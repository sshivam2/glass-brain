<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instruments- Mini Test - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Match the following instruments used in surgery.",
    "choices": [
      {
        "id": 1,
        "text": "1-a, 2-b, 3-c, 4-d"
      },
      {
        "id": 2,
        "text": "1-b, 2-a, 3-d, 4-c"
      },
      {
        "id": 3,
        "text": "1-c, 2-a, 3-d, 4-b"
      },
      {
        "id": 4,
        "text": "1-b, 2-a, 3-c, 4-d"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option 2 is correctly matched.</p>\n<p><strong>Image 1</strong> shows\u00a0<strong>Lane\u2019s tissue holding forceps</strong></p>\n<ul>\n<li>It has got stout and thick distal blades with oval fenestra in each blade</li>\n<li>Apposing tooth in the tip</li>\n<li>Lock in proximal part</li>\n</ul>\n<p><strong>Uses:</strong></p>\n<ul>\n<li>Hold bulky and tough structures, hold lymph nodes.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/337ca4cfd9ca47bca1f2ece0423e908b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/65a68547d9674ffb90b97e3bbb470246x1280x1431.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08d025764d3b4b6bac14ccb9cfacf690x1280x1133.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5033693cfd9548bd8558cddc37cd47d6x1279x916.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea1901d9fb3f4463859b483a274b3b03x1280x1074.JPEG"
    ]
  },
  {
    "text": "Which of the following instruments would be best suited to retract the liver out of the field of operation while performing an open cholecystectomy?",
    "choices": [
      {
        "id": 1,
        "text": "2"
      },
      {
        "id": 2,
        "text": "1"
      },
      {
        "id": 3,
        "text": "4"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The&nbsp;<strong>Deaver&rsquo;s retractor&nbsp;</strong>would be most useful&nbsp;in <strong>cholecystectomy</strong> as it is specifically designed for holding the<strong> liver up and out of the way.</strong></p>\n<p>Deaver&rsquo;s retractor is used carefully to avoid damaging the liver.&nbsp;Some surgeons protect the liver with an abdominal pack before placing the blade on top.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6ce0c678d34f462698fb9c6a25799011.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17c166338071480b822403726b8774adx1279x1022.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c63273e151a2491d9eb81fb25fd02c71x1279x1116.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/14edbbd2fd764e13a28f2a6f1472a6ffx1279x745.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/03ea82932e434fbb9dda901ea7c24258x1280x1065.JPEG"
    ]
  },
  {
    "text": "Which of the following instruments are used in the caesarean section?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 5, 6"
      },
      {
        "id": 2,
        "text": "1, 2, 3, 5"
      },
      {
        "id": 3,
        "text": "1, 2, 4, 6"
      },
      {
        "id": 4,
        "text": "1, 2, 3, 6"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Of the given list/combination of instruments&nbsp;<strong>1, 2, 4, 6&nbsp;</strong>are commonly used in the cesarean section.&nbsp;</p>\n<p><strong>Cesarean section </strong>is an operative procedure in which the fetuses are delivered through an incision on the abdominal and uterine walls.&nbsp;</p>\n<p>The given image summarizes the various instruments used in the lower segment cesarean section.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94662fbc80ab43e4a14ff9269caa1af2x1280x2557.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4a7c3ed485441dead8b8794440c8cf4x1280x1666.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5b83caf252645d7af45d27715ea21fbx1279x1116.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c730be584fa47deb5f1a0b23b86c0f8x1280x1133.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/05794c14c7af430788a4406b771cd986x720x427.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cdd18a8f03fd4e069940839b4c4fd3c4x720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/df2958421cc24cc1baffce68302d0207x1280x781.JPEG"
    ]
  },
  {
    "text": "You enter the ENT operation theatre when a procedure is underway for a patient with fungal sinusitis with a fungal ball.  You notice the following instruments on the instruments tray. Which of the following is not an indication for the procedure performed with these instruments?",
    "choices": [
      {
        "id": 1,
        "text": "Lateral frontal sinusitis"
      },
      {
        "id": 2,
        "text": "Control of epistaxis"
      },
      {
        "id": 3,
        "text": "Antrochoanal polyp"
      },
      {
        "id": 4,
        "text": "Septoplasty"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 470\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The given image is of instruments commonly\u00a0used in <strong>Functional Endoscopic Sinus Surgery</strong>\u00a0(FESS) operation. <strong>Lateral frontal sinus disease</strong> is a contraindication for endoscopic sinus surgery as the disease is inaccessible by endoscopic procedures.</p>\n<p>Indications of FESS:</p>\n<ul>\n<li>Chronic bacterial sinusitis unresponsive to adequate medical\u00a0treatment.</li>\n<li>Recurrent acute bacterial sinusitis.</li>\n<li>Polypoid rhinosinusitis (diffuse nasal polyposis).</li>\n<li>Fungal sinusitis with fungal ball or nasal polyp.</li>\n<li><strong>Antrochoanal polyp</strong>.</li>\n<li>Mucocele of frontoethmoid or sphenoid sinus.</li>\n<li><strong>Control of epistaxis</strong> by endoscopic cautery.</li>\n<li>Removal of foreign body from the nose or sinus.</li>\n<li>Endoscopic <strong>septoplasty</strong>.</li>\n</ul>\n<p>Contraindications to FESS:</p>\n<ul>\n<li>Inexperience and lack of proper instrumentation.</li>\n<li>Disease inaccessible by endoscopic procedures, e.g.<strong> lateral frontal sinus disease</strong> and stenosis of internal opening of frontal sinus.</li>\n<li>Osteomyelitis.</li>\n<li>Threatened intracranial or intraorbital complication.</li>\n</ul>\n<p>The following image shows common instruments used in FESS:</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/da0058912a194b368af832a1e4987f7a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/29193165fbd742eb9c52045d2a60f119x1280x1850.JPEG"
    ]
  },
  {
    "text": "A 55-year-old, alcohol-dependent male patient presented with respiratory distress and abdominal distension. The patient reports that this is a recurring problem even after repeated medical interventions. On auscultation, basal crackles are heard bilaterally on the chest fields. He is visibly icteric, and his fingers show clubbing. The nurse prepares the following tray for a procedure. Which quadrant of the abdomen is preferred when performing this procedure?",
    "choices": [
      {
        "id": 1,
        "text": "Left upper quadrant"
      },
      {
        "id": 2,
        "text": "Right lower quadrant"
      },
      {
        "id": 3,
        "text": "Left lower quadrant"
      },
      {
        "id": 4,
        "text": "Right upper quadrant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given clinical scenario, a <strong>large-volume paracentesis</strong>&nbsp;is to be done <strong>to remove ascitic fluid</strong> secondary to likely liver pathology.&nbsp;The <strong>left lower quadrant</strong> is preferred because of the <strong>greater depth of ascites</strong> and the<strong> thinner abdominal wall.</strong></p>\n<p>After evaluation of the patient and confirmation of ascites,&nbsp;the etiology of the ascites is best determined by <strong>paracentesis.&nbsp;</strong></p>\n<p><strong>Paracentesis</strong>&nbsp;is a bedside procedure in which a needle or small catheter is passed transcutaneously to drain ascitic fluid from the peritoneum. The lower quadrant is the most frequent site for paracentesis. The left lower quadrant is preferred because of the <strong>greater depth</strong> of ascites and the thinner abdominal wall. Paracentesis is a relatively <strong>safe</strong> procedure even in patients with coagulopathy.</p>\n<p>Complications are seen but are infrequent and include the following:</p>\n<ul>\n<li>Abdominal wall hematomas</li>\n<li>Hypotension</li>\n<li>Hepatorenal syndrome</li>\n<li>Infection</li>\n</ul>\n<p><strong>Refractory cirrhotic ascites</strong> is defined by the persistence of ascites despite sodium restriction and maximal (or maximally tolerated) diuretic use. When medical therapy is insufficient, refractory ascites is managed by repeated <strong>large-volume paracentesis (LVP).&nbsp;</strong>Patients undergoing LVP should receive <strong>IV albumin</strong> infusions of <strong>6&ndash;8 g per liter of ascitic fluid removed</strong>.&nbsp;Intravenous infusion of albumin accompanying LVP decreases the risk of &ldquo;<strong>post-paracentesis circulatory dysfunction</strong>&rdquo; and death. Post-paracentesis circulatory dysfunction (PPCD) is characterized by the activation of the RAAS system and increased renin levels. It causes rapid re-accumulation of ascitic fluid.</p>\n<p>Indications of paracentesis:</p>\n<ul>\n<li>Diagnostic -\n<ul>\n<li>New-onset ascites for fluid evaluation</li>\n<li>Refractory ascites</li>\n<li>\n<div class=\"topbullet\">Suspected spontaneous or secondary bacterial peritonitis</div>\n</li>\n</ul>\n</li>\n<li>Therapeutic -\n<ul>\n<li>\n<div class=\"topbullet\">Respiratory compromise secondary to ascites</div>\n</li>\n<li>Abdominal pain or pressure secondary to ascites</li>\n</ul>\n</li>\n</ul>\n<p>Contraindications :</p>\n<p>An acute abdomen requiring surgery is the only absolute contraindication. Relative contraindications include elevated PT/INR and pregnancy.</p>\n<p>The following image shows the instruments included in a paracentesis tray:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1d5188859e214b378ae753068c585576.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da5200b8ae7e49a197600d70b5fb7a8ax1280x1631.JPEG"
    ]
  },
  {
    "text": "Which of the following instruments is/are used in tubal patency testing?",
    "choices": [
      {
        "id": 1,
        "text": "1 and 3"
      },
      {
        "id": 2,
        "text": "2 and 3"
      },
      {
        "id": 3,
        "text": "1 and 2"
      },
      {
        "id": 4,
        "text": "1, 2, and 3"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option D is correct. All the above instruments are used in tubal patency testing.\u00a0</p>\n<p><strong>Image 1</strong> shows\u00a0<strong>Rubins Insufflation Cannula.</strong></p>\n<div>It requires a \u2018Y\u2019\u00a0rubber tube. One end is attached to a bulb and the\u00a0other end to a manometer.</div>\n<p>Uses:\u00a0To know the patency of the tube (Rubin\u2019s test) in\u00a0infertility investigation or following tuboplasty.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/545f3789947c433aa57011968d95b4d2.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/769647a4c55246f3b2a34e05288d9d6ax600x468.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fd9ae846ece44c19ed341124771fb44x600x468.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9b11841428f348cbbfc27d4a68cc668cx600x468.JPEG"
    ]
  },
  {
    "text": "A senior resident working in an intensive care unit has assembled the following materials to perform a procedure. Which of the following is not an indication for this procedure?",
    "choices": [
      {
        "id": 1,
        "text": "Aspiration of air emboli"
      },
      {
        "id": 2,
        "text": "Permanent hemodialysis"
      },
      {
        "id": 3,
        "text": "Hyperalimentation administration"
      },
      {
        "id": 4,
        "text": "Transvenous cardiac pacing"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>From the materials which have been gathered by the senior resident, it can be inferred that he would be performing a <strong>central venous catheterization.\u00a0</strong></p>\n<p>The materials are as follows according to their numbers in the given image.</p>\n<ol>\n<li>A syringe with a local anesthetic</li>\n<li>Scalpel in case venous cutdown is needed</li>\n<li>Sterile gel for ultrasound\u00a0guidance</li>\n<li>Introducer needle (here 18 Ga) on the syringe with saline\u00a0to detect backflow of blood upon vein penetration</li>\n<li>Guidewire</li>\n<li>Tissue dilator</li>\n<li>An indwelling catheter (here 16 Ga)</li>\n<li>Additional fasteners, and corresponding surgical thread</li>\n<li>The final dressing to be applied</li>\n</ol>\n<p>The catheter can be inserted into any of the following veins - Internal jugular veins, subclavian vein, external jugular veins, and femoral vein.</p>\n<p>Preferred sites in special considerations :</p>\n<ul>\n<li>Severe bleeding diatheses - Internal/external jugular vein</li>\n<li>Severe emphysema - Internal jugular</li>\n<li>Emergency transvenous cardiac pacing - Right internal jugular</li>\n<li>Trauma patients (neck immobilised) - Subclavian/Femoral</li>\n</ul>\n<p><strong>Indications</strong> of central venous catheterization include</p>\n<ul>\n<li>Central venous pressure monitoring</li>\n<li>Pulmonary artery catheterization and monitoring</li>\n<li><strong>Transvenous cardiac pacing</strong></li>\n<li><strong>Temporary</strong> hemodialysis</li>\n<li>Drug administration (concentrated vasoactive drugs, <strong>hyperalimentation</strong>, chemotherapy, agents irritating peripheral veins, prolonged antibiotic therapy)</li>\n<li>Rapid infusion of fluids<strong>\u00a0</strong>(Trauma, major surgery)</li>\n<li><strong>Aspiration of air emboli</strong></li>\n<li>Inadequate peripheral venous access</li>\n<li>Sampling site for repeated blood testing</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cba1dbcee9944ccba1c0350149ede006.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c9e9449c8c7449998ad3ff588cd999dax750x600.JPEG"
    ]
  },
  {
    "text": "Which of the following instruments are kept in the baby tray in the labour room ?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 4, 5 and 6"
      },
      {
        "id": 2,
        "text": "1, 3, 5 and 6"
      },
      {
        "id": 3,
        "text": "1, 2, 3, 5 and 6"
      },
      {
        "id": 4,
        "text": "3, 4, 5 and 6"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<div class=\"page\" title=\"Page 1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option C is correct. Epinephrine is not kept in the baby tray.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6126118acf6849e2983f36fc3d67b890x1280x1235.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/496d8eb3c4fe4e9c9f53d52de5631fa0x1280x998.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/719570b259b84d328f61bb29f1519528x1280x997.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e1e8eb3aaef34bb3be9d48a437be24eax1280x998.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a4b60cc58d64e19aa5ae45b52013862x1280x997.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9a03075b751248088c53022e4feacee7x1280x997.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1b819e5058cc434b8d324512f7c61f29x1280x997.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5aaa534df9af48548b08420feae2cc7ex1280x997.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d5ba9bbfbfc540c48f17a59c14a15d42x1280x997.JPEG"
    ]
  },
  {
    "text": "Name the surgery for which the following set of instruments is used.",
    "choices": [
      {
        "id": 1,
        "text": "Pharyngoplasty"
      },
      {
        "id": 2,
        "text": "Palatoplasty"
      },
      {
        "id": 3,
        "text": "Adenoidectomy"
      },
      {
        "id": 4,
        "text": "Tonsillectomy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given set of instruments is used in<strong> tonsillectomy.</strong></p>\n<p>Instrument 1: <strong>Boyle-Davis mouth gag\u00a0</strong>is used for opening the mouth and depressing tongue for doing surgery. Various sized<strong> tongue blades</strong> are used along with it according to the age of the patient.</p>\n<p>Uses of Boyle Davis mouth gag are:</p>\n<ul>\n<li>Pharyngoplasty</li>\n<li>Tonsillectomy\u00a0</li>\n<li>Surgery of soft palate</li>\n<li>Adenoidectomy</li>\n<li>Excision of angiofibroma</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b2c79f52f83e4abdb68b39d1b164a724.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e1d1fa2222c945c3bd1f2b7d9be1c937x1280x1542.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/169078b60df84e80bc110ed7e212d4e0x1280x1517.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0da3c0fbf1bb40dd92fc2798a4c5615cx1280x875.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74300c6bff4d462185bb4c1f1265f7cdx1280x2167.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aaaeaa555a4942c09720460eeab2e031x1280x1414.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c5738f444d3143a28821672b52f50d82x1280x962.JPEG"
    ]
  },
  {
    "text": "Name the procedure for which the following set of instruments are used.",
    "choices": [
      {
        "id": 1,
        "text": "Lid surgery"
      },
      {
        "id": 2,
        "text": "Dacryocystorhinostomy"
      },
      {
        "id": 3,
        "text": "Enucleation"
      },
      {
        "id": 4,
        "text": "Lens extraction"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given set of instruments is used for <strong>dacryocystorhinostomy</strong> (DCR).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a77decd9e60642c881e40cc455367e3e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/40d189f5cbfe44ccabd7acc49be13313x600x703.JPEG"
    ]
  },
  {
    "text": "Identify the procedure for which the given instrument tray is used.",
    "choices": [
      {
        "id": 1,
        "text": "Bone marrow biopsy"
      },
      {
        "id": 2,
        "text": "Liver biopsy"
      },
      {
        "id": 3,
        "text": "Lumbar puncture"
      },
      {
        "id": 4,
        "text": "Pleural biopsy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given tray contains the&nbsp;<strong>Jamshidi biopsy needle</strong>&nbsp;which is used to perform&nbsp;<strong>bone marrow biopsy.</strong></p>\n<p>Jamshidi bone marrow biopsy needle, instrument number 3, is the key identifier.</p>\n<p>Equipment:&nbsp;</p>\n<ol>\n<li>Stylet</li>\n<li>Cap</li>\n<li>Jamshidi Biopsy needle-wide bore.</li>\n<li>J-shaped obturator&nbsp;for removing the&nbsp;biopsy core from the needle</li>\n<li>No. 11 blade&nbsp;to give a stab at the selected site</li>\n<li>Glass slides</li>\n<li>Drapes</li>\n<li>Sponge holder</li>\n<li>Disposable syringes - to give local anesthesia and then to collect samples</li>\n<li>Needles - to give local anesthesia and then to collect samples</li>\n<li>Bowl for antiseptic solution</li>\n<li>Kidney tray</li>\n<li>Gauze pieces</li>\n<li>Injectable lidocaine 2% for local anesthesia</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/757c7bd36da94d7ea48d0c10e20e7e2c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/38c79396ac104e6fbe4c268a76c7d970x600x764.JPEG"
    ]
  },
  {
    "text": "You are an intern posted in the Obstetrics and Gynaecology outpatient department. You notice the following set of instruments on a tray in the examination room. Which of the following statements is not true regarding the test performed with the given set of instruments?",
    "choices": [
      {
        "id": 1,
        "text": "Test should not be performed if the patient has had intercourse in the past 72 hours"
      },
      {
        "id": 2,
        "text": "Ideal time to perform the test is around the time of ovulation"
      },
      {
        "id": 3,
        "text": "The test should be performed prior to performing a vaginal examination"
      },
      {
        "id": 4,
        "text": "Lubricants should not be used while or prior to performing the test"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given set of instruments are commonly used for the collection of\u00a0<strong>pap smears.\u00a0</strong>The patient should, ideally, not have had intercourse in the\u00a0<strong>24 hours</strong> prior to the test.</p>\n<p>The given image includes Cusco's bivalved self-retaining speculum, Koplin's jar, smear slides, Ayer's spatula, and endocervical brush.\u00a0</p>\n<p><strong>Pap/ Papanicolaou test</strong>\u00a0is a\u00a0<strong>screening test</strong>\u00a0only. A positive test requires further evaluation - colposcopy, cervical biopsy, fractional curettage should be done.</p>\n<p><strong>Prerequisites:</strong></p>\n<ul>\n<li>Should be done prior to vaginal examination, as\u00a0the fingers may remove the desquamated cervical cells and give a false-negative report,</li>\n<li>Lubricants should not be used as they may prevent detection of organisms</li>\n<li>The patient should not be menstruating during the pap test as\u00a0any vaginal bleeding during the examination precludes proper visualization of the cervix. So, the ideal time is around ovulation.</li>\n<li>The patient should not have had intercourse 24 hours prior to the test.</li>\n</ul>\n<p><strong>Screening guidelines:</strong></p>\n<ul>\n<li>Time for initiation:\u00a0<strong>21 years</strong>, regardless of the age of first sexual intercourse.</li>\n<li>Women aged 21-29 years: Every\u00a0<strong>3 years</strong>(earlier it was done annually)</li>\n<li>Women who are aged 30-65 years: Pap test + HPV testing every\u00a0<strong>5 years</strong>.</li>\n<li>Women should stop having cervical cancer screening after the age of 65 years.\u00a0If suspicious PAP, screening till 75 years.</li>\n<li>HIV+ women: annual checkup until three consecutive negative tests followed by testing every 3 years for life.</li>\n<li>HPV DNA testing in combination with PAP improves the sensitivity of screening.</li>\n</ul>\n<p>Ayres spatula and endocervical brush are the instruments used for the pap test.</p>\n<p>The most common fixative used in pap smear is <strong>95% ethyl alcohol</strong>.\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2885cb42ac424d1b8feb33798800abf9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b44ec905357c406294d60051ccc0ed88x1280x4698.JPEG"
    ]
  },
  {
    "text": "Match the following splints and the conditions where they are used.",
    "choices": [
      {
        "id": 1,
        "text": "1-d, 2-c, 3-b, 4-a"
      },
      {
        "id": 2,
        "text": "1-d, 2-b, 3-c, 4-a"
      },
      {
        "id": 3,
        "text": "1-c, 2-d, 3-b, 4-a"
      },
      {
        "id": 4,
        "text": "1-c, 2-d, 3-a, 4-b"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct answer is\u00a01-d, 2-c, 3-b, 4-a.</p>\n<ol>\n<li>Knuckle bender splint - Ulnar nerve palsy</li>\n<li>Cock-up splint\u00a0 -\u00a0Radial nerve palsy</li>\n<li>Aeroplane splint -\u00a0Brachial plexus injury</li>\n<li>SOMI Brace - Cervical spine injury</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6e75b0489df246ba86ea62d2b4fb5ca6.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f82c568dd99481ebcf6f5dd959f5282x1280x1246.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dad153a18bc74b6da49da12ee4355bb9x1280x1246.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6c75d65d75024117bdccb1898700c05dx1280x1251.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/356aa963d1494c2fb53ca591f81dce99x1280x1254.JPEG"
    ]
  },
  {
    "text": "While posted in the COVID ward, you notice the following instruments present on a tray and you realize it is for a particular procedure. All of the following predict difficulty in performing the procedure except:",
    "choices": [
      {
        "id": 1,
        "text": "High, arched palate"
      },
      {
        "id": 2,
        "text": "Short thyromental distance"
      },
      {
        "id": 3,
        "text": "Long, thin neck"
      },
      {
        "id": 4,
        "text": "Prominent overbite"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows a tray in an&nbsp;<strong>airway cart</strong> with the instruments necessary for <strong>endotracheal intubation.&nbsp;</strong>All the options are predictors of difficult laryngoscopy (and difficult intubation) except a <strong>long, thin</strong> neck.<strong>&nbsp;</strong>A <strong>short, thick neck</strong> is a predictor of<strong>&nbsp;difficult laryngoscopy.</strong></p>\n<p>An endotracheal intubation tray may include:</p>\n<ol>\n<li><strong>Magill's forceps</strong>&nbsp;</li>\n<li><strong>Macintosh curved laryngoscope/Miller's straight laryngoscope</strong> for direct laryngoscopy</li>\n<li><strong>Endotracheal (ET) tubes</strong> of varying sizes</li>\n<li>A 10ml <strong>syringe</strong> to inflate the bulb of the ET tube</li>\n<li><strong>Stylet and Bougie</strong> to aid in difficulty with intubation</li>\n<li><strong>Guedel oropharyngeal airway</strong> to suction secretion for better visualization of the airway</li>\n</ol>\n<p>Difficult endotracheal intubation by direct laryngoscopy is primarily due to an inadequate view of the glottis.&nbsp;<strong>Predictors</strong> for difficult laryngoscopy&nbsp;are as given below :</p>\n<ul>\n<li>Long upper incisors</li>\n<li><strong>Prominent overbite</strong></li>\n<li>Inability to protrude the mandible</li>\n<li>Small mouth opening</li>\n<li>Mallampati classification III or IV</li>\n<li><strong>High, arched palate</strong></li>\n<li><strong>Short thyromental distance</strong></li>\n<li><strong>Short, thick neck</strong></li>\n<li>Limited cervical mobility</li>\n</ul>\n<p>The&nbsp;<strong>Cormack and Lehane grading</strong> scale describes laryngoscopic views with grades&nbsp;ranging from I&nbsp;(the best view) to IV (the most difficult view). The grades are as follows :</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Grades</strong></td>\n<td style=\"text-align: center;\"><strong>Structures visualized</strong></td>\n</tr>\n<tr>\n<td>I</td>\n<td>Entire laryngeal aperture</td>\n</tr>\n<tr>\n<td>II</td>\n<td>Only the posterior portion of the laryngeal aperture</td>\n</tr>\n<tr>\n<td>III</td>\n<td>Only the epiglottis</td>\n</tr>\n<tr>\n<td>IV</td>\n<td>No visualization of the epiglottis or larynx</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Yentis</strong> modified the classification scheme and&nbsp;proposed that grade II be differentiated into IIA (partial view of the glottis) and IIB (arytenoids or posterior vocal cords only are visible).</p>\n<ul>\n<li><strong>Grade I or IIA&nbsp;</strong>- relatively easy intubation.</li>\n<li><strong>Grades IIB and III</strong> - significantly difficult intubation.</li>\n<li><strong>Grade IV</strong>- alternate method of intubation required (such as blind passage of ET or using an intubating stylet).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/edad6ecb51824840a293203288cf12f1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old female presents to the casualty after a trivial fall with pain in her right hip. X-Rays taken shows the presence of fracture of the femoral neck.  Which of the following implants will the orthopedic surgeon use in this case?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Among the given nails used as implants, the\u00a0<strong>Smith Petersen nail (SP nail)</strong>\u00a0shown in image 1 is used for internal fixation of fracture of the femoral neck.</p>\n<p><strong>Smith Petersen nail (SP nail) :</strong></p>\n<p>It is a cannulated triflanged nail that is used for internal fixation of a fracture of the neck of the femur. Advantages of its triflanged shape:</p>\n<ul>\n<li>It prevents axial rotation of the fragments</li>\n<li>It cuts only a little bone to provide good stability.</li>\n</ul>\n<p>The nail is cannulated because it is threaded over a guide wire introduced at the correct site under X-ray control. It can be used along with McLaughlin\u2019s plate for the fixation of inter-trochanteric fractures as well.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5b42efce188e421d95af0e4f11df1b7f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a8e70ab78dc4eeca98b1f83227f249cx1280x1042.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0cb45896b48640f6a1288dbbc5b12e58x1280x1252.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/315d44569b00435e8ee1cdf39cd870a9x1280x1955.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c6e4ac5a2f448db859e26a26325ab42x1280x1432.JPEG"
    ]
  },
  {
    "text": "Which of the following is false regarding the procedure performed with the following set of instruments?",
    "choices": [
      {
        "id": 1,
        "text": "Best placement of the tube for suctioning is postpyloric"
      },
      {
        "id": 2,
        "text": "It is contraindicated in significant facial trauma"
      },
      {
        "id": 3,
        "text": "Length is measured from tip of nose to ear to xiphisternum"
      },
      {
        "id": 4,
        "text": "Abdominal x-ray is the best way to confirm position"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given instrument tray shows instruments required for insertion of a <strong>nasogastric tube</strong> which is placed <strong>before the pylorus</strong> when used <strong>for</strong> <strong>suction</strong> to <strong>avoid damage to the duodenum</strong>.</p>\n<p>Nasogastric tubes play a standard role in treating intestinal obstruction and can also be used to provide nutritional support. The commonly used method to determine the length of a nasogastric tube is the <strong>NEX method</strong>: the<strong> tip of the nose </strong>to<strong> ear </strong>to<strong> xiphisternum</strong>.</p>\n<p>NEX method:</p>\n<ul>\n<li>Nose&ndash;Ear&ndash;Xiphisternum&nbsp;</li>\n<li>The tube length should be estimated before insertion.</li>\n<li>Place the exit port of the tube at the&nbsp;<strong>tip of the nose</strong>. Extend tube to the&nbsp;<strong>earlobe</strong>, and then to <strong>xiphisternum</strong>.</li>\n</ul>\n<p>Approximate length<strong>&nbsp;</strong>to be inserted: 55cms</p>\n<p>Ideally, Ryle's tube is inserted in the<strong> sitting position </strong>with the <strong>neck slightly flexed</strong>. Confirmation of the correct position is done by the following:</p>\n<ul>\n<li>Auscultation in the epigastric area while injecting a bolus of air</li>\n<li>An <strong>abdominal x-ray</strong> is the <strong>best way to confirm</strong> the <strong>location</strong> of the tube</li>\n</ul>\n<p>The ideal location for an NG tube placed for<strong> suction </strong>is <strong>within the stomach</strong> because placement past the pylorus can cause damage to the duodenum. The <strong>ideal location</strong> for an NG<strong> feeding tube </strong>is<strong> postpyloric </strong>to<strong> decrease </strong>the risk of<strong> aspiration</strong>.</p>\n<p>Indications for NG tube :</p>\n<ul>\n<li>Aspiration of gastric fluid</li>\n<li>Gastric decompression</li>\n<li>Feeding</li>\n<li>Administration of medication</li>\n<li>Bowel irrigation</li>\n</ul>\n<p>Contraindications:</p>\n<p>Absolute:</p>\n<ul>\n<li><strong>Severe midface trauma</strong></li>\n<li>Recent nasal surgery</li>\n</ul>\n<p>Relative:</p>\n<ul>\n<li>Coagulation abnormality</li>\n<li>Esophageal varices</li>\n<li>Recent banding of esophageal varices</li>\n<li>Anastomoses in stomach and esophagus</li>\n</ul>\n<p>Instruments tray used for nasogastric tube insertion:&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d6fdc076610e47db8247ecff32943a25.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/db2910a0ec88475ebf504ec500fb2daax1280x1602.JPEG"
    ]
  },
  {
    "text": "A patient is prepared for a minor procedure in the ophthalmology outpatient department. The following instruments are assembled in the tray. Which of the following glands is involved in the pathology for which this procedure is performed?",
    "choices": [
      {
        "id": 1,
        "text": "Gland of Wolfring"
      },
      {
        "id": 2,
        "text": "Zeis gland"
      },
      {
        "id": 3,
        "text": "Meibomian gland"
      },
      {
        "id": 4,
        "text": "Gland of Krause"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given set of instruments represents the <strong>chalazion set</strong>&nbsp;which is used to perform <strong>incision and curettage</strong> of a chalazion.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2110f356adfc4a75961b6d646be90c3f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1cf8e4b9a364419f885ef5b5dfe996cax1280x2146.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f86dfec85b9d49d891620fe3bea4bff2x600x450.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/755fb1e967ed4a1c9fda4e336943a02ax548x448.PNG"
    ]
  },
  {
    "text": "Identify the following instrument tray.",
    "choices": [
      {
        "id": 1,
        "text": "Delivery tray"
      },
      {
        "id": 2,
        "text": "Episiotomy tray"
      },
      {
        "id": 3,
        "text": "Baby tray"
      },
      {
        "id": 4,
        "text": "Manual vacuum aspiration tray"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The given set of instruments are components of a <strong>delivery tray.</strong></p>\n<p>The image below shows the&nbsp;<strong>delivery tray</strong> containing</p>\n<ol>\n<li>Kidney tray</li>\n<li>Bowl for antiseptic&nbsp;lotion</li>\n<li>Perineal pads</li>\n<li>Gauze pieces&nbsp;</li>\n<li>Cotton swabs&nbsp;</li>\n<li>Speculum&nbsp;</li>\n<li>Gloves</li>\n<li>Urinary catheter&nbsp;</li>\n<li>Scissors</li>\n<li>Sponge holding forceps&nbsp;</li>\n<li>Artery forceps</li>\n<li>Cord clamp&nbsp;</li>\n</ol>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/90910fdb3e724434bf8260dbccac2f4e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d62339de04d247f6b4d37a3649269f46x1280x1235.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/015134ab07b14d9eb884ed9294cdbe51x1200x916.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2437951a91f4406b8be000009bc21f27x1279x1235.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf9fee03a89840be808f4b2eee9a2f54x1280x1875.PNG"
    ]
  },
  {
    "text": "A patient with bilateral abductor paralysis is admitted to the intensive care unit. In order to relieve the respiratory obstruction, a tracheostomy is being performed. Which of the following is not an immediate complication of this procedure?",
    "choices": [
      {
        "id": 1,
        "text": "Aspiration of blood"
      },
      {
        "id": 2,
        "text": "Pneumothorax"
      },
      {
        "id": 3,
        "text": "Apnoea"
      },
      {
        "id": 4,
        "text": "Tracheal stenosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Tracheal stenosis</strong>, due to tracheal ulceration and infection, is a<strong> late complication</strong> of tracheostomy and does not occur immediately.</p>\n<div class=\"page\" title=\"Page 374\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>A tracheostomy is a procedure where an opening is made in the anterior wall of the trachea and it is converted into a stoma on the skin surface. It is primarily indicated when there is respiratory <strong>obstruction</strong>, <strong>secretions, </strong>or respiratory<strong> insufficiency.&nbsp;</strong>It is also indicated<strong>&nbsp;</strong>in an <strong>intubated patient</strong> after&nbsp;<strong>2-3 weeks</strong>&nbsp;to avoid&nbsp;<strong>subglottic stenosis.</strong></p>\n</div>\n</div>\n</div>\n<p><strong>Complications of tracheostomy:</strong></p>\n<table style=\"height: 271px; width: 558.359375px;\">\n<tbody>\n<tr>\n<td style=\"width: 177px; text-align: center;\">\n<p><strong>Immediate </strong></p>\n<p>(at the time of operation)</p>\n</td>\n<td style=\"width: 110px; text-align: center;\">\n<p><strong>Intermediate </strong></p>\n<p>(during first few hours or days)</p>\n</td>\n<td style=\"width: 210.359375px; text-align: center;\">\n<p><strong>Late </strong></p>\n<p>(after chronic use for weeks or months)</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 177px;\">\n<ol>\n<li>Primary hemorrhage</li>\n<li>Apnoea due to sudden washout of CO2</li>\n<li>Pneumothorax due to injury to apical pleura</li>\n<li>Injury to recurrent laryngeal nerves</li>\n<li>Aspiration of blood</li>\n<li>Injury to esopgahus</li>\n</ol>\n</td>\n<td style=\"width: 110px;\">\n<ol>\n<li>Reactionary or secondary hemorrhage.</li>\n<li>Displacement of the tube.</li>\n<li>Blocking of the tube.</li>\n<li>Subcutaneous emphysema.</li>\n<li>Tracheitis and tracheobronchitis.</li>\n<li>Atelectasis and lung abscess.</li>\n<li>Local wound infection and granulations.</li>\n</ol>\n</td>\n<td style=\"width: 210.359375px;\">\n<ol>\n<li>Laryngeal stenosis.</li>\n<li>Tracheal stenosis</li>\n<li>Tracheo-oesophageal fistula</li>\n<li>Problems of decannulation.</li>\n<li>Persistent tracheocutaneous fistula.</li>\n<li>Keloid or unsightly scar.</li>\n<li>Aspiration of tracheostomy tube fragments into the tracheobronchial tree</li>\n</ol>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/53ce80cec98c4e1db894222948d61c68x720x569.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8ac6b785f2084d1f9e475bbc1023cc39x1279x1077.JPEG"
    ]
  },
  {
    "text": "The following set of instruments are not used in ________ .",
    "choices": [
      {
        "id": 1,
        "text": "Post operative analgesia"
      },
      {
        "id": 2,
        "text": "Spinal anesthesia"
      },
      {
        "id": 3,
        "text": "Obstetric analgesia"
      },
      {
        "id": 4,
        "text": "Segmental block"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows <strong>Epidural set,</strong> containing an epidural catheter, 18G Tuohy needle and a syringe,\u00a0which is used in epidural anesthesia. It is used in obstetric analgesia, post-operative analgesia, and segmental blocks, but not in spinal anesthesia.</p>\n<p><strong>Identification points:</strong></p>\n<ul>\n<li>Tuohy needle has a <strong>blunt, curved tip (Huber tip)</strong>\u00a0that helps to <strong>prevent accidental dural puncture</strong>.\u00a0The needle shaft is marked in 1-cm intervals so that the depth of insertion can be identified.</li>\n</ul>\n<p>It finds its use in surgical anesthesia, obstetric analgesia, segmental blocks, post operative analgesia, and chronic pain management.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2022189d3fbb4c6090f78982eb1b1a89.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Instruments- Mini Test';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>