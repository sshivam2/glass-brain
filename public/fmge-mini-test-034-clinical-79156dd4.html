<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 034 (Clinical) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 52-year-old woman presented with weakness of shoulder movements. Investigations revealed quadrangular space syndrome. Which of the following nerve is likely to be affected?",
    "choices": [
      {
        "id": 1,
        "text": "Musculocutaneous nerve"
      },
      {
        "id": 2,
        "text": "Suprascapular nerve"
      },
      {
        "id": 3,
        "text": "Radial nerve"
      },
      {
        "id": 4,
        "text": "Axillary nerve"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>axillary nerve </strong>is likely to be affected as it is&nbsp;one of the contents of the quadrangular space.</p>\n<p><strong>Quadrangular space</strong> <strong>(Foramen of Velpeau)&nbsp;</strong>is a passageway for the nerves and vessels between the axilla anteriorly and the scapular region posteriorly.</p>\n<p><strong>Quadrangular space syndrome:&nbsp;</strong>The condition is caused by hypertrophy or fibrosis of the quadrangular space muscles which impinge on the axillary nerve. The patient presents with weakness of the shoulder movements.</p>\n<p>The image below shows spaces around the shoulder joint. (QS: Quadrangular space, TS: Superior triangular space, TI: Inferior triangular space).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f28ce7ad9ba4b0fb0d0b3f5c60a8d38x1130x1200.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bf523ab9db054b8f940eb434874a1fbax1182x1200.GIF"
    ]
  },
  {
    "text": "An elderly man, with congestive cardiac failure, complains of shortness of breath when lying down. What is the mechanism behind this symptom?",
    "choices": [
      {
        "id": 1,
        "text": "Reservoir function of pulmonary veins."
      },
      {
        "id": 2,
        "text": "Reservoir function of veins in lower limbs."
      },
      {
        "id": 3,
        "text": "Pulmonary arterial hypertension."
      },
      {
        "id": 4,
        "text": "Systemic hypertension."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given scenario describes <strong>orthopnea</strong> in congestive heart failure. It is due to <strong>reservoir function of pulmonary veins.</strong></p>\n<p><strong>Orthopnea&nbsp;</strong>is&nbsp;<strong>dyspnea</strong> occurring in the <strong>recumbent</strong> position.</p>\n<p>It results from <strong>redistribution</strong> of <strong>fluid</strong> from the <strong>splanchnic</strong> circulation <strong>and</strong> lower <strong>extremities</strong> (increased venous return) into the heart during recumbency. This increased venous return is <strong>not</strong> <strong>put</strong> <strong>out</strong> by the left ventricle and hence pools in the <strong>pulmonary</strong> <strong>veins</strong> that acts as <strong>capacitance</strong> <strong>vessels</strong> (reservoir function) adding to the already congested pulmonary vasculature resulting in breathing difficulty.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year old man who was a chronic alcoholic presented with confusion, ataxia, and diplopia. What is the treatment protocol?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B1 injection followed by glucose infusion"
      },
      {
        "id": 2,
        "text": "Glucose infusion followed thiamine injection"
      },
      {
        "id": 3,
        "text": "Glucose infusion alone"
      },
      {
        "id": 4,
        "text": "Thiamine infusion alone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical history is suggestive of <strong>Wernicke's&nbsp;encephalopathy.</strong></p>\n<p>The current standard of treatment for patients with symptoms of Wernicke's encephalopathy is to give<strong>&nbsp;thiamine 100 mg intravenously before administering glucose-containing&nbsp;IV fl</strong>uids.</p>\n<p>Thiamine deficiency&nbsp;leads to the following:</p>\n<p><strong>&nbsp; &nbsp; 1. Wernicke&rsquo;s encephalopathy:&nbsp;</strong>It is more commonly seen in alcoholics with chronic thiamine deficiency. It is characterized by :</p>\n<ul>\n<li>Global confusion</li>\n<li>Truncal ataxia</li>\n<li>Ophthalmoplegia</li>\n<li>Horizontal nystagmus&nbsp;</li>\n</ul>\n<p>&nbsp; &nbsp; <strong>2. Korsakoff psychosis:</strong>&nbsp;symptoms in addition to those of Wernicke's encephalopathy include:</p>\n<ul>\n<li>Memory loss</li>\n<li><strong>Confabulation</strong></li>\n</ul>\n<p>&nbsp; &nbsp; 3. <strong>Beriberi:&nbsp;</strong>It can present with sensorimotor peripheral neuropathy, and muscle weakness <strong>(dry beriberi)</strong> or tachycardia, cardiomegaly, high-output cardiac failure <strong>(wet beriberi).</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old woman presented with a painless palpable lump in her left breast. She had sustained a traumatic blow to her left breast 1 month back. Mammography showed a radiolucent cystic lesion with rimmed calcification. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Lymphocytic mastopathy"
      },
      {
        "id": 2,
        "text": "Sclerosing adenosis"
      },
      {
        "id": 3,
        "text": "Fat necrosis"
      },
      {
        "id": 4,
        "text": "Hyalinized fibroadenoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The typical history of a breast lump following <strong>trauma</strong> and mammography findings of&nbsp;a <strong>radiolucent</strong> <strong>cystic</strong> lesion with <strong>rimmed calcification&nbsp;</strong>suggests a diagnosis of<strong>&nbsp;fat necrosis</strong>.</p>\n<p>About half the affected women with fat necrosis of the breast have a history of breast trauma or previous surgery. It&nbsp;can present as a <strong>painless</strong> palpable mass, skin thickening or retraction, or mammographic densities or calcifications.</p>\n<p>Histologically, necrotic adipose tissue with <strong>foamy macrophages</strong>, multinucleated <strong>giant cells</strong>,&nbsp;and chronic inflammatory cells are seen often with <strong>hemosiderin</strong> deposits, <strong>fibrosis</strong>,&nbsp;and calcification.</p>\n<p>The following image shows an area of fat necrosis within breast tissue.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc7a21d3c4f84155b98928926dd960ebx766x599.JPEG"
    ]
  },
  {
    "text": "A 16-year-old boy is admitted with fever, icterus, conjunctival suffusion and hematuria for 15 days. Which serological test should be done for diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Widal test"
      },
      {
        "id": 2,
        "text": "Microscopic agglutination test"
      },
      {
        "id": 3,
        "text": "Weil felix reaction"
      },
      {
        "id": 4,
        "text": "Paul Bunnell test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Microscopic agglutination test</strong>&nbsp;is used for diagnosis <strong>of Leptospirosis</strong>.</p>\n<p>History of fever with liver(icterus) and kidney(hematuria) involvement should arouse suspicion for leptospirosis (Weil's disease).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient complains of muscle weakness. It was reversed on the administration of neostigmine because _________",
    "choices": [
      {
        "id": 1,
        "text": "It blocks the action of acetylcholine"
      },
      {
        "id": 2,
        "text": "It interferes with the action of choline transferase"
      },
      {
        "id": 3,
        "text": "It interferes with the action of choline acetyl transferase"
      },
      {
        "id": 4,
        "text": "It interferes with the action of acetylcholine esterase"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Muscle weakness is improved by <strong>neostigmine </strong>as it interferes with the<strong> action of acetylcholine esterase.</strong></p>\n<p>Inhibition of acetylcholine esterase increases the acetylcholine levels in the synapse that can act on receptors over the large surface area and for more periods reducing the weakness.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17de91627d8047d984a749fcc6eac33fx1280x2234.JPEG"
    ]
  },
  {
    "text": "A 5-year-old boy is brought to OPD with complaints of pain over the forearm. On detailed examination, several wounds with cigarettes burns are found. X-ray showed a spiral fracture of the radius. Which of the following is least likely seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Subdural hematoma"
      },
      {
        "id": 2,
        "text": "Periosteal shearing"
      },
      {
        "id": 3,
        "text": "Multiple injuries at same stage of healing"
      },
      {
        "id": 4,
        "text": "Soft tissue swelling"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>battered baby syndrome</strong>. The classical feature of this condition is injuries inflicted are of <strong>different ages </strong>and in <strong>different stages of healing</strong>. This is due to the repetitive nature of child abuse.</p>\n<p>A battered child is one who has received <strong>repetitive physical injuries as a result of non-accidental\u00a0</strong><strong>violence, produced by a parent or guardian</strong>, there may also be deprivation of nutrition, care, and affection.</p>\n<p>This syndrome <strong>must be considered</strong> in any child:</p>\n<ul>\n<li>In whom the degree and type of injury varies with the history given</li>\n<li>When injuries are of different ages and in different stages of healing</li>\n<li>When there is a purposeful delay in seeking medical attention despite serious injury</li>\n<li>Who exhibits evidence of fracture of any bone, subdural hematoma, failure to thrive, soft tissue swelling or skin bruising</li>\n<li>Who dies suddenly</li>\n</ul>\n<p><span class=\"fontstyle0\"><strong>Skeletal survey</strong>, which includes the following, should be done in a case of suspected child abuse:</span></p>\n<ul>\n<li><span class=\"fontstyle0\">AP views of the entire skeleton</span></li>\n<li><span class=\"fontstyle0\">Dedicated views of hands and feet</span></li>\n<li><span class=\"fontstyle0\">Lateral views of the appendicular skeleton, skull, and spine</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Given below is a histological section of a biopsy taken from a farmer who presented with a vascular polypoidal mass protruding from his left nostril. What is the causative organism for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Klebsiella rhinoscleromatis"
      },
      {
        "id": 2,
        "text": "Rhinosporidium seeberi"
      },
      {
        "id": 3,
        "text": "Mycobacterium ulcerans"
      },
      {
        "id": 4,
        "text": "Rhizopus Oryza"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario along with the histology (showing <strong>sporangia)</strong> is suggestive of <strong>rhinosporidiosis </strong>caused by<strong>&nbsp;</strong><em><strong>Rhinosporidium seeberi.</strong></em></p>\n<p>Rhinoscleroma is caused by <em>Klebsiella rhinoscleromatis.</em></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/679c15db42d04cc79370103c56f60c76.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient with ptosis presented with retraction of the ptotic eyelid on chewing.  What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Oculomotor palsy"
      },
      {
        "id": 2,
        "text": "Third nerve misdirection syndrome"
      },
      {
        "id": 3,
        "text": "Abducens palsy"
      },
      {
        "id": 4,
        "text": "Marcus Gunn jaw-winking syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A patient with ptosis presented with retraction of the ptotic eyelid on chewing. The diagnosis is Marcus&ndash;Gunn jaw-winking phenomenon.</p>\n<ul>\n<li>About <strong>5%</strong> of all cases of <strong>congenital ptosis</strong> are associated with the Marcus&ndash;Gunn jaw-winking phenomenon.</li>\n<li>The vast majority are <strong>unilateral</strong>.</li>\n<li><strong>Etiology</strong>:<strong>&nbsp;</strong>a branch of the <strong>mandibular division</strong> of the <strong>fifth</strong> cranial nerve is <strong>misdirected</strong> to the levator muscle.</li>\n<li>Signs\n<ul>\n<li><strong>Retraction of the ptotic lid</strong> in conjunction with <strong>stimulation of the ipsilateral pterygoid muscles</strong> by <strong>chewing</strong>, <strong>sucking</strong>, opening the mouth, or contralateral jaw movement.</li>\n<li>Less common stimuli to winking include <strong>jaw protrusion</strong>, <strong>smiling</strong>, swallowing, and clenching of teeth.</li>\n<li><strong>Jaw-winking does not improve with age</strong> although patients may learn to mask it.</li>\n</ul>\n</li>\n</ul>\n<p><strong>Image</strong>:&nbsp;The woman cannot control her eyelids while drinking</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7dee4f8a38f34d9bae43f489f12a0038x466x313.PNG"
    ]
  },
  {
    "text": "An\u200b 8-year-old child had an unprovoked dog bite. Which of the following measures should be taken?",
    "choices": [
      {
        "id": 1,
        "text": "Withhold the vaccine and observe the dog for 10 days"
      },
      {
        "id": 2,
        "text": "No action needed"
      },
      {
        "id": 3,
        "text": "Kill the dog and send brain for biopsy"
      },
      {
        "id": 4,
        "text": "Give cell culture derived vaccine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>It is appropriate to give post-exposure prophylaxis immediately to reduce the chances of getting rabies by administering cell culture derived vaccine.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An epidemiologist is assessing an outbreak of acute diarrhoeal disease in a region. He wants to predict the virulence of the causative agent. Which of the following parameters will he use for this purpose?",
    "choices": [
      {
        "id": 1,
        "text": "Secondary attack rate"
      },
      {
        "id": 2,
        "text": "Case fatality rate"
      },
      {
        "id": 3,
        "text": "Survival rate"
      },
      {
        "id": 4,
        "text": "Incidence rate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Case fatality rate</strong> is used in this scenario as it is the most useful parameter to predict the <strong>virulence</strong> of an acute illness.&nbsp;It <strong>represents</strong> the<strong> killing power</strong> of disease.</p>\n<p>Note:</p>\n<p><strong>Case fatality rate</strong>&nbsp;is an&nbsp;<strong>incidence proportion</strong>&nbsp;and not a true rate as no time interval is used for its calculation.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are a field doctor at the site of an earthquake. You assist in rapidly classifying the injured on the basis of the likelihood of their survival and need for intervention. What is this process called?",
    "choices": [
      {
        "id": 1,
        "text": "Field care"
      },
      {
        "id": 2,
        "text": "Tagging"
      },
      {
        "id": 3,
        "text": "Rehabilitation"
      },
      {
        "id": 4,
        "text": "Triage"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The process of rapidly classifying the injured in a disaster on the basis of <strong>severity of injury</strong> and<strong> likelihood of survival</strong> with prompt medical intervention is called <strong>triage.</strong> It is carried out at the<strong> site of disaster</strong>.</p>\n<p><strong>Tagging </strong>is the identification of patients in a disaster with tags stating their name, age, place of origin, triage category, diagnosis, and initial treatment.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man was diagnosed with STEMI. He was admitted and given thrombolytic therapy. The next day he complained of palpitations and an ECG was taken. Which of the following drugs can be used to treat his condition?",
    "choices": [
      {
        "id": 1,
        "text": "Amiodarone"
      },
      {
        "id": 2,
        "text": "Verapamil"
      },
      {
        "id": 3,
        "text": "Flecainide"
      },
      {
        "id": 4,
        "text": "Propafenone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above ECG shows narrow QRS complex, irregular RR intervals, and absent P waves which are suggestive of&nbsp;<strong>atrial fibrillation</strong>. Among the given options, <strong>amiodarone</strong> can be administered in&nbsp;patients having atrial fibrillation with <strong>coronary&nbsp;or structural heart disease</strong>.</p>\n<p>Drugs for rhythm control in atrial fibrillation:</p>\n<p>In patients without structural heart disease, class I agents are used. Class I agents act by blocking the&nbsp;Na<sup>+</sup>&nbsp;channels leading to slower depolarization:</p>\n<ul>\n<li>Flecainide&nbsp;</li>\n<li>Propafenone</li>\n<li>Disopyramide</li>\n</ul>\n<p>In patients with coronary&nbsp;or structural heart disease, class III agents are used. Class III agents act by blocking the K<sup>+</sup>&nbsp;channels leading to slower repolarization causing increased refractory period:</p>\n<ul>\n<li>Amiodarone</li>\n<li>Dofetilide</li>\n<li>Sotalol</li>\n<li>Ibutilide</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c1ab596ecd41423a86eb2c076febefba.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da96986021754d1e8f8c7326e53a95f5x1280x2221.JPEG"
    ]
  },
  {
    "text": "An 11-year-old boy presented with steatorrhea and chronic diarrhea. An evaluation revealed delayed intellectual development and ataxia. Acanthocytes were seen on the peripheral blood smear. Ophthalmological examination showed the following. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gaucher's disease"
      },
      {
        "id": 2,
        "text": "Abetalipoproteinemia"
      },
      {
        "id": 3,
        "text": "Whipple's disease"
      },
      {
        "id": 4,
        "text": "Protein losing enteropathy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image showing <strong>retinitis</strong> <strong>pigmentosa</strong> and presence of <strong>acanthocytes</strong> along with the given clinical features is suggestive of&nbsp;<strong>abetalipoproteinemia.</strong></p>\n<p>Abetalipoproteinemia is a rare genetic disorder in which there is <strong>defective chylomicron formation</strong>. Chylomicrons are required for the absorption and transport of fats and fat-soluble vitamins.</p>\n<p>It presents in early childhood with steatorrhoea and diarrhea, hypolipidemia, failure to thrive, ataxia, sensory and motor neuropathies.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/319bb11a2839404f995b1c1a349a88e8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient is known to have mitral stenosis had an acute onset of weakness of the left arm which recovered completely in 10 days. The most likely diagnosis is _______",
    "choices": [
      {
        "id": 1,
        "text": "Transient ischemic attack"
      },
      {
        "id": 2,
        "text": "Ischemic stroke"
      },
      {
        "id": 3,
        "text": "Hemorrhagic stroke"
      },
      {
        "id": 4,
        "text": "Vasculitis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with mitral stenosis and acute onset weakness of the left arm is most likely to have had an <strong>ischemic stroke</strong>.&nbsp;Mitral stenosis is known to cause atrial fibrillation and is a common cause of cardioembolic stroke.</p>\n<p><strong>Transient ischemic attack(TIA)</strong>&nbsp;is a <strong>temporary</strong>, focal neurological deficit of sudden onset (stroke-like symptoms) owing to focal ischemia of the brain, retina or cochlea. It lasts for <strong>less than 24 hours</strong>. Most TIAs last for less than 1 hour to a few minutes. There is a <strong>high risk of developing an ischemic stroke</strong>&nbsp;after a TIA, especially for the first 3 months following a TIA.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following clinical symptoms are not observed in secondary adrenal insufficiency?",
    "choices": [
      {
        "id": 1,
        "text": "Pigmentation"
      },
      {
        "id": 2,
        "text": "Postural hypotension"
      },
      {
        "id": 3,
        "text": "Hypoglycemia"
      },
      {
        "id": 4,
        "text": "Lassitude"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Pigmentation is not observed&nbsp;in&nbsp;secondary adrenal insufficiency.</p>\n<p>In secondary adrenal insufficiency,&nbsp;the skin is characterized by an <strong>alabaster-like paleness</strong> due to the&nbsp;<strong>lack of ACTH </strong>secretion.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Four weeks after a head injury, a 70-year-old patient developed altered sensorium and presented with headache and  vomiting. Fundus examination showed papilledema. The probable diagnosis is ____.",
    "choices": [
      {
        "id": 1,
        "text": "Extradural hematoma (EDH)"
      },
      {
        "id": 2,
        "text": "Chronic subdural hematoma (SDH)"
      },
      {
        "id": 3,
        "text": "Subacute SDH"
      },
      {
        "id": 4,
        "text": "Acute SDH"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The probable diagnosis in the above scenario is <strong>chronic subdural hematoma (SDH)</strong>.</p>\n<p>Chronic SDH is a collection of blood breakdown products that are at least <strong>2 to 3 weeks old.&nbsp;</strong></p>\n<p>It may arise from <strong>minor head injury</strong>.&nbsp;<strong>Alcoholics</strong>, the <strong>elderly</strong>,&nbsp;and <strong>patients on anticoagulation</strong> are at higher risk.</p>\n<div class=\"page\" title=\"Page 1747\">&nbsp;</div>\n<p>Imaging reveals diffuse <strong>hypodensity </strong>overlying the brain surface.</p>\n<p>A <strong>chronic SDH &gt;1 cm </strong>or any symptomatic SDH should be <strong>surgically drained.</strong></p>\n<table width=\"640\">\n<tbody>\n<tr>\n<td width=\"231\">\n<p><strong>Nomenclature </strong></p>\n</td>\n<td width=\"409\">\n<p><strong>Time </strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"231\">\n<p><strong>Acute&nbsp; SDH </strong></p>\n</td>\n<td width=\"409\">\n<p>&lt;3 days</p>\n</td>\n</tr>\n<tr>\n<td width=\"231\">\n<p><strong>Subacute SDH </strong></p>\n</td>\n<td width=\"409\">\n<p>4&ndash;21 days</p>\n</td>\n</tr>\n<tr>\n<td width=\"231\">\n<p><strong>Chronic SDH </strong></p>\n</td>\n<td width=\"409\">\n<p>&gt; 21 days</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old male has recently undergone exploratory laparotomy for acute abdomen. On 5th postoperative day, he is febrile. The sutured site is erythematous and on the removal of 2 skin sutures, there is a leakage of intestinal contents through the wound.  An electrolyte panel done on him showed hyponatremia, hypokalemia and metabolic acidosis. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gastric fistula"
      },
      {
        "id": 2,
        "text": "Duodenal fistula"
      },
      {
        "id": 3,
        "text": "Sigmoid fistula"
      },
      {
        "id": 4,
        "text": "Rectal fistula"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is suggestive of an <strong>enterocutaneous fistula.</strong> From the electrolyte panel showing <strong>hyponatremia, hypokalemia and metabolic acidosis,</strong> a diagnosis of <strong>duodenal fistula</strong> can be made.&nbsp;</p>\n<p>Enterocutaneous fistulas are classified according to their location and volume of daily output.</p>\n<ul>\n<li><strong>Proximal fistulas are associated with the higher output, greater fluid and electrolyte loss, and greater loss of digestive capacity.</strong></li>\n<li>Distal fistulas tend to have lower output, making them easier to manage and more likely to close spontaneously.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presents to the emergency department with complaints of severe abdominal pain and 3 episodes of vomiting in the past 9 hours. He says that the pain radiates to the back and is partially relieved by bending forwards. The abdominal radiograph of the patient is given below. What is the sign that is seen in the radiograph?",
    "choices": [
      {
        "id": 1,
        "text": "Sentinel loop sign"
      },
      {
        "id": 2,
        "text": "Colon cut-off sign"
      },
      {
        "id": 3,
        "text": "Renal halo sign"
      },
      {
        "id": 4,
        "text": "Obliteration of psoas shadow"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given erect abdominal x-ray shows the <strong>colon cut-off sign</strong>, which is seen in <strong>acute pancreatitis.</strong></p>\n<p>The<strong> colon cut-off sign </strong>describes gaseous distension seen in the<strong> proximal colon </strong>associated with the narrowing of the <strong>splenic flexure</strong>. Though originally described in abdominal radiographs, this sign has also been demonstrated in contrast enema and computed tomography.</p>\n<p>This appearance results from an <strong>inflammatory process </strong>extending from the pancreas into the<strong> phrenico-colic ligament</strong> via the <strong>transverse mesocolon</strong>. This causes <strong>functional spasm</strong> of the splenic flexure, resulting in the colon cut-off sign.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Sentinel loop sign </strong>refers to the generalized or localized ileus of the intestine adjacent to the pancreas. A sentinel loop refers to a short segment of <strong>adynamic ileus</strong> adjacent to an intra-abdominal inflammatory process. It is seen in <strong>acute pancreatitis.</strong></p>\n<p>Option C: <strong>Renal halo sign</strong> is produced by the apparent enhancement of the perirenal fat by an adjacent retroperitoneal exudate in the pararenal space. It is seen in acute pancreatitis.</p>\n<p>Option D: <strong>Obliteration of the psoas shadow</strong> on imaging often indicates <strong>retroperitoneal pathology</strong>, such as infection, haemorrhage, or malignancy. It can suggest<strong> psoas abscess </strong>or<strong> inflammation</strong> in adjacent structures.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/12e23350719e4306964902fa91bb5171.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man with a history of coronary artery disease presented with complaints of recurrent postprandial abdominal pain associated with vomiting and diarrhea. Abdominal examination shows no tenderness or rigidity. What could be the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ischemic colitis"
      },
      {
        "id": 2,
        "text": "Wilkie's syndrome"
      },
      {
        "id": 3,
        "text": "Nutcracker's syndrome"
      },
      {
        "id": 4,
        "text": "Chronic mesenteric ischemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Postprandial abdominal pain</strong> in the background of&nbsp;<strong>CAD</strong> is suggestive of <strong>chronic mesenteric ischemia(CMI).</strong> The most common cause of chronic mesenteric ischemia is <strong>atherosclerotic disease.</strong></p>\n<p>The three classic symptoms&nbsp;pathognomonic of CMI are:</p>\n<ul>\n<li><strong>Postprandial pain</strong> (crampy periumbilical abdominal pain within 30 minutes of meals)</li>\n<li><strong>Food fear</strong> (foods that precipitate symptoms are avoided by the patient and unintentional weight loss can result)</li>\n<li>Significant <strong>weight loss</strong></li>\n</ul>\n<p>CT angiogram demonstrates both the arterial lesion and the patterns of collateral blood flow.</p>\n<p><strong>Percutaneous transluminal angioplasty (PTA)</strong> and stenting have gained acceptance as the<strong> first line of therapy</strong> for mesenteric ischemia.<strong>&nbsp;</strong></p>\n<p><strong>Nutcracker syndrome </strong>refers to compression of the left renal vein, most commonly between the aorta and the superior mesenteric artery<strong>, </strong>with impaired blood outflow often accompanied by distention of the distal portion of the vein. Most commonly presents with hematuria, flank pain, and varicoceles.&nbsp;</p>\n<p>CT image of nutcracker syndrome showing compression of the LRV between the aorta and the SMA:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8cb06614174b494889e92bc1f52afec3x1074x775.PNG"
    ]
  },
  {
    "text": "A 50-year-old woman presents to her gynecologist with postcoital bleeding. She was diagnosed as a case of carcinoma cervix stage IB after evaluation. Treatment of choice in this patient is____",
    "choices": [
      {
        "id": 1,
        "text": "Type 1 hysterectomy"
      },
      {
        "id": 2,
        "text": "Type 2 hysterectomy"
      },
      {
        "id": 3,
        "text": "Type 3 hysterectomy"
      },
      {
        "id": 4,
        "text": "Type 4 hysterectomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Type 3 hysterectomy/</strong>Radical hysterectomy, pelvic lymphadenectomy, para aortic lymph node evaluation &ndash; is the <strong>treatment of choice in Stage 1 B.</strong></p>\n<div class=\"page\" title=\"Page 697\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Stage IB lesions are defined as those extending past the limits of microinvasion yet still confined to the cervix. T stage is subcategorized either as <strong>IB1</strong> if tumors measure&lt;2cm&nbsp; or as <strong>IB2</strong> if they measure 2cm to &lt;4cm.</p>\n</div>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are prescribing estrogen therapy for a woman with hot flushes. What is the minimum number of days in a month during which you should combine it with progesterone?",
    "choices": [
      {
        "id": 1,
        "text": "8 days"
      },
      {
        "id": 2,
        "text": "10 days"
      },
      {
        "id": 3,
        "text": "12 days"
      },
      {
        "id": 4,
        "text": "14 days"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<div class=\"page\" title=\"Page 87\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>A minimum of <strong>12</strong> <strong>days</strong> (in a month) of progesterone must be added to estrogen therapy. This reduces the risk of endometrial cancer to 2%.&nbsp;</p>\n<p>The risk of cancer with estrogen therapy is dose and duration-dependent.&nbsp;<strong>Combined</strong> estrogen and progesterone provides better <strong>protection</strong> against <strong>endometrial cancer.&nbsp;</strong></p>\n<p>Tibolone is a safe drug and does not cause endometrial hyperplasia.&nbsp;</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A pregnant woman with pre-eclampsia is started on prophylactic MgSO4 in view of signs of impending eclampsia. An hour later, examination reveals RR - 16 breaths/minute and absent patellar reflexes. What is her plasma concentration of MgSO4 most likely to be?",
    "choices": [
      {
        "id": 1,
        "text": "6-8 mEq/L"
      },
      {
        "id": 2,
        "text": "14-16 mEq/L"
      },
      {
        "id": 3,
        "text": "16-30 mEq/L"
      },
      {
        "id": 4,
        "text": "10-12 mEq/L"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Patellar reflexes disappear</strong> when plasma magnesium concentration reaches 10 mEq/L. As there is no respiratory&nbsp;depression, the plasma concentration is likely to be <strong>10-12&nbsp;mEq/L.</strong></p>\n<p>The disappearance of the<strong> patellar reflex</strong> is the<strong> first sign </strong>of impending&nbsp;magnesium&nbsp;<strong>toxicity.&nbsp;</strong>MgSO4 is prophylactically used in impending eclampsia,&nbsp;severe pre-eclampsia, and&nbsp;HELLP syndrome.</p>\n<table style=\"height: 156px;\" width=\"407\">\n<tbody>\n<tr>\n<td style=\"width: 168.453125px;\"><strong>Signs of magnesium toxicity</strong></td>\n<td style=\"width: 222.5625px;\"><strong>Plasma concentrations of magnesium (mEq/L)</strong></td>\n</tr>\n<tr>\n<td style=\"width: 168.453125px;\">Loss of patellar reflex</td>\n<td style=\"width: 222.5625px;\">10&ndash;12</td>\n</tr>\n<tr>\n<td style=\"width: 168.453125px;\">Respiratory depression</td>\n<td style=\"width: 222.5625px;\">12-13&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 168.453125px;\">Cardiac arrest</td>\n<td style=\"width: 222.5625px;\">&gt;30&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A neonate is being evaluated for the finding shown in the image. The mother's prenatal history is significant for viral exanthem in early pregnancy.  On examination, a grade 3 murmur is heard on auscultation. Which of the following is the most likely cause of this patient's murmur?",
    "choices": [
      {
        "id": 1,
        "text": "Patent ductus arteriosus"
      },
      {
        "id": 2,
        "text": "Ventricular septal defect"
      },
      {
        "id": 3,
        "text": "Atrial septal defect"
      },
      {
        "id": 4,
        "text": "Pulmonary stenosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows a bilateral cataract, which along with the antenatal history of viral exanthem is suggestive of <strong>c</strong><strong>ongenital rubella syndrome</strong>.&nbsp;<strong>Patent ductus arteriosus </strong>(PDA) is the <strong>most common</strong> congenital heart disease associated with rubella, followed by pulmonary artery stenosis (PS).</p>\n<p>Frequency of heart disease in congenital rubella: PDA &gt; PS &gt; VSD &gt; ASD.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2e82cd7ad45947668a21f105d539a4ed.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 6-year-old boy presented with the following findings. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Milwaukee shoulder"
      },
      {
        "id": 2,
        "text": "Sprengel deformity"
      },
      {
        "id": 3,
        "text": "Long thoracic nerve injury"
      },
      {
        "id": 4,
        "text": "Klippel-Feil syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows an&nbsp;<strong>upward elevation of the scapula relative&nbsp;to the thoracic cage</strong> characteristically seen in <strong>Sprengel deformity</strong>.</p>\n<p><strong>Sprengel deformity</strong> is a <strong>congenital&nbsp;upward elevation </strong>of the<strong> scapula</strong>. It is&nbsp;due to the failure of the scapula to descend completely in embryonic life.</p>\n<p>The affected scapula is smaller, shaped differently, abnormally high, and somewhat prominent. Shoulder movements are usually painless. Abduction and elevation of shoulders may be limited due to fixation of the scapula.</p>\n<p>The&nbsp;<strong>Cavendish classification</strong> is used to grade the severity of Sprengel deformity.&nbsp;</p>\n<p>If the deformity is mild, no treatment is required. In severe deformity, surgery may be indicated. These procedures include:</p>\n<ul>\n<li>Green procedure</li>\n<li>Woodward procedure</li>\n<li>Mears procedure</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4c031edc0772462badbaa3df9e653ce5.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 70-year-old woman was evaluated for memory problems. Her husband first noticed the issue about  4 or 5 years back but attributed the symptoms to old age. Gradually her forgetfulness worsened and began to interfere with her daily activities such as housekeeping. A month ago, she got lost while returning from the church which she had been visiting regularly for the past 30 years. No personality changes, rigidity, or gait disturbances were observed. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Alzheimer's disease"
      },
      {
        "id": 2,
        "text": "Vascular dementia"
      },
      {
        "id": 3,
        "text": "Dementia with Lewy bodies"
      },
      {
        "id": 4,
        "text": "Pick's disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of <strong>insidious loss of episodic memory</strong> followed by <strong>slowly progressive dementia</strong> is suggestive of <strong>Alzheimer&rsquo;s disease.</strong>&nbsp;This&nbsp;primarily involves the neurodegeneration of the cholinergic system<strong>.</strong></p>\n<p>Alzheimer's disease is the <strong>most common </strong>cause of dementia, followed by&nbsp;vascular&nbsp;dementia and&nbsp;Lewy body dementia.</p>\n<p>Option B: Absence of prior cerebrovascular accident history or focal neurological deficits rules out vascular dementia. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\n<p>Option C: Absence of gait disturbance, rigidity (Parkinsonism) rules out dementia with Lewy bodies.&nbsp;</p>\n<p>Option D: Absence of early personality changes rules out Pick's disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old male in kidney failure with a serum creatinine of 2.1 mg/dl is scheduled for surgery. Which of the following muscle relaxants can be used?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2 and 4"
      },
      {
        "id": 2,
        "text": "3,4 and 5"
      },
      {
        "id": 3,
        "text": "2 and 4"
      },
      {
        "id": 4,
        "text": "1 only"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p style=\"text-align: justify;\"><strong>Succinylcholine, atracurium</strong> and<strong> cis-atracurium</strong> can be used in this patient who has a&nbsp;<strong>renal failure</strong> with<strong> elevated serum creatinine</strong>(normal value- 0.8&ndash;1.3 mg/dL in men and 0.6&ndash;1 mg/dL in women).</p>\n<p style=\"text-align: justify;\">Succinylcholine can be<strong> safely administered</strong> to patients with <strong>diminished </strong>or<strong> absent kidney function</strong> provided serum<strong> potassium levels </strong>are<strong> normal</strong>. If the serum potassium is increased, then a non-depolarizing muscle relaxant like atracurium or cisatracurium which is non-dependent on renal excretion is to be used. <strong>Atracurium </strong>or <strong>cisatracurium</strong> undergo <strong>Hofmann elimination</strong> which is non-enzymatic spontaneous degradation.</p>\n<p style=\"text-align: justify;\">Pancuronium is almost entirely dependent on the kidney for excretion (60&ndash;90%). Pancuronium has a prolonged elimination half-life in renal failure patients and thus should be used very cautiously.</p>\n<p style=\"text-align: justify;\">40-60% of d-tubocurarine is excreted via the kidney and so prolonged effects are seen with renal insufficiency</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 52-year-old male presents with the following lesion. DNA Analysis from tissue samples for T-cell receptor analysis showed clonal rearrangements of the T-cell receptor genes. What is the possible diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Follicular mucinosis"
      },
      {
        "id": 2,
        "text": "Bowen's disease"
      },
      {
        "id": 3,
        "text": "Psoriasis"
      },
      {
        "id": 4,
        "text": "Mycosis fungoides"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical features along with the characteristic investigation of T-cell receptor analysis showing clonal rearrangement of the T-cell receptor(TCR) is diagnostic of <strong>Mycosis fungoides</strong>.</p>\n<ul>\n<li>Mycosis fungoides is characterized by <strong>polymorphic patches and plaques</strong> usually involving limb/girdle sites, the breast and especially the <strong>buttock area</strong>.</li>\n<li>It is characterized by subtle, <strong>fine, scaly</strong> and often slightly <strong>atrophic</strong> (wrinkled) <strong>erythematous</strong> patches.</li>\n</ul>\n<p>T\u2010cell receptor gene analysis consists of the&nbsp;<strong>analysis of DNA</strong> from tissue samples for the detection of <strong>clonal rearrangements of the TCR genes</strong> as a marker of a <strong>monoclonal T\u2010cell population</strong>. T\u2010cell clones can be detected in a proportion (<strong>70%</strong> overall) of skin biopsies from patients with early\u2010stage disease and are almost invariable in patients with later stages of the disease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b36f894a13634700af5d13749ca256ea.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old male with Marfanoid features presented with sudden onset breathlessness. The chest X-ray is given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pneumothorax"
      },
      {
        "id": 2,
        "text": "Pleural effusion"
      },
      {
        "id": 3,
        "text": "Consolidation"
      },
      {
        "id": 4,
        "text": "Fibrosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The X-ray shows left-sided pneumothorax with the partial collapse of the left lung. Best X-ray view to diagnose pneumothorax is <strong>PA view in full expiration</strong>.</p>\n<p>Chest radiograph in spontaneous pneumothorax demonstrates: &nbsp;</p>\n<ul>\n<li>Visible visceral pleural edge is seen as a very thin, sharp white line</li>\n<li>No lung markings are seen peripheral to this line</li>\n<li>The peripheral space is radiolucent compared to the adjacent lung.</li>\n<li>The lung may completely collapse.</li>\n<li>The mediastinum should not shift away from the pneumothorax unless a&nbsp;tension pneumothorax&nbsp;is present.</li>\n<li>Subcutaneous emphysema&nbsp;and&nbsp;pneumomediastinum&nbsp;may also be present.</li>\n<li>The&nbsp;<strong>deep sulcus sign</strong>&nbsp;on a supine chest radiograph is an indication of a&nbsp;pneumothorax. In a supine film (common in the ICU), it may be the only indication of a pneumothorax because air collects anteriorly and basally, within the nondependent portions of the pleural space, as opposed to the apex when the patient is upright. <strong>The costophrenic angle is abnormally deepened when the pleural air collects laterally, producing the deep sulcus sign.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/418446474e8641ff891befcc49948aa5.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/c27586d1465b4a29a09580df5a7e2121x641x650.PNG"
    ]
  },
  {
    "text": "A patient with carcinoma endometrium is treated with pelvic external beam irradiation. Which of the following organs is likely to be affected the most?",
    "choices": [
      {
        "id": 1,
        "text": "Ovary"
      },
      {
        "id": 2,
        "text": "Vagina"
      },
      {
        "id": 3,
        "text": "Bladder"
      },
      {
        "id": 4,
        "text": "Rectum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Among the given options, the <strong>ovary</strong> is most likely to be affected as it is the <strong>most radiosensitive</strong> organ.&nbsp;</p>\n<p>Radiosensitivity of pelvic organs is as follows:&nbsp;<strong>ovary&gt;rectum&gt;bladder&gt;vagina.&nbsp;</strong>Radiation tolerance dose for ovary is 2-3 Gy whereas vagina 90 Gy. Hence, among the given options, the vagina is the most radioresistant organ.</p>\n<p>The radiation dose necessary to induce ovarian failure is age-dependent. A single dose of 3-4 Gray can induce amenorrhea in almost all women &gt;40 yrs of age. In young women, oogenesis is much less sensitive to radiation as compared to the elderly.&nbsp;</p>\n<p>Radiosensitivity of various tissues is summed up in the table given below:&nbsp;</p>\n<table style=\"height: 292px; width: 488px;\">\n<tbody>\n<tr>\n<td style=\"width: 122.156px;\">&nbsp;</td>\n<td style=\"width: 185px;\"><strong>Most radiosensitive</strong></td>\n<td style=\"width: 158.844px;\"><strong>Least radiosensitive</strong></td>\n</tr>\n<tr>\n<td style=\"width: 122.156px;\"><strong>Tissue</strong></td>\n<td style=\"width: 185px;\">Bone marrow, Gonads</td>\n<td style=\"width: 158.844px;\">Nervous tissue, Muscle fibers</td>\n</tr>\n<tr>\n<td style=\"width: 122.156px;\"><strong>Blood cells</strong></td>\n<td style=\"width: 185px;\">Lymphocytes</td>\n<td style=\"width: 158.844px;\">Platelets</td>\n</tr>\n<tr>\n<td style=\"width: 122.156px;\"><strong>Stages of cell cycle</strong></td>\n<td style=\"width: 185px;\">G2M interphase</td>\n<td style=\"width: 158.844px;\">S phase</td>\n</tr>\n<tr>\n<td style=\"width: 122.156px;\"><strong>Cell types</strong></td>\n<td style=\"width: 185px;\">Rapidly dividing</td>\n<td style=\"width: 158.844px;\">Quiescent</td>\n</tr>\n<tr>\n<td style=\"width: 122.156px;\"><strong>Ocular structure</strong></td>\n<td style=\"width: 185px;\">Lens</td>\n<td style=\"width: 158.844px;\">Sclera</td>\n</tr>\n<tr>\n<td style=\"width: 122.156px;\"><strong>Layer of retina</strong></td>\n<td style=\"width: 185px;\">Rods</td>\n<td style=\"width: 158.844px;\">Ganglion cell layer</td>\n</tr>\n</tbody>\n</table>\n<p>The skin is most commonly affected due to radiation. Stratum basalis is the layer of the skin most affected.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 034 (Clinical)';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>