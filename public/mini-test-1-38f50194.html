<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 1 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2022-23
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 5-year-old child is crying uncontrollably and is complaining of ear pain. He has a high-grade fever, cold, and nose block. The otoscopic examination showed the following finding. Which of the following organisms is the most common cause of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Moraxella catarrhalis"
      },
      {
        "id": 2,
        "text": "Streptococcus pneumoniae"
      },
      {
        "id": 3,
        "text": "Haemophilus influenzae"
      },
      {
        "id": 4,
        "text": "Staphylococcus aureus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical features of <strong>severe ear pain, fever, and cold</strong> with the otoscopic image showing <strong>red and bulging tympanic membrane</strong>\u00a0are likely to be <strong>acute suppurative otitis media</strong>. <em><strong>Streptococcus pneumoniae</strong></em> is the\u00a0most common cause of this condition. Other organisms that can cause these are:</p>\n<ul>\n<li><em><strong> Haemophilus influenzae</strong></em></li>\n<li><em><strong> Moraxella catarrhalis</strong></em></li>\n<li><em>Streptococcus pyogenes</em></li>\n<li><strong><em>Staphylococcus aureus</em></strong></li>\n<li><em>Pseudomonas aeruginosa</em></li>\n</ul>\n<p>Clinical features: The child may present with a cold, fever, and earache. If the tympanic membrane ruptures, ear discharge might also be there.</p>\n<p>In the stage of presuppuration, there might be a leash of blood vessels that appear along with the handle of the malleus and at the periphery of the tympanic membrane giving it a <strong>cart-wheel appearance</strong>. Later, the entire tympanic membrane becomes red.</p>\n<p>Management:</p>\n<p>Since the most common organism responsible are<em>\u00a0<strong>Streptococcus pneumonia\u00a0</strong></em>and\u00a0<em>Haemophilus influenza</em>, antibiotics should be started. The effective drugs in acute otitis media are <strong>ampicillin</strong> (50 mg/kg/day in four divided doses) and <strong>amoxicillin</strong> (40 mg/kg/day in three divided doses).</p>\n<p><strong>Decongestant nasal drops</strong>- ephedrine, oxymetazoline, and xylometazoline nasal drops can be used to decrease the edema of the eustachian tube, and promote middle ear ventilation.</p>\n<p><strong>Oral nasal decongestants</strong> like pseudoephedrine in combination with an antihistamine are effective in treating nasal blockade.</p>\n<p><strong>Analgesics and antipyretics</strong> are used to relieve pain and fever</p>\n<p>If there is ear discharge, it has to be mopped with sterile cotton buds. An antibiotic wick may also be inserted.</p>\n<p><strong>Myringotomy:</strong>\u00a0It is incising the eardrum to evacuate pus and is indicated when the drum is bulging and there is acute pain, incomplete resolution despite antibiotics, persistent conductive hearing loss, and persistent effusion beyond 12 weeks.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fe537394c2744585acb91a66369ac282.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A primigravida presents with lower abdominal pain at 36 weeks of gestation and assumes it to be labor pain. Which of the following statements is incorrect about false labor pain?",
    "choices": [
      {
        "id": 1,
        "text": "More commonly experienced by primigravidae than multigravidae"
      },
      {
        "id": 2,
        "text": "It is associated with the formation of a bag of waters"
      },
      {
        "id": 3,
        "text": "Contractions are irregular and unpredictable"
      },
      {
        "id": 4,
        "text": "Pain is relieved by enema and sedation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The incorrect statement about false labor pain is that it is associated with the<strong> formation </strong>of a <strong>bag of waters. True labor pains</strong> are associated with the formation of the bag of waters.&nbsp;</p>\n<p><strong>False labor pain </strong>is characterized by&nbsp;<strong>dull, irregular</strong>, and <strong>unpredictable&nbsp;</strong>pain&nbsp;confined to the lower abdomen and groin. It is <strong>not associated</strong> with the <strong>hardening</strong> of the uterus or<strong> bag of waters</strong> formation and does not cause <strong>cervical dilation.</strong> Usually, it is <strong>relieved with enema</strong> or sedatives. It is also known as <strong>Braxton Hicks contractions</strong>.</p>\n<p>It is more common in<strong> primigravidae</strong> than in parous women and&nbsp;usually appears 1 or 2 weeks&nbsp;prior to the onset of true labor pain in primigravidae and a few days prior in multiparae.&nbsp;</p>\n<p>True labor pain is characterized by pain in the lower abdomen and back, radiating to the thighs. It occurs due to<strong> painful uterine contractions</strong> at <strong>regular intervals&nbsp;</strong>with <strong>increasing frequency, intensity&nbsp;</strong>and&nbsp;<strong>duration</strong>.&nbsp;It is associated with the&nbsp;<strong>show</strong> (cervical mucus plug with blood),&nbsp;<strong>progressive effacement</strong> and <strong>dilatation</strong> of the cervix and <strong>descent</strong> of the presenting part.&nbsp;It is <strong>not relieved</strong> by <strong>enema</strong> or <strong>sedatives</strong>.</p>\n<p>A <strong>bag of waters </strong>refers to the lower pole of the fetal membranes containing <strong>liquor amnii</strong> which&nbsp;bulges into the cervical canal below the presenting part.&nbsp;During uterine contraction, the bag becomes tense and convex due to the rise in intra-amniotic pressure and disappears completely after the contractions. This is almost a certain sign of the onset of <strong>true labor.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the stage of senile cataract depicted in the given image.",
    "choices": [
      {
        "id": 1,
        "text": "Intumescent cataract"
      },
      {
        "id": 2,
        "text": "Mature senile cataract"
      },
      {
        "id": 3,
        "text": "Morgagnian cataract"
      },
      {
        "id": 4,
        "text": "Sclerotic type of hypermature cataract"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows the characteristic appearance of\u00a0<strong>Morgagnian hypermature cataract</strong>.</p>\n<p><strong>Morgagnian hypermature cataract\u00a0</strong>is characterized by the\u00a0<strong>liquefaction</strong>\u00a0of the entire\u00a0<strong>cortex.</strong>\u00a0The\u00a0lens is converted into a\u00a0<strong>bag of milky fluid</strong>. The\u00a0<strong>small, brownish nucleus</strong>\u00a0settles at the\u00a0<strong>bottom</strong>, its\u00a0<strong>position altering\u00a0</strong>with a\u00a0change in the position of the head.</p>\n<p><strong>Senile Cataract </strong></p>\n<p><strong>Types: </strong></p>\n<ul>\n<li><strong>Cortical</strong> (<strong>soft</strong> cataract): 75%\u00a0\u00a0\u00a0</li>\n<li><strong>Nuclear</strong> (<strong>hard</strong> cataract): 25%</li>\n</ul>\n<p><strong>Cortical cataract </strong>is<strong>\u00a0</strong>further divided into the cuneiform and cupuliform types.</p>\n<table style=\"height: 178px; width: 468px;\">\n<tbody>\n<tr>\n<td style=\"width: 199.805px; text-align: center;\"><strong>Cuneiform </strong>(70%)</td>\n<td style=\"width: 239.602px; text-align: center;\"><strong>Posterior subcapsular/Cupuliform</strong> (5%)</td>\n</tr>\n<tr>\n<td style=\"width: 199.805px;\">\n<p><strong>Radial spoke-like</strong>\u00a0opacity starting in the periphery and extending centrally</p>\n</td>\n<td style=\"width: 239.602px;\">\n<p><strong>Central saucer-shaped</strong> opacity in the posterior cortex just below the capsule</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 199.805px;\">\n<p>Late visual loss</p>\n</td>\n<td style=\"width: 239.602px;\">\n<p>Early loss of visual acuity</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 199.805px;\">\u00a0</td>\n<td style=\"width: 239.602px;\">\n<p>Most visually handicapping senile cataract\u00a0</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/480b1f0f98b94bc182183a4faac59d8d.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a0c1593bf00e49c4ab371eb7c9b3c866x619x419.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6ed460ba1cda4c90ae7626e16d8f8667x620x451.PNG"
    ]
  },
  {
    "text": "Which of the following statements is incorrect regarding Mental Healthcare Act 2017?",
    "choices": [
      {
        "id": 1,
        "text": "Right to access mental health care and treatment"
      },
      {
        "id": 2,
        "text": "Advance directive by mentally ill persons"
      },
      {
        "id": 3,
        "text": "Prohibition of electroconvulsive therapy for minors"
      },
      {
        "id": 4,
        "text": "Criminalization of suicide attempts"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Mental Healthcare Act 2017 <strong>decriminalized suicide</strong> <strong>attempts</strong>.</p>\n<p>The Act states that&nbsp;a person who attempts suicide shall be presumed to be suffering from mental illness at that time and will not be punished under the Indian Penal Code.&nbsp;</p>\n<p>Other important features of Mental Healthcare Act 2017 are as follows:</p>\n<ul>\n<li>Every person has the <strong>right to access mental health care and treatment</strong> from services run by the government. These services should be affordable, easily accessible, and of good quality.</li>\n<li>A <strong>mentally ill person has the right to make an advance directive</strong>. It states how the person wants to be treated for the illness during a mental health situation and who shall be their nominated representative.</li>\n<li>Central and State mental health authorities are the administrative bodies to register, supervise, and maintain all mental health establishments.</li>\n<li>The Mental Health Review Commission and Board will be a quasi-judicial body that reviews the advance directives and advise the government on the protection of the rights of the mentally ill person.</li>\n<li>Electroconvulsive therapy (ECT) can be done only with the use of muscle relaxants and anesthesia.<strong> ECT </strong>is<strong> prohibited </strong>for<strong> minors</strong>.&nbsp;</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 4-month-old child was brought with repeated epileptic spasms. The child had reached his normal milestone at the age of 2\u2009months. But the parents noticed that he lost the ability to hold his head steadily and he recently could not track light or sound. What is the finding in the given EEG of this child?",
    "choices": [
      {
        "id": 1,
        "text": "Hypsarrhythmia"
      },
      {
        "id": 2,
        "text": "Burst suppression pattern"
      },
      {
        "id": 3,
        "text": "Spike and slow wave"
      },
      {
        "id": 4,
        "text": "Periodic lateralized epileptiform discharge"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given scenario is of&nbsp;<strong>infantile&nbsp;spasms</strong>,&nbsp;<strong>developmental regression</strong>&nbsp;and the EEG showing&nbsp;<strong>hypsarrhythmia</strong>&nbsp;is suggestive&nbsp;of&nbsp;West syndrome.&nbsp;</p>\n<p><strong>Hypsarrhythmia</strong> is an abnormal interictal pattern that consists of diffuse,<strong> high voltage, slow waves</strong> with a chaotic background of <strong>irregular, multifocal spikes and sharp waves.</strong> During the clinical spasm, there is a marked suppression of the EEG background (the <strong>electrodecremental response</strong>).</p>\n<p>Hypsarrhythmias are usually seen in <strong>epileptic spasms.</strong> These are characterized by a briefly sustained flexion or extension of predominantly proximal muscles, including truncal muscles.</p>\n<p>West syndrome&nbsp;is a rare type of epilepsy syndrome that begins in&nbsp;<strong>infancy</strong>. It is characterized by a triad of:</p>\n<ul>\n<li aria-level=\"1\">Infantile spasm (also called&nbsp;<strong>salaam spells</strong>)&nbsp;is a convulsive disease characterized by brief, symmetric axial muscle contraction (neck, trunk, and/or extremities).</li>\n<li aria-level=\"1\">Developmental regression</li>\n<li aria-level=\"1\">Hypsarrhythmia (Himalayan wave pattern) on EEG</li>\n</ul>\n<p>Treatment of West syndrome includes:</p>\n<ul>\n<li><strong>ACTH</strong></li>\n<li>Vigabatrin, if associated with&nbsp;<strong>tuberous sclerosis</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/04844edbef7d4e23acc28f855d615ed0.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/63e2e11ff38f46c7b43dcfe711b91107x480x600.JPEG"
    ]
  },
  {
    "text": "The maximum amount of air that can be expelled from the lungs after first filling the lungs to their maximum extent and then expiring to the maximum extent is equal to ____.",
    "choices": [
      {
        "id": 1,
        "text": "Functional residual capacity"
      },
      {
        "id": 2,
        "text": "Total lung capacity"
      },
      {
        "id": 3,
        "text": "Vital capacity"
      },
      {
        "id": 4,
        "text": "Inspiratory capacity"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The maximum amount of air that can be expelled from the lungs after first filling the lungs to their maximum extent and then expiring to the maximum extent is equal to the&nbsp;<strong>vital capacity</strong>&nbsp;of the lungs.</p>\n<p>The vital capacity is the <strong>sum</strong> of <strong>inspiratory reserve volume</strong>,<strong> tidal volume</strong>, and <strong>expiratory reserve volume</strong>. It is around <strong>4600</strong> <strong>mL</strong>.</p>\n<p>Option A:&nbsp;<strong>Functional residual capacity</strong> is the sum of expiratory reserve volume and residual volume, and it is the total amount of air remaining in the lungs after normal expiration. It is about <strong>2300</strong> <strong>mL</strong>.</p>\n<p>Option B: The <strong>total&nbsp;lung capacity</strong> is the maximum volume to which lungs can be expanded with the greatest effort. It is the sum of vital capacity and the residual volume and is about <strong>5800</strong> <strong>mL</strong>.</p>\n<p>Option D: The <strong>inspiratory capacity </strong>is the maximum amount of air inspired from the end-expiratory level and is about <strong>3500</strong> <strong>mL</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/783cb2d1d3b04cdc9ee1a201e2821cbcx799x276.JPEG"
    ]
  },
  {
    "text": "A man who got involved in a road traffic accident after consuming alcohol is brought to the emergency department. What is the minimum blood alcohol concentration to cause impairment of driving skills?",
    "choices": [
      {
        "id": 1,
        "text": "> 200 mg/dL"
      },
      {
        "id": 2,
        "text": "100-150 mg/dL"
      },
      {
        "id": 3,
        "text": "30-50 mg/dL"
      },
      {
        "id": 4,
        "text": "50-100 mg/dL"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>minimum blood alcohol concentration</strong>\u00a0to cause <strong>impairment of driving skills</strong> is\u00a0<strong>30-50 mg/dL</strong>.</p>\n<p>This is the reason that in India, the blood alcohol limit is set at 30 mg/dL, measured by a breathalyzer. Anyone driving over that limit is said to be driving under the influence.</p>\n<p>The effects of alcohol intoxication at various blood alcohol concentrations are listed below.</p>\n<table>\n<tbody>\n<tr>\n<td>Blood alcohol concentration (mg/dL)</td>\n<td style=\"text-align: center;\">Effects\u00a0</td>\n</tr>\n<tr>\n<td><strong>30-50</strong></td>\n<td><strong>Impairment of driving and similar skills</strong></td>\n</tr>\n<tr>\n<td>50-100</td>\n<td>Reduced inhibitions, slurred speech, laughter</td>\n</tr>\n<tr>\n<td>100-150</td>\n<td>Incoordination,\u00a0ataxia</td>\n</tr>\n<tr>\n<td>150-200</td>\n<td>Obvious drunkenness, nausea,\u00a0staggering gait</td>\n</tr>\n<tr>\n<td>200-300</td>\n<td>Vomiting, stupor</td>\n</tr>\n<tr>\n<td>300-350</td>\n<td>Stupor, coma, risk of aspirating vomitus</td>\n</tr>\n<tr>\n<td>350-450 and above</td>\n<td>Danger of death from respiratory paralysis</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A male patient presents with a history of back pain. He gives a history of pulling a muscle while lifting heavy weights. On examination, there is exaggerated lumbar lordosis and you perform the test as shown in the image below. Name the test performed.",
    "choices": [
      {
        "id": 1,
        "text": "Trendelenburg test"
      },
      {
        "id": 2,
        "text": "Thomas test"
      },
      {
        "id": 3,
        "text": "Ober's test"
      },
      {
        "id": 4,
        "text": "Allen\u2019s test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Thomas test</strong> is being performed in the given&nbsp;image above.&nbsp;</p>\n<p>Thomas test&nbsp;is used to detect&nbsp;<strong>fixed flexion deformity </strong>of the <strong>hip.&nbsp;</strong>Here, the affected hip is extended while the contralateral hip is held flexed, flattening and immobilizing the lumbar spine.</p>\n<p>Flexion deformity is seen in the&nbsp;<strong>initial stages</strong>&nbsp;of the disease. The patient keeps the hip in flexion as this is the position of ease and maximum joint capacity.&nbsp;<strong>Soft tissue contractures</strong> convert this into a <strong>fixed flexion deformity</strong>, making locomotion impossible.</p>\n<p>In an effort to bring the limb on the ground and to make locomotion possible, the&nbsp;<strong>lumbar spine</strong> undergoes <strong>exaggerated lordosis</strong>&nbsp;and thus&nbsp;conceals the fixed flexion deformity. This is revealed by the Thomas test. The&nbsp;<strong>easy passage </strong>of the<strong> examiner's hand </strong>between the <strong>bed </strong>and the <strong>back </strong>of the<strong> patient</strong> is considered a <strong>positive test&nbsp;</strong>as normally this is not possible.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:<strong> Trendelenburg test&nbsp;</strong>is used to <strong>assess</strong> the weakness or paralysis of the <strong>gluteus&nbsp;medius&nbsp;muscle</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2539606b8057459ba9ab49a08b0669df.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b88843c2b6c44506b767f1dba6bad190x1280x4280.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4a77f5e0ca743b89e96f59caacad8ecx1280x3351.JPEG"
    ]
  },
  {
    "text": "A 50-year-old man was recently diagnosed with adenocarcinoma of the colon. While explaining the pathogenesis of the disease to him, which of the following would you mention as the \"first hit\" in the classic adenoma-carcinoma sequence?",
    "choices": [
      {
        "id": 1,
        "text": "APC on Chromosome 5q21"
      },
      {
        "id": 2,
        "text": "KRAS on Chromosome 12p12"
      },
      {
        "id": 3,
        "text": "TP53 on Chromosome 17p13"
      },
      {
        "id": 4,
        "text": "LOH at Chromosome 18q21"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The mutation of the cancer suppressor gene\u00a0<strong><em>APC</em> on chromosome 5q21 </strong>is the\u00a0<strong>\"first hit\"\u00a0</strong>in the classical\u00a0<strong>adenoma-carcinoma sequence.\u00a0</strong></p>\n<p><strong>Adenocarcinoma</strong> of the <strong>colon</strong> is the <strong>most common malignancy</strong> of the<strong> GI tract</strong>. The pathogenesis of colon cancer can be explained by three distinct pathways of genomic instability:</p>\n<ol>\n<li>Chromosomal instability/APC-\u03b2-catenin pathway/<strong>Classic adenoma-carcinoma sequence</strong></li>\n<li>Microsatellite instability pathway (MSI)</li>\n<li>CpG island methylator phenotype pathway.</li>\n</ol>\n<div class=\"page\" title=\"Page 816\"><strong>Chromosomal instability/APC-\u03b2-catenin pathway/classic adenoma-carcinoma sequence</strong> is the <strong>most common pathway</strong>, accounting for 80% of sporadic cancers. The <strong>\"first-hit\"</strong> in this pathway is the <strong>inherited </strong>or<strong> acquired\u00a0mutation</strong> of the cancer suppressor gene\u00a0<em><strong>APC </strong></em>on<strong> chromosome 5q21. Both copies</strong> of the <em><strong>APC</strong></em> gene must be <strong>inactivated.</strong> The <strong>\"second hit\"</strong> is due to methylation abnormalities and inactivation of the normal <strong>\u03b2-catenin.</strong> The loss of the second <em>APC</em> allele follows the \"second hit.\" Mutations of <em><strong>KRAS </strong></em>on<strong> chromosome 12p12</strong>,\u00a0<em><strong>TP53 </strong></em>on<strong> chromosome 17p13</strong>,\u00a0and\u00a0<strong>LOH </strong>at<strong> chromosome 18q21</strong> are also involved in <strong>further steps</strong> of the\u00a0classic adenoma-carcinoma sequence.</div>\n<div class=\"page\" title=\"Page 816\">\u00a0</div>\n<div class=\"page\" title=\"Page 816\"><strong>Microsatellite instability pathway</strong> (MSI) occurs in patients with <strong>DNA mismatch repair deficiency</strong>, leading to the accumulation of mutations in microsatellite repeats. The main pathogenic mechanisms are <strong>mutations</strong> of <strong>type II TGF-\u03b2 receptor</strong>\u00a0leading to uncontrolled cell growth, and <strong>loss of pro-apoptotic BAX </strong>which may enhance the survival of genetically abnormal clones.</div>\n<div class=\"page\" title=\"Page 816\">\u00a0</div>\n<div class=\"page\" title=\"Page 816\"><strong>CpG island hypermethylation phenotype</strong> (CIMP) - In these tumors, the <strong><em>MLH1</em> promoter</strong> region is typically <strong>hypermethylated,</strong> thus reducing MLH1 expression and repair function.<strong> Activating mutations</strong> in the oncogene <em><strong>BRAF</strong></em> are common in these cancers.<em> <strong>KRAS </strong></em>and<strong><em> TP53</em> are not typically mutated.</strong> The combination of MSI, <em>BRAF</em> mutation, and methylation of specific targets, such as <em>MLH1</em>, is the signature of this pathway of carcinogenesis.</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with renal failure was diagnosed with invasive mucormycosis and was to be started on amphotericin B. Which formulation of amphotericin B would pose the highest risk of nephrotoxicity in him?",
    "choices": [
      {
        "id": 1,
        "text": "Liposomal amphotericin B"
      },
      {
        "id": 2,
        "text": "Conventional amphotericin B"
      },
      {
        "id": 3,
        "text": "Amphotericin B lipid complex"
      },
      {
        "id": 4,
        "text": "Amphotericin B colloidal dispersion"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Nephrotoxicity </strong>risk<strong>&nbsp;</strong>is<strong>&nbsp;</strong>highest<strong>&nbsp;</strong>with<strong>&nbsp;conventional amphotericin B.&nbsp;</strong></p>\n<p><strong>Conventional</strong> amphotericin B (C-AMB) is <strong>not</strong> a <strong>lipid-based</strong> formulation of amphotericin B<strong>.&nbsp;</strong>Amphotericin B is insoluble in water, hence C-AMB is formulated by complexing with bile salt deoxycholate to make it suitable for intravenous infusion<strong>.&nbsp;</strong>Amphotericin deoxycholate is FDA approved for the treatment of mucormycosis but t<span data-preserver-spaces=\"true\">he rationale behind the usage of&nbsp;<strong>liposomal amphotericin B</strong> over amphotericin deoxycholate in mucormycosis are:</span></p>\n<ul>\n<li><strong><span data-preserver-spaces=\"true\">Less nephrotoxic</span></strong><span data-preserver-spaces=\"true\">&nbsp;than amphotericin B deoxycholate</span></li>\n<li><strong><span data-preserver-spaces=\"true\">Better CNS penetration&nbsp;</span></strong><span data-preserver-spaces=\"true\">than amphotericin B deoxycholate or amphotericin B lipid complex</span></li>\n<li><strong><span data-preserver-spaces=\"true\">Better outcomes&nbsp;</span></strong><span data-preserver-spaces=\"true\">than with amphotericin B deoxycholate&nbsp;</span></li>\n</ul>\n<p><strong>Nephrotoxicity risk</strong> with amphotericin B&nbsp;formulations in decreasing order:</p>\n<ul>\n<li><strong>C-AMB</strong> &gt; Amphotericin B lipid complex (ABLC) &gt; Liposomal amphotericin B (L-AMB)</li>\n<li>All lipid formulations of amphotericin B (ABLC, L-AMB, Amphotericin B colloidal dispersion(ABCD)) are less nephrotoxic than conventional amphotericin B</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old male patient presents with pain during defecation along with the presence of blood-streaked stools. He has had a history of constipation for 5 months. On examination, a sentinel tag is present at the anal orifice. Due to extreme pain, a digital rectal examination is avoided. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fistula in ano"
      },
      {
        "id": 2,
        "text": "Anal fissure"
      },
      {
        "id": 3,
        "text": "Internal hemorrhoids"
      },
      {
        "id": 4,
        "text": "External hemorrhoids"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This case scenario with a history of chronic constipation, and the presence of sentinel tags on examination, suggests a diagnosis of\u00a0<strong>anal fissure</strong>.</p>\n<div class=\"page\" title=\"Page 1372\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>An anal fissure is a longitudinal split in the anoderm of the distal anal canal. A chronic anal fissure is frequently associated with:</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li><strong>Sentinel tag </strong>externally</li>\n<li>Hypertrophied <strong>anal papillae</strong>\u00a0internally</li>\n<li>Anal ulcer overlying the internal sphincter</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d14f8c599baf44dc9dfa86d317a3f99cx1280x1429.JPEG"
    ]
  },
  {
    "text": "The structure marked \"?\" in the image is composed of _____ cartilage.",
    "choices": [
      {
        "id": 1,
        "text": "Fibrous cartilage"
      },
      {
        "id": 2,
        "text": "Hyaline cartilage"
      },
      {
        "id": 3,
        "text": "Elastic cartilage"
      },
      {
        "id": 4,
        "text": "Yellow fibrocartilage"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">The structure marked \"?\" in the image is the <strong>thyroid cartilage</strong>, and it is composed of <strong>hyaline cartilage</strong>.</p>\n<p class=\"ng-binding\">Thyroid cartilage\u00a0is identified by the presence of superior and inferior horns, and its relation with the epiglottis and larynx. The given image shows a cut-open view of the larynx from the back, and here, the thyroid cartilage encases the larynx anteriorly. The stalk of the epiglottis is also seen attached to the inner surface of the thyroid cartilage.</p>\n<p>Hyaline cartilage is made up of chondrocytes and matrix:</p>\n<ul>\n<li>The chondrocytes in the deeper matrix are rounded in shape and may appear in groups of eight that originate from the mitotic divisions of a single chondroblast. These groups of cells are called\u00a0<strong>isogenous cell aggregates</strong>\u00a0or cell nests.</li>\n<li>The important components of the matrix are\u00a0<strong>type II collagen</strong>,\u00a0<strong>aggrecan</strong>\u00a0(proteoglycan), and\u00a0<strong>chondronectin</strong>\u00a0(glycoprotein).</li>\n<li>The matrix that immediately surrounds the chondrocytes is basophilic and is known as the territorial matrix, whereas the matrix that is more distant from the cells appears pale and is known as the\u00a0<strong>interterritorial matrix</strong>.</li>\n</ul>\n<p>Hyaline cartilage is found at various sites:</p>\n<ul>\n<li>Larger respiratory passages (nose, larynx, trachea, and bronchi)</li>\n<li>Thyroid cartilage</li>\n<li>Cricoid cartilage</li>\n<li>Base of the arytenoid cartilage</li>\n<li>Ventral end of ribs, where they articulate with the sternum</li>\n<li>Epiphyseal plate of long bones</li>\n<li>Articular cartilage of synovial joints\u00a0</li>\n<li>Temporary skeleton in embryo</li>\n</ul>\n<p>On microscopy, hyaline cartilage can be identified by the following characteristics:</p>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<ul>\n<li>Presence of chondrocytes within lacunae.</li>\n<li>Group of two or more chondrocytes, which are known as\u00a0<strong>isogenous cell aggregates</strong>\u00a0or\u00a0<strong>cell nests</strong></li>\n<li>Basophilic territorial matrix and pale interterritorial matrix</li>\n<li>Presence of perichondrium with outer fibrous and the inner cellular layer</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0c67afaad5fc4fcbac0add1852c7ae69.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7ac7f4aa81f74695a243ce4e21d274c7x1280x1514.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b6d317d4f815498caafaad4fa976537ex960x720.JPEG"
    ]
  },
  {
    "text": "A 20-year-old patient presents for advice regarding obesity. On multiple occasions over the past 4 months, she has eaten large amounts of food at night and felt disgusted, and guilty after. She is distressed about overeating but states that she can not control it. There is no history of vomiting. Her BMI is 35. Which of the following disorders is responsible for this patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Bulimia nervosa"
      },
      {
        "id": 2,
        "text": "Night eating disorder"
      },
      {
        "id": 3,
        "text": "Binge-eating disorder"
      },
      {
        "id": 4,
        "text": "Anorexia nervosa"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario with a patient having <strong>recurrent episodes </strong>of<strong> uncontrollable binge eating</strong> for <strong>over 3 months,</strong> associated with <strong>distress</strong> and feelings of <strong>guilt</strong> in the <strong>absence</strong> of <strong>inappropriate compensatory behavior</strong> such as vomiting, is suggestive of <strong>binge-eating disorder</strong>. It<span data-preserver-spaces=\"true\">&nbsp;is described as the consumption of unusually large amounts of food over a short period. People with this condition feel that they have no control over their eating. They are also concerned about their weight and eating habits.&nbsp;</span><span data-preserver-spaces=\"true\">It&nbsp;is the most common eating disorder.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">DSM-5 diagnostic criteria for Binge-eating disorder:</span></strong></p>\n<p style=\"padding-left: 30px;\"><span data-preserver-spaces=\"true\">A. Recurrent episodes of binge eating. An episode of binge eating is characterized by both the following:</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">1. Eating, in a discrete period, an amount of food that is larger than what most people would eat in a similar period under similar circumstances.</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">2. A sense of lack of control over eating during the episode (e.g., a feeling that one cannot stop eating or control what or how much one is eating).</span></p>\n<p style=\"padding-left: 30px;\"><span data-preserver-spaces=\"true\">B. The binge-eating episodes are associated with</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">1. Eating much more rapidly than normal.</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">2. Eating until feeling uncomfortably full.</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">3. Eating large amounts of food when not feeling physically hungry.</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">4. Eating alone because of feeling embarrassed by how much one is eating.</span></p>\n<p style=\"padding-left: 90px;\"><span data-preserver-spaces=\"true\">5. Feeling disgusted with oneself, depressed, or very guilty afterward.</span></p>\n<p style=\"padding-left: 30px;\"><span data-preserver-spaces=\"true\">C. Marked distress regarding binge eating is present.</span></p>\n<p style=\"padding-left: 30px;\"><span data-preserver-spaces=\"true\">D. The binge-eating occurs, on average, at least once a week for 3 months.</span></p>\n<p style=\"padding-left: 30px;\"><span data-preserver-spaces=\"true\">E. Binge eating is not associated with the recurrent use of inappropriate compensatory behavior as in bulimia nervosa and does not occur exclusively during bulimia nervosa or anorexia nervosa.</span></p>\n<p><span data-preserver-spaces=\"true\">&nbsp;</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Other options:</span></strong></p>\n<p><strong><span data-preserver-spaces=\"true\">Bulimia nervosa:</span></strong><span data-preserver-spaces=\"true\">&nbsp;People with bulimia nervosa perform&nbsp;</span><strong><span data-preserver-spaces=\"true\">compensatory behavior</span></strong><span data-preserver-spaces=\"true\">&nbsp;such as vomiting, laxative abuse, or excessive dieting after binge eating. The person maintains a normal BMI.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Night eating disorder: </span></strong>It<strong><span data-preserver-spaces=\"true\">&nbsp;</span></strong><span data-preserver-spaces=\"true\">is characterized by a large amount of food consumption after an evening meal. They generally have a little appetite during the day and suffer from <strong>insomnia</strong>. They are <strong>not overly concerned</strong> with their body image and weight and the amount of food consumed is lower than binge eating done in bulimia and binge eating disorders.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Anorexia nervosa: </span></strong>P<span data-preserver-spaces=\"true\">eople with Anorexia nervosa are&nbsp;</span><strong><span data-preserver-spaces=\"true\">underweight</span></strong><span data-preserver-spaces=\"true\">&nbsp;and have an excessive drive for thinness and<strong> intense fear of gaining weight.</strong></span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 18-year-old boy is rushed to the emergency department after having choked on a bone while eating. He is responsive but unable to speak. What is to be done next?",
    "choices": [
      {
        "id": 1,
        "text": "Bag and mask ventilation"
      },
      {
        "id": 2,
        "text": "Endoscopic removal"
      },
      {
        "id": 3,
        "text": "Deliver 5 backslaps and 5 chest compressions"
      },
      {
        "id": 4,
        "text": "Perform Heimlich maneuver"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In a choking <strong>child</strong> (more than 1 year old) or an <strong>adult,</strong> the first step to be done is to perform <strong>Heimlich</strong> maneuver which involves delivering <strong>abdominal thrusts.</strong></p>\n<p>The rescuer should stand or kneel behind the patient and wrap his arms around the patient&rsquo;s waist. A fist is made with one hand and using the other hand, the fist is driven into the patient&rsquo;s abdomen with a rapid, forceful upward thrust so as to dislodge the foreign body. This is continued until the foreign body is expelled or if the patient becomes unresponsive.</p>\n<p>If the patient becomes <strong>unresponsive</strong>, immediately <strong>start</strong> <strong>CPR</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7c96e24d3b1f4fafab682fe5a100eebex510x442.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7bbb754ab7d24e128f1d60c28afc9c8ax1280x2905.JPEG"
    ]
  },
  {
    "text": "A 56-year-old diabetic patient presented with complaints of fever, cough, and hemoptysis for a few weeks. On staining his sputum, gram-negative bacilli with the typical safety pin appearance were identified. Culture on Ashdown medium showed wrinkled, purple colonies. Which of the following could be the possible causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Burkholderia pseudomallei"
      },
      {
        "id": 2,
        "text": "Burkholderia mallei"
      },
      {
        "id": 3,
        "text": "Burkholderia cepacia"
      },
      {
        "id": 4,
        "text": "Paraburkholderia species"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical features of the patient, detection of gram-negative bacilli with safety pin appearance, and formation of wrinkled, purple colonies on culture are together suggestive of <strong>Whitmore's disease</strong>&nbsp;or&nbsp;<strong>melioidosis</strong>&nbsp;caused by&nbsp;<em><strong>Burkholderia pseudomallei</strong></em><strong>.</strong></p>\n<p>Infection with&nbsp;<em>B. pseudomallei</em>&nbsp;is acquired by contamination of abrasion wounds with soil and water containing the bacilli. Patients with underlying diseases like diabetes mellitus have an increased risk of acquiring the infection.</p>\n<p><strong>Melioidosis</strong>&nbsp;can be of two types:</p>\n<ul>\n<li>Acute&nbsp;- It causes <strong>acute pneumonia</strong> with upper lobe infiltrates or severe necrotizing disease. It can also <strong>mimic tuberculosis</strong> with fever, cough, and hemoptysis. It may lead to <strong>septicemia</strong>. Acute cases have a high case fatality rate.&nbsp;</li>\n<li>Chronic - It can lead to the development of multiple<strong> caseous or suppurative foci</strong>, with skin and <strong>subcutaneous abscesses</strong>. These can lead to <strong>lymphangitis</strong> and <strong>lymphadenopathy</strong>. It may involve bones and other internal organs.</li>\n</ul>\n<p>On microscopy, small, irregularly staining gram-negative bacilli can be demonstrated for diagnosis. <strong>Methylene blue stain</strong> shows a typical bipolar <strong>safety pin appearance</strong>. <strong>ELISA</strong> for IgM and IgG antibodies and&nbsp;<strong>indirect hemagglutination</strong> can be also used for diagnosis.&nbsp;</p>\n<p><strong>Treatment</strong> is divided into two stages: an <strong>intensive phase</strong>&nbsp;of&nbsp;<strong>2 weeks</strong>&nbsp;of therapy with&nbsp;<strong>ceftazidime</strong>&nbsp;(drug of choice) or a carbapenem, followed by&nbsp;<strong>12 weeks</strong> of <strong>oral cotrimoxazole</strong> to eradicate the organism and prevent relapse.</p>\n<p>The image below shows dry <strong>purple wrinkled</strong> colonies of&nbsp;<em>B. pseudomallei&nbsp;</em>cultured in <strong>Ashdown</strong> medium.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/634271886341430991d02a61853c84dax800x600.JPEG"
    ]
  },
  {
    "text": "A 5-year-old child was brought to the hospital with the following skin lesions on both legs. Which of the following appearances of deposits do you expect to see at the dermo-epidermal junction on the direct immunofluorescence test?",
    "choices": [
      {
        "id": 1,
        "text": "Fish-net"
      },
      {
        "id": 2,
        "text": "Speckled"
      },
      {
        "id": 3,
        "text": "Linear"
      },
      {
        "id": 4,
        "text": "Focal granular"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of a 5-year-old child with the lesions shown in the given image having a&nbsp;<strong>string of pearls</strong>&nbsp;or <strong>cluster of jewels&nbsp;</strong>sign is characteristic of <strong>linear IgA disease,&nbsp;</strong>with <strong>linear deposits&nbsp;of IgA</strong> at the dermo-epidermal junction.</p>\n<p><strong>Linear IgA disease/ chronic bullous disorder of childhood (CBDC)</strong>&nbsp;is an immunobullous disease of childhood that clinically can present as an annular arrangement of vesicles. It arises <strong>more abruptly in children</strong> compared to adults. It has a<strong> bimodal onset, below the age of 5 years</strong><strong>&nbsp;</strong>and<strong> between the age of 60 - 65 years.</strong></p>\n<p><strong>Clinical features include:</strong></p>\n<ul>\n<li><strong>Mucous membrane lesions </strong>like&nbsp;oral erosions and ulcers are commonly seen. Nasal crusting and genital lesions may also occur.</li>\n<li><strong>Tense blisters, vesicles,</strong>&nbsp;and <strong>annular erythema</strong> are the characteristic triad of clinical features.</li>\n<li>The blisters are arranged in a <strong>circular fashion,&nbsp;</strong>resembling a&nbsp;<strong>crown/ cluster of jewels</strong>&nbsp;or a&nbsp;<strong>string of pearls</strong> appearance.</li>\n<li>In young children, the distribution of lesions is perioral, perianal, and perineum.</li>\n<li>In adults, the distribution is over the extensors and the trunk.</li>\n</ul>\n<p>Note: The <strong>string of pearls</strong> or <strong>cluster of jewels sign</strong>&nbsp;is characteristic of <strong>linear IgA disease&nbsp;</strong>and <strong>not pathognomic</strong>&nbsp;of this disease.&nbsp;</p>\n<p>The image below shows a string of pearls appearance in the Linear IgA disease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/99f1d1f3e8db412faa5f7f7747c3cbf0.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d0e0d4f2fc544a29842ad004abf31a0ex1278x695.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/177c68586479458ab54e85e0cd087808x1279x962.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9689940ebb8d487196bd61b885c14ae7x384x218.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/44836fa9df094deab7c35b5ec0a196b3x1279x1302.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f457d29bb5445baae7592e715d2acb7x655x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad2094c1fa814382bc7d05005eafa535x720x552.PNG"
    ]
  },
  {
    "text": "A 30-year-old male patient presented to the casualty department with bradykinesia, rigidity, and tremors. His attender reported that he had been diagnosed with schizophrenia and had recently started treatment.  What is the drug of choice to treat the patient's presenting symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Levodopa"
      },
      {
        "id": 2,
        "text": "Benzhexol"
      },
      {
        "id": 3,
        "text": "Amantadine"
      },
      {
        "id": 4,
        "text": "Selegiline"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of<strong>&nbsp;</strong><strong>drug-induced parkinsonism,</strong>&nbsp;for which the drug of choice<strong>&nbsp;</strong>is<strong> benzhexol,&nbsp;</strong>also known as <strong>trihexiphenidyl</strong>.&nbsp;</p>\n<p>Drug-induced parkinsonism is caused by certain drugs that have D<sub>2</sub> antagonistic action, such as typical antipsychotics. Due to the decrease in dopaminergic activity, they result in an unbalanced cholinergic activity. Benzhexol is a <strong>centrally acting&nbsp;</strong>antimuscarinic agent. It acts by restoring the cholinergic balance in the striatal interneurons.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old bodybuilder started a diet of raw eggs as a source of protein, following which he developed dermatitis, atrophic glossitis, and muscular pains. On investigation, he was diagnosed with a vitamin deficiency. Which of the following enzymes does not require this vitamin as a coenzyme?",
    "choices": [
      {
        "id": 1,
        "text": "Pyruvate carboxylase"
      },
      {
        "id": 2,
        "text": "Propionyl-CoA carboxylase"
      },
      {
        "id": 3,
        "text": "Carbamoyl phosphate synthetase"
      },
      {
        "id": 4,
        "text": "Methylcrotonyl-CoA carboxylase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of features like dermatitis, atrophic glossitis, and muscle pain developing in an individual on a raw egg diet is suggestive of&nbsp;<strong>biotin deficiency</strong>, and carbamoyl phosphate synthetase is the enzyme that is not dependent on biotin.</p>\n<p>A protein called <strong>avidin</strong> is present in the <strong>egg white</strong>, which binds to biotin in the diet, making <strong>biotin unavailable</strong> for intestinal absorption. Avidin is heat labile, and boiling of the egg neutralizes its inhibitory activity. One molecule of avidin can bind with four molecules of biotin.</p>\n<p>Biotin deficiency is rare, except in individuals on prolonged total parenteral nutrition and those consuming raw eggs. Individuals with a biotin deficiency may develop features such as dermatitis, atrophic glossitis, hyperesthesia, muscle pain, anorexia, and hallucinations. Treatment is the administration of an injection of&nbsp;<strong>100&ndash;300 mg&nbsp;</strong>biotin.</p>\n<p>Biotin serves as a <strong>co-enzyme</strong> for several <strong>carboxylase enzymes</strong>:</p>\n<ul>\n<li><strong>Acetyl-CoA carboxylase</strong>\n<ul>\n<li>This enzyme adds CO<sub>2</sub> to acetyl CoA, forming malonyl CoA.</li>\n<li>It is the rate-limiting reaction in the biosynthesis of fatty acids</li>\n</ul>\n</li>\n<li><strong>Pyruvate carboxylase</strong>\n<ul>\n<li>Pyruvate + CO<sub>2</sub> +ATP &rarr; Oxaloacetate +ADP + Pi</li>\n<li>It provides oxaloacetate, which is the catalyst for the TCA cycle and is an important enzyme in gluconeogenesis.</li>\n</ul>\n</li>\n<li><strong>Propionyl CoA carboxylase</strong>\n<ul>\n<li>Propionyl CoA +CO<sub>2&nbsp;</sub>+ ATP &rarr; Methyl malonyl CoA + ADP + Pi</li>\n</ul>\n</li>\n<li><strong>Methylcrotonyl-CoA carboxylase</strong></li>\n</ul>\n<div class=\"page\" title=\"Page 550\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Biotin also plays a role in the regulation of the cell cycle.</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Biotin-independent</strong> reactions:</p>\n<ul>\n<li>Urea and pyrimidine synthesis, with <strong>carbamoyl phosphate synthetase</strong>&nbsp;as the stepping stone</li>\n<li>Addition of CO<sub>2</sub> to form C6 in the purine ring</li>\n<li>Conversion of pyruvate to malate by malic enzyme</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the structure marked \"A\" in the CT scan of the thorax shown below.",
    "choices": [
      {
        "id": 1,
        "text": "Descending aorta"
      },
      {
        "id": 2,
        "text": "Superior vena cava"
      },
      {
        "id": 3,
        "text": "Ascending aorta"
      },
      {
        "id": 4,
        "text": "Right pulmonary artery"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked \"A\" in the CT Thorax is the <strong>ascending aorta.</strong></p>\n<p>In a CT study, X-rays are applied in a circular motion and body tissue slices are recreated mathematically. Different tissues are seen with different intensities, depending on the proportion of attenuation of the X-rays that pass through them.</p>\n<ul>\n<li><strong>Air</strong>\u00a0and\u00a0<strong>water</strong>\u00a0are displayed as\u00a0<strong>low-intensity (dark appearance) areas</strong>\u00a0because they produce only little attenuation.</li>\n<li><strong>Bone</strong>\u00a0is displayed as a\u00a0<strong>high-intensity structure (bright appearance</strong>) because of its significant attenuation.</li>\n<li><strong>High density</strong>\u00a0is seen in the presence of\u00a0<strong>hyperemia, freshly clotted blood, and contrast agents</strong>.</li>\n<li><strong>Edema</strong>\u00a0and\u00a0<strong>necrosis</strong>\u00a0are seen as\u00a0<strong>low-intensity</strong>\u00a0areas.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2d01ab8c16fa494d8120ed9b9fde4b7c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5f5adf74c834012affd52151888d55bx531x478.JPEG"
    ]
  },
  {
    "text": "A 19-year-old male patient presents with fever and right lower quadrant pain. On examination, there is tenderness and guarding with an ill-defined mass in the right iliac fossa. A CT scan shows an appendicolith and a complete blood count reveals leucocytosis. The patient improves on conservative treatment. What is the next step in the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Immediate appendectomy"
      },
      {
        "id": 2,
        "text": "Interval appendectomy"
      },
      {
        "id": 3,
        "text": "Percutaneous drainage"
      },
      {
        "id": 4,
        "text": "Wait and watch for spontaneous resolution"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>appendicular mass</strong>. <strong>Interval appendectomy</strong> is done after the conservative management of an <strong>appendicular mass</strong> with <strong>appendicolith</strong>.</p>\n<p>Clinically, patients with the appendicular mass present with a <strong>mass in the right iliac fossa</strong>, fever, <strong>abdominal pain,</strong> and increased pulse rate. In<strong> appendicular mass,</strong> the inflammatory process is already localized and any surgical intervention may be difficult and dangerous.&nbsp;</p>\n<p>Hence, if the general condition is satisfactory, the <strong>conservative Ochsner&ndash;Sherren regimen</strong> is used. After conservative management, a CT scan follow-up should be done to check for complete resolution of the mass.</p>\n<p>Following successful management of appendicular mass, removal of the appendix is advised by a procedure called <strong>interval appendectomy</strong> in <strong>6-8 weeks</strong> after conservative management. The rationale for interval appendectomy is to prevent recurrent appendicitis and risks associated with emergent appendectomy or perforation of the appendix.</p>\n<p>Interval appendectomy is reserved in:</p>\n<ul>\n<li><strong>Recurrent appendicitis</strong></li>\n<li><strong>Appendicolith&nbsp;</strong>(leads to recurrent appendicitis)</li>\n<li><strong>Children</strong></li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Immediate appendectomy</strong> after conservative management has an overall higher rate of complications, wound infections, and abdominal/pelvic abscess formation. So it is <strong>better</strong> to be <strong>avoided.</strong></p>\n<p>Option C: <strong>Percutaneous drainage</strong> is to be done when <strong>pelvic abscess</strong> and <strong>appendicular abscess</strong> do not resolve with conservative management.</p>\n<p>Option D: Appendicolith increases inflammation and leads to recurrent attacks of appendicitis. Hence it is <strong>not advisable</strong> to <strong>wait and watch</strong> for its spontaneous resolution.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 1';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2022-23"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>