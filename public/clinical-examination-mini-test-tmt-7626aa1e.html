<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinical Examination Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 56-year-old female patient presented with chronic cough, bronchiectasis, lower limb lymphedema, and the following nail findings. What are these nail findings called?",
    "choices": [
      {
        "id": 1,
        "text": "Leukonychia"
      },
      {
        "id": 2,
        "text": "Yellow nails"
      },
      {
        "id": 3,
        "text": "Terry's nails"
      },
      {
        "id": 4,
        "text": "Lindsay's nails"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This is an image showing <strong>yellow nails</strong>, and this feature is a component of the&nbsp;<strong>yellow nail syndrome</strong>. They can also occur due to secondary infection with <em>Pseudomonas </em>spp. or <em>Candida </em>spp.</p>\n<p><strong>Yellow nail syndrome</strong>&nbsp;consists of the&nbsp;<strong>triad</strong> of&nbsp;<strong>yellow nail discoloration</strong>, <strong>pulmonary manifestations</strong> (chronic cough, bronchiectasis, pleural effusion), and <strong>lower limb lymphedema</strong>. <strong>Chronic sinusitis</strong> is frequently associated with the triad.</p>\n<p>The characteristic finding is the development of thickened and excessively curved,<strong> yellow nails. </strong>There is&nbsp;an<strong>&nbsp;</strong>almost complete stoppage of nail growth.</p>\n<p>Other options -</p>\n<p>Option A:&nbsp;<strong>Leukonychia</strong> is a <strong>white discoloration</strong> of the nail. True leukonychia occurs due to dysfunction of the nail matrix. <strong>Apparent leukonychia</strong> is seen due to pallor of the <strong>nail bed</strong>, as seen in chronic anemia, edema, and vascular diseases.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/33ee77f24102490791b93a3ad08962da.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4f09d947479a434c97279b35b8240f8bx720x361.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1c6e5d33483941fba5df575565363b48x1280x1706.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/60974e4895c54004b68b97215279c69ex1280x1486.JPEG"
    ]
  },
  {
    "text": "How does the Jendrassik manoeuvre reinforce the knee jerk reflex?",
    "choices": [
      {
        "id": 1,
        "text": "Activates group 1b nerve fibres in tendon"
      },
      {
        "id": 2,
        "text": "Increases gamma motor neuron discharge"
      },
      {
        "id": 3,
        "text": "Makes muscle spindles less sensitive"
      },
      {
        "id": 4,
        "text": "Decreases activity of group 1a nerve fibres"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Jendrassik's maneuver</strong> reinforces the knee-jerk reflex by<strong> increasing</strong> the <strong>gamma motor neuron discharge </strong>from the spinal cord. Increased gamma motor discharge <strong>increases the sensitivity of group 1a nerve fibers</strong> in the muscle spindles to stretch. Increased activity of the group 1a afferents enhances deep tendon reflexes, including the knee jerk reflex.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/00782ab138dc472bb3c203d171eeb75ex360x263.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36179b3d2ddd4adc9c6d83a561332407x1280x1541.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa3f0c79607b459c8666f9a93d998d3bx248x360.JPEG"
    ]
  },
  {
    "text": "A patient with diabetes mellitus for the past 5 years presents with vomiting and abdominal pain. On examination, she appears dehydrated. Investigations revealed pH - 7.00, blood sugar level- 500 mg/dL, and ketonuria. What type of breathing pattern can be observed in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Deep, gasping inspiration with a pause at full inspiration followed by a brief insufficient release."
      },
      {
        "id": 2,
        "text": "Regular deep respirations with periods of apnea"
      },
      {
        "id": 3,
        "text": "Increased volume of respiration"
      },
      {
        "id": 4,
        "text": "Deep and rapid breathing pattern"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p class=\"p2\">The given clinical scenario with <strong>severe</strong>&nbsp;<strong>dehydration, hyperglycemia, ketonuria,&nbsp;</strong>and&nbsp;<strong>metabolic acidosis(pH-7.00)</strong> is suggestive of <strong>diabetic ketoacidosis</strong>. The type of breathing pattern that can be seen in a case of diabetic ketoacidosis is a <strong>deep and rapid breathing</strong> <strong>pattern (Kussmaul breathing).</strong></p>\n<p>Normally, the H<sup>+</sup> ions from acids in our body are buffered with various mechanisms. But in cases where acid production is high like in diabetic ketoacidosis and sepsis, the buffering capacity is exceeded. The resulting <strong>acidosis</strong> <strong>stimulates respiration</strong> and decreases alveolar CO<sub>2</sub> in order to produce a compensatory fall in the H<sup>+</sup> ions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During the clinical examination of a 54-year-old female patient with non-productive cough, exertional dyspnoea, and fatigue, you notice cyanosis and clubbing. On further examination, you hear late inspiratory velcro crackles at lung bases that are unaltered by coughing and the pulmonary function test showed a restrictive deficit. Which of the following conditions should this typical clinical picture prompt you to suspect?",
    "choices": [
      {
        "id": 1,
        "text": "Bronchiolitis"
      },
      {
        "id": 2,
        "text": "Bronchial asthma"
      },
      {
        "id": 3,
        "text": "Interstitial lung disease"
      },
      {
        "id": 4,
        "text": "Bronchiectasis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Interstitial lung disease</strong>\u00a0(ILD) should be suspected in this patient.</p>\n<p>ILD or\u00a0<strong>diffuse parenchymal lung disease\u00a0</strong> is a heterogeneous collection of disorders that share a common presentation (<strong>dyspnea</strong>), physical findings (<strong>late inspiratory crackles</strong>), and chest radiographs (<strong>septal thickening and reticulonodular changes</strong>)</p>\n<p>ILD occurs in patients aged more than 60 years and is common in women. They may present with an insidious onset of progressive dyspnea and non-productive cough.\u00a0<strong>Late inspiratory velcro crackles </strong>on the lung base\u00a0are one of the physical findings present in ILD. <strong>Cyanosis and clubbing</strong> are seen in advanced diseases.</p>\n<p>In ILD, Pulmonary function test show a restrictive deficit.\u00a0</p>\n<p>Based on the histopathological pattern on lung biopsy-</p>\n<table style=\"width: 380px; height: 263px;\">\n<tbody>\n<tr>\n<td style=\"width: 151.141px;\"><strong>\u00a0Type of ILD</strong></td>\n<td style=\"width: 212.859px;\"><strong>Histologic pattern seen</strong></td>\n</tr>\n<tr>\n<td style=\"width: 151.141px;\">Idiopathic pulmonary fibrosis</td>\n<td style=\"width: 212.859px;\">Usual interstitial pneumonia\u00a0(UIP)</td>\n</tr>\n<tr>\n<td style=\"width: 151.141px;\">Non-specific interstitial pneumonia</td>\n<td style=\"width: 212.859px;\">A fibrotic or cellular pattern of non-specific interstitial pneumonia (NSIP)</td>\n</tr>\n<tr>\n<td style=\"width: 151.141px;\">Respiratory bronchiolitis associated interstitial lung disease</td>\n<td style=\"width: 212.859px;\">Respiratory bronchiolitis associated lung disease</td>\n</tr>\n<tr>\n<td style=\"width: 151.141px;\">Systematic sclerosis-associated ILD</td>\n<td style=\"width: 212.859px;\">Both UIP and NSIP</td>\n</tr>\n<tr>\n<td style=\"width: 151.141px;\">\u00a0Sarcoidosis</td>\n<td style=\"width: 212.859px;\">Non caseating granuloma</td>\n</tr>\n</tbody>\n</table>\n<p>Other options:</p>\n<p>Bronchiolitis, bronchiectasis, and bronchial asthma are <strong>obstructive lung diseases</strong>. Pulmonary function test show <strong>obstructive pattern</strong>.\u00a0</p>\n<p><strong>Note:\u00a0</strong>Velcro crackles may also be heard in case of radiation pneumonitis. Also, it may be difficult to reliably distinguish the same from crackles of pulmonary edema.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You would perform a Gutzmann\u2019s pressure test for diagnosing which of the following conditions:",
    "choices": [
      {
        "id": 1,
        "text": "Puberphonia"
      },
      {
        "id": 2,
        "text": "Habitual dysphonia"
      },
      {
        "id": 3,
        "text": "Spasmodic dysphonia"
      },
      {
        "id": 4,
        "text": "Dysphonia plica ventricularis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Gutzmann&rsquo;s pressure test</strong> is done in a case of <strong>puberphonia</strong>.</p>\n<p>Pressing the thyroid prominence in a backward and downward direction relaxes the overstretched cords and low tone voice can be produced. This is known as the&nbsp;<strong>Gutzmann&rsquo;s pressure test.</strong></p>\n<p>Puberphonia:</p>\n<ul>\n<li>Condition seen in <strong>emotionally labile adolescent males</strong>.</li>\n<li>They continue to speak in the <strong>pre-pubertal high-pitched voice</strong>.</li>\n<li>The treatment is <strong>speech therapy</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The image below shows finding seen on eliciting plantar reflex in a patient in the neurology ward. All of the following signs may be seen in this patient except:",
    "choices": [
      {
        "id": 1,
        "text": "Fasciculations"
      },
      {
        "id": 2,
        "text": "Spasticity"
      },
      {
        "id": 3,
        "text": "Hyperreflexia"
      },
      {
        "id": 4,
        "text": "Hypertonia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"notion-focusable\" tabindex=\"0\" role=\"button\">\n<div>The image shows <strong>extensor plantar response </strong>(positive Babinski sign), suggestive of an <strong>upper motor neuron (UMN) lesion.&nbsp;Fasciculations</strong> are seen in <strong>lower motor neuron lesions </strong>(not UMN).</div>\n<div>&nbsp;</div>\n<div>UMNs refer to corticospinal tract neurons and&nbsp;brainstem neurons that control spinal motor neurons. Injury to UMNs lead to:</div>\n<ul>\n<li>Spasticity</li>\n<li>Hypertonia&nbsp;</li>\n<li>Hyperreflexia</li>\n<li>Abnormal plantar extensor reflex (positive Babinski sign).</li>\n</ul>\n<div><strong>Babinski sign</strong> refers to dorsiflexion of the great toe and fanning of other toes when the lateral aspect of the sole of the foot is scratched. It is a sign of an <strong>upper motor neuron lesion</strong>. In <strong>normal</strong> adults, the response is <strong>plantar flexion</strong> of all the toes.</div>\n<div>&nbsp;</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/70d3306767d449fcaf8eb850fd1fe0bd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b71e4bb1dd7c41d0ad038d6a6d1b2f68x407x358.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f82ba8377c714c94a44ed04ca8777aeex800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da3ee900b2c54c2ca610b5c7e1b8d011x640x480.JPEG"
    ]
  },
  {
    "text": "You are evaluating a 17-year-old boy for Marfan's syndrome. You notice the following appearance of the chest as shown in the image below. This finding is called:",
    "choices": [
      {
        "id": 1,
        "text": "Pectus excavatum"
      },
      {
        "id": 2,
        "text": "Harrison\u2019s sulcus"
      },
      {
        "id": 3,
        "text": "Pectus carinatum"
      },
      {
        "id": 4,
        "text": "Cobbler\u2019s chest"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows <strong>forward protrusion </strong>of the <strong>sternum</strong> and the adjacent costal cartilages. This finding is called <strong>pectus carinatum.</strong></p>\n<p>Pectus carinatum is also known as <strong>pigeon chest</strong>. It is seen in conditions such as&nbsp;<strong>Marfan&rsquo;s syndrome</strong>, <strong>rickets</strong>, and <strong>childhood asthma</strong>.</p>\n<p><strong>Marfan's syndrome</strong> is an&nbsp;<strong>autosomal dominant </strong>connective tissue disorder&nbsp;caused by a mutation in the&nbsp;<strong>fibrillin-1</strong> (FBN1) gene on the long arm of chromosome 15. Skeletal manifestations of Marfan's syndrome include:</p>\n<ul>\n<li><strong>Tall stature</strong> and<strong> long limbs</strong>; <strong>upper segment to lower segment ratio</strong> is <strong>reduced</strong>.</li>\n<li><strong>Pectus carinatum&nbsp;</strong></li>\n<li><strong>Pectus excavatum&nbsp;</strong>or cobbler chest or funnel chest&nbsp;</li>\n<li>Long and slender fingers (<strong>arachnodactyly</strong>)</li>\n<li>Joint laxity&nbsp;</li>\n</ul>\n<p>The image given below shows the <strong>pectus excavatum, </strong>characterized by an<strong>&nbsp;increased hollowness</strong> in the <strong>lower part</strong> of the <strong>sternum</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f5e7bba6beac486193dcc69dd9a7e558.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cb6977d847384c4f98e240f8867f173ex900x1200.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/93ed4d495be0468587568c63c2bfd355x512x354.PNG"
    ]
  },
  {
    "text": "Persistent generalized lymphadenopathy is defined as lymph nodes more than ___ cm in size, in ___ or more extra inguinal sites persisting for ___ or more months without an obvious cause. The respective answers are:",
    "choices": [
      {
        "id": 1,
        "text": "2, 2, 3"
      },
      {
        "id": 2,
        "text": "2, 3, 1"
      },
      {
        "id": 3,
        "text": "1, 2, 3"
      },
      {
        "id": 4,
        "text": "1, 2, 1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Persistent generalized lymphadenopathy is defined as lymph nodes more than <strong>1 cm in size</strong>, in <strong>2 or more</strong> areas persisting for <strong>3 or more</strong> months.</p>\n<div class=\"page\" title=\"Page 499\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Generalized lymphadenopathy is frequently associated with disorders such as:</p>\n<ul>\n<li><strong>Infectious mononucleosis (Epstein-Barr virus [EBV])</strong></li>\n<li><strong>Cytomegalovirus [CMV]</strong></li>\n<li><strong>Toxoplasmosis</strong></li>\n<li><strong>AIDS</strong></li>\n<li>Other viral infections</li>\n<li>Systemic Lupus Erythematosus <strong>(SLE)</strong>, and mixed connective tissue disease</li>\n<li>Acute and chronic <strong>lymphocytic leukemias</strong> and <strong>malignant lymphomas</strong></li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to the OPD with complaints of breathlessness after walking about 100m. According to the Modified medical research council scale which grade does this patient belong to?",
    "choices": [
      {
        "id": 1,
        "text": "Grade 1"
      },
      {
        "id": 2,
        "text": "Grade 2"
      },
      {
        "id": 3,
        "text": "Grade 3"
      },
      {
        "id": 4,
        "text": "Grade 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A patient who stops for breath after walking about 100 m belongs to <strong>grade 3</strong> according to the <strong>Modified Medical Research Council (mMRC) dyspnoea scale.</strong></p>\n<p>The Modified Medical Research Council (mMRC) Dyspnea Scale is used to classify the severity of symptoms in <strong>respiratory diseases, specifically COPD.</strong></p>\n<p><strong>Modified MRC (mMRC) dyspnoea scale:</strong></p>\n<ul>\n<li>Grade 0 -Not troubled by breathlessness, except with strenuous exercise\u00a0</li>\n<li>Grade 1 -<strong><strong>\u00a0</strong></strong>Shortness of breath walking on level ground or walking up a slight hill</li>\n<li>Grade 2 - Walks slower than people of similar age on level ground due to breathlessness, or has to stop to rest when walking at their own pace on level ground.</li>\n<li><strong>Grade 3</strong> - Stops to rest after walking <strong>about 100 yards(~91m)</strong> or after walking a <strong>few minutes on level ground</strong></li>\n<li>Grade 4 - Too breathless to leave the house, or breathless with activities of daily living (e.g., dressing/ undressing)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with complaints of drooling of saliva and deviation of the angle of the mouth. Bell's Palsy is suspected. When the patient is asked to close the affected eye, the sign given in the image below can be seen. What is the likely cause?",
    "choices": [
      {
        "id": 1,
        "text": "Left sided LMN type of facial nerve palsy"
      },
      {
        "id": 2,
        "text": "Right sided LMN type of facial nerve palsy"
      },
      {
        "id": 3,
        "text": "Left sided UMN type of facial nerve palsy"
      },
      {
        "id": 4,
        "text": "Right sided UMN type of facial nerve palsy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the above clinical scenario history of&nbsp;<strong>drooling</strong> of saliva,&nbsp;<strong>deviation</strong> of the <strong>angle</strong> of the <strong>mouth, </strong>and the<strong>&nbsp;</strong>image showing<strong> Bell's phenomenon of left eye </strong>are suggestive of a <strong>left-sided LMN type of facial nerve palsy</strong>. It presents with an inability to close the eye, and when the patient attempts to close the eye, <strong>eyeball</strong> <strong>turns up and out.</strong>&nbsp;This is known as the&nbsp;<strong>Bell's phenomenon</strong>.</p>\n<p>Bell's palsy&nbsp;is an <strong>acute </strong>onset&nbsp;<strong>idiopathic, </strong>peripheral facial paralysis.&nbsp;It is a&nbsp;<strong>lower motor neuron lesion&nbsp;</strong>of the<strong>&nbsp;facial nerve&nbsp;</strong>and involves the <strong>ipsilateral</strong>&nbsp;side of the upper and lower halves of the&nbsp;<strong>face</strong>. Other features include drooling of saliva and facial asymmetry. There may be noise intolerance and a loss of taste sensation.</p>\n<p>Bell's palsy is a <strong>diagnosis of exclusion</strong>. All other possible causes of facial paralysis should be ruled out by investigations.&nbsp;</p>\n<p>Treatment of Bell's palsy involves <strong>prednisone</strong> 60-80 mg daily during the first 5 days and then tapered over the next 5 days. Tape to depress the upper eyelid during sleep and artificial tears can be used to prevent corneal drying.&nbsp;Most patients recover within a few weeks or months.</p>\n<p>The following image shows a patient with Bell's palsy.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1f1a9814017448a9954d5d63152e2da1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8c6e4ef7edad4624b31523fbc50b4a94x407x599.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8d68f2bba8c24cb78d3f1938955b1acax1280x2045.JPEG"
    ]
  },
  {
    "text": "During the muscle power examination of a patient, you notice the patient is unable to overcome resistance\nother than gravity. Which of the following is the muscle power according to the Medical Research Council (MRC) grading?",
    "choices": [
      {
        "id": 1,
        "text": "Grade 1"
      },
      {
        "id": 2,
        "text": "Grade 2"
      },
      {
        "id": 3,
        "text": "Grade 3"
      },
      {
        "id": 4,
        "text": "Grade 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>As&nbsp;the patient is unable to overcome resistance other than gravity, the muscle power is <strong>Grade 3</strong> as per the MRC grading.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following Korotkoff sounds corresponds to diastolic blood pressure in a patient with aortic regurgitation?",
    "choices": [
      {
        "id": 1,
        "text": "Soft swishing murmur"
      },
      {
        "id": 2,
        "text": "Tapping sound"
      },
      {
        "id": 3,
        "text": "Muffled sound"
      },
      {
        "id": 4,
        "text": "Disappearance of sound"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Muffled sound</strong> corresponds to <strong>diastolic blood pressure</strong> in aortic regurgitation.</p>\n<p>In aortic regurgitation, the <strong>pulse pressure is widened</strong> and the Korotkoff sounds often do not disappear even when the sphygmomanometer cuff is fully deflated. Hence, diastolic pressure is recorded at the pressure that corresponds to muffling of korotkoff sounds.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presented with complaints of chest pain which worsens on deep inspiration, non-productive cough, and dyspnea. The chest x-ray is given below. What will be percussion notes just above the level of the suspected pathology?",
    "choices": [
      {
        "id": 1,
        "text": "Tympanic"
      },
      {
        "id": 2,
        "text": "Stony dull"
      },
      {
        "id": 3,
        "text": "Sub-tympanic"
      },
      {
        "id": 4,
        "text": "Hyper-resonant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the above clinical scenario history of chest pain which worsens on deep inspiration, non-productive cough, dyspnea and X-ray showing <strong>obliteration of costophrenic angle</strong>&nbsp;is suggestive of<strong> pleural effusion</strong>.<strong>&nbsp;</strong>On examination, there will be <strong>sub tympanic&nbsp;note</strong> on percussion <strong>above</strong> the level of pleural effusion<strong>.</strong></p>\n<p><strong>Percussion notes</strong></p>\n<ul>\n<li><strong>Tympanic note </strong>- Drum Like Note - Stomach, Intestine, subcutaneous Emphysema<strong>(Option A)</strong></li>\n<li><strong>Subtympanic(Skodiac)note </strong>- Boxy Quality note - Just above pleural effusion</li>\n<li><strong>Hyper-resonant note </strong>- Note quality is between normal and tympanic - Pneumothorax, Bilateral emphysema<strong>(Option D)</strong></li>\n<li><strong>Impaired note </strong>- Seen in airless areas - Lung fibrosis, Lung collapse</li>\n<li><strong>Dull note </strong>- Seen in Consolidation, Thick pleura</li>\n<li><strong>Stony dull note </strong>- Pain is felt over the pleximeter finger with a plexor finger feeling resistance - seen in Large pleural effusion <strong>(Option B)</strong></li>\n</ul>\n<p><strong>Pleural effusion</strong> refers to the pathological accumulation of fluid in the pleural space due to</p>\n<ul>\n<li>Excess fluid formation from the interstitial spaces of the lung, parietal pleura, or peritoneal cavity.</li>\n<li>Decreased fluid removal by the lymphatics.</li>\n</ul>\n<p>Pleural effusion may present with dyspnea, pleuritic pain, dry cough, and associated symptoms like fever, weight loss, edema, and ascites depending on the etiology. On examination, there may be tachypnea,&nbsp;<strong>dullness on percussion </strong>and<strong>&nbsp;</strong><strong>decreased/absent breath sounds </strong>at the base.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5e7a0627d13147ce868b6df1b1de9146.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old female patient presented with breathlessness, chest pain, and syncopal attacks on and off for 3 months. Echocardiography showed an abnormality of the cardiac valve. Identify the valvular lesion and the associated murmur from the below image that depicts the heart sounds and murmur of the underlying condition.",
    "choices": [
      {
        "id": 1,
        "text": "Aortic stenosis, Systolic murmur"
      },
      {
        "id": 2,
        "text": "Aortic regurgitation, Diastolic murmur"
      },
      {
        "id": 3,
        "text": "Mitral stenosis, Systolic murmur"
      },
      {
        "id": 4,
        "text": "Mitral regurgitation, Diastolic murmur"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario and the image showing a <strong>systolic murmur</strong> (occurring in the interval between S1 and S2) are suggestive of <strong>aortic stenosis</strong>&nbsp;and the associated <strong>systolic murmur.&nbsp;</strong></p>\n<p>Aortic stenosis is the&nbsp;<strong>narrowing</strong>&nbsp;of the<strong>&nbsp;aortic valve</strong>. It is caused by&nbsp;<strong>rheumatic heart disease </strong>or by the&nbsp;<strong>calcification</strong>&nbsp;of the&nbsp;<strong>normal aortic valve</strong> or a&nbsp;<strong>congenital bicuspid</strong>&nbsp;<strong>valve</strong>. Narrowing of the aortic valve causes a&nbsp;<strong>decrease in stroke volume</strong>. This results in a&nbsp;<strong>weak</strong>&nbsp;<strong>pulse</strong>&nbsp;(pulsus parvus), which&nbsp;<strong>slowly&nbsp;rises</strong>&nbsp;and has a&nbsp;<strong>delayed peak</strong>&nbsp;(pulsus tardus)&mdash;a pattern best appreciated in the&nbsp;<strong>carotid arteries</strong>.</p>\n<p>The clinical features of aortic stenosis are&nbsp;<strong>exertional dyspnea</strong>&nbsp;due to left ventricular (LV) diastolic dysfunction,&nbsp;<strong>angina pectoris&nbsp;</strong>due to the&nbsp;combination of the increased oxygen demand and reduced supply,&nbsp;<strong>syncope&nbsp;</strong>due to the combination of decreased cardiac output and systemic arterial dilation, which lead to a reduction in cerebral perfusion.</p>\n<p>An <strong>ejection mid-systolic murmur</strong>&nbsp;can be auscultated in <strong>aortic stenosis</strong>. It begins after the first heart sound (S1), increases in intensity toward the middle of the ejection, and ends just before aortic valve closure. It is low-pitched, rough, and rasping in character. It is best heard at the <strong>base of the heart,</strong> most commonly in the second right intercostal space.</p>\n<p>A <strong>systolic ejection click</strong> can be heard in young patients with a <strong>bicuspid aortic valve</strong>, but disappears as the valves become calcified. A2 and P2&nbsp;may be heard at the same time, or A2 may follow P2, resulting in the <strong>paradoxical splitting</strong> of the second heart sound (S2). The fourth heart sound (S4) is often heard at the apex, indicating the presence of left ventricular hypertrophy.</p>\n<p>Other options:</p>\n<p>In <strong>mitral stenosis, </strong>a <strong>d</strong><strong>iastolic murmur</strong>&nbsp;can be heard during auscultation.</p>\n<p>Other murmurs:&nbsp;</p>\n<ul>\n<li><strong>Pansystolic murmur </strong>of <strong>functional tricuspid regurgitation</strong>:\n<ul>\n<li>Occurs with severe pulmonary hypertension</li>\n<li>Audible along the left sternal border</li>\n<li>Louder during inspiration and reduces during forced expiration <strong>(Carvallo sign)</strong></li>\n</ul>\n</li>\n<li><strong>Graham Steell murmur</strong> of <strong>pulmonary regurgitation</strong>:\n<ul>\n<li>High-pitched, diastolic, decrescendo-blowing murmur</li>\n<li>Audible along the left sternal border</li>\n<li>Occurs with severe pulmonary hypertension</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a911f1186ce04d2dbe7b0fa7d124541a.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa37729c9f5442399693aadbed454406x1280x1191.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/33e48c417e99465c8b119b5fedae047ex1280x1191.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/14b8186c1464498fb5b9ca24f18c625dx1280x1190.JPEG"
    ]
  },
  {
    "text": "A patient presented with complaints of breathlessness that worsen with exertion and fatiguability for a few months. Based on further workup, a diagnosis of constrictive pericarditis was made. Which of the following findings is likely to be seen in him due to this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Rise or a lack of fall in his JVP during inspiration"
      },
      {
        "id": 2,
        "text": "Sharp fall in his JVP during inspiration"
      },
      {
        "id": 3,
        "text": "Sharp rise followed by a sustained deep fall in JVP during expiration"
      },
      {
        "id": 4,
        "text": "Sharp fall followed by a rise in JVP during expiration"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 1715\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In a patient with <strong>constrictive pericarditis</strong>, the clinical sign that is likely to be seen in <strong>JVP</strong> is <strong>Kussmaul&rsquo;s</strong> sign. It<strong>&nbsp;</strong>is defined by either a <strong>rise or a lack of fall</strong> of the JVP <strong>with</strong> <strong>inspiration</strong>.</p>\n<p>Normally, the venous pressure should <strong>fall</strong> by at <strong>least 3 mmHg</strong> with<strong> inspiration.</strong></p>\n<p>Kussmaul's sign is classically associated with <strong>constrictive pericarditis,</strong> although it has been reported in patients with restrictive cardiomyopathy, massive pulmonary embolism, right ventricular infarction, and <strong>advanced</strong> left ventricular (LV) systolic heart failure.&nbsp;</p>\n<p>The pathophysiological mechanisms responsible for Kussmaul&rsquo;s sign can be explained by conditions that cause <strong>right ventricular dysfunction, impair right ventricular filling, and raise atrial pressure</strong>. The inability of cardiac chambers to expand due to (1) <strong>hypoelasticity or inelasticity</strong> of the <strong>myocardium</strong> caused by conditions such as infection and fibrosis (<strong>restrictive cardiomyopathy</strong>) (2) <strong>mechanical compartmentalization</strong> by constrictive pericardial diseases (constrictive pericarditis), or (3) <strong>impaired right ventricular function</strong> resulting from right-sided myocardial infarction, impede effective right ventricular filling and cause a paradoxical increase in jugular venous pressure during inspiration.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During the clinical examination of a patient, you notice the following finding. Which of the following conditions is the patient unlikely to have?",
    "choices": [
      {
        "id": 1,
        "text": "Chronic obstructive pulmonary disease (COPD)"
      },
      {
        "id": 2,
        "text": "Lung abscess"
      },
      {
        "id": 3,
        "text": "Sarcoidosis"
      },
      {
        "id": 4,
        "text": "Bronchiectasis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given finding in the image is <strong>clubbing</strong>, hence the patient is unlikely to have COPD. Clubbing is <strong>not a sign of COPD</strong>.&nbsp;</p>\n<p>In case there is clubbing in a patient with COPD then a possibility of<strong> lung cancer</strong> must be <strong>ruled out</strong>.</p>\n<p>Clubbing is a clinical finding characterized by&nbsp;<strong>selective bulbous enlargement</strong> of the <strong>distal segments</strong> of the <strong>fingers</strong> and <strong>toes</strong>. It occurs&nbsp;due to the <strong>proliferation </strong>of<strong> connective tissue</strong>, especially&nbsp;on the dorsal surface.</p>\n<p>Causes of clubbing are:</p>\n<ul>\n<li aria-level=\"1\"><strong>Pulmonary</strong></li>\n<ul>\n<li aria-level=\"2\">Bronchogenic carcinoma</li>\n<li aria-level=\"2\">Mesothelioma, asbestosis</li>\n<li aria-level=\"2\"><strong>Lung abscess</strong>, empyema,<strong> bronchiectasis</strong></li>\n<li aria-level=\"2\">Cystic fibrosis</li>\n<li aria-level=\"2\"><strong>Sarcoidosis</strong></li>\n</ul>\n<li aria-level=\"1\"><strong>Gastrointestinal</strong></li>\n<ul>\n<li aria-level=\"1\">Inflammatory bowel disease - ulcerative colitis, Crohn's disease</li>\n<li aria-level=\"2\">Sprue, celiac disease</li>\n<li aria-level=\"2\">Gastric and colonic carcinoma</li>\n<li aria-level=\"2\">Cirrhosis</li>\n<li aria-level=\"2\">Chronic active hepatitis</li>\n</ul>\n<li aria-level=\"1\"><strong>Cardiovascular</strong></li>\n<ul>\n<li aria-level=\"2\">Cyanotic congenital heart disease</li>\n<li aria-level=\"2\">Infective endocarditis</li>\n<li aria-level=\"2\">Aortic aneurysm</li>\n<li aria-level=\"2\">Arteriovenous malformations</li>\n<li aria-level=\"2\">Atrial myxoma</li>\n</ul>\n<li aria-level=\"1\"><strong>Endocrine</strong></li>\n<ul>\n<li aria-level=\"2\">Hyperthyroidism - Grave&rsquo;s disease</li>\n</ul>\n<li aria-level=\"1\"><strong>Neurological</strong></li>\n<ul>\n<li aria-level=\"2\">Hemiplegia (unilateral clubbing)</li>\n</ul>\n</ul>\n<div class=\"page\" title=\"Page 1150\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Hypertrophic osteoarthropathy</strong> is an associated feature in clubbing seen due to primary or metastatic lung disease, mesothelioma, bronchiectasis, and hepatic cirrhosis. It can be diagnosed using a bone radiograph or MRI.</p>\n<p>Clinical methods to elicit clubbing are:</p>\n<ul>\n<li aria-level=\"1\"><strong>Schamroth sign</strong>: This sign is elicited by placing the dorsal surfaces of terminal phalanges of corresponding right and left fingers together.&nbsp;<strong>Normal</strong> fingers create a <strong>diamond-shaped window</strong>, whereas in <strong>clubbed fingers</strong>, this diamond-shaped window gets <strong>obliterated</strong>.&nbsp;</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1f362fceb0c746d6adc9dcdf36ab917c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5562dbffddc541a4a95500e19a5b5840x600x1183.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e9961f1f363148cea7474e56f66173d7x600x861.JPEG"
    ]
  },
  {
    "text": "On tapping a long saphenous varicose vein in the lower part, the impulse can be felt at the saphenous opening with the other hand. This is known as ______",
    "choices": [
      {
        "id": 1,
        "text": "Perthe\u2019s test."
      },
      {
        "id": 2,
        "text": "Modified Perthe\u2019s Test"
      },
      {
        "id": 3,
        "text": "Schwartz test"
      },
      {
        "id": 4,
        "text": "Morrisey\u2019s cough impulse test"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the&nbsp;<strong>Schwartz test</strong>, on tapping a long saphenous varicose vein in the lower part, the impulse can be felt at the saphenous opening with the other hand.&nbsp;<br /><br /><strong>Perthe&rsquo;s Test</strong>: The affected lower limb is wrapped in an elastic bandage, after ruling out arterial occlusive disease. The patient is then asked to walk around. Severe cramping pain arises if there is deep vein thrombosis.&nbsp;<br /><br /><strong>Modified Perthe&rsquo;s Test</strong>: A tourniquet is tied around the upper part of the thigh to prevent reflux down the vein and the patient is asked to walk around. In the presence of normal communicating and deep veins, the varicose veins will shrink. If there is any block, the veins will get more distended.&nbsp;</p>\n<p><strong>Morrisey&rsquo;s cough impulse test:</strong>&nbsp;The limb is elevated to empty the varicose veins. Now it is put to bed and the patient is asked to cough forcibly. An expansile cough impulse is felt at the saphenous opening if the saphenofemoral valve is incompetent. Similarly, a Bruit may be heard on auscultation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the lesions seen in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Grey turner sign"
      },
      {
        "id": 2,
        "text": "Spider Angiomata"
      },
      {
        "id": 3,
        "text": "Caput medusa"
      },
      {
        "id": 4,
        "text": "Cherry Hemangioma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The lesions seen in the image are <strong>Spider angiomas.</strong></p>\n<p><strong>Spider angiomas</strong> (also known as spider naevus or spider telangiectasias) consist of a central arteriole, about pin-headed in size from which steadily narrowing capillaries radiate like spider legs. They are seen in a case of<strong> liver cirrhosis</strong>. Although the exact cause of spider angiomas is not known, many hypotheses have been put forward. Important among&nbsp;those are direct <strong>vasodilatory effects</strong> of alcohol, substance P, <strong>hyperestrogenism</strong>, and inadequate hepatic metabolism of steroid hormones. Spider naevus is also seen in <strong>pregnancy</strong> and with the use of estrogen-containing pills, further associating it with a hyperestrogenic state.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7860b1c60b76461f8b021411b233feda.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/198556949e1d401aa1168d3e803f2a0fx720x1212.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4efaf520d944211a9ab174093dfe2d4x448x368.JPEG"
    ]
  },
  {
    "text": "A patient who is comfortable at rest, but has symptoms on less than ordinary physical activity, with marked limitation of physical activity, is classified as ________.",
    "choices": [
      {
        "id": 1,
        "text": "NYHA class V"
      },
      {
        "id": 2,
        "text": "NYHA class IV"
      },
      {
        "id": 3,
        "text": "NYHA class II"
      },
      {
        "id": 4,
        "text": "NYHA class III"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A patient who is <strong>comfortable at rest,</strong> but has symptoms on\u00a0<strong>less than ordinary</strong> physical activity, with\u00a0<strong>marked limitation of physical activity,</strong> should be classified as<strong> NYHA class III.</strong></p>\n<table style=\"height: 388px; width: 472.984375px;\">\n<tbody>\n<tr>\n<td style=\"width: 85.9844px;\">NYHA class</td>\n<td style=\"width: 358.406px; text-align: center;\">Description</td>\n</tr>\n<tr>\n<td style=\"width: 85.9844px; text-align: center;\">I</td>\n<td style=\"width: 358.406px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">No limitation of physical activity</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Ordinary physical activity does not cause symptoms</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 85.9844px; text-align: center;\">II</td>\n<td style=\"width: 358.406px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Slight limitation of physical activity</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Comfortable at rest, but ordinary physical activity causes symptoms</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 85.9844px; text-align: center;\"><strong>III</strong></td>\n<td style=\"width: 358.406px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Marked limitation</strong> of physical activity</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Comfortable at rest, but less than ordinary physical activity causes symptoms</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 85.9844px; text-align: center;\">IV</td>\n<td style=\"width: 358.406px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Unable to carry out any physical activity without symptoms or symptoms at rest</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During the ward rounds, you notice the notes on a patient file says dysdiadochokinesia present. To elicit this, which of the following would you ask the patient to perform?",
    "choices": [
      {
        "id": 1,
        "text": "Stand with the feet close by and the eyes closed"
      },
      {
        "id": 2,
        "text": "Fix the eye on an object on one extreme of the room"
      },
      {
        "id": 3,
        "text": "Supination and pronation of the hand in quick succession"
      },
      {
        "id": 4,
        "text": "Walk heel to toe on a straight line without any support"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient should be asked to perform a <strong>rapid alternating movement</strong> like the supination and pronation of the hand in quick succession for eliciting dysdiadochokinesis.&nbsp; <strong>Dysdiadochokinesia</strong> is the inability to perform rapid alternate movements.</p>\n<p>It is a clinical manifestation of <strong>cerebellar dysfunction</strong> and is most evident when strength and sensation are intact. Focal lesions in the nervous system may produce highly asymmetric dysdiadochokinesia.&nbsp;</p>\n<p>Standing with the feet close by and the eyes closed is used to check for <strong>Romberg sign</strong>.&nbsp;Walking heel to toe on a straight line without any support is known as the <strong>tandem walking test.</strong></p>\n<p>&nbsp;</p>\n<p>The following movement is the method to check for dysdiadochokinesis. The patient is showing normal movement, with no dysdiadochokinesis.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e611399b386e40c9bfb608dc3ee7499ax510x459.GIF"
    ]
  }
];
        let quizName = 'Clinical Examination Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>