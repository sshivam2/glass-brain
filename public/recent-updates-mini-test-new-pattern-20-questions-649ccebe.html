<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recent Updates Mini Test - New Pattern (20 Questions) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 37-year-old woman who is a direct contact of a known case of influenza is also found to be positive. She has just had a mild cough and a runny nose over the last 10-12 hours but was completely asymptomatic before that. Her medical history is unremarkable but she is currently on calcium and iron supplements prescribed to her by her GP. She has just been in close proximity with her 14-year-old daughter over the last 2 days. You decide to start her on Baloxavir marboxil (Xofluza). Which of the following statements are true?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, and 4"
      },
      {
        "id": 2,
        "text": "1, 2, 3, and 5"
      },
      {
        "id": 3,
        "text": "3, 4, and 5"
      },
      {
        "id": 4,
        "text": "1, 4, and 5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The endonuclease inhibitor indicated for both&nbsp;post-exposure prevention and treatment of acute uncomplicated influenza is <strong>Baloxavir marboxil (Xofluza)&nbsp;</strong>which is available in tablet form to be taken<strong> orally, </strong>and now also as granules for mixing in water <strong>(not nasal spray).</strong></p>\n<p>It was approved by the FDA in 2018. It is used to treat acute&nbsp;<strong>uncomplicated influenza</strong> in patients 12 years of age and older who have been <strong>symptomatic</strong> for <strong>less than 48 hours. </strong>It is a <strong>selective inhibitor of influenza cap-dependent endonuclease</strong> which blocks proliferation by <strong>inhibiting mRNA synthesis.</strong></p>\n<p>Baloxavir inhibits the endonuclease activity of the polymerase acidic protein. Polymerase acidic protein is an influenza virus-specific enzyme in the viral RNA polymerase complex required for viral gene transcription. Inhibiting this results in inhibition of influenza virus replication.</p>\n<p>In November 2020&nbsp;the U.S. FDA <strong>expanded the approved indication</strong> for&nbsp;baloxavir marboxil (Xofluza ) to <strong>include</strong> <strong>post-exposure prevention of influenza</strong> for patients 12 years of age and older after contact with an individual who has the flu.</p>\n<p>The most common side effects of baloxavir marboxil include diarrhea, bronchitis, nausea, sinusitis, and headache.&nbsp;Baloxavir marboxil should <strong>not</strong> be co-administered with dairy products, <strong>calcium-containing</strong>&nbsp;beverages,&nbsp;laxatives, antacids, or oral supplements containing <strong>calcium, iron,</strong> magnesium, selenium, aluminum, or zinc.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following refers to X-linked osteopetrosis occurring due to IKBKG mutation?",
    "choices": [
      {
        "id": 1,
        "text": "Albers-Schonberg disease"
      },
      {
        "id": 2,
        "text": "Anhidrotic ectodermal dysplasia"
      },
      {
        "id": 3,
        "text": "Vrolik\u2019s syndrome"
      },
      {
        "id": 4,
        "text": "Brittle bone disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>X-linked osteopetrosis</strong> which occurs due to <strong>IKBKG mutation</strong> is also known as <strong>anhidrotic ectodermal dysplasia.\u00a0</strong></p>\n<p>Osteopetrosis is usually autosomal dominant or autosomal recessive. Rarely, it can have an <strong>X-linked</strong> pattern of inheritance, which occurs due to the\u00a0<strong>IKBKG mutation</strong> encoding NEMO. It is involved in <strong>NF-kB activation.</strong>\u00a0</p>\n<p>IKBKG mutations result in a multisystem disorder due to the involvement of NF-kB. It is called X-linked anhidrotic ectodermal dysplasia with immunodeficiency. It includes osteopetrosis.</p>\n<p>Option A:<strong>\u00a0Albers Schonberg disease</strong> is a mild autosomal dominant form of <strong>osteopetrosis</strong> that is caused by a mutation of CLCN7.</p>\n<p>Options C and D: Vrolik syndrome and brittle bone disease is another name for osteogenesis imperfecta.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In 2020, the U.S. Food and Drug Administration has approved Inmazeb , a mixture of three monoclonal antibodies, as the first FDA-approved treatment for which of the following deadly diseases?",
    "choices": [
      {
        "id": 1,
        "text": "Corona virus"
      },
      {
        "id": 2,
        "text": "Ebola virus"
      },
      {
        "id": 3,
        "text": "Lyssa virus"
      },
      {
        "id": 4,
        "text": "Nipah virus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The U.S. Food and Drug Administration approved <strong>Inmazeb (atoltivimab, maftivimab, and odesivimab)</strong>, a mixture of three <strong>monoclonal antibodies</strong>, as the first FDA-approved treatment for\u00a0<strong>Zaire ebolavirus\u00a0</strong>(<strong>Ebola virus</strong>) infection in adult and pediatric patients.</p>\n<p>It is indicated for the treatment of infection caused by Zaire ebolavirus in adult and pediatric patients, including neonates born to a mother who is RT-PCR positive for Zaire ebolavirus infection.</p>\n<p>Inmazeb targets the <strong>glycoprotein</strong> that is on the surface of the Ebola virus. Glycoprotein attaches to the cell receptor and fuses the viral and host cell membranes allowing the virus to enter the cell. The three antibodies that makeup Inmazeb can bind to this glycoprotein simultaneously and <strong>block attachment and entry of the virus</strong></p>\n<p>Note: Patients who receive Inmazeb should avoid the concurrent administration of a live vaccine due to the treatment\u2019s potential to inhibit replication of a live vaccine virus indicated for the prevention of Ebola virus infection and possibly reduce the vaccine\u2019s efficacy.</p>\n<p><strong><span data-preserver-spaces=\"true\">Ebola virus\u00a0</span></strong><span data-preserver-spaces=\"true\">is the cause of an emerging disease called Ebola virus disease and is widespread in Africa. It belongs to the\u00a0</span><strong><span data-preserver-spaces=\"true\">Filoviridae</span></strong><span data-preserver-spaces=\"true\">\u00a0family.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Fruit bats</span></strong><span data-preserver-spaces=\"true\">\u00a0act as\u00a0</span><strong><span data-preserver-spaces=\"true\">reservoir</span></strong><span data-preserver-spaces=\"true\">\u00a0hosts of the virus and it is transmitted to humans only accidentally.\u00a0</span><strong><span data-preserver-spaces=\"true\">Human-to-human transmission</span></strong><span data-preserver-spaces=\"true\">\u00a0is through direct contact with blood or body fluids of an infected symptomatic person. </span></p>\n<p><span data-preserver-spaces=\"true\">The incubation period of the disease is\u00a0</span><strong><span data-preserver-spaces=\"true\">2 to 21</span></strong><span data-preserver-spaces=\"true\">\u00a0days. Symptoms include\u00a0</span><strong><span data-preserver-spaces=\"true\">fever, intense weakness, vomiting, diarrhea, rashes,</span></strong><span data-preserver-spaces=\"true\">\u00a0and, in extreme cases, internal and external\u00a0</span><strong><span data-preserver-spaces=\"true\">bleeding</span></strong><span data-preserver-spaces=\"true\">. The current treatment is mainly supportive. Patients are susceptible to reinfection even after a complete cure.</span></p>\n<p>\u00a0</p>\n<p><span data-preserver-spaces=\"true\">The electron micrograph image shows\u00a0<strong>the Ebola virus</strong>.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/30a4a8bdef7a4c7bb1df5e10b02017a8x720x331.JPEG"
    ]
  },
  {
    "text": "Your friend, who is a diabetic, overweight female, seeks your medical opinion on a new method of contraception, called TWIRLA, which her gynecologist had prescribed to her. You would be correct to mention all of the following except:",
    "choices": [
      {
        "id": 1,
        "text": "TWIRLA is contraindicated in women with a BMI \u2265 30 kg/m2"
      },
      {
        "id": 2,
        "text": "TWIRLA delivers drugs transdermally and is applied to the skin as a patch"
      },
      {
        "id": 3,
        "text": "She would need glucose monitoring if she uses TWIRLA"
      },
      {
        "id": 4,
        "text": "It can be applied over the abdomen, buttock, upper torso or even the breasts"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>TWIRLA</strong>, a transdermal contraceptive patch can be applied over the abdomen, buttock, upper torso <strong>but not the breasts.</strong></p>\n<p>The US Food and Drug Administration (FDA) has approved the levonorgestrel and Ethinyl estradiol transdermal system&nbsp;(<strong><em>Twirla</em></strong>) for contraception in women whose body mass index (BMI) is &lt;30 kg/m<sup>2</sup>&nbsp;and for whom a combined hormonal&nbsp;contraceptive&nbsp;is appropriate.</p>\n<p>Applied weekly to the abdomen, buttock, or upper torso (excluding the breasts), Twirla delivers a&nbsp;30-&micro;g daily dose of ethinyl estradiol and a 120-&micro;g daily dose of levonorgestrel.</p>\n<p>Enzyme inducers (e.g., CYP3A4) may decrease the effectiveness of TWIRLA or increase breakthrough bleeding. Women should be advised to use a backup or alternative method of contraception when enzyme inducers are used with TWIRLA.&nbsp;Adverse Carbohydrate and Lipid Metabolic Effect of Twirla necessitates&nbsp;monitoring of glucose in prediabetic and diabetic women using TWIRLA. An alternate<br />contraceptive method should be considered for women with uncontrolled dyslipidemia.</p>\n<p><strong>Contraindications</strong>:</p>\n<ul>\n<li>High risk of arterial or venous thromboembolism diseases&nbsp;</li>\n<li>Breast cancer or other estrogen- or progestin-sensitive cancer&nbsp;</li>\n<li>BMI &ge; 30 kg/m2&nbsp;</li>\n<li>Liver tumors, acute viral hepatitis or decompensated cirrhosis&nbsp;</li>\n<li>Undiagnosed abnormal uterine bleeding</li>\n<li>Pregnancy&nbsp;</li>\n<li>Hypersensitivity reactions to components of TWIRLA</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old primigravida, in her 21st week of pregnancy, seeks your advice regarding an analgesic for abdominal pain. Which of the following drugs would you not advise as it may cause serious kidney problems in the unborn baby?",
    "choices": [
      {
        "id": 1,
        "text": "Tramadol"
      },
      {
        "id": 2,
        "text": "Paracetamol"
      },
      {
        "id": 3,
        "text": "Ibuprofen"
      },
      {
        "id": 4,
        "text": "Morphine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The U.S. Food and Drug Administration (FDA) has issued a warning regarding the use of <strong>nonsteroidal anti-inflammatory drugs (NSAIDs) </strong>like<strong>\u00a0ibuprofen</strong> around or after\u00a0<strong>20 weeks </strong>of gestation as it may cause rare but serious problems in the <strong>kidneys</strong> of the fetus.</p>\n<p>This can lead to a\u00a0<strong>decrease in amniotic fluid</strong> levels surrounding the fetus. From 20 weeks onwards, the fetal kidneys produce most of the amniotic fluid.</p>\n<p>NSAIDs, commonly used for anti-inflammatory and analgesic benefits include aspirin, ibuprofen, naproxen, diclofenac, and celecoxib. These recommendations <strong>do not apply</strong> to the use of <strong>low-dose aspirin</strong>\u00a0during pregnancy and should be taken under the direction of a health care professional.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A District Leprosy Officer is preparing the annual report as per NLEP 2020. Which of the following parameters would he not consider as an essential indicator?",
    "choices": [
      {
        "id": 1,
        "text": "Treatment Completion Rate (TCR)"
      },
      {
        "id": 2,
        "text": "Prevalence rate (PR)"
      },
      {
        "id": 3,
        "text": "Rate of new cases with Grade II disabilities per 10 lakh population per year"
      },
      {
        "id": 4,
        "text": "Proportion of new cases correctly diagnosed"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The proportion of new cases correctly diagnosed is not included under essential indicators. It is a part of the quality of service indicators as per NLEP 2020.&nbsp;</p>\n<p>The <strong>essential indicators</strong> include:</p>\n<ul>\n<li style=\"font-weight: 400;\">Annual new case detection rate (<strong>ANCDR</strong>) per 1 lakh population.</li>\n<li style=\"font-weight: 400;\">Rate of new cases with grade II disabilities (<strong>G2D</strong>) per 10 lakh population per year.</li>\n<li style=\"font-weight: 400;\">Treatment completion rate (<strong>TCR</strong>) as a proxy to cure rate.</li>\n<li style=\"font-weight: 400;\">Prevalence rate (<strong>PR</strong>).</li>\n</ul>\n<p><strong>Additional epidemiological indicators</strong> include:</p>\n<ul>\n<li style=\"font-weight: 400;\">Proportion of Grade II disabilities among new cases.</li>\n<li style=\"font-weight: 400;\">Proportion of females among new cases.&nbsp;</li>\n<li style=\"font-weight: 400;\">Proportion of multibacillary (MB) among new cases.</li>\n<li style=\"font-weight: 400;\">Proportion of child (0- 14 years) among new cases.&nbsp;</li>\n<li style=\"font-weight: 400;\">Child rate per 100,000 population.&nbsp;</li>\n<li style=\"font-weight: 400;\">Scheduled Caste New Case Detection Rate.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "According to the ICMR's nutritional requirement for Indians guidelines 2020, the estimated average requirement (EAR) of proteins for a sedentary female is:",
    "choices": [
      {
        "id": 1,
        "text": "44g/d"
      },
      {
        "id": 2,
        "text": "36g/d"
      },
      {
        "id": 3,
        "text": "30g/d"
      },
      {
        "id": 4,
        "text": "43g/d"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>According to the RDA guidelines 2020, the estimated average requirement (EAR) of proteins for a female is&nbsp;36g/d</p>\n<p>It is 43g/d for males. Protein requirement does not vary with activity levels.&nbsp;</p>\n<p>&nbsp;</p>\n<p>Note:&nbsp;<br />RDA and EAR are distinct parameters and values are different for both</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The histological examination of the heart of a patient who died due to heart failure is given below.  What underlying condition did the patient most likely have?",
    "choices": [
      {
        "id": 1,
        "text": "Hypertrophic cardiomyopathy"
      },
      {
        "id": 2,
        "text": "Restrictive cardiomyopathy"
      },
      {
        "id": 3,
        "text": "Arrhythmogenic cardiomyopathy"
      },
      {
        "id": 4,
        "text": "Dilated cardiomyopathy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given scenario, the histology image shows&nbsp;<strong>ninja-star</strong>&nbsp;like nuclei in myocytes. This is suggestive of <strong>dilated cardiomyopathy&nbsp;</strong>(DCM).</p>\n<p>These are non-specific findings but the presence of&nbsp;<strong>&ge; 5% myocytes</strong> with <strong>ninja star</strong>-like nuclei are suggestive of <strong>DCM.</strong> Here, DCM is due to <strong>titin-truncating mutations</strong>. Truncating mutations are those which shorten the coding sequence of the genes.&nbsp;</p>\n<p>Histologically they appear as variable myocyte hypertrophy and interstitial fibrosis. The nuclei are enlarged, bizarre and hyperchromatic exhibiting a ninja-star like appearance.&nbsp;</p>\n<p>The image given below explains the ninja star-like nuclei in the myocytes.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b72ce2790c9a4d3fa57437cb1dcac5aa.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/93325a80f6ee42009e9064b507199a84x600x636.JPEG"
    ]
  },
  {
    "text": "You are posted as a junior resident in the Emergency Medicine department, where you have to resuscitate an 11-month-old infant who is not breathing and you cannot get the pulse. According to the AHA 2020 guidelines for the pediatric basic and advanced life support, you would be correct to perform all of the following steps except:",
    "choices": [
      {
        "id": 1,
        "text": "Administer  at least 20-30 breaths/min"
      },
      {
        "id": 2,
        "text": "Use a cuffed endotracheal tube for intubating this child"
      },
      {
        "id": 3,
        "text": "Apply cricoid pressure  during endotracheal intubation"
      },
      {
        "id": 4,
        "text": "Administer the initial dose of epinephrine within 5 minutes from the start of chest compressions"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>According to the AHA 2020 guidelines, routine use of cricoid pressure is <strong>not</strong> recommended during the endotracheal intubation of pediatric patients.</p>\n<p>It is reasonable to choose <strong>cuffed ETT</strong>s over uncuffed ETTs for intubating infants and children. When a cuffed ETT is used, attention should be paid to tube size, position, and cuff inflation pressure (usually &lt;20-25 cm H2O).</p>\n<p>For infants and children with a pulse but an absent or inadequate respiratory effort, it is reasonable to give 1 breath every 2 to 3 seconds <strong>(20-30 breaths/min)</strong>. For pediatric patients in any setting, it is reasonable to administer the<strong> initial dose of epinephrine within 5 minutes</strong> from the start of chest compressions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not true about the Ervebo vaccine for the given viral disease?",
    "choices": [
      {
        "id": 1,
        "text": "It is a live attenuated vaccine"
      },
      {
        "id": 2,
        "text": "It contains the viral DNA as immunogen"
      },
      {
        "id": 3,
        "text": "It is effective against the Zaire subtype"
      },
      {
        "id": 4,
        "text": "It uses recombinant vesicular stomatitis virus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given structure is that of the <strong>Ebola virus</strong>. <strong>Ervebo vaccine</strong> does not contain viral DNA. Ebola virus is an RNA virus.</p>\n<p><strong>Ervebo</strong> is a <strong>live attenuated vaccine</strong>\u00a0approved by FDA to prevent Ebola infection. It contains recombinant vesicular stomatitis virus in which the native glycoprotein gene is replaced with the glycoprotein gene of the Ebola virus. It is <strong>effective against the Zaire subtype</strong> of the virus only which was responsible for the recent outbreak in Africa.It is indicated\u00a0in individuals 18 years of age and older.</p>\n<p>It should be administered as a single 1 mL dose, intramuscularly.\u00a0Anaphylaxis has been observed following administration.</p>\n<p>Limitations:</p>\n<p>The duration of protection conferred by this vaccine is unknown.<br />It does <strong>not</strong> protect against other species of <strong>Ebolavirus or Marburgvirus</strong>.<br />Effectiveness of the vaccine when administered concurrently with antiviral medication, immune globulin (IG), and/or blood or plasma transfusions is unknown</p>\n<p>Vaccine virus RNA has been detected in blood, saliva, urine, and fluid from skin vesicles of vaccinated adults.</p>\n<p>The most common local adverse events were injection-site pain, swelling, and redness.<br />The most common systemic adverse events following vaccination were headache, feverishness, muscle pain, fatigue, joint pain, nausea, arthritis, rash and abnormal sweating.</p>\n<p>Ebola virus is an enveloped virus with helical symmetry. Its genetic content is single-stranded RNA bound in negative-sense.\u00a0<span data-preserver-spaces=\"true\">Ebola virus shows a</span><strong><span data-preserver-spaces=\"true\">\u00a0bowl of spaghetti appearance.\u00a0</span></strong><span data-preserver-spaces=\"true\">This virus has the\u00a0<strong>highest mortality rate</strong>\u00a0(25\u201390%) of all viral hemorrhagic fevers.\u00a0</span>Patients are susceptible to reinfection even after a complete cure.</p>\n<p><span data-preserver-spaces=\"true\">The infection is common in Sudan and Zaire provinces in Africa. The incubation period of the disease is\u00a0</span><strong><span data-preserver-spaces=\"true\">2 to 21</span></strong><span data-preserver-spaces=\"true\">\u00a0days. Symptoms include\u00a0</span>fever, intense weakness, vomiting, diarrhea, rashes,\u00a0and, in extreme cases, internal and external\u00a0bleeding. The current treatment is mainly supportive.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8024afd1771f4d538aad0a6b1824768c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "After having undergone training under the DAKSHATA program, you implement the usage of the safe childbirth checklists. Which of the following need to be recorded as part of the checklist on admission?",
    "choices": [
      {
        "id": 1,
        "text": "2, 4 and 5 only"
      },
      {
        "id": 2,
        "text": "1 and 2 only"
      },
      {
        "id": 3,
        "text": "1, 2, 3, 4, and 5"
      },
      {
        "id": 4,
        "text": "1, 2, 3, and 4 only"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Under the DAKSHATA scheme, the\u00a0Safe Childbirth Checklist used on admission\u00a0requires all of the above parameters to be recorded</p>\n<p>The <strong>Ministry of Health and Family Welfare</strong> (MoHFW) has developed an initiative termed \u2018Dakshata\u2019 to improve the quality of care at the delivery points of the country through a focused program that includes</p>\n<ul>\n<li>a concise training package for <strong>competency enhancement </strong>for <strong>Medical Officers, Nurses, and ANMs</strong></li>\n<li>developing a system of<strong> post-training follow-up </strong>and<strong> mentoring</strong></li>\n<li>ensuring the <strong>availability </strong>of essential commodities,<strong> </strong>supplies, and equipment in the labor rooms</li>\n<li>strengthening the capacity of the facilities and the system to measure the quality of care regularly.</li>\n</ul>\n<p>The goal of the initiative:<br />To <strong>improve the quality of maternal and newborn care</strong> during the<strong> intra</strong>- and<strong> immediate postpartum period</strong>, through <strong>providers</strong> who are <strong>competent and confident (Dakshata).</strong></p>\n<p>The technical content of the training will be organized around four pause points:</p>\n<ul>\n<li>At the time of admission before birth</li>\n<li>Just before pushing or at cesarean section</li>\n<li>Soon after delivery (within 1 hour)</li>\n<li>At the time of discharge</li>\n</ul>\n<p>The checklists to be used are as below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b8f50423e0304854b945cdb4bd20c2b3x571x712.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1ec2d7c512504de99bccf9f6a4834ff2x567x730.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d7dc891a55784e4f9b28fb7f96735409x559x733.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c7ff7b4314ae41d6a1a16886bc96e35dx545x727.PNG"
    ]
  },
  {
    "text": "Which of the following is a topical androgen receptor inhibitor that you can prescribe in a 16-year-old with the following condition?",
    "choices": [
      {
        "id": 1,
        "text": "Adapalene"
      },
      {
        "id": 2,
        "text": "Tazarotene"
      },
      {
        "id": 3,
        "text": "Tretinoin"
      },
      {
        "id": 4,
        "text": "Clascoterone"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shows the presence&nbsp;of&nbsp;<strong>papules&nbsp;</strong>and&nbsp;<strong>pustules</strong>&nbsp;with an&nbsp;<strong>erythematous base</strong>&nbsp;with few comedones, suggestive of moderate acne vulgaris.&nbsp; <strong>Clascoterone</strong>&nbsp;is the&nbsp;<strong>topical androgen receptor inhibitor</strong>&nbsp;that can be prescribed to this patient.</p>\n<p>Clascoterone is approved by the FDA in 2020 in the treatment of<strong> acne vulgaris </strong>in individuals<strong> aged&nbsp;&ge; 12 years</strong>. It is one of the alternative topical therapies.&nbsp;</p>\n<p>The mechanism of action of clascosterone is that it&nbsp;competes with the androgens, specifically <strong>dihydrotestosterone</strong>, for binding to the androgen receptor. This leads to <strong>inhibition</strong> of the<strong> sebum production</strong> and the <strong>inflammatory pathways</strong>.&nbsp;</p>\n<p>The <strong>adverse effects </strong>are <strong>skin irritation</strong> and in some cases hypothalamic-pituitary-adrenal axis suppression.&nbsp;</p>\n<p><strong>Acne</strong> is a&nbsp;<strong>polymorphic inflammatory</strong>&nbsp;disease of the&nbsp;<strong>pilosebaceous</strong>&nbsp;<strong>unit</strong>, frequently affecting the face, back and chest.&nbsp;<strong>Precipitating factors</strong> include:</p>\n<ul>\n<li>Lifestyle and environmental factors, diet, BMI, smoking and alcohol use, menstrual cycle, stress and sleep deprivation</li>\n<li><strong>Drugs</strong> like corticosteroids, anticonvulsants, etc</li>\n</ul>\n<p><strong>Severity</strong> of acne according to lesion type and extent:</p>\n<table style=\"height: 133px; width: 568px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 116px;\"><strong>Type of acne</strong></td>\n<td style=\"height: 18px; width: 436px;\"><strong>Description</strong></td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 116px;\">1. <strong>Comedonal</strong></td>\n<td style=\"height: 18px; width: 436px;\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Non\u2010inflamed lesions<br />- Open comedones/blackheads<br />- Closed (whiteheads) comedones</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 116px;\">2. <strong>Mild</strong></td>\n<td style=\"height: 18px; width: 436px;\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Non\u2010inflamed lesions<br />- Inflammatory lesions &lt;5 mm</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 116px;\">3. <strong>Moderate</strong></td>\n<td style=\"height: 18px; width: 436px;\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Non\u2010inflamed lesions<br />- Papulopustular lesions</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 16.2969px;\">\n<td style=\"height: 16.2969px; width: 116px;\">4. <strong>Severe</strong></td>\n<td style=\"height: 16.2969px; width: 436px;\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Deep-seated inflammatory lesions<br />- Nodules and deep pustules<br />- Small nodules are &gt;5 mm; large nodules are &gt;1 cm<br />- Painful lesions with exudative sinus tracts, disfiguring tissue destruction and scarring<br /><br /><strong>Acne conglabata:</strong></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"page\" title=\"Page 2376\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Multiple grouped comedones<br />- Papules, tender inflammatory nodules of varying sizes, suppurative and coalesce to form sinus tract<br />- Extensive scarring</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Assessment</strong> of acne includes:</p>\n<ul>\n<li>Leed's photometric grading scale</li>\n<li>Comprehensive acne severity system (CASS)</li>\n</ul>\n<p>Management:&nbsp;</p>\n<ul>\n<li>Mild acne -&nbsp;\n<ul>\n<li>Comedonal acne&nbsp;-&nbsp;<strong>topical retinoid</strong></li>\n<li>Papular and pustular acne -&nbsp;<strong>topical retinoid </strong>and<strong> topical antibiotics</strong></li>\n</ul>\n</li>\n<li>Moderate papular or pustular acne&nbsp;and nodular acne -&nbsp;<strong>oral antibiotic + topical retinoid &plusmn;</strong><strong>&nbsp;benzoyl peroxide</strong></li>\n<li>Severe&nbsp;nodular and&nbsp;conglobate acne -&nbsp;<strong>oral isotretinoin</strong></li>\n<li>Other therapies -&nbsp; topical niacinamide, salicylic acid, chemical peels , lasers and photodynamic therapy</li>\n<li><strong>Novel drugs -&nbsp;</strong>\n<ul>\n<li>Drugs that target&nbsp;both <strong>retinoic acid receptors -beta</strong> and&nbsp;<strong>-gamma -&nbsp;</strong>\n<ul>\n<li>Adapalene</li>\n<li><strong>Tazarotene</strong>&nbsp;</li>\n<li>Tretinoin</li>\n</ul>\n</li>\n<li>Topical androgen receptor inhibitor - 1% <strong>clascoterone </strong>cream</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/22cd588c7dc84df6ba9340c77d8bb63b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/58e50466bb94419194130673399b5f7ax1280x5399.JPEG"
    ]
  },
  {
    "text": "The given image shows newly discovered salivary gland tissues seen on PSMA (prostate-specific membrane antigen) PET/CT. These salivary gland tissues primarily overlie the _____",
    "choices": [
      {
        "id": 1,
        "text": "Torus tubarius"
      },
      {
        "id": 2,
        "text": "Rosenm\u00fcllers\u2019 fossa"
      },
      {
        "id": 3,
        "text": "Eustachian tube"
      },
      {
        "id": 4,
        "text": "Maxillary sinus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given PSMA PET/CT shows the <strong>recently discovered</strong> pair of&nbsp;<strong>nasopharyngeal salivary glands</strong> which are present&nbsp;over the<strong> torus tubarius</strong>, the cartilaginous structure which supports the entrance of the eustachian tube. These newly&nbsp;identified glands have been named the &ldquo;<strong>tubarial salivary glands&rdquo;</strong>.</p>\n<p>The glands extend from the pharyngeal wall to the Rosenm&uuml;llers&rsquo; fossa. The gland cells showed almost 100% cytoplasmic expression of PSMA, similar to the PSMA-ligand uptake of minor salivary glands in the palate. Bilateral PSMA-positive areas were seen on PSMA PET/CT which extend from the skull base along the posterolateral pharyngeal wall, on the pharyngeal side of the superior pharyngeal constrictor muscle, with a PSMA-positive mass overlying the <strong>torus tubarius</strong>.</p>\n<p>PSMA PET/CT is positron emission tomography/computed tomography with prostate-specific membrane antigen ligands.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/db5fff3a2ca84b33b165c6abc3ea0db8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 7-day-old infant was brought with complaints of profuse watery diarrhea and severe dehydration. On detailed evaluation, labs showed metabolic acidosis and electron microscopy of small bowel biopsy showed characteristic intracellular microvillus inclusions. Mutations in which of the following genes is associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Microsomal triglyceride transfer protein"
      },
      {
        "id": 2,
        "text": "MYO5B"
      },
      {
        "id": 3,
        "text": "SMAD4"
      },
      {
        "id": 4,
        "text": "FOXP3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of<strong>&nbsp;microvillus inclusion disease </strong>(MVID) which is associated with<strong> MYO5B gene </strong>mutations.&nbsp;</p>\n<p>Microvillus inclusion disease<strong>&nbsp;</strong>or Davidson disease&nbsp;is an <strong>autosomal recessive</strong> disorder due to mutations of MYO5B gene. This gene encodes a motor protein that is required for the transport of normal nutrients, ions, water, and plasma membrane components. Hence, it leads to <strong>defective</strong> <strong>vesicular</strong> <strong>transport</strong> that causes deficient brush-border assembly.</p>\n<p>Clinical features of MVID are:</p>\n<ul>\n<li>Profuse watery,<strong> secretory diarrhea -</strong> before 3 months of age (often in the <strong>first few days of life</strong>)</li>\n<li>Metabolic acidosis</li>\n<li>Hypotonic dehydration</li>\n</ul>\n<p>Diagnosis of MVID include:</p>\n<ul>\n<li>Electron microscopy -\n<ul>\n<li><strong>Inclusion containing microvilli</strong> in the apical cytoplasm of the intestinal cells.</li>\n<li>Brush border microvilli are poorly developed with only a few/blunted microvilli</li>\n</ul>\n</li>\n<li><strong>Immunostaining</strong> of<strong> villin</strong>&nbsp;(the brush border protein)</li>\n<li><strong>CD10 </strong>immunohistochemistry to detect microvillus inclusions</li>\n</ul>\n<p>Treatment is total parenteral nutrition and small bowel transplantation.</p>\n<p>The following electron microscopy image shows characteristic intracytoplasmic inclusions that are lined by intact microvilli along the absorptive surfaces of the intestinal cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/648fb7a031904bbda4684f848b63a921x1280x1179.JPEG"
    ]
  },
  {
    "text": "What was the 2020 Nobel Prize in Physiology or Medicine awarded for?",
    "choices": [
      {
        "id": 1,
        "text": "Discovery of how cells sense and adapt to oxygen availability"
      },
      {
        "id": 2,
        "text": "Discovery of hepatitis C virus"
      },
      {
        "id": 3,
        "text": "Discovery of cancer therapy by inhibition of negative immune regulation"
      },
      {
        "id": 4,
        "text": "Molecular mechanisms controlling the circadian rhythm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-preserver-spaces=\"true\">The Nobel Prize in Physiology or Medicine<strong> 2020</strong> was awarded jointly to&nbsp;</span>Harvey J. Alter, Michael Houghton, and Charles M. Rice<span data-preserver-spaces=\"true\">&nbsp;for <strong>the</strong></span><strong>&nbsp;discovery of hepatitis C</strong> virus.</p>\n<p>The given image shows Harvey J. Alter, Michael Houghton, and Charles M. Rice.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b787ffa2af694174a80744081c23fa3dx800x450.JPEG"
    ]
  },
  {
    "text": "Mr. Ramesh is a 55-year-old man who has pledged for cornea donation. History of which of the following diseases would render his cornea unfit for transplantation?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 3 and 5"
      },
      {
        "id": 3,
        "text": "2, 3, 4, 5"
      },
      {
        "id": 4,
        "text": "2, 3, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Diabetes and hypertension are not considered as a contraindication for carrying out cornea donation.</p>\n<p><strong>Contraindications</strong> for eye donation include <strong>Hepatitis B, Hepatitis C, HIV, syphilis, leprosy, tetanus, and COVID-19</strong>.</p>\n<p>In view of the recent pandemic, COVID -19 has also been included as a contraindication for eye donation as per the eye bank 2020 guidelines.</p>\n<p><strong>Contraindications for transplantation: </strong>These include conditions with a potential risk of transmission of local or systemic communicable disease from donor to recipient.</p>\n<ul>\n<li>Death of unknown cause.</li>\n<li>Death with progressive neurodegenerative diseases like\n<ul>\n<li>Chronic idiopathic demyelinating polyneuropathy</li>\n<li>Amyotrophic lateral sclerosis</li>\n<li>Multiple sclerosis</li>\n<li>Huntington\u2019s chorea</li>\n<li>Alzheimer\u2019s disease</li>\n<li>Myasthenia gravis</li>\n<li>Parkinson\u2019s syndrome</li>\n<li>Creutzfeldt-Jakob disease</li>\n</ul>\n</li>\n<li>Active meningitis, viral encephalitis</li>\n<li>Active septicemia at the time of death</li>\n<li>Active viral hepatitis</li>\n<li>Congenital rubella</li>\n<li>Reye\u2019s syndrome</li>\n<li>Suspected rabies and persons who, within the past six months, were bitten by an animal suspected to be infected with rabies</li>\n<li>Active miliary tuberculosis</li>\n<li>Hepatitis B surface antigen-positive donors,\u00a0Hepatitis C seropositive donors</li>\n<li>HTLV-I or HTLV-II infection</li>\n<li>HIV seropositive donors</li>\n<li>Active syphilis or seropositive for syphilis.</li>\n<li><strong>Leprosy</strong></li>\n<li><strong>COVID-19 i</strong><strong>nfection</strong></li>\n<li><strong>Tetanus</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old male presented with an asymptomatic unilateral neck mass. Biopsy revealed a tumor arising from carotid body bifurcation which secreted norepinephrine. Various other laboratory and radiological investigations rule out pheochromocytoma in this patient. Which of the following syndrome would cause this tumor without pheochromocytoma?",
    "choices": [
      {
        "id": 1,
        "text": "Von Hippel Lindau syndrome"
      },
      {
        "id": 2,
        "text": "MEN 2A"
      },
      {
        "id": 3,
        "text": "Hereditary paraganglioma type 3"
      },
      {
        "id": 4,
        "text": "Polycythemia paraganglioma syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Hereditary paraganglioma type 3</strong>&nbsp; is associated with isolated <strong>paraganglioma without pheochromocytoma</strong>. Type 1 and 4 are associated with both pheochromocytoma and paragangliomas</p>\n<p>Paragangliomas are neuroendocrine cell tumors arising from sympathetic or parasympathetic ganglia. Sympathetic paraganglioma secretes catecholamines whilst parasympathetic are silent. They may be incidentally detected.&nbsp;Around 70% of extra-adrenal paragangliomas occur in the head and neck.</p>\n<p>Adrenal medullary pheochromocytomas are the most common paraganglioma.</p>\n<p>Paragangliomas typically develop in two locations:</p>\n<ul>\n<li>Paravertebral paraganglia (organ of Zuckerkandl). These tumors have <strong>sympathetic</strong> connections and stain positively for<strong> chromaffin</strong>, as they <strong>produce catecholamines.</strong></li>\n<li>Paraganglia related to the great vessels of the head and neck, especially the aorticopulmonary chain, including the carotid bodies (carotid body tumor), aortic bodies, jugulotympanic ganglia ( glomus tympanicum or jugulare), the vagus nerve, and clusters located around the oral cavity, nose, nasopharynx, larynx, and orbit. These have&nbsp;<strong>parasympathetic</strong> innervation and do <strong>not</strong> usually produce catecholamines.</li>\n</ul>\n<p>The <strong>carotid body tumor</strong> is a <strong>parasympathetic paraganglioma</strong>. It is usually less than 6 cm in diameter and arises around the <strong>bifurcation of the common carotid artery</strong>. The tumor&nbsp;is red-pink to brown colored, and the microscopic features show&nbsp;nests (zellballen) of round to oval chief cells with abundant, clear or granular, eosinophilic cytoplasm and uniform, round to ovoid&nbsp;nuclei, surrounded by delicate vascular septae. There is scanty cellular pleomorphism and mitoses.&nbsp;The <strong>chief cells</strong> stain positive for&nbsp;<strong>chromogranin, synaptophysin, neuron-specific enolase, CD56, and CD57. </strong></p>\n<p>The supporting spindle-shaped stromal cells called <strong>sustentacular cells</strong>&nbsp;are positive for <strong>S-100 protein</strong>.</p>\n<p>Electron microscopy shows well-demarcated <strong>neuroendocrine granules</strong> in<strong> paravertebral, functioning</strong> tumors.</p>\n<p>&nbsp;</p>\n<table style=\"width: 431px; height: 419px;\">\n<tbody>\n<tr>\n<td style=\"width: 123.576px;\"><strong>Syndrome</strong></td>\n<td style=\"width: 45.7986px;\"><strong>Gene</strong></td>\n<td style=\"width: 144.688px;\"><strong>Associated lesions</strong></td>\n<td style=\"width: 93.5764px;\"><strong>Other features</strong></td>\n</tr>\n<tr>\n<td style=\"width: 123.576px;\">Hereditary paraganglioma 1</td>\n<td style=\"width: 45.7986px;\">SDHD</td>\n<td style=\"width: 144.688px;\">Pheochromocytoma, paraganglioma</td>\n<td style=\"width: 93.5764px;\">&nbsp;GIST</td>\n</tr>\n<tr>\n<td style=\"width: 123.576px;\">Hereditary paraganglioma 3</td>\n<td style=\"width: 45.7986px;\">SDHC</td>\n<td style=\"width: 144.688px;\">Paraganglioma</td>\n<td style=\"width: 93.5764px;\">&nbsp;GIST</td>\n</tr>\n<tr>\n<td style=\"width: 123.576px;\">Hereditary paraganglioma&nbsp;4&nbsp;</td>\n<td style=\"width: 45.7986px;\">SDHB</td>\n<td style=\"width: 144.688px;\">Pheochromocytoma, paraganglioma</td>\n<td style=\"width: 93.5764px;\">&nbsp;GIST</td>\n</tr>\n<tr>\n<td style=\"width: 123.576px;\">Polycythemia paraganglioma syndrome</td>\n<td style=\"width: 45.7986px;\">EPAS1</td>\n<td style=\"width: 144.688px;\">Pheochromocytoma, paraganglioma</td>\n<td style=\"width: 93.5764px;\">Polycythemia</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;<br /><br /><br />&nbsp;&nbsp;</p>\n<p><strong>Other options:</strong></p>\n<p>VHL Syndrome is associated with both phaeochromocytoma and paraganglioma.</p>\n<p>MEN 2A presents with phaeochromocytoma, paraganglioma, medullary thyroid carcinoma, and parathyroid hyperplasia.</p>\n<p>Polycythemia paraganglioma syndrome has paraganglioma, pheochromocytoma, and polycythemia.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which drug has been approved by the FDA to treat Duchenne muscular dystrophy (DMD) in patients who have a confirmed mutation of the DMD gene that is amenable to exon 53 skipping?",
    "choices": [
      {
        "id": 1,
        "text": "Eteplirsen"
      },
      {
        "id": 2,
        "text": "Viltolarsen"
      },
      {
        "id": 3,
        "text": "Deflazocort"
      },
      {
        "id": 4,
        "text": "Risdiplam"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Viltolarsen</strong>\u00a0is an antisense oligonucleotide indicated for the treatment of Duchenne muscular dystrophy, which has been approved by the FDA in patients who have a <strong>confirmed mutation </strong>of the <strong>DMD gene that is</strong> <strong>amenable to exon 53 skipping.</strong></p>\n<p>Viltolarsen injection is administered as an<strong> intravenous infusion </strong>over<strong> 60 minutes.</strong></p>\n<p>Serum cystatin C, urine dipstick, and urine protein-to-creatinine ratio should be measured before starting\u00a0Viltolarsen.\u00a0Kidney function should be monitored in patients on this drug.\u00a0The most common adverse reactions with this drug were upper respiratory tract infection, injection site reaction, cough and fever.</p>\n<p><strong>Muscle Dystrophy:</strong></p>\n<p>Duchenne and Becker muscular dystrophy are caused by loss-of-function mutations in the<strong>\u00a0dystrophin gene on the X chromosome</strong>. Dystrophin is one of the\u00a0<strong>largest human genes</strong>. Dystrophin provides mechanical stability to the myofiber and its cell membrane during muscle contraction. Defects in the complex can lead to small membrane tears that pemits calcium influx, resulting in myofiber degeneration.</p>\n<p>Duchenne muscular dystrophy is associated with\u00a0<strong>deletions or frame-shift mutations</strong>\u00a0that result in the\u00a0<strong>total absence of dystrophin.\u00a0</strong></p>\n<p>In Becker muscular dystrophy, the mutations lead to the synthesis of a\u00a0<strong>truncated version of dystrophin, </strong>which <strong>retains some</strong> of the <strong>function</strong>.<strong>\u00a0</strong>Immunohistochemical studies for dystrophin show the absence of the normal sarcolemmal staining pattern in Duchenne muscular dystrophy and reduced staining in Becker muscular dystrophy.</p>\n<p><strong>Definitive therapy</strong>\u00a0aims at restorating the dystrophin levels in skeletal and cardiac muscle fibers.</p>\n<p>One approach involves the expression of antisense RNAs which alter RNA splicing which allow\u00a0<strong>\u201cskipping\u201d of exons</strong>\u00a0containing deleterious mutations, and permitting the expression of a truncated and partially functional, dystrophin protein.</p>\n<p>Using drugs that\u00a0<strong>promote ribosomal \u201cread-through\u201d of stop codons</strong>, which may enable the expression of some dystrophin protein.</p>\n<p>Both of these approaches are mutation-specific and thus need to be tailored to individual patients.</p>\n<p><strong>Gene therapy</strong>\u00a0(introduction of a normal dystrophin gene) is under investigation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not involved in efferocytosis?",
    "choices": [
      {
        "id": 1,
        "text": "Epithelial cell"
      },
      {
        "id": 2,
        "text": "Macrophage"
      },
      {
        "id": 3,
        "text": "Fibroblast"
      },
      {
        "id": 4,
        "text": "Free radicals"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Efferocytosis</strong> is a specialized type of phagocytosis, where <strong>apoptotic bodies</strong> are phagocytosed with the help of&nbsp;<strong>macrophages, epithelial cells</strong>, and <strong>fibroblast cells.</strong></p>\n<p>During this process, ligands bind to the apoptotic bodies and send &lsquo;<strong>eat me</strong>&rsquo; <strong>signals</strong>. These signals are recognized by receptors present on phagocytes that bind and engulf these cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The U.S. Food and Drug Administration has recently approved a drug called lumasiran as the first treatment for __________________",
    "choices": [
      {
        "id": 1,
        "text": "Homocystinuria type I"
      },
      {
        "id": 2,
        "text": "Hyperprolinemia type I"
      },
      {
        "id": 3,
        "text": "Primary hyperoxaluria type 1"
      },
      {
        "id": 4,
        "text": "Homocystinuria type II"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The U.S. Food and Drug Administration has approved <strong>lumasiran</strong> (Oxlumo) which&nbsp;is an <strong>HAO1-directed small interfering ribonucleic acid</strong> (siRNA) indicated for the <strong>treatment of primary hyperoxaluria type 1 (PH1).&nbsp;</strong>It is used to lower urinary oxalate levels in pediatric and adult patients.</p>\n<p>It&nbsp;<strong>decreases oxalate production&nbsp;</strong>and is designated as an<strong> orphan drug.&nbsp;</strong>Lumasiran (Oxlumo)&nbsp;injection is for <strong>subcutaneous use</strong>. Primary hyperoxaluria type I occurs due to the deficiency of the <strong>alanine</strong> <strong>glyoxalate aminotransferase</strong> in liver peroxisomes.&nbsp;There is a failure to catabolize glyoxylate formed by the deamination of glycine.&nbsp;This causes oxalate overproduction, leading to the formation of oxalate stones and subsequent kidney damage.</p>\n<p>Patients with PH1 produce excess oxalate, which can combine with calcium to cause kidney stones and deposits in the kidneys. This can lead to progressive kidney damage, resulting in kidney failure and the need for dialysis. As kidney function worsens, oxalate can build up and damage other organs, including the heart, bones and eyes.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Recent Updates Mini Test - New Pattern (20 Questions)';
        const quizFilename = 'recent-updates-mini-test-new-pattern-20-questions-649ccebe.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>