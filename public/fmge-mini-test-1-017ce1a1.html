<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 1 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 70-year-old chronic smoker is being evaluated for chronic diarrhea, steatorrhea, and weight loss. On examination, pallor was noted. Peripheral smear revealed macrocytes and hypersegmented neutrophils. Stool examination showed elevated calprotectin and a positive guaiac test. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ulcerative colitis"
      },
      {
        "id": 2,
        "text": "Diverticulitis"
      },
      {
        "id": 3,
        "text": "Crohn\u2019s disease"
      },
      {
        "id": 4,
        "text": "Irritable bowel syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above scenario is suggestive of <strong>Crohn's </strong>disease<strong>&nbsp;</strong>presenting as <strong>jejunoileitis</strong>. This is evidenced by the presence of features of <strong>malabsorption</strong> such as steatorrhea, chronic diarrhea, and vitamin B12 deficiency anemia.</p>\n<p>The&nbsp;<strong>fecal calprotectin</strong>&nbsp;and&nbsp;<strong>lactoferrin</strong>&nbsp;are elevated in&nbsp;<strong>inflammatory conditions</strong>&nbsp;like inflammatory bowel disease, but not in irritable bowel syndrome.&nbsp;</p>\n<p>The&nbsp;<strong>stool</strong> <strong>guaiac test</strong>&nbsp;or&nbsp;guaiac fecal occult blood test&nbsp;(gFOBT) reveals the presence of microscopic levels of blood suggesting <strong>Crohn's</strong> disease. <strong>Gross bleeding</strong> per rectum is more characteristic of <strong>ulcerative colitis.</strong>&nbsp;&nbsp;</p>\n<p>Additionally, <strong>smoking</strong> is a risk factor for Crohn's disease. However, it is a<strong> protective </strong>factor<strong>&nbsp;</strong>in<strong>&nbsp;ulcerative colitis.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 9-year old child presents chronic fatigue, growth retardation and epistaxis. On further evaluation, hepatosplenomegaly, thrombocytopenia and anemia was found. X-ray of the femur shows the following. Bone marrow biopsy showed cells with wrinkled tissue paper appearance. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Sandhoff's disease"
      },
      {
        "id": 2,
        "text": "Fabry\u2019s disease"
      },
      {
        "id": 3,
        "text": "Gaucher\u2019s disease"
      },
      {
        "id": 4,
        "text": "Farber's disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical features, X-ray showing&nbsp;<strong>Erlenmeyer flask deformity</strong> and bone marrow biopsy showing cells with<strong> wrinkled tissue paper </strong>appearance suggest&nbsp;<strong>Gaucher&rsquo;s disease (type I)</strong></p>\n<p>Gaucher's disease&nbsp;is a&nbsp;genetic disorder&nbsp;in which&nbsp;glucocerebroside&nbsp;accumulates in cells and certain organs due to the <strong>deficiency</strong> of the enzyme&nbsp;<strong>glucocerebrosidase (&beta;-glucosidase).</strong></p>\n<p>It is the <strong>most common lysosomal storage disorder.</strong></p>\n<p>It is characterized by the following clinical features:</p>\n<ul>\n<li>Painless&nbsp;hepatomegaly and&nbsp;splenomegaly&nbsp;</li>\n<li>Liver cirrhosis</li>\n<li>Hypersplenism and&nbsp;pancytopenia</li>\n<li>Bleeding tendencies</li>\n<li>Bone pain</li>\n<li>Osteoporosis, pathological fractures (<strong>Erlenmeyer flask deformity)</strong></li>\n<li><strong>Neurological symptoms</strong> such as developmental delay, hypertonia, strabismus, supranuclear gaze palsy (seen in <strong>type 3</strong>)</li>\n</ul>\n<p>Treatment: <strong>Enzyme replacement</strong> therapy is available in the form of&nbsp;</p>\n<ul>\n<li>Human recombinant acid&nbsp;&beta;-glucosidase (Imiglucerase)</li>\n<li>Velaglucerase alfa</li>\n<li>Taliglucerase alfa</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1c7fb075b9634c8dbd0f304c411827fd.jpeg"
    ],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old pregnant woman has completed her 1st antenatal visit under the maternal and child health program (MCH). Now she is 14 weeks pregnant. How many more antenatal visits does she need to complete to fulfill the minimum requirement for antenatal visits under the MCH?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given clinical scenario, the lady should complete 3 more visits to fulfill the minimum requirement of antenatal visits under MCH.</p>\n<p>The <strong>minimum number</strong> of<strong> antenatal visits</strong> according to <strong>MCH</strong> is <strong>4</strong>.</p>\n<ul>\n<li><strong>1st visit&nbsp;</strong>&ndash; within 12 weeks, preferably as soon as the pregnancy is suspected.</li>\n<li><strong>2nd visit&nbsp;</strong>&ndash; between 14 and 26 weeks</li>\n<li><strong>3rd visit&nbsp;</strong>&ndash; between 28 and 34 weeks</li>\n<li><strong>4th visit&nbsp;</strong>&ndash; between 36 weeks and term</li>\n</ul>\n<p>It is advised that the woman should visit the medical officer at the PHC for an antenatal check-up during 3rd visit.</p>\n<p>The minimum number of antenatal visits according to the WHO (not MCH), is 8.</p>\n<p>The <strong>ideal number</strong> of <strong>antenatal</strong> <strong>visits</strong> a mother should take to the antenatal clinic is:</p>\n<ul>\n<li><strong>Once a month</strong> during the<strong> first 7 months</strong></li>\n<li><strong>Twice a month</strong> during the <strong>next&nbsp;month </strong></li>\n<li><strong>Once a week</strong>, thereafter if everything is normal.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged obese female patient has recently been diagnosed with type 2 DM. The best initial drug of choice for the clinical management of type 2 diabetes mellitus in obese patients is ______",
    "choices": [
      {
        "id": 1,
        "text": "Metformin"
      },
      {
        "id": 2,
        "text": "Sulfonylurea"
      },
      {
        "id": 3,
        "text": "Meglitinide"
      },
      {
        "id": 4,
        "text": "Sitagliptin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Metformin</strong> is the <strong>best initial drug</strong>&nbsp;of choice for the clinical management of diabetes mellitus in an obese patient.</p>\n<p>Metformin</p>\n<ul>\n<li><strong>Drug of choice</strong> in obese Type 2 diabetes mellitus patients</li>\n<li>Mechanism of Action: <strong>Reduced&nbsp;</strong>hepatic <strong>glucose production</strong></li>\n<li>Advantages :\n<ul>\n<li>Modest <strong>weight loss</strong></li>\n<li><strong>No</strong> <strong>hypoglycemia</strong></li>\n<li>No plasma level monitoring</li>\n</ul>\n</li>\n<li>Disadvantages :\n<ul>\n<li>Nausea, Diarrhea</li>\n<li><strong>Lactic acidosis</strong></li>\n<li><strong>Vitamin B<span style=\"font-size: 11.6667px;\">12</span></strong>&nbsp;deficiency</li>\n</ul>\n</li>\n<li>Contraindications :\n<ul>\n<li>Liver failure</li>\n<li>Chronic renal failure</li>\n<li>Chronic hepatic failure</li>\n<li>Alcoholics</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A lady wants LASIK surgery for her daughter. Which of the following is not an eligibility criteria for LASIK?",
    "choices": [
      {
        "id": 1,
        "text": "Stable refraction for the past 1 year"
      },
      {
        "id": 2,
        "text": "Corneal thickness of 600 microns"
      },
      {
        "id": 3,
        "text": "Age of 15 years"
      },
      {
        "id": 4,
        "text": "Myopia of 4D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Age of 15 years is not a criteria for LASIK surgery. LASIK surgery is performed after 18 years of age.</p>\n<p>Laser-assisted in situ keratomileusis (LASIK) is performed</p>\n<ul>\n<li>using <strong>excimer laser</strong></li>\n<li>in individuals aged <strong>&gt; 18 years</strong></li>\n<li>in individuals who have a <strong>stable refractive error</strong></li>\n<li>in individuals who have had <strong>unsatisfactory results</strong> with<strong> non-surgical treatment</strong></li>\n<li>in individuals in whom corneal-thinning disorders such as <strong>keratoconus have been ruled out</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0218bf6b33284cefb4740f46ad0fef01x1280x1238.JPEG"
    ]
  },
  {
    "text": "To diagnose a child with attention-deficit/hyperactivity disorder, symptoms should begin before what age?",
    "choices": [
      {
        "id": 1,
        "text": "7"
      },
      {
        "id": 2,
        "text": "12"
      },
      {
        "id": 3,
        "text": "17"
      },
      {
        "id": 4,
        "text": "18"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>To diagnose ADHD, symptoms have to be present<strong> before 12 years</strong> of age.</p>\n<p>According to DSM-5, <strong>six or more symptoms</strong> of inattention for children <strong>up to</strong> <strong>age 16 years</strong>, or <strong>five or more</strong>&nbsp;symptoms for adolescents age <strong>17 years and older</strong> and <strong>adults&nbsp;</strong>are required to make a diagnosis.&nbsp;Symptoms of inattention/hyperactivity must be present for at least 6 months.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions will you perform the Kasai procedure?",
    "choices": [
      {
        "id": 1,
        "text": "Extrahepatic biliary atresia"
      },
      {
        "id": 2,
        "text": "Type 1 choledochal cyst"
      },
      {
        "id": 3,
        "text": "Caroli disease"
      },
      {
        "id": 4,
        "text": "Cholangiocarcinoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Kasai procedure</strong> (<strong>Roux-en-Y hepatoportoenterostomy</strong>) is done for <strong>extrahepatic biliary atresia.</strong>&nbsp;In the Kasai procedure, the occluded extrahepatic bile ducts are excised and a jejunal Roux loop is anastomosed to the hepatic hilum.</p>\n<p>Extrahepatic biliary atresia&nbsp;(EHBA) is defined as a partial or total <strong>absence </strong>of permeable<strong> bile duct </strong>between porta hepatis and the duodenum. It is due to <strong>inflammatory fibrosis</strong> of the biliary tree.&nbsp;It leads to obstruction to bile flow thereby causing leaking of <strong>conjugated bilirubin</strong> into the circulation.</p>\n<p>Associated anomalies include cardiac lesions, <strong>polysplenia</strong>, <strong>situs inversus</strong>, <strong>absent vena cava</strong>, and a preduodenal portal vein.</p>\n<p><strong>HIDA scan</strong>&nbsp;is the <strong>investigation of choice</strong> for EHBA. <strong>Intraoperative cholangiogram</strong> is the&nbsp;<strong>gold standard</strong> for diagnosis.</p>\n<table style=\"height: 261px; width: 496.6875px;\">\n<tbody>\n<tr style=\"height: 29.7656px;\">\n<td style=\"width: 754.6875px; text-align: center; height: 29.7656px;\" colspan=\"3\"><strong>Management of extrahepatic biliary atresia</strong></td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 104px; height: 54px;\">Type I</td>\n<td style=\"width: 295px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atresia restricted to the common bile duct</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 355.6875px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Roux-en-Y hepaticojejunostomy</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 104px; height: 54px;\">Type II</td>\n<td style=\"width: 295px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atresia of the common hepatic duct</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 355.6875px; height: 54px;\" rowspan=\"2\"><strong>Kasai procedure</strong> (Roux-en-Y hepatoportoenterostomy)</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 104px; height: 54px;\">Type III</td>\n<td style=\"width: 295px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atresia of the right and left hepatic duct</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Infants</strong> with biliary atresia, who do not achieve successful drainage after Kasai's procedure, require<strong> liver transplantation</strong> within the first year of life. It is the most common reason for liver transplantation in children.</p>\n<p>Kasai procedure:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a5dea0598624632a466b5cbb4eda70cx720x866.PNG"
    ]
  },
  {
    "text": "Pap smear is ________",
    "choices": [
      {
        "id": 1,
        "text": "Screening test"
      },
      {
        "id": 2,
        "text": "Diagnostic test"
      },
      {
        "id": 3,
        "text": "Confirmative test"
      },
      {
        "id": 4,
        "text": "Both a & b"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Pap smear is a <strong>screening</strong> test. In case of positive&nbsp;test further investigations should be done.</p>\n<p><strong>Pap Smear&nbsp;Schedule</strong></p>\n<ul>\n<li>Time for initiation: <strong>21 years</strong>, regardless of the age of first sexual intercourse.</li>\n<li>Women aged 21-29 years: Every <strong>3 years</strong>(earlier it was done annually)</li>\n<li>Women aged 30-65 years: Pap test + HPV testing every <strong>5 years</strong>.</li>\n<li>Women should stop having cervical cancer screening after the age of 65 years.&nbsp;If suspicious PAP, screening till 75 years.</li>\n<li>HIV+ women: annual checkup until three consecutive negative tests followed by testing every 3 years for life.</li>\n<li>HPV DNA testing in combination with PAP improves the sensitivity of screening.</li>\n</ul>\n<p>Ayres spatula and endocervical brush are the instruments used for the pap test.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea2611c6fd594b378534c87172d8620ex1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/632a126becc3436088ff92325108ae48x486x724.JPEG"
    ]
  },
  {
    "text": "The egg in cup heart is seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Pericardial effusion"
      },
      {
        "id": 2,
        "text": "Constrictive pericarditis"
      },
      {
        "id": 3,
        "text": "TOF"
      },
      {
        "id": 4,
        "text": "HOCM"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Egg in a Cup</strong>&nbsp;appearance is seen with <strong>Constrictive pericarditis.</strong></p>\n<ul>\n<li>Constrictive pericarditis results with <strong>calcification of the pericardium</strong>. There is a s<strong>traightening of the right heart border</strong> and <strong>roughening of the cardiac outline</strong> as a result of pleuropericardial thickening. Calcification has a characteristic distribution involving the anterior and lateral aspects of the heart.</li>\n<li>Constrictive pericarditis is a type of pericarditis which leads to diastolic dysfunction and potential symptoms of right heart failure. Characterized by <strong>fibrous</strong> or <strong>calcific constrictive thickening of the&nbsp;</strong><strong>pericardium,&nbsp;</strong>which prevents normal diastolic filling of the heart.</li>\n<li>MRI is the investigation done to assess the thickness of pericardium.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d1e04a5c48444cc480b14c3c16bf150d.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the size of the intravenous cannula shown below?",
    "choices": [
      {
        "id": 1,
        "text": "20G"
      },
      {
        "id": 2,
        "text": "22G"
      },
      {
        "id": 3,
        "text": "24G"
      },
      {
        "id": 4,
        "text": "26G"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The size of the given cannula is <strong>24G (</strong><strong>yellow).</strong></p>\n<p>This cannula is used to gain IV access in the<strong> pediatric </strong>age group. The flow rate in this cannula is <strong>20ml/min.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0f2f84836614579a5dd33a823d04130.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Among the following, which isotope is used in nuclear scanning?",
    "choices": [
      {
        "id": 1,
        "text": "Tc 99m"
      },
      {
        "id": 2,
        "text": "I 125"
      },
      {
        "id": 3,
        "text": "Cs 137"
      },
      {
        "id": 4,
        "text": "Ir 192"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Technetium agents based on <strong>technetium-99m</strong> (Tc-99m) radioisotope are the most frequently used agents in <strong>nuclear imaging</strong>.</p>\n<p>The radioactive technetium can be chelated to a number of different compounds to create specific radiopharmaceuticals and optimize imaging of various structures.\u00a0The <strong>half-life</strong> of Tc 99m is <strong>6 hours.\u00a0</strong>It produces\u00a0<strong>gamma rays </strong>of <strong>140 keV.</strong></p>\n<p><strong>Iodine 125 (I 125), caesium 137 (Cs 137), and iridium 192 (Ir 192) </strong>are used in <strong>radiotherapy.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old woman presented to the OPD with a 4 x 2 cm painless lump in the left breast. She is planned for a mastectomy. Sentinel lymph node biopsy done showed involvement of level 1 lymph nodes. Which of the following lymph nodes will not be affected in her case?",
    "choices": [
      {
        "id": 1,
        "text": "Posterior"
      },
      {
        "id": 2,
        "text": "Lateral"
      },
      {
        "id": 3,
        "text": "Subscapular"
      },
      {
        "id": 4,
        "text": "Interpectoral"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Interpectoral</strong> lymph nodes are&nbsp;<strong>level 2</strong>&nbsp;axillary lymph nodes. <strong>Level 1 </strong>axillary lymph nodes include <strong>anterior, lateral, and posterior/subscapular&nbsp;</strong>nodes.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bbf19882592340e5b28cf2d28b4d6e23x1280x1341.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ce3220eb41d44fac8eb7467a942836ddx1279x1669.JPEG"
    ]
  },
  {
    "text": "A 5-year-old child with a \u200bhistory of perianal pain is brought to the OPD. On subjecting the specimen from the perianal region to a test, it produces yellow rhombic crystals of spermine picrate. What is the test done?",
    "choices": [
      {
        "id": 1,
        "text": "Barberio test"
      },
      {
        "id": 2,
        "text": "Florence test"
      },
      {
        "id": 3,
        "text": "Takayama test"
      },
      {
        "id": 4,
        "text": "Teichmann test"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The test done in the scenario is <strong>Barberio test</strong>. It is used to detect <strong>seminal fluid.</strong></p>\n<p>When saturated aqueous or alcoholic solution of <strong>picric</strong> <strong>acid</strong> is added to the <strong>spermatic</strong> <strong>fluid</strong>, <strong>yellow needle-shaped</strong> rhombic crystals of<strong> spermine picrate</strong> are produced.</p>\n<p>Other options:&nbsp;</p>\n<p>Option B: Florence test:&nbsp;</p>\n<ul>\n<li>The <strong>suspected</strong>&nbsp;<strong>seminal</strong> <strong>stain</strong> is extracted with 10%&nbsp;<strong>hydrochloric</strong>&nbsp;<strong>acid</strong> and a drop of it is placed over a slide.</li>\n<li>A coverslip is placed over it and a drop of <strong>Florence</strong> <strong>solution </strong>(potassium iodide, iodine, and water) is made to run under the coverslip.</li>\n<li>If semen is present, <strong>dark</strong> <strong>brown</strong> rhombic or needle-shaped crystals of choline iodide appear immediately.</li>\n</ul>\n<p>Option C: Takayama test&nbsp;(Haemochromogen crystal test):&nbsp;</p>\n<ul>\n<li>The test is used to detect suspected<strong> bloodstains.&nbsp;</strong>Small piece of suspected material is added on a glass slide.</li>\n<li>Then, 2-3 drops of Takayama reagent is added and covered with a coverslip.</li>\n<li>If it is a bloodstain,<strong> pink feathery crystals</strong> of <strong>haemochromogen</strong> or <strong>reduced alkaline haematin</strong> appear in a few minutes.</li>\n</ul>\n<p>Option D: Teichmann test (Haemin Crystal Test):&nbsp;</p>\n<ul>\n<li>The test is used to detect suspected <strong>bloodstains</strong>.</li>\n<li>Small piece of suspected material is placed on a glass slide. Then, 2-3 drops of<strong> glacial acetic acid</strong> and a small crystal of <strong>sodium chloride</strong> are added to the glass slide and covered with a coverslip. The slide is then heated.</li>\n<li>If bloodstain is present, faint<strong> yellowish-red</strong> to <strong>brownish-black</strong> <strong>rhombic</strong> <strong>crystals</strong> of <strong>haemin</strong> or <strong>haematin chloride appear.</strong></li>\n<li>When <strong>hydrogen</strong> <strong>peroxide</strong> is added, the haematin crystals give bubbles of gas.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In modern obstetrics, which of the following investigations is used for monitoring the fetus of an Rh-negative sensitized mother?",
    "choices": [
      {
        "id": 1,
        "text": "Biophysical profile"
      },
      {
        "id": 2,
        "text": "Fetal blood sampling"
      },
      {
        "id": 3,
        "text": "Amniospectometry"
      },
      {
        "id": 4,
        "text": "MCA doppler peak systolic velocity"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>MCA doppler peak systolic velocity (PSV)&nbsp;</strong>is used for the monitoring of fetuses in Rh-negative sensitized mothers.</p>\n<p>MCA PSV is enhanced due to increased cardiac output and decreased viscosity of fetal blood.&nbsp;</p>\n<p>If the MCA PSV <strong>exceeds 1.5 MoM</strong> (multiples of the median) and the gestational age is less than 34 or 35 weeks, fetal blood sampling should be considered. MCA Doppler PSV has replaced amniocentesis as the preferred test for the detection of anemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old man presents to the emergency department after being punched in the right side of his face. His plain radiograph is shown below. Which of the following bones maximally contributes to the region fractured?",
    "choices": [
      {
        "id": 1,
        "text": "Maxilla"
      },
      {
        "id": 2,
        "text": "Sphenoid bone"
      },
      {
        "id": 3,
        "text": "Palatine bone"
      },
      {
        "id": 4,
        "text": "Zygomatic bone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The plain radiograph shows a <strong>fracture</strong> of the <strong>floor of the orbit</strong>. The maximum contribution to the floor of the orbit is by the\u00a0<strong>maxilla</strong>.</p>\n<p><strong>Boundaries</strong> of the bony orbit:</p>\n<ul>\n<li><strong>Roof:\u00a0</strong>\n<ul>\n<li>The orbital plate of the\u00a0<strong>frontal</strong> bone\u00a0</li>\n<li>Sphenoid bone (small part)</li>\n</ul>\n</li>\n<li><strong>Floor:\u00a0</strong>Thin plate of bone that also forms the roof of the maxillary sinus\n<ul>\n<li>T<strong>he orbital plate of the\u00a0maxilla</strong></li>\n<li>Zygomatic bone (anterolateral)</li>\n<li>Orbital process of palatine bone (posteromedial)</li>\n</ul>\n</li>\n<li><strong>Medial</strong> wall:\n<ul>\n<li><strong>Maxilla</strong></li>\n<li>Lacrimal bone</li>\n<li>Ethmoid bone</li>\n<li>Sphenoid bone</li>\n</ul>\n</li>\n<li><strong>Lateral</strong> wall:\u00a0\n<ul>\n<li><strong>Zygomatic</strong> bone (anterior)</li>\n<li>Greater wing of <strong>sphenoid</strong> (posterior)</li>\n<li>Sphenozygomatic suture.</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/23ff18ad3bcd4a11baa09c353b1e1537.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ab75acfa3d524efeb86a9c3c09e55768x1280x1270.JPEG"
    ]
  },
  {
    "text": "A child is found to have the findings shown in the image below, on examination of the lower back. Identify the condition:",
    "choices": [
      {
        "id": 1,
        "text": "Encephalocele"
      },
      {
        "id": 2,
        "text": "Omphalocele"
      },
      {
        "id": 3,
        "text": "Rachischisis"
      },
      {
        "id": 4,
        "text": "Spina bifida"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image showing a\u00a0<strong>tuft of hair</strong>\u00a0over the\u00a0<strong>lower back</strong>\u00a0is suggestive of\u00a0<strong>spina bifida</strong>.</p>\n<p><strong>Spina bifida</strong>\u00a0is a general term used for\u00a0<strong>neural tube defects</strong>\u00a0affecting the spinal region and associated with\u00a0<strong>splitting</strong>\u00a0of the\u00a0<strong>vertebral arches</strong>. It is\u00a0characterized by gaps in the vertebral arches and may or may not involve the underlying neural tissue.\u00a0</p>\n<p>The 3 main\u00a0<strong>types</strong>\u00a0of spina bifida:</p>\n<ol>\n<li><strong>Spina bifida</strong>\u00a0<strong>occulta</strong>\u00a0-<strong>\u00a0</strong>This is the\u00a0<strong>mildest</strong>\u00a0form of spina bifida. The defect in the vertebral arches is\u00a0<strong>covered</strong>\u00a0by the\u00a0<strong>skin</strong>. The splits in the vertebrae are so small that the spinal cord does not protrude. The skin at the site of the lesion may be normal. They present only with a\u00a0<strong>tuft of hair</strong>\u00a0over the\u00a0<strong>lower back</strong>.</li>\n<li><strong>Meningocele - </strong>The defect in the vertebra allows the\u00a0<strong>meninges\u00a0</strong>to protrude through the defect.</li>\n<li><strong>Myelomeningocele\u00a0</strong>(meningomyelocele) - A defect in\u00a0the vertebral column allows the\u00a0<strong>spinal cord\u00a0</strong>with the\u00a0<strong>meningeal coverings</strong>\u00a0to protrude.\u00a0</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dea9e42809854aff9d8b4c359e125485.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6654ef87251848b4b1318a9f6e53019fx500x254.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bfc72c8612e64f38ba91ef7bebd4000fx720x509.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2da43d2ed2ff4406bd3ad4f1a091353ex720x803.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/945b6ed81a6b4a94a31081523f02d598x1279x1242.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/32b1f49846a9466885fc54eeaf438329x635x638.JPEG"
    ]
  },
  {
    "text": "A patient is diagnosed with hepatitis B infection. Which of the following markers will always be present in his serum, even during recurrences, or if he develops chronic hepatitis?",
    "choices": [
      {
        "id": 1,
        "text": "HBc Ag"
      },
      {
        "id": 2,
        "text": "Anti HBs Ab"
      },
      {
        "id": 3,
        "text": "Anti HBc Ab"
      },
      {
        "id": 4,
        "text": "HBe Ag"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A patient who has had exposure to HBV will have <strong>Anti HBc antibodies&nbsp;</strong>even when he has moved into the chronic or recurrent stages.&nbsp;<strong>IgM</strong> anti-HBc reappears during acute&nbsp;<strong>recurrences</strong> while <strong>IgG</strong> Anti HBc is found in <strong>chronic</strong> states.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old man with a history of COPD presents with increased shortness of breath. His ABG analysis reveals pH - 7.24; pCO2 - 60 mm Hg, pO2- 52 mmHg, HCO3 - 27 mmol/L. What is the most probable underlying acid-base disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Metabolic Acidosis"
      },
      {
        "id": 2,
        "text": "Metabolic Alkalosis"
      },
      {
        "id": 3,
        "text": "Respiratory Acidosis"
      },
      {
        "id": 4,
        "text": "Respiratory Alkalosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The underlying acid-base disorder is respiratory acidosis.</p>\n<ul style=\"list-style-type: circle;\">\n<li>Step 1: A pH of <strong>7.24</strong> signifies&nbsp;<strong>acidosis</strong>.</li>\n<li>Step 2: A plasma HCO<sub>3</sub><sup>-</sup> is <strong>27 mEq/L</strong> is within normal limits. This is very likely to be due to compensation as it does not reflect the direction of the pH change.</li>\n<li>Step 3: A pCO<sub>2</sub> of <strong>60 mmHg</strong>&nbsp;along with an acidotic pH signifies <strong>respiratory acidosis</strong>.&nbsp;</li>\n<li>Step 4: The expected compensatory increase in HCO<sub>3</sub><sup>-&nbsp;</sup>can be calculated using the following formula:</li>\n</ul>\n<ul>\n<li>Increase in HCO<sub>3</sub><sup>-&nbsp;</sup>= 0.4 X &Delta; PaCO<sub>2</sub> (as COPD is a chronic condition and the presentation of the patient is not acute)</li>\n<li>Thus, the increase in&nbsp;HCO<sub>3</sub><sup>- </sup>= 0.4 x (60-40) = 8 mEq/L</li>\n<li>Therefore expected HCO<sub>3</sub><sup>-</sup> is 24 + 8 = <strong>32 mEq/L</strong>.</li>\n<li>The actual HCO3- measured is 27 mEq/L (which is less than the expected value) indicating that&nbsp;there could be a component of metabolic acidosis also.</li>\n<li>But, the predominant disorder is <strong>respiratory acidosis</strong>&nbsp;and thus it is the best answer.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12 year old boy came to the OPD with scald injury of arm. The lesion was  pink, oozing and painful to touch. Which of the following is the most appropriate management?",
    "choices": [
      {
        "id": 1,
        "text": "Collagen dressing"
      },
      {
        "id": 2,
        "text": "Excision and grafting"
      },
      {
        "id": 3,
        "text": "Paraffin gauze dressing"
      },
      {
        "id": 4,
        "text": "Silver sulphadiazine cream dressing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Scald injury (hot liquids) with pink, oozing and painful lesion is suggestive of a 2nd degree burn. Second-degree wounds is treated with daily dressing changes with topical antibiotics (<strong>Silver sulphadiazine cream</strong>), cotton gauze and elastic wraps.</p>\n<div class=\"page\" title=\"Page 538\">&nbsp;</div>\n<table style=\"height: 240px; width: 459px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 99px; text-align: center;\"><strong>First degree</strong></td>\n<td style=\"width: 64px; text-align: center;\">\n<p><strong>Superficial&nbsp;</strong></p>\n<p><strong>second</strong></p>\n</td>\n<td style=\"width: 145px; text-align: center;\"><strong>Deep second</strong></td>\n<td style=\"width: 133px; text-align: center;\"><strong>Third&nbsp;degree</strong></td>\n</tr>\n<tr>\n<td style=\"width: 99px;\">Painful</td>\n<td style=\"width: 64px;\">Painful</td>\n<td style=\"width: 145px;\">Pain on pin prick</td>\n<td style=\"width: 133px;\">Painless</td>\n</tr>\n<tr>\n<td style=\"width: 99px;\">Erythematous</td>\n<td style=\"width: 64px;\">\n<p>Erythematous,</p>\n<p>moist</p>\n</td>\n<td style=\"width: 145px;\">Pale, Mottled</td>\n<td style=\"width: 133px;\">Hard leathery eschar</td>\n</tr>\n<tr>\n<td style=\"width: 99px;\">Blanch on touch</td>\n<td style=\"width: 64px;\">Blanch on touch</td>\n<td style=\"width: 145px;\">Not blanch</td>\n<td style=\"width: 133px;\">Black in color</td>\n</tr>\n<tr>\n<td style=\"width: 99px;\">Not blister</td>\n<td style=\"width: 64px;\"><strong>often blister</strong></td>\n<td style=\"width: 145px;\">&nbsp;</td>\n<td style=\"width: 133px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 99px;\">No scarring</td>\n<td style=\"width: 64px;\">Spontaneous re-epithelialisation in 1-2 weeks</td>\n<td style=\"width: 145px;\">Severe scarring,<br />re-epithelialisation in 2-5week</td>\n<td style=\"width: 133px;\">Excision &amp; skin grafting needed</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74510e75cc6845ff89d59e0319a190d5x1280x1307.JPEG"
    ]
  },
  {
    "text": "Corticosteroid indicated for the stimulation of fetal lung maturation in preterm labor______",
    "choices": [
      {
        "id": 1,
        "text": "Hydrocortisone"
      },
      {
        "id": 2,
        "text": "Triamcinolone"
      },
      {
        "id": 3,
        "text": "Methylprednisolone"
      },
      {
        "id": 4,
        "text": "Betamethasone"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Betamethasone</strong> is indicated for the stimulation of <strong>fetal lung maturation in preterm labor.</strong></p>\n<p><strong>Dexamethasone</strong>, another long-acting glucocorticoid is also indicated. It has benefits such as less risk of intraventricular hemorrhage and a shorter length of stay in the NICU.</p>\n<p class=\"p1\">Maternal administration of glucocorticoids is advised in preterm labor when the period of gestation is&nbsp;<strong>less</strong>&nbsp;than&nbsp;<strong>34 weeks</strong>.&nbsp;<strong>Intramuscular injection</strong>&nbsp;of either betamethasone or dexamethasone is given.</p>\n<p class=\"p1\"><strong>Dosage</strong>:&nbsp;</p>\n<ul>\n<li class=\"p1\">Betamethasone(Betnesol): Two doses of 12 mg each, given 24 hours apart.</li>\n<li class=\"p1\">Dexamethasone: Four doses of 6 mg each, given every 12 hours.</li>\n</ul>\n<p class=\"p1\">This helps in fetal lung maturation and minimizes the incidence of:</p>\n<ul>\n<li class=\"p1\">Respiratory distress syndrome</li>\n<li class=\"p1\">Intraventricular hemorrhage</li>\n<li class=\"p1\">Necrotizing enterocolitis</li>\n</ul>\n<p>It is beneficial when the delivery is delayed beyond 48 hours after the first dose.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The device shown in the given image is used for the monitoring of:",
    "choices": [
      {
        "id": 1,
        "text": "Oxygen saturation"
      },
      {
        "id": 2,
        "text": "Oxygen content of the blood"
      },
      {
        "id": 3,
        "text": "Partial pressure of oxygen"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image depicts a <strong>pulse oximeter</strong>. Pulse oximetry is used for <strong>monitoring pulse rate and oxygen saturation</strong> of a patient.</p>\n<p>A small sensor is placed on the finger, toe, earlobe, or another convenient place.</p>\n<p>The <strong>relative absorption of light by oxyhemoglobin</strong> (HbO) and deoxyhemoglobin is assessed by <strong>measuring the amount of red and infrared light emerging from tissues</strong> traversed by light rays and processed by the device, producing an oxygen saturation level.</p>\n<p>Pulse oximetry does <strong>not measure the absolute content or the partial pressures of oxygen or carbon dioxide</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bfbaff03740845859ba1be1ce2b528e5.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old female patient presents to the OPD with complaints of shortness of breath and tiredness. There is no history of reactive airway disease or heart diseases previously. She has a history of breast cancer for which breast conservation surgery and chemoradiation were done. On examination, there were engorged neck veins and JVP showed rapid x and y descent and Chest Xray is as below.Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Constrictive pericarditis"
      },
      {
        "id": 2,
        "text": "Cardiac tamponade"
      },
      {
        "id": 3,
        "text": "Dilated cardiomyopathy"
      },
      {
        "id": 4,
        "text": "Restricted cardiomyopathy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical features and the JVP findings of <strong>rapid X and Y descent</strong>\u00a0 are suggestive of<strong> constrictive pericarditis.</strong></p>\n<p><strong>Constrictive pericarditis:</strong></p>\n<ul>\n<li>It is the condition where a thickened, fibrotic, and often calcified pericardium restricts the diastolic filling of the heart.</li>\n<li>In developing countries, infectious etiologies like <strong>tuberculosis or viral infections</strong> are the most common cause of this condition.</li>\n<li><strong>Cardiac surgery</strong> and<strong> radiation therapy</strong> are also common causes.</li>\n<li>Other causes include connective tissue disease, uremia, neoplasm, or idiopathic.</li>\n<li>Clinically the patients present with dyspnea, orthopnea, and fatigue.</li>\n<li>JVP findings - There is a\u00a0<strong>rapid 'x' and 'y' descent</strong>. The rapid 'y' descent is more prominent and reflects rapid early ventricular diastolic filling.\u00a0This occurs due to the constricting pericardium, increasing the atrial pressures.</li>\n</ul>\n<p>Diagnosis:</p>\n<ul>\n<li>Diagnosis is difficult and is confirmed by multiple investigations</li>\n<li>Hallmark findings of pericardial constriction are <strong>pericardial thickening, calcification, and abnormal ventricular diastolic function.</strong></li>\n<li>The X-ray can be normal or there may be non-specific cardiac enlargement, calcification, and roughened cardiac outline.</li>\n<li>Echo can assess the hemodynamic function but it is accurate in identifying pericardial thickening.</li>\n<li>CT and MRI are more sensitive investigations.</li>\n<li>CT has an edge over MRI as it can detect calcification associated with this condition.</li>\n<li>Pericardial thickness of &gt; 4mm along with clinical features of constriction is highly suggestive of this diagnosis.</li>\n<li>Cardiac MR may show diastolic septal bounce.</li>\n<li>Hepatomegaly and ascites can be seen associated with this condition.</li>\n</ul>\n<p><strong>Constrictive pericarditis</strong> will have <strong>prominent y descent, prominent x descent</strong>, and Kussmaul's sign. Normally, the venous pressure should fall by at least 3 mmHg with inspiration. Kussmaul\u2019s sign is defined by either a rise or a lack of fall of the JVP with inspiration.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a4ee9618436e4de9bab2ae4ac8b006e1.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/70a53c5479f842c6b6168ebb7f14ff1cx1279x903.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/410aef088faf412289c7cefe139a4800x1279x840.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/788578adff164a90aa62896aae19b83ax1280x863.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8cb199c9bfab4546b991d118fcfd1ab8x1280x952.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f06e1652367a4effb3ae8ba5d41e6077x1280x1022.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c14a058d30994e3db7715953763ccc5ex1279x706.JPEG"
    ]
  },
  {
    "text": "Identify the following-",
    "choices": [
      {
        "id": 1,
        "text": "Cock-up splint"
      },
      {
        "id": 2,
        "text": "Dynamic finger splint"
      },
      {
        "id": 3,
        "text": "Colle's cast"
      },
      {
        "id": 4,
        "text": "Knuckle bender splint"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image provided above is that of <strong>cock-up splint&nbsp;</strong>and is used in <strong>radial nerve palsy.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5e93a4a2b326479f83499b6c4b93b00a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b4097bb9a3aa4a9ba3d409acd0469620x1280x1395.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b74d7887f7d44865a41f06b2a26122e0x1280x754.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/92e12acd218442248ab27e1db7ef5eb4x355x321.JPEG"
    ]
  },
  {
    "text": "A 50-year-old man presented with the blurring of vision. Urine examination showed proteinuria. Fundus examination showed dot and blot hemorrhages, microaneurysms, and cotton wool spots. Histopathology of the kidney was as shown below. What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Renal amyloidosis"
      },
      {
        "id": 2,
        "text": "Focal segmental glomerulosclerosis"
      },
      {
        "id": 3,
        "text": "Kimmelstiel-Wilson disease"
      },
      {
        "id": 4,
        "text": "Lupus nephritis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Histopathological image shows <strong>acellular periodic acid Schiff (PAS)-positive nodules</strong> suggestive of&nbsp;nodular glomerulosclerosis/intercapillary glomerulosclerosis/Kimmelstiel&ndash;Wilson disease, which occurs in patients with&nbsp;diabetic nephropathy.</p>\n<p>Three renal lesions are encountered in diabetic nephropathy:</p>\n<ul>\n<li><strong>Glomerular lesions</strong>:\n<ul>\n<li>Capillary basement membrane thickening</li>\n<li>Diffuse mesangial sclerosis</li>\n<li>Nodular glomerulosclerosis/<strong>Kimmelstiel&ndash;Wilson disease</strong></li>\n</ul>\n</li>\n<li><strong>Renal vascular lesions</strong>, principally hyaline arteriolosclerosis</li>\n<li><strong>Pyelonephritis</strong>, including necrotizing papillitis</li>\n</ul>\n<p>Renal histopathology in:</p>\n<ul>\n<li>Amyloidosis:&nbsp;Glomerular deposits appearing as thickenings of the mesangial matrix, forming interlacing broad ribbons of amyloid</li>\n<li>Lupus nephritis:&nbsp;Immune complex deposits in the mesangium or along the entire basement membrane (wire loop lesions), with mesangial cell proliferation</li>\n<li>Focal segmental glomerulosclerosis:&nbsp;Focal and segmental hyalinosis and sclerosis of the capillary wall; lipid droplets in the sclerosed area.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/800949781bf5465f8d3a6022da109176.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "All of the following are contraindications of IUD usage except:",
    "choices": [
      {
        "id": 1,
        "text": "PID"
      },
      {
        "id": 2,
        "text": "Cardiac problems"
      },
      {
        "id": 3,
        "text": "Carcinoma cervix"
      },
      {
        "id": 4,
        "text": "Menorrhagia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Cardiac problems is not a contraindication in IUD usage.</p>\n<p>&nbsp;</p>\n<table style=\"height: 518px; float: left; width: 640.143px;\">\n<tbody>\n<tr style=\"height: 13px;\">\n<td style=\"width: 628.143px; height: 13px; text-align: center;\" colspan=\"2\"><strong>IUD Usage</strong></td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 145px; height: 13px; text-align: center;\"><strong>Absolute contraindications</strong></td>\n<td style=\"width: 483.143px; height: 13px; text-align: center;\"><strong>Relative contraindications</strong></td>\n</tr>\n<tr style=\"height: 40px;\">\n<td style=\"width: 145px; height: 40px;\">\n<p>suspected pregnancy,</p>\n<p><strong>PID,</strong></p>\n<p>vaginal bleeding of unknown etiology,</p>\n<p><strong>Carcinoma cervix</strong>/uterus/adnexa/other pelvic tumors,</p>\n<p><strong>previous ectopic pregnancy.</strong></p>\n</td>\n<td style=\"width: 483.143px; height: 40px;\">\n<p>anemia,</p>\n<p><strong>menorrhagia</strong>,</p>\n<p>history of PID since the last pregnancy,</p>\n<p>purulent cervical discharge, distortions of the uterine cavity due to fibroids,</p>\n<p>uterine malformations,</p>\n<p>unmotivated person.&nbsp;</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The only abductor of the vocal cord is ______",
    "choices": [
      {
        "id": 1,
        "text": "Cricothyroid"
      },
      {
        "id": 2,
        "text": "Posterior cricoarytenoid"
      },
      {
        "id": 3,
        "text": "Lateral cricoarytenoid"
      },
      {
        "id": 4,
        "text": "Interarytenoid"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Posterior cricoarytenoid is the only intrinsic muscle of the larynx that causes abduction of vocal cords.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 15-year-old male undergoes bilateral adrenalectomy for phaeochromocytoma. On the third postoperative day, the boy feels lethargic and tired. Blood pressure is 80/60 mm Hg, there is no sign of bleed. What could be the cause of this?",
    "choices": [
      {
        "id": 1,
        "text": "Addison's crisis"
      },
      {
        "id": 2,
        "text": "SIADH"
      },
      {
        "id": 3,
        "text": "Diabetes insipidus"
      },
      {
        "id": 4,
        "text": "Cerebral salt wasting disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical features given in the question are suggestive of <strong>Addisonian crisis.</strong></p>\n<p><strong>Addisonian crisis</strong> is a life-threatening condition caused due to <strong>sudden insufficiency</strong> <strong>of adrenal hormones</strong>. Normally, adrenal corticosteroids help to retain sodium and maintain normal intravascular volume. Sudden lack of these hormones causes excessive <strong>loss of sodium, decreased intravascular volume, low blood pressure</strong> and eventually <strong>circulatory collapse.</strong></p>\n<p>The <strong>causes</strong> are either primary or secondary. Primary causes include adrenal haemorrhage, acute infection, etc, while the secondary causes include surgery, cessation of steroid therapy, postpartum pituitary necrosis, etc.</p>\n<p><strong>Treatment</strong> includes fluid and glucocorticoid replacement.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following malignancies is most commonly associated with the paraneoplastic manifestation shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Breast carcinoma"
      },
      {
        "id": 2,
        "text": "Bladder cancer"
      },
      {
        "id": 3,
        "text": "Gastric adenocarcinoma"
      },
      {
        "id": 4,
        "text": "Lung adenocarcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This image shows velvety warty hyperpigmentation on the front of the neck called&nbsp;<strong>acanthosis nigricans</strong>. By far, the commonest site of underlying neoplasm is the <strong>gastrointestinal</strong> tract (70&ndash;90%), and&nbsp;<strong>gastric adenocarcinoma</strong> is the most frequent.</p>\n<p>Production by tumor cells of either<strong> transforming growth factor &alpha; (TGF-&alpha;) or cytokines</strong> that activate insulin\u2010like growth factors or their<strong> cutaneous receptors</strong> has been proposed as the pathogenetic mechanism.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/10bb3f14245e4e2f8c12cf44be4da1dd.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "After successful delivery of the baby, the obstetrician witnesses that the episiotomy performed has extended away backwards beyond the perineal body. Which among the following structures is likely to be injured in this case?",
    "choices": [
      {
        "id": 1,
        "text": "External anal sphicter"
      },
      {
        "id": 2,
        "text": "Ischiocavernosus"
      },
      {
        "id": 3,
        "text": "Bulbospongiosis"
      },
      {
        "id": 4,
        "text": "Urethral sphincter"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The structure injured in an episiotomy done posteriorly beyond the perineal body is the <strong>external anal sphincter</strong>.&nbsp;</p>\n<p class=\"p1\">The lacerations of the perineum have been divided into four degrees:</p>\n<ul>\n<li class=\"p1\">First degree- laceration is restricted to the <strong>skin</strong> of the fourchette</li>\n<li class=\"p1\">Second degree- <strong>muscles</strong> of the perineal body are torn through</li>\n<li class=\"p1\">Third degree- the tear extends partially backward through the <strong>external anal sphincter</strong></li>\n<li class=\"p1\">Fourth degree- the external anal sphincter is torn and <strong>anal</strong> <strong>mucosa</strong> is also involved</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Specificity of a screening test is the ability of a test to detect ____",
    "choices": [
      {
        "id": 1,
        "text": "True positives"
      },
      {
        "id": 2,
        "text": "False positives"
      },
      {
        "id": 3,
        "text": "True negatives"
      },
      {
        "id": 4,
        "text": "False negatives"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Specificity </strong>of a screening test is the ability of the test to identify correctly <strong>those who don&rsquo;t have the disease</strong> or the true negatives.</p>\n<p><strong>Sensitivity </strong>of a screening test is the ability of the test to identify correctly <strong>those who have the disease</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 1';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>