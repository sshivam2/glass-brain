<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forensic Medicine Test - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Test Series Subject / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "You are declaring a patient brain-dead by using the Harvard criteria. All of the following parameters are checked for, except:",
    "choices": [
      {
        "id": 1,
        "text": "Unresponsiveness to painful stimuli"
      },
      {
        "id": 2,
        "text": "Isoelectric ECG waves"
      },
      {
        "id": 3,
        "text": "Loss of elicitable reflexes"
      },
      {
        "id": 4,
        "text": "No spontaneous muscular movements"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Isoelectric EEG</strong> is included in <strong>Harvard criteria</strong> for <strong>brain death</strong> and <strong>not ECG</strong>.</p>\n<p>Harvard criteria for brain death include:</p>\n<ul>\n<li><strong>Unreceptivity and unresponsiveness,</strong>\u00a0demonstrated by an absent motor response to pain in all extremities.</li>\n<li>No movements</li>\n<li><strong>Apnea-</strong> impaired brainstem activity indicates damage to the medullary cardio-respiratory centers. This manifests as a loss of centrally controlled breathing.</li>\n<li><strong>Absence of elicitable reflexes</strong>\n<ul>\n<li>Cranial nerve II, III (optic and oculomotor)- absent direct and consensual light reflex. This is associated with dilated pupils measuring about 9 mm.</li>\n<li>Cranial nerve VIII (vestibulocochlear)- absent oculocephalic (Doll's eye phenomenon) and oculovestibular (unresponsive to caloric testing) reflexes.</li>\n<li>Cranial nerve V, VII (trigeminal and facial)- absent corneal and jaw reflexes.</li>\n<li>Cranial nerve IX, X (glossopharyngeal and vagus)- absent cough and gag reflexes.</li>\n</ul>\n</li>\n<li><strong>Isoelectric EEG (confirmatory)</strong></li>\n</ul>\n<p>All these tests should be recorded. If there is no change after 24 hours, then the patient is declared brain dead.</p>\n<p><strong>Philadelphia protocol</strong>, <strong>Minnesota criteria</strong> are other criteria used to diagnose brain death.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Kevorkian sign is seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Cornea"
      },
      {
        "id": 2,
        "text": "Retinal vessels"
      },
      {
        "id": 3,
        "text": "Pupil"
      },
      {
        "id": 4,
        "text": "Vitreous humour"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Kevorkian sign</strong> is a postmortem change that occurs in the<strong> retinal vessels.</strong></p>\n<ul>\n<li>It is characterised by <strong>fragmentation of blood column</strong> in the retinal vessels.</li>\n<li>It <strong>appears</strong> <strong>within minutes</strong> after death and <strong>lasts</strong> for about <strong>1 hour.</strong></li>\n<li>It can be<strong> visualised</strong> by using an <strong>ophthalmoscope.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/945b80c0ec924feb8f66e87874db76f8x600x503.JPEG"
    ]
  },
  {
    "text": "During the examination of a victim of assault, you noticed the following wound shown in the image below. You would document this wound as:",
    "choices": [
      {
        "id": 1,
        "text": "Incised wound"
      },
      {
        "id": 2,
        "text": "Chopped wound"
      },
      {
        "id": 3,
        "text": "Lacerated wound"
      },
      {
        "id": 4,
        "text": "Stab wound"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>The given image is most likely suggestive of a <strong>stab wound</strong> because of the presence of <strong>fish-tails</strong>.</p>\n<p>A<strong>&nbsp;stab wound</strong>&nbsp;is a type of mechanical injury that is produced when&nbsp;<strong>force</strong>&nbsp;is applied along the&nbsp;<strong>long axis</strong>&nbsp;of a narrow, pointed object like a&nbsp;<strong>knife</strong>, sword, chisel, needle, screwdriver, etc into the depth of the body. The characteristics are</p>\n<ul>\n<li>The margins of the wound are&nbsp;<strong>clean-cut</strong>&nbsp;and&nbsp;<strong>inverted.</strong>&nbsp;</li>\n<li>The&nbsp;<strong>length</strong>&nbsp;of the wound&nbsp;is slightly&nbsp;<strong>less</strong>&nbsp;than the&nbsp;<strong>width</strong>&nbsp;of the&nbsp;<strong>weapon.&nbsp;</strong></li>\n<li>The&nbsp;<strong>width</strong>&nbsp;of the wound corresponds to the&nbsp;<strong>maximum possible width&nbsp;</strong>of the<strong>&nbsp;blade.&nbsp;</strong></li>\n<li>The&nbsp;<strong>depth</strong>&nbsp;of the wound is&nbsp;<strong>greater than</strong>&nbsp;the&nbsp;<strong>length and width&nbsp;</strong>of the external injury on the skin surface.</li>\n<li>The shape of the surface wound depends on the type of weapon, cutting surface, the direction of thrust, cleavage lines, etc.</li>\n<li>The shape of the wound is usually triangular or wedge-shaped. Depending on the type of instrument used, one side of the wound may be sharp, while another side may be blunt.</li>\n<li>The blunt side may show small splits at each corner called&nbsp;<strong>fishtailing</strong>&nbsp;as shown below.&nbsp;</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/297c99db707b49d29ae89739bc37a97b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76787a1f7b2045c1b869455cf919dfdfx1279x1070.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a23bd457e49047e9b0351a28b0bc2272x512x236.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7622a54c81604bbf8535f584f9781b25x1280x1525.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/25752205fa324cb99ca3ffefbd366b33x600x782.JPEG"
    ]
  },
  {
    "text": "A dead body is found at a crime scene. On examining it, you notice that fixation of hypostasis has already occurred. What is the minimum time required for this finding to occur?",
    "choices": [
      {
        "id": 1,
        "text": "2 hours"
      },
      {
        "id": 2,
        "text": "4 hours"
      },
      {
        "id": 3,
        "text": "6 hours"
      },
      {
        "id": 4,
        "text": "24 hours"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Fixation</strong> of<strong> hypostasis</strong> occurs <strong>6 &ndash; 12 hours after death</strong>.</p>\n<p>Purple or<strong> reddish-purple discoloration</strong> of the skin due to <strong>collection </strong>of<strong> blood </strong>in <strong>toneless capillaries</strong> in <strong>dependant parts </strong>of the body. It is called postmortem hypostasis/ postmortem staining/ postmortem lividity/ livor mortis/ suggilation/ vibices.</p>\n<p>Timing of development of postmortem hypostasis:</p>\n<ul>\n<li>Mottled patches &ndash; 1-3 hours following the death</li>\n<li>Uniform area of staining &ndash; 3-6 hours following death</li>\n<li>Fully developed and fixation of hypostasis &ndash; 6-12 hours</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A Forensic Examiner receives the following skull of a victim of mob violence. Which of the following conclusions he makes is correct:",
    "choices": [
      {
        "id": 1,
        "text": "The victim could have suffered a blunt force trauma"
      },
      {
        "id": 2,
        "text": "It is not possible to determine the sequence of injuries from fracture pattern"
      },
      {
        "id": 3,
        "text": "The victim could only have suffered from a gun-shot wound as indicated by Puppe\u2019s rule"
      },
      {
        "id": 4,
        "text": "Fracture pattern in skull injuries are random and offer no clue upon examination"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Puppe\u2019s Rule is true for <strong>all blunt injuries to the skull</strong>, and it is of particular importance in <strong>gunshot wounds.</strong> But the rule is <strong>not limited to gunshots</strong>.</p>\n<p>Puppe\u2019s rule: It is possible to determine the s<strong>equence of injuries in skull fractures</strong> caused by blunt injuries to the head because the second fracture ends at the point where a break in cohesion is already present. A new fracture Line does not cross an existing fracture line which can be used to determine the sequence of injuries.</p>\n<p>Ex:- <strong>Correct sequence</strong> of shots in this would be 1-&gt;2-&gt;3</p>\n<p><strong>Note -\u00a0</strong>Puppe's rule applies to any multiple blunt force trauma causing skull fractures.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9c158155842944ffb0567bec3f7e3a73.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A man was found dead due to starvation.Which of the following findings will be seen on autopsy?",
    "choices": [
      {
        "id": 1,
        "text": "Distended gall bladder"
      },
      {
        "id": 2,
        "text": "Enlarged liver"
      },
      {
        "id": 3,
        "text": "Expanded lungs"
      },
      {
        "id": 4,
        "text": "Hypertrophied heart"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In <strong>starvation, </strong>the<strong> gall bladder</strong> <strong>is distended</strong>.</p>\n<p>In starvation,&nbsp;<strong>bile does not get secreted into the duodenum </strong>due to the absence of food entering the stomach and intestine. So <strong>bile gets</strong> <strong>accumulated </strong>in the gall bladder and gets <strong>distended</strong>.</p>\n<p>Starvation:</p>\n<ul>\n<li>The<strong> feeling of intense hunger</strong> lasts for <strong>30&ndash;48 hours.</strong></li>\n<li>A person can survive for <strong>10&ndash;12 days without food and water</strong> and for <strong>6&ndash;8 weeks without food alone</strong>.</li>\n<li>Loss of <strong>40% of body weight</strong> is usually <strong>fatal</strong>.</li>\n<li>Loss of 70&ndash;90% of body fat and 20% of body protein is fatal.</li>\n<li>There is a&nbsp;<strong>reduction </strong>in the<strong> weight </strong>and size of all organs<strong> except the brain</strong>.</li>\n</ul>\n<p>Other features of starvation:</p>\n<ul>\n<li>Dry, lustreless hair</li>\n<li>Brittle nails&nbsp;</li>\n<li><strong>Pale skin</strong> with edema around ankles</li>\n<li>Loss of fat in subcutaneous tissue, in the omentum&nbsp;<br />(sparing of fat in female breast and orbit till later)</li>\n<li><strong>Atrophy of muscles</strong> and darkening due to lipochrome</li>\n<li>The <strong>heart is atrophied</strong> with empty chambers</li>\n<li><strong>Pale and collapsed lung</strong></li>\n<li><strong>Shrunken liver</strong> with necrosis</li>\n<li>Tissue paper-like intestinal mucosa</li>\n<li>Empty bladder</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 19-year-old boy is brought to the doctor because his family found him dressed as a woman. He says that he derives sexual pleasure from this act. However, he has no wish to undergo sex-change surgery. What is this type of perversion called?",
    "choices": [
      {
        "id": 1,
        "text": "Transsexualism"
      },
      {
        "id": 2,
        "text": "Fetishistic transvestism"
      },
      {
        "id": 3,
        "text": "Frotteurism"
      },
      {
        "id": 4,
        "text": "Gender dysphoria"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of<strong> fetishistic transvestism. </strong></p>\n<p>It<strong>&nbsp;</strong>is a&nbsp;paraphilia characterized by recurrent sexually arousing fantasies, sexual urges, or behavior involving the wearing of clothes of the opposite sex and appearing as a member of the opposite sex. It is also called&nbsp;<strong>transvestic fetishism. </strong>It is usually seen in males who obtain sexual pleasure by wearing female clothes.</p>\n<p>Fetishistic transvestism is a paraphilia whereas transvestism is a gender identity disorder.&nbsp;There is no hormonal/genital abnormality in fetishistic transvestism.</p>\n<p>Option A: <strong>Transsexualism </strong>refers to&nbsp;an obsessional desire to become a member of the opposite sex and seek surgery for anatomical alterations.&nbsp;</p>\n<p>Option C: <strong>Frotteurism&nbsp;</strong>refers to a&nbsp;person who obtains sexual gratification by contact with another person (rubbing his private parts against female buttocks, breasts, or thighs, in public places). It is punishable under&nbsp;Section <strong>290 IPC</strong>, with fine up to 200 Rs.</p>\n<div class=\"wDYxhc\" lang=\"en-IN\" data-md=\"61\">\n<div class=\"LGOjhe\" role=\"heading\" data-attrid=\"wa:/description\" aria-level=\"3\" data-hveid=\"CAsQAA\"><span class=\"ILfuVd\"><span class=\"hgKElc\">Option D: <strong>Gender dysphoria</strong> is a term that&nbsp;describes a sense of unease that a person has due to&nbsp;a <strong>mismatch </strong>between their<strong> biological sex </strong>and<strong> their gender identity</strong>. This sense of unease or dissatisfaction can lead to depression and anxiety and can have a harmful impact on daily life.</span></span></div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Section 89 of the BNS deals with ____",
    "choices": [
      {
        "id": 1,
        "text": "Death of the mother by an act done with intent to cause miscarriage"
      },
      {
        "id": 2,
        "text": "Concealment of birth and secret disposal of the fetus are punishable."
      },
      {
        "id": 3,
        "text": "Causing the death of the quick unborn child by an act amounting to culpable homicide"
      },
      {
        "id": 4,
        "text": "Causing miscarriage without woman\u2019s consent."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Section 89 (IPC 313)</strong>\u00a0of BNS, states that if <strong>miscarriage is done without the consent of the woman, the punishment is life imprisonment.</strong></p>\n<p>Related sections:</p>\n<ul>\n<li><strong>Section 90 (IPC 314) </strong>of the BNS deals with the<strong> death of the mother caused by an act done with intent to cause miscarriage.\u00a0</strong>(Option A)</li>\n<li><strong>Section 94(IPC 318)</strong> of BNS \u2013 deals with <strong>concealment of birth and secret disposal of the fetus are punishable.\u00a0</strong>(Option B)</li>\n<li><strong>Section 92 (IPC 316)</strong> of BNS, states that an act leading to the<strong> death of a quick unborn child, done with the intention of preventing a child from being born alive, is guilty of culpable homicide and shall be punished with imprisonment of either description for a term that may extend to ten years and shall also be liable to a fine</strong>. (Option C)</li>\n<li><strong>Section 93(IPC 317)</strong> of BNS, <strong>exposure or abandoning children are both punishable</strong>.</li>\n<li><strong>Section 94 (IPC 318)</strong> of BNS \u2013 <strong>concealment of birth and secret disposal of the fetus are punishable.</strong></li>\n</ul>\n<p>Note- The phrase \u201cquick with child\u201d refers to advanced pregnancy when quickening can be felt.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The \u2018en masse\u2019 removal of organs is a feature of which of the following autopsy techniques?",
    "choices": [
      {
        "id": 1,
        "text": "Virchow technique"
      },
      {
        "id": 2,
        "text": "Rokitansky technique"
      },
      {
        "id": 3,
        "text": "Ghon technique"
      },
      {
        "id": 4,
        "text": "Letulle technique"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The &lsquo;en masse&rsquo; removal of organs&nbsp;is done in the <strong>Letulle technique.</strong></p>\n<p>It is the removal of the cervical, thoracic, abdominal and pelvic organs as a single organ mass. They are subsequently dissected into organ blocks.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which type of mechanical asphyxia does the image shown below represent?",
    "choices": [
      {
        "id": 1,
        "text": "Burking"
      },
      {
        "id": 2,
        "text": "Bansdola"
      },
      {
        "id": 3,
        "text": "Mugging"
      },
      {
        "id": 4,
        "text": "Garroting"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The type of mechanical asphyxia shown in the image is <strong>m</strong><strong>ugging.</strong></p>\n<p><strong>Mugging</strong> is a type of <strong>strangulation</strong> caused by <strong>holding the neck </strong>of the <strong>victim\u00a0</strong>in the <strong>crook of the elbow</strong>. Pressure is then exerted either on the front of the larynx or at one or both sides by the forearm and upper arm. In mugging, the attack is\u00a0usually made <strong>from behind</strong>. The image below shows strangulation by mugging.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d0428a2b12114b838f7a6bb0497adf21.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4e7d53599a8b48168b62ba588dc8d9dex1280x1713.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/28f8f234ad1246b998bf5284e9e6de6dx1280x1317.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/057130193d6d4b7eb978e43038b8ed05x1280x1091.JPEG"
    ]
  },
  {
    "text": "The venom of the snake shown in the image is most likely to be:",
    "choices": [
      {
        "id": 1,
        "text": "Myotoxic"
      },
      {
        "id": 2,
        "text": "Haemotoxic"
      },
      {
        "id": 3,
        "text": "Vasculotoxic"
      },
      {
        "id": 4,
        "text": "Neurotoxic"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The snake in the given image is a <strong>sea snake\u00a0</strong>and it's venom is<strong>\u00a0myotoxic.\u00a0</strong></p>\n<p class=\"p1\"><span class=\"s1\">Sea snakes are myotoxic. Myotoxin causes\u00a0a non-enzymatic mechanism that leads to severe muscle necrosis.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c857262bc3234fd28164612db3406a65.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Crown heel length of a 6 month old fetus would be:",
    "choices": [
      {
        "id": 1,
        "text": "36 cm"
      },
      {
        "id": 2,
        "text": "30 cm"
      },
      {
        "id": 3,
        "text": "25 cm"
      },
      {
        "id": 4,
        "text": "12 cm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Crown heel length of a 6-month old fetus would be<strong> 30 cm.</strong></p>\n<p>According to the Rule of Hasse:</p>\n<ul>\n<li>During the first five months of pregnancy the square root of the length gives the approx. age of the fetus in months.</li>\n<li>During last five months the length in centimeters is divided by five gives the age in months.</li>\n</ul>\n<p>Age of fetus in first five months = square root of the crown heel length in cm.</p>\n<p>Age of the fetus during <strong>last 5 months</strong> of pregnancy = (Crown heel length in cm)/5</p>\n<p>So,<strong> crown heel length = age in months \u00d7 5 i.e. 6 \u00d7 5 = 30 cm.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A female convict was allegedly tortured and raped by an investigating officer while in police custody. Under which section will the inquest be conducted?",
    "choices": [
      {
        "id": 1,
        "text": "BNS Section 63 (375 IPC )"
      },
      {
        "id": 2,
        "text": "BNS Section 68 (376-C IPC)"
      },
      {
        "id": 3,
        "text": "BNSS Section 196 (176 CrPC)"
      },
      {
        "id": 4,
        "text": "BNSS Section 194 (174 CrpC)"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario is indicative of <strong>custodial rape</strong>. A magistrate inquest is done under <strong>BNSS Section 196 (Section 176 CrPC)</strong>.</p>\n<p><strong>Custodial rape</strong> is defined as the offence committed by persons who are in supervisory positions indulging in sexual intercourse with women in their custody by inducing or seducing the woman by taking advantage of his official position.</p>\n<p><strong>BNSS 196 (Section 176 CrPC)</strong> deals with magistrate inquest in which the cause of death is not under natural circumstances. Magistrate inquest may be conducted by the District Magistrate, Sub-Divisional Magistrate, Tahsildar, or any other Executive Magistrate empowered by the State Government.</p>\n<p>Indications for Magistrate Inquest:</p>\n<ul>\n<li><strong>Custodial rape</strong></li>\n<li>Death in police custody or police interrogation</li>\n<li>Death in police firing</li>\n<li>Death in prison, reformatories, Borstal school</li>\n<li>Death in a psychiatric hospital</li>\n<li>Dowry death</li>\n<li>Cases of exhumation.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A- <strong>BNS Section 63 (Section 375 IPC)</strong>deals with the definition of<strong> rape</strong>. In BNS 63, the Age of Consent of 15 years is replaced by 18 years in BNS. Exception 2 of Section 63 states that \u201csexual intercourse or acts by a man with his wife, the wife not being under 18 years of age, is not rape\u201d.</p>\n<p>Option B- <strong>BNS Section 68 (Section 376 IPC)</strong> deals with any person who holds <strong>authority</strong> or a fiduciary role, is a <strong>public servant</strong>, manages a jail, remand home, custody facility, or <strong>women\u2019s/children\u2019s institution</strong>, and misuses their position or relationship of trust to induce or seduce a woman in their custody, charge, or present on the premises into having<strong> sexual intercourse </strong>with them (<strong>not amounting to rape</strong>), shall face imprisonment for a term of no less than<strong> five years,</strong> which may <strong>extend</strong> to <strong>ten years</strong>, along with a <strong>fine</strong>.</p>\n<p>Option D- <strong>BNSS Section 194 (Section 174 CrPC)</strong> deals with the <strong>police inquest</strong>. It is done in suicide, homicide, killing by any animal or machinery or accident, and death under circumstances that raise suspicion of another person committing the offence.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A girl who is _____  years old can give consent for general physical examination but neither can she be employed in a factory nor can she give consent for sexual intercourse.",
    "choices": [
      {
        "id": 1,
        "text": "15 years"
      },
      {
        "id": 2,
        "text": "11 years"
      },
      {
        "id": 3,
        "text": "10 years"
      },
      {
        "id": 4,
        "text": "13 years"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A girl who is <strong>13 years old</strong>, can give consent for general physical examination but neither can she be employed in a factory nor can she give consent for sexual intercourse.</p>\n<p>This is because the legal age for general physical examination is<strong> 12 years</strong>, for employment in a factory is <strong>14 years</strong> and for consent for sexual intercourse is <strong>18 years</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to you with a history of ingestion of one uncrushed seed similar to that shown in the image below. He is asymptomatic at presentation. Which of the following can be anticipated in this case?",
    "choices": [
      {
        "id": 1,
        "text": "No poisonous action"
      },
      {
        "id": 2,
        "text": "Confusion followed by coma"
      },
      {
        "id": 3,
        "text": "Severe convulsions followed by death"
      },
      {
        "id": 4,
        "text": "Opisthotonos followed by respiratory paralysis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows seeds of <strong>Strychnos-nux vomica</strong>. If swallowed <strong>uncrushed</strong>, the seeds of nux vomica have <strong>no poisonous action</strong>, as they are not dissolved in the gastrointestinal tract, and are passed entirely in the faeces.</p>\n<p>Strychnine is a competitive antagonist of <strong>glycine</strong> at the postsynaptic receptors in the motor neurons of the anterior horn of the spinal cord. This leads to increased activity in the motor neurons. The fatal dose is <strong>15-30 mg</strong> of strychnine or<strong> one crushed seed.</strong></p>\n<p>Patients typically present with symptoms similar to <strong>tetanus</strong> such as</p>\n<ul>\n<li><strong>Convulsions</strong> are clonic initially but eventually become tonic. The anti-gravity muscles experience the most severe convulsions, causing the body to typically arch in hyperextension\u2014a position called opisthotonus.</li>\n<li><strong>Risus sardonicus</strong> which results from the <strong>contraction of the jaws and facial muscles</strong> in which the corners of the mouth are drawn back.</li>\n<li>If the spasm involves the abdominal muscles, the body bends forward <strong>(emprosthotonos),</strong> or to the side <strong>(pleurosthotonus).</strong></li>\n<li>If death is preceded by a severe convulsion, as in strychnine poisoning, it causes an increase in the body temperature known as <strong>postmortem caloricity.</strong></li>\n</ul>\n<p>The first step in the management of strychnine poisoning is to control convulsions with <strong>benzodiazepines or barbiturates</strong> and the patients should be placed in a <strong>dark room</strong> to avoid triggering further convulsions. <strong>Activated charcoal</strong> can be used to adsorb unabsorbed poison after a thorough stomach wash. <strong>Acidification of urine </strong>can be done to increase the excretion of strychnine.</p>\n<p>The toxin strychnine does not affect any receptors in the brain and the person remains conscious till death. Strychnine poisoning is characterized by <strong>conscious seizures.\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/25394b21de9d4bd9955ffaba14fd12c1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old child with a history of developmental delay is brought to a pediatric psychologist for evaluation after being involved in an incident where he caused significant damage to a neighbour's property. The child appears to lack an understanding of the consequences of his actions and exhibits signs of emotional immaturity. He will not be held guilty under which Bhartiya Nyaya Sanhita (BNS) section?",
    "choices": [
      {
        "id": 1,
        "text": "24"
      },
      {
        "id": 2,
        "text": "23"
      },
      {
        "id": 3,
        "text": "21"
      },
      {
        "id": 4,
        "text": "22"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given case of a 10-year-old child involved in property damage, he will not be held legally responsible under <strong>BNS (Bhartiya Nyaya Sanhita)</strong> <strong>Section 21 (IPC 83)</strong>. This section specifies that a child aged <strong>7 to 12</strong>, who demonstrates<strong> insufficient mental maturity</strong>, is not deemed criminally liable for their actions.</p>\n<p>Given the child's developmental delays and lack of comprehension regarding the repercussions of his behaviour, he is protected from legal penalties or prosecution due to his inadequate mental maturity.</p>\n<p>Other options:</p>\n<p>Option A: BNS section <strong>24(IPC 86) </strong>states that a person who commits an offence under <strong>voluntary intoxication</strong> is <strong>liable for the act.</strong></p>\n<p>Option B: BNS section <strong>23(IPC 85)</strong> states that a person who commits an offence under <strong>involuntary intoxication</strong> is <strong>not liable for the act.</strong></p>\n<p>Option D: BNS section <strong>22(IPC 84)</strong> states that an act of a person of an <strong>unsound mind</strong> (e.g. schizophrenia) is not liable for punishment or prosecution.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You were posted for an autopsy of a 34-year-old tribal man who was under police custody for interrogation. On external examination, signs of third-degree torture were present. Which of the following incisions is preferred to detect and evaluate the hidden subcutaneous hemorrhage?",
    "choices": [
      {
        "id": 1,
        "text": "I-shaped incision"
      },
      {
        "id": 2,
        "text": "Elongated X-shaped incision"
      },
      {
        "id": 3,
        "text": "Y-shaped incision"
      },
      {
        "id": 4,
        "text": "Modified Y-shaped incision"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is suggestive of <strong>custodial death</strong>. The incision that is preferred to detect and evaluate the hidden subcutaneous hemorrhage is the\u00a0<strong>elongated</strong> <strong>X- shaped incision</strong>.</p>\n<p>An elongated X-shaped incision is used to dissect subcutaneous structures in the back of the body. It helps identify and evaluate the extent of blunt injuries when superficial imprints are faint. This type of incision is<strong> helpful in the reconstruction of events before death</strong> and is practiced in custodial death.</p>\n<p>The image below shows the 'elongated X- shaped' incision:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f5bc395419e40af8753df2c750a35c7x1280x1462.JPEG"
    ]
  },
  {
    "text": "Which of the following indicates a female skull?",
    "choices": [
      {
        "id": 1,
        "text": "Prominent mastoid process"
      },
      {
        "id": 2,
        "text": "Large parietal eminences"
      },
      {
        "id": 3,
        "text": "Square orbits with round margins"
      },
      {
        "id": 4,
        "text": "Small frontal eminences"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Large parietal eminences </strong>indicate a<strong> female skull.</strong></p>\n<p>Differentiating features between male and female skulls:</p>\n<table style=\"height: 293px;\" width=\"298\">\n<tbody>\n<tr>\n<td style=\"width: 92px;\">Trait</td>\n<td style=\"width: 92px;\">Male</td>\n<td style=\"width: 92px;\">Female</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">General size</td>\n<td style=\"width: 92px;\">Large</td>\n<td style=\"width: 92px;\">Small</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Architecture</td>\n<td style=\"width: 92px;\">Rugged</td>\n<td style=\"width: 92px;\">Smooth</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Supraorbital ridges</td>\n<td style=\"width: 92px;\">Prominent</td>\n<td style=\"width: 92px;\">Less prominent</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Mastoid process</td>\n<td style=\"width: 92px;\">Prominent</td>\n<td style=\"width: 92px;\">Less prominent</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Occipital region</td>\n<td style=\"width: 92px;\">Marked muscle markings</td>\n<td style=\"width: 92px;\">No marked muscle markings</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Frontal eminences</td>\n<td style=\"width: 92px;\"><strong>Small</strong></td>\n<td style=\"width: 92px;\"><strong>Large</strong></td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Parietal eminences</td>\n<td style=\"width: 92px;\"><strong>Small</strong></td>\n<td style=\"width: 92px;\"><strong>Large</strong></td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Orbits</td>\n<td style=\"width: 92px;\">Square with round margins</td>\n<td style=\"width: 92px;\">Round with sharp margins</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Mandible</td>\n<td style=\"width: 92px;\">Large, broad ramus</td>\n<td style=\"width: 92px;\">Small, small ramus</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">Chin shape</td>\n<td style=\"width: 92px;\">U-shaped</td>\n<td style=\"width: 92px;\">V-shaped</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the active principle of the poison shown in the image?",
    "choices": [
      {
        "id": 1,
        "text": "Ricin"
      },
      {
        "id": 2,
        "text": "Abrin"
      },
      {
        "id": 3,
        "text": "Thevetin"
      },
      {
        "id": 4,
        "text": "Bhilawanol"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shows<strong> black, heart-shaped seeds with hard rinds</strong> that identify them as seeds of <strong>Semecarpus anacardium,</strong> and its active principles are <strong>bhilawanol and semicarpol.</strong> Common names are marking nut, bhilwan, bibva, bhela, and oriental cashew.</p>\n<p>Within the fruit is a thick fleshy pericarp that yields the active principle, which is a <strong>brown oily resinous fluid </strong>called bhilawanol.\u00a0</p>\n<p>The juice when applied locally to the skin <strong>produces irritation, painful blisters,</strong> itching, and eczematous eruption. The seeds are used to produce an <strong>artificial bruise.</strong> Symptoms such as pain, fever, and painful passage of brownish urine may be seen.</p>\n<p>A large dose taken orally can produce blisters in the mouth and throat, with gastroenteritis. It also produces dyspnea, cyanosis, tachycardia, coma, and death. The fatal period is 12 to 24 hours.</p>\n<p>Medicolegal importance is the use of the juice by <strong>malingerers to fabricate wounds.</strong> Instilled in the eyes it can cause conjunctivitis or ophthalmia due to its local irritant effect.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Ricin</strong> is the active principle of <strong>Ricinus communis.</strong> It is a toxalbumin or phytotoxin that <strong>inhibits protein synthesis</strong> by affecting the ribosomal RNA polymerase. The seeds are flat to oval-shaped and have dark brown markings (shown below). It is a <strong>chemical warfare agent.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/50f85118bdf1412fb811934eba05915c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3f8117410e1f4947a1bed88f4f3c5d17x640x640.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5b041271ef4d438daa89a38de2fc0808x640x509.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1535a44c2c574b80b01d5dcf39d970c3x1024x768.JPEG"
    ]
  },
  {
    "text": "Olive Green colored urine is seen in poisoning with:",
    "choices": [
      {
        "id": 1,
        "text": "Organophosphates"
      },
      {
        "id": 2,
        "text": "Kerosene"
      },
      {
        "id": 3,
        "text": "Carbolic acid"
      },
      {
        "id": 4,
        "text": "Oxalic acid"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Olive green urine</strong> is seen in <strong>carbolic acid poisoning.</strong></p>\n<p>In carbolic acid poisoning if the patient <strong>survives for 48 hrs</strong> there will be <strong>carboluria</strong> followed <strong>by anuria. </strong>The victim will pass dark, <strong>smoky urine</strong> which soon turns <strong>olive green</strong> <strong>on standing due to oxidation of hydroquinone and pyrocatechol.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/9dedb167c00348fea20d0c445794a690x440x518.PNG"
    ]
  },
  {
    "text": "Which of the following poison can be found even in skeletonised remains of the body?",
    "choices": [
      {
        "id": 1,
        "text": "Arsenic"
      },
      {
        "id": 2,
        "text": "Carbon monoxide"
      },
      {
        "id": 3,
        "text": "Hydrogen sulphide"
      },
      {
        "id": 4,
        "text": "Phosphorus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Arsenic</strong> can be found even in skeletonized remains of the body.</p>\n<p>Arsenic becomes fixed in the cancellous tissues of the long bones by\u00a0<strong>conversion of phosphates to arsenates.\u00a0</strong>The elimination of arsenic in this form is much slower and can be detected in the bones for several years after death.</p>\n<p><strong>Heavy metals</strong> such as\u00a0<strong>lead</strong>, <strong>copper</strong>,\u00a0<strong>mercury</strong>, including metalloids like <strong>arsenic </strong>and<strong>\u00a0antimony</strong>, may be found in bones for a prolonged period in cases of chronic poisoning. They are also deposited in hair, nails, etc. For these reasons, when heavy metal poisoning is suspected, these specimens are collected in addition to the routine viscera and body fluids.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old man files a case against a surgeon who left a cotton swab inside his abdomen after a hernia repair. Which of the following best describes this scenario of medical negligence?",
    "choices": [
      {
        "id": 1,
        "text": "Res judicata"
      },
      {
        "id": 2,
        "text": "Res ipsa loquitur"
      },
      {
        "id": 3,
        "text": "Res indicata"
      },
      {
        "id": 4,
        "text": "Novus actus interveniens"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Res ipsa loquitur\u00a0</strong>best describes this scenario under medical negligence.</p>\n<p>Res ipsa loquitur means the <strong>facts</strong> of the case <strong>speak</strong>\u00a0<strong>for</strong>\u00a0<strong>themselves.</strong></p>\n<p>Normally, in cases of <strong>medical negligence,</strong> the <strong>burden</strong> of <strong>proof lies</strong> on the <strong>patient</strong> to prove the doctor guilty. However, the patient <strong>need</strong> <strong>not</strong> <strong>prove</strong> any negligence <strong>under Res ipsa loquitur.</strong></p>\n<p>The <strong>conditions</strong> to be <strong>fulfilled</strong> for Res Ipsa Loquitur are:</p>\n<ul>\n<li>The injury or <strong>damage</strong> would <strong>not</strong> have <strong>occurred</strong> <strong>without negligence</strong></li>\n<li>The <strong>doctor</strong> is in <strong>exclusive control</strong> of the instrumentation or <strong>circumstances</strong></li>\n<li>The <strong>patient</strong> must <strong>not</strong> <strong>contribute</strong> to his own injury or <strong>damage</strong></li>\n</ul>\n<p>Several situations can be used as defenses by the doctor against medical negligence. This includes no duty owed to the plaintiff/ patient, the doctor's duty has been discharged according to prevailing standards, a scenario of misadventure<strong>\u00a0</strong>that\u00a0may be therapeutic, diagnostic, and experimental, or an error of judgment.</p>\n<p>Other options:</p>\n<p>Option A:\u00a0<strong>Res judicata </strong>under section <strong>300 Cr. P.C</strong> states that if a question of negligence against a doctor has already been decided by a court in a dispute between the doctor and his patient, the patient will not be allowed to contest the same question.</p>\n<p>Option C:<strong> Limitation</strong>\u00a0or\u00a0<strong>Res indicata</strong>\u00a0indicates that a suit for damages for negligence should be filed against the doctor <strong>within two years</strong> from the date of alleged negligence. A suit\u00a0<strong>filed after two years</strong> will be<strong> dismissed</strong>. But, where a breach of duty to provide care as per a particular contract between a patient and a doctor is committed, legal action can be initiated <strong>up to three years</strong> from the date of alleged negligence.</p>\n<p>Option D:\u00a0<strong>Novus Actus Interveniens</strong>\u00a0is a situation where the cause of disability or death passes from the doctor to a later negligent action of some other person. It means a person is responsible not only for his actions but also for the logical consequences of those actions.\u00a0For a plea of Novus actus, an element of negligence is absolutely essential.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A forensic pathologist is examining a body discovered buried in soil, noting the decomposition stage suggests the body had been buried for approximately 8 days.\u00a0If the body had been left exposed to air under similar environmental conditions, what would be the estimated time since death based on Casper's dictum?",
    "choices": [
      {
        "id": 1,
        "text": "1 day"
      },
      {
        "id": 2,
        "text": "8 days"
      },
      {
        "id": 3,
        "text": "64 days"
      },
      {
        "id": 4,
        "text": "32 days"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>As the decomposition stage suggests the body had been buried for approximately 8 days,\u00a0the equivalent decomposition in air would have taken place in <strong>1/8th</strong> of that time.</p>\n<p><strong>Casper's rule</strong> or <strong>dictum</strong> states that a <strong>body decomposes in the air twice as fast as submerged in water, and eight times faster as buried in earth.</strong></p>\n<p>Therefore, the <strong>rate of decomposition</strong> is <strong>Air &gt; Water &gt; Soil</strong>. It is helpful in the estimation of time since death. \u00a0</p>\n<p>Free access of air hastens putrefaction, partly because the <strong>air</strong> conveys organisms to the body. Putrefaction is rapid in a body buried in a <strong>damp, marshy</strong> or<strong> shallow</strong> grave without clothes or coffin, because the body is exposed to constant changes of temperature. <strong>Putrefaction</strong> is <strong>more rapid</strong> in <strong>warm, fresh water than in cold, salt water</strong>. It is <strong>more rapid</strong> in <strong>stagnant water</strong> than in <strong>running water</strong>.</p>\n<p>Note: Forensic taphonomy is the study and interpretation of postmortem processes of human remains i.e. the history of a body following death.<br />The ratio of the time a body takes to decompose in <strong>air, water, and soil</strong> is <strong>1:2:8</strong>. This means that the time taken by soil is greater than water and air. So, the correct order of time taken for decomposition is Soil &gt; Water &gt; Air.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following tests can be used to check the cessation of circulation, except:",
    "choices": [
      {
        "id": 1,
        "text": "Diaphanous test"
      },
      {
        "id": 2,
        "text": "Winslow\u2019s test"
      },
      {
        "id": 3,
        "text": "Magnus\u2019s test"
      },
      {
        "id": 4,
        "text": "Icard\u2019s test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Winslow\u2019s test </strong>is used to check the <strong>cessation</strong> <strong>of respiration </strong>while the<strong> Diaphanous test, Magnus\u2019s test and Icard\u2019s test </strong>are done to check the<strong> cessation of circulation. </strong>\u00a0</p>\n<p>Winslow's test consists of placing a <strong>bowl of water on the chest </strong>and monitoring the movement on the water's surface.</p>\n<p>Other tests for confirming cessation of breathing. are:</p>\n<ul>\n<li><strong>No audible breath sounds</strong> on continuous auscultation of the upper part of the chest and in front of or on the larynx for a <strong>minimum of 5 minutes</strong></li>\n<li>Feather test \u2013 No movement of a feather held in front of the nose</li>\n<li>Mirror test \u2013 A mirror held in front of the nose does not turn dim due to any moisture in breath.</li>\n</ul>\n<p>Tests for confirming cessation of circulation:</p>\n<ul>\n<li><strong>No audible heart sounds</strong> on continuous auscultation on the precordial area of the chest for a minimum of <strong>5 minutes</strong> and a <strong>flat ECG</strong> recording for <strong>5 minutes</strong></li>\n<li><strong>Magnus\u2019s test (Ligature test) </strong>- Fingers fail to <strong>show congestion distal to a ligature </strong>applied at their base</li>\n<li><strong>Diaphanous test (Transillumination test)</strong> - Failure to show <strong>redness</strong> in the <strong>webspace</strong> between the fingers on transillumination from behind</li>\n<li><strong>Icard\u2019s test</strong> - Fluorescent dye on being injected at a given site in a dead body fails to produce any discoloration</li>\n<li>Fingernail test - <strong>No blanching and filling of blood</strong> in the fingernail on the application of pressure and release</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to the emergency department with a history of a gunshot wound sustained while on a hunting trip. X-ray findings are as given below. Which of the following weapons is most likely to produce this type of injury?",
    "choices": [
      {
        "id": 1,
        "text": "Shotgun"
      },
      {
        "id": 2,
        "text": "Assault rifle"
      },
      {
        "id": 3,
        "text": "Sporting rifle"
      },
      {
        "id": 4,
        "text": "Machine gun"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The radiograph is suggestive of a <strong>close-range shotgun blast injury</strong> to the knee. <strong>Birdshot</strong> <strong>pellets</strong> are visible within and around the shattered patella, distal femur, and proximal tibia.</p>\n<p>The ammunition for the shotgun is a cartridge made of a <strong>cardboard or plastic cylinder</strong> fitted into a <strong>metal base</strong>. The base carries a <strong>percussion detonator</strong> that is struck by the spring-loaded firing pin when the trigger is pulled.&nbsp; The&nbsp;<strong>primer&nbsp;</strong>is located in the percussion cup and contains the detonator.&nbsp; The cartridge contains a charge of <strong>propellant (gunpowder)</strong>, above which are &lsquo;<strong>wads</strong>&rsquo; or pistons of felt, and cardboard or plastic&nbsp;discs, or both. Above these is the <strong>charge of shot (pellets)</strong>, which varies greatly in number and size, finally covered by a card or plastic disc.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/90dbc75091be4ea39de45c8abc4c84fc.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bf642f8bbf254091a2984dec5c9a1fd8x1280x1201.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da24e106f4db44e7bd1abbdbbb3b617ex720x683.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/32be34f2407340a8be49d6bd0bd421a6x1279x1246.JPEG"
    ]
  },
  {
    "text": "A 15-year-old boy playing at the seashore drowned in the sea during high tide. Which of the following is seen in this type of drowning?",
    "choices": [
      {
        "id": 1,
        "text": "Hemoconcentration and hyponatremia"
      },
      {
        "id": 2,
        "text": "Hemodilution and hyponatremia"
      },
      {
        "id": 3,
        "text": "Hemodilution and hypernatremia"
      },
      {
        "id": 4,
        "text": "Hemoconcentration and hypernatremia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given scenario points towards <strong>sea water drowning. Hemoconcentration</strong> and <strong>hypernatremia</strong> is seen in this type of drowning.</p>\n<p>Seawater being <strong>hypertonic</strong> to <strong>plasma</strong> causes a shift of <strong>fluid</strong> from the <strong>blood</strong> to <strong>alveoli</strong> causing <strong>pulmonary edema.</strong> There is a net <strong>decrease</strong> in <strong>blood volume</strong> causing <strong>hemoconcentration</strong> and <strong>hypernatremia.</strong> This may lead to <strong>increased viscosity</strong> of blood and in turn lead to <strong>myocardial anoxia</strong> leading to heart failure and the RBCs get <strong>crenated.</strong></p>\n<p>Other options:\u00a0</p>\n<p>Option <strong>B: Hemodilution</strong> and <strong>hyponatremia</strong> are seen in <strong>freshwater drowning.</strong> In freshwater drowning water enters the hypotonic alveoli, which is absorbed to blood easily and will result in hemodilution. This leads to swelling of RBCs, leading to <strong>lysis of RBCs causing hyperkalemia.</strong> This may lead to <strong>ventricular fibrillation</strong> and cerebral anoxia within 3-5 minutes and death.</p>\n<p>Option A and C: Hemoconcentration with hyponatremia and hemodilution with hypernatremia are not seen in any form of drowning.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The least common fingerprint pattern is _____________.",
    "choices": [
      {
        "id": 1,
        "text": "Composite"
      },
      {
        "id": 2,
        "text": "Whorl"
      },
      {
        "id": 3,
        "text": "Loops"
      },
      {
        "id": 4,
        "text": "Arches"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Composite type (1-2%) is the least common fingerprint pattern.</p>\n<p>Patterns of fingerprints:</p>\n<ul>\n<li><strong>Loops</strong> - Most common type <strong>(60-70%)</strong></li>\n<li><strong>Whorl</strong> - (25-30%)</li>\n<li><strong>Arch</strong> - (6-7%) They may be plain, <strong>tented,\u00a0</strong>or exceptional.\u00a0</li>\n<li><strong>Composite forms (1 \u2013 2%) - least common</strong></li>\n</ul>\n<p>The study of ridge patterns in the skin is <strong>Dactylography/</strong> Galton-Henry system/ Dermatoglyphics. Fingerprints are the impressions of patterns produced by the papillary or epidermal ridges present on the fingertips.</p>\n<p>Classification of fingerprints into different patterns is based on <strong>delta and core formation. </strong>Delta is a <strong>triangular</strong> arrangement formed where three separate ridge line flows come together. The <strong>core</strong> is the <strong>centermost portion</strong> of a ridge flow pattern.\u00a0</p>\n<p>The number of delta and core for each pattern is given below.</p>\n<table style=\"border-collapse: collapse; width: 31.8495%; height: 134.391px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\"><strong>Pattern\u00a0</strong></td>\n<td style=\"width: 52.6012%; height: 22.3984px;\"><strong>Delta\u00a0</strong></td>\n<td style=\"width: 15.896%; height: 22.3984px;\"><strong>Core</strong></td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\">Loop</td>\n<td style=\"width: 52.6012%; height: 22.3984px;\">1</td>\n<td style=\"width: 15.896%; height: 22.3984px;\">1</td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 31.5029%; height: 44.7969px;\">Plain arch</td>\n<td style=\"width: 52.6012%; height: 44.7969px;\">0</td>\n<td style=\"width: 15.896%; height: 44.7969px;\">0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\">Tented arch</td>\n<td style=\"width: 52.6012%; height: 22.3984px;\">1 delta at the base of the upthrust</td>\n<td style=\"width: 15.896%; height: 22.3984px;\">0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\">Whorl</td>\n<td style=\"width: 52.6012%; height: 22.3984px;\">2</td>\n<td style=\"width: 15.896%; height: 22.3984px;\">1</td>\n</tr>\n</tbody>\n</table>\n<p>The image given below shows the delta and core in the different fingerprint patterns. For each type, the position of the core is marked with a green circle, and the delta is marked with a blue triangle.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2fc713c740f24137a525a1dbbee9a507x1280x2295.JPEG"
    ]
  },
  {
    "text": "Identify the type of skull fracture in the given image.",
    "choices": [
      {
        "id": 1,
        "text": "Depressed fracture"
      },
      {
        "id": 2,
        "text": "Pond fracture"
      },
      {
        "id": 3,
        "text": "Hinge fracture"
      },
      {
        "id": 4,
        "text": "Comminuted fracture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows a <strong>pond fracture of the skull.</strong></p>\n<p>It appears as an <strong>indentation</strong> or a <strong>buckling-in</strong> of the skull, without actual fracture. It is more commonly seen in <strong>infants</strong> due to the elasticity of the bones. They are caused by an <strong>obstetric forceps</strong> blade or a blow from a blunt object. The dura mater is not torn and usually, the brain is not damaged.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/439f2a0219c24f14847da51100aa445a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following tests on live birth are based on the changes in the middle ear?",
    "choices": [
      {
        "id": 1,
        "text": "Fodere\u2019s test"
      },
      {
        "id": 2,
        "text": "Ploucquet\u2019s test"
      },
      {
        "id": 3,
        "text": "Wredin\u2019s test"
      },
      {
        "id": 4,
        "text": "Breslau\u2019s second life test"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Wredin\u2019s test</strong> is based on the changes in the <strong>middle ear.</strong></p>\n<p><strong>Tests for live birth:</strong></p>\n<ul>\n<li><strong>Wredin\u2019s test</strong>\u00a0\u2013 Before birth, the middle ear does not contain air. It only contains gelatinous embryonic connective tissue. With respiration, the eustachian tube opens and the gelatinous substance is replaced by air. For this, the middle ear must be opened underwater by removing tegmen tympani. If an air bubble comes out, the test is said to be positive. This is <strong>not at all reliable.</strong></li>\n<li><strong>Fodere\u2019s test</strong>\u00a0\u2013 Based on the increase in the weight of the lung due to increased blood flow after birth. The weight of\u00a0unrespired lung is 30\u201340g whereas the weight of\u00a0respired lung is 60\u201366 g.</li>\n<li><strong>Ploucquet\u2019s test</strong>\u00a0\u2013 Based on the ratio of the weight of the lung to the weight of the body in unrespired and respired lungs.\n<ul>\n<li><strong>Unrespired lungs:</strong>\u00a0Weight of lungs: weight of body = 1:70</li>\n<li><strong>Respired lungs:\u00a0</strong>Weight of lungs: weight of body = 1:35</li>\n</ul>\n</li>\n<li><strong>Breslau\u2019s second life test:</strong>\u00a0Air enters the\u00a0<strong>stomach </strong>and<strong> intestine</strong> during respiration in a live-born fetus. So if respiration has taken place, they float in water, otherwise, they sink.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old boy is brought to OPD with complaints of pain over the forearm. On detailed examination, several wounds with cigarettes burns are found. X-ray showed a spiral fracture of the radius. Which of the following is least likely seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Subdural hematoma"
      },
      {
        "id": 2,
        "text": "Periosteal shearing"
      },
      {
        "id": 3,
        "text": "Multiple injuries at same stage of healing"
      },
      {
        "id": 4,
        "text": "Soft tissue swelling"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>battered baby syndrome</strong>. The classical feature of this condition is injuries inflicted are of <strong>different ages </strong>and in <strong>different stages of healing</strong>. This is due to the repetitive nature of child abuse.</p>\n<p>A battered child is one who has received <strong>repetitive physical injuries as a result of non-accidental\u00a0</strong><strong>violence, produced by a parent or guardian</strong>, there may also be deprivation of nutrition, care, and affection.</p>\n<p>This syndrome <strong>must be considered</strong> in any child:</p>\n<ul>\n<li>In whom the degree and type of injury varies with the history given</li>\n<li>When injuries are of different ages and in different stages of healing</li>\n<li>When there is a purposeful delay in seeking medical attention despite serious injury</li>\n<li>Who exhibits evidence of fracture of any bone, subdural hematoma, failure to thrive, soft tissue swelling or skin bruising</li>\n<li>Who dies suddenly</li>\n</ul>\n<p><span class=\"fontstyle0\"><strong>Skeletal survey</strong>, which includes the following, should be done in a case of suspected child abuse:</span></p>\n<ul>\n<li><span class=\"fontstyle0\">AP views of the entire skeleton</span></li>\n<li><span class=\"fontstyle0\">Dedicated views of hands and feet</span></li>\n<li><span class=\"fontstyle0\">Lateral views of the appendicular skeleton, skull, and spine</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Forensic Medicine Test';
        let hierarchy = ["Marrow", "FMGE Test Series Subject", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>