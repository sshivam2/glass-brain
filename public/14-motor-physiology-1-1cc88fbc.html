<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14 Motor Physiology - 1 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Physiology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">38</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Each muscle spindle consists of ______ intrafusal fibers.",
    "choices": [
      {
        "id": 1,
        "text": "12 to 24"
      },
      {
        "id": 2,
        "text": "3 to 12"
      },
      {
        "id": 3,
        "text": "1 to 3"
      },
      {
        "id": 4,
        "text": "24 to 50"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Each muscle spindle is 3 to 10 millimeters long. It is built around <strong>3 to 12</strong> tiny intrafusal muscle fibers that are attached to the glycocalyx of the surrounding large extrafusal skeletal muscle fibers.</li>\n<li>Each intrafusal muscle fiber is a tiny skeletal muscle fiber. However, the central region of each of these fibers has few or no actin and myosin filaments. Therefore, this central portion does not contract when the ends do. Instead, it functions as a <strong>sensory receptor</strong>. The end portions that do contract are excited by <strong>small gamma motor nerve fibers</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Motor supply to muscle spindle is _______",
    "choices": [
      {
        "id": 1,
        "text": "I\u03b1"
      },
      {
        "id": 2,
        "text": "II"
      },
      {
        "id": 3,
        "text": "\u03b3"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Motor supply to muscle spindle is\u00a0<strong>\u03b3</strong></p>\n<p>Muscle spindles have a motor nerve supply of their own.These nerves belong to<strong> Erlanger and</strong> <strong>Gasser\u2019s A\u0263 group</strong>. They are just <strong>3\u20136 \u03bc</strong> in diameter (hence called small motor nerve system/\u0263 efferents of Leksell) and go exclusively to muscle spindles.\u00a0</p>\n<p><strong>Note</strong>:</p>\n<ul>\n<li>Motor innervation of muscle spindle is by gamma efferents\u00a0</li>\n<li>Motor innervation of extrafusal fibers is by alpha motor neurons</li>\n</ul>\n<p>Nuclear bag muscle fibers: <strong>1\u20133 </strong>per muscle spindle.</p>\n<p>Nuclear chain muscle fibers: <strong>3\u20139</strong> per muscle spindle.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/19cbc22b5c36438da1aab1352395e3c0x1280x1244.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/18412681eab449b8b2efa70686542cfcx1280x1678.JPEG"
    ]
  },
  {
    "text": "Identify the type of nerve fibre in the diagram below.",
    "choices": [
      {
        "id": 1,
        "text": "Gamma Neuron"
      },
      {
        "id": 2,
        "text": "Alpha Neuron"
      },
      {
        "id": 3,
        "text": "Beta Neuron"
      },
      {
        "id": 4,
        "text": "Delta Neuron"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given figure, the fiber in yellow innervates the <strong>ends of the muscle spindle</strong>. Therefore, it is a&nbsp;<strong>gamma motor neuron. &nbsp;</strong></p>\n<p>Many much smaller gamma motor neurons are located in the <strong>spinal cord anterior horns </strong>(shown as the yellow efferent fiber). These gamma motor neurons average <strong>5 micrometers</strong> in diameter, which go to small, special skeletal muscle fibers called intrafusal fibers or the&nbsp;muscle spindle. These fibers constitute the ends of the muscle spindle, which help control <strong>basic muscle &ldquo;tone.&rdquo;&nbsp;</strong></p>\n<p><strong>Option (b):</strong></p>\n<p>The <strong>alpha motor neurons </strong>(shown as the blue efferent fibre) are on an average&nbsp;<strong>14 micrometers</strong> in diameter. These fibers branch many times after they enter the muscle and<strong> innervate the large skeletal muscle fibers at the motor endplate</strong>. Stimulation of a single alpha nerve fiber excites anywhere from three to several hundred skeletal muscle fibers, which are collectively called the <strong>motor unit.</strong></p>\n<p><strong>Option (c):</strong></p>\n<p>A-beta fibers are fibers for touch and pressure.</p>\n<p><strong>Option (d):</strong></p>\n<p>A-delta fibers are fibers for pain and temperature.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c040e3a449d04de797eea1dca92d028c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/30b848ac2f584f47801d896b36ec4bb7x1280x1643.JPEG"
    ]
  },
  {
    "text": "Which of the following is false with respect to muscle spindles?",
    "choices": [
      {
        "id": 1,
        "text": "The intrafusal and extrafusal fibers are positioned paralled to each other"
      },
      {
        "id": 2,
        "text": "The primary endings of intrafusal fibers are most sensitive to a dynamic response"
      },
      {
        "id": 3,
        "text": "Type II nerve fibers do not innervate static nuclear bag fibers"
      },
      {
        "id": 4,
        "text": "Two types of \u03b3 motor neurons supply the muscle spindle"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Type II nerve fibers do innervate the static nuclear bag fibers. They do not innervate dynamic nuclear bag fibers.</p>\n<p>A muscle spindle has:</p>\n<ul>\n<li>Intrafusal fibers - these are tiny skeletal muscles which have few or no actin and myosin filaments in the central portion. This portion acts as a sensory receptor.</li>\n<li>Extrafusal fibers</li>\n</ul>\n<p>These fibers are <strong>positioned paralle</strong>l to each other (Option A).</p>\n<p>There are two types of intrafusal fibers:</p>\n<ul>\n<li><strong>Nuclear bag</strong> fibers - subdivided as <strong>dynamic and static</strong> nuclear bag fibers</li>\n<li>Nuclear chain fibers</li>\n</ul>\n<p><strong>Sensory nerve supply</strong>: There are two types of sensory endings:</p>\n<ul>\n<li><strong>Primary endings</strong> - (<strong>annulospiral ending</strong>) from&nbsp;<strong>Type Ia</strong> nerve fibers. This innervates both the <strong>nuclear bag and nuclear chain</strong> fibers. They are most sensitive to the velocity of the change in muscle length. This is called a <strong>dynamic response. </strong>(Option B)</li>\n<li><strong>Secondary endings</strong> - from <strong>Type II</strong> nerve fibers. This innervates static nuclear bag and nuclear chain fibers. They <strong>do not innervate dynamic nuclear bag fibers. </strong>(Option C)&nbsp;</li>\n</ul>\n<p>Both primary and secondary endings show a static response.</p>\n<p><strong>Motor nerve supply:</strong> The muscle spindles are supplied by&nbsp;<strong>&gamma; motor neurons</strong>. There are <strong>two types</strong> of&nbsp;&gamma; motor neurons- dynamic that supply dynamic nuclear bag fibers and static that supply static nuclear bag fibers and nuclear chain fibers. (Option D)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d808e65b4f694be88dbce6c8e7354d90x1280x1678.JPEG"
    ]
  },
  {
    "text": "Which of the following is sensed by the nuclear bag fibers?",
    "choices": [
      {
        "id": 1,
        "text": "Dynamic length of muscle"
      },
      {
        "id": 2,
        "text": "Muscle tension"
      },
      {
        "id": 3,
        "text": "Joint position"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The nuclear bag fibers sense the <strong>dynamic length of the muscle.</strong></p>\n<p>Nuclear bag fibers are intrafusal fibers, which are a part of the muscle spindle. Intrafusal fibers serve a purely sensory function in the muscle spindle.</p>\n<p><strong>Types of intrafusal fibers in muscle spindles:</strong></p>\n<table style=\"width: 367px;\">\n<tbody>\n<tr>\n<td style=\"width: 172px;\"><strong>Feature</strong></td>\n<td style=\"width: 172px;\"><strong>Nuclear bag fibers</strong></td>\n<td style=\"width: 207px;\"><strong>Nuclear chain fibers</strong></td>\n</tr>\n<tr>\n<td style=\"width: 172px;\">Structure</td>\n<td style=\"width: 172px;\">Nuclei in central dilated area</td>\n<td style=\"width: 207px;\">Nuclei in rows</td>\n</tr>\n<tr>\n<td style=\"width: 172px;\">Types</td>\n<td style=\"width: 172px;\">\n<ul>\n<li>Static</li>\n<li>Dynamic</li>\n</ul>\n</td>\n<td style=\"width: 207px;\">----</td>\n</tr>\n<tr>\n<td style=\"width: 172px;\">Primary sensory afferent</td>\n<td style=\"width: 172px;\">Ia (for both the types)</td>\n<td style=\"width: 207px;\">&nbsp;Ia</td>\n</tr>\n<tr>\n<td style=\"width: 172px;\">Secondary sensory ending</td>\n<td style=\"width: 172px;\">II (only for static bag fiber)</td>\n<td style=\"width: 207px;\">II</td>\n</tr>\n<tr>\n<td style=\"width: 172px;\">Efferent</td>\n<td style=\"width: 172px;\">\n<div class=\"page\" title=\"Page 243\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>static &amp; dynamic &gamma;-motor neurons</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 207px;\">\n<div class=\"page\" title=\"Page 243\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>static &gamma;-motor neurons</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 172px;\">Way of detection of the change in muscle length</td>\n<td style=\"width: 172px;\">Static &amp; dynamic changes</td>\n<td style=\"width: 207px;\">Static change</td>\n</tr>\n</tbody>\n</table>\n<div class=\"page\" title=\"Page 242\">&nbsp;</div>\n<div class=\"page\" title=\"Page 242\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Note</strong>- Golgi tendon organ senses changes in <strong>muscle tension</strong>. Muscle spindle also provides sense of <strong>joint position</strong>.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The afferents for deep tendon reflexes innervate  _____",
    "choices": [
      {
        "id": 1,
        "text": "Dynamic intrafusal fibers"
      },
      {
        "id": 2,
        "text": "Golgi tendon organ"
      },
      {
        "id": 3,
        "text": "Nuclear bag and chain fibers"
      },
      {
        "id": 4,
        "text": "Golgi tendon and muscle spindle"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The afferents for&nbsp;deep tendon reflexes innervate both -&nbsp;<strong>nuclear bag and</strong><strong>&nbsp;chain fibers.</strong></p>\n<p>The afferents for the DTRs are the type Ia and type II nerve fibers. There are three types of intrafusal muscle fibers: dynamic nuclear bag, static nuclear bag, and nuclear chain fibers. A single Ia afferent fiber innervates all three types of fibers to form a primary sensory ending. A group II sensory fiber innervates nuclear chain and static bag fibers to form a secondary sensory ending.</p>\n<p>Deep tendon reflexes are an example of stretch reflex or myotatic reflex.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Stimulus for stretch reflex is_____",
    "choices": [
      {
        "id": 1,
        "text": "Passive stretch"
      },
      {
        "id": 2,
        "text": "Active stretch"
      },
      {
        "id": 3,
        "text": "Both"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Stretch reflex occurs when the muscle is stretched passively.</p>\n<p><strong>Stretch (myotatic) reflex</strong>&nbsp;is monosynaptic. (As illustrated in the figure given below, steps 1&rarr;5).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/df2ab043860e4db7b04e0873e5dd6e83x1280x1309.JPEG"
    ]
  },
  {
    "text": "Withdrawal reflexes are not____",
    "choices": [
      {
        "id": 1,
        "text": "Initiated by nociceptive stimuli"
      },
      {
        "id": 2,
        "text": "Prolonged if the stimulus is strong"
      },
      {
        "id": 3,
        "text": "An example of a flexor reflex"
      },
      {
        "id": 4,
        "text": "Accompanied by the same response on both sides of the body"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Withdrawal reflexes are <strong>not accompanied</strong> by the<strong> same response on both sides </strong>of the body. On the <strong>ipsilateral</strong> side of the pain stimulus,<strong> flexors are stimulated</strong> (they contract) and <strong>extensors are inhibited </strong>(they relax), and the arm is jerked away from the stove. On the <strong>contralateral</strong> side,<strong> flexors are inhibited</strong> and <strong>extensors are stimulated</strong> (crossed extension reflex) to maintain balance.</p>\n<p>It results in flexion on the ipsilateral side and extension on the contralateral side.</p>\n<p>Somatosensory and pain afferent fibers elicit withdrawal of the stimulated body part from the noxious stimulus.</p>\n<p>Pain (e.g., touching a hot stove) stimulates the flexor reflex afferents of groups II, III, and IV.</p>\n<p>The afferent fibers synapse polysynaptically (via interneurons) onto motoneurons in the spinal cord.</p>\n<p>As a result of persistent neural activity in the polysynaptic circuits, an afterdischarge occurs. The afterdischarge prevents the muscle from relaxing for some time.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/900216bed2b647489d4dcec81e46b75bx1280x2269.JPEG"
    ]
  },
  {
    "text": "The maintenance of normal posture depends on_____",
    "choices": [
      {
        "id": 1,
        "text": "Integrity of reflex arc"
      },
      {
        "id": 2,
        "text": "Muscle power"
      },
      {
        "id": 3,
        "text": "Type of muscle fiber"
      },
      {
        "id": 4,
        "text": "Joint movement in physiological range"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The maintenance of normal posture depends on<strong>&nbsp;</strong>the <strong>Integrity of reflex arc.</strong></p>\n<p>The muscles that maintain upright posture&mdash;that is, support the body&rsquo;s weight against gravity&mdash;are controlled by the brain and by reflex mechanisms.</p>\n<p>Three levels of the nervous system control movement:</p>\n<ul>\n<li><strong>The spinal cord</strong>, which integrates spinal reflexes and contains central pattern generators.</li>\n<li><strong>The brain stem and cerebellum</strong>, which control postural reflexes and hand and eye movements.</li>\n<li><strong>The cerebral cortex and basal ganglia</strong>, which are responsible for voluntary movements.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6177220116cc4506b9bccb197610a02bx1280x1956.JPEG"
    ]
  },
  {
    "text": "Receptor for inverse stretch reflex_____",
    "choices": [
      {
        "id": 1,
        "text": "Muscle spindle"
      },
      {
        "id": 2,
        "text": "Extrafusal fiber"
      },
      {
        "id": 3,
        "text": "Intrafusal fiber"
      },
      {
        "id": 4,
        "text": "Golgi tendon organ"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Golgi tendon organ</strong> is the receptor for <strong>inverse stretch reflex</strong> (refer figure).</p>\n<p>The Golgi tendon organs, unlike the spindles, are in series with the muscle fibers; therefore, they are stimulated by both passive stretch and active contraction of the muscle.</p>\n<p>The degree of stimulation by contraction of muscles is much greater than that caused by the stretching of muscles.</p>\n<p>Muscle contraction <strong>&rarr; Ib fibers</strong> from the Golgi tendon organ excite an <strong>inhibitory interneuron</strong> that releases inhibitory mediator<strong> glycine &rarr; hyperpolarization (inhibition) of &alpha; motor neurons </strong>&rarr; muscle relaxation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/52195322e98c4349aae0aa39089682d8x1280x1938.JPEG"
    ]
  },
  {
    "text": "The number of muscle fibers per Golgi tendon organ is ___.",
    "choices": [
      {
        "id": 1,
        "text": "3-20"
      },
      {
        "id": 2,
        "text": "200-300"
      },
      {
        "id": 3,
        "text": "50-60"
      },
      {
        "id": 4,
        "text": "80-100"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>There are 3-20 muscle fibers per Golgi tendon organ.</p>\n<ul>\n<li>Golgi tendon organ consists of a netlike collection of knobby nerve endings among the fascicles of a tendon.</li>\n<li>There are 3&ndash;25 muscle fibers per Golgi ten&shy;don organ.</li>\n<li>The fibers from the Golgi tendon organs make up the Ib group of myelinated, rapidly conducting sensory nerve fibers.</li>\n<li>Golgi tendon organs help in regulating the velocity of the muscle contraction, muscle length, and muscle force.</li>\n<li>They are the receptor for <strong>inverse stretch reflex</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/be59692c2c5e44b4978a6b45c79c68c3x600x816.JPEG"
    ]
  },
  {
    "text": "The inverse stretch reflex_____",
    "choices": [
      {
        "id": 1,
        "text": "Occurs when Ia spindle afferents are inhibited"
      },
      {
        "id": 2,
        "text": "Is a monosynaptic reflex initiated by activation of the Golgi tendon organ"
      },
      {
        "id": 3,
        "text": "Is a disynaptic reflex with a single interneuron inserted between the afferent and efferent limbs"
      },
      {
        "id": 4,
        "text": "Is a polysynaptic reflex with many interneurons inserted between the afferent and efferent limbs"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Golgi tendon reflex (Inverse myotatic/Inverse stretch reflex)</strong> <strong>is</strong> <strong>disynaptic,&nbsp;</strong>is the opposite, or inverse, of the stretch reflex.</p>\n<p>When tension on the muscle&mdash;and therefore on the tendon&mdash;becomes extreme, the inhibitory effect from the golgi tendon organ can be so great that it leads instantaneous relaxation of the entire muscle. This effect is called the <strong><em>lengthening reaction</em></strong><em>; </em>it is probably a protective mechanism to prevent tearing of the muscle or avulsion of the tendon from its attachments to the bone.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3114e5b386164f339109af4df9753842x1280x1938.JPEG"
    ]
  },
  {
    "text": "All of the following are true about withdrawal reflex except ______",
    "choices": [
      {
        "id": 1,
        "text": "Diverging circuits to spread the reflex to the necessary muscles for withdrawal are present"
      },
      {
        "id": 2,
        "text": "Circuits to inhibit the antagonist muscles, called reciprocal inhibition circuits are present"
      },
      {
        "id": 3,
        "text": "Circuits to cause afterdischarge that lasts many fractions of a second after the stimulus is over are present"
      },
      {
        "id": 4,
        "text": "The pathways for eliciting the flexor withdrawal reflex pass directly to the anterior motor neurons making it a monosynaptic reflex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The flexor reflex is organized to withdraw a pained or otherwise irritated part of the body from a stimulus. Further, because of after-discharge, the reflex can hold the irritated part away from the stimulus for 0.1 to 3 seconds after the irritation is over. During this time, other reflexes and actions of the central nervous system can move the entire body away from the painful stimulus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d73f2ba546bf4224a2853c5afeaf7626x1280x1671.JPEG"
    ]
  },
  {
    "text": "Muscle tone is maintained by_____",
    "choices": [
      {
        "id": 1,
        "text": "Golgi tendon organ"
      },
      {
        "id": 2,
        "text": "Muscle spindle"
      },
      {
        "id": 3,
        "text": "Renshaw cell"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The resistance of a muscle to stretch is often referred to as its tone or tonus and <strong>muscle spindle\u00a0</strong>helps to control basic muscle tone.</p>\n<p>The tonic (static) stretch reflex circuit includes both group Ia and group II afferent fibers from muscle spindles. Normally, there is ongoing activity in the Ia and II afferents that helps maintain a baseline firing of \u03b1 motor neurons; therefore, the tonic stretch reflex contributes to muscle tone.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true during initiation of voluntary movements?",
    "choices": [
      {
        "id": 1,
        "text": "\u0391 \u03b1 motor neurons are activated followed by \u03b3 motor neuron"
      },
      {
        "id": 2,
        "text": "\u0391 \u03b3 motor neurons are activated followed by \u03b1 motor neuron"
      },
      {
        "id": 3,
        "text": "Both \u03b1 and \u0263 motor neurons are activated together"
      },
      {
        "id": 4,
        "text": "Only \u03b1 motor neurons are activated"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The cell bodies of &alpha; and &gamma; motor neurons to a given muscle lie close together. Both types are <strong>activated by interneurons</strong> in their immediate vicinity and sometimes directly by neurons of the descending pathways. During many voluntary and involuntary movements, they are coactivated, i.e., they are excited at almost the same time. <strong>(&alpha;-\u0263 coactivation</strong><strong>)</strong></p>\n<p>The purpose of &alpha;-\u0263 coactivation:</p>\n<ul>\n<li>First, it keeps the length of the receptor portion of the muscle spindle from changing during the course of the whole muscle contraction. Hence, the muscle contraction is <strong>not opposed by the stretch reflex</strong>.</li>\n<li>Second, if the muscle spindle did not contract and relax along with the large muscle fibers, the receptor portion of the spindle would sometimes be flail and sometimes be overstretched.</li>\n</ul>\n<p>Coactivation thus ensures that information about muscle length will be continuously available to provide for adjustment during ongoing actions and to plan and program future movements.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Righting reflex is____",
    "choices": [
      {
        "id": 1,
        "text": "Stretch reflex"
      },
      {
        "id": 2,
        "text": "Postural reflex"
      },
      {
        "id": 3,
        "text": "Spinal reflex"
      },
      {
        "id": 4,
        "text": "Ocular reflex"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Righting reflexes operate to maintain the normal standing position and keep an animal's head upright. These reflexes are a series of responses integrated for the most part in the nuclei of the midbrain.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient with decerebrate rigidity, on applying pressure on the footpad, extension of that limb occurs. Which of the following statements is false regarding this phenomenon?",
    "choices": [
      {
        "id": 1,
        "text": "It is Magnet Reaction"
      },
      {
        "id": 2,
        "text": "It is integrated at the Spinal Level"
      },
      {
        "id": 3,
        "text": "It helps to prevent falling on that side"
      },
      {
        "id": 4,
        "text": "It is a righting reflex integrated at midbrain level"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Pressure on the footpad of a decerebrate patient causes the limb to extend against the pressure applied to the foot. This reflex is called the <strong>positive supportive reaction </strong>and<strong>\u00a0</strong>is a righting reflex integrated at the <strong>spinal level</strong>.</p>\n<p>Pressure on one side causes extension in that direction (e.g., on applying pressure on the <strong>right</strong> footpad, extension of <strong>the right</strong>\u00a0lower limb occurs), an effect called the <strong>magnet reaction</strong><em>. </em>It is seen in infants and following spinal transection.</p>\n<p>From an evolutionary perspective, this reflex helps to prevent falling on the side where the stimulus is given.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Pyramids are formed by____",
    "choices": [
      {
        "id": 1,
        "text": "Arcuate nucleus"
      },
      {
        "id": 2,
        "text": "Vestibular nuclei"
      },
      {
        "id": 3,
        "text": "Interstitials cells of kajal"
      },
      {
        "id": 4,
        "text": "Corticospinal tract"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The corticospinal pathways are also called the pyramidal tracts or pyramidal system because of their triangular shape as they pass along the ventral surface of the medulla oblongata.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc802c3098a243e7b297a0c4a3c5b26fx1280x2843.JPEG"
    ]
  },
  {
    "text": "Which of the following is true about corticospinal tract?",
    "choices": [
      {
        "id": 1,
        "text": "Mostly crossed"
      },
      {
        "id": 2,
        "text": "Uncrossed"
      },
      {
        "id": 3,
        "text": "Crossed at midspinal level"
      },
      {
        "id": 4,
        "text": "20% crossed"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The corticospinal tract contains <strong>crossed fibers</strong> (majority).</p>\n<p><strong>Fibers of the corticospinal tract</strong> originate from the primary motor cortex (about 30%), the premotor and supplementary motor areas (30%), and the somatosensory areas posterior to the central sulcus (40%).</p>\n<p>Most fibers (<strong>80% fibers</strong>) decussate (cross) in the medullary pyramids and descend in the lateral white matter of the spinal cord to form the <strong>lateral corticospinal tract</strong>. They control the movements of the contralateral limbs.</p>\n<p>The remaining <strong>20% make</strong> up <strong>the ventral corticospinal tract</strong>. These fibers remain <strong>uncrossed</strong> until reaching the spinal cord where axons terminate bilaterally on spinal interneurons antecedent to motor neurons. These fibers control the movements of the axial musculature.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/275ac4b809654007a141f30f02b3f671x1064x604.PNG"
    ]
  },
  {
    "text": "Which of the following is false regarding the origin of corticospinal tract?",
    "choices": [
      {
        "id": 1,
        "text": "Corticospinal tract fibers originate from Betz Cells"
      },
      {
        "id": 2,
        "text": "30% from premotor and supplementary motor areas"
      },
      {
        "id": 3,
        "text": "40% from somatosensory areas"
      },
      {
        "id": 4,
        "text": "90% from the primary motor cortex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>30% of corticospinal tract </strong>originates about from the<strong> primary motor cortex</strong>, not 90%.</p>\n<p>30 % from the premotor and supplementary motor areas.&nbsp;40 % from the somatosensory areas posterior to the central sulcus.&nbsp;</p>\n<p><strong>Betz cells</strong></p>\n<ul>\n<li>Some large myelinated fibres in the corticospinal tract originate from <strong>giant pyramidal cells<em>,&nbsp;</em>also known as Betz cells</strong>.</li>\n<li>Found in the <strong>layer 5</strong> of primary motor cortex.</li>\n<li>These large fibers represent only <strong>3 percent</strong> of the total fibers of the corticospinal tract. (The other 97 percent less than 4 micrometers in diameter that conduct background tonic signals to the motor areas of the cord.)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5abbb8d1a57944ceaa2dc9c46011d2c3x1280x2843.JPEG"
    ]
  },
  {
    "text": "Which of the following is not an extrapyramidal tract?",
    "choices": [
      {
        "id": 1,
        "text": "Reticulospinal tract"
      },
      {
        "id": 2,
        "text": "Rubrospinal tract"
      },
      {
        "id": 3,
        "text": "Corticospinal tract"
      },
      {
        "id": 4,
        "text": "Vestibulospinal tract"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Corticospinal tract is a pyramidal tract .&nbsp;</strong></p>\n<p><strong>Pyramidal tracts </strong>(corticospinal and corticobulbar) pass through the medullary pyramids.</p>\n<p>All others are <strong>extrapyramidal tracts </strong>and originate primarily in the the brain stem.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which pathway is not involved in maintainence of posture?",
    "choices": [
      {
        "id": 1,
        "text": "Reticulospinal tract"
      },
      {
        "id": 2,
        "text": "Rubrospinal tract"
      },
      {
        "id": 3,
        "text": "Tectospinal tract"
      },
      {
        "id": 4,
        "text": "Vestibulospinal tract"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Rubrospinal tract</strong> is not involved in posture maintenance.</p>\n<p><strong>Medial motor system </strong></p>\n<ul>\n<li>Controls the axial muscles (muscles of the trunk)</li>\n<li>Axial muscles are concerned with <strong>postural adjustments</strong> and gross movements</li>\n</ul>\n<p><strong>Lateral motor system</strong></p>\n<ul>\n<li>Controls the distal muscles</li>\n<li>Distal muscles mediate fine, skilled movements</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5ad9ffc67054876ac12cde4d3ac3e21x1280x1246.JPEG"
    ]
  },
  {
    "text": "Gamma motor neurons are mainly influenced by _____",
    "choices": [
      {
        "id": 1,
        "text": "Reticulospinal tract"
      },
      {
        "id": 2,
        "text": "Rubrospinal tract"
      },
      {
        "id": 3,
        "text": "Tectospinal tract"
      },
      {
        "id": 4,
        "text": "Vestibulospinal tract"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>The pontine and medullary reticulospinal tracts are involved in maintainance of posture and in modulating muscle tone especially via an input to \u0263- motor neurons.</li>\n<li>Pontine reticulospinal neurons are primarily excitatory and medullary reticulospinal neurons are primarily inhibitory.</li>\n<li>Stimulation of &gamma;-motor neurons does not lead directly to detectable contraction of the muscles because the intrafusal fibers are not strong enough or plentiful enough to cause short&shy;ening.</li>\n<li>However, stimulation does cause the contractile ends of the intrafusal fibers to shorten and therefore stretches the nuclear bag portion of the spindles, deforming the endings, and initiating impulses in the Ia fibers . This in turn can lead to reflex contraction of the muscle.</li>\n<li>Thus, muscles can be made to contract via stimulation of the &alpha;-motor neu&shy;rons that innervate the extrafusal fibers or the &gamma;-motor neu&shy;rons that initiate contraction indirectly via the stretch reflex.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "According to Herrington classification, the decerebrate rigidity is characterized by all except ______",
    "choices": [
      {
        "id": 1,
        "text": "Rigidity occurs in all the muscles of the body"
      },
      {
        "id": 2,
        "text": "Increase in the rate of discharge of the \u0263 efferent neuron"
      },
      {
        "id": 3,
        "text": "Increased excitability of the motor neuron pool"
      },
      {
        "id": 4,
        "text": "Decerebration produces no phenomenon akin to spinal shock"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In decerebrate rigidity, there is rigidity in <strong>extensor muscles of all the four extremities</strong> (not all muscles of the body).</p>\n<p><strong>Decerebration</strong></p>\n<ul>\n<li>Complete transection of the brain stem between the superior and inferior colliculi permits the brain stem pathways to function independently of their input from higher brain structures. This is called a <strong>mid-collicular decerebration.</strong></li>\n<li>This lesion interrupts all input from the cortex (corticospinal and corticobulbar tracts) and red nucleus (rubrospinal tract), primarily to distal muscles of the extremities.</li>\n<li>The excitatory and inhibitory reticulospinal pathways (primarily to postural extensor muscles) remain intact.</li>\n<li>The dominance of drive from ascending sensory pathways to the excitatory reticulospinal pathway leads to hyperactivity in extensor muscles in all four extremities which are called <strong>decerebrate rigidity.</strong></li>\n<li>The excitatory input from the reticulospinal pathway activates \u03b3-motor neurons which indirectly activate \u03b1-motor neurons (via Ia spindle afferent activity). This is called the <strong>gamma loop.</strong></li>\n</ul>\n<p>Option 4. Spinal shock is different from decebrate rigidity as it is a transient state that can occur immediately after a spinal cord injury. It is characterized by a temporary loss or depression of spinal reflexes below the level of the injury.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true for decorticate rigidity?",
    "choices": [
      {
        "id": 1,
        "text": "It is produced by the removal of cerebral cortex and basal ganglia"
      },
      {
        "id": 2,
        "text": "Flexion of lower limbs and extension of upper limbs occurs"
      },
      {
        "id": 3,
        "text": "Rigidity is pronounced"
      },
      {
        "id": 4,
        "text": "It is characterized by flexion of upper limbs and extension of lower limbs"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Removal of the cerebral cortex <strong>(decortication) </strong>produces <strong>decorticate rigidity.</strong></li>\n<li>Characterized by flexion of the upper extremities at the elbow and extensor hyperactivity in the lower extremities.</li>\n<li>The flexion can be explained by active rubrospi&shy;nal excitation of flexor muscles in the upper extremities; the hyperextension of lower extremities is due to the same changes that occur after midcollicular decerebration.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a6c11cba47204951b0b484492ec712f7x571x131.JPEG"
    ]
  },
  {
    "text": "Which of the following reflex is absent in a decorticate animal?",
    "choices": [
      {
        "id": 1,
        "text": "Righting reflex"
      },
      {
        "id": 2,
        "text": "Hopping and Placing Reflex"
      },
      {
        "id": 3,
        "text": "Labrynthine Reflex"
      },
      {
        "id": 4,
        "text": "Crossed Extensor Reflex"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The Hopping and Placing reflex is absent in a decorticate animal as it is integrated in the cerebral cortex. Rest of the reflexes are integrated below the cortex.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Destruction of anterior cerebellum in a decerebrate animal leads to _________.",
    "choices": [
      {
        "id": 1,
        "text": "No effect on rigidity"
      },
      {
        "id": 2,
        "text": "Increased flexor muscle tone"
      },
      {
        "id": 3,
        "text": "Increased rigidity via alpha motor neuron"
      },
      {
        "id": 4,
        "text": "Decrease in rigidity"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Destruction of the anterior cerebellum in a decerebrate animal leads to <strong>an increased rigidity via alpha motor neuron</strong>.</p>\n<p>If the anterior lobe of the cerebellum is removed in a decerebrate animal, extensor muscle hyperactivity is exaggerated <strong>(decerebellate rigidity). </strong>This cut eliminates cortical inhibition of the cerebellar fastigial nucleus and secondarily increases excitation to vestibular nuclei. Subsequent dorsal root section does not reverse the rigidity, hence proving that the rigidity is due to activation of &alpha;-motor neurons independent of the gamma loop.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Upper Motor Neurons (UMN) include ______",
    "choices": [
      {
        "id": 1,
        "text": "Pyramidal cells"
      },
      {
        "id": 2,
        "text": "Peripheral nerves"
      },
      {
        "id": 3,
        "text": "Glial cells"
      },
      {
        "id": 4,
        "text": "Anterior horn cells"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>Upper motor neurons </strong>typically refer to corticospinal tract neurons that innervate spinal motor neurons, but they can also include brainstem neurons that control spinal motor neurons.</li>\n<li>Corticospinal tract contain a population of large myelinated fibers with a mean diameter of 16 micrometers. These fibers originate from <strong>giant pyramidal cells</strong>, called <strong>Betz cells,</strong> that are found only in the primary motor cortex.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man meets with an accident and develops spinal cord transection. Which of the following features will be seen as a result of pyramidal tract injury below the level of motor decussation?",
    "choices": [
      {
        "id": 1,
        "text": "Positive Babinski sign"
      },
      {
        "id": 2,
        "text": "Loss of deep tendon reflex"
      },
      {
        "id": 3,
        "text": "Loss of proprioception"
      },
      {
        "id": 4,
        "text": "Flaccidity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Cutting the pyramidal tract below the decussation (UMN lesion) causes<strong> abnormal plantar extensor reflex (posi\u00adtive Babinski sign). </strong></p>\n<p>It\u00a0initially causes muscles to become weak and flaccid but eventually leads to spasticity, <strong>hypertonia </strong>(increased resistance to passive movement), and hyperactive stretch reflexes.<br /><br />The image below shows the pyramidal tract (corticospinal pathway).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/47a90fd5d6d14764b83c38775ab39a91x548x1200.JPEG"
    ]
  },
  {
    "text": "A 36-year-old male patient presented to the ER following a road traffic accident. Which of the following features would not be present if there is a corticospinal tract involvement?",
    "choices": [
      {
        "id": 1,
        "text": "Cog-Wheel Rigidity"
      },
      {
        "id": 2,
        "text": "Extensor Plantar response"
      },
      {
        "id": 3,
        "text": "Spasticity"
      },
      {
        "id": 4,
        "text": "Loss of superficial reflex"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Cog-wheel rigidity is not seen if there is a corticospinal tract involvement.&nbsp;<strong>Cogwheel rigidity</strong> is seen in <strong>extrapyramidal tract involvement</strong> when there is a tremor superimposed on hypertonia (e.g., Parkinsonism).</p>\n<p>In an upper motor neuron lesion, there is damage to the corticospinal or corticobulbar fibres. If the corticospinal fibres are damaged, it leads to diminished or<strong> loss of superficial reflexes</strong>, shows an <strong>extensor plantar response</strong> (Babinski's sign) with loss of fine skilled movement and <strong>spasticity</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While exercising, a 42-year-old woman developed sudden onset of tingling in her right leg and an inability to control movement in that limb. A neurologic exam showed a hyperactive knee jerk reflex and a positive Babinski sign. Which of the following is not true regarding her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Reflexes can be modified by impulses from various parts of the CNS"
      },
      {
        "id": 2,
        "text": "Reflexes may involve simultaneous contraction of some muscles and relaxation of others"
      },
      {
        "id": 3,
        "text": "Reflexes are chronically suppressed after spinal cord transection"
      },
      {
        "id": 4,
        "text": "Reflexes often occur without conscious perception"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical vignette is suggestive of <strong>spinal cord transection</strong>, which is characterized by an <strong>exaggeration</strong> <strong>of</strong> <strong>reflexes</strong> and not suppression.</p>\n<p><strong>Upper motor neurons </strong>typically refer to corticospinal tract neurons that innervate spinal motor neurons. Damage to these neurons, as in transection of the spinal cord, initially causes muscles to become weak and flaccid but eventually leads to spasticity, hypertonia (increased resistance to passive movement), hyperactive reflexes, and abnormal plantar extensor reflex (positive Babinski sign).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man with a history of medically controlled atrial fibrillation develops sudden onset weakness in the right side of his body. Which of the following Broadman's area is most likely affected?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "1,2,3"
      },
      {
        "id": 3,
        "text": "5,7"
      },
      {
        "id": 4,
        "text": "16,18"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical vignette is suggestive of an acute stroke, most probably due to atrial fibrillation induced thromboembolism. Since the patient has developed motor weakness in the right side of his body, he most likely has an infarct affecting the <strong>primary motor cortex</strong> (&nbsp;<strong>broadmann area 4</strong>).</p>\n<ul>\n<li><strong>The primary motor cortex </strong>(or just the motor cortex) can be defined as the region of the cortex from which movements are elicited with the least amount of electrical stimulation.</li>\n<li>It is essentially congruent with Brodmann's cytoarchitectonic <strong>area 4</strong>.</li>\n<li>The <strong>primary motor cortex (M1) </strong>is in the precentral gyrus of the frontal lobe, extending into the central sulcus.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/004c8694fd77447ebdb24980694e570ax364x334.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8665d75799d74b3bae671ed190a6c76fx800x507.PNG"
    ]
  },
  {
    "text": "Skilled voluntary movement is initiated by____",
    "choices": [
      {
        "id": 1,
        "text": "Association cortex"
      },
      {
        "id": 2,
        "text": "Basal ganglia"
      },
      {
        "id": 3,
        "text": "Cerebral cortex"
      },
      {
        "id": 4,
        "text": "Cerebellum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Commands for voluntary movements originate in <strong>cortical association areas.</strong></p>\n<p>The <strong>corticospinal</strong> and <strong>corticobulbar system</strong> (originating in the motor cortex located in precentral gyrus) is the <strong>primary pathway</strong> for the initiation of <strong>skilled voluntary movement.</strong></p>\n<p>The movements are planned in the <strong>cortex</strong> as well as in the <strong>basal ganglia</strong> and the <strong>lateral portions of the cerebellar hemispheres</strong>.</p>\n<p>The basal ganglia and cerebellum funnel information to the premotor and motor cortex by way of the thalamus.</p>\n<p>Motor commands from the motor cortex are relayed in large part via the <strong>corticospinal tracts</strong> to the spinal cord.</p>\n<p>Movement sets up alterations in sensory input from the special senses and from muscles, tendons, joints, and the skin. This feedback information, which adjusts and smooths movement, is relayed directly to the motor cortex and to the spinocerebellum.</p>\n<div class=\"page\" title=\"Page 249\">&nbsp;</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a7dfa1a2e8b4e3480b329dcdd736fd7x1280x1693.JPEG"
    ]
  },
  {
    "text": "In the homunculus, which of the following has maximum representation?",
    "choices": [
      {
        "id": 1,
        "text": "Low control and skilled movements"
      },
      {
        "id": 2,
        "text": "More muscle fibres are present"
      },
      {
        "id": 3,
        "text": "Increased preciseness of movements"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In a homunculus, the more the representation of an area, the more precise the movements are.&nbsp;</p>\n<ul>\n<li>The relative sizes of the cortical receiving areas of the sensory homunculus are<strong>&nbsp;proportionate to the use of the part.</strong></li>\n<li>The sizes of these areas are&nbsp;<strong>directly proportional to the number of specialized sensory receptors&nbsp;</strong>in each respective peripheral area of the body.</li>\n<li>Some body parts are represented by large areas in the somatic cortex&mdash;the&nbsp;<strong>lips the greatest</strong>&nbsp;of all, followed by the<strong>&nbsp;face and thumb</strong>,<strong>&nbsp;</strong>whereas the&nbsp;<strong>trunk and lower part of the body</strong>&nbsp;are represented by relatively&nbsp;<strong>small areas.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f0376d25f5443e3a9500cd6de8f9205x1280x1275.JPEG"
    ]
  },
  {
    "text": "In the degrees of representation of the different muscle areas as mapped by Penfield and Rasmussen in the primary motor cortex, which of the following has the maximum representation?",
    "choices": [
      {
        "id": 1,
        "text": "Vocalization"
      },
      {
        "id": 2,
        "text": "Mastication"
      },
      {
        "id": 3,
        "text": "Salivation"
      },
      {
        "id": 4,
        "text": "Thumb"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>As seen from the figure given below, <strong>Vocalization &gt; Salivation &gt; Mastication &gt; Thumb</strong></p>\n<p>The topographical organization is demonstrated graphically in the figure<strong>, </strong>which shows the degrees of representation of the different muscle areas as mapped by Penfield and Rasmussen. This mapping was done by electrically stimulating the different areas of the motor cortex in human beings who were undergoing neurosurgical operations.\u00a0</p>\n<p>The<strong> face</strong> is represented<strong> bilaterally</strong>. The rest of the <strong>body</strong> has a <strong>unilateral</strong> representation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a81a39376e024437aafdf56aad117c27x1280x1806.JPEG"
    ]
  },
  {
    "text": "While doing a neurosurgical procedure, the paracentral lobules of both hemispheres were damaged. It will lead to which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Hemiplegia"
      },
      {
        "id": 2,
        "text": "Monoplegia"
      },
      {
        "id": 3,
        "text": "Paraplegia"
      },
      {
        "id": 4,
        "text": "Quadriplegia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Damage to both paracentral lobules will cause paraplegia.</p>\n<p>The&nbsp;<strong>paracentral lobule</strong> is the medial <strong>continuation</strong> of the precentral and postcentral <strong>gyri</strong>. It controls <strong>motor and sensory</strong> innervations of the contralateral <strong>lower extremity</strong>. It is also responsible for the control of defecation and urination.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Setting posture before planned movement is associated with ____.",
    "choices": [
      {
        "id": 1,
        "text": "Premotor cortex"
      },
      {
        "id": 2,
        "text": "Motor cortex"
      },
      {
        "id": 3,
        "text": "Frontal"
      },
      {
        "id": 4,
        "text": "Supplementary"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>The premotor cortex</strong> may be concerned with a setting posture at the start of a planned movement and getting the individual prepared to move. It is most involved in control of proximal limb muscles needed to orient the body for movement.</li>\n<li>It is located anterior to the precentral gyrus, on the lateral and medial cortical surface; it also con&shy;tains a somatotopic map almost identical to the topographic organization in primary motor cortex with the mouth and face areas located most laterally. As one moves upward, the hand, arm, trunk, and leg areas are encountered. (as seen in the figure below)</li>\n<li>This region receives input from sensory regions of the parietal cortex and projects to primary motor cortex (M1), the spinal cord, and the brainstem reticular formation.</li>\n<li>A special class of neurons called <strong>mirror neurons</strong> becomes active when a person performs a specific motor task or when he or she observes the same task performed by others. These neurons transform sensory representations of acts that are heard or seen into motor representations of these acts.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/722c52f158694143be88d068c27f4d62x637x324.PNG"
    ]
  },
  {
    "text": "A  quadriplegic man with a high cervical lesion develops sudden onset of flushing, sweating, pounding headache and hypertension. He has a distended bladder due to a blocked urinary catheter. On immediate drainage of the urinary bladder and repositioning him from supine to reclining, his symptoms resolve. Which of the following is false regarding the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "SBP may rise over 200 mm Hg"
      },
      {
        "id": 2,
        "text": "Major portion of the body\u2019s skeletal muscle go into extensor spasm"
      },
      {
        "id": 3,
        "text": "Large areas of the body break out into profuse sweating"
      },
      {
        "id": 4,
        "text": "Colon and Bladder evacuate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical vignette is suggestive of <strong>spinal mass reflex</strong> which is seen in patients with a <strong>high spinal lesion</strong>.&nbsp;A major portion of the body&rsquo;s skeletal muscles goes into strong <strong>flexor</strong> spasm, and <strong>not</strong> extensor spasm,<strong>&nbsp;</strong>in a spinal mass reflex.</p>\n<p><strong>Mass Reflex: </strong>In a spinal animal or human being, sometimes the spinal cord suddenly becomes excessively active, causing massive discharge in large portions of the cord. The usual stimulus that causes this excess activity is a strong pain stimulus to the skin or excessive filling of a viscus, such as over-distention of the bladder or the gut. The mass reflex involves large portions or even all of the cord.</p>\n<p>The effects are as follows:&nbsp;</p>\n<ol>\n<li>A major portion of the body&rsquo;s skeletal muscles goes into strong <strong>flexor spasms;</strong></li>\n<li>The <strong>colon</strong> and <strong>bladder</strong> are likely to <strong>evacuate</strong>;</li>\n<li>The arterial pressure often rises to maximal values, sometimes to a <strong>systolic pressure</strong> well <strong>over 200 mm Hg</strong>; and</li>\n<li>Large areas of the body break out into profuse <strong>sweating</strong>.</li>\n</ol>\n<p>The mechanism is similar to the mechanism of epileptic seizures, which involve reverberating circuits that occur in the brain instead of in the cord.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '14 Motor Physiology - 1';
        let hierarchy = ["Marrow", "qBank", "Physiology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>