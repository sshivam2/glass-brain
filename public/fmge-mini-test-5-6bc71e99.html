<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 5 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "What is altered in thyroid profile throughout pregnancy?",
    "choices": [
      {
        "id": 1,
        "text": "Free T3 level"
      },
      {
        "id": 2,
        "text": "Free T4 level"
      },
      {
        "id": 3,
        "text": "Total T3 level"
      },
      {
        "id": 4,
        "text": "TSH level"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Total T3 levels are altered <strong>throughout</strong> pregnancy.</p>\n<p><strong>Hormones during pregnancy:</strong>&nbsp;</p>\n<table style=\"width: 738px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\"><strong>Increased</strong></td>\n<td style=\"width: 179px; height: 18px;\"><strong>Decreased</strong></td>\n<td style=\"width: 92px; height: 18px;\"><strong>Unchanged</strong></td>\n</tr>\n<tr style=\"height: 35px;\">\n<td style=\"width: 195px; height: 35px;\">Growth Hormone</td>\n<td style=\"width: 179px; height: 35px;\">\n<p>LH (Leutinizing&nbsp;hormone)</p>\n</td>\n<td style=\"width: 92px; height: 35px;\">\n<p>ADH (Anti-diuretic hormone)</p>\n</td>\n</tr>\n<tr style=\"height: 31px;\">\n<td style=\"width: 195px; height: 31px;\">&nbsp;</td>\n<td style=\"width: 179px; height: 31px;\">\n<p>FSH (Follicle-stimulating hormone)</p>\n</td>\n<td style=\"width: 92px; height: 31px;\"><strong>Free T3</strong>,<strong>Free T4</strong></td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\">Prolactin</td>\n<td style=\"width: 179px; height: 18px;\">DHEAS(Di-Hydro EpiAndroSterone)</td>\n<td style=\"width: 92px; height: 18px;\">&nbsp;</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\"><strong>Total T3,</strong> Total T4</td>\n<td style=\"width: 179px; height: 18px;\">&nbsp;</td>\n<td style=\"width: 92px; height: 18px;\">&nbsp;</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\">Aldosterone</td>\n<td style=\"width: 179px; height: 18px;\">&nbsp;</td>\n<td style=\"width: 92px; height: 18px;\">&nbsp;</td>\n</tr>\n<tr style=\"height: 52px;\">\n<td style=\"width: 195px; height: 52px;\">\n<p>Testosterone,Androstenodione and cortisol</p>\n</td>\n<td style=\"width: 179px; height: 52px;\">&nbsp;</td>\n<td style=\"width: 92px; height: 52px;\">&nbsp;</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\">Insulin(due to insulin resistance)</td>\n<td style=\"width: 179px; height: 18px;\">&nbsp;</td>\n<td style=\"width: 92px; height: 18px;\">&nbsp;</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\">Estrogen</td>\n<td style=\"width: 179px; height: 18px;\">&nbsp;</td>\n<td style=\"width: 92px; height: 18px;\">&nbsp;</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 195px; height: 18px;\">Progesterone</td>\n<td style=\"width: 179px; height: 18px;\">&nbsp;</td>\n<td style=\"width: 92px; height: 18px;\">&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>Total T3 and total T4 increase due to stimulation of thyroid tissue by hCG during early period of gestation. But there is no change in free T3 and T4 due to increase in TBG. This leads to transient fall in TSH during early weeks of gestation.<strong> The level of TSH reaches normal</strong> level during second and third trimester.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 52-year-old male patient comes with complaints of abdominal pain, nausea, and vomiting. A peripheral blood smear reveals macrocytes and hypersegmented neutrophils and an endoscopy reveals atrophic gastritis. Which of the following conditions is likely to be seen this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B12 deficiency"
      },
      {
        "id": 2,
        "text": "Folate deficiency"
      },
      {
        "id": 3,
        "text": "Pyridoxine deficiency"
      },
      {
        "id": 4,
        "text": "Niacin deficiency"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given findings are suggestive of <strong>pernicious anemia,</strong>&nbsp;which is associated with <strong>atrophic gastritis</strong> and&nbsp;<strong>vitamin B12 deficiency.</strong></p>\n<p><strong>Anemic patient</strong>&nbsp;with a peripheral smear showing&nbsp;<strong>macrocytic RBCs</strong>&nbsp;and&nbsp;<strong>hypersegmented neutrophils</strong>&nbsp;are important characteristic features of&nbsp;<strong>megaloblastic anemia.</strong>&nbsp;<strong>Vitamin B12</strong> and folic acid deficiency&nbsp;are the main&nbsp;causes&nbsp;of megaloblastic anemia.</p>\n<p><strong>Pernicious anemia</strong> is an autoimmune disease characterized by&nbsp;<strong>autoantibodies</strong> against&nbsp;<strong>intrinsic</strong> <strong>factor (IF)</strong>, which is required for the <strong>uptake of vitamin B12</strong>.</p>\n<p>These patients also develop <strong>chronic</strong>&nbsp;<strong>atrophic gastritis,</strong> characterized by loss of parietal cells, infiltration of lymphocytes and plasma cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient who is on treatment for angina, presents to you with erectile dysfunction. You decide against prescribing sildenafil because the patient is being treated with _____",
    "choices": [
      {
        "id": 1,
        "text": "Calcium channel blockers"
      },
      {
        "id": 2,
        "text": "Beta blockers"
      },
      {
        "id": 3,
        "text": "Nitrates"
      },
      {
        "id": 4,
        "text": "ACE inhibitors"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient would be on<strong> nitrates</strong> for angina and thus<strong> should not&nbsp;be prescribed</strong>&nbsp;sildenafil as sildenafil causes<strong> dangerous potentiation of nitrate action</strong>&nbsp;resulting in&nbsp;<strong>severe hypotension.</strong></p>\n<p>The combination of the two drugs has a<strong> synergistic action</strong> on the intracellular <strong>cGMP levels</strong> that can result in uninhibited vasodilation and a precipitous fall in blood pressure. Hence, the use of <strong>sildenafil is a contraindication when on nitrates.&nbsp;</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child presents with a hypopigmented patch on her face with fine scaling. There is a history of atopy in the family.  What is the clinical diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Leprosy"
      },
      {
        "id": 2,
        "text": "Pityriasis versicolor"
      },
      {
        "id": 3,
        "text": "Pityriasis alba"
      },
      {
        "id": 4,
        "text": "Atopic eczema"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given history of&nbsp;<strong>age</strong>, <strong>fine scaling,</strong> <strong>distribution of the lesions</strong>&nbsp;and <strong>history of atopy</strong> suggests the diagnosis <strong>pityriasis alba</strong>.</p>\n<ul>\n<li>Pityriasis Alba is a pattern of <strong>dermatitis</strong> in which <strong>hypopigmentation</strong> is the most conspicuous feature.</li>\n<li>It is seen in the age group of <strong>3 to 16 years.</strong></li>\n<li>The individual <strong>lesion</strong> is a rounded oval or irregular <strong>hypopigmented patch</strong>, which is usually <strong>not well marginated and </strong>lesions have <strong>scaling</strong>.</li>\n<li>In children, the lesions are often <strong>confined to the face</strong>&nbsp;and are most common on the <strong>cheeks</strong> and around the <strong>mouth and chin</strong>.</li>\n<li>Pityriasis alba is often a <strong>manifestation of atopic eczema</strong> but it is not confined to atopic individuals.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/78b0096dbf3645fb8d7f5d59336c8a3ax1280x983.JPEG"
    ]
  },
  {
    "text": "A patient comes with a \u200bhistory of clean-cut injury which is not lacerated. He says that he received his last dose of tetanus vaccination about 10 years ago. What should be given next?",
    "choices": [
      {
        "id": 1,
        "text": "Full course of tetanus vaccination"
      },
      {
        "id": 2,
        "text": "Single dose tetanus toxoid"
      },
      {
        "id": 3,
        "text": "Tetanus toxoid + immunoglobulin"
      },
      {
        "id": 4,
        "text": "No vaccination needed"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A<strong> single dose&nbsp;</strong>of<strong> tetanus toxoid</strong> is given as the <strong>wound</strong> is <strong>clean</strong> and the&nbsp;<strong>last dose</strong> was<strong>&nbsp;</strong>received&nbsp;more than<strong> 10 years ago.</strong></p>\n<p><strong class=\"ng-binding\">Post exposure prophylaxis for tetanus:</strong></p>\n<div class=\"panel-body ng-scope\">\n<p>Prophylaxis is given based on patient category:</p>\n<ol style=\"list-style-type: upper-alpha;\">\n<li>Full immunization or a booster dose within the past 5 years.</li>\n<li>Full immunization or a booster dose &gt; 5 years ago but &lt; 10 years.</li>\n<li>Full immunization or a booster dose &gt; 10 years ago.</li>\n<li>Unknown or never taken immunization</li>\n</ol>\n<table>\n<tbody>\n<tr>\n<td>Category</td>\n<td>Clean wound</td>\n<td>Unclean wound</td>\n</tr>\n<tr>\n<td>A</td>\n<td>Only wound care</td>\n<td>Only wound care</td>\n</tr>\n<tr>\n<td>B</td>\n<td>Wound care + TT single dose</td>\n<td>Wound care + TT single dose</td>\n</tr>\n<tr>\n<td>C</td>\n<td>Wound care + TT single dose</td>\n<td>Wound care + TT single dose + Human tetanus immunoglobulin&nbsp;</td>\n</tr>\n<tr>\n<td>D</td>\n<td>Wound care + TT complete course</td>\n<td>Wound care + TT complete course + Human tetanus immunoglobulin</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old man presented with chronic pain in his hand, knees, and hips,aggravated on climbing stairs, while pain in his hands increases when he writes or types. He also complains of stiffness in his joints in the morning, which lasts for around half an hour. On examination of the hands, Herbeden's and Bouchard's nodes are visible. X-ray of the knee showed narrowed joint space with osteophytes. Which among the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Osteoporosis"
      },
      {
        "id": 2,
        "text": "Osteoarthritis"
      },
      {
        "id": 3,
        "text": "Rheumatoid arthritis"
      },
      {
        "id": 4,
        "text": "Bone tumour"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical vignette points to a diagnosis of&nbsp;<strong>osteoarthritis (OA).</strong></p>\n<p>&nbsp;Osteoarthritis is the most common cause of chronic knee pain in persons aged over 45 years. The early phases typically present with episodic joint pain following overactive use of the diseased joint. As the disease progresses, the pain becomes continuous and may be associated with stiffness of the affected joint. Morning stiffness if present, is usually brief for around 30 minutes. Clinical signs include:&nbsp;</p>\n<div class=\"page\" title=\"Page 2674\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Tenderness of the joint</li>\n<li>Bony swelling</li>\n<li>Decreased and painful range of movement&nbsp;</li>\n<li>Crepitus when the joint is moved</li>\n<li>Weakness and wasting of muscles acting on the joint</li>\n<li>Signs of inflammation&nbsp;</li>\n<li>Deformity and instability in severe cases</li>\n</ul>\n<p>&nbsp;The joints <strong>involved</strong> in osteoarthritis are:</p>\n<ul>\n<li>Distal and proximal interphalangeal joints (DIP, PIP)</li>\n<li>First carpometacarpal joint (base of the thumb)</li>\n<li>Hip</li>\n<li>Knee</li>\n<li>First metatarsal phalangeal joint (MTP)</li>\n<li>Cervical and lumbosacral spine</li>\n</ul>\n<p>The <strong>wrist, elbow, and ankle joints</strong> are usually <strong>spared</strong>.<strong>Heberden&rsquo;s</strong>&nbsp;and&nbsp;<strong>Bouchard&rsquo;s&nbsp;</strong><strong>nodes are nodules in osteoarthritis that are palpable in the distal interphalangeal joint and proximal interphalangeal joints respectively.</strong></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0c4ce65e67924b4dad621155ea2feddfx1280x1085.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0d84e0926304b85af097344a1440da7x963x1197.JPEG"
    ]
  },
  {
    "text": "A 48-year-old woman known case of rheumatoid arthritis since 10 years presents to the OPD  with headache, nausea, vomiting, generalized weakness,  severe abdominal pain. She also complained of dark-colored urine since 3 days. On examination there was severe pallor and BP was found to be 180/120 mmHg. She is on phenacetin-caffeine- aspirin combination painkiller for 10 years. A CT abdomen was done. The patient is most likely suffering from_________.",
    "choices": [
      {
        "id": 1,
        "text": "Septic ATN(acute tubular necrosis)"
      },
      {
        "id": 2,
        "text": "Chronic kidney disease"
      },
      {
        "id": 3,
        "text": "NSAID-induced kidney disease"
      },
      {
        "id": 4,
        "text": "Uric acid nephropathy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is highly suggestive of chronic kidney disease caused due to analgesic nephropathy. The CT scan shows<strong> papillary calcifications.</strong></p>\n<p><strong>Analgesic nephropathy</strong> is a renal disease characterized by chronic interstitial nephritis and renal papillary necrosis occurring due to excessive prolonged use of a combination of analgesics. It is mainly caused by the <strong>phenacetin-Aspirin-caffeine</strong> combination. Females are more commonly affected. The mechanism of injury is medullary hypoxia leading to papillary necrosis and finally causes chronic tubulointerstitial disease. It increases the risk of urothelial malignancies. Papillary calcifications are seen on CT.</p>\n<p>NSAID induced nephropathy is a type IV hypersensitivity reaction. The features are oliguric AKI, FeNa less than one, and hyperkalemia. It is seen within a few days of use and is reversible.&nbsp;</p>\n<p>Uric acid nephropathy/tumor lysis syndrome presents with oliguric AKI due to intratubular obstruction by uric acid crystals.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f9e0d025e6464c0e9c4e6a302fd5e51d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presents with swelling and tenderness in the anatomical snuffbox after sustaining a fall onto an outstretched hand. Identify the cast given below that was used to manage the patient's injury.",
    "choices": [
      {
        "id": 1,
        "text": "Minerva cast"
      },
      {
        "id": 2,
        "text": "Glass-holding cast"
      },
      {
        "id": 3,
        "text": "Turnbuckle cast"
      },
      {
        "id": 4,
        "text": "Colles cast"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The cast applied to a patient in the <strong>glass-holding position</strong> is known as the <strong>scaphoid cast/glass-holding cast</strong>. It is used to treat <strong>scaphoid fractures</strong>.</p>\n<p>To apply a scaphoid cast, the <strong>wrist </strong>is held in<strong> slight dorsiflexion</strong> and the <strong>thumb </strong>is in<strong> abduction</strong> and <strong>slight flexion,</strong> as if a glass is being held between the index finger and thumb. It extends from just below the elbow to just proximal to the metacarpal necks of the digits. On the thumb, the cast extends to just proximal to the interphalangeal joint.</p>\n<p>Scaphoid fracture presents with pain and swelling over the radial aspect of the wrist. A <strong>fall</strong> on an <strong>outstretched</strong> hand could result in such a fracture. The\u00a0fracture can be confirmed (when an x-ray does not show a fracture) if there is <strong>pain</strong>\u00a0elicited in the <strong>anatomical snuff box</strong> on the radial border of the wrist.</p>\n<p>An oblique x-ray of the wrist should be able to show a scaphoid fracture.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/219084f1752842bf9905ee86279542f6.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/19938ead32784f9c8c97ee03f7bb16b2x1280x1481.JPEG"
    ]
  },
  {
    "text": "What is the indication for the procedure shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Uterine inversion"
      },
      {
        "id": 2,
        "text": "Cervical polyps"
      },
      {
        "id": 3,
        "text": "Uterine prolapse"
      },
      {
        "id": 4,
        "text": "Cervical incompetence"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given procedure is\u00a0<strong>McDonald's cerclage</strong>\u00a0which is done for\u00a0<strong>cervical incompetence.\u00a0</strong></p>\n<p><strong>Cervical incompetence</strong>\u00a0is the\u00a0<strong>impairment</strong>\u00a0of the\u00a0<strong>retentive power</strong>\u00a0of the cervix. It can be due to anatomical causes or functional causes.\u00a0It leads to\u00a0<strong>painless dilation</strong>\u00a0of the cervix and\u00a0<strong>painless expulsion</strong>\u00a0of the products of conception in the\u00a0<strong>mid-trimester</strong>.\u00a0 Cervical incompetence is diagnosed by clinical examination and ultrasonography showing the presence of\u00a0<strong>short cervix</strong>\u00a0(&lt;25 mm) with or without\u00a0<strong>funnelling</strong>\u00a0of the internal os.</p>\n<p><strong>Prophylactic cerclage</strong>\u00a0is done around 14 weeks of pregnancy or 2 weeks earlier than the previous fetal loss. Rescue or<strong>\u00a0emergency cerclage</strong>\u00a0is done anytime\u00a0<strong>within</strong>\u00a0<strong>24 weeks</strong>\u00a0of gestation.</p>\n<p><strong>Removal</strong>\u00a0of cerclage should be done by<strong>\u00a037 weeks</strong>\u00a0of gestation. It can be removed earlier in case of preterm labor or if signs of abortion are seen.</p>\n<p>Commonly used types\u00a0of\u00a0procedures for\u00a0<strong>cervical</strong>\u00a0<strong>cerclage</strong>\u00a0during\u00a0<strong>pregnancy</strong>:</p>\n<ul>\n<li><strong>McDonald's</strong>\u00a0procedure:\u00a0<strong>purse-string suture</strong></li>\n<li><strong>Modified</strong>\u00a0<strong>Shirodkar's</strong>\u00a0procedure:</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ad51049d2dc540b3acb39ae7c38b25d0.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6bd710ccd1f6412e9304848e0b22bf07x1280x2558.JPEG"
    ]
  },
  {
    "text": "A 50-year-old female patient presented with breathlessness and fatigue for 5 months. Chest X-ray showed left atrial enlargement with straightening of the left cardiac border. Echocardiogram showed reduced opening of the mitral valve during diastole with thickening of the valve leaflets. Which among the following findings can be heard during auscultation?",
    "choices": [
      {
        "id": 1,
        "text": "Mid-diastolic murmur"
      },
      {
        "id": 2,
        "text": "Mid-systolic murmur"
      },
      {
        "id": 3,
        "text": "Pansystolic murmur"
      },
      {
        "id": 4,
        "text": "Early diastolic murmur"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of&nbsp;<strong>mitral stenosis </strong>(MS), and a <strong>mid-diastolic murmur</strong>&nbsp;can be heard during auscultation.</p>\n<p>MS is a valvular heart disease, most commonly caused by&nbsp;<strong>rheumatic fever</strong>. Other causes include:</p>\n<ul>\n<li>Mitral annular calcification with leaflet involvement</li>\n<li>Systemic lupus erythematosus, rheumatoid arthritis</li>\n<li>Left atrial myxoma</li>\n<li>Infective endocarditis with large vegetation</li>\n</ul>\n<p>Chronic inflammation causes the thickening of the valve leaflets and the shortening and fusion of chordae tendineae, leading to the formation of a <strong>funnel-shaped</strong> or <strong>fish-mouth valve</strong>. <strong>Calcification</strong> immobilizes the leaflets and narrows the valve further. <strong>Thrombi</strong> are also commonly formed from the calcified valve or dilated left atrium (in atrial fibrillation).</p>\n<p>Patients present with <strong>dyspnea</strong> and cough in the early stages. But as the disease progresses, daily activities are limited and the patient develops <strong>orthopnea</strong> and <strong>paroxysmal nocturnal dyspnea</strong>. <strong>Hemoptysis</strong> can occur due to the rupture of&nbsp;pulmonary-bronchial venous connections as a result of pulmonary venous hypertension.</p>\n<p>Important auscultatory findings of MS include:</p>\n<ul>\n<li><strong>Mid-diastolic murmur</strong> following OS:\n<ul>\n<li>Low-pitched, rumbling</li>\n<li>Heard best at the apex with the patient in the left lateral position</li>\n<li>Accentuated by mild exercise</li>\n<li>Duration of the murmur correlates with the severity of the stenosis</li>\n<li>Reappears or becomes louder during atrial systole in patients with sinus rhythm (presystolic accentuation)</li>\n</ul>\n</li>\n<li><strong>Opening snap (OS)</strong> of the mitral valve following the aortic component of S2 (A2)</li>\n<li>Accentuated and slightly delayed&nbsp;first heart sound (S1)</li>\n</ul>\n<p>When the cardiac output is severely reduced, the typical auscultatory findings may not be heard. This is known as<strong> silent MS</strong>. Hepatomegaly, pedal edema, ascites, and pleural effusion, may occur in patients with right ventricular failure.</p>\n<p>Other associated murmurs include:</p>\n<ul>\n<li><strong>Pansystolic murmur </strong>of <strong>functional tricuspid regurgitation</strong>:\n<ul>\n<li>Occurs with severe pulmonary hypertension</li>\n<li>Audible along the left sternal border</li>\n<li>Louder during inspiration and reduces during forced expiration (Carvallo&rsquo;s sign)</li>\n</ul>\n</li>\n<li><strong>Graham Steell murmur</strong> of <strong>pulmonary regurgitation</strong>:\n<ul>\n<li>High-pitched, diastolic, decrescendo-blowing murmur</li>\n<li>Audible along the left sternal border</li>\n<li>Occurs with severe pulmonary hypertension</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa37729c9f5442399693aadbed454406x1280x1191.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2ee26acb8fe4f2397862950428c6decx1280x1190.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/33e48c417e99465c8b119b5fedae047ex1280x1191.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/14b8186c1464498fb5b9ca24f18c625dx1280x1190.JPEG"
    ]
  },
  {
    "text": "A 28-year-old HIV positive patient presents to the clinic with a history of a mild burning sensation in his mouth that is aggravated while eating spicy foods. The oral examination showed creamy white patches on the oral mucosa. The wet mount microscopy of the scraping obtained from the patches is given below. What is the most probable causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Candida"
      },
      {
        "id": 2,
        "text": "Cryptococcus"
      },
      {
        "id": 3,
        "text": "Aspergillus"
      },
      {
        "id": 4,
        "text": "Histoplasma capsulatum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical picture of creamy white patches on the oral mucosa and the wet mount microscopy showing budding yeasts and pseudohyphae&nbsp;are suggestive of <strong>oral candidiasis</strong> caused by <strong>candida.</strong></p>\n<p>The risk factors for oral candidiasis include AIDS, diabetes mellitus, and other immunocompromised states.</p>\n<p>Treatment: Topical azoles or nystatin.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/50e342a4ee0c4c03bc24182b72040513.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 34-year-old female presented to the psychiatric OPD with low mood, loss of energy,  loss of interest in pleasurable activities, decreased sleep, and appetite for the past 2 months. What is the most appropriate treatment to be started?",
    "choices": [
      {
        "id": 1,
        "text": "Lithium"
      },
      {
        "id": 2,
        "text": "Sodium valpraote"
      },
      {
        "id": 3,
        "text": "Haloperidol"
      },
      {
        "id": 4,
        "text": "Fluoxetine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical vignette point towards major depressive disorder. <strong>SSRIs</strong> like <strong>fluoxetine</strong> are the most appropriate treatment for major depressive disorder. SSRIs should be continued for 6-9 months after complete remission of symptoms in case of a single episode of depression.\u00a0</p>\n<p>The diagnostic criteria for major depressive disorder are as follows:</p>\n<p>A. Five or more of the following symptoms have been present during the\u00a0<strong>same 2-week period.\u00a0</strong>At least<strong>\u00a0one of the symptoms</strong>\u00a0is either\u00a0<strong>depressed mood</strong>\u00a0or\u00a0<strong>loss of interest</strong>\u00a0or pleasure.</p>\n<ul style=\"list-style-type: circle;\">\n<li>Depressed mood most of the day</li>\n<li>Markedly diminished interest or pleasure in activities (anhedonia)</li>\n<li>Significant weight loss when not dieting or weight gain, decrease or increase in appetite</li>\n<li>Insomnia or hypersomnia</li>\n<li>Psychomotor agitation or retardation</li>\n<li>Fatigue or loss of energy</li>\n<li>Feelings of worthlessness or excessive or inappropriate guilt</li>\n<li>Diminished ability to think or concentrate, or indecisiveness</li>\n<li>Recurrent thoughts of death, recurrent suicidal ideation</li>\n</ul>\n<p>B. The symptoms cause\u00a0<strong>clinically significant distress</strong>\u00a0or<strong>\u00a0impairment</strong>\u00a0in social, occupa\u00adtional, or other important areas\u00a0<strong>of functioning.</strong></p>\n<p>C. The episode is\u00a0<strong>not attributable to</strong>\u00a0the physiological effects of<strong>\u00a0a substance</strong>\u00a0or to another medical condition.</p>\n<p>D. The occurrence of the major depressive episode\u00a0<strong>is not better explained by</strong>\u00a0schizoaf\u00adfective disorder, schizophrenia, schizophreniform disorder, delusional disorder, or other specified and unspecified\u00a0<strong>schizophrenia spectrum and other psychotic disorders.</strong></p>\n<p>E. There has\u00a0<strong>never been</strong>\u00a0a\u00a0<strong>manic</strong>\u00a0episode or a\u00a0<strong>hypomanic episode</strong>.</p>\n<p>Treatment of depression according to NICE guidelines:\u00a0</p>\n<div class=\"page\" title=\"Page 275\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>In recent\u2010onset, mild depression, cognitive behavioral therapy (CBT) is preferred and antidepressants are not recommended.</li>\n<li>Antidepressants (SSRIs) are recommended for the treatment of moderate to severe depression and for dysthymia along with CBT.</li>\n<li>For treatment\u2010resistant depression, recommended strategies include augmentation with lithium or an antipsychotic or the addition of a second antidepressant.</li>\n<li>The use of electroconvulsive therapy (ECT) is supported in severe and treatment-resistant depression.\u00a0\u00a0</li>\n</ul>\n<p>\u00a0</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the diagnosis from the given image?",
    "choices": [
      {
        "id": 1,
        "text": "Colle\u2019s fracture"
      },
      {
        "id": 2,
        "text": "Smith\u2019s fracture"
      },
      {
        "id": 3,
        "text": "Bennet fracture"
      },
      {
        "id": 4,
        "text": "Barton\u2019s fracture"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given radiograph is volar&nbsp;<strong>Barton&rsquo;s fracture</strong>. Dislocation of the radiocarpal joint is the hallmark of Barton's fracture.</p>\n<p><strong>Volar-type Barton's</strong>&nbsp;is a fracture-dislocation of the volar rim of the radius. This type is the most common.</p>\n<p><strong>Dorsal-type Barton's</strong>&nbsp;is a fracture-dislocation of the dorsal rim of the radius. Thus, it is similar to Smith&rsquo;s fracture, but the difference is that the fracture line runs obliquely and <strong>extends into the joint surface</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6b778922f054426b9179b7c09723fdc5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f74309fc42344111b02e35c05d12f048x1280x1413.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e62766e6cafc4ef2a8fe682525da88b3x388x372.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6cfd515f766c4dfd9a28ff2f507cc72fx287x483.PNG"
    ]
  },
  {
    "text": "A 55-year-old man presents to the clinic with a history of intermittent blood in stools for the past 3 months. After a detailed workup, the surgeon discovers a rectal adenocarcinoma which is located 8 cm away from the anal verge. There is no nodal or distant metastasis. Which of the following surgeries would you prefer in managing this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Abdominoperineal resection"
      },
      {
        "id": 2,
        "text": "Hartmann's operation"
      },
      {
        "id": 3,
        "text": "Low anterior resection"
      },
      {
        "id": 4,
        "text": "Endoluminal stent"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Low anterior resection</strong> is the preferred surgery in the rectal carcinoma which is located at least 5- 5.5 cm away from the anal verge.&nbsp;</p>\n<p>It&nbsp;is not performed:</p>\n<ul>\n<li>If adequate margin could not be achieved even after preoperative chemoradiotherapy.</li>\n<li>If the sphincters have to be sacrificed to achieve an adequate margin.</li>\n<li>In patients who cannot tolerate low anastomosis.</li>\n</ul>\n<p>In such cases, where anterior resection cannot be performed in distal rectal cancers, abdominoperineal resection is done.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the marked artery.",
    "choices": [
      {
        "id": 1,
        "text": "Superior cerebellar artery"
      },
      {
        "id": 2,
        "text": "Posterior inferior cerebellar artery"
      },
      {
        "id": 3,
        "text": "Anterior inferior cerebellar artery"
      },
      {
        "id": 4,
        "text": "Posterior spinal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The artery marked is the<strong> posterior inferior cerebellar artery.&nbsp;</strong>This artery branches out from the vertebral artery and it is the largest branch of the vertebral artery.</p>\n<p>The following image shows the <strong>circle of Willis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/519a28e118e349c4ab17050f7ec09e1c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which one of the following has maximum ionisation potential?",
    "choices": [
      {
        "id": 1,
        "text": "Electron"
      },
      {
        "id": 2,
        "text": "Proton"
      },
      {
        "id": 3,
        "text": "Helium ion"
      },
      {
        "id": 4,
        "text": "Gamma-photon"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Alpha particle</strong> is similar to <strong>helium </strong>with two protons and two neutron has<strong> maximum ionising potential but least penetrating ability</strong> and penetrates only superficial tissues to extent of 1 mm.</p>\n<p><strong>Gamma rays</strong> have the maximum tissue penetrating ability.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The milestone shown in the image should disappear by_______.",
    "choices": [
      {
        "id": 1,
        "text": "12 weeks"
      },
      {
        "id": 2,
        "text": "16 weeks"
      },
      {
        "id": 3,
        "text": "20 weeks"
      },
      {
        "id": 4,
        "text": "24 weeks"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The milestone shown in the image is hand regard. It should disappear by <strong>20 weeks</strong>.\u00a0</p>\n<p>Between 12 and 20 weeks, the child observes his own hands very intently, this is known as hand regard.</p>\n<p>Its persistence after 20 weeks is considered abnormal.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a3f46025241245c998848a9cfaf2857c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the target Maternal mortality rate and Under 5 mortality rate to be achieved by 2030 ?",
    "choices": [
      {
        "id": 1,
        "text": "70 and 25 respectively"
      },
      {
        "id": 2,
        "text": "97 and 25 respectively"
      },
      {
        "id": 3,
        "text": "50 and 40 respectively"
      },
      {
        "id": 4,
        "text": "80 and 30 respectively"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>target maternal mortality rate</strong> and <strong>Under-5 mortality rate</strong> to be achieved by 2030 are <strong>70 and 25,</strong> respectively.</p>\n<p>SDG(Sustainable development goals) comprises of <strong>17 goals</strong> and<strong> 170 targets\u00a0</strong>for<strong> Agenda 2030.</strong></p>\n<p>The SDGs adopted in 2015 aim to reduce <strong>Under-5 mortality</strong>\u00a0to\u00a0<strong>as low as 25 per 1000 live births</strong>\u00a0by the year 2030.</p>\n<p>The <strong>Sustainable Development Goals (SDGs)</strong>, also known as the Global Goals, were adopted by the United Nations in 2015 as a call to action to end poverty, protect the planet, and ensure that by 2030 all people enjoy peace and prosperity.</p>\n<p>It consists of 17 integrated sustainable development goals to be achieved by the year 2030, with priority being given to countries that are farthest behind. The SDGs are designed to end poverty, hunger, AIDS, and discrimination against women and girls.</p>\n<p>SDG 3 deals with ensuring healthy lives and promoting well-being for all at all ages. The important sub-targets of SDG 3 are:</p>\n<table>\n<tbody>\n<tr>\n<td>Sub-target</td>\n<td>Goal</td>\n</tr>\n<tr>\n<td>3.1</td>\n<td>Reduce global <strong>maternal mortality </strong>to <strong>&lt;70/100,000</strong> live births.</td>\n</tr>\n<tr>\n<td><strong>3.2</strong></td>\n<td>\n<ul>\n<li>Reduce\u00a0<strong>neonatal mortality</strong>\u00a0to at least as low as\u00a0<strong>12/1000 live births.</strong></li>\n<li>Reduce<strong>\u00a0under 5 mortality</strong>\u00a0to at least as low as<strong>\u00a025/1000 live births.</strong></li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>3.3</td>\n<td>End epidemics of AIDS, tuberculosis, malaria, and neglected tropical diseases, combat hepatitis, water-borne diseases, and other communicable diseases</td>\n</tr>\n<tr>\n<td>3.5</td>\n<td>Prevention and treatment of substance abuse, narcotic abuse, and harmful use of alcohol.</td>\n</tr>\n<tr>\n<td>3.7</td>\n<td>Universal access to sexual and reproductive health care services, including family planning.</td>\n</tr>\n<tr>\n<td>3.9</td>\n<td>Substantially reduce deaths and illnesses due to hazardous chemicals and air, water, and soil pollution and contamination.</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0Given below is an overview of the\u00a0<strong>17 Sustainable Development Goals</strong>\u00a0(SDGs)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f1f37ba863b344cc95353e93c4d0a7a4x400x302.GIF"
    ]
  },
  {
    "text": "A 7-year-old child presented with complaints of bed-wetting almost twice a week for the past 1 year. A detailed investigation was done to rule out the organic cause. What should be the treatment plan for this child?",
    "choices": [
      {
        "id": 1,
        "text": "Pharmacotherapy with imipramine"
      },
      {
        "id": 2,
        "text": "Psychodynamic psychotherapy"
      },
      {
        "id": 3,
        "text": "Bladder training (with reward for delaying micturition during daytime)"
      },
      {
        "id": 4,
        "text": "Bell and pad based classical conditioning"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical features are suggestive of nocturnal enuresis.&nbsp;<strong>Bell and pad based classical conditioning</strong> is the most effective treatment.</p>\n<p><strong>Nocturnal enuresis</strong> refers to the&nbsp;occurrence of involuntary urination at night after 5 years of age. It may be a normal phenomenon in children up to 5 years of age.</p>\n<p>Treatment for nocturnal enuresis may include either behavioural therapy, pharmacotherapy, or psychotherapy.</p>\n<p><strong>Behavioural therapy:</strong></p>\n<ul>\n<li>Classic conditioning with the <strong>bell</strong> (or buzzer) and <strong>pad</strong> (alarm) apparatus is the <strong>most effective</strong> treatment for enuresis.</li>\n<li>Dryness is achieved in 50% of the cases.</li>\n<li><strong>Bladder training</strong> with encouragement or reward for delaying micturition for increasing times during waking hours is useful but considered as an <strong>inferior</strong>&nbsp;to bell and pad.</li>\n</ul>\n<p><strong>Pharmacotherapy:</strong></p>\n<ul>\n<li>Medications should be considered<strong> if behavioural therapy has failed,</strong> and if enuresis is causing impairment in social, family, and school function.</li>\n<li>Desmopressin (an antidiuretic) and&nbsp;Reboxetine (norepinephrine reuptake inhibitor) are commonly used drugs. Reboxetine is considered as a <strong>safer alternative to imipramine.</strong></li>\n</ul>\n<p><strong>Psychotherapy:</strong></p>\n<ul>\n<li>It is indicated in cases with chronic enuresis, to deal with any coexisting psy&shy;chiatric problems and the emotional and family difficulties.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following disorders causing secondary amenorrhoea with their respective lab findings.",
    "choices": [
      {
        "id": 1,
        "text": "1-C, 2-B, 3-D, 4-A"
      },
      {
        "id": 2,
        "text": "1-D, 2-B, 3-C, 4-A"
      },
      {
        "id": 3,
        "text": "1-C, 2-D, 3-B, 4-A"
      },
      {
        "id": 4,
        "text": "1-A, 2-B, 3-D, 4-C"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct answer is&nbsp;<strong>1-C, 2-D, 3-B, 4-A</strong>.</p>\n<table style=\"height: 216px; width: 439px;\">\n<tbody>\n<tr>\n<td style=\"width: 156.087px;\"><strong>Condition</strong></td>\n<td style=\"width: 267.514px;\"><strong>Lab markers&nbsp;</strong></td>\n</tr>\n<tr>\n<td style=\"width: 156.087px;\">1. Sheehan's syndrome</td>\n<td style=\"width: 267.514px;\">C. Low LH, Low FSH, Low estradiol</td>\n</tr>\n<tr>\n<td style=\"width: 156.087px;\">2. Premature Ovarian failure</td>\n<td style=\"width: 267.514px;\">D. High LH, High FSH, Low estradiol</td>\n</tr>\n<tr>\n<td style=\"width: 156.087px;\">3. PCOS</td>\n<td style=\"width: 267.514px;\">B. High LH, Low FSH, Low estradiol</td>\n</tr>\n<tr>\n<td style=\"width: 156.087px;\">4. Asherman's syndrome</td>\n<td style=\"width: 267.514px;\">A. Normal FSH, Normal LH, Normal estradiol</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Secondary amenorrhoea</strong>&nbsp;is the absence of menses for more than three months in girls or women who previously had regular menstrual cycles or six months in girls or women who had irregular menses.</p>\n<p><strong>Premature Ovarian failure&nbsp;</strong>or premature menopause is the development of menopause before the age of&nbsp;<strong>40 years</strong>. It is diagnosed when at least 2 serum FSH levels are elevated (&gt;40 mIU/l) when measured at least 1 month apart in a woman &lt;40 years. The other findings consistent with POF include low estradiol and an elevated FSH/LH ratio.</p>\n<p><strong>Asherman's syndrome</strong>&nbsp;is the presence of&nbsp;<strong>uterine synechiae</strong>, due to the destruction of large areas of the endometrium, most commonly as a result of trauma to the endometrium following pregnancy-related curettages. Oligomenorrhoea, amenorrhoea, dysmenorrhoea, abortion, and infertility are seen with uterine synechiae. The laboratory investigations and<strong> hormonal assays are generally normal</strong> in isolated cases of uterine synechiae. Diagnosis is generally established using <strong>hysteroscopy. Moth-eaten appearance&nbsp;</strong>on hysterosalpingography suggests a diagnosis of&nbsp;Asherman syndrome<strong>.&nbsp;</strong>Treatment is by&nbsp;<strong>hysteroscopic adhesiolysis</strong>.</p>\n<p><strong>PCOS</strong>&nbsp;is a&nbsp;<strong>multisystem, metabolic, endocrine dysfunction</strong>&nbsp;that commonly occurs among women in the&nbsp;<strong>reproductive</strong>&nbsp;age group. <strong>LH level </strong>is <strong>raised</strong> over 10 IU/mL. <strong>FSH </strong>level remains<strong> normal to low</strong>, but<strong>&nbsp;FSH/LH ratio falls</strong>. <strong>Estrone(E1)</strong> levels are <strong>elevated</strong> but <strong>estradiol level</strong> in PCOS is <strong>low</strong> in comparison to Estrone (E1).&nbsp;</p>\n<p><strong>Sheehan's syndrome/ p</strong><strong>ituitary apoplexy</strong>&nbsp;is hemorrhagic infarction of large pituitary adenomas or&nbsp;<strong>pituitary infarction</strong>&nbsp;due to traumatic major blood loss. If this blood loss occurs<strong>&nbsp;during delivery,</strong>&nbsp;it's called&nbsp;<strong>Sheehan's syndrome.&nbsp;</strong>Affected women may present with&nbsp;<strong>panhypopituitarism&nbsp;</strong>and may have persistent hypotension, tachycardia, hypoglycemia, and lactation failure. The most prominent symptoms are&nbsp;<strong>lactation failure&nbsp;</strong>(due to the deficiency of prolactin)<strong>&nbsp;</strong>and&nbsp;<strong>postpartum amenorrhea&nbsp;</strong>(due to the deficiency of gonadotropins).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/19ac598898f54332aefa0b9e0f548b65x1280x3120.JPEG"
    ]
  },
  {
    "text": "In a patient pO2 is 85mmHg, pCO2 is 50mmHg, pH is 7.2, and HCO3- is 36mmol/L. The condition is______",
    "choices": [
      {
        "id": 1,
        "text": "Respiratory acidosis with compensatory metabolic alkalosis"
      },
      {
        "id": 2,
        "text": "Uncompensated respiratory acidosis"
      },
      {
        "id": 3,
        "text": "Metabolic acidosis with compensatory respiratory alkalosis"
      },
      {
        "id": 4,
        "text": "Uncompensated metabolic acidosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The provided scenario describes a patient with<strong> pO\u2082</strong> of <strong>85 mmHg</strong>, <strong>pCO\u2082 </strong>of <strong>50 mmHg</strong>, <strong>pH</strong> of <strong>7.2</strong>, and <strong>HCO\u2083\u207b </strong>of <strong>36 mmol/L</strong>. These findings suggest<strong> respiratory acidosis </strong>with a <strong>compensatory metabolic alkalosis</strong>.</p>\n<p>Interpretation of the <strong>ABG</strong>:</p>\n<p>Step 1: A pH of <strong>7.2</strong> indicates <strong>acidosis</strong>.</p>\n<p>Step 2: <strong>pCO2</strong> is 50 mmHG, which is <strong>high</strong>, thus, along with a low pH this signifies <strong>respiratory acidosis</strong></p>\n<p>Step 3: The <strong>HCO3- levels are increased (&gt;30mmol/L)</strong>, which is opposite to the change in pH, thus, there is <strong>compensatory metabolic alkalosis.</strong></p>\n<p>Step 4: Even though the compensatory mechanisms try to bring up the pH to the normal level, the <strong>pH </strong>is still<strong> below</strong> the <strong>normal value</strong>, which means that the <strong>respiratory acidosis</strong> is<strong> uncompensated.</strong></p>\n<p>Thus, the best option is<strong>\u00a0respiratory acidosis</strong> with <strong>compensatory metabolic alkalosis.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a component of qSOFA score?",
    "choices": [
      {
        "id": 1,
        "text": "Respiratory rate \u226522"
      },
      {
        "id": 2,
        "text": "LDH- Lactate dehydrogenase"
      },
      {
        "id": 3,
        "text": "Altered mental status"
      },
      {
        "id": 4,
        "text": "Systolic blood pressure \u2264 100 mmHg"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p2\"><strong>Lactate dehydrogenase </strong>is <strong>not a component </strong>of the<strong> qSOFA score.&nbsp;</strong></p>\n<p class=\"p2\">qSOFA scoring<span class=\"s3\">&nbsp;is a&nbsp;simplified&nbsp;derivative of SOFA for&nbsp;<strong>bedside</strong>&nbsp;<strong>assessment</strong>&nbsp;that is&nbsp;</span><span class=\"s4\">particularly useful&nbsp;<strong>outside </strong>the<strong> ICU </strong>setting</span><span class=\"s3\">&nbsp;as it does not require laboratory values.</span></p>\n<p>The qSOFA&nbsp;assigns one point for each component and&nbsp;suggests potentially&nbsp;<strong>life-threatening sepsis</strong>&nbsp;when&nbsp;<strong>at least two</strong>&nbsp;of the following parameters are met.</p>\n<ul>\n<li><strong>Altered mental status</strong> (GCS &lt;15)</li>\n<li><strong>Systolic blood pressure &le; 100 mmHg</strong></li>\n<li><strong>Respiratory rate</strong>&nbsp;<strong>&ge;&nbsp;22 breaths/min.</strong></li>\n</ul>\n<p>A&nbsp;<strong>qSOFA&nbsp;</strong>score of&nbsp;<strong>&ge;</strong><strong>2</strong>&nbsp;is associated with a&nbsp;<strong>significant risk of death</strong>&nbsp;or prolonged ICU stay.</p>\n<p><strong>SOFA</strong>&nbsp;is a more comprehensive and accurate scoring system which is&nbsp;particularly&nbsp;<strong>superior to&nbsp;qSOFA</strong>&nbsp;in the<strong>&nbsp;ICU setting.</strong>&nbsp;<span class=\"s3\">This includes:</span></p>\n<ul>\n<li class=\"p3\"><span class=\"s3\"><strong>Circulation</strong> - Systolic BP &amp; need for vasopressors and platelet count</span></li>\n<li class=\"p3\"><span class=\"s3\"><strong>Respiration</strong> - PaO2/FiO2 &amp; need for mechanical ventilation</span></li>\n<li class=\"p3\"><span class=\"s3\"><strong>Mentation</strong> - Glasgow coma score</span></li>\n<li class=\"p3\"><span class=\"s3\"><strong>Hepatic function</strong> - Bilirubin</span></li>\n<li class=\"p3\"><span class=\"s3\"><strong>Renal function</strong> - Creatinine</span></li>\n</ul>\n<p class=\"p1\"><strong><span class=\"s1\">Organ dysfunction</span></strong><span class=\"s2\"> is identified by a </span><strong><span class=\"s1\">SOFA score of&nbsp;&ge; 2</span></strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is brought to the emergency room after a head-on motor vehicle collision. He is unresponsive even to painful stimuli and is apneic; however, he does have a pulse. Which of the following clinical findings would exclude a diagnosis of brain death?",
    "choices": [
      {
        "id": 1,
        "text": "Unresponsiveness to stimuli"
      },
      {
        "id": 2,
        "text": "Constricted pupils"
      },
      {
        "id": 3,
        "text": "Invariant pulse rate"
      },
      {
        "id": 4,
        "text": "Positive deep tendon reflexes"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Constricted pupils</strong> would rule out brain death.</p>\n<p><strong>Brain death</strong> is the&nbsp;<strong>irreversible</strong> <strong>cessation</strong> of all <strong>cerebral</strong> <strong>function</strong> with the preservation of cardiac activity and maintenance of respiratory and somatic function by artificial means.&nbsp;</p>\n<p>The diagnosis of brain death should be confirmed with the following clinical findings:</p>\n<ul>\n<li><strong>Brainstem damage</strong> as evidenced by <strong>dilated</strong> or <strong>mid-sized pupils</strong> without light reaction.</li>\n<li></li>\n<li>Absent brain-originating motor response, including response to pain stimulus above the neck or other brain-originating movements (eg, seizures, decerebrate or decorticate posturing)</li>\n<li><strong>Unresponsiveness</strong> to any stimuli,</li>\n<li>Absent corneal, gag and oculovestibular reflexes, Absent sucking or rooting reflexes, Absent cough with tracheal suctioning</li>\n<li><strong>Apnea</strong>, indicating medullary destruction.</li>\n<li>The <strong>heart rate</strong> should be invariant and does not accelerate to atropine.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following correctly represents the effect of the mutation causing sickle cell anemia?",
    "choices": [
      {
        "id": 1,
        "text": "Glutamate by valine at 6th position"
      },
      {
        "id": 2,
        "text": "Valine by glutamate at  6th position"
      },
      {
        "id": 3,
        "text": "Glutamate by valine at 5th position"
      },
      {
        "id": 4,
        "text": "Valine by glutamate at  5th position"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Sickle cell anemia</strong> is characterized by the replacement of\u00a0glutamate by valine at the 6th position.</p>\n<p>Sickle cell anemia is an\u00a0<strong>autosomal recessive\u00a0</strong>disorder occurring due to the T-to-A\u00a0<strong>point mutation</strong>\u00a0in the sixth codon of the \u03b2-globin gene. This results in the replacement of glutamate residue with valine. This leads to the formation of\u00a0<strong>sickle-shaped red blood cells</strong>\u00a0due to the polymerization of\u00a0<strong>deoxygenated</strong>\u00a0<strong>hemoglobin\u00a0</strong>(HbS).</p>\n<p>The\u00a0<strong>clinical features</strong>\u00a0of sickle cell disease are due to the tendency of\u00a0<strong>HbS molecules</strong>\u00a0to\u00a0<strong>stack</strong>\u00a0into\u00a0<strong>polymers</strong>\u00a0when\u00a0<strong>deoxygenated.</strong>\u00a0The features are:</p>\n<ul>\n<li>Moderately severe hemolytic anemia with jaundice.</li>\n<li><strong>Painful bone crisis-</strong>\u00a0hand-foot syndrome or dactylitis of the bones of hands and feet.</li>\n<li><strong>Acute chest syndrome</strong>\u00a0typically presents with fever, cough, chest pain, and\u00a0<strong>pulmonary infiltrates</strong>.</li>\n<li>Hyposthenuria- inability to concentrate urine.</li>\n<li><strong>Aplastic crisis</strong>\u00a0stems from the infection of red cell progenitors by\u00a0<em>parvovirus B19</em>, which causes a transient cessation of erythropoiesis and a sudden worsening of the anemia.</li>\n<li>Spleen\n<ul>\n<li>In children-\u00a0<strong>splenic sequestration</strong>\u00a0crises occur which results in\u00a0<strong>splenomegaly</strong>\u00a0due to red pulp congestion.</li>\n<li>Adolescence or early adulthood- <strong>auto splenectomy</strong>\u00a0occurs due to splenic infarction, fibrosis, and progressive shrinkage.</li>\n<li>Increased susceptibility to infection with encapsulated organisms like pneumococcal, meningococcal, and\u00a0<em>Haemophilus influenza</em>\u00a0septicemia, but can be reduced by vaccination and prophylactic antibiotics.</li>\n</ul>\n</li>\n<li>Other clinical features include priapism, leg ulcers,\u00a0<strong>stroke</strong>, retinopathy, pigment gallstones, and growth retardation.</li>\n</ul>\n<p>\u00a0The diagnosis is suggested by the clinical findings, the presence of\u00a0<strong>irreversibly sickled RBCs</strong>\u00a0on peripheral smear, and hemoglobin electrophoresis\u00a0showing<strong>\u00a0increased HbA2, HbF,</strong>\u00a0and\u00a0<strong>S spike.</strong></p>\n<p>Disease-modifying drugs such as hydroxyurea<strong>\u00a0</strong>can be given to patients with sickle cell anemia since it reduces the incidence of adverse vaso-occlusive vents. Blood transfusions are used to treat and prevent complications of sickle cell disease, including preparation for surgery, symptomatic anemia, acute stroke, multi-organ failure, and acute chest syndrome</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is part of trotter's triad, seen in nasopharyngeal carcinoma?",
    "choices": [
      {
        "id": 1,
        "text": "Conductive hearing loss, ipsilateral temporoparietal neuralgia, palatal paralysis"
      },
      {
        "id": 2,
        "text": "Sensorineural hearing loss, contralateral  temporoparietal neuralgia, palatal paralysis"
      },
      {
        "id": 3,
        "text": "Sensorineural hearing loss, ipsilateral temporoparietal neuralgia, epistaxis"
      },
      {
        "id": 4,
        "text": "Conductive hearing loss, contralateral temporoparietal neuralgia, epistaxis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Trotter\u2019s triad</strong>\u00a0seen in <strong>nasopharyngeal carcinoma\u00a0</strong>consists of <strong>conductive hearing loss, ipsilateral temporoparietal neuralgia,\u00a0</strong>and<strong> palatal paralysis.</strong></p>\n<p>In <strong>nasopharyngeal carcinoma</strong>, the tumour's location near these<strong> cranial nerves</strong> can lead to their compression or infiltration, resulting in the characteristic symptoms of <strong>Trotter's</strong> <strong>triad</strong>. Therefore, <strong>cranial nerves V </strong>(trigeminal nerve) and <strong>X</strong> (vagus nerve) are commonly affected in this condition.</p>\n<p>Nasopharyngeal carcinoma, a malignancy arising from the<strong> nasopharynx</strong>, can manifest with <strong>Trotter's triad</strong>, which includes:</p>\n<ul>\n<li><strong>Conductive deafness</strong>: This occurs due to obstruction or dysfunction of the <strong>eustachian tube</strong>, leading to impaired middle ear function.</li>\n<li><strong>Ipsilateral temporoparietal neuralgia</strong>: This symptom is characterized by <strong>sharp, shooting pain</strong> in the temporoparietal region of the head. It is primarily caused by the involvement of the <strong>trigeminal nerve</strong> (cranial nerve V), which carries <strong>sensory fibres</strong> from the face and certain parts of the head.</li>\n<li><strong>Palatal paralysis</strong>: This condition results from the involvement of the <strong>vagus nerve</strong> (cranial nerve X), which innervates the<strong> muscles</strong> of the <strong>soft palate</strong>. Palatal paralysis can lead to difficulty in swallowing, nasal regurgitation of fluids, and a nasal voice quality</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient has been brought to your emergency department with the following signs and symptoms - Dry mouth, irrelevant slurred speech, dry and hot skin, dilated pupils. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Alcohol intoxication"
      },
      {
        "id": 2,
        "text": "Datura poisoning"
      },
      {
        "id": 3,
        "text": "Organophosphate poisoning"
      },
      {
        "id": 4,
        "text": "Cocaine poisoning"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>clinical syndrome</strong> in the question is that of <strong>Datura poisoning.</strong></p>\n<ul>\n<li>\n<p class=\"p1\">Jimson weed (Datura stramonium) and angel&rsquo;s trumpet (Datura candida).</p>\n</li>\n<li>\n<p class=\"p1\">All Datura species contain the <strong>anticholinergic alkaloids atropine, scopolamine,</strong> and <strong>hyoscyamine.</strong></p>\n</li>\n<li>\n<p class=\"p1\">Seeds or other parts of the plant can be ingested or smoked and produce <strong>delirium, hallucinations,</strong> and<strong> seizures</strong> along with other classic<strong> anticholinergic effects,</strong> such as mydriasis, tachycardia, dry mouth and skin, blurred vision, urinary retention, and hyperthermia.</p>\n</li>\n<li>\n<p class=\"p1\"><strong>Gastric emptying</strong> is often <strong>delayed,</strong> and the small, plentiful seeds can become trapped among the gastrointestinal folds after ingestion; thus<strong> gastric decontamination</strong> can be an <strong>important therapy.</strong></p>\n</li>\n<li>\n<p class=\"p1\"><strong>Physostigmine,</strong> a reversible acetylcholine esterase antagonist, is an <strong>effective treatment</strong> for severe anticholinergic poisoning.</p>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Screening of immigrants from infectious diseases such as tuberculosis  is done in many countries to protect the home population.  What form of prevention is this?",
    "choices": [
      {
        "id": 1,
        "text": "Primary"
      },
      {
        "id": 2,
        "text": "Primordial"
      },
      {
        "id": 3,
        "text": "Secondary"
      },
      {
        "id": 4,
        "text": "Tertiary"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Screening of immigrants from infectious diseases such as tuberculosis&nbsp;is an example of&nbsp;<strong>Prospective screening</strong>, which is a form of primary prevention.&nbsp; &nbsp;</p>\n<p><strong>Prospective screening</strong>&nbsp;is done for the&nbsp;<strong>benefit of others, who have not gotten the disease. This is done so that the disease is controlled and not spread.&nbsp;</strong>Thus, it is a form&nbsp;of <strong>primary prevention.&nbsp;</strong></p>\n<p><strong>Prescriptive screening</strong>&nbsp;is done for <strong>case detection,</strong>&nbsp;and people are screened for their&nbsp;<strong>own benefits</strong>&nbsp;of early diagnosis of diseases existing in them. This is a form of secondary prevention. e.g., neonatal screening for hypothyroidism, pap smear for detection of cervical cancer.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following ocular examination findings with their pathology.",
    "choices": [
      {
        "id": 1,
        "text": "A-2, B-3, C-4, D-1"
      },
      {
        "id": 2,
        "text": "A-1, B-3, C-4, D-2"
      },
      {
        "id": 3,
        "text": "A-4, B-2, C-3, D-1"
      },
      {
        "id": 4,
        "text": "A-3, B-1, C-2, D-4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct match is as follows:</p>\n<p>Image A:&nbsp;Vossius ring<br />Image B:&nbsp;Arcus lipoides<br />Image C:&nbsp;Kayser-Fleischer&nbsp;ring<br />Image D:&nbsp;Wessely's immune ring</p>\n<p>Vossius ring is&nbsp;a circular ring of faint or stippled opacity, seen on the<strong>&nbsp;anterior surface</strong>&nbsp;of the lens due to brown&nbsp;<strong>amorphous granules of pigment</strong>&nbsp;lying&nbsp;<strong>on the capsule of the lens</strong>. It is usually seen after&nbsp;<strong>blunt trauma</strong>&nbsp;to the eye and orbit.</p>\n<p>It usually has about the same diameter as the contracted pupil. The force of the blow drives the cornea and iris backward and thus producing an impression of the iris on the lens as shown below. The resorption of the pigment results in discrete subcapsular opacities.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/162b51a9c1ef4d33b59f45bf7d205a37.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9af034e2460549859ac6971d682ecf55x720x703.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2bc0dbf7d78b41bb86bafbb6fe381efdx720x478.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/63233cf8d58149e4a2ee7c0c349043fex288x191.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/02572dc69a73401a95a0610e9c72243bx688x514.PNG"
    ]
  },
  {
    "text": "A 48-year-old woman was advised mammography for the presence of a lump in her right breast. According to the mammogram findings, the lump was categorized as BIRADS 3. What will be the next appropriate step in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Perform trucut biopsy"
      },
      {
        "id": 2,
        "text": "Routine annual screening"
      },
      {
        "id": 3,
        "text": "Fine needle aspiration cytology"
      },
      {
        "id": 4,
        "text": "Follow-up every 6 months for 2 years"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The next appropriate step in this patient will be to <strong>follow up</strong> the patient <strong>every 6 months</strong> for the next 2 years.</p>\n<p>A Breast Imaging Reporting and Data System (BIRADS) score of <strong>3</strong> means that it is a probably benign lesion. The next step should be a close follow-up every 6 months for the next 2 years. During this period, the score can either be downgraded to BIRADS 2 or upgraded to BIRADS 4 or 5.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year old male come to casualty with head injury. Examination reveals normal consciousness and blood in the tympanic membrane. Most likely cause is?",
    "choices": [
      {
        "id": 1,
        "text": "Extradural hemorrhage"
      },
      {
        "id": 2,
        "text": "Subdural hemorrhage"
      },
      {
        "id": 3,
        "text": "Intraventricular hemorrhage"
      },
      {
        "id": 4,
        "text": "Basilar fracture"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Hemotympanum is a feature of fracture of Skull Base.</p>\n<p><strong>Anterior Cranial Fossa Fracture:</strong></p>\n<ul>\n<li>Subconjunctival hematoma</li>\n<li><strong>CSF rhinorrhea</strong></li>\n<li><strong>Carotico-cavernous fistula</strong></li>\n<li>Periorbital hematoma or <strong>raccoon eyes</strong></li>\n</ul>\n<p><strong>Middle Cranial Fossa Fracture:</strong></p>\n<ul>\n<li>CSF otorrhea or rhinorrhea</li>\n<li>Hemotympanum</li>\n<li>Ossicular disruption</li>\n<li>Battle sign: bruising behind the ear</li>\n<li>7th and 8th cranial nerve palsies</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 5';
        const quizFilename = 'fmge-mini-test-5-6bc71e99.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>