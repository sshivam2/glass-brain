<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 22 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Mr. Sonu is brought to the hospital because his family members feel that his movements and activities have become very slow.  On examination, the patient has tremors, slurred speech, rigidity, and impaired cerebellar function. He also has orthostatic hypotension. The MRI of his brain is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pantothenate kinase\u2013associated neurodegeneration"
      },
      {
        "id": 2,
        "text": "Parkinson's disease"
      },
      {
        "id": 3,
        "text": "Multiple system atrophy"
      },
      {
        "id": 4,
        "text": "Progressive supranuclear palsy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical presentation and the MRI showing <strong>hot cross bun sign\u00a0</strong>suggest that the most likely diagnosis is<strong> multiple system atrophy</strong>.\u00a0</p>\n<p><strong>Multiple system atrophy </strong>(MSA)<strong>\u00a0</strong>is a type of<strong> atypical Parkinson's disease.\u00a0</strong>Along with the features of Parkinson's disease, they also have <strong>cerebellar</strong> and <strong>autonomic</strong> features. The common autonomic feature seen in these patients is <strong>orthostatic hypotension</strong>. MSA is characterized by the presence of degeneration in the\u00a0<strong>striatum, cerebellum, </strong>and <strong>inferior olivary nuclei</strong> coupled with characteristic glial cytoplasmic <strong>inclusions.</strong> These inclusions stain positively for\u00a0<strong><span class=\"s1\">\u03b1</span>-synuclein.</strong></p>\n<p>Other options:</p>\n<p>Option A- <strong>Pantothenate kinase-associated neurodegeneration</strong> (PKAN) formerly known as Hallervorden-Spatz disease is caused by a mutation in the <strong>PANK2 gene.</strong> It usually occurs in childhood and has features of dystonia, parkinsonism, and spasticity. MRI shows the low signal abnormality in the center of the globus pallidus due to iron accumulation. This is known as the <strong>eye of the tiger sign</strong>.</p>\n<p>The below image shows the Eye of the tiger sign seen in PKAN:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2abafb9b40d544729a69df67bd9b3a3e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/920988045ccc475daf2e2e91992587ccx649x799.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dbff961f2032492a8a275500c9132dfdx289x222.PNG"
    ]
  },
  {
    "text": "A soldier is brought to the hospital after receiving a blow on the head during a war. There is no history of loss of consciousness. He opens his eyes spontaneously, obeys commands, and is able to converse normally, being oriented to time, place and person. Using the GCS scoring, the head injury of this patient is classified as:",
    "choices": [
      {
        "id": 1,
        "text": "Moderate"
      },
      {
        "id": 2,
        "text": "Severe"
      },
      {
        "id": 3,
        "text": "Minor"
      },
      {
        "id": 4,
        "text": "Mild"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The head injury of this patient is classified as <strong>minor</strong>, using the Glasgow Coma Scale score. GCS score of 15 in a patient with no loss of consciousness is called a minor head injury.</p>\n<p><strong>Glasgow Coma Scale&nbsp;</strong>(GCS)<strong>&nbsp;</strong>is used in the assessment of patients with a&nbsp;head injury<strong>.&nbsp;</strong>The GCS score based on the given clinical scenario is<strong>&nbsp;15</strong>&nbsp;(<strong>E4 V5 M6</strong>)<strong>.</strong></p>\n<p>It is calculated as follows</p>\n<ul>\n<li>Eye-opening: Spontaneous, Score = 4</li>\n<li>Verbal response: Normal oriented conversation, score = 5</li>\n<li>Motor response: Obeys commands, score = 6</li>\n</ul>\n<p>Based on the GCS score, the head injury sustained can be classified as follows:</p>\n<p><strong>GCS Score</strong></p>\n<p>&nbsp;</p>\n<ul>\n<li class=\"ng-binding ng-scope\">15 with no loss of consciousness represents minor head injury</li>\n<li class=\"ng-binding ng-scope\">13-15 represent mild injury</li>\n<li>9-12 represent moderate injury</li>\n<li>scores &le;8 represent severe injury\u202f</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is admitted to the hospital for management of burns. He is being treated for severe pain with fentanyl being administered in a manner as seen in the image below. The false statement regarding this drug delivery system is:",
    "choices": [
      {
        "id": 1,
        "text": "Delivers the drug into systemic circulation via the stratum basale"
      },
      {
        "id": 2,
        "text": "Steady plasma concentration of the drug without fluctuations"
      },
      {
        "id": 3,
        "text": "Absorption of the drug occurs more readily through burned skin"
      },
      {
        "id": 4,
        "text": "A priming dose of the drug already exists on a micropore membrane"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows a <strong>transdermal patch</strong>. The false statement regarding this drug delivery system is that it delivers the drug into systemic circulation via stratum basale. It delivers the drug into the systemic circulation via the <strong>stratum corneum</strong>.</p>\n<p>The below diagram shows the components of a transdermal patch:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0a4d6eb85cd44ddc94ff1efe3ef54eb3.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1ab4885bff3940bfb0ab1597e416ec28x720x524.JPEG"
    ]
  },
  {
    "text": "A 65-year-old man presents with complaints of hematuria, fever, and weight loss. On examination, there is a palpable mass in the left iliac fossa. Histopathological features of the mass are shown in the image below. Identify the false statement about this type of renal cell carcinoma.",
    "choices": [
      {
        "id": 1,
        "text": "Most common type of renal cell carcinoma"
      },
      {
        "id": 2,
        "text": "Is associated with von Hippel-Lindau syndrome"
      },
      {
        "id": 3,
        "text": "Commonly arise from distal convoluted tubules"
      },
      {
        "id": 4,
        "text": "May extend into the inferior vena cava"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The false statement about this type of renal cell carcinoma is that it arises from the distal convoluted tubules.</p>\n<p>The given clinical vignette of a <strong>man</strong> in his <strong>6th decade</strong> of life presenting with symptoms of <strong>hematuria</strong>,\u00a0<strong>fever,</strong> and <strong>weight loss</strong> and examination showing a palpable mass in the left iliac fossa with the histopathological image given above is indicative of <strong>clear cell carcinoma</strong>.</p>\n<p>Clear cell carcinoma is the <strong>most common</strong> type of <strong>renal cell cancer</strong> and the <strong>third most common</strong> of <strong>urological cancers</strong>.</p>\n<div class=\"page\" title=\"Page 586\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Most of the cases are sporadic, but can also occur either in familial forms or in association with <strong>von Hippel-Lindau</strong> (VHL) disease. Nevertheless, all three forms are associated with the loss of sequence of the <strong>short arm</strong> of <strong>chromosome 3</strong>.</p>\n<p>Those with VHL disease inherit a germline mutation of the VHL gene on chromosomal band <strong>3p25</strong> and lose the second allele by somatic mutation. This VHL gene is involved in the majority of sporadic clear cell carcinomas. Cytogenetic abnormalities giving rise to loss of a segment on chromosome <strong>3p</strong> that has the VHL gene are seen in sporadic renal cell cancers. The second, non-deleted allele is inactivated by a somatic mutation or hypermethylation. Thus, loss or inactivation of both copies of the VHL gene is the common underlying molecular abnormality in both sporadic and familial forms of clear cell carcinomas.</p>\n<p>The VHL protein causes the degradation of <strong>hypoxia-induced factors</strong> (HIFs), which are transcription factors that contribute to carcinogenesis by stimulating the expression of vascular endothelial growth factor (VEGF) that helps drive tumour cell growth.</p>\n<p>Histologically, they are composed of cells with clear cytoplasm. Most of them arise from the <strong>proximal tubular epithelium</strong> and usually occur as solitary unilateral lesions. They are bright yellow-grey-white spherical masses of variable size that distort the renal outline.</p>\n<p>The margins are sharply defined and confined within the renal capsule. In clear cell carcinoma, the growth pattern varies from solid to trabecular (cordlike) or tubular (resembling tubules). The tumour cells have a rounded or polygonal shape and abundant clear or granular cytoplasm, which contains glycogen and lipids.</p>\n<div class=\"page\" title=\"Page 952\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>One of the characteristic features of clear cell carcinoma is its tendency to grow as a solid column of cells that <strong>extend from</strong> the <strong>renal vein</strong>, up to the<strong> inferior vena cava</strong>, and sometimes as far as the<strong> right</strong> side of the<strong> heart</strong>.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d0a822e4f83a44c09ad30ea8a5b2f87e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young man suffered a trauma to his right hand while playing basketball. 3 weeks later, he reports to the orthopedician because of pain and stiffness over the right wrist. On examination, wrist movements are limited and painful. He is diagnosed with Kienb\u00f6ck's disease. This condition involves avascular necrosis of:",
    "choices": [
      {
        "id": 1,
        "text": "Scaphoid"
      },
      {
        "id": 2,
        "text": "Hamate"
      },
      {
        "id": 3,
        "text": "Capitate"
      },
      {
        "id": 4,
        "text": "Lunate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Kienb&ouml;ck's disease</strong> involves avascular necrosis of the <strong>l</strong><strong>unate</strong>.</p>\n<div class=\"page\" title=\"Page 438\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>This condition is usually seen in&nbsp;<strong>young adults</strong>, who present with pain and stiffness in the wrist. A&nbsp;<strong>history of trauma </strong>may be present. On examination, localized tenderness can be appreciated over the lunate, and a <strong>reduction</strong> in&nbsp;<strong>grip strength</strong>&nbsp;can be noted.&nbsp;<strong>Limited </strong>and<strong> painful</strong>&nbsp;wrist <strong>movements</strong> are noted in the later stages of the disease.</p>\n<p>It involves four stages:&nbsp;</p>\n<ul>\n<li><strong>Stage 1</strong> involves <strong>ischemia</strong> of the bone, <strong>without</strong> any clinical or <strong>radiographic abnormality</strong>&nbsp;</li>\n<li><strong>Stage 2</strong> shows&nbsp;<strong>trabecular necrosis</strong> with reactive <strong>new bone formation</strong>. There is increased radiographic density, but little/no distortion of the shape</li>\n<li><strong>Stage 3</strong> involves the <strong>collapse</strong> of the bone</li>\n<li><strong>Stage 4</strong> is characterized by <strong>disruption</strong> of <strong>radiocarpal congruence</strong> and secondary osteoarthritis</li>\n</ul>\n<p>In the <strong>initial stages</strong>, an X-ray might be normal, therefore an <strong>MRI with gadolinium enhancement</strong> is the investigation of choice.&nbsp;</p>\n<p>Management includes the use of <strong>splints</strong> and <strong>vascularized bone grafts</strong> for the early stages of the disease and <strong>total wrist fusion/replacement</strong> for advanced disease.</p>\n<p>Note: Avascular necrosis of the scaphoid occurs due to a fracture of the waist of the scaphoid bone.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4e4688cdf25f4b66b0d00057cca98ca1x356x184.JPEG"
    ]
  },
  {
    "text": "Match the enzyme with the disease caused by its deficiency:",
    "choices": [
      {
        "id": 1,
        "text": "1-c, 2-a, 3-d, 4-b"
      },
      {
        "id": 2,
        "text": "1-c, 2-d, 3-b, 4-a"
      },
      {
        "id": 3,
        "text": "1-a, 2-c, 3-d, 4-b"
      },
      {
        "id": 4,
        "text": "1-a, 2-d. 3-b, 4-c"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct sequence is 1-c, 2-a, 3-d, 4-b as shown in the table below.<br /><br /></p>\n<table style=\"height: 151px; width: 361.016px;\">\n<tbody>\n<tr>\n<td style=\"width: 188px;\"><strong>Enzyme</strong></td>\n<td style=\"width: 155.016px;\"><strong>Disease</strong></td>\n</tr>\n<tr>\n<td style=\"width: 188px;\">Glucose-6-phosphate</td>\n<td style=\"width: 155.016px;\">von Gierke disease</td>\n</tr>\n<tr>\n<td style=\"width: 188px;\">Liver phosphorylase\u00a0</td>\n<td style=\"width: 155.016px;\">Hers disease</td>\n</tr>\n<tr>\n<td style=\"width: 188px;\">Fumarylacetoacetate hydrolase</td>\n<td style=\"width: 155.016px;\">Tyrosinemia type I</td>\n</tr>\n<tr>\n<td style=\"width: 188px;\">Ceramidase</td>\n<td style=\"width: 155.016px;\">Farber's disease</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p><strong>von Gierke disease</strong> is caused to <strong>glucose-6-phosphate deficiency</strong> and patients with this condition have hypoglycemia, lactic academia, ketosis, hyperlipidemia and liver and renal tubule cells having glycogen deposits.</p>\n<p><strong>Hers disease</strong> is caused due to <strong>liver phosphorylase deficiency</strong> and in this condition, glycogen accumulates in liver leading to hepatomegaly, and there is hypoglycemia</p>\n<p><strong>Tyrosinemia type I</strong> is caused due to a deficiency of the enzyme <strong>fumarylacetoacetate hydrolase</strong>. The untreated type usually presents in young infants with severe liver involvement or later with liver and renal tubular dysfunction associated with growth failure and rickets. Other features include altered mental status, abdominal pain, peripheral neuropathy, and/or respiratory failure requiring mechanical ventilation.</p>\n<p><strong>Farber's disease</strong> is caused due to a deficiency of <strong>ceramidase</strong> and manifests as hoarseness, dermatitis, skeletal deformation, mental retardation. It is fatal in early life.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman delivers a baby at the primary health center. While examining the baby, you notice a foot deformity as shown in the image below. Screening for other defects and early cost-free intervention for this condition is covered under which of the following schemes?",
    "choices": [
      {
        "id": 1,
        "text": "Rashtriya Bal Swasthya Karyakram"
      },
      {
        "id": 2,
        "text": "Navjat Shishu Suraksha Karyakram"
      },
      {
        "id": 3,
        "text": "Janani Sishu Suraksha Karyakaram"
      },
      {
        "id": 4,
        "text": "PM Surakshit Matritva Abhiyan"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The condition seen in the given image is&nbsp;<strong>clubfoot </strong>(congenital talipes equinovarus or CTEV). Screening of this birth defect and early intervention are covered under the&nbsp;<strong>Rashtriya Bal Swasthya Karyakram</strong> scheme.</p>\n<p>Rashtriya Bal Swasthya Karyakram (RBSK) is an important initiative aiming at early identification and early intervention for children from birth to 18 years to cover 4 &lsquo;D&rsquo;s which are:</p>\n<ul>\n<li>Defects at birth</li>\n<li>Deficiencies</li>\n<li>Diseases</li>\n<li>Development delays, including disability.</li>\n</ul>\n<p>The first level of screening is done by medical officers, staff nurses, and ANMs, at all the places where deliveries are conducted. After 48 hours, up to 6 weeks, the screening of newborns will be done by ASHA at home as a part of the Home Based New-born Care (HBNC) package.</p>\n<p>The target groups are divided into three groups based on age:</p>\n<ul>\n<li>Newborn to 6 weeks</li>\n<li>6 weeks to 6 years</li>\n<li>6 years to 18 years.</li>\n</ul>\n<p>They screen all the babies born at public health facilities and at home, preschool children in rural areas and urban slums, and children up to 12th grade enrolled in government schools.</p>\n<p>Defects screened during birth :</p>\n<ul>\n<li>Neural tube defect&nbsp;</li>\n<li>Down's Syndrome&nbsp;</li>\n<li>Cleft Lip &amp; Palate / Cleft palate alone</li>\n<li><strong>Talipes (club foot)</strong></li>\n<li>Developmental dysplasia of the hip</li>\n<li>Congenital cataract</li>\n<li>Congenital deafness</li>\n<li>Congenital heart diseases</li>\n<li>Retinopathy of Prematurity</li>\n</ul>\n<p>Other options :</p>\n<p>Option B:<strong> Navjat Shishu Suraksha Karyakram</strong>:&nbsp;NSSK is a program aimed to train health personnel in basic newborn care and resuscitation, has been launched to address care at birth issues i.e. prevention of hypothermia, prevention of infection, early initiation of breastfeeding, and basic newborn resuscitation.</p>\n<p>Option C: <strong>Janani Sishu Suraksha Karyakaram</strong>:&nbsp;It is an initiative to provide completely free and cashless services to pregnant women including normal deliveries and cesarean operations and sick newborns (up to 30 days after birth) in Government health institutions in both rural &amp; urban areas.</p>\n<p>Option D:<strong> Pradhan Mantri Surakshit Matritva Abhiyan</strong>: This program aims to provide assured, comprehensive, and quality antenatal care, free of cost, to all pregnant women on the 9th of every month.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7ae147ca9a054c658deb4e717d92f1e7.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 22-year-old college student reports feelings of low energy, lack of motivation, hopelessness, and feeling useless. She mentions that she has felt this way since her teenage years. There is no history suggestive of suicidal attempts, ideation, or any manic episodes. A diagnosis of dysthymia was made. Which is the most commonly used method of psychotherapy in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Behavior therapy"
      },
      {
        "id": 2,
        "text": "Insight oriented therapy"
      },
      {
        "id": 3,
        "text": "Interpersonal therapy"
      },
      {
        "id": 4,
        "text": "Cognitive therapy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is consistent with the diagnosis of <strong>dysthymia, </strong>and the most commonly used therapy for treatment is <strong>insight-oriented therapy.</strong> Dysthymia refers to a persistent depressive mood lasting for more than 2 years (1 year in children and adolescents) but are not severe enough to be diagnosed as major depression.</p>\n<div class=\"page\" title=\"Page 366\"><strong>DSM V Criteria for diagnosis of dysthymia:\u00a0</strong>Depressed mood for most of the day as indicated by either subjective account or observation by others, for at\u00a0<strong>least 2 years</strong>. In children and adolescents - at\u00a0<strong>least 1 year.</strong></div>\n<p>Presence\u00a0of<strong>\u00a0two (or more)</strong>\u00a0of the following while being depressed.</p>\n<ul>\n<li>Poor appetite or overeating</li>\n<li>Insomnia or hypersomnia</li>\n<li>Low energy or fatigue</li>\n<li>Low self-esteem</li>\n<li>Poor concentration and/or difficulty making decisions</li>\n<li>Feelings of hopelessness</li>\n</ul>\n<div class=\"page\" title=\"Page 398\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 398\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 399\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>As per DSM- 5, onset can be early -before 21 years of age or late -after 21 years of age.</p>\n<p>The most effective treatment involves a combination of psychotherapy and pharmacotherapy. They include:</p>\n<div class=\"page\" title=\"Page 401\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Insight-Oriented Psychotherapy</strong> (Psychoanalytic psychotherapy): It is the <strong>most common</strong>\u00a0method and is considered the treatment of choice.\u00a0 This therapeutic approach attempts at relating the depressive symptoms to unresolved conflicts from the past. The patient's relationships and current lifestyle are examined, and insight is gained.</li>\n<li><strong>Cognitive therapy</strong>: Patients are taught new ways of thinking and behaving, to replace negative and depressive attitudes about themselves, the world, and the future.</li>\n<li><strong>Behavioral therapy</strong>: Patients are made to focus on specific goals to increase activity, pleasant experiences, and relaxation. Altering per\u00adsonal behavior is believed to be effective in changing depressed thoughts and feelings.</li>\n<li><strong>Interpersonal therapy</strong>: The patient's current interpersonal experi\u00adences and methods of coping with stress are examined to reduce depressive symptoms and to improve self-esteem.\u00a0</li>\n<li><strong>Family and group therapy</strong>: Helps both the patient and their family deal with the symptoms of the disorder. Group therapy may help withdrawn patients learn new ways to overcome their interper\u00adsonal issues in social settings</li>\n<li><strong>Pharmacotherapy</strong>: Selective serotonin reuptake inhibitors (SSRIs) like venlafaxine and bupropion are effective.</li>\n</ul>\n<p>Hospitalization is usually not indicated in dysthymia. However, severe symptoms, marked social or professional incapacitation, the need for exten\u00adsive diagnostic procedures, and suicidal ideation are all indica\u00adtions for hospitalization.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old patient is under general anesthesia. Which of the following circuits is least effective for the prevention of rebreathing during spontaneous ventilation?",
    "choices": [
      {
        "id": 1,
        "text": "Bain circuit"
      },
      {
        "id": 2,
        "text": "Magill's circuit"
      },
      {
        "id": 3,
        "text": "Mapleson A circuit"
      },
      {
        "id": 4,
        "text": "Lack's circuit"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 922\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Among the given options, the <strong>Bain</strong> circuit (modification of Mapleson D circuit) is the <strong>least effective</strong> for spontaneous ventilation.\u00a0</p>\n<p>The relative efficiency of different Mapleson systems with respect to prevention of rebreathing during spontaneous ventilation:</p>\n<p><strong>Mapleson A &gt;\u00a0Mapleson D, F, E &gt; Mapleson C, B.\u00a0<br /></strong></p>\n<p>Mnemonic: A &gt; DFE &gt; CB\u00a0: A Dog Can Bite (Usually a spontaneous event)</p>\n<p><strong>Mapleson A circuit</strong> is also known as <strong>Magill's circuit</strong>. It has an adjustable pressure limiting valve located near the facemask, and fresh gas flow enters the opposite end of the circuit near the reservoir bag. A corrugated tubing connects the reservoir bag near the machine end to the adjustable pressure limiting valve at the patient end of the system. It is the best circuit for <strong>spontaneous respiration</strong> as no rebreathing occurs with adequate flows.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b8edd30b1ddd4f3e83cc4272d8c7038ax1280x1046.9442484121382.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7dfd862f09b34b29894879c74db1cd09x1280x875.5994358251057.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9a852f7d3eec4a6cbc22c6045ea32784x1280x1678.984485190409.JPEG"
    ]
  },
  {
    "text": "A 3-year-old child was referred to the Ophthalmology department for evaluation of upper eyelid ptosis. Previous photographs suggest that it has been present from birth. The external eye measurements are given below. Which among the following surgeries is used to manage this case?",
    "choices": [
      {
        "id": 1,
        "text": "Levator resection through the conjunctiva"
      },
      {
        "id": 2,
        "text": "Fasanella Servat operation"
      },
      {
        "id": 3,
        "text": "Frontalis sling suspension"
      },
      {
        "id": 4,
        "text": "Levator resection with aponeurotic reinsertion"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Frontalis sling suspension </strong>is done for <strong>congenital ptosis </strong>with <strong>poor</strong> levator function.</p>\n<div class=\"page\" title=\"Page 473\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Ptosis refers to the drooping of the upper eyelid such that it covers more than 2 mm of the superior cornea. It may be congenital or acquired.</p>\n<p>Congenital Ptosis may be classified as:</p>\n<ul>\n<li>Simple - isolated abnormality</li>\n<li>Complicated -associated with ocular motor anomalies, blepharophimosis syndrome, and Marcus Gunn ptosis.</li>\n</ul>\n<p>The presence of congenital ptosis should be confirmed by photographs taken during childhood. It is usually bilateral and is due to defective development of the muscle.</p>\n<p>Measurements to assess ptosis:</p>\n<ul>\n<li><strong>Margin-reflex distance</strong>: The distance between the upper lid margin and the corneal reflection of a torch held by the\u00a0examiner on which the patient fixates. It is normally\u00a04\u20135 mm.</li>\n<li><strong>Palpebral fissure height</strong>: The distance between the upper and lower lid margins. It is measured in the pupillary plane. Normally it is 7\u201310 mm in males and 8\u201312 mm in females. Ptosis can be graded as\n<ul>\n<li>mild (up to 2 mm)</li>\n<li>moderate (2-3 mm)</li>\n<li>severe (4 mm or more)</li>\n</ul>\n</li>\n<li><strong>Levator function</strong> (upper lid excursion): It is measured by placing the thumb firmly against the patient\u2019s brow with the gaze fixed downwards. The patient is then asked to look up as much as possible and the amount of excursion is measured with a ruler. It is graded as:\n<ul>\n<li>Good:12\u201314 mm</li>\n<li>Fair: 5\u201311 mm</li>\n<li>Poor: 4 mm or less</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<p>When the levator function is poor (3 mm or less), the eyelid is suspended from the frontalis muscle using sutures, a fascia lata sling, or a silicone band.\u00a0Infection of the suture bed is a complication of this surgery and the suture should be monitored.</p>\n<p>Surgical treatment of various types of ptosis:</p>\n<p>In patients with\u00a0 <strong>good to moderate levator action</strong>:</p>\n<table style=\"width: 442px;\">\n<tbody>\n<tr style=\"height: 72px;\">\n<td style=\"width: 219px; height: 72px;\">Surgery</td>\n<td style=\"width: 131.562px; height: 72px;\">Amount of ptosis that can be treated</td>\n<td style=\"width: 218.438px; height: 72px;\">Indications</td>\n</tr>\n<tr style=\"height: 35px;\">\n<td style=\"width: 219px; height: 35px;\">Fasanella Servat</td>\n<td style=\"width: 131.562px; height: 35px;\">&lt; 2 mm</td>\n<td style=\"width: 218.438px; height: 35px;\">Horner Syndrome</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 219px; height: 54px;\">Levator Resection \u2013 Anterior approach</td>\n<td style=\"width: 131.562px; height: 54px;\">Any</td>\n<td style=\"width: 218.438px; height: 54px;\">Larger resection in ptosis</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 219px; height: 54px;\">Levator resection \u2013 Conjunctival approach</td>\n<td style=\"width: 131.562px; height: 54px;\">Any</td>\n<td style=\"width: 218.438px; height: 54px;\">Moderate resection in ptosis</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 219px; height: 54px;\">Levator resection with aponeurotic reinsertion</td>\n<td style=\"width: 131.562px; height: 54px;\">Any</td>\n<td style=\"width: 218.438px; height: 54px;\">Acquired ptosis</td>\n</tr>\n</tbody>\n</table>\n<p>In patients with\u00a0<strong>poor levator action</strong>:</p>\n<table style=\"width: 442px;\">\n<tbody>\n<tr style=\"height: 39.6875px;\">\n<td style=\"width: 219px; height: 39.6875px;\">Surgery\u00a0 \u00a0\u00a0</td>\n<td style=\"width: 219px; height: 39.6875px;\">Amount of ptosis that can be treated</td>\n<td style=\"width: 219px; height: 39.6875px;\">Indications</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 219px; height: 54px;\">Frontalis suspension \u2013 Fascia lata</td>\n<td style=\"width: 131.562px; height: 54px;\">&gt; 2 mm</td>\n<td style=\"width: 218.438px; height: 54px;\">Congenital ptosis, especially Marcus Gunn Ptosis</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old woman presents to the clinic with 6 weeks of amenorrhea. Her urine pregnancy test is positive. On bimanual examination, the apposition of vaginal and abdominal fingers is possible below the body of the uterus. What is this sign called?",
    "choices": [
      {
        "id": 1,
        "text": "Chadwick's sign"
      },
      {
        "id": 2,
        "text": "Hegar's sign"
      },
      {
        "id": 3,
        "text": "Goodell sign"
      },
      {
        "id": 4,
        "text": "Osiander's sign"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This sign described above is called <strong>Hegar's sign</strong>.</p>\n<p>During bimanual examination, two fingers are placed in the anterior fornix and two fingers feel are on the abdomen, behind the uterus.&nbsp;Around 6-10 weeks of gestation, the growing fetus leads to enlargement of the upper part of the uterus, while the lower part is empty and soft. The cervix is firm in consistency. Because of this,&nbsp;<strong>apposition</strong> of the <strong>abdominal</strong> and <strong>vaginal</strong> fingers,&nbsp;<strong>below</strong> the <strong>body</strong> of the <strong>uterus,</strong>&nbsp;is possible on bimanual examination. This is called the Hegar's sign.</p>\n<p>Other options:</p>\n<p>Option A- A bluish tint of the ectocervix due to increased vascularity- <strong>Chadwick's sign</strong></p>\n<p>Option C- Cervical edema and softening- <strong>Goodell sign</strong></p>\n<p>Option D- Increased pulsations felt through the lateral fornices - <strong>Osiander's sign</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old man presented with a slowly progressive swelling with pain in the middle of his right leg. Microscopic examination of a biopsied specimen showed epithelial cells in a fibrous stroma as shown in the image below. He is diagnosed with an adamantinoma. What do you expect to see on an X-ray of the lesion?",
    "choices": [
      {
        "id": 1,
        "text": "Sharply demarcated radiolucent lesions in tibial diaphysis"
      },
      {
        "id": 2,
        "text": "Soft tissue mass with extensive calcification"
      },
      {
        "id": 3,
        "text": "Homogenously lytic lesion with lack of calcification"
      },
      {
        "id": 4,
        "text": "Ground glass appearance of bone with multiloculated lesions"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>An X-ray of an adamantinoma\u00a0shows <strong>multiple sharply demarcated radiolucent lesions</strong> in the<strong> tibial diaphysis </strong>and<strong> honeycomb/soap bubble</strong> appearance.</p>\n<p><strong>Adamantinoma</strong> is a <strong>rare\u00a0tumor </strong>of the<strong> diaphysis\u00a0</strong>and presents commonly with pain and mild swelling in the front of the leg. It usually presents in the<strong> 2nd or 3rd decade</strong>\u00a0and arises from the\u00a0<strong>epithelial</strong> <strong>cells</strong>.\u00a0</p>\n<p>On examination, there is thickening and tenderness along the subcutaneous border of the tibia<strong>.</strong></p>\n<p>Histology<strong>\u00a0</strong>shows islands of epithelial-like cells (can have an acinar arrangement) in a densely populated stroma of spindle cells.</p>\n<p>Adamantinoma is a <strong>low-grade tumor</strong> that metastasizes late \u2013 and usually only after repeated and inadequate attempts at removal<strong>.\u00a0</strong><strong>Complete excision of the tumor</strong> is the treatment of choice.\u00a0</p>\n<p>The following image shows an X-ray and gross specimen of an adamantinoma.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a42c1e2e061141d5bab512e290ec0dad.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fc3916480c09483cb80314942794aae9x800x421.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0d36e8e759d74bac952213d2679dfa67x720x912.JPEG"
    ]
  },
  {
    "text": "A young man presents with a history of head injury. On examination, his pulse rate is 52/minute, blood pressure is 168/100 mm Hg, and respiratory rate is 10/min. Which among the following options is responsible for the raised blood pressure in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "J reflex"
      },
      {
        "id": 2,
        "text": "Bainbridge reflex"
      },
      {
        "id": 3,
        "text": "Bezold-Jarisch reflex"
      },
      {
        "id": 4,
        "text": "Cushing reflex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The reflex responsible for elevated BP in a patient with a head injury is the\u00a0<strong>Cushing</strong> <strong>reflex. </strong><strong>The Cushing</strong>\u00a0<strong>reflex</strong> is a <strong>triad</strong> of:</p>\n<ul>\n<li>Reflex bradycardia (via arterial baroreceptors)</li>\n<li>Hypertension (with widened pulse pressure)</li>\n<li>Irregular respiration (bradypnea).</li>\n</ul>\n<p>When intracranial pressure is increased, the blood supply to <strong>rostral ventrolateral</strong> neurons is compromised. This leads to local hypoxia and hypercapnia which in turn increase the discharge of the central chemoreceptors located on the ventrolateral medullary surface. This activation causes a rise in blood pressure which then restores the blood flow to the medulla. However, the arterial baroreceptors sense this increase in the systemic blood pressure and cause a reflex decrease in the heart rate.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/061b843708f5485f811fbe8ddddb9efex1280x1214.PNG"
    ]
  },
  {
    "text": "A 45-year-old obese patient presents with autophony. He says he can even hear the sounds of his breath and this gets exaggerated when he performs pranayama. He recently undertook a rapid weight loss program and lost 45 kgs over three months. The image below shows the procedure performed and the instrument used, for the management of his condition. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Blocked eustachian tube"
      },
      {
        "id": 2,
        "text": "Retracted eustachian tube"
      },
      {
        "id": 3,
        "text": "Overtly patent eustachian tube"
      },
      {
        "id": 4,
        "text": "Eustachian tube atelectasis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The given clinical scenario with a clinical history suggestive of rapid weight loss, patient hearing his voice (autophony) and the symptom getting exaggerated while attempting to breathe after closing opposite nostril (as performed during Yoga)</span><strong><span data-preserver-spaces=\"true\">\u00a0</span></strong>is seen in <strong><span data-preserver-spaces=\"true\">patulous eustachian tube/ overtly/ abnormally patent eustachian tube.\u00a0</span></strong></p>\n<p><span data-preserver-spaces=\"true\">The treatment of this condition includes <strong>e</strong></span><strong><span data-preserver-spaces=\"true\"><strong>us</strong>tachian tube catheterization\u00a0</span></strong><span data-preserver-spaces=\"true\">as shown in the image. Image A and B are steps involved in the procedure while image C shows the <strong>eustachian tube catheter.\u00a0</strong>It is actually a curved, metal cannula, measuring about 5 inches in length. Its tip is curved gently downwards. It is used to catheterize the Eustachian tube and is also used to remove foreign bodies in the nose.\u00a0</span></p>\n<p><strong>Patulous eustachian tube:\u00a0</strong><span data-preserver-spaces=\"true\">In this condition, the eustachian tube is abnormally patent. The patient\u2019s primary complaints are hearing his voice &amp; breathing sounds, which is known as autophony.\u00a0</span></p>\n<p><span data-preserver-spaces=\"true\">The most common cause is\u00a0</span><strong><span data-preserver-spaces=\"true\">idiopathic.\u00a0</span></strong><span data-preserver-spaces=\"true\">It is commonly seen after rapid weight loss. The\u00a0<strong>Ostmann fat pads</strong>\u00a0are located inferomedial to the eustachian tubes and are important in the normal closure of the Eustachian tube, preventing transmission of nasopharyngeal pressure to the middle ear. Acute and significant loss of weight leading to loss of adipocytes in the Ostmann fat pad can lead to tubal dysfunction.</span></p>\n<p><span data-preserver-spaces=\"true\">Treatment includes weight gain,\u00a0</span><strong><span data-preserver-spaces=\"true\">administration of potassium iodide solution.\u00a0</span></strong><span data-preserver-spaces=\"true\">Long-standing cases or specific treatment could include cauterization of tubes or\u00a0</span><strong><span data-preserver-spaces=\"true\">insertion of the grommet.</span></strong></p>\n<p>Other options:</p>\n<p><strong><span data-preserver-spaces=\"true\">Option A: Tubal blockage: </span></strong>C<span data-preserver-spaces=\"true\">an be acute or chronic. It can</span><span data-preserver-spaces=\"true\">\u00a0be reversed physiologically or by yawning or\u00a0</span><strong><span data-preserver-spaces=\"true\">Valsalva maneuver.\u00a0</span></strong><span data-preserver-spaces=\"true\">Symptoms include those associated with the development of negative pressure in the middle ear cavity, with sequelae being a collection of fluid and infection to hemorrhage. Other</span><span data-preserver-spaces=\"true\">\u00a0symptoms include otalgia, hearing loss,\u00a0</span><strong><span data-preserver-spaces=\"true\">popping sensations</span></strong><span data-preserver-spaces=\"true\">, rarely vertigo. It is treated by</span><span data-preserver-spaces=\"true\">\u00a0relieving the obstruction, treating the cause like infection or inflammation, and preventing or averting infection by antibiotic supplementation.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Options B </span></strong>and<strong><span data-preserver-spaces=\"true\"> D: Retracted eustachian tube/atelectasis of the tubes</span></strong><span data-preserver-spaces=\"true\">\u00a0could be due to obstruction at any path between the eustachian tube and attic.\u00a0</span><span data-preserver-spaces=\"true\">Retraction pockets could be formed which if left untreated can lead to sclerotic changes or atelectasis.\u00a0</span><span data-preserver-spaces=\"true\">Management includes surgical clearing of pockets and the establishment of ventilation. Antibiotic supplementation is a must to avoid middle ear infections.\u00a0</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0d8606716a954d3c9daa2e85bd6d3baa.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 16-year-old girl is brought to the dermatologist after developing a rash on the exposed portion of her arm, face, and back after jogging as seen in the image below. She is presently being treated for acne vulgaris. Which of the following medications used for the treatment of acne vulgaris, influenced the severity of the patient's sunburn?",
    "choices": [
      {
        "id": 1,
        "text": "Spironolactone"
      },
      {
        "id": 2,
        "text": "Doxycycline"
      },
      {
        "id": 3,
        "text": "Dapsone"
      },
      {
        "id": 4,
        "text": "Azelaic acid"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The medication used for the treatment of acne vulgaris that influenced the severity of the patient's sunburn is <strong>doxycycline</strong>.</p>\n<p>The age of the patient, physical examination and past history of\u00a0<strong>acne vulgaris</strong>\u00a0along with the image and presenting symptoms suggest a <strong>sunburn\u00a0</strong>while being on treatment for inflammatory acne vulgaris.\u00a0<strong>Doxycycline</strong>, an oral tetracycline antibiotic used in the treatment of acne vulgaris has been known to cause <strong>photosensitivity</strong>.</p>\n<p><strong>Photosensitivity</strong> refers to the appearance (or, exacerbation) of various skin\u00a0<strong>symptoms </strong>on\u00a0exposure to <strong>sunlight</strong>. Skin conditions caused by exposure to sunlight are\u00a0called <strong>photodermatoses.</strong></p>\n<p>Acne vulgaris is commonly seen in <strong>teenagers</strong> and <strong>young adults</strong>. The clinical lesions are <strong>non\u2010inflammatory open</strong> and <strong>closed comedones</strong> and/or <strong>papules, pustules, and nodules</strong> of varying degrees of inflammation and depth. The face, back, and/or chest are the most frequently affected sites. Post\u2010inflammatory macules, pigment changes, and scarring commonly occur.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bb488dd17f5140bc8fc28e4f329b36b6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young woman came with a 2-day history of dysuria and increased urinary frequency. She is sexually active and does not use condoms regularly. Examination reveals suprapubic tenderness. On antibiotic sensitivity testing, Novobiocin resistance is seen. Which of the following is the most likely cause of her symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Proteus mirabilis"
      },
      {
        "id": 2,
        "text": "Escherichia coli"
      },
      {
        "id": 3,
        "text": "Neisseria gonorrhoeae"
      },
      {
        "id": 4,
        "text": "Staphylococcus saprophyticus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span data-preserver-spaces=\"true\">The patient has signs and symptoms of&nbsp;</span><strong><span data-preserver-spaces=\"true\">UTI (cystitis)</span></strong><span data-preserver-spaces=\"true\">- dysuria, increased frequency with suprapubic tenderness. Her urine analysis shows infection with nitrite negative bacteria. T</span><span data-preserver-spaces=\"true\">he antibiotic sensitivity shows novobiocin resistance, pointing towards </span><em><strong>Staphylococcus saprophyticus</strong></em><span data-preserver-spaces=\"true\">. It is a common cause of UTI in sexually active young females.</span></p>\n<p><span data-preserver-spaces=\"true\"><em>Staphylococcus saprophyticus</em> is a coagulase-negative, novobiocin-resistant, non-hemolytic bacteria that is a normal flora of the vaginal tract. These bacteria do not convert nitrate to nitrite.</span></p>\n<p><span data-preserver-spaces=\"true\">Other options:</span></p>\n<p>Option A:<strong><span data-preserver-spaces=\"true\"> Proteus mirabilis</span></strong><span data-preserver-spaces=\"true\">&nbsp;can also cause UTI. It produces a urease enzyme that alkalizes the urine. It is not the most common cause of UTI in sexually active females.</span></p>\n<p>Option B:<strong><span data-preserver-spaces=\"true\"> E.coli-</span></strong><span data-preserver-spaces=\"true\">&nbsp;This would have been the case if the test would have shown nitrite positive. It is the most common cause of UTI in all age groups.</span></p>\n<p>Option C:<strong><span data-preserver-spaces=\"true\"> N. gonorrhoeae&nbsp;</span></strong><span data-preserver-spaces=\"true\">causes urethritis, cervicitis, and PID, but not cystitis.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/056ac445a0bc4f79b7af4002c88f1d76.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A dead body is brought in for postmortem immediately after the death. You notice that the temperature of the body remains raised for about the first two hours after death. This can occur due to all of the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Cholera"
      },
      {
        "id": 2,
        "text": "Drowning"
      },
      {
        "id": 3,
        "text": "Sunstroke"
      },
      {
        "id": 4,
        "text": "Strychnine poisoning"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The condition in which the temperature of the body remains raised for about first two hours after death is termed\u00a0<strong>postmortem caloricity.</strong>\u00a0It is not seen in cases of drowning.</p>\n<p>Strychnine poisoning, septicaemia and sunstroke lead to an increase in body temperature for the first 2 hours following death.</p>\n<p><strong>The condition occurs:</strong></p>\n<ul>\n<li>When the regulation of body temperature has been severely disturbed before death as in <strong>sunstroke, pontine haemorrhage.</strong></li>\n<li>Increased heat production in muscles due to convulsions as in <strong>tetanus</strong> and <strong>strychnine poisoning.</strong></li>\n<li>When there has been increased bacterial activity as in <strong>septicaemia, cholera.</strong></li>\n</ul>\n<p>Other options:</p>\n<p>Cooling of the body after death is termed as algor mortis. In case of drowning, cooling of the body in water will be <strong>faster</strong> because, water is a better conductor of heat. Cooling in still water is about twice as fast as in air, and in flowing water, it is about three times as fast.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a vascular phenomenon of infective endocarditis?",
    "choices": [
      {
        "id": 1,
        "text": "Janeway lesions"
      },
      {
        "id": 2,
        "text": "Osler's nodes"
      },
      {
        "id": 3,
        "text": "Roth's spots"
      },
      {
        "id": 4,
        "text": "Glomerulonephitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Janeway lesions are due to a vascular phenomenon in infective endocarditis.</p>\n<p>Janeway lesions are\u00a0<strong>non-tender</strong>, erythematous, or hemorrhagic macular or nodular lesions, which are present on the palms or soles. They are vascular lesions caused due to deposition of septic emboli in the dermis.\u00a0</p>\n<p>Other vascular manifestations of\u00a0 include:</p>\n<ul>\n<li>Septic pulmonary infarcts</li>\n<li>Mycotic aneurysm</li>\n<li>Splinter hemorrhages</li>\n<li>Conjunctival hemorrhages</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/40ddadaeb161498b89f3a01c423def29x600x468.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f11acc3d111e42bba2edd1b08ae6143cx768x1024.JPEG"
    ]
  },
  {
    "text": "You have been invited to a child's birthday party. On reaching his home, you notice him ride a tricycle to the stairs and then get off, climb the stairs with alternate feet to reach his room. He has built a tower of 9 blocks in his room and is able to copy a circle using the glitter pens you gifted him. What is the likely age that these milestones correspond to?",
    "choices": [
      {
        "id": 1,
        "text": "12 months"
      },
      {
        "id": 2,
        "text": "18 months"
      },
      {
        "id": 3,
        "text": "2 years"
      },
      {
        "id": 4,
        "text": "3 years"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>These milestones correspond to an age of <strong>3 years</strong>.</p>\n<p>The <strong>milestones attained</strong> by a child at age 3 are:</p>\n<ul>\n<li><strong>Gross</strong> motor development:\u00a0Can ride a tricycle and walk up the stairs with alternate feet</li>\n<li><strong>Fine</strong> motor development:\u00a0Can build a tower of 9 blocks and can copy a circle</li>\n<li><strong>Social</strong> and <strong>adaptive</strong>:\u00a0Shares toys, begins to count, can identify 1-2 colors\u00a0</li>\n<li><strong>Language</strong>: Continually asks questions, knows full name</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young patient who suffered a large wound due to a road traffic accident was referred to you after initial wound management. As a plastic surgeon, you decide to cover the wound with the following type of graft. Which of the following is not a feature of the graft used by the plastic surgeon?",
    "choices": [
      {
        "id": 1,
        "text": "It is also known as Thiersch graft"
      },
      {
        "id": 2,
        "text": "Harvested using dermatome knife"
      },
      {
        "id": 3,
        "text": "Only dressing is enough at donor site"
      },
      {
        "id": 4,
        "text": "This graft has the best cosmetic appearance"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span data-preserver-spaces=\"true\">The given image shows the procedure of obtaining a&nbsp;</span><strong><span data-preserver-spaces=\"true\">split-thickness skin graft</span></strong><span data-preserver-spaces=\"true\">&nbsp;using a handheld&nbsp;</span><strong><span data-preserver-spaces=\"true\">Humby knife.</span></strong><span data-preserver-spaces=\"true\">&nbsp;The <strong>best&nbsp;cosmetic appearance&nbsp;</strong>is generally seen with&nbsp;<strong>full-thickness skin grafts.&nbsp;</strong></span></p>\n<p>The most preferable donor site is buttock in cosmetically sensitive individuals and children. The most commonly used donor site is the <strong>thigh.</strong></p>\n<ul>\n<li>The graft is taken from the donor site with a handheld <strong>Humby knife</strong> or <strong>dermatome knife.</strong></li>\n<li>Grafts are perforated to allow exudates to escape and improve &lsquo;take&rsquo;. It can further be meshed to allow expansion.</li>\n<li>Grafts will take up only on the beds which are vascularized, hence preparation of wound bed is an essential step.</li>\n<li>Skin grafts are completely dependent on nutrition on the tissue over which they are placed and can heal well over muscle, perichondrium, and periosteum. They do not take well over bone or cartilage or on tissue that has been irradiated or infected or is hypovascular.</li>\n<li>A clean healthy wound bed with a meshed graft tied in place to stop movement will encourage take.</li>\n<li>The presence of <strong>group A beta-hemolytic streptococci</strong> is a <strong>contraindication</strong> in grafting as it can destroy split grafts completely and also convert donors to full-thickness defects.</li>\n<li>The donor area is dressed appropriately and the dressing is opened after 10 days and not earlier.&nbsp;</li>\n</ul>\n<p>The given image shows<strong> Humby's knife.&nbsp;</strong>The average thickness of the graft obtained from a Humbys knife is 0.3 mm.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/696b040d936247be9547bc7763100603.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4d22782707b045fbbe58e6588fdd19dax720x710.PNG"
    ]
  }
];
        let quizName = 'Mini Test 22';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>