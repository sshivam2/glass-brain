<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 23 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which among the following has been marked with the correct types of joints?",
    "choices": [
      {
        "id": 1,
        "text": "1-Primary cartilaginous joint, 2-Fibrous joint, 3-Synovial joint"
      },
      {
        "id": 2,
        "text": "1-Fibrous joint, 2-Primary cartilaginous joint, 3-Synovial joint"
      },
      {
        "id": 3,
        "text": "1-Secondary cartilaginous joint, 2-Fibrous joint, 3-Synovial joint"
      },
      {
        "id": 4,
        "text": "1-Fibrous joint, 2-Secondary cartilaginous joint, 3-Synovial joint"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct answer is option C.</p>\n<p><strong>1- Intervertebral joint- Secondary cartilaginous joint</strong></p>\n<p><strong>2- Suture- Fibrous joint</strong></p>\n<p><strong>3- Knee joint- Synovial joint</strong></p>\n<p>Structurally, joints are classified as fibrous joints, cartilaginous joints, and synovial joints.&nbsp;</p>\n<table style=\"width: 365px;\">\n<tbody>\n<tr>\n<td style=\"text-align: center; width: 349px;\" colspan=\"2\"><strong>Structural classification of joints</strong></td>\n</tr>\n<tr>\n<td style=\"text-align: center; width: 117px;\"><strong>Type&nbsp;</strong></td>\n<td style=\"text-align: center; width: 232px;\"><strong>Subtypes</strong></td>\n</tr>\n<tr>\n<td style=\"width: 117px;\"><strong>Fibrous joints</strong></td>\n<td style=\"width: 232px;\">\n<ul>\n<li>Sutures</li>\n<li>Syndesmosis</li>\n<li>Gomphosis</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 117px;\"><strong>Cartilaginous joints</strong></td>\n<td style=\"width: 232px;\">\n<ul>\n<li>Primary cartilaginous (synchondrosis)</li>\n<li>Secondary cartilaginous (symphysis)</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 117px;\"><strong>Synovial joints</strong></td>\n<td style=\"width: 232px;\">\n<ul>\n<li>Ball-and-socket or spheroidal joints</li>\n<li>Sellar or saddle joints</li>\n<li>Condylar or bicondylar joints</li>\n<li>Ellipsoid joints</li>\n<li>Hinge joints</li>\n<li>Pivot or trochoid joints</li>\n<li>Plane joints</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>The types of <strong>fibrous</strong> joints- sutures (a), syndesmosis (b), and gomphosis (c) are shown in the image below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0e17fee418144947bfc29d1174148f8a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/273d586c0ff54eb598d48532a4b78023x1280x562.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/694ace51789844c8b63461e09a430219x800x379.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/96b67cef1df94542b66f8215b99ed86bx503x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fbfdf2ebfc37443da392f520f8c66bfdx1280x3510.289343683839.JPEG"
    ]
  },
  {
    "text": "You are monitoring a 45-year-old female patient in the postoperative ward. Her 24-hour urine output is 1.5 mL/min, serum creatinine is 1.0 mg/dL, and urine creatinine is 60 mg/dL. What is the patient's creatinine clearance rate?",
    "choices": [
      {
        "id": 1,
        "text": "30 mL/min"
      },
      {
        "id": 2,
        "text": "60 mL/min"
      },
      {
        "id": 3,
        "text": "90 mL/min"
      },
      {
        "id": 4,
        "text": "120 mL/min"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The creatinine clearance in this patient is <strong>90 mL/min.</strong></p>\n<p><strong>Creatinine clearance&nbsp;</strong>is defined as the volume of plasma from which creatinine is completely removed by the kidney in a given amount of time (usually minutes).</p>\n<p>The formula used to calculate creatinine clearance (C<sub>Cr</sub>) is:</p>\n<p><strong>&nbsp;U<sub>Cr</sub> &times; V &frasl; P</strong><sub><strong>Cr&nbsp;</strong>&nbsp;</sub>where,</p>\n<p>U<sub>Cr </sub>-&nbsp;Urine creatinine (mg/dL)</p>\n<p>P<sub>Cr </sub>-&nbsp;Serum creatinine (mg/dL)</p>\n<p>V - Urine volume (mL/min)</p>\n<p><strong>Note</strong>: The creatinine clearance is usually expressed in mL/min; hence, the preferred unit of urine volume is mL/min, which is calculated based on the 24-hour urine volume. While calculating, ensure that both the urine creatinine and serum creatinine have the same units (either mg/dL or mg/mL).</p>\n<p>In the given question,</p>\n<p>U<sub>Cr </sub>= 60 mg/dL</p>\n<p>P<sub>Cr </sub>= 1.0 mg/dL</p>\n<p>V &nbsp;= 1.5 mL/min</p>\n<p>Substituting the values given in the question, we get:</p>\n<p>Creatinine clearance =&nbsp;&nbsp;U<sub>Cr</sub> &times; V &frasl; P<sub>Cr ,</sub></p>\n<p>= (60 x 1.5)/1</p>\n<p>= 60 x 1.5</p>\n<p><strong>= 90 mL/min</strong></p>\n<p><strong>Creatinine</strong> is a <strong>by-product of muscle metabolism</strong> and is <strong>cleared</strong> from the body fluids almost entirely by <strong>glomerular filtration</strong>. Therefore, the clearance of creatinine is used to <strong>assess GFR</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old male child has delayed developmental milestones and intellectual disability, with the following appearance (image A). On further examination, there is an enlarged tongue, cloudy cornea, and hepatomegaly. A radiograph of the hand is shown in image B. A girl born in their family also had similar symptoms and she died at 9 years of age. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Scheie syndrome"
      },
      {
        "id": 2,
        "text": "Hurler-Scheie syndrome"
      },
      {
        "id": 3,
        "text": "Hurler syndrome"
      },
      {
        "id": 4,
        "text": "Hunter syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis is <strong>Hurler syndrome.\u00a0</strong>The child is <strong>2 years</strong> of age and has <strong>coarse facial features</strong> like a depressed nasal bridge, thick lips, and an open mouth with protruded tongue. The radiograph shows <strong>enlarged diaphyses</strong> of the metacarpals and phalanges. These features along with severe <strong>developmental delay</strong>, <strong>cloudy cornea</strong>, hepatomegaly, and<strong>\u00a0intellectual\u00a0disability</strong> suggest that the child has Hurler syndrome.</p>\n<p>It is a <strong>severe</strong> type of mucopolysaccharidoses <strong>(MPS) I</strong>. It is caused due to deficiency of\u00a0<strong>\u03b1-L-iduronidase. </strong>This enzyme is required for the breakdown of dermatan and heparan sulfate. The deficiency of the enzyme leads to the accumulation of these mucopolysaccharides.\u00a0</p>\n<p>Patients usually present between <strong>6-24 months</strong> of age. They have</p>\n<ul>\n<li><strong>Intellectual disability</strong></li>\n<li><strong>Skeletal dysplasia,</strong>\u00a0called dysostosis multiplex- thick ribs, ovoid vertebral bodies,<strong> enlarged diaphyses</strong> of the long bones, macrocephaly, enlarged <strong>J-shaped sella</strong></li>\n<li><strong>Cloudy cornea</strong>, glaucoma, retinal degeneration</li>\n<li>Mixed hearing loss, etc</li>\n</ul>\n<p>Other options</p>\n<p>Option A- The <strong>Scheie syndrome</strong>\u00a0is a milder form of MPS-I (MPS I-S ). The symptoms appear <strong>after 5 years</strong> of age and the diagnosis is made between 10-20 years. It is characterized by <strong>normal intelligence</strong> and stature, joint stiffness, aortic valve disease, corneal clouding, and mild dysostosis multiplex. Ophthalmic and cardiac involvement might be present.</p>\n<p>Option\u00a0B- <strong>Hurler-Scheie syndrome</strong> is an intermediate between Hurler syndrome and\u00a0Scheie syndrome. The onset of symptoms is between <strong>3-8 years of</strong> age. They have <strong>mild</strong> or <strong>no intellectual dysfunction</strong>.\u00a0Ophthalmic and cardiac involvement might be present.</p>\n<p>Option D- <strong>Hunter syndrome</strong> is a <strong>type II MPS.\u00a0</strong>It occurs due to the deficiency of <strong>iduronate 2-sulfatase.\u00a0</strong>It shares the same features as type I MPS like coarse facial features, short stature, and dysostosis multiplex. However, there is <strong>no corneal clouding.\u00a0</strong>It is the only MPS with <strong>X-linked recessive</strong> inheritance. So if a\u00a0baby girl is affected in the family, it is less likely to be Hunter syndrome. All the other MPS are autosomal recessive.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/706b53faa52e4639a902467c9428a45c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not true regarding necroptosis?",
    "choices": [
      {
        "id": 1,
        "text": "Kinases like RIP1 and RIP3 are involved"
      },
      {
        "id": 2,
        "text": "It causes caspase-independent programmed cell death"
      },
      {
        "id": 3,
        "text": "Cytokine IL-1 plays an important role in the process"
      },
      {
        "id": 4,
        "text": "Necroptosis starts by ligation of TNFR1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The fever-inducing <strong>cytokine IL-1</strong> plays an important role in <strong>pyroptosis</strong> and <strong>not necroptosis</strong>.\u00a0</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Necroptosis,</span></strong><span data-preserver-spaces=\"true\">\u00a0also known as\u00a0</span><strong><span data-preserver-spaces=\"true\">programmed necrosis,</span></strong><span data-preserver-spaces=\"true\">\u00a0is programmed cell death <strong>without caspase activation</strong>. It shares features of <strong>both necrosis</strong> and <strong>apoptosis</strong>.</span></p>\n<p><span data-preserver-spaces=\"true\">It resembles <strong>necrosis</strong> because of the following features:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">loss of ATP</span></li>\n<li><span data-preserver-spaces=\"true\">swelling of the cell and organelles</span></li>\n<li><span data-preserver-spaces=\"true\">generation of reactive oxygen species (ROS)</span></li>\n<li><span data-preserver-spaces=\"true\">release of lysosomal enzymes</span></li>\n<li><span data-preserver-spaces=\"true\">rupture of the plasma membrane</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">It is triggered by genetically programmed signal transduction events that lead to cell death. This <strong>resembles programmed cell death</strong>, which is considered the hallmark of <strong>apoptosis</strong>. Hence, <strong>necroptosis</strong> is also called\u00a0</span><strong><span data-preserver-spaces=\"true\">programmed necrosis</span></strong><span data-preserver-spaces=\"true\">.</span></p>\n<p><span data-preserver-spaces=\"true\">Necroptosis does not result in caspase activation, and hence, it is also called <strong>\u201ccaspase-independent\u201d programmed</strong> cell death (option B). </span><span data-preserver-spaces=\"true\">The process <strong>starts</strong> with the <strong>ligation</strong> of <strong>TNFR1 </strong>(option D). Ligation of TNFR1 recruits two kinases called <strong>receptor-associated kinases 1</strong> and <strong>3</strong> (<strong>RIP1</strong> &amp;\u00a0<strong>RIP3</strong>) (option A).</span></p>\n<p><span data-preserver-spaces=\"true\">Necroptosis begins similarly to the extrinsic pathway of apoptosis, i.e., by <strong>receptor-ligand interaction</strong>. The most well-studied is the <strong>TNF-TNFR mediated pathway</strong>. The pathway is demonstrated below:</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7bd19a2667df4488b843f5ea4e043eb4x1280x3312.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c491a77a04e0405ab06fc33c6ec66ccbx680x599.PNG"
    ]
  },
  {
    "text": "A 44-year-old HIV patient presents with a non-productive cough and progressively worsening breathing difficulty. Chest x-ray shows diffuse bilateral interstitial infiltrates along with a pneumatocele. Microscopic examination of the bronchoalveolar lavage shows the following. What is the special stain used in this scenario?",
    "choices": [
      {
        "id": 1,
        "text": "Methenamine silver stain"
      },
      {
        "id": 2,
        "text": "Fontana-Masson stain"
      },
      {
        "id": 3,
        "text": "Malachite green stain"
      },
      {
        "id": 4,
        "text": "Periodic acid-Schiff stain"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical picture and the staining showing the black-colored stained cysts, resembling the\u00a0crushed ping pong balls, are suggestive of\u00a0<strong><em>Pneumocystis</em> pneumonia (PCP). </strong>It is caused by <strong><em>Pneumocystis jirovecii</em>.\u00a0</strong>The stain used for staining the causative organism is\u00a0<strong>Gomori\u2019s methenamine silver stain</strong>.</p>\n<p>Patients with PCP generally present with fever and cough that is usually non-productive. Finding on chest x-ray is either a normal film if the disease is suspected early, or diffuse<strong>\u00a0</strong>bilateral interstitial infiltrates. The classic finding of<strong>\u00a0</strong>dense perihilar infiltrate is unusual in patients with AIDS.</p>\n<p>Treatment:\u00a0Trimethoprim-sulfamethoxazole\u00a0and pentamidine isethionate</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/106db2c331f04be0b855581104ede6e4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 23-year-old woman presents to the emergency department with seizures. Her parents said this started 15 minutes back and has been continuous. Initial resuscitative measures are taken, and she is given lorazepam. However, her seizures didn\u2019t subside. Which antiepileptic drug is indicated now?",
    "choices": [
      {
        "id": 1,
        "text": "Propofol"
      },
      {
        "id": 2,
        "text": "Phenytoin"
      },
      {
        "id": 3,
        "text": "Phenobarbitone"
      },
      {
        "id": 4,
        "text": "Pregabalin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with seizures for more than 15 minutes has <strong>status epilepticus</strong>. The treatment algorithm is shown below. According to this, this patient, who did not respond to lorazepam needs <strong>phenytoin</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/81d205dd33f04901917d81c2572feff6x303x519.PNG"
    ]
  },
  {
    "text": "A police sub-inspector brings the accused in a rape case to a doctor and requests a medical examination. He believes that examination findings would yield evidence to prove the offense allegedly committed. However, the accused is not cooperative. What is the next course of action by the doctor?",
    "choices": [
      {
        "id": 1,
        "text": "Request police officer for a court order"
      },
      {
        "id": 2,
        "text": "Refuse to carry out medical examination without consent"
      },
      {
        "id": 3,
        "text": "Perform medical examination by force"
      },
      {
        "id": 4,
        "text": "Wait until the accused gives consent"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The next course of action by the doctor is to perform the <strong>medical examination</strong> by <strong>force</strong>.&nbsp;</p>\n<p><strong>Section 53 CrPC</strong> deals with the examination of the&nbsp;<strong>accused</strong> by a doctor using force, in the event that the examination has been requested by a police officer (designation of Sub-Inspector and above). The intention behind such a request must be to procure evidence regarding the offense allegedly committed by the accused <strong>[Sec. 53 (1) CrPC].&nbsp;</strong>If the person is accused of rape, a medical examination may be carried out by force (in the event of non-cooperation) by the provisions made by&nbsp;<strong>Sec. 53A CrPC.</strong></p>\n<p>Whenever the person of a female is examined, the medical examination must be carried out only by, or under the <strong>direct supervision</strong> of a <strong>female doctor</strong>&nbsp;<strong>[Sec. 53 (2) CrPC].</strong></p>\n<p>Such an examination is applicable to the testing of blood, blood stains, semen, swabs, sputum, hair samples, and fingernail clippings.&nbsp;</p>\n<p><strong>Other options:</strong></p>\n<p>Consent is mandatory for the examination of a <strong>victim</strong> in criminal cases. Performing an examination by force or by availing of a court order is not allowed for the examination of a victim.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following are the objective tests for the hearing?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, and 4"
      },
      {
        "id": 2,
        "text": "1, 2, and 3"
      },
      {
        "id": 3,
        "text": "2, 3, and 4"
      },
      {
        "id": 4,
        "text": "1, 2, 3, and 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Brainstem-evoked response audiometry</strong> (BERA), <strong>otoacoustic emissions</strong>&nbsp;(OAE), and <strong>tympanometry</strong>&nbsp;are&nbsp;<strong>objective</strong> <strong>tests</strong> for hearing.&nbsp;</p>\n<p>The<strong>&nbsp;objective tests</strong> of hearing are:</p>\n<div class=\"page\" title=\"Page 148\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Evoked response audiometry\n<ul>\n<li>Electrocochleography</li>\n<li>Auditory brainstem response</li>\n</ul>\n</li>\n<li>Otoacoustic emissions</li>\n<li>Impedance audiometry\n<ul>\n<li>Tympanometry</li>\n<li>Acoustic reflex measurements</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<p><strong>Brainstem-evoked response audiometry (BERA)</strong>&nbsp;or <strong>Auditory brainstem response</strong> (ABR) is an<strong>&nbsp;objective test&nbsp;</strong>that<strong>&nbsp;r</strong><strong>ecords electrical activity&nbsp;</strong>occurring in the auditory pathway. It elicits <strong>brainstem responses</strong> to auditory stimulation. Click stimuli or tone bursts lead to the generation of electrical potentials which are picked up from <strong>surface electrodes</strong> on the <strong>vertex</strong>.</p>\n<div class=\"page\" title=\"Page 44\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Otoacoustic emissions</strong> (OAEs) refer to an&nbsp;<strong>objective test</strong>&nbsp;that records the low-intensity&nbsp;sounds produced by<strong>&nbsp;</strong>the<strong> outer hair cells </strong>of a <strong>normal cochlea.&nbsp;</strong>It can be&nbsp;elicited by a microphone in the external auditory canal and is then analyzed by a computer. They test the <strong>function of the cochlea</strong>.&nbsp;They are used to test hearing in neonates, and sedated/unconscious patients, and to differentiate cochlear from retro-cochlear hearing loss.&nbsp;</p>\n</div>\n</div>\n</div>\n<p><strong>Tympanometry</strong> is a component of impedance audiometry. It is an&nbsp;<strong>objective test&nbsp;</strong>of the<strong> middle ear and eustachian tube functions</strong>&nbsp;(conductive compartment of hearing). Here, the compliance of the tympanic membrane, i.e., how much it moves to the pressure differentials applied from the external ear is measured. This is plotted on a graph, to obtain a tympanogram.&nbsp;</p>\n<p>Note-<strong> Pure</strong> <strong>tone audiometry</strong> is a <strong>subjective test</strong> for hearing as it <strong>relies on the patient's</strong> responses to&nbsp;<strong>pure tone</strong>&nbsp;stimuli. Other examples of subjective tests include:</p>\n<ul>\n<li>Tuning fork tests</li>\n<li>Speech audiometry</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old man presents with a wrist drop, severe colicky abdominal pain, and constipation. His peripheral smear is shown below. Which of the following is the commonest mode of occupational exposure to the compound responsible?",
    "choices": [
      {
        "id": 1,
        "text": "Ingestion"
      },
      {
        "id": 2,
        "text": "Direct contact on skin"
      },
      {
        "id": 3,
        "text": "Inhalation"
      },
      {
        "id": 4,
        "text": "Inoculation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical background and the image showing<strong>&nbsp;basophilic stippling</strong> are suggestive of <strong>lead poisoning.&nbsp;</strong><strong>Inhalation</strong> is the <strong>most common route of occupational</strong> <strong>exposure</strong> to lead.</p>\n<p>Lead poisoning may occur by:</p>\n<ul>\n<li><strong>Inhalation</strong> of fumes and dust of lead</li>\n<li><strong>Ingestion</strong> via contaminated hands or when small amounts of lead trapped in the upper respiratory tract are swallowed.</li>\n<li><strong>Absorption</strong> through the <strong>skin</strong></li>\n</ul>\n<p>Painters exposed to lead-based paints usually develop plumbism (lead poisoning). The clinical features of lead poisoning include abdominal colic, constipation, loss of appetite, a <strong>blue line</strong> on the gums (Burtonian line), <strong>basophilic stippling</strong> of red cells, anemia, <strong>wrist</strong> <strong>drop</strong>, and foot drop. CNS symptoms like insomnia, headache, mental confusion, delirium, may also be seen.</p>\n<p>Coproporphyrin levels in urine (CPU) are useful in screening. Measurement of blood and urine lead levels should be done for diagnosis.</p>\n<div class=\"page\" title=\"Page 3344\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Chelation with oral DMSA, calcium EDTA, and dimercaprol are treatment modalities. Correction of iron, calcium, zinc, and calcium deficiencies should be done. Vitamin C is a weak chelating agent.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/36d413a92ebd4ecd99d08b4a58aa259f.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient has recurrent optic neuritis of both eyes with extensive transverse myelitis. Visual acuity in the right eye is 6/60 and visual acuity in the left eye 6/18. The patient showed a partial response to steroids. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Acute disseminated encephalomyelitis"
      },
      {
        "id": 2,
        "text": "Devic's disease"
      },
      {
        "id": 3,
        "text": "Riddoch syndrome"
      },
      {
        "id": 4,
        "text": "Acute fulminant multiple sclerosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of <strong>neuromyelitis optica</strong>, which is also known as <strong>Devic's disease</strong>.</p>\n<p>It is an aggressive inflammatory demyelinating disorder characterized by recurrent attacks of<strong> optic neuritis</strong> and <strong>myelitis.&nbsp;</strong>Attacks of Optic neuritis can be bilateral or unilateral and myelitis can be severe and&nbsp;involve three or more contiguous vertebral segments.</p>\n<p><strong>Core clinical characteristics are:</strong></p>\n<ul>\n<li class=\"p3\">Optic neuritis</li>\n<li class=\"p3\">Acute myelitis</li>\n<li class=\"p3\">Area postrema syndrome: episodes of otherwise unexplained hiccups or nausea or vomiting</li>\n<li class=\"p3\">Acute brainstem syndrome</li>\n<li class=\"p3\">Symptomatic narcolepsy or acute diencephalic clinical syndrome with NMOSD*-typical diencephalic MRI lesions</li>\n<li class=\"p3\">Symptomatic cerebral syndrome with NMOSD*-typical brain lesions</li>\n</ul>\n<p>Option A: Acute Disseminated Encephalomyelitis&nbsp;(ADEM) is a demyelinating condition most frequently associated with an antecedent infection</p>\n<div class=\"page\" title=\"Page 3590\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 3590\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option C: Riddoch syndrome is the ability to consciously perceive the stimulus in a blind field. It is seen when there is a lesion in the occipital lobe.</p>\n<p>Option D: Acute fulminant multiple sclerosis is an&nbsp;acute episode of&nbsp;multiple sclerosis, known as Marburg&rsquo;s variant</p>\n<p>*NMOSD stands for&nbsp;neuromyelitis optica spectrum disorder.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the instrument shown below that is used to create a pneumoperitoneum ?",
    "choices": [
      {
        "id": 1,
        "text": "Veress needle"
      },
      {
        "id": 2,
        "text": "Salah's needle"
      },
      {
        "id": 3,
        "text": "Hasson Trocar"
      },
      {
        "id": 4,
        "text": "Von Graefe needle"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image showing a long, slender laparoscopic instrument is <strong>Veress</strong> <strong>Needle</strong>. It is used in <strong>direct puncture laparoscopy</strong> to produce a <strong>pneumoperitoneum</strong>.</p>\n<p><strong>Direct</strong> puncture laparoscopy (closed method):</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The abdominal wall is grasped with towel clips or fingers to elevate the abdominal wall away from the underlying structures.&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">A small incision is made in the umbilicus and the Veress needle is introduced into the abdomen. Two distinct pops can be felt as the needle pierces the abdominal wall fascia and the peritoneum.</li>\n</ol>\n<p>The <strong>umbilicus</strong> is the <strong>preferred</strong> location for introducing a Vereess needle because the abdominal wall is <strong>thin</strong> at this location.</p>\n<p>Carbon dioxide<strong> (CO<sub>2</sub>)</strong> gas is usually used and the maximum pressure is in the range of <strong>14-15 mmHg</strong>. But N<sub>2</sub>O is used if the procedure is done under local anesthesia. Insufflation with N<sub>2</sub>O is stopped at a pressure of 10 mmHg or when 2L of gas is insufflated.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3d015fa229ba49698cced76cfbc8cbf4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1dc4dcf008464391af178e36afae9445x616x301.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/61c45f7654ac41b682c79029bba3c77cx500x500.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea25b6ec1e494a2bb42baf99b3a29bfdx1279x735.JPEG"
    ]
  },
  {
    "text": "A 20-year old female patient presented with painless lesions on the vulva as shown in the image below. Which of the following vaccines is not protective against this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Gardasil"
      },
      {
        "id": 2,
        "text": "Cervarix"
      },
      {
        "id": 3,
        "text": "Gardasil-9"
      },
      {
        "id": 4,
        "text": "Quadrivalent HPV vaccine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The condition in the image is <strong>condyloma acuminata (venereal warts)</strong> caused by infection with human papilloma virus <strong>6 or 11.</strong> The Cervarix vaccine does not protect against it. <strong>Cervarix</strong> offers protection against HPV subtypes <strong>16,18</strong>, which cause CIN and Ca cervix.</p>\n<p>The image shows <strong>multiple warty growths </strong>on the vulva and around the anal canal, as seen in condyloma acuminata<strong>.</strong> The verrucous growths may appear discrete or coalesce to form large <strong>cauliflower-like </strong>growths. They may be asymptomatic but can also cause discomfort, discharge, or bleeding. Treatment may include <strong>ablation</strong>, <strong>excision</strong>, or <strong>topical agents</strong> such as podophyllin and imiquimod.</p>\n<p>The available vaccinations against HPV are summarized below.</p>\n<table style=\"height: 483px; width: 515.165px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 102px;\"><strong>Brand name</strong></td>\n<td style=\"width: 92px;\"><strong>Cervarix</strong></td>\n<td style=\"width: 133px;\"><strong>Gardasil</strong></td>\n<td style=\"width: 139.165px;\"><strong>Gardasil-9</strong></td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Characteristic and HPV subtypes</td>\n<td style=\"width: 92px;\">Bivalent:16,18</td>\n<td style=\"width: 133px;\">Quadrivalent: <strong>6,11,</strong>16,18</td>\n<td style=\"width: 139.165px;\">Nonavalent: <strong>6,11</strong>,16,18,31,33,45,52,58</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Protects against:</td>\n<td style=\"width: 92px;\">CIN, Ca cervix</td>\n<td style=\"width: 133px;\">Anogenital warts, CIN, Ca cervix</td>\n<td style=\"width: 139.165px;\">Anogenital warts, CIN, CA cervix,\u00a0 Vulval intraepithelial neoplasia, Vaginal intraepithelial neoplasia</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Dose</td>\n<td style=\"width: 92px;\">0.5ml\u00a0</td>\n<td style=\"width: 133px;\">0.5ml</td>\n<td style=\"width: 139.165px;\">0.5ml</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Administration</td>\n<td style=\"width: 92px;\">0, 1, 6 months i.m</td>\n<td style=\"width: 133px;\">0, 2, 6 months i.m</td>\n<td style=\"width: 139.165px;\">0, 2, 6months, i.m</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Administered gender</td>\n<td style=\"width: 92px;\">Female and male</td>\n<td style=\"width: 133px;\">Female and male</td>\n<td style=\"width: 139.165px;\">Female and male</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Ideal Age range:</td>\n<td style=\"width: 92px;\">11-12 years,9-26 years\u00a0</td>\n<td style=\"width: 133px;\">11-12 years, 9-26 years for both male and female</td>\n<td style=\"width: 139.165px;\">\n<p>Females:11-12 years, 9-26 years</p>\n<p>Males:11-12 years</p>\n<p>9-15 years - FDA approved</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Gardasil 9</strong> has received expanded indication, which now includes the <strong>prevention of oropharyngeal</strong> and other <strong>head and neck cancers</strong> caused by HPV types 16,18,31,33,45,52,58.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5f392e1762c142ffb4f23324c1097a74.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A senior pediatric resident uses Silverman Anderson scoring system to assess respiratory distress in newborns. Which of the following components is given a score of 1?",
    "choices": [
      {
        "id": 1,
        "text": "Expiratory grunting audible without stethoscope"
      },
      {
        "id": 2,
        "text": "Markedly visible xiphoid retraction"
      },
      {
        "id": 3,
        "text": "Absence of nasal flaring"
      },
      {
        "id": 4,
        "text": "Upper chest movement showing inspiratory lag"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>According to <strong>Silverman Anderson's score</strong>, <strong>upper chest movement</strong> showing <strong>inspiratory lag</strong> is given a score of <strong>1</strong>.\u00a0</p>\n<p>Expiratory <strong>grunting</strong> that is audible <strong>without a stethoscope</strong> and <strong>markedly visible xiphoid retractions</strong> are given a score of <strong>2.</strong>\u00a0An <strong>absence</strong> of nasal <strong>flaring</strong> would be given a score of <strong>0</strong>.</p>\n<p>Silverman Anderson's score is used to assess the severity of respiratory distress in neonates.\u00a0Components of this scoring system include:</p>\n<table style=\"width: 398px; height: 541px;\">\n<tbody>\n<tr>\n<td style=\"width: 102px;\"><strong>\u00a0 \u00a0 Score</strong></td>\n<td style=\"width: 99px;\"><strong>\u00a0 \u00a00</strong></td>\n<td style=\"width: 90px;\"><strong>\u00a0 \u00a0 \u00a01</strong></td>\n<td style=\"width: 79px;\"><strong>\u00a0 \u00a0 \u00a0 2</strong></td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">\n<p><strong>1. Upper chest retraction</strong></p>\n<p><strong>(Chest movement)</strong></p>\n</td>\n<td style=\"width: 99px;\">Synchronized</td>\n<td style=\"width: 90px;\"><strong>Lag on inspiration</strong></td>\n<td style=\"width: 79px;\">See-saw</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">\n<p><strong>2. Lower chest retraction</strong></p>\n<p><strong>(Intercostal retraction)</strong></p>\n</td>\n<td style=\"width: 99px;\">None</td>\n<td style=\"width: 90px;\">Just visible</td>\n<td style=\"width: 79px;\">Marked</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\"><strong>3. Xiphoid \u00a0 \u00a0retraction</strong></td>\n<td style=\"width: 99px;\">None</td>\n<td style=\"width: 90px;\">Just visible</td>\n<td style=\"width: 79px;\">Marked</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\"><strong>4. Nasal flaring</strong></td>\n<td style=\"width: 99px;\">None</td>\n<td style=\"width: 90px;\">Minimal</td>\n<td style=\"width: 79px;\">Marked</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\"><strong>5. Grunt</strong></td>\n<td style=\"width: 99px;\">Not audible</td>\n<td style=\"width: 90px;\">Audible with Stethoscope</td>\n<td style=\"width: 79px;\">Audible with naked ear</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p>The Silverman Anderson Retraction Score is more suited for <strong>preterms</strong>, however, the <strong>Downes\u2019 Score\u00a0</strong>can be applied to any gestational age and condition. Components of Downes' score are respiratory rate, cyanosis, air entry, grunt, and retractions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e3689d2f53cf4f4d8e2697c90c24b9c4x1280x1839.JPEG"
    ]
  },
  {
    "text": "A 15-year-old child presents with hair loss. The pattern of hair loss is shown in the image below. The hair pull test is negative in other sites. Physical examination also shows cervical lymphadenopathy. Which of the following is the best treatment for this patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Intralesional glucocorticoid"
      },
      {
        "id": 2,
        "text": "Oral itraconazole"
      },
      {
        "id": 3,
        "text": "Observation"
      },
      {
        "id": 4,
        "text": "Topical minoxidil"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows alopecia with <strong>multiple black dots </strong>which is suggestive <strong>of tinea capitis</strong>. It has to be treated with <strong>oral itraconazole.</strong></p>\n<p>Tinea capitis is a dermatophyte infection primarily occurring in children. Clinical features of tinea capitis are patchy hair loss, scaling, tender lymphadenopathy, and in severe cases, there might be pustules and crusting of the affected area.</p>\n<p>The clinical variants of tinea capitis are:</p>\n<ul>\n<li><strong>Endothrix</strong> - a non-inflammatory type in which <strong>multiple black dots</strong>\u00a0are present within the areas of alopecia. It is most commonly caused by <strong>T. tonsurans\u00a0and T. violaceum.</strong></li>\n<li><strong>Ectothrix</strong> -\u00a0a mild inflammatory type in which single or multiple scaly patches with hair loss are seen.</li>\n<li><strong>Kerion</strong>\u00a0- a severe inflammatory type that presents with an inflammatory mass with <strong>thick crusting</strong> and <strong>matting of hair</strong> with pus and sinus formation.</li>\n<li><strong>Favus</strong> -\u00a0is characterized by the presence of yellowish, cup\u2010shaped crusts known as <strong>scutula</strong> that develop around hair follicles.</li>\n</ul>\n<p>Other options -\u00a0</p>\n<p>Option A and C\u00a0 - Intralesional glucocorticoid and observation are applicable for <strong>alopecia aerata. </strong>It presents with <strong>patchy hair loss</strong>\u00a0and the <strong>hair pull test is positive</strong>. Observation is also be applicable for <strong>telogen effluvium</strong>\u00a0where again there is <strong>diffuse</strong> hair <strong>thinning </strong>and<strong> positive hair pull test</strong><strong>.\u00a0</strong>Both these conditions do not present with lymphadenopathy.</p>\n<p>Option D - Minoxidil is used for the treatment of <strong>androgenic alopecia</strong> which presents with hair loss on the <strong>vertex </strong>and<strong> central region</strong>. Additionally, it is unlikely to present at such a young age or with lymphadenopathy.</p>\n<p>Below is an image of endothrix variant -\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5f1257fba75145839d0272b979a25863.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/81c7217a890b433b8a0966ee37b520b6x720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/84c7c1b0ed824ec6bda894a8827d3284x512x358.PNG"
    ]
  },
  {
    "text": "The maximum oxygen delivered by a nasal cannula is?",
    "choices": [
      {
        "id": 1,
        "text": "20%"
      },
      {
        "id": 2,
        "text": "60%"
      },
      {
        "id": 3,
        "text": "40%"
      },
      {
        "id": 4,
        "text": "100%"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The maximum oxygen delivered by a nasal cannula is 40%.</p>\n<p><strong>The nasal cannula </strong>is a<strong> low flow variable</strong> <strong>performance</strong> oxygen delivery system that can provide a maximum inspired oxygen concentration of <strong>40%</strong> at flow rates greater than 10 L/ min for short periods. It is usually limited to a <strong>flow of 5-6 L/min</strong> to reduce the discomfort resulting from inadequate humidification and high flow into the nasal cavity. It may also cause&nbsp;drying and crusting of the nasal mucosa.</p>\n<p>Oxygen delivery devices can be broadly divided into low flow oxygen devices (eg: nasal cannula, simple face mask, non-rebreathing mask) and high flow oxygen devices (eg: venturi mask).</p>\n<table width=\"620\">\n<tbody>\n<tr>\n<td><strong>Oxygen delivery devices</strong></td>\n<td><strong>Flow rate (liter/min)&nbsp;</strong></td>\n<td><strong>Approximate FiO2</strong></td>\n</tr>\n<tr>\n<td>Nasal cannula&nbsp;</td>\n<td>1-6&nbsp;</td>\n<td>0.24-0.44&nbsp;</td>\n</tr>\n<tr>\n<td>Simple face mask&nbsp;</td>\n<td>6-10</td>\n<td>0.40-0.60</td>\n</tr>\n<tr>\n<td>Non-rebreathing mask</td>\n<td>10-15</td>\n<td>0.90-1.00&nbsp;</td>\n</tr>\n<tr>\n<td>Venturi mask&nbsp;</td>\n<td>2-15&nbsp;</td>\n<td>0.24-0.60</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are true about open fractures?",
    "choices": [
      {
        "id": 1,
        "text": "1 and 2"
      },
      {
        "id": 2,
        "text": "1 and 4"
      },
      {
        "id": 3,
        "text": "2 and 4"
      },
      {
        "id": 4,
        "text": "2 and 3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Open fractures</strong> are usually associated with <strong>multiple other injuries</strong> and <strong>compartment syndrome </strong>can occur as a complication of open fractures.</p>\n<p>Open fractures are\u00a0characterized by a break in the overlying skin and soft tissues. Hence, the fracture fragment is exposed to the external environment. It is usually <strong>associated</strong> with <strong>multiple other injuries.</strong></p>\n<p>The most common sites involved in open fractures include\u00a0</p>\n<ul>\n<li><strong>Phalanges </strong>(Fingers and toes)</li>\n<li><strong>Tibial diaphysis</strong></li>\n<li>Distal radius\u00a0</li>\n<li>Ankle</li>\n</ul>\n<p>Open fractures are more prone to develop an <strong>infection</strong>, as it's exposed to the external environment. The presence of an open fracture does not prevent the development of <strong>compartment syndrome</strong>.</p>\n<p>Major components of management of all open fractures are:</p>\n<ul>\n<li><strong>Antibiotic</strong> prophylaxis - It should be given <strong>as early as possible<br /></strong></li>\n<li><strong>Early debridement</strong> of the wound and fracture - This includes the following steps:\n<ul>\n<li><strong>Excision</strong> of the wound margins</li>\n<li><strong>Extension</strong> of the wound if required</li>\n<li>Delivery of the fracture outside the wound for proper examination</li>\n<li>Removal of the devitalized tissue</li>\n<li><strong>Cleansing of the wound</strong> to remove all the foreign materials</li>\n<li>Nerves and tendons are usually left alone, but if the wound is clean, a repair can be considered</li>\n</ul>\n</li>\n<li><strong>Wound cover</strong>:\n<ul>\n<li>In <strong>Gustilo Type I and II fractures</strong> wound cover can be done <strong>at the time of debridement </strong>(Early wound cover)</li>\n<li><strong>Delayed wound cover</strong> is usually practiced in <strong>Type III</strong> fractures</li>\n</ul>\n</li>\n<li><strong>Fracture stabilization</strong> - The method of stabilization depends on the degree of contamination, amount of soft tissue damage, and time from the injury to operation.\n<ul>\n<li><strong>External fixation</strong> is used as a <strong>temporary</strong> measure if there is a delay in wound cover</li>\n<li>If definitive wound cover can be achieved at the time of debridement and there is no significant contamination, then an open fracture can be managed as same as a closed injury\u00a0</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Acute onset inattention with disorganized thinking and altered level of consciousness is characteristic of:",
    "choices": [
      {
        "id": 1,
        "text": "Dementia"
      },
      {
        "id": 2,
        "text": "Psychosis"
      },
      {
        "id": 3,
        "text": "Delirium"
      },
      {
        "id": 4,
        "text": "Schizophrenia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Acute onset inattention with disorganized thinking and altered level of consciousness is characteristic of <strong>delirium</strong>.</p>\n<p>The <strong>Confusion Assessment Method (CAM)</strong> is a diagnostic algorithm for delirium. The diagnosis of delirium requires the presence of features 1 and 2 and either feature 3 or 4.</p>\n<div class=\"page\" title=\"Page 194\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 194\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Feature 1: <strong>Acute</strong> onset and <strong>fluctuating</strong> course\n<ul>\n<li>Positive responses to the following questions satisfy this feature:<br />Is there evidence of an acute change in mental status from the patient&rsquo;s baseline? Does it fluctuate during the day, or does it increase and decrease in severity?</li>\n</ul>\n</li>\n<li>Feature 2: <strong>Inattention</strong>\n<ul>\n<li>Positive response to the following question satisfies this feature: Is there difficulty focusing attention, easily distractibility, or difficulty keeping track of what was being said?</li>\n</ul>\n</li>\n<li>Feature 3: <strong>Disorganized thinking</strong>\n<ul>\n<li>A positive response to the following question satisfies this feature: Was the patient&rsquo;s thinking disorganized or incoherent. Was there rambling or irrelevant conversation, an unclear or illogical flow of ideas, or unpredictable switching from subject to subject?</li>\n</ul>\n</li>\n<li>Feature 4: <strong>Altered level of consciousness</strong>\n<ul>\n<li>This feature is satisfied by any answer other than &ldquo;alert&rdquo; to the following question: Rate the patient&rsquo;s level of consciousness: alert (normal), vigilant (hyperalert), lethargic (drowsy, easily aroused), stupor (difficult to arouse), or coma (unarousable)?</li>\n</ul>\n</li>\n</ul>\n<p>The scale may not identify the full spectrum of patients with delirium, but all patients who are acutely confused should be presumed delirious. A course that fluctuates over hours or days and may worsen at night&nbsp;is known as <strong>sundowning</strong>. It is typically seen in delirium, but is not essential for the diagnosis.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p>Other screening tools that can aid in identifying patients with delirium are:</p>\n<ul>\n<li>Nursing Delirium Screening Scale (NuDESC)</li>\n<li>Organic Brain Syndrome Scale</li>\n<li>Delirium Rating Scale</li>\n<li>ICU version of the CAM</li>\n<li>Delirium Detection Score</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 61-year-old hypertensive male patient presents with back pain. He has been smoking for the past 30 years. On physical exam, he has an enlarged pulsatile mass over his abdomen. His CT scan is shown below. Which of the following are indications for elective surgical repair in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 2, 3"
      },
      {
        "id": 3,
        "text": "2, 3, 5"
      },
      {
        "id": 4,
        "text": "2, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical vignette describing a smoker with abdominal/back pain, history of hypertension and smoking, physical examination revealing a pulsatile mass, and CT findings showing dilation of the abdominal aorta is indicative of <strong>abdominal aortic aneurysm(AAA)</strong>. The following are indications for <strong>elective</strong> repair of AAA.</p>\n<ol>\n<li>Asymptomatic abdominal aortic aneurysm <strong>\u22655.5 cm</strong></li>\n<li>Rapid expansion <strong>&gt;1 cm</strong> in 1 year.</li>\n<li>AAA associated with<strong> peripheral arterial aneurysm</strong> (eg, iliac, popliteal) or symptomatic peripheral artery disease (eg, iliac occlusive disease) undergoing revascularization</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/054e45f0e8e840708b18e2fa704e0935.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b062a85cf6cd4fa8aa0a4c051053fd9cx715x599.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0a3509911e56432da46213b5af94aeb9x1280x2454.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions show \"Pop corn calcification\"?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, and 3"
      },
      {
        "id": 2,
        "text": "1, 2, 4, and 5"
      },
      {
        "id": 3,
        "text": "1, 2, 3, and 4"
      },
      {
        "id": 4,
        "text": "2, 3, 4, and 5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The calcification in<strong>\u00a0duct ectasia </strong>has a<strong> broken needle appearance. </strong>All the other conditions are associated with pop-corn calcification.</p>\n<p><strong>Amorphous calcifications</strong> with <strong>rings and arcs</strong> which resemble popped corn kernels in appearance are known as <strong>pop-corn calcification.\u00a0</strong></p>\n<p>It may be seen in\u00a0</p>\n<ul>\n<li>Chondroid lesions like chondrosarcoma</li>\n<li>Fibrous dysplasia</li>\n<li>Pulmonary hamartomas</li>\n<li>Fibroadenoma breast</li>\n<li>Calcified uterine fibroid</li>\n<li>Metaphyses and epiphyses of long bones of children with osteogenesis imperfecta.</li>\n</ul>\n<p>Image showing popcorn calcification in involuted fibroadenoma of the breast is given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ba9506b7e7d472b919fead1e9408f3dx720x750.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc4b42ca9f3241a2af659e80b561e3f2x841x1024.JPEG"
    ]
  },
  {
    "text": "Sequentially arrange the following fundoscopic findings according to the respective grades in which they are seen, as per Keith Wagener Barker (KWB) grading of hypertensive retinopathy, starting with grade 1.",
    "choices": [
      {
        "id": 1,
        "text": "1,2,3,4"
      },
      {
        "id": 2,
        "text": "4,3,1,2"
      },
      {
        "id": 3,
        "text": "3,4,1,2"
      },
      {
        "id": 4,
        "text": "2,3,1,4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct sequence according Keith Wagener Barker (KWB) grading of hypertensive retinopathy\u00a0is</p>\n<p>3. Retinal arteriolar narrowing\u00a0</p>\n<p>4. Arteriovenous nipping</p>\n<p>1. Macular star</p>\n<p>2. Optic Disc swelling</p>\n<p><strong>Keith Wagener Barker</strong> (KWB) grading of hypertensive retinopathy:</p>\n<p><strong>Grade 1</strong>: Presence of mild generalized <strong>retinal arteriolar narrowing.\u00a0</strong></p>\n<p><strong>Grade 2</strong>: Presence of focal arteriolar narrowing and <strong>arteriovenous nipping.</strong></p>\n<ul>\n<li>Copper wiring: Opacified appearance of arteriolar walls.</li>\n<li class=\"half_rhythm\">\n<div>Salus\u2019s sign: Deflection of retinal vein as it crosses the arteriole.</div>\n</li>\n<li class=\"half_rhythm\">\n<div>Gunn\u2019s sign: Tapering of the retinal vein on either side of the AV crossing.</div>\n</li>\n<li class=\"half_rhythm\">\n<div>Bonnet\u2019s sign: Banking of the retinal vein distal to the AV crossing.</div>\n</li>\n</ul>\n<p><strong>Grade 3</strong>: Grade 2 plus retinal hemorrhages, exudates and macular star.</p>\n<ul>\n<li>Retinal hemorrhages:\n<ul>\n<li><strong>Dot-blot hemorrhages</strong>: Bleeding in the inner retinal layer</li>\n<li><strong>Flame shaped hemorrhage</strong>: Bleeding is in the superficial retinal layer</li>\n</ul>\n</li>\n<li>Retinal exudates:\n<ul>\n<li><strong>Hard exudates</strong>: Lipid deposits in the retina</li>\n<li><strong>Soft exudates</strong>: These are also known as <strong>cotton wool spots</strong> which appear due to ischemia of the nerve fibers</li>\n</ul>\n</li>\n<li>Macular Changes\n<ul>\n<li><strong>Macular star</strong> formation due to deposition of hard exudates around the macula.</li>\n</ul>\n</li>\n</ul>\n<p><strong>Grade 4</strong>: Severe grade 3 plus <strong>optic disc swelling</strong>. This is a marker of malignant hypertension.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a3ad93aab5b7404dacab28597038fa68x1200x2876.JPEG"
    ]
  }
];
        let quizName = 'Mini Test 23';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>