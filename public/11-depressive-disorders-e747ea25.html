<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11 Depressive Disorders - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Psychiatry
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "According to the latest  WHO statistics, what is the most common psychiatric disorder in the world?",
    "choices": [
      {
        "id": 1,
        "text": "Eating disorder"
      },
      {
        "id": 2,
        "text": "Depression"
      },
      {
        "id": 3,
        "text": "Bipolar disorder"
      },
      {
        "id": 4,
        "text": "Anxiety disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>According to the WHO global health statistics 2020, <strong>anxiety disorder</strong> is the <strong>most common</strong>&nbsp;psychiatric illness in the world.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following is a  component of  Beck's triad of depression ?",
    "choices": [
      {
        "id": 1,
        "text": "Worthlessness"
      },
      {
        "id": 2,
        "text": "Anhedonia"
      },
      {
        "id": 3,
        "text": "Low mood"
      },
      {
        "id": 4,
        "text": "Fatigability"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Worthlessness</strong> is a component of&nbsp;Beck's cognitive <strong>triad of depression</strong>.&nbsp;It is also known as the negative triad.&nbsp;</p>\n<p><strong>Aaron Beck's cognitive triad</strong> consists of:</p>\n<ol>\n<li>Negative views about one's self - A tendency to devalue to feel personally inadequate (<strong>Worthlessness</strong>)</li>\n<li>Negative views about the world - A tendency to feel that there is no help available (<strong>Helplessness</strong>)</li>\n<li>Negative views about the future - The expectation of suffering and failure (<strong>Hopelessness</strong>)</li>\n</ol>\n<p><strong>Anhedonia</strong> - Decreased ability to experience pleasure.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old man continues to smoke despite several attempts at quitting because he believes that he will always be a smoker. Which of the following theories best describes this behavior?",
    "choices": [
      {
        "id": 1,
        "text": "Learned helplessness theory"
      },
      {
        "id": 2,
        "text": "Theory of psychosocial development"
      },
      {
        "id": 3,
        "text": "Psychodynamic theory"
      },
      {
        "id": 4,
        "text": "Social learning theory"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario is suggestive of the&nbsp;<strong>learned helplessness theory </strong>of depression.&nbsp;The theory connects depressive phenomena to the experience of uncontrollable events. It was proposed by Martin Seligman.&nbsp;</p>\n<p>Another good example of this can be a situation of domestic abuse where women tend to leave several times before doing so for good. A person may believe that they can never escape the abuser, even when help and support are available.</p>\n<p>Option B: The<strong> theory of</strong> <strong>psychosocial development</strong> was proposed by Erik Erikson. There are&nbsp;<strong>8 stages</strong> of psychosocial <strong>development.</strong> He states that&nbsp;there are critical time periods, each of which poses a particular <strong>psychosocial conflict</strong> to the individual. The resolution of this conflict results in either psychosocial growth or regression.</p>\n<p>Option C: <strong>Psychodynamic theory of development </strong>explains personality in terms of the interaction between the conscious and unconscious forces of <strong>Id, ego, and super-ego.</strong></p>\n<p>Option D: <strong>Social learning theory</strong> is a theory of learning process and social behavior which proposes that new behaviors can be acquired by observing and imitating others.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old woman is brought to the psychiatry OPD with low mood for the past 2 weeks, reduced socialization, decreased appetite and inability to sleep for the past 3 months. She complains of frequent backache and headache, with early morning awakening. Which of the following is increased in this disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Cortisol"
      },
      {
        "id": 2,
        "text": "Dopamine"
      },
      {
        "id": 3,
        "text": "Norepinephrine"
      },
      {
        "id": 4,
        "text": "Serotonin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of low mood along with reduced appetite, reduced interest in socialization, somatic symptoms, and disturbed sleep, points towards a diagnosis of <strong>depression (major depressive disorder).&nbsp;Cortisol</strong>&nbsp;levels are <strong>increased</strong> in depression.&nbsp;&nbsp;</p>\n<p>The diagnostic criteria for major depressive disorder are as follows:</p>\n<p>A. <strong>Five or more</strong> of the following symptoms have been present during the <strong>same 2 week period.&nbsp;</strong>At least<strong> one of the symptoms</strong> is either <strong>depressed mood</strong> or <strong>loss of interest</strong> or pleasure.</p>\n<ol>\n<li>Depressed mood most of the day</li>\n<li>Markedly diminished interest or pleasure in activities (anhedonia)</li>\n<li>Significant weight loss (loss of more than 5% of body weight in a month) when not dieting or weight gain, decrease or increase in appetite&nbsp;</li>\n<li>Insomnia or hypersomnia</li>\n<li>Psychomotor agitation or retardation</li>\n<li>Fatigue or loss of energy</li>\n<li>Feelings of worthlessness or excessive or inappropriate guilt</li>\n<li>Diminished ability to think or concentrate, or indecisiveness</li>\n<li>Recurrent thoughts of death, recurrent suicidal ideation</li>\n</ol>\n<p>B. The symptoms cause clinically significant <strong>distress or impairment</strong> in social, occupa&shy;tional, or other important areas of functioning.</p>\n<p>C. The episode is <strong>not attributable </strong>to the physiological effects of a<strong> substance</strong> or to another <strong>medical condition</strong>.</p>\n<p>D. The occurrence of the major depressive episode is not better explained by:</p>\n<ul>\n<li>Schizoaf&shy;fective disorder</li>\n<li>Schizophrenia</li>\n<li>Schizophreniform disorder</li>\n<li>Delusional disorder</li>\n<li>Another specified or unspecified schizophrenia spectrum, or other psychotic disorders.</li>\n</ul>\n<p>E. There has <strong>never </strong>been a <strong>manic</strong> episode or a <strong>hypomanic episode</strong>.</p>\n<p>Note<strong>: </strong>The levels of norepinephrine, serotonin, and dopamine are decreased in depression</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old retired officer has been confined to his house since the COVID-19 pandemic started in March 2020. He does not have any visitors and has lost touch with his family as well. He has been having persistent feelings of low mood and sees no purpose in his life. He sometimes has thoughts about killing himself. Which of the following sleep changes occur in this disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Increased REM latency"
      },
      {
        "id": 2,
        "text": "An increase in total sleep time"
      },
      {
        "id": 3,
        "text": "Deficits of slow-wave sleep"
      },
      {
        "id": 4,
        "text": "Decreased rapid eye movement (REM) sleep"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of&nbsp;<strong>depression (major depressive disorder).&nbsp;</strong>It is associated with a&nbsp;<strong>premature loss of deep (slow-wave) sleep</strong>.</p>\n<p>Sleep changes in depression:</p>\n<ul>\n<li>A premature loss of deep (slow-wave) sleep</li>\n<li>An increase in nocturnal arousal manifested as:\n<ul>\n<li>An increase in nocturnal awakenings</li>\n<li>A <strong>reduction </strong>in<strong> total sleep</strong> time</li>\n<li><strong>Increased</strong> phasic rapid eye movement (<strong>REM</strong>) sleep</li>\n<li>Increased core body temperature</li>\n</ul>\n</li>\n</ul>\n<p>The combination of <strong>increased REM drive</strong> and <strong>decreased slow-wave sleep</strong> results in a significant reduction in the first period of non-REM (NREM) sleep, a phenomenon referred to as<strong> reduced REM latency</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statement is false regarding the MRI changes seen in depression?",
    "choices": [
      {
        "id": 1,
        "text": "Reduction in volume of cingulate cortex"
      },
      {
        "id": 2,
        "text": "Compromised function in the prefrontal area during a cognitive task"
      },
      {
        "id": 3,
        "text": "Hyperactivity of the amygdala during an emotional task"
      },
      {
        "id": 4,
        "text": "Atrophy of the mesial temporal lobe"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Atrophy</strong> of the <strong>mesial temporal lobe</strong> particularly the hippocampus, entorhinal cortex and perirhinal cortex is an MRI change seen in <strong>Alzheimer's disease </strong>(and not depression).</p>\n<p>The MRI changes seen in depression are:</p>\n<ul>\n<li>Reduction in volume of cingulate cortex, prefrontal cortex, amygdala and hippocampus</li>\n<li>Compromised function in the prefrontal area during the implementation of a cognitive task</li>\n<li>Hyperactivity of the limbic system (including the amygdala) during an emotional task</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You receive a referral for a patient who reports a feeling of extreme heaviness in the arms or legs. As a result, he has been finding it difficult to move his limbs. In which of the following conditions is this type of paralysis seen?",
    "choices": [
      {
        "id": 1,
        "text": "Involutional melancholia"
      },
      {
        "id": 2,
        "text": "Atypical depression"
      },
      {
        "id": 3,
        "text": "Psychotic depression"
      },
      {
        "id": 4,
        "text": "Major depression"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>leaden paralysis&nbsp;</strong>and it refers to a feeling of extreme heaviness, usually in the arms or legs resulting in the difficulty of moving the limbs. It is seen in <strong>atypical depression</strong>.</p>\n<p class=\"p1\"><span class=\"s1\">Atypical depression</span><strong>&nbsp;</strong>is characterized by:</p>\n<ol>\n<li class=\"p1\">Low mood</li>\n<li>Increased sleep</li>\n<li>Increased appetite</li>\n<li>Weight gain</li>\n<li>Becomes sensitive to any comments</li>\n<li>Leaden paralysis</li>\n</ol>\n<p>Note:&nbsp;<strong>Involutional melancholia</strong>&nbsp;is a severe depressive state seen exclusively in people between <strong>40-65 years</strong>. It is usually associated with the delusions of persecution and nihilism.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old male who lost his wife 3 months back complains that his intestines have become rotten. He feels that he is responsible for his wife's death and should be sent to prison. He complains of feeling low all the time and has lost interest in daily activities since his wife's death. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Normal grief reaction"
      },
      {
        "id": 2,
        "text": "Psychotic depression"
      },
      {
        "id": 3,
        "text": "Delusional disorder"
      },
      {
        "id": 4,
        "text": "Schizophrenia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of persistent low mood, anhedonia, guilt, and self-critical thought content along with <strong>nihilistic delusion</strong> (rotten intestine), points towards a diagnosis of <strong>major depression with psychotic features</strong>.</p>\n<p>Differentiating features of grief and depression have been enlisted in the following table:</p>\n<table style=\"height: 593px; width: 383px;\">\n<tbody>\n<tr>\n<td style=\"width: 177.046875px;\"><strong>Grief</strong></td>\n<td style=\"width: 189.96875px;\"><strong>Depression</strong></td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">Feelings of emptyness and loss</td>\n<td style=\"width: 189.96875px;\">Persistent low mood and inability to anticipate pleasure</td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">Dysphoria comes in waves and tends to decrease in intentsity over time</td>\n<td style=\"width: 189.96875px;\">Low mood tends to be persistent and consistent</td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">Associated with thoughts and reminders of deceased/loss</td>\n<td style=\"width: 189.96875px;\">Not tied to specific thoughts and pre-occupations</td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">May be present along with positive emotions and humor</td>\n<td style=\"width: 189.96875px;\">Pervassive unhappiness and misery</td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">Thought content associated with thoughts and memories of deceased/loss</td>\n<td style=\"width: 189.96875px;\">Thought content associated with self-critical and pessimistic ruminations</td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">Self-esteem is generally preserved</td>\n<td style=\"width: 189.96875px;\">Worthlessness and self-loathing is common</td>\n</tr>\n<tr>\n<td style=\"width: 177.046875px;\">Ideas of death focused on joining the deceased</td>\n<td style=\"width: 189.96875px;\">Ideas of death focused on ending life due to hopelessness</td>\n</tr>\n</tbody>\n</table>\n<p>Note: Tricyclic antidepressants are considered to be the first-line drugs for psychotic depression.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An IT employee is feeling guilty, hopeless, and not able to concentrate on work. His symptoms started 3 years back when he entered college. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Depressive disorder"
      },
      {
        "id": 2,
        "text": "Dysthymia"
      },
      {
        "id": 3,
        "text": "Adjustment disorder"
      },
      {
        "id": 4,
        "text": "Cyclothymic disorder"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given clinical scenario of guilt, hopelessness, and difficulty in concentrating over a period of <strong>more than 2 years</strong>, is suggestive of <strong>dysthymia (persistent depressive disorder)</strong>.</p>\n<p>The DSM 5 and ICD-11 criteria for diagnosis of dysthymia:&nbsp;</p>\n<p>A. Depressed mood for most of the day as indicated by either subjective account or observation by others, for at&nbsp;<strong>least 2 years</strong>. In children and adolescents at&nbsp;least 1 year.</p>\n<p>B. Presence&nbsp;of<strong>&nbsp;two (or more)</strong>&nbsp;of the following while being depressed.</p>\n<ol>\n<li>Poor appetite or overeating</li>\n<li>Insomnia or hypersomnia</li>\n<li>Low energy or fatigue</li>\n<li>Low self-esteem</li>\n<li>Poor concentration and/or difficulty making decisions</li>\n<li>Feelings of hopelessness</li>\n</ol>\n<div class=\"page\" title=\"Page 212\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>C. During the 2-year period (1 year for children or adolescents) of the disturbance, the individ&shy;ual has never been without the symptoms in criteria A and B for more than 2 months at a time.</p>\n<p>D. Criteria for a major depressive disorder may be continuously present for 2 years.</p>\n<p>E. There has never been a manic episode or a hypomanic episode, and criteria have never been met for cyclothymic disorder.</p>\n<p>F. The disturbance is not better explained by a persistent schizoaffective disorder, schizophrenia, delusional disorder, or other specified or unspecified schizophrenia spectrum and other psychotic disorders.</p>\n<p>G. The symptoms are not attributable to the physiological effects of a substance (e.g., a drug of abuse, a medication) or another medical condition (e.g. hypothyroidism).</p>\n<p>H. The symptoms cause clinically significant distress or impairment in social, occupational, or other important areas of functioning.</p>\n</div>\n</div>\n</div>\n<p>Option C:&nbsp;<strong>Adjustment disorder </strong>is characterized by emotional or behavioral symptoms that develop&nbsp;<strong>within 3 months of exposure</strong>&nbsp;to an identifiable stressor and usually&nbsp;<strong>do not last more than 6 months</strong>&nbsp;after the stressor ends.</p>\n<p>Option D: <strong>Cyclothymic disorder&nbsp;</strong>is symptomatically a mild form of bipolar II disorder, characterized by episodes of <strong>hypomania</strong> and <strong>mild depression</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient comes to you with a history of persistent low mood for the past 3 years. He also complains of fatigue and insomnia during this period. He gives a history of worsening low mood over the past 3 weeks, along with suicidal thoughts and a loss of interest in all activities.  What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Major depressive disorder"
      },
      {
        "id": 2,
        "text": "Dysthymia"
      },
      {
        "id": 3,
        "text": "Cyclothymia"
      },
      {
        "id": 4,
        "text": "Double depression"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Double depression</strong> is the most probable diagnosis in this scenario.&nbsp;<strong>Dysthymia</strong> and <strong>major depressive disorder</strong>&nbsp;in the <strong>same period&nbsp;</strong>constitute&nbsp;double depression.&nbsp;</p>\n<p>From the given history:</p>\n<ul>\n<li>Features of low mood, fatigue, and insomnia for more than 2 years point towards dysthymia.</li>\n<li>Features of low mood, fatigue, insomnia, anhedonia, and suicidal thoughts for more than 2 weeks point towards major depressive disorder.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A mother started to feel sad and tearful over the first two weeks following childbirth. She felt overwhelmed by the responsibilities of nursing her baby and changing diapers and waking up in the middle of the night. She felt that she was a failure as a mother. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Post-partum blues"
      },
      {
        "id": 2,
        "text": "Postpartum depression"
      },
      {
        "id": 3,
        "text": "Post-partum psychosis"
      },
      {
        "id": 4,
        "text": "Post-partum anxiety"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The given clinical scenario is suggestive of <strong>postpartum blues.\u00a0</strong></p>\n<p class=\"p1\">It is characterized by a labile mood, sadness, and subjective confusion. It is thought to be due to changes in hormone levels, the stress of childbirth, and anxiety about the responsibilities of motherhood.\u00a0This usually resolves spontaneously.\u00a0</p>\n<p class=\"p1\">If symptoms last longer than 2 weeks, an evaluation for <strong>postpartum depression</strong> is needed.</p>\n<p>Note:\u00a0 Zuranolone is the first-ever oral drug to be approved specifically for the treatment of postpartum depression. It is a neuroactive steroid that enhances the action of GABA in the brain and regulates mood.\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman who had delivered a healthy baby 3 weeks ago was brought to the psychiatry OPD. She intently stares at you and says that her baby was stolen from the womb by her sister. On examination she has labile mood, and is mumbling to herself. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Baby blues"
      },
      {
        "id": 2,
        "text": "Postpartum depression"
      },
      {
        "id": 3,
        "text": "Postpartum psychosis"
      },
      {
        "id": 4,
        "text": "Schizophrenia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">From the given clinical scenario the patient is showing features of <strong>postpartum psychosis </strong>(depression with psychotic features).<strong>&nbsp;</strong>It<strong>&nbsp;</strong>can often begin within a few days following delivery, although the mean time of onset is usually within <strong>2 to 4 weeks</strong> of delivery.&nbsp;</p>\n<p>Characteristically, the patient begins to complain of fatigue, episodes of tearfulness, and emotional lability. Later develops,&nbsp;<strong>suspiciousness</strong>, confusion, <strong>irrational statements</strong>, and obsessive concerns about the baby's health and welfare may be present.&nbsp;Patients eventually develop <strong>delusions</strong> that involve the idea that the baby is dead or defective. <strong>Hallucinations</strong> if present may involve voices telling the patient to harm the baby or herself.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the treatment of choice for postpartum blues?",
    "choices": [
      {
        "id": 1,
        "text": "Fluoxetine"
      },
      {
        "id": 2,
        "text": "Cognitive behavioural therapy"
      },
      {
        "id": 3,
        "text": "Lithium carbonate"
      },
      {
        "id": 4,
        "text": "Support and education"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Postpartum blues</strong> is common in mothers in the puerperal period and requires nothing more than <strong>education and support</strong>. It is characterised by a labile mood, sadness and subjective confusion. It is thought to be due to changes in hormone levels, the stress of childbirth and anxiety about the responsibilities of motherhood.</p>\n<p>If symptoms last longer than 2 weeks, an evaluation for <strong>postpartum depression</strong> is needed.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A primigravida who is 9 weeks pregnant, with low mood, loss of appetite, anhedonia, and insomnia for the past 2 weeks was referred to the psychiatry department.  Which of the following drugs would you prescribe her?",
    "choices": [
      {
        "id": 1,
        "text": "Imipramine"
      },
      {
        "id": 2,
        "text": "Desipramine"
      },
      {
        "id": 3,
        "text": "Selegiline"
      },
      {
        "id": 4,
        "text": "Paroxetine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of depression. <strong>Desipramine</strong> is the <strong>safest</strong> to use amongst the given options, for <strong>depression during pregnancy.\u00a0</strong></p>\n<p>Antidepressants and pregnancy:</p>\n<p>Tricyclic Antidepressants (TCA):\u00a0</p>\n<ul>\n<li>Cross the placenta.</li>\n<li><strong>Imipramine</strong> - <strong>not safe</strong>, due to high anticholinergic and hypotensive properties</li>\n<li>Desipramine, nortriptyline - recommended</li>\n<li>Neonatal withdrawal effects are frequent and mild</li>\n</ul>\n<p>Mono Amine Oxidase Inhibitors (MAO-I):</p>\n<ul>\n<li>Should be <strong>avoided</strong> in <strong>pregnancy,</strong> as they increase the risk of hypertensive crisis</li>\n<li>Associated with pulmonary hypertension in newborns</li>\n</ul>\n<p>Selective Serotonin Reuptake Inhibitors (SSRI):</p>\n<ul>\n<li>Associated with preterm delivery and spontaneous abortions</li>\n<li><strong>Paroxetine</strong> - shows <strong>cardiac abnormalities</strong> in <strong>newborns</strong></li>\n<li>Citalopram, Sertraline - safer drugs</li>\n<li>Neonate shows serotonin toxicity and withdrawal symptoms</li>\n</ul>\n<p>Note: Antipsychotic drugs like olanzapine, quetiapine, and risperidone are considered safe during pregnancy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "For how long would you continue SSRIs for a patient who had a single episode of depression?",
    "choices": [
      {
        "id": 1,
        "text": "4 weeks after complete remission"
      },
      {
        "id": 2,
        "text": "6 months after complete remission"
      },
      {
        "id": 3,
        "text": "6 weeks after complete remission"
      },
      {
        "id": 4,
        "text": "Until complete remission"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<table style=\"width: 362.609px; height: 336px;\">\n<tbody>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Class of drugs</strong></td>\n<td style=\"width: 173.609px; text-align: center;\"><strong>Examples</strong></td>\n</tr>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Selective serotonin reuptake inhibitors (SSRI)</strong></td>\n<td style=\"width: 173.609px;\">\n<ul>\n<li>Fluoxetine</li>\n<li>Fluvoxamine</li>\n<li>Paroxetine</li>\n<li>Sertraline</li>\n<li>Citalopram</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Serotonin-norepinephrine reuptake inhibitors</strong></td>\n<td style=\"width: 173.609px;\">\n<ul>\n<li>Venlafaxine</li>\n<li>Desvenlafaxine</li>\n<li>Duloxetine</li>\n<li>Milnacipran</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Tricyclic antidepressants</strong></td>\n<td style=\"width: 173.609px;\">\n<ul>\n<li>Amitriptyline</li>\n<li>Imipramine</li>\n<li>Nortriptyline</li>\n<li>Desipramine</li>\n<li>Amoxapine</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Atypical antipsychotics</strong></td>\n<td style=\"width: 173.609px;\">\n<ul>\n<li>Aripiprazole</li>\n<li>Olanzapine</li>\n<li>Quetiapine</li>\n<li>Risperidone</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Monoamine oxidase inhibitors (MAO)</strong></td>\n<td style=\"width: 173.609px;\">\n<ul>\n<li>Isocarboxazid</li>\n<li>Selegiline</li>\n<li>Phenelzine</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 171px; text-align: center;\"><strong>Atypical antidepressants</strong></td>\n<td style=\"width: 173.609px;\">\n<ul>\n<li>Bupropion</li>\n<li>Trazodone</li>\n<li>Mirtazapine</li>\n<li>Mianserin</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient was treated with TCA for a major depressive episode in the hospital for 4 weeks. What is the main concern while considering his discharge from the hospital?",
    "choices": [
      {
        "id": 1,
        "text": "Need for drug monitoring"
      },
      {
        "id": 2,
        "text": "ECG monitoring for arrhythmias"
      },
      {
        "id": 3,
        "text": "Suicidal risk"
      },
      {
        "id": 4,
        "text": "Sedation being the side effect"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Suicidal thoughts</strong> or<strong> behavior </strong>are a <strong>side effect</strong> of <strong>TCAs.</strong> Therefore, the attendants of the patient <strong>should be warned</strong> regarding this when a patient gets discharged after being treated with TCAs for a major depressive episode.</p>\n<p>Tricyclic antidepressants (TCAs) are drugs that act by<strong> inhibiting</strong> the<strong> reuptake</strong> of <strong>noradrenaline</strong> and <strong>serotonin</strong> from the synaptic clefts.\u00a0</p>\n<p>The side effects of TCAs are due to blockade of other receptors:</p>\n<ul>\n<li><strong>Muscarinic M receptors</strong>- constipation, dry mouth, arrhythmia</li>\n<li><strong>Histamine H<sub>1</sub>\u00a0receptors</strong>- sedation</li>\n<li><strong>5HT receptors</strong> - weight gain due to increased appetite</li>\n<li><strong>Alpha<sub>1</sub> receptors</strong> - postural hypotension.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the treatment of choice in a patient with refractory depression and suicidal thoughts?",
    "choices": [
      {
        "id": 1,
        "text": "Selective serotonin receptor inhibitors"
      },
      {
        "id": 2,
        "text": "Tricyclic antidepressants"
      },
      {
        "id": 3,
        "text": "Electroconvulsive therapy"
      },
      {
        "id": 4,
        "text": "Monoamine oxidase inhibitors"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Electroconvulsive therapy (ECT)</strong> is the treatment of choice for depression with suicidal thoughts and refractory depression.</p>\n<p>Modified ECT uses short-acting anaesthesia and short-acting muscle relaxants.</p>\n<p>Treatment of depression:</p>\n<ul>\n<li>In recent\u2010onset&nbsp;<strong>mild depression</strong>, cognitive behavioural therapy (CBT) is preferred and antidepressants are not recommended.</li>\n<li>For<strong> moderate to severe depression</strong> and&nbsp;<strong>dysthymia</strong> - Antidepressants (SSRIs) + CBT.</li>\n<li>For <strong>treatment\u2010resistant depression</strong>, recommended strategies include augmentation with lithium or an antipsychotic or the addition of a second antidepressant</li>\n<li><strong>For severe</strong> and<strong> treatment-resistant depression - </strong>Electroconvulsive therapy (ECT) can also be used.</li>\n</ul>\n<p>Somatic and newer treatment modalities for depression include:</p>\n<ul>\n<li>Vagus nerve stimulation for resistant depression</li>\n<li>Repeated transcranial magnetic stimulation</li>\n<li>Phototherapy</li>\n<li>Deep brain stimulation.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which is a mood stabiliser with an anti-suicidal role?",
    "choices": [
      {
        "id": 1,
        "text": "Carbamazepine"
      },
      {
        "id": 2,
        "text": "Lamotrigine"
      },
      {
        "id": 3,
        "text": "Lithium"
      },
      {
        "id": 4,
        "text": "Valproate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Lithium</strong> is a mood stabilizer with an<strong> anti-suicidal </strong>role.</p>\n<p><strong>Maintenance treatment</strong> with <strong>lithium</strong> has been shown to significantly<strong>\u00a0decrease the rate of suicide </strong>in patients diagnosed with\u00a0<strong>mood disorders </strong>when compared to<strong>\u00a0</strong>other mood stabilizers such as carbamazepine, lamotrigine, and valproate.</p>\n<p>Lithium is also used as an augmentation agent in treatment-resistant depression. Recurrent depression with a cyclic pattern can be controlled by either lithium or imipramine.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 36-year-old woman presented with symptoms of low mood, loss of interest, loss of appetite, and sleep disturbances for the past 3 weeks. She has a history of two similar episodes over the last 3 years. She has no history of episodes of elated mood, racing thoughts, or decreased need to sleep.  Which of the following is not a risk factor for her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Short episode duration"
      },
      {
        "id": 2,
        "text": "Recurrent dysthymia"
      },
      {
        "id": 3,
        "text": "Family history of similar episodes"
      },
      {
        "id": 4,
        "text": "Concurrent non-affective psychiatric illness"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The given clinical scenario points towards a diagnosis of <strong>recurrent depressive disorder</strong>. <strong>Long</strong> <strong>episode duration</strong> is a risk factor for recurrent depression.</p>\n<p>Risk factors:</p>\n<ul>\n<li>Family history of depression</li>\n<li>Recurrent dysthymia</li>\n<li>Concurrent non\u2010affective psychiatric illness</li>\n<li>Female gender\u00a0</li>\n<li>Long episode duration</li>\n<li>Degree of treatment resistance</li>\n<li>Chronic medical illness</li>\n<li>Social factors (lack of confiding relationships and psychosocial stressors)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly gentleman presents to you with complaints of forgetfulness. He is unable to work as his memory issues were causing him distress, and he has difficulty concentrating. He also has insomnia, depressed mood, loss of appetite, and fatigue for the past two weeks. Which of the following best describes this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Alzheimer's disease"
      },
      {
        "id": 2,
        "text": "Delirium"
      },
      {
        "id": 3,
        "text": "Dementia"
      },
      {
        "id": 4,
        "text": "Pseudo-dementia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above scenario of an&nbsp;<strong>elderly</strong> <strong>depressed patient&nbsp;</strong>with memory loss and <strong>dementia syndrome</strong>&nbsp;is suggestive of&nbsp;<strong>pseudodementia.&nbsp;</strong>This syndrome has been termed as&nbsp;dementia syndrome of depression/depression with reversible dementia.<strong>&nbsp;</strong>The condition may improve or even completely subside after the remission of depression.&nbsp;</p>\n<p>Pseudodementia is&nbsp;a condition that appears similar to dementia but <strong>does not have neurological degeneration</strong>. Such patients commonly complain of impaired concentration and forgetfulness.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is anaclitic depression?",
    "choices": [
      {
        "id": 1,
        "text": "Depression in infants when separated from primary caregiver"
      },
      {
        "id": 2,
        "text": "Depression seen in mental retardation"
      },
      {
        "id": 3,
        "text": "Depression seen in autism spectrum disorder"
      },
      {
        "id": 4,
        "text": "Depression in schizophrenia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 118\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Anaclitic depression</strong>, also known as <strong>hospitalism,</strong>\u00a0is a type of depression in <strong>infants</strong> where\u00a0<strong>sudden separation</strong> from their <strong>primary caregivers</strong> leads to depression, withdrawal, nonresponsiveness, and loss of milestones in the infants.\u00a0However, they recover when their mothers return or when surrogate mothering is available.\u00a0</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged woman diagnosed with depression presented to your OPD for a follow-up. You notice a characteristic sign marked by an arrow in the image. Identify this sign.",
    "choices": [
      {
        "id": 1,
        "text": "Veraguth's sign"
      },
      {
        "id": 2,
        "text": "Omega sign"
      },
      {
        "id": 3,
        "text": "Van Gogh sign"
      },
      {
        "id": 4,
        "text": "Ottoman's sign"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">In the given image, the arrow indicates <strong>Veraguth's sign </strong>or Veraguth's fold, a<strong>&nbsp;diagonal palpebral fold</strong> running from the lateral corners of the eyes, medially upward to the medial end of the eyebrows. It is a physical sign of depression.</p>\n<p>Another physical sign of depression is the&nbsp;<strong>Omega sign. </strong>In this, there is&nbsp;vertical wrinkling between the eyebrows joined at the top by a horizontal crease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/865944f18b7a42679eb3b74f1e0659f5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6d2bdce0d5324ff5acffc26bb59afd85x1200x1118.JPEG"
    ]
  },
  {
    "text": "Which of the following is not a feature of melancholia?",
    "choices": [
      {
        "id": 1,
        "text": "Severe anhedonia"
      },
      {
        "id": 2,
        "text": "Weight loss"
      },
      {
        "id": 3,
        "text": "Sleep-onset insomnia"
      },
      {
        "id": 4,
        "text": "Profound feelings of guilt over trivial events"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Sleep-onset insomnia</strong> is a characteristic feature of <strong>anxiety disorder</strong>, not melancholia.</p>\n<p><strong>Melancholia</strong> is one of the oldest terms used in psychiatry, to describe the <strong>dark mood of depression</strong>. It is still used to refer to a state of depression characterized by:</p>\n<ul>\n<li>Severe anhedonia</li>\n<li>Early morning awakening (<strong>terminal insomnia</strong>)</li>\n<li>Weight loss</li>\n<li>Profound feelings of guilt (often over trivial events)</li>\n</ul>\n<p>Melancholia is sometimes referred to as \"<strong>endogenous depression</strong>\" or depression that arises in the absence of external life stressors or precipitants.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following is not a feature of a patient with hysteroid dysphoria?",
    "choices": [
      {
        "id": 1,
        "text": "Reversed vegetative symptoms"
      },
      {
        "id": 2,
        "text": "No therapeutic response to monoamine oxidase inhibitors"
      },
      {
        "id": 3,
        "text": "They experience a craving for chocolate"
      },
      {
        "id": 4,
        "text": "Impaired anticipatory pleasure is seen"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Persons with <strong>hysteroid dysphoria</strong> respond well to treatment with monoamine oxidase inhibitors.</p>\n<p>Hysteroid dysphoria is a type of <strong>atypical depression. </strong>The following features can be seen in this condition:</p>\n<ul>\n<li>Reversed vegetative symptoms:\n<ul>\n<li>Insomnia</li>\n<li>Tendency to oversleep and to overeat</li>\n<li>Mood worsens in the evening</li>\n</ul>\n</li>\n<li><strong>Extreme sensitivity to rejection</strong> (hallmark feature)</li>\n<li>Impaired anticipatory pleasure (prediction of pleasure from a future reward), but affected persons are capable of <strong>mood reactivity</strong>&nbsp;i.e., their mood brightens in response to positive events</li>\n<li>Craving for chocolate</li>\n<li>Like patients with bipolar depression, they respond preferentially to monoamine oxidase inhibitors (MAOIs).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old male presents with symptoms of low mood, fatigue, and failure to experience pleasure in any activities. He also complains of insomnia and lack of concentration. These symptoms are present during most of the months of winter and completely remit during spring. The symptoms have been recurring over the past 3 years. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Major Depressive disorder"
      },
      {
        "id": 2,
        "text": "Major Depressive Disorder with seasonal pattern"
      },
      {
        "id": 3,
        "text": "Cyclothymia"
      },
      {
        "id": 4,
        "text": "Dysthymia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Major depressive disorder</strong> with<strong> seasonal pattern</strong> is the most likely diagnosis in this scenario.&nbsp;</p>\n<p>Features of major depressive disorder with seasonal pattern:<strong>&nbsp;</strong></p>\n<ul>\n<li>Onset and remission of major depressive episodes at <strong>specific times of the year.</strong></li>\n<li>In most cases, the episodes begin in the&nbsp;fall or winter and remit in spring.</li>\n<li>This pattern of onset and remission of episodes must have occurred during at least a<strong> 2-year period</strong>, <strong>without any</strong><br /><strong>nonseasonal episodes</strong> during this period.</li>\n<li>In addition, the seasonal depressive episodes must substantially <strong>outnumber any nonseasonal depressive episodes</strong> over the individual's lifetime.</li>\n<li>Absence of seasonally linked psychosocial stressors (e.g., seasonal unemployment or school schedule).</li>\n<li>Major depressive episodes that occur in a seasonal pattern are often characterized by prominent energy, hypersomnia, overeating, weight gain, and a craving for carbohydrates.</li>\n</ul>\n<p>Note:&nbsp;According to ICD-11, seasonal depressive disorder is included under recurrent depressive disorders.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old man presents with symptoms of low mood, fatigue, and inability to experience pleasure in any activities. He also complains of insomnia and lack of concentration. These symptoms are present during the months of winter and completely remit during spring. On further questioning, you find that he is a laborer who is always left unemployed during the winter months. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Major depressive disorder"
      },
      {
        "id": 2,
        "text": "Major depressive disorder with seasonal pattern"
      },
      {
        "id": 3,
        "text": "Dysthymia"
      },
      {
        "id": 4,
        "text": "Cyclothymia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Major depressive disorder</strong> is the most likely diagnosis in this case.\u00a0</p>\n<p>DSM-V criteria for diagnosis of depression:</p>\n<div class=\"page\" title=\"Page 365\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ol>\n<li><strong>Depressed mood</strong>\u00a0most of the day</li>\n<li><strong>Anhedonia</strong>- diminished interest in day-to-day activities</li>\n<li>Significant\u00a0weight loss\u00a0or\u00a0weight gain\u00a0and/or change in\u00a0appetite.</li>\n<li><strong>Insomnia</strong>\u00a0or hypersomnia</li>\n<li>Psychomotor agitation or retardation</li>\n<li><strong>Fatigue</strong>\u00a0or loss of energy</li>\n<li>Feelings of worthlessness or excessive,\u00a0inappropriate guilt</li>\n<li><strong>Diminished ability</strong> to think or <strong>concentrate</strong>, indecisiveness</li>\n<li>Recurrent thoughts of death and suicide</li>\n</ol>\n<p>At least\u00a0<strong>five out of nine</strong>\u00a0symptoms must be present over a two-week period and\u00a0<strong>one</strong>\u00a0symptom\u00a0<strong>must be depressed mood </strong>or<strong> anhedonia.\u00a0</strong></p>\n</div>\n</div>\n</div>\n<p><strong>Major depressive disorder with seasonal pattern </strong>(option B) is <strong>not</strong> the <strong>diagnosis</strong> as there is<strong> the presence of a </strong><strong>psychosocial stressor</strong> (e.g., seasonal unemployment or school schedule). It is explicitly mentioned in the question that the patient always remains unemployed during the winter months which acts as the objective psychological stressor in this case.</p>\n<p><strong>Major depressive disorder with seasonal pattern</strong> refers to the <strong>onset</strong> and <strong>remission</strong> of <strong>major depressive episodes</strong> at\u00a0<strong>specific times of the year</strong>.\u00a0In most cases, the episodes begin in the\u00a0fall or winter and remit in spring.\u00a0Major depressive episodes that occur in a seasonal pattern are often characterized by prominent energy, hypersomnia, overeating, weight gain, and a craving for carbohydrates. This pattern of onset and remission of episodes must have occurred during at least a\u00a02-year period,\u00a0without any nonseasonal episodes\u00a0during this period.\u00a0</p>\n<p><strong>Dysthymia</strong> (option C)\u00a0is the presence of a <strong>persistently depressed mood</strong> that lasts <strong>most of the day</strong> and is <strong>continuous</strong>. There are also feelings of <strong>guilt</strong>, <strong>irritability</strong>, and <strong>anger</strong> associated with it. These symptoms are present for at least 2 years. Dysthymia will also\u00a0<strong>never</strong>\u00a0present with an episode of <strong>mania/hypomania</strong>.</p>\n<p><strong>Cyclothymia</strong> (option D) is a\u00a0<strong>mild</strong>\u00a0form of\u00a0<strong>bipolar II disorder</strong>,\u00a0characterized by symptoms of\u00a0<strong>hypomania\u00a0</strong>and\u00a0<strong>mild depression</strong>. Hypomania mainly includes symptoms like\u00a0persistently elevated\u00a0or\u00a0irritable mood\u00a0and abnormally\u00a0increased energy\u00a0lasting for at least\u00a04 consecutive days.\u00a0The depression seen in cyclothymia does not qualify the criteria for a major depressive episode.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Phototherapy is a treatment for which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Schizophrenia"
      },
      {
        "id": 2,
        "text": "Chronic major depression"
      },
      {
        "id": 3,
        "text": "Seasonal affective disorder"
      },
      {
        "id": 4,
        "text": "Cyclothymia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Phototherapy</strong> was introduced as a treatment for <strong>seasonal affective disorder</strong>.</p>\n<p>In this disorder, patients typically experience depression as the photoperiod of the day decreases with advancing winter.&nbsp;</p>\n<p>Phototherapy typically involves exposing the affected <strong>patient&nbsp;</strong>to bright light in the range of 1,500 to 10,000 lux or more, typically with a lightbox. The patient sits in front of this lightbox&nbsp;for approximately <strong>1 to 2 hours before dawn </strong>each day.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged female patient presents with a history of loss of interest in day to day activities, weight loss, insomnia, and sadness for six months. She also recalls hearing a voice once that ordered her to kill herself. What is the DSM-V diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Major depressive disorder with psychotic features"
      },
      {
        "id": 2,
        "text": "Schizophrenia"
      },
      {
        "id": 3,
        "text": "Schizoaffective disorder"
      },
      {
        "id": 4,
        "text": "Delusional disorder"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Since the patient fulfills the DSM-V criteria for major depressive disorder and has had an episode of auditory hallucination, a diagnosis of <strong>major depressive disorder with psychotic features</strong> is made.</p>\n<p><strong>Diagnostic criteria for depression:</strong></p>\n<ol>\n<li>Depressed mood&nbsp;most of the day</li>\n<li>Anhedonia- diminished interest in day to day activities</li>\n<li>Significant weight loss or weight gain. Change in appetite.</li>\n<li>Insomnia&nbsp;or hypersomnia</li>\n<li>Psychomotor agitation or retardation</li>\n<li>Fatigue or loss of energy</li>\n<li>Feelings of worthlessness or excessive, inappropriate guilt</li>\n<li>Diminished ability to think or concentrate, indecisiveness</li>\n<li>Recurrent thoughts of death, suicidal ideation</li>\n</ol>\n<p>At least <strong>five out of nine</strong> symptoms must be present over a two week period and <strong>one</strong> symptom <strong>must be depressed mood or anhedonia.</strong></p>\n<p>In major depressive disorder with psychotic features, <strong>delusions and/or hallucinations</strong> are present along with the depression symptoms.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old patient comes to the casualty with a dry mouth, decreased sweating and blurring of vision, tremors. On examination, blood pressure is low, and mydriasis is present. The patient says that he has been on psychiatric medication for the past year. Which of the following drugs is responsible for the above presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Disulfiram"
      },
      {
        "id": 2,
        "text": "Imipramine"
      },
      {
        "id": 3,
        "text": "Lithium"
      },
      {
        "id": 4,
        "text": "Valproate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The manifestations given in the question are the side effects of <strong>tricyclic antidepressants (imipramine).</strong></p>\n<p>TCAs have <strong>anticholinergic side effects </strong>such as&nbsp;dry eyes, pupillary dilation, decreased&nbsp;sweating, urinary retention, and constipation.</p>\n<p>These drugs are <strong>contraindicated</strong> in patients with <strong>glaucoma</strong> and <strong>benign prostatic hyperplasia</strong>.</p>\n<p>Side effects of tricyclic antidepressants:</p>\n<table style=\"height: 123px; width: 523px;\">\n<tbody>\n<tr>\n<td style=\"width: 170.515625px;\">Receptor blocked</td>\n<td style=\"width: 160.484375px;\">Side effect</td>\n</tr>\n<tr>\n<td style=\"width: 170.515625px;\">Muscarinic receptor blockade</td>\n<td style=\"width: 160.484375px;\">Anticholinergic- dry mouth, dilated pupils, tachycardia, urinary retention</td>\n</tr>\n<tr>\n<td style=\"width: 170.515625px;\">Alpha 1 adrenergic receptor blockade</td>\n<td style=\"width: 160.484375px;\">Drowsiness, postural hypotension, sexual dysfunction</td>\n</tr>\n<tr>\n<td style=\"width: 170.515625px;\">H1 receptor blockade</td>\n<td style=\"width: 160.484375px;\">Weight gain, drowsiness</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old woman developed serotonin syndrome after receiving a single dose of imipramine. She was already being treated for depression with paroxetine. Which of the following is not seen on examination?",
    "choices": [
      {
        "id": 1,
        "text": "Tremors"
      },
      {
        "id": 2,
        "text": "Rigidity"
      },
      {
        "id": 3,
        "text": "Hypothermia"
      },
      {
        "id": 4,
        "text": "Myoclonus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Hypothermia&nbsp;is not a feature of serotonin syndrome.</p>\n<p><strong>Serotonin syndrome</strong> is characterized by 3 A&rsquo;s:</p>\n<ol>\n<li>Neuromuscular hyper<strong>a</strong>ctivity (clonus, hyperreflexia, hypertonia, tremor, and seizure)</li>\n<li><strong>A</strong>utonomic stimulation (hyperthermia, diaphoresis, diarrhoea)</li>\n<li><strong>A</strong>gitation.</li>\n</ol>\n<p>It&nbsp;can occur with any drug that increases 5-HT (eg, MAOIs, SSRIs, SNRIs, TCAs, tramadol, ondansetron, triptans, linezolid, MDMA, dextromethorphan).</p>\n<p>Treatment: Discontinuation of the offending drug, supportive management, cyproheptadine (5-HT2 receptor antagonist).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '11 Depressive Disorders';
        let hierarchy = ["Marrow", "qBank", "Psychiatry"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>