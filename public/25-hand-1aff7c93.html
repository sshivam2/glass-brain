<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>25  Hand - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        DAMS / DQB / Anatomy
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">29</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "id": 50000,
    "choices": [
      {
        "id": 200000,
        "text": "Palmar interossei"
      },
      {
        "id": 200001,
        "text": "Dorsal interossei"
      },
      {
        "id": 200002,
        "text": "Lumbricals"
      },
      {
        "id": 200003,
        "text": "FDS"
      }
    ],
    "text": "Flexion of MCP joint and extension of IP joints is the action of All except:",
    "unique_key": "Q4226426",
    "question_audio": null,
    "question_video": null,
    "map_id": 34250279,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) FDS (Flexor Digitorum Superficialis) The Flexor Digitorum Superficialis (FDS) is a muscle that flexes the proximal interphalangeal (PIP) joints and contributes to flexion of the metacarpophalangeal (MCP) joints, but it does not contribute to the extension of the interphalangeal (IP) joints. The combined action of MCP joint flexion and IP joint extension is performed by the intrinsic muscles of the hand (lumbricals and interossei), which insert into the extensor expansion. Since the FDS is an extrinsic flexor muscle, it does not act on the extensor mechanism, making it the incorrect option for this specific action. Incorrect Responses: (A) Palmar interossei The palmar interossei are intrinsic muscles of the hand responsible for adduction of the fingers and contribute to flexion at the MCP joints and extension at the IP joints through their insertion into the extensor expansion. This makes them involved in the described action. (B) Dorsal interossei The dorsal interossei are also intrinsic muscles of the hand, primarily responsible for abduction of the fingers. Like the palmar interossei, they insert into the extensor expansion and assist in flexion at the MCP joints and extension at the IP joints, aligning with the action described. (C) Lumbricals The lumbricals are small intrinsic muscles of the hand that originate from the tendons of the flexor digitorum profundus and insert into the extensor expansion. Their unique function includes flexing the MCP joints while extending the IP joints, making them a key contributor to this action.",
    "correct_choice_id": 200003,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/28982891697959810/28982891697959810.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/28982891697959810/28982891697959810.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50001,
    "choices": [
      {
        "id": 200004,
        "text": "Brachioradialis"
      },
      {
        "id": 200005,
        "text": "Flexor carpi ulnaris"
      },
      {
        "id": 200006,
        "text": "Extensor digitorum"
      },
      {
        "id": 200007,
        "text": "Extensor carpi Radialis"
      }
    ],
    "text": "Adductors of the hand at the wrist joint include",
    "unique_key": "Q2195896",
    "question_audio": null,
    "question_video": null,
    "map_id": 34685555,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Flexor carpi ulnaris The flexor carpi ulnaris is a primary adductor of the hand at the wrist joint. It originates from the medial epicondyle of the humerus and inserts into the pisiform, hook of hamate, and base of the fifth metacarpal. Its function includes flexion and adduction (ulnar deviation) of the wrist. By pulling the hand medially towards the ulnar side, it performs the action of adduction effectively. Incorrect Responses: (A) Brachioradialis The brachioradialis is primarily a flexor of the elbow joint. It does not act on the wrist joint and plays no role in wrist movements, including adduction. (C) Extensor digitorum The extensor digitorum is primarily responsible for extension of the fingers and contributes to wrist extension. However, it does not have any function related to adduction of the wrist.",
    "correct_choice_id": 200005,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/54820381697960004/54820381697960004.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/54820381697960004/54820381697960004.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50002,
    "choices": [
      {
        "id": 200008,
        "text": "The space around the hypothenar muscles"
      },
      {
        "id": 200009,
        "text": "The synovial sheath for the flexor pollicis longus tendon"
      },
      {
        "id": 200010,
        "text": "The ulnar bursa"
      },
      {
        "id": 200011,
        "text": "The space around the muscles of the thenar eminence"
      }
    ],
    "text": "A patient is found to have pus in the midpalmar space. The space is -",
    "unique_key": "Q8468269",
    "question_audio": null,
    "question_video": null,
    "map_id": 34878257,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) The space around the hypothenar muscles The midpalmar space is an anatomical fascial compartment located in the palm. It lies beneath the palmar aponeurosis and is bordered by the hypothenar muscles, the flexor tendons of the fingers, and the interosseous muscles. Infections, such as an accumulation of pus, can occur here due to direct injury or spread from other areas like the flexor tendon sheaths. This space is significant because it provides a potential pathway for infections to spread from the hand into the forearm. Since the space is associated with the hypothenar muscles, this makes option (A) the correct answer. Incorrect Responses: (B) The synovial sheath for the flexor pollicis longus tendon The synovial sheath for the flexor pollicis longus tendon is known as the radial bursa, which is separate from the midpalmar space. Although infections of the radial bursa can occur, they are anatomically distinct from the midpalmar space. (C) The ulnar bursa The ulnar bursa surrounds the flexor tendons of the fingers and is closely related to the carpal tunnel. While infections can involve the ulnar bursa, it is not synonymous with the midpalmar space and is a separate structure. (D) The space around the muscles of the thenar eminence The thenar space surrounds the muscles of the thenar eminence, which are responsible for thumb movements. This space is anatomically distinct from the midpalmar space and is not involved in infections or pus accumulation in the midpalmar region.",
    "correct_choice_id": 200008,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/63144931697960018/63144931697960018.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/63144931697960018/63144931697960018.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50003,
    "choices": [
      {
        "id": 200012,
        "text": "Median Nerve"
      },
      {
        "id": 200013,
        "text": "Flexor pollicis longus"
      },
      {
        "id": 200014,
        "text": "Flexor carpi radialis"
      },
      {
        "id": 200015,
        "text": "Flexor digitorum superficialis"
      }
    ],
    "text": "The carpal tunnel contains all of the following important structures except",
    "unique_key": "Q5666838",
    "question_audio": null,
    "question_video": null,
    "map_id": 34942796,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Flexor carpi radialis. The flexor carpi radialis muscle does not pass through the carpal tunnel. Instead, it passes outside the carpal tunnel, lying in a separate compartment within the wrist. The tendon of the flexor carpi radialis travels through a separate sheath, not the carpal tunnel, which is primarily occupied by structures responsible for flexion of the fingers and thumb. Incorrect Responses: A. Median Nerve: The median nerve is one of the key structures that passes through the carpal tunnel. It innervates several important muscles in the hand, including the thenar muscles, and provides sensory innervation to the palmar side of the thumb, index, middle, and part of the ring fingers. Compression of the median nerve in the carpal tunnel can lead to carpal tunnel syndrome. B. Flexor pollicis longus: The tendon of the flexor pollicis longus, which is responsible for flexing the thumb, passes through the carpal tunnel. It is one of the tendons that help facilitate movements of the thumb, and it is included in the structures passing through the carpal tunnel. D. Flexor digitorum superficialis: The tendons of the flexor digitorum superficialis also pass through the carpal tunnel. This muscle plays an important role in flexing the middle phalanges of the fingers, and its tendons travel through the carpal tunnel alongside those of the flexor digitorum profundus and flexor pollicis longus.",
    "correct_choice_id": 200014,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/67038421697960888/67038421697960888.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/67038421697960888/67038421697960888.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50004,
    "choices": [
      {
        "id": 200016,
        "text": "Adductor pollicis"
      },
      {
        "id": 200017,
        "text": "Opponens pollicis"
      },
      {
        "id": 200018,
        "text": "Abductor pollicis brevis"
      },
      {
        "id": 200019,
        "text": "Flexor digitorum profundus"
      }
    ],
    "text": "Which of the following muscle is supplied by deep branch of the ulnar nerve",
    "unique_key": "Q6739772",
    "question_audio": null,
    "question_video": null,
    "map_id": 34649211,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Adductor Pollicis The adductor pollicis is supplied by the deep branch of the ulnar nerve. This muscle is located in the hand and has two heads: the transverse and oblique heads. It plays a crucial role in adducting the thumb, bringing it closer to the palm or fingers. The deep branch of the ulnar nerve is responsible for innervating most of the intrinsic muscles of the hand, including the adductor pollicis, making this the correct answer. Incorrect Options: (B) Opponens Pollicis The opponens pollicis is supplied by the recurrent branch of the median nerve, not the deep branch of the ulnar nerve. This muscle is involved in opposition of the thumb, a movement critical for grasping and manipulating objects. (C) Abductor Pollicis Brevis The abductor pollicis brevis is also innervated by the recurrent branch of the median nerve. This muscle abducts the thumb at the carpometacarpal and metacarpophalangeal joints and does not receive any innervation from the ulnar nerve. (D) Flexor Digitorum Profundus The flexor digitorum profundus is partially innervated by the ulnar nerve, but it is not supplied by the deep branch. Instead, the medial half of this muscle (responsible for flexion of the fourth and fifth digits) is innervated by the ulnar nerve, while the lateral half (for the second and third digits) is supplied by the anterior interosseous branch of the median nerve. It is not an intrinsic hand muscle and therefore does not receive innervation from the deep branch of the ulnar nerve.",
    "correct_choice_id": 200016,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/35745641697961065/35745641697961065.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/35745641697961065/35745641697961065.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50005,
    "choices": [
      {
        "id": 200020,
        "text": "Radial artery"
      },
      {
        "id": 200021,
        "text": "Tendon of abductor pollicis longus"
      },
      {
        "id": 200022,
        "text": "Tendon of extensor pollicis brevis"
      },
      {
        "id": 200023,
        "text": "Scaphoid bone"
      },
      {
        "id": 200024,
        "text": "Superficial cutaneous branch of radial nerve"
      }
    ],
    "text": "Which of the following is the main content of the anatomical snuffbox?",
    "unique_key": "Q6466215",
    "question_audio": null,
    "question_video": null,
    "map_id": 34250802,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Radial Artery The radial artery is the primary content of the anatomical snuffbox. The snuffbox is a triangular depression on the lateral aspect of the wrist, formed by the tendons of the abductor pollicis longus, extensor pollicis brevis (anterior boundary), and extensor pollicis longus (posterior boundary). The floor of the snuffbox is made up of the scaphoid and trapezium bones, and the radial artery passes through this space as it continues to supply the hand. The pulse of the radial artery can often be palpated in the snuffbox, making it clinically significant. Incorrect Options: (B) Tendon of Abductor Pollicis Longus The tendon of the abductor pollicis longus forms the lateral boundary of the anatomical snuffbox but is not considered a content of the snuffbox itself. It is part of the extensor mechanism of the thumb but lies outside the snuffbox's triangular depression. (C) Tendon of Extensor Pollicis Brevis The tendon of the extensor pollicis brevis runs alongside the tendon of the abductor pollicis longus and also forms the lateral boundary of the snuffbox. However, like the abductor pollicis longus, it is not part of the snuffbox contents but contributes to its anatomical borders. (D) Scaphoid Bone The scaphoid bone forms part of the floor of the anatomical snuffbox along with the trapezium bone. While it is an important structure palpated clinically in cases of suspected scaphoid fracture, it is not a content of the snuffbox in the sense of the structures passing through it. (E) Superficial Cutaneous Branch of Radial Nerve The superficial branch of the radial nerve runs superficially across the anatomical snuffbox, providing sensory innervation to the skin in this area. While it is closely associated with the snuffbox, it does not pass through its central depression and is thus not considered a primary content.",
    "correct_choice_id": 200020,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/39372411697961134/39372411697961134.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/39372411697961134/39372411697961134.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50006,
    "choices": [
      {
        "id": 200025,
        "text": "Extensor pollicis brevis"
      },
      {
        "id": 200026,
        "text": "Extensor carpi radialis longus"
      },
      {
        "id": 200027,
        "text": "Extensor carpi radialis brevis"
      },
      {
        "id": 200028,
        "text": "Extensor digiti minimi"
      }
    ],
    "text": "First extensor compartment of wrist have which of the following structures",
    "unique_key": "Q1726338",
    "question_audio": null,
    "question_video": null,
    "map_id": 34813841,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Extensor Pollicis Brevis The first extensor compartment of the wrist contains the extensor pollicis brevis tendon, along with the abductor pollicis longus tendon. This compartment is located on the radial side of the wrist and is responsible for movements related to the thumb, specifically thumb extension and abduction. The extensor pollicis brevis helps extend the thumb at the metacarpophalangeal joint. Therefore, option (A) is the correct answer. Incorrect Options: (B) Extensor Carpi Radialis Longus The extensor carpi radialis longus tendon lies in the second extensor compartment, not the first. It is involved in wrist extension and radial deviation, but it does not pass through the first extensor compartment. Thus, option (B) is incorrect. (C) Extensor Carpi Radialis Brevis The extensor carpi radialis brevis tendon also lies in the second extensor compartment, along with the extensor carpi radialis longus. Like the longus, it is involved in wrist extension and radial deviation but is not a part of the first extensor compartment, making option (C) incorrect. (D) Extensor Digiti Minimi The extensor digiti minimi tendon passes through the fifth extensor compartment, not the first. It is responsible for extending the little finger (fifth digit), and its tendon is found in a separate compartment from those of the thumb.",
    "correct_choice_id": 200025,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/7154111697961194/7154111697961194.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/7154111697961194/7154111697961194.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50007,
    "choices": [
      {
        "id": 200029,
        "text": "Deep branch of ulnar nerve"
      },
      {
        "id": 200030,
        "text": "Superficial branch of ulnar nerve"
      },
      {
        "id": 200031,
        "text": "Median nerve"
      },
      {
        "id": 200032,
        "text": "Radial nerve"
      }
    ],
    "text": "First dorsal interosseous muscle of hand is supplied by",
    "unique_key": "Q2920353",
    "question_audio": null,
    "question_video": null,
    "map_id": 34557240,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Deep Branch of Ulnar Nerve The first dorsal interosseous muscle of the hand is innervated by the deep branch of the ulnar nerve. This muscle is one of the intrinsic muscles of the hand and plays a key role in the abduction of the index finger (moving it away from the middle finger). The deep branch of the ulnar nerve supplies most of the intrinsic muscles of the hand, including the dorsal interossei, which are responsible for finger movements like abduction and adduction. Incorrect Options: (B) Superficial Branch of Ulnar Nerve The superficial branch of the ulnar nerve provides sensory innervation to the palm of the hand and the medial aspect of the little finger and half of the ring finger. It does not innervate any muscles, including the first dorsal interosseous muscle. Therefore, option (B) is incorrect. (C) Median Nerve The median nerve supplies the muscles of the thenar eminence (such as the opponens pollicis) and some of the flexors in the forearm. However, it does not innervate the dorsal interossei muscles, which are supplied by the ulnar nerve. Therefore, option (C) is incorrect. (D) Radial Nerve The radial nerve is responsible for the innervation of the extensor muscles of the forearm and hand, as well as sensation to the posterior aspects of the arm and hand. It does not supply any intrinsic hand muscles, including the dorsal interossei. Thus, option (D) is incorrect.",
    "correct_choice_id": 200029,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/5460401697961207/5460401697961207.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/5460401697961207/5460401697961207.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50008,
    "choices": [
      {
        "id": 200033,
        "text": "Capitate"
      },
      {
        "id": 200034,
        "text": "Scaphoid"
      },
      {
        "id": 200035,
        "text": "Triquitral"
      },
      {
        "id": 200036,
        "text": "Pisiform"
      }
    ],
    "text": "First primary ossification centre to appear of carpal bones is",
    "unique_key": "Q3838327",
    "question_audio": null,
    "question_video": null,
    "map_id": 34358306,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Capitate The capitate is the first carpal bone to develop a primary ossification center, making A. Capitate the correct answer. The ossification of carpal bones follows a specific sequence, and the capitate, located centrally in the carpal region, ossifies first. This process begins around the third month of fetal development, making it a significant marker in skeletal maturation. Its early ossification is crucial for the subsequent development and organization of the carpal bones. Incorrect options: B. Scaphoid: The scaphoid, a carpal bone located on the radial side of the wrist, is one of the last carpal bones to ossify. Its primary ossification center appears around 4\u20135 years of age, significantly later than the capitate. C. Triquetral: The triquetral, located on the ulnar side of the wrist, ossifies after the capitate and hamate. Its primary ossification center typically appears around 2\u20133 years of age, making it later than the capitate. D. Pisiform: The pisiform is the last carpal bone to ossify, with its primary ossification center appearing around 9\u201312 years of age. Its late ossification is due to its role as a sesamoid bone within the tendon of the flexor carpi ulnaris.",
    "correct_choice_id": 200033,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/36442561697961906/36442561697961906.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/36442561697961906/36442561697961906.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50009,
    "choices": [
      {
        "id": 200037,
        "text": "Adductor pollicis"
      },
      {
        "id": 200038,
        "text": "Flexor pollicis brevis"
      },
      {
        "id": 200039,
        "text": "Opponens pollicis"
      },
      {
        "id": 200040,
        "text": "Abductor pollicis brevis"
      }
    ],
    "text": "Which one of the following muscles of thumb is not supplied by median nerve ?",
    "unique_key": "Q6427383",
    "question_audio": null,
    "question_video": null,
    "map_id": 34582486,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Adductor pollicis The adductor pollicis muscle is not supplied by the median nerve, making A. Adductor pollicis the correct answer. The adductor pollicis is supplied by the deep branch of the ulnar nerve. This muscle, which has two heads (oblique and transverse), plays a critical role in adducting the thumb toward the palm, allowing for a strong grip. Since it is entirely innervated by the ulnar nerve, it is excluded from the muscles of the thumb that receive innervation from the median nerve. Incorrect options: B. Flexor pollicis brevis: This muscle has two heads: the superficial head, which is supplied by the median nerve, and the deep head, which is supplied by the ulnar nerve. However, the portion primarily associated with the median nerve places it under its domain for the purposes of thumb movement. C. Opponens pollicis: The opponens pollicis muscle is entirely supplied by the recurrent branch of the median nerve. It is crucial for the opposition of the thumb, a defining feature of human hand function. D. Abductor pollicis brevis: This muscle is also supplied by the recurrent branch of the median nerve. It abducts the thumb, moving it away from the hand\u2019s midline, and is involved in precision grip.",
    "correct_choice_id": 200037,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/32346381697961918/32346381697961918.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/32346381697961918/32346381697961918.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50010,
    "choices": [
      {
        "id": 200041,
        "text": "Triquetral"
      },
      {
        "id": 200042,
        "text": "Lunate"
      },
      {
        "id": 200043,
        "text": "Scaphoid"
      },
      {
        "id": 200044,
        "text": "Trapezoid"
      }
    ],
    "text": "Pisiform bone articulates with? (DNB)",
    "unique_key": "Q6866351",
    "question_audio": null,
    "question_video": null,
    "map_id": 34941296,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) riquetral The pisiform bone articulates with the triquetral bone, making A. Triquetral the correct answer. The pisiform is a small, pea-shaped sesamoid bone located within the tendon of the flexor carpi ulnaris muscle. It is positioned on the ulnar side of the wrist, forming part of the proximal row of carpal bones. Its only articulation is with the triquetral bone, which lies directly beneath it. This articulation is a synovial joint that contributes to the stability and function of the wrist. Incorrect options: B. Lunate: The lunate is a crescent-shaped carpal bone that articulates with the radius proximally and other carpal bones such as the scaphoid and triquetral laterally. However, it does not directly articulate with the pisiform. C. Scaphoid: The scaphoid is a boat-shaped carpal bone located on the radial side of the wrist. It articulates with the radius, lunate, and trapezium but does not have any direct connection to the pisiform. D. Trapezoid: The trapezoid is a distal carpal bone located on the radial side of the wrist. It articulates with the scaphoid, trapezium, capitate, and the base of the second metacarpal. The trapezoid is anatomically distant from the pisiform and does not articulate with it.",
    "correct_choice_id": 200041,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/40204181697961935/40204181697961935.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/40204181697961935/40204181697961935.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50011,
    "choices": [
      {
        "id": 200045,
        "text": "Adductor space"
      },
      {
        "id": 200046,
        "text": "Midpalmar space"
      },
      {
        "id": 200047,
        "text": "Thenar space"
      },
      {
        "id": 200048,
        "text": "Hypothenar space"
      }
    ],
    "text": "First lumbrical canal communicates with?",
    "unique_key": "Q7235337",
    "question_audio": null,
    "question_video": null,
    "map_id": 34012246,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Thenar space The first lumbrical canal communicates with the thenar space, making C. Thenar space the correct answer. The lumbrical canals are tubular structures associated with the lumbrical muscles of the hand. The first lumbrical canal, associated with the first lumbrical muscle, is positioned between the flexor pollicis longus tendon and the flexor tendons of the index finger. It has direct communication with the thenar space, a compartment of the palm located adjacent to the thumb, bounded by the thenar muscles. This communication is clinically significant in the spread of infections or fluids within the hand. Incorrect options: A. Adductor space: The adductor space (or adductor compartment) is located on the ulnar side of the hand, containing the adductor pollicis muscle. It does not have a direct anatomical connection with the first lumbrical canal, so this option is incorrect. B. Midpalmar space: The midpalmar space lies more centrally in the palm and is located closer to the ulnar side of the hand. It communicates with the lumbrical canals of the middle, ring, and little fingers but not the first lumbrical canal, which is specific to the index finger. D. Hypothenar space: The hypothenar space is located on the ulnar side of the palm, containing the muscles that control the little finger. It does not communicate with the first lumbrical canal, making this option incorrect.",
    "correct_choice_id": 200047,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/8282381697961972/8282381697961972.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/8282381697961972/8282381697961972.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50012,
    "choices": [
      {
        "id": 200049,
        "text": "Posterior"
      },
      {
        "id": 200050,
        "text": "Anterior"
      },
      {
        "id": 200051,
        "text": "Laterally rotated"
      },
      {
        "id": 200052,
        "text": "Medially rotated"
      }
    ],
    "text": "In relation to other metacarpals, the first metacarpal is ?",
    "unique_key": "Q7892667",
    "question_audio": null,
    "question_video": null,
    "map_id": 34859126,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Medially rotated. The first metacarpal (thumb) is medially rotated in comparison to the other metacarpals. This rotation is a key characteristic that allows the thumb to have a wide range of motion, especially during functions like opposition. The first metacarpal is positioned differently from the second to fifth metacarpals, which are aligned more or less in a straight line in the palm. This medial rotation of the first metacarpal is crucial for the thumb's ability to oppose the fingers and perform gripping tasks.",
    "correct_choice_id": 200052,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/76132141697962010/76132141697962010.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/76132141697962010/76132141697962010.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50013,
    "choices": [
      {
        "id": 200053,
        "text": "Interossei"
      },
      {
        "id": 200054,
        "text": "Lumbricals"
      },
      {
        "id": 200055,
        "text": "Extensor digitorum"
      },
      {
        "id": 200056,
        "text": "Adductor pollicis"
      }
    ],
    "text": "Which muscle does not take part in dorsal digital expansion \u2013",
    "unique_key": "Q9765061",
    "question_audio": null,
    "question_video": null,
    "map_id": 34500438,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Adductor pollicis. The dorsal digital expansion (also called the extensor hood) is a fibrous structure on the dorsal side of the fingers. It serves as an attachment for tendons of the extensor digitorum, lumbricals, and interossei muscles, allowing coordinated movement of the fingers during extension and flexion. The adductor pollicis, however, is not involved in the dorsal digital expansion because it is a muscle of the thumb that functions primarily to adduct the thumb toward the palm. The thumb does not have a dorsal digital expansion like the other digits, making this the correct answer. Evaluation of Each Option: A. Interossei Correct The interossei muscles (both dorsal and palmar) attach to the extensor hood of the fingers and contribute to the dorsal digital expansion. They assist in fine movements such as abduction, adduction, and coordinated extension of the fingers at the interphalangeal joints, making this option part of the dorsal digital expansion. B. Lumbricals Correct The lumbrical muscles also insert into the extensor hood of the fingers and play a role in flexion of the metacarpophalangeal (MCP) joints while simultaneously extending the interphalangeal (IP) joints. Their contribution to the dorsal digital expansion is crucial for balanced finger movement, so this option is also correct. C. Extensor digitorum Correct The tendons of the extensor digitorum muscle form the foundation of the dorsal digital expansion. They directly insert into the extensor hood and are responsible for extending the MCP, proximal interphalangeal (PIP), and distal interphalangeal (DIP) joints. This makes the extensor digitorum an essential part of the dorsal digital expansion.",
    "correct_choice_id": 200056,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/13891011697962533/13891011697962533.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/13891011697962533/13891011697962533.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50014,
    "choices": [
      {
        "id": 200057,
        "text": "APL"
      },
      {
        "id": 200058,
        "text": "EPL"
      },
      {
        "id": 200059,
        "text": "EPB"
      },
      {
        "id": 200060,
        "text": "ECU"
      }
    ],
    "text": "Bounderies of anatomical snuff box are all except",
    "unique_key": "Q3213257",
    "question_audio": null,
    "question_video": null,
    "map_id": 34372232,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) ECU (Extensor Carpi Ulnaris). The ECU is not a boundary of the anatomical snuff box. The anatomical snuff box is a triangular depression on the lateral aspect of the wrist, and its boundaries are formed by tendons of certain muscles. The ECU, however, lies on the medial side of the wrist and does not contribute to the boundaries of the snuff box. Incorrect Responses: A. APL (Abductor Pollicis Longus): The APL forms the lateral (radial) border of the anatomical snuff box. It is one of the muscles responsible for the abduction of the thumb and plays a key role in defining the snuff box's boundary. B. EPL (Extensor Pollicis Longus): The EPL forms the medial (ulnar) border of the anatomical snuff box. It is responsible for extending the thumb, and its tendon lies along the medial edge of the snuff box. C. EPB (Extensor Pollicis Brevis): The EPB forms the proximal border of the anatomical snuff box. It lies just lateral to the EPL and works to extend the thumb, playing a role in the formation of the snuff box boundary.",
    "correct_choice_id": 200060,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/34122141697962610/34122141697962610.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/34122141697962610/34122141697962610.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50015,
    "choices": [
      {
        "id": 200061,
        "text": "Palmaris longus"
      },
      {
        "id": 200062,
        "text": "FCR"
      },
      {
        "id": 200063,
        "text": "Lumbricals"
      },
      {
        "id": 200064,
        "text": "Adductor pollicis"
      }
    ],
    "text": "Which muscle originates from tendon of other muscle",
    "unique_key": "Q7889197",
    "question_audio": null,
    "question_video": null,
    "map_id": 34905730,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Lumbricals. The lumbricals are unique muscles because they originate from the tendons of the flexor digitorum profundus (FDP) muscle in the forearm. Specifically, each lumbrical originates from the tendon of the FDP of the corresponding finger, and then they insert into the extensor mechanism of the finger. This muscle is involved in flexing the metacarpophalangeal (MCP) joints while extending the interphalangeal (IP) joints. Incorrect Responses: A. Palmaris longus: The palmaris longus originates from the medial epicondyle of the humerus, not from the tendon of another muscle. It passes down the forearm to insert into the palmar aponeurosis, and its primary function is to tense the aponeurosis and assist in wrist flexion. B. FCR (Flexor Carpi Radialis): The FCR originates from the medial epicondyle of the humerus, similar to the palmaris longus, and it inserts into the base of the second and third metacarpals. It is responsible for flexing and abducting the wrist. It does not originate from the tendon of another muscle. D. Adductor pollicis: The adductor pollicis is a muscle of the hand that originates from the second and third metacarpals and the capitate bone. It is responsible for the adduction of the thumb. Like the other options, it does not originate from the tendon of another muscle.",
    "correct_choice_id": 200063,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/78161921697962650/78161921697962650.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/78161921697962650/78161921697962650.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50016,
    "choices": [
      {
        "id": 200065,
        "text": "Lumbricals"
      },
      {
        "id": 200066,
        "text": "Dorsal interossei"
      },
      {
        "id": 200067,
        "text": "Palmar interossei"
      },
      {
        "id": 200068,
        "text": "All of the above"
      }
    ],
    "text": "Flexion of metacarpophalangeal joint is produced by",
    "unique_key": "Q6961791",
    "question_audio": null,
    "question_video": null,
    "map_id": 34626163,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) All of the above. Flexion of the metacarpophalangeal (MCP) joint is produced by a combination of the lumbricals, dorsal interossei, and palmar interossei muscles. These muscles work together to flex the MCP joint while extending the interphalangeal (IP) joints, allowing for fine motor control of the fingers. The lumbricals are responsible for flexing the MCP joint and extending the IP joints. They are unique in their action because they originate from the tendons of the flexor digitorum profundus and insert into the extensor mechanism of the fingers. The dorsal interossei also contribute to flexion at the MCP joint. They are primarily responsible for abducting the fingers but also play a role in flexing the MCP joint. The palmar interossei are responsible for adducting the fingers but, similar to the dorsal interossei, they also help in flexing the MCP joint. Thus, all of these muscles play a role in the flexion of the MCP joint, making D. All of the above the correct answer.",
    "correct_choice_id": 200068,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/34902601697962661/34902601697962661.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/34902601697962661/34902601697962661.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50017,
    "choices": [
      {
        "id": 200069,
        "text": "Pneumatic bone"
      },
      {
        "id": 200070,
        "text": "Sesamoid bone"
      },
      {
        "id": 200071,
        "text": "Accessory bone"
      },
      {
        "id": 200072,
        "text": "Long bone"
      }
    ],
    "text": "Pisiform is which type of bone",
    "unique_key": "Q7051169",
    "question_audio": null,
    "question_video": null,
    "map_id": 34114179,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Sesamoid bone. The pisiform is classified as a sesamoid bone, which is a type of bone that forms within a tendon. Sesamoid bones typically develop in areas of high mechanical stress, where they help reduce friction and modify pressure, enhancing the mechanical efficiency of the tendon. The pisiform is located within the tendon of the flexor carpi ulnaris muscle in the wrist, and it plays a role in increasing the leverage of the tendon during wrist movements. Incorrect Responses: A. Pneumatic bone: A pneumatic bone contains air spaces or cavities, such as the bones of the skull, like the maxilla and frontal bones. These bones help reduce the weight of the skull and are not related to the structure of the pisiform, which does not have air spaces. C. Accessory bone: Accessory bones are extra bones that develop in certain anatomical locations but are not present in all individuals. These bones are typically variations and do not serve the same structural function as sesamoid bones. The pisiform is not an accessory bone but a specialized sesamoid bone within the flexor carpi ulnaris tendon. D. Long bone: Long bones are characterized by a shaft (diaphysis) and two ends (epiphyses), such as the femur or humerus. The pisiform does not have this structure and does not qualify as a long bone. Instead, it is a small, round bone embedded in a tendon.",
    "correct_choice_id": 200070,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/15668831697962772/15668831697962772.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/15668831697962772/15668831697962772.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50018,
    "choices": [
      {
        "id": 200073,
        "text": "Saddle"
      },
      {
        "id": 200074,
        "text": "Hinge"
      },
      {
        "id": 200075,
        "text": "Ball and socket"
      },
      {
        "id": 200076,
        "text": "Pivot"
      }
    ],
    "text": "Carpometacarpal joint of thumb is -",
    "unique_key": "Q3439908",
    "question_audio": null,
    "question_video": null,
    "map_id": 34471584,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Saddle. The carpometacarpal (CMC) joint of the thumb is classified as a saddle joint. This type of joint allows for a wide range of movement, including flexion, extension, abduction, adduction, and opposition (touching the thumb to the fingertips). The saddle shape of the joint is formed by the articulation between the trapezium bone of the wrist and the first metacarpal bone of the thumb, where both the bones have complementary convex and concave surfaces. This unique structure allows for the thumb's highly versatile movements. Incorrect Responses: B. Hinge: A hinge joint permits movement primarily in one plane, such as flexion and extension. It is seen in joints like the elbow or knee, but the CMC joint of the thumb allows for more complex movements (like opposition), which cannot be performed by a hinge joint. Therefore, this type of joint is not the correct classification for the thumb's CMC joint. C. Ball and socket: A ball and socket joint allows for movement in multiple directions, including rotation. Examples include the shoulder and hip joints. While the thumb's CMC joint is quite mobile, it does not allow for the full range of motion characteristic of a ball and socket joint, such as rotational movement, which makes this option incorrect. D. Pivot: A pivot joint allows for rotational movement around a single axis, as seen in the atlantoaxial joint of the neck. The CMC joint of the thumb does not provide this type of rotational movement but instead allows for more complex motions like opposition, making it inappropriate to classify it as a pivot joint.",
    "correct_choice_id": 200073,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/38962731697962805/38962731697962805.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/38962731697962805/38962731697962805.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50019,
    "choices": [
      {
        "id": 200077,
        "text": "Long us Palmaris"
      },
      {
        "id": 200078,
        "text": "Long flexors"
      },
      {
        "id": 200079,
        "text": "Short flexors"
      },
      {
        "id": 200080,
        "text": "Lumbricals"
      }
    ],
    "text": "Power grip of hand is due to",
    "unique_key": "Q9868548",
    "question_audio": null,
    "question_video": null,
    "map_id": 34403790,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Long flexors. The long flexors of the hand, including the flexor digitorum superficialis and flexor digitorum profundus, are primarily responsible for the power grip of the hand. These muscles allow for strong flexion of the fingers and are essential for gripping large or heavy objects. They enable the hand to exert force, providing a firm grasp by flexing the fingers at the proximal and distal interphalangeal joints, often with the assistance of the intrinsic hand muscles. Incorrect Responses: A. Longus Palmaris: The palmaris longus muscle, when present, acts as a weak flexor of the wrist and tenses the palmar aponeurosis but is not a major contributor to the power grip. It does not play a significant role in flexing the fingers or generating force for gripping objects. C. Short flexors: The short flexors, such as the flexor pollicis brevis and the flexor digiti minimi, are involved in fine motor tasks and some flexion of individual fingers but do not contribute as strongly to the power grip. The power grip relies more on the long flexor muscles that provide stronger and broader flexion of the fingers. D. Lumbricals: The lumbricals are intrinsic hand muscles that contribute to fine motor control and the flexion of the metacarpophalangeal joints while extending the interphalangeal joints. However, they are not involved in generating the strength required for the power grip, which primarily relies on the long flexor muscles.",
    "correct_choice_id": 200078,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/50674971697962816/50674971697962816.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/50674971697962816/50674971697962816.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50020,
    "choices": [
      {
        "id": 200081,
        "text": "2"
      },
      {
        "id": 200082,
        "text": "3"
      },
      {
        "id": 200083,
        "text": "4"
      },
      {
        "id": 200084,
        "text": "5"
      }
    ],
    "text": "Total number of dorsal interossei",
    "unique_key": "Q5129024",
    "question_audio": null,
    "question_video": null,
    "map_id": 34586456,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) 4. The hand has four dorsal interossei muscles, which are located between the metacarpal bones. These muscles are responsible for the abduction of the fingers (moving fingers away from the midline of the hand) and also play a role in flexing the metacarpophalangeal joints and extending the interphalangeal joints. The four dorsal interossei are crucial for fine motor control and hand dexterity.",
    "correct_choice_id": 200083,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/62958901697962878/62958901697962878.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/62958901697962878/62958901697962878.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50021,
    "choices": [
      {
        "id": 200085,
        "text": "Abduction"
      },
      {
        "id": 200086,
        "text": "Adduction"
      },
      {
        "id": 200087,
        "text": "Flexion"
      },
      {
        "id": 200088,
        "text": "Extension"
      }
    ],
    "text": "The following marked muscle causes-<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/12(381).jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q8123413",
    "question_audio": null,
    "question_video": null,
    "map_id": 34191287,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A-Abduction is caused by Abductor pollicis brevis and longus. Option B-The following marked muscle is adductor pollicis,hence it will take part in adduction. Option C-Flexion is caused by flexor pollicis brevis and longus. Option D-Extension is caused by extensor pollicis longus and brevis.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/6(585).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200086,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/37161941698506510/37161941698506510.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/37161941698506510/37161941698506510.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50022,
    "choices": [
      {
        "id": 200089,
        "text": "Extensor digitorum"
      },
      {
        "id": 200090,
        "text": "Abductor pollicis brevis"
      },
      {
        "id": 200091,
        "text": "Interossei and lumbricals"
      },
      {
        "id": 200092,
        "text": "Abductor pollicis longus"
      }
    ],
    "text": "A patient presented with the extension of the MCP joint and flexion of IP. Which muscle is affected?",
    "unique_key": "Q6967625",
    "question_audio": null,
    "question_video": null,
    "map_id": 34385593,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Option A-Extensor digitorum performs Extension of MCP,IP and wrist joint. Option B-Abductor pollicis brevis does abduction at thumb. Option C-Interossei and lumbricals perform the action of flexion at MCP joint and extension at IP joint.therefore,in cases of palsy of Interossei and lumbricals,patient will present with the extension of the MCP joint and flexion of IP joint. Option D-Abductor pollicis longus also does abduction at thumb..<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/25(224).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200091,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/35406091698505234/35406091698505234.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/35406091698505234/35406091698505234.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50023,
    "choices": [
      {
        "id": 200093,
        "text": "Index finger"
      },
      {
        "id": 200094,
        "text": "Little finger"
      },
      {
        "id": 200095,
        "text": "Middle finger"
      },
      {
        "id": 200096,
        "text": "Ring finger"
      }
    ],
    "text": "Which of the following finger is having two dorsal interossei muscles:",
    "unique_key": "Q2746054",
    "question_audio": null,
    "question_video": null,
    "map_id": 34171929,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Dorsal interossei is Absent in thumb & little finger. Middle finger has 2 dorsal interossei but doesn\u2019t have any palmar interossei.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/44_1(28).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200095,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/44378191701776270/44378191701776270.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/44378191701776270/44378191701776270.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50024,
    "choices": [
      {
        "id": 200097,
        "text": "2nd Dorsal interossei"
      },
      {
        "id": 200098,
        "text": "2nd Palmar interossei"
      },
      {
        "id": 200099,
        "text": "Lumbricals"
      },
      {
        "id": 200100,
        "text": "Extensor digitorum"
      }
    ],
    "text": "Which of the following muscles do not contribute to the marked tendon:<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/45(102).jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q4522753",
    "question_audio": null,
    "question_video": null,
    "map_id": 34537454,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Interossei muscles,lumbricals are inserted in dorsal digital expansion which is an expanded tendon of Extensor digitorum.Middle finger has 2 dorsal interossei,lumbricals but doesn\u2019t have any palmar interossei.",
    "correct_choice_id": 200098,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50025,
    "choices": [
      {
        "id": 200101,
        "text": "Opponens pollicis"
      },
      {
        "id": 200102,
        "text": "Abductor pollicis brevis"
      },
      {
        "id": 200103,
        "text": "Flexor pollicis longus"
      },
      {
        "id": 200104,
        "text": "First palmar interossei"
      }
    ],
    "text": "Identify the marked muscle<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/52(91).jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q2632712",
    "question_audio": null,
    "question_video": null,
    "map_id": 34023500,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Option A-The opponens pollicis muscle is one of the three thenar muscles. It originates from the flexor retinaculum of the hand and the tubercle of the trapezium. It passes downward and laterally, and is inserted into the whole length of the metacarpal bone of the thumb on its radial side as shown in picture. Option B-for Abductor pollicis brevis,Two smaller origins are located on carpal bones; the first is found on the tubercle of scaphoid while the second is on the tubercle of trapezium bone. After originating from these locations, the muscle fibers form a single muscle belly that runs distally and radially (lateral) towards the thumb. Option C-Flexor pollicis longus comes all the way from forearm to be inserted on base of 1st metacarpal. Option D-First palmar interossei arises from medial palmar surface of the first metacarpal.",
    "correct_choice_id": 200101,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/27054831701776402/27054831701776402.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/27054831701776402/27054831701776402.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50026,
    "choices": [
      {
        "id": 200105,
        "text": "1st Lumbrical"
      },
      {
        "id": 200106,
        "text": "1st Interossei"
      },
      {
        "id": 200107,
        "text": "Flexor Hallucis Brevis"
      },
      {
        "id": 200108,
        "text": "Abductor Hallucis"
      }
    ],
    "text": "Which of the following muscle is supplied by Lateral plantar nerve ?",
    "unique_key": "Q4194206",
    "question_audio": null,
    "question_video": null,
    "map_id": 34294153,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A,C,D-Medial plantar nerve supplies 4 intrinsic muscles of sole. These are abductor hallucis, flexor digitorum brevis, flexor hallucis brevis and 1st lumbrical. Option B-1st Interossei is supplied by Lateral plantar nerve.Rest of muscles of sole are supplied by Lateral plantar nerve.",
    "correct_choice_id": 200106,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50027,
    "choices": [
      {
        "id": 200109,
        "text": "Flexor pollicis brevis"
      },
      {
        "id": 200110,
        "text": "Opponens pollicis"
      },
      {
        "id": 200111,
        "text": "Abductor pollicis brevis"
      },
      {
        "id": 200112,
        "text": "Dorsal Interossei"
      }
    ],
    "text": "A man came to OPD who can't close button of his shirt and can't make O sign, which of the following muscle is paralysed.",
    "unique_key": "Q6196660",
    "question_audio": null,
    "question_video": null,
    "map_id": 34461731,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) A man who can't close button of his shirt and can't make O sign indicates palsy of Abductor pollicis brevis,supplied by median nerve. Abductor pollicis brevis muscle is the most lateral and superficial of the three muscles forming the thenar eminence. Origin It takes its origin from the front of transverse carpal ligament, extending into the tubercles of scaphoid and trapezium. Insertion The muscle has a short tendon which attaches to the radial side of the base of the proximal phalanx of the thumb.",
    "correct_choice_id": 200111,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/32208051725256720/32208051725256720.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/32208051725256720/32208051725256720.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50028,
    "choices": [
      {
        "id": 200113,
        "text": "Wrist drop"
      },
      {
        "id": 200114,
        "text": "Loss of finger extension"
      },
      {
        "id": 200115,
        "text": "Inability to extend elbow"
      },
      {
        "id": 200116,
        "text": "Inability to abduct fingers"
      }
    ],
    "text": "Which of the following features will be seen in case of posterior interosseous nerve injury.",
    "unique_key": "Q8078340",
    "question_audio": null,
    "question_video": null,
    "map_id": 34534027,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A-Wrist drop do not occur in case of posterior interosseous nerve injury,as brachioradialis and ECRL are spared. Option B-Loss of finger extension occur in case of posterior interosseous nerve injury. Option C-Inability to extend elbow do not occur as triceps is spared. Option D-Inability to abduct little fingers occur in ulnar nerve injury.",
    "correct_choice_id": 200114,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/36386181731674896/36386181731674896.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/36386181731674896/36386181731674896.m3u8",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '25  Hand';
        const quizFilename = '25-hand-1aff7c93.html';
        let hierarchy = ["DAMS", "DQB", "Anatomy"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on navigation
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>