<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>178 Dermatology Ini-Cet 2023 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Dermatology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">13</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A patient on Anti PD1 immunotherapy(Nivolumab) comes with pruritus, eczema, and urticarial rashes. Histopathological examination reveals a subepidermal blister. The direct Immunofluorescence of the lesions showed Linear C3 and IgG on the basement membrane. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pemphigus vulgaris"
      },
      {
        "id": 2,
        "text": "Bullous pemphigoid"
      },
      {
        "id": 3,
        "text": "Dermatitis herpetiformis"
      },
      {
        "id": 4,
        "text": "Pemphigus foliaceous"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Option D-Pemphigus foliaceous</strong> shows <strong>antidesmoglein-3</strong> antibodies, <strong>anti-desmocollin</strong> antibodies and a <strong>predominance</strong> of <strong>anti-desmoglein-1</strong> antibodies.&nbsp;Lack of mucosal involvement in pemphigus foliaceous, where anti-desmoglein-1 antibodies are prominent, is due to the&nbsp;<strong>low expression of desmoglein 1</strong> in the <strong>mucosa.</strong>&nbsp;In pemphigus vulgaris, where anti-desmoglein-3 antibodies are prominent, mucosal involvement is extensive in early stages as <strong>desmoglein</strong> <strong>3</strong> is abundantly present in the mucosa.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/75e3113d9e6349af963733a2482e82b2x800x1066.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4cc656298b3a4f73a90f0df583bb05a8x384x218.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2691ca23e5424b91a33862186dd7d646x800x1066.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36f8ba3f8011493fb3be9a3650d07aebx720x472.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68496a060b3d4f839103073ae151a71dx1280x1128.JPEG"
    ]
  },
  {
    "text": "A 24 year old young male presented with asymptomatic scaly lesions over back, symmetrical in distribution. Images of the lesions are given, Identify the disease and the pattern of lesions",
    "choices": [
      {
        "id": 1,
        "text": "Collaratte scale-Christmas tree pattern-Pityriasis rosea"
      },
      {
        "id": 2,
        "text": "Wickhams striae-Lichen planus"
      },
      {
        "id": 3,
        "text": "Christmas tree pattern-Lichen planus"
      },
      {
        "id": 4,
        "text": "Wornoff ring-Seborrhic dermatitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A <strong>hypopigmented ring</strong> surrounding individual <strong>psoriatic lesions</strong> is known as the&nbsp;<strong>Woronoff ring</strong>.It is usually associated with treatment, most commonly UV radiation or topical corticosteroids. The pathogenesis of the Woronoff ring is not well understood, but may result from the&nbsp;<strong>inhibition of prostaglandin synthesis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/709d652820054944a49f2aeeaab7150f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/99c41098ef54406e99d0a037b5a11820x720x809.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/30525885dedd4dee8c96f532f46fb26dx1280x916.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17b775fc716c47078f551f0980e3f688x720x1278.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/73416486fb0445bc8b990c8da3cd75adx720x872.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/57b66b3416864a1db76ab8862cb7e1e5x1280x1027.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a5d1608b0638491684314a0743170059x150x150.JPEG"
    ]
  },
  {
    "text": "Statement 1: Histopathological examination of a patient with Flaccid bulla and painful erosions showing suprabasal blister and inflammatory infiltrate in the blister cleft.\nStatement 2: The row of tombstones appearance is diagnostic of Pemphigus vulgaris.",
    "choices": [
      {
        "id": 1,
        "text": "Statement 1 is false and Statement 2 is true"
      },
      {
        "id": 2,
        "text": "Statement 1 is true and Statement 2 is false"
      },
      {
        "id": 3,
        "text": "Both the statements are true but 2 is not the conclusion of 1"
      },
      {
        "id": 4,
        "text": "Both the statements are true but 2 is the conclusion of 1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Other investigations\u00a0include a <strong>Tzanck smear</strong> showing <strong>acantholytic cells</strong>. Anti-Dsg <strong>ELISA assays</strong> can be used to monitor the disease activity.</p>\n<p><strong>Systemic corticosteroids</strong> are the <strong>mainstay</strong> of treatment for controlling the disease, improving the quality of life and reducing disease activity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/44836fa9df094deab7c35b5ec0a196b3x1279x1302.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea55e6373d764d269353c4a3eb06d31ax510x502.GIF"
    ]
  },
  {
    "text": "Identify the following lines in dermatology",
    "choices": [
      {
        "id": 1,
        "text": "Hinderer lines"
      },
      {
        "id": 2,
        "text": "Marionettes line"
      },
      {
        "id": 3,
        "text": "Relaxed skin tension lines"
      },
      {
        "id": 4,
        "text": "Blaschko lines"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Hinderer's lines</strong> are 2 intersecting lines&mdash;one drawn from the ala to the tragus and the other from the oral commissure to the lateral canthus.</p>\n<p>Option B:&nbsp;Melomental folds, or<strong> marionette lines,</strong> are one of the consequences of facial aging. The curvilinear wrinkles form because of facial movements and the aging process extend downward from the oral commissures.</p>\n<p>Option C: <strong>Relaxed skin tension lines</strong> run perpendicular to the direction of contraction of the underlying muscles and parallel to the dermal collagen bundles.To produce favourable aesthetic results, incisions should generally be designed to follow rhytids or the relaxed skin tension lines as the resulting scars will be stronger and less likely to stretch.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/055d3b1a028b43b88159db401cee118c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ce151a2dee6423483304b1e2fdaf5d9x1200x1654.JPEG"
    ]
  },
  {
    "text": "Match the following wood lamp findings with the disease",
    "choices": [
      {
        "id": 1,
        "text": "1-a,2-c,3-d,4-b"
      },
      {
        "id": 2,
        "text": "1-e,2-c,3-d,4-b"
      },
      {
        "id": 3,
        "text": "1-e,2-d,3-c,4-b"
      },
      {
        "id": 4,
        "text": "1-a,2-d,3-c,4-b"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct match is</p>\n<ol>\n<li>Erythrasma &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e)Coral red fluorescence</li>\n<li>Pityriasis versicolor &nbsp; c)Yellow fluorescence</li>\n<li>Tinea Capitis &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;d)Blue fluorescence &nbsp;</li>\n<li>Vitiligo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;b)Milky white florescence</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Consider the causes of alopecia. Which among the following cause(s) non-scarring alopecia?",
    "choices": [
      {
        "id": 1,
        "text": "3 and 4"
      },
      {
        "id": 2,
        "text": "1, 2, and 3"
      },
      {
        "id": 3,
        "text": "2, 3, and 4"
      },
      {
        "id": 4,
        "text": "Only 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Non-scarring alopecia is caused by androgenic alopecia, alopecia areata, and telogen effluvium (1, 2 and 3).&nbsp;&nbsp;<strong>Frontal fibrosing alopecia</strong> is&nbsp;a type of <strong>primary cicatricial (scarring) alopecia.</strong></p>\n<p><strong>Alopecia areata&nbsp;</strong>is a chronic inflammatory disease that causes&nbsp;<strong>non-scarring hair loss</strong>.&nbsp;It is a&nbsp;<strong>T-cell-mediated inflammatory disease.&nbsp;</strong>It is associated with several autoimmune diseases, including&nbsp;<strong>thyroiditis</strong>, lupus erythematosus<strong>,</strong>&nbsp;vitiligo, and psoriasis. It mainly affects the&nbsp;<strong>scalp,&nbsp;</strong>but can also affect the&nbsp;<strong>beard, eyebrows,&nbsp;</strong>and<strong>&nbsp;eyelashes.&nbsp;</strong>In some cases, this progresses to a total loss of scalp hair&nbsp;<strong>(alopecia totalis)</strong>&nbsp;or a loss of all hair on the body<strong>&nbsp;(alopecia universalis)</strong>.</p>\n<p><strong>Telogen effluvium</strong>&nbsp;is a type of<strong>&nbsp;nonscarring alopecia</strong>&nbsp;that is marked by&nbsp;<strong>diffuse</strong>&nbsp;<strong>shedding</strong>&nbsp;of normal hair. This occurs due to&nbsp;<strong>premature termination</strong>&nbsp;of the anagen phase of the hair cycle.&nbsp; It can be either acute or chronic.&nbsp;</p>\n<ul>\n<li><strong>Acute telogen effluvium</strong>&nbsp;occurs<strong>&nbsp;2&ndash;3 months</strong>&nbsp;after a stressful event such as high&nbsp;<strong>fever</strong>,&nbsp;<strong>surgery</strong>, starvation, and hemorrhage. Hormonal fluctuations during the&nbsp;<strong>postpartum</strong>&nbsp;period can trigger it (<strong>telogen gravidarum</strong>). Telogen effluvium can result in a diffuse reduction in hair density but never total baldness. It generally&nbsp;<strong>resolves</strong>&nbsp;<strong>spontaneously</strong>.&nbsp;</li>\n<li><strong>Chronic telogen effluvium</strong> is used to describe the diffuse shedding of telogen hair for more than<strong>&nbsp;6 months</strong>. Common causes include&nbsp;<strong>thyroid disorders</strong>, iron-deficiency anemia, and malnutrition.&nbsp;</li>\n</ul>\n<p><strong>Androgenetic alopecia </strong>is&nbsp;a disorder characterized by a reduction of hair fiber production by follicles and miniaturization. <strong>Dihydrotestosterone</strong>, an androgenic metabolite, is implicated in the etiology. It is of two types: male-pattern and female-pattern hair loss.&nbsp;Male-pattern hair loss causes <strong>frontal hairline recession</strong> and thinning of the <strong>vertex</strong>.&nbsp;&nbsp;Female-pattern hair loss involves the <strong>mid-frontal scalp</strong> diffusely. There is no or minimal involvement of the temporal region.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A farmer from Tamil Nadu presents with fever, body ache, and cough for 3 days. Lab studies showed thrombocytopenia. On examination, a black lesion is present, as in the picture below. IgM scrub typhus-positive. What drug will be used in the management?",
    "choices": [
      {
        "id": 1,
        "text": "Doxycyline"
      },
      {
        "id": 2,
        "text": "Ceftriaxone"
      },
      {
        "id": 3,
        "text": "Ceftriaxone+Doxycycline"
      },
      {
        "id": 4,
        "text": "Doxycycline + Azithromycin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above clinical scenario and the image show an <strong>eschar</strong> at the bite site along with positive IgM\u00a0of\u00a0<strong>scrub typhus\u00a0</strong>caused by\u00a0<em><strong>Orientia</strong>\u00a0<strong>tsutsugamushi</strong></em>\u00a0and<em><strong>\u00a0</strong></em>transmitted by\u00a0<strong>trombiculid mite.\u00a0</strong>As per a study published in 2023, <strong>Doxycycline</strong> and <strong>Azithromycin combined</strong> therapy was found to be <strong>superior</strong> to <strong>Doxycycline monotherapy.</strong></p>\n<p><strong><span data-preserver-spaces=\"true\">Scrub Typhus\u00a0</span></strong><span data-preserver-spaces=\"true\">is also known as chigger-borne typhus, which is caused by <strong>Orientia tsutsugamushi</strong>. The vector is trombiculid mite. Humans are infected when they are bitten by the mite larvae known as\u00a0</span><strong><span data-preserver-spaces=\"true\">chiggers.\u00a0</span></strong><span data-preserver-spaces=\"true\">The incubation period is 1- 3 weeks. The patient typically develops a characteristic<strong>\u00a0eschar</strong>\u00a0at the site of the mite bite, with\u00a0</span><strong><span data-preserver-spaces=\"true\">regional lymphadenopathy</span></strong><span data-preserver-spaces=\"true\">\u00a0and\u00a0<strong>maculopapular rash</strong>.</span></p>\n<p>Diagnosis is by serologic assays.\u00a0</p>\n<p>Treatment is with a combination therapy of <strong>azithromycin</strong> and <strong>doxycycline.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f0676423edc1475f84e388f409503633.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young male complains of an itchy rash over his back as seen below. What is the most likely sign and diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Collarette scale-pityriasis rosea"
      },
      {
        "id": 2,
        "text": "Wickham's striae - lichen planus"
      },
      {
        "id": 3,
        "text": "Woronoff's sign - psoriasis"
      },
      {
        "id": 4,
        "text": "Christmas tree appearance - psoriasis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p><strong>Pityriasis rosea\u00a0</strong>is the most likely diagnosis in this patient presenting with christmas tree lesions, and will likely have <strong>collarette scales.</strong></p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p>The image given below shows collarette scales.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/30525885dedd4dee8c96f532f46fb26dx1280x916.JPEG\" width=\"323\" height=\"231\" /></div>\n</div>\n</div>\n<p>Pityriasis rosea/pityriasis circinata/roseola annulata is an\u00a0<strong>acute self-limiting papulosquamous</strong>\u00a0disorder. It is commonly seen in\u00a0<strong>children</strong>\u00a0and\u00a0<strong>young adults</strong>.</p>\n<p>Clinical features include:</p>\n<ul>\n<li><strong>Prodrome</strong>\u00a0of a sore throat, gastrointestinal disturbance, fever or arthralgia.</li>\n<li><strong>Herald patch</strong>\u00a0- Large and conspicuous eruptions on the thigh, upper arm, trunk or neck covered by\u00a0<strong>fine scales</strong></li>\n</ul>\n<p>The image given below shows a herald patch.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/99c41098ef54406e99d0a037b5a11820x720x809.JPEG\" width=\"245\" height=\"276\" /></div>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<ul>\n<li>After 5-15 days, it turns into discrete oval lesions, dull pink in color and covered by fine dry\u00a0<strong>silvery-grey scales</strong>.\u00a0</li>\n<li>These\u00a0<strong>secondary lesions</strong>\u00a0occur as macules and papules that are elliptical or ovular, symmetric, and commonly involve the\u00a0<strong>thorax,</strong>\u00a0<strong>back,\u00a0</strong>and<strong>\u00a0abdomen</strong>.</li>\n<li>It is followed by a\u00a0<strong>marginal collarette of scale</strong>\u00a0with a\u00a0<strong>central wrinkling\u00a0</strong>and\u00a0<strong>atrophy</strong>. The collarettes of the scales are attached peripherally. It is also called a\u00a0<strong>hanging curtain sign.</strong></li>\n<li>The long axes of the lesions characteristically follow the lines of skin tension parallel to the ribs in a\u00a0<strong>Christmas tree pattern</strong>\u00a0on the upper chest and back.</li>\n</ul>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\u00a0</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p>\u00a0The images given below show Christmas tree pattern along the lines of skin tension on the back and the chest.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/17b775fc716c47078f551f0980e3f688x720x1278.PNG\" width=\"251\" height=\"446\" /></div>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/73416486fb0445bc8b990c8da3cd75adx720x872.JPEG\" width=\"264\" height=\"320\" /></div>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p>The rashes of pityriasis rosea usually\u00a0<strong>resolve</strong>\u00a0by\u00a0<strong>8 weeks</strong>.</p>\n<p>Other options:</p>\n<p><strong>Lichen planus</strong>\u00a0is an idiopathic inflammatory skin disease affecting the skin and mucous membranes, often with a chronic course with relapses and periods of remission.Patients present with\u00a0<strong>pruritic, purple, polygonal, papules.</strong>\u00a0The lesions have\u00a0<strong>thin white lines</strong>\u00a0on their surface known as\u00a0<strong>Wickham\u2019s striae.\u00a0</strong>They are commonly seen on<strong>\u00a0</strong>the volar aspect of the\u00a0<strong>wrists, the lumbar region</strong>, and\u00a0<strong>around the ankles.</strong>The\u00a0<strong>mucosal involvemen</strong>t is seen. The commonest mucosal sites are buccal mucosa and tongue, rarely it can also be found on the anus and genitalia.\u00a0</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/57b66b3416864a1db76ab8862cb7e1e5x1280x1027.JPEG\" width=\"285\" height=\"229\" /></div>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p>A\u00a0<strong>hypopigmented ring</strong>\u00a0surrounding individual\u00a0<strong>psoriatic lesions</strong>\u00a0is known as the\u00a0<strong>Woronoff ring</strong>.It is usually associated with treatment, most commonly UV radiation or topical corticosteroids. The pathogenesis of the Woronoff ring is not well understood, but may result from the\u00a0<strong>inhibition of prostaglandin synthesis.</strong></p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/a5d1608b0638491684314a0743170059x150x150.JPEG\" /></div>\n</div>\n</div>\n<p data-sourcepos=\"21:1-21:165\">\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/81b387e94dfd45538fa14d0710070640.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "An overweight 12-year old girl has the following blackish discolouration on her neck, as shown below. What is this condition and its' association?",
    "choices": [
      {
        "id": 1,
        "text": "Acanthosis nigricans - Insulin resistance"
      },
      {
        "id": 2,
        "text": "Stria Albicans - Cushing syndrome"
      },
      {
        "id": 3,
        "text": "Xeroderma pigmentosum - Malignancy"
      },
      {
        "id": 4,
        "text": "Cafe au lait spots - McCune Albright syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The condition shown in the above image is likely\u00a0<strong>acanthosis nigricans </strong>- that is strongly associated with<strong> insulin resistance/hyperinsulinemia</strong></p>\n<p>Acanthosis nigricans is a darkening of the skin of the\u00a0<strong>intertriginous areas</strong>. The hyperpigmentation is generally velvety with poorly defined borders and thickening of the skin.\u00a0</p>\n<p>It can be grossly classified into benign and malignant.</p>\n<p><strong>Benign acanthosis nigricans</strong>\u00a0is associated with\u00a0<strong>obesity</strong>\u00a0or\u00a0<strong>insulin resistance</strong>.\u00a0<strong>Insulin resistance</strong>\u00a0is the most accepted hypothesis used to explain the pathophysiology of the condition. <strong>Elevated circulating fatty acids</strong> are considered a major factor in developing <strong>insulin resistance.</strong></p>\n<p><strong>Malignant\u00a0acanthosis nigricans</strong>\u00a0has a rapid onset and is characterized by symmetrical, hyperpigmented, rugose, velvety plaques. It affects the axillae and flexures, nape of the neck, and mucosal surfaces. If it occurs de novo and is associated with weight loss, malignancy should be suspected. Generalized pruritus and skin changes of tripe palms (acanthosis palmaris) are also associated with malignancy. Associated malignancies are generally <strong>GI or lung carcinomas</strong>. In malignancy, tumor cells are believed to produce transforming growth factor-alpha or cytokines that activate <strong>insulin-like growth factors</strong>.\u00a0</p>\n<p>Acanthosis nigricans can only be treated by treating the underlying disease. In addition, treatment specific to acanthosis nigricans is done for aesthetic reasons.\u00a0Medications like keratolytics, topical vitamin D, and melatonin can be used. Procedures like laser, dermabrasion, and chemical peels are also available.\u00a0</p>\n<p>Other options:</p>\n<p data-sourcepos=\"11:3-11:304\">Option B: <strong>Stria Albicans </strong>is a stretch mark that is white or pearly in color. It is most common in pregnant women and people who have gained or lost weight quickly. Stria Albicans is not associated with Cushing syndrome, which is a hormonal disorder caused by excess cortisol production and produces a strechy, purplish rash most commonly over the abdomen/flanks.</p>\n<p data-sourcepos=\"13:3-13:186\">Option C: <strong>Xeroderma pigmentosum - malignancy</strong> is a rare genetic disorder that makes the skin extremely sensitive to ultraviolet radiation from the sun. People with xeroderma pigmentosum have a greatly increased risk of developing skin cancer.</p>\n<p data-sourcepos=\"15:3-15:267\">Option D: <strong>Cafe au lait spots - McCune Albright syndrome</strong> is a genetic disorder that causes multiple light brown, oval-shaped birthmarks on the skin. It is also associated with other symptoms, such as precocious puberty and bone abnormalities - polyostotic fibrous dysplasias.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/09ad5fcd0a734f0bbf16911c4f6964fd.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following are cause(s) of non-scarring alopecia?",
    "choices": [
      {
        "id": 1,
        "text": "3 and 4"
      },
      {
        "id": 2,
        "text": "1, 2 and 3"
      },
      {
        "id": 3,
        "text": "2, 3 and 4"
      },
      {
        "id": 4,
        "text": "Only 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Non-scarring alopecia is caused by <strong>androgenic alopecia, alopecia areata, and telogen effluvium.</strong></p>\n<p><strong>Alopecia areata</strong></p>\n<p>It is a chronic inflammatory disease that causes\u00a0<strong>non-scarring hair loss</strong>.\u00a0It is a\u00a0<strong>T-cell-mediated inflammatory disease.\u00a0</strong>It is associated with several autoimmune diseases, including\u00a0<strong>thyroiditis</strong>, lupus erythematosus<strong>,</strong>\u00a0vitiligo, and psoriasis.</p>\n<p>It mainly affects the\u00a0<strong>scalp,\u00a0</strong>but can also affect the\u00a0<strong>beard, eyebrows,\u00a0</strong>and<strong>\u00a0eyelashes.\u00a0</strong>In some cases, this progresses to a total loss of scalp hair\u00a0<strong>(alopecia totalis)</strong>\u00a0or a loss of all hair on the body<strong>\u00a0(alopecia universalis)</strong>.</p>\n<p><strong>Telogen effluvium</strong>\u00a0</p>\n<p>It is a type of<strong>\u00a0nonscarring alopecia</strong>\u00a0that is marked by\u00a0<strong>diffuse</strong>\u00a0<strong>shedding</strong>\u00a0of normal hair. This occurs due to\u00a0<strong>premature termination</strong>\u00a0of the anagen phase of the hair cycle.\u00a0 It can be either acute or chronic.</p>\n<p><strong>Acute telogen effluvium</strong>\u00a0occurs<strong>\u00a02\u20133 months</strong>\u00a0after a stressful event such as high\u00a0<strong>fever</strong>,\u00a0<strong>surgery</strong>, starvation, and hemorrhage. Hormonal fluctuations during the\u00a0<strong>postpartum</strong>\u00a0period can trigger it (<strong>telogen gravidarum</strong>). Telogen effluvium can result in a diffuse reduction in hair density but never total baldness. It generally\u00a0<strong>resolves</strong>\u00a0<strong>spontaneously</strong>.</p>\n<p>Chronic telogen effluvium is used to describe the diffuse shedding of telogen hair for more than<strong>\u00a06 months</strong>. Common causes include\u00a0<strong>thyroid disorders</strong>, iron-deficiency anemia, and malnutrition.\u00a0</p>\n<p><strong>Androgenetic alopecia</strong></p>\n<p>It is a disorder characterized by a reduction of hair fiber production by follicles and miniaturization.\u00a0<strong>Dihydrotestosterone</strong>, an androgenic metabolite, is implicated in the etiology. It is of two types: male-pattern and female-pattern hair loss.\u00a0Male-pattern hair loss causes\u00a0<strong>frontal hairline recession</strong>\u00a0and thinning of the\u00a0<strong>vertex</strong>.\u00a0\u00a0Female-pattern hair loss involves the\u00a0<strong>mid-frontal scalp</strong>\u00a0diffusely. There is no or minimal involvement of the temporal region.</p>\n<p><strong>CICATRICIAL/SCARRING ALOPECIA: Frontal fibrosing alopecia</strong>\u00a0is a primary cicatrical condition that affects\u00a0<strong>post-menopausal women</strong>\u00a0in particular and frequently involves the eyebrows.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged Indian man came to your OPD with the lesion as shown in the image below. The most likely diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Squamous cell carcinoma"
      },
      {
        "id": 2,
        "text": "Basal cell carcinoma"
      },
      {
        "id": 3,
        "text": "Lupus vulgaris"
      },
      {
        "id": 4,
        "text": "Nevus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option C-\u00a0<strong>Lupus vulgaris</strong>\u00a0originates from an underlying focus of tuberculosis, typically in a bone, joint, or lymph node, or maybe from the hematogenous and lymphatic spread. It presents as a\u00a0<strong>slowly enlarging plaque</strong>\u00a0with an\u00a0<strong>elevated border</strong>\u00a0and\u00a0<strong>central atrophy</strong>. The edges of the lesion gradually extend in some areas and\u00a0<strong>heal with scarring</strong>\u00a0in others. In India, the buttocks, and trunk are more frequently involved.\u00a0<strong>Apple jelly nodules</strong>\u00a0are demonstrated on\u00a0<strong>diascopy.</strong></p>\n<p>Option D: <strong>Nevus</strong> are aggregates of melanocytes at the dermis or dermo-epidermal junction. It can get transformed into <strong>malignant melanoma</strong> and the features suggestive of malignant transformation are a <strong>change </strong>in<strong> size, shape, color, thickness, satellite lesions,</strong> and<strong> tingling/ itching/serosanguinous discharge.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2b2cb68f342b42aeb75412ad9a8c5369.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dcf6f993722443c89245666de81247f6x1280x1131.JPEG"
    ]
  },
  {
    "text": "A patient with several skin lesions undergoes an investigation and an image of it is shown below. What is this test?",
    "choices": [
      {
        "id": 1,
        "text": "Indirect immunofluorescence"
      },
      {
        "id": 2,
        "text": "Direct immunofluorescence"
      },
      {
        "id": 3,
        "text": "Immunohistochemistry"
      },
      {
        "id": 4,
        "text": "Fluorescent in-situ hybridization"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p><strong>Direct immunofluorescence test,\u00a0</strong>that is shown above,\u00a0is the most accurate test to diagnose\u00a0<strong>Pemphigus Vulgaris.</strong></p>\n<p>Direct Immunofluorescence uses\u00a0<strong>anti-IgG antibodies</strong>\u00a0which detects the\u00a0<strong>anti-desmoglein IgG antibodies</strong>\u00a0deposited on the\u00a0<strong>Desmosomes</strong>. These desmosomes are present at cell junctions; this leads to\u00a0<strong>the fishnet pattern.</strong></p>\n<p>\u00a0</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/2dea83b13d534a539f8fd2364f482fbax1280x1302.JPEG\" width=\"316\" height=\"322\" /></div>\n</div>\n</div>\n<p data-sourcepos=\"5:1-5:40\"><strong>Direct immunofluorescence (DIF)</strong> is a type of immunofluorescence that is used to diagnose autoimmune blistering diseases, such as pemphigus. In DIF, antibodies are applied directly to a skin biopsy specimen. If the patient has pemphigus, the antibodies will bind to the desmosomes, which are the proteins that hold skin cells together. This binding will produce a <strong>fish net pattern</strong> of fluorescence under a microscope.</p>\n<p data-sourcepos=\"5:1-5:40\">Other options:</p>\n<div class=\"dynamic-carousel-wrapper\">\u00a0</div>\n<p data-sourcepos=\"9:1-9:356\"><strong>Indirect immunofluorescence (IIF)</strong> is a type of immunofluorescence that is used to diagnose autoimmune diseases. In IIF, antibodies are first applied to a patient's serum, and then the serum is applied to a skin biopsy specimen. The presence of antibodies in the patient's serum will cause the skin biopsy specimen to fluoresce under a microscope. Seen below is a centromeric pattern on IF in Sjogren's disease -1 and Diffuse/homogenous staining in SLE - 2.</p>\n<div class=\"h-400-scroll\"><img class=\"img-fluid hover-max ng-star-inserted\" src=\"https://cdn1.dailyrounds.org/uploads/e0fc86891ae04c4d82faf1715c1eb9e5.JPEG\" width=\"194\" height=\"162\" /></div>\n<div class=\"h-400-scroll\"><img class=\"img-fluid hover-max ng-star-inserted\" src=\"https://cdn1.dailyrounds.org/uploads/fa1f4030997f450da48bdd83a38333f4.JPEG\" width=\"192\" height=\"177\" /></div>\n<p class=\"table-responsive font-weight-light ng-star-inserted\">\u00a0<strong>Immunohistochemistry</strong> is a type of microscopy technique used to visualize the presence of specific proteins/receptors in cells or tissues. It uses antibodies that are labeled with enzymes or fluorescent dyes to bind to specific antigens. An example is receptor identification in breast cancer specimens.</p>\n<p><strong><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/2644a3a7e0ce4bf38e37ad36d717dd33x243x199.JPEG\" width=\"199\" height=\"163\" /></strong></p>\n<p><strong class=\"ng-binding\">Fluorescent In Situ Hybridisation (FISH)\u00a0</strong>is a simple technique for the detection of specific DNA sequences in cells/tissues.\u00a0It uses fluorescent labeled probes to bind to complementary DNA\u00a0FISH can be performed on\u00a0<strong>prenatal samples</strong>, peripheral blood cells, touch preparations from cancer biopsies, and even fixed archival tissue sections.\u00a0It is used to detect</p>\n<ul>\n<li><strong>numeric abnormalities</strong>\u00a0of chromosomes (aneuploidy)</li>\n<li>subtle\u00a0<strong>microdeletions\u00a0</strong>and<strong>\u00a0rearrangements</strong>.</li>\n<li>complex\u00a0<strong>translocations</strong>\u00a0that are not demonstrable by routine karyotyping</li>\n<li><strong>gene amplification</strong>\u00a0(e.g., HER2 in breast cancer or NMYC amplification in neuroblastomas)</li>\n</ul>\n<div class=\"h-400-scroll\">\u00a0</div>\n<div class=\"h-400-scroll\">\u00a0</div>\n<div class=\"h-400-scroll\"><img class=\"img-fluid hover-max ng-star-inserted\" src=\"https://cdn1.dailyrounds.org/uploads/2ecba17c26f241c7bf76c518456d5847.PNG\" width=\"211\" height=\"162\" /></div>\n<div class=\"ng-star-inserted\">\u00a0</div>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/81f6346f191846deae42aceff190426a.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presents with vesicles and oral lesions. Histopathological examination reveals suprabasal split. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Varicella"
      },
      {
        "id": 2,
        "text": "IgA disease"
      },
      {
        "id": 3,
        "text": "Pemphigus vulgaris"
      },
      {
        "id": 4,
        "text": "Pemphigus foliaceous"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p data-sourcepos=\"24:1-24:25\">The image given shows the\u00a0<strong>row of tombstone</strong>\u00a0appearance seen in <strong>Pemphigus vulgaris.</strong></p>\n<p data-sourcepos=\"26:1-26:521\">Pemphigus vulgaris is an autoimmune blistering disease caused by the deposition of IgG antibodies against desmoglein 3, a protein that holds skin cells together. It is characterized by widespread flaccid bullae, which are large, fluid-filled blisters that rupture easily. The lesions typically start on the trunk and spread to the extremities. Oral lesions are common in pemphigus vulgaris. Histologically, pemphigus vulgaris is characterized by a suprabasal split with acantholysis (loss of cohesion between skin cells).</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<p><strong>Acantholysis</strong>\u00a0and\u00a0<strong>cell apoptosis</strong>\u00a0are the key pathological processes in pemphigus. Histological changes include:</p>\n<ul>\n<li><strong>Intercellular oedema</strong>\u00a0with\u00a0<strong>loss of intercellular attachments</strong>\u00a0in the basal layer is the\u00a0<strong>earliest change</strong></li>\n<li><strong>Suprabasal epidermal cells</strong>\u00a0<strong>separate\u00a0</strong>from the basal cells to form clefts and blisters.</li>\n<li><strong>Basal cells remain attached</strong>\u00a0to the basement membrane, in a \u2018<strong>row of tombstones</strong>\u2019 on the floor of the blister.</li>\n<li>Blister cavities contain rounded\u2010up\u00a0<strong>acantholytic cells,\u00a0</strong>also seen in\u00a0<strong>Tzank smears.</strong></li>\n</ul>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/ed4e77fca98b4009bfd32dce648d120bx510x502.GIF\" width=\"253\" height=\"249\" /></div>\n<div class=\"h-400-scroll mb-2 ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll answer-html ng-star-inserted\">\n<table style=\"width: 936px;\" border=\"1\">\n<tbody>\n<tr>\n<th style=\"width: 149px;\">Type of pemphigus</th>\n<th style=\"width: 280px;\">Cutaneous distribution</th>\n<th style=\"width: 197.273px;\">Mucosal involvement</th>\n<th style=\"width: 278.727px;\">Lesions</th>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Pemphigus<br />vulgaris</td>\n<td style=\"width: 280px;\">- Scalp, face, chest, upper trunk<br />- May be generalised</td>\n<td style=\"width: 197.273px;\">\n<div class=\"page\" title=\"Page 2\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Oro\u2010pharynx, conjunctiva, genital</p>\n</div>\n</div>\n</div>\n</div>\n\u00a0</td>\n<td style=\"width: 278.727px;\">\n<div class=\"page\" title=\"Page 2\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Flaccid blisters<br />- Erosions<br />- Flexural vegetations</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Pemphigus<br />vegetans</td>\n<td style=\"width: 280px;\">- Flexural aspects</td>\n<td style=\"width: 197.273px;\">\n<div class=\"page\" title=\"Page 2\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 2\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Oro\u2010pharynx, conjunctiva, genital</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 278.727px;\">\n<div class=\"page\" title=\"Page 2\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>- Vegetating plaques<br />- Vesicles<br />- Pustules<br />- Erosions</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Pemphigus<br />foliaceous</td>\n<td style=\"width: 280px;\">- Scalp, face, chest, upper back, seborrheic areas<br />- May be generalised\u00a0</td>\n<td style=\"width: 197.273px;\">- None\u00a0</td>\n<td style=\"width: 278.727px;\">- Scaly papules<br />- Crusted erosions<br />- Erythroderma\u00a0</td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Paraneoplastic<br />pemphigus\u00a0</td>\n<td style=\"width: 280px;\">- Upper body<br />- Palmoplantar\u00a0</td>\n<td style=\"width: 197.273px;\">- Severe mucositis</td>\n<td style=\"width: 278.727px;\">- Polymorphous bullae<br />- Erosions<br />- Target lesions</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p><strong>IgA disease (Linear IgA bullous dermatosis):</strong>\u00a0Autoimmune blistering disease caused by the deposition of IgA antibodies at the dermal-epidermal junction. It is characterized by vesicles and bullae, which are large, fluid-filled blisters. The lesions typically start on the trunk and spread to the extremities. Oral lesions are not common in IgA disease. Histologically, IgA disease is characterized by a suprabasal split with linear IgA deposition at the dermal-epidermal junction.\u00a0<strong>Anti-transglutaminase</strong>\u00a0antibodies are positive in\u00a0<strong>dermatitis herpetiformis</strong>. Patients present with erythematous papules and vesicles on the extensor aspect of elbows, knees, buttocks, and scalp. Histopathology demonstrates\u00a0<strong>subepidermal blister</strong>\u00a0formation with neutrophils located at the tips of the dermal papillae. Direct immunofluorescence will reveal the\u00a0<strong>deposition of IgA</strong>\u00a0in the papillary dermis in a granular or fibrillar pattern.</p>\n<p data-sourcepos=\"18:1-18:50\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/ad2094c1fa814382bc7d05005eafa535x720x552.PNG\" width=\"245\" height=\"188\" /></p>\n<p><strong>Pemphigus foliaceus</strong></p>\n<p data-sourcepos=\"32:1-32:118\">Pemphigus foliaceus is an autoimmune blistering disease caused by the deposition of IgG antibodies against <strong>desmoglein 1</strong>, a protein that holds skin cells together. It is characterized by <strong>superficial</strong>, <strong>flaccid</strong> bullae that are prone to rupture and erosion. The lesions typically start on the face and scalp and then spread to the trunk and extremities. Oral lesions are not common in pemphigus foliaceus. Histologically,<span class=\"animating\"> pemphigus foliaceus is characterized by a <strong>subcorneal</strong> <strong>split</strong> with acantholysis and minimal inflammation.</span></p>\n<p>The image given below shows the lesions seen in pemphigus foliaceous.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/e106ff7de11d458fb1291e2d7f6716a3x1280x1128.JPEG\" width=\"267\" height=\"235\" /></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"dynamic-carousel-wrapper\">\u00a0</div>\n<p data-sourcepos=\"18:1-18:50\">\u00a0</p>\n<div class=\"dynamic-carousel-wrapper\">\u00a0</div>\n<p data-sourcepos=\"26:1-26:521\">\u00a0</p>\n<div class=\"dynamic-carousel-wrapper\">\u00a0</div>\n<p data-sourcepos=\"32:1-32:118\">\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4281750ff9f645d7af75d18c305fbffb.PNG"
    ],
    "explanation_images": []
  }
];
        let quizName = '178 Dermatology Ini-Cet 2023';
        let hierarchy = ["Marrow", "PYQs", "Dermatology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>