<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 24 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following structures is related to the area marked as A in the given image below?",
    "choices": [
      {
        "id": 1,
        "text": "Superior vena cava"
      },
      {
        "id": 2,
        "text": "Azygos vein"
      },
      {
        "id": 3,
        "text": "Arch of aorta"
      },
      {
        "id": 4,
        "text": "Left brachiocephalic vein"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The cadaveric image shown is of the&nbsp;<strong>left lung</strong>.&nbsp;The&nbsp;<strong>arch of aorta&nbsp;</strong>is related to the area marked as A in the given image.&nbsp;</p>\n<p>The left lung is divided into superior and inferior lobes by the<strong> oblique fissure</strong>. The <strong>pulmonary root</strong> connects the <strong>medial surface</strong> of the <strong>lung</strong> to the <strong>heart </strong>and <strong>trachea</strong>. It is formed by structures that enter or leave the hilum. The left root is present inferior to the <strong>arch </strong>of the<strong> aorta.</strong></p>\n<p>The vertical sequence of structures at the <strong>left hilum</strong> from above to below is:</p>\n<ul>\n<li>Pulmonary artery</li>\n<li>Principal (hyparterial) bronchus, and</li>\n<li>Inferior pulmonary vein</li>\n</ul>\n<p>The arrangement of the lung hilar structures from the <strong>anterior </strong>to <strong>posterior</strong> in the order is:</p>\n<ul>\n<li>Pulmonary vein</li>\n<li>Pulmonary artery</li>\n<li>Primary bronchus</li>\n<li>Bronchial artery</li>\n</ul>\n<p>The cadaveric image given below shows the structures related to the hilum of the<strong> left lung</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/69360e50ab1744b1849384393e486ba0.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/21255dcd62d04bcba92d99113cda60f9x1200x1125.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc6a9c97cc2a445a9c8798575557ce75x1280x1053.PNG"
    ]
  },
  {
    "text": "On examination of a newborn, you notice that the baby is hypotonic, has a high forehead, large anterior fontanelle, markedly separated cranial sutures, and hepatomegaly. Imaging reveals renal cysts. Investigations reveal elevated levels of very-long-chain fatty acids,  abnormal intermediates of bile acid synthesis, and deficiency of plasmalogens. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Zellweger syndrome"
      },
      {
        "id": 2,
        "text": "Refsum disease"
      },
      {
        "id": 3,
        "text": "Adrenoleukodystrophy"
      },
      {
        "id": 4,
        "text": "Rhizomelic chondrodysplasia punctata"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical features of <strong>hypotonia, dysmorphic facial features, hepatomegaly, renal cysts</strong> and<strong> accumulation </strong>of<strong>\u00a0very-long-chain fatty acids</strong>, abnormal intermediates of bile acid synthesis, with a\u00a0<strong>deficiency</strong> of <strong>plasmalogens</strong> are suggestive of <strong>Zellweger syndrome</strong>. It<strong>\u00a0</strong>is<strong> also known</strong>\u00a0as <strong>cerebrohepatorenal syndrome\u00a0</strong></p>\n<p>It is caused by <strong>mutations</strong> in the\u00a0<strong>PEX</strong>\u00a0family of genes. As a result of this, there is a defective transport of the proteins from the cytosol to the peroxisomes. It severely impairs the functions of peroxisomes resulting in defective beta-oxidation of very-long-chain fatty acids (VLCFA), defective alpha oxidation, and impaired synthesis of bile acids and plasmalogens.</p>\n<p>The child presents with</p>\n<ul>\n<li><strong>Dysmorphic facial features</strong> like wide anterior fontanelles markedly separated cranial sutures, epicanthal folds, etc</li>\n<li>Profound <strong>developmental delay</strong></li>\n<li><strong>Hepatomegaly</strong></li>\n<li><strong>Renal cysts</strong></li>\n<li><strong>Chondrodysplasia punctata</strong>- calcific stippling of the patellae, hips, and other epiphysis is seen in the majority of the patients.</li>\n</ul>\n<p>Biochemical findings will show<strong>\u00a0</strong>:</p>\n<ul>\n<li>accumulation of\u00a0<strong>very-long-chain fatty acids, phytanic acid</strong></li>\n<li>abnormalities of the synthesis of bile acids</li>\n<li>marked <strong>reduction of plasmalogens</strong></li>\n</ul>\n<p>There is no appropriate treatment for Zellweger syndrome. It is very severe and infants rarely survive beyond six months of age.</p>\n<p>Other options:</p>\n<p>Option B- <strong>Refsum disease</strong> is a disorder of <strong>alpha fatty acid oxidation</strong>. It occurs due to a defect in the enzyme phytanoyl-CoA hydroxylase (PAHX). It typically occurs in individuals between <strong>10-15 years</strong> and is characterized by\u00a0<strong>retinitis pigmentosa,\u00a0</strong><strong>anosmia,\u00a0</strong><strong>peripheral neuropathy,\u00a0</strong><strong>ichthyosis,\u00a0</strong>cardiac conduction defects. There are elevated CSF protein levels without an increase in cells.</p>\n<p>It can be diagnosed by <strong>elevated levels</strong> of <strong>phytanic acid</strong> and decreased activity of PAHX in the fibroblasts. <strong>VLCFA levels</strong> are <strong>norma</strong>l in this condition.</p>\n<p><strong>Infantile Refsums disease</strong>\u00a0presents at <strong>one to six months of age</strong> with severe developmental delay but generally <strong>without the dysmorphic features.</strong></p>\n<p>Option C- <strong>Neonatal adrenoleukodystrophy</strong> is a disorder of <strong>beta-oxidation</strong> that results in the accumulation of very-long-chain fatty acids (VLCFA) in all tissues. The abnormalities primarily affect the <strong>central nervous system</strong>, <strong>adrenal cortex</strong>, and <strong>Leydig cells</strong>.\u00a0The craniofacial appearance is dysmorphic, but less marked than Zellweger syndrome and consists primarily of <strong>mid-face hypoplasia</strong>. Patients typically have hepatomegaly but <strong>do not have</strong> <strong>renal microcysts</strong> or <strong>chondrodysplasia punctata.</strong></p>\n<p>Option D-\u00a0<strong>Rhizomelic chondrodysplasia punctata</strong> is also a disorder of peroxisomes. They also present with profound mental retardation and dysmorphic facies. The unique feature is that it primarily affects the proximal long bones resulting in <strong>severe short stature</strong>. They might also have congenital cataracts and ichthyosis.\u00a0<strong>VLCFA</strong> levels are <strong>not elevated</strong> in this condition.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 22-year-old male patient presents to the casualty following a road traffic accident. On examination, he has a contaminated wound in his right forearm.  He has received the full course of tetanus immunization and the last booster dose was at 15 years of age. Which of the following is advisable for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Wound care + TT single dose"
      },
      {
        "id": 2,
        "text": "Wound care + TT complete course"
      },
      {
        "id": 3,
        "text": "Wound care + TT single dose + Human tetanus immunoglobulin"
      },
      {
        "id": 4,
        "text": "Only wound care"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A male patient with a <strong>contaminated wound</strong> with a<strong> full course</strong> of tetanus immunization taken <strong>7 years back</strong> will come under <strong>category B</strong> of post-exposure prophylaxis for tetanus. Hence, he must be given proper <strong>wound care</strong> and one dose of <strong>tetanus toxoid</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old patient presents with facial redness as shown in the image. He also complains of burning and tingling sensation on the skin which increases on sunlight exposure and wind. The redness of the lesion increases when he consumes hot and spicy beverages and alcohol.  What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Acne rosacea"
      },
      {
        "id": 2,
        "text": "Acne vulgaris"
      },
      {
        "id": 3,
        "text": "Melasma"
      },
      {
        "id": 4,
        "text": "Systemic lupus erythematosus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-preserver-spaces=\"true\">The given image shows</span><strong><span data-preserver-spaces=\"true\">&nbsp;erythema&nbsp;</span></strong><span data-preserver-spaces=\"true\">and&nbsp;</span><strong><span data-preserver-spaces=\"true\">papules</span></strong><span data-preserver-spaces=\"true\">&nbsp;on the&nbsp;</span><strong><span data-preserver-spaces=\"true\">central face</span></strong><span data-preserver-spaces=\"true\">, which along with a history of&nbsp;</span><strong><span data-preserver-spaces=\"true\">triggering factors</span></strong><span data-preserver-spaces=\"true\">&nbsp;like sunlight, wind, spicy food, and alcohol points towards a diagnosis of&nbsp;<strong>acne rosacea</strong>.</span></p>\n<p><span data-preserver-spaces=\"true\">Acne rosacea is a disorder that appears mainly in people within <strong>30 to 50 years of age.&nbsp;</strong>The lesions are mainly present on the <strong>convexities of the face.</strong>&nbsp;</span>There are mainly 4 subtypes:</p>\n<ul>\n<li><strong>Erythematotelangiectatic rosacea (ETTR):&nbsp;</strong>Patients complain of a gradual increase in facial redness. They mainly appear on the lateral cheeks, the ears, and sometimes the sides of the neck. This redness can be triggered by various factors like sunlight, wind, hot, spicy food, and alcohol.</li>\n<li><strong>Papulopustular rosacea (PPR):&nbsp;</strong>Patients complain of red bumps or pimples that are located principally on the proximal cheeks, central chin, nose, and central forehead</li>\n<li><strong>Phymatous rosacea (PR):&nbsp;</strong>Occurs in a patient with preexisting PPR. They complain of thickening of the distal nose with a prominence of pores.</li>\n<li><strong>Ocular rosacea (OR): </strong>Patients complain of dryness and gritty sensation in the eye.</li>\n</ul>\n<p>Other options:</p>\n<p>Option B- <strong>Acne vulgaris</strong> is commonly seen in <strong>adolescents.</strong> It is commonly seen in the <strong>face,</strong> but can also be present on the <strong>back and chest</strong>. The lesions may present as comedonal acne, papulopustular acne, nodular acne, etc.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/11f77acec58149af89fe2b26c75bbc23.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a6664033a7104239a633425f195a064fx800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8cd069158e4245b9bc2bec7ac9140333x399x454.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/becdb47f13db4639b6ec1fd3a8e630d5x607x453.JPEG"
    ]
  },
  {
    "text": "A young woman presented with a history of discharge from the left ear for the past 4 weeks, deep-seated ear pain for the past 1 week, and diplopia for the past 2 days. Her symptoms have progressed gradually over the past 4 weeks. Which of the following signs/syndrome is seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Griesinger sign"
      },
      {
        "id": 2,
        "text": "Gradenigo  syndrome"
      },
      {
        "id": 3,
        "text": "Grisel syndrome"
      },
      {
        "id": 4,
        "text": "Holman-Miller sign"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is a typical presentation of <strong>Gradenigo syndrome.&nbsp;</strong></p>\n<p>Patients with <strong>petrositis</strong> may present with Gradenigo syndrome. Gradenigo syndrome is a triad with the following symptoms:</p>\n<ul>\n<li><strong>Diplopia </strong>or double vision due to cranial nerve&nbsp;<strong>VI</strong>&nbsp; palsy</li>\n<li><strong>Facial pain</strong> or<strong> deep-seated ear pain</strong>&nbsp;due to cranial nerve <strong>V</strong> involvement</li>\n<li><strong>Persistent ear discharge</strong>&nbsp;due to otitis media</li>\n</ul>\n<p>The patient may also have a fever, headache, vomiting, and neck rigidity. The involvement of facial and statoacoustic nerves results in&nbsp;facial paralysis and recurrent vertigo respectively.</p>\n<p>Diagnosis of petrositis is done by a CT scan and MRI. <strong>CT scan</strong> of the<strong> temporal bone</strong>&nbsp;shows bony details of the air cells and petrous apex<strong>. MRI</strong> helps to detect the presence of fluid or pus.</p>\n<p>Treatment with suitable <strong>intravenous antibacterial therapy</strong> should precede and follow surgical intervention. Definitive management would include&nbsp;<strong>mastoidectomy.&nbsp;</strong></p>\n<p>Other options:</p>\n<p>Option A: <strong>Griesinger sign</strong> is<strong>&nbsp;edema over the mastoid</strong><strong>,</strong> which is secondary to the thrombosis of the <strong>mastoid emissary vein</strong>. It is seen in <strong>sigmoid sinus thrombosis.</strong></p>\n<p>Option C: <strong>Grisel syndrome</strong> refers to&nbsp;non-traumatic<strong> atlantoaxial joint dislocation</strong>. Patient presents with neck pain and torticollis.</p>\n<p>Option D: <strong>Holman-Miller sign or</strong> <strong>antral sign </strong>is the<strong> anterior bowing </strong>of the <strong>posterior wall </strong>of&nbsp;the<strong> maxillary sinus.</strong>&nbsp;It is a&nbsp;<strong>pathognomonic</strong> feature of<strong> angiofibroma.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 22-year-old man comes to the emergency room with profound drowsiness. On examination, he is found to have respiratory depression, with a respiratory rate of 5 cycles/minute. His symptoms are traced back to a drug derived from the plant shown below. Which of the following is the antidote to this patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Flumazenil"
      },
      {
        "id": 2,
        "text": "Naloxone"
      },
      {
        "id": 3,
        "text": "Physostigmine"
      },
      {
        "id": 4,
        "text": "Atropine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The suitable antidote to this patient presenting with features of\u00a0<strong>opiate intoxication\u00a0</strong>is\u00a0<strong>naloxone.\u00a0</strong>The derivative drug,\u00a0<strong>opium\u00a0</strong>is derived from the\u00a0<strong>Papaver somniferum\u00a0</strong>plant as shown in the clinical vignette.</p>\n<p>Toxic parts of the plant include the unripe fruit capsule and the latex juice. Active principles of opium are grouped under\u00a0<strong>phenanthrenes (morphine, codeine, heroin)\u00a0</strong>and\u00a0<strong>benzyl-isoquinolones</strong> <strong>(papaverine, narcotin)</strong>.</p>\n<p>These drugs act on mu, kappa, delta receptors in the CNS and mediate the effects of euphoria, analgesia, respiratory depression, gastrointestinal dysmotility, and miosis.\u00a0</p>\n<p>The antidote to opiate intoxication is a <strong>competitive opiate antagonist</strong> named\u00a0<strong>naloxone\u00a0</strong>which competes with opioids at their receptor sites. Dose: 0.4-2 mg IV (It may be repeated every 10-15 minutes up to a maximum dose of 10 mg).</p>\n<p>Other options:</p>\n<p>Option A - <strong>Flumazenil</strong> is the<strong> antidote to treat benzodiazepine (BZD)</strong> intoxication. Benzodiazepines (alprazolam, flunitrazepam) are sedative-hypnotics and symptoms of intoxication include normal vital signs, sedation, diplopia, ataxia, slurred speech, and impaired motor function. Flumazenil acts as a competitive antagonist at the site of BZD action, which is the gamma-aminobutyric acid receptor.\u00a0</p>\n<p>Option C - <strong>Physostigmine </strong>is used in the <strong>treatment of anticholinergic toxicity due to atropine</strong>. Atropine is the anticholinergic active principle derived from tropane alkaloids such as Datura stramonium and Atropa belladonna. Toxidrome consists of features such as tachycardia, hyperthermia, agitation, delirium, mydriasis, dry flushed skin, and urinary retention. Physostigmine is a reversible acetylcholine esterase inhibitor that increases acetylcholine concentrations in the synaptic cleft to mitigate the effects of atropine toxicity.\u00a0</p>\n<p>Option D - <strong>Atropine</strong> is used in the<strong> treatment of cholinergic toxicity due to organophosphates (DDT, parathion, malathion)</strong>. Symptoms of cholinergic toxicity include bradycardia, respiratory depression, and autonomic symptoms of salivation, lacrimation, urination, defecation. Atropine used in association with pralidoxime act as competitive inhibitors at the nicotinic and muscarinic acetylcholine receptors to neutralize the toxicity.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6c7565a36e314be5ad62f6660249c864.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A radiological assessment of a pregnant woman reveals an anteroposteriorly oval-shaped pelvic inlet. According to Caldwell and Moloy's classification, this shape of pelvic inlet is described as ______.",
    "choices": [
      {
        "id": 1,
        "text": "Android pelvis"
      },
      {
        "id": 2,
        "text": "Anthropoid pelvis"
      },
      {
        "id": 3,
        "text": "Gynecoid pelvis"
      },
      {
        "id": 4,
        "text": "Platypelloid pelvis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>According to Caldwell and Moloy's classification, an <strong>anteroposteriorly oval</strong>-<strong>shaped</strong> <strong>pelvic inlet&nbsp;</strong>is an <strong>anthropoid pelvis</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/011535fbaaf341d3a6d75538abb0d91dx1280x1638.JPEG"
    ]
  },
  {
    "text": "A mother brings her 4-month-old female child to the outpatient department. She was delivered by C-section. The pregnancy was complicated by oligohydramnios and breech presentation. On examination of the child, you notice the finding shown in the image below. What is the most appropriate management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Closed reduction only"
      },
      {
        "id": 2,
        "text": "Pavlik harness after closed reduction"
      },
      {
        "id": 3,
        "text": "Total hip replacement"
      },
      {
        "id": 4,
        "text": "Femoral osteotomy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A<strong>\u00a0Pavlik harness</strong> <strong>after closed reduction</strong> is the most appropriate\u00a0management for this infant, with history and examination suggestive of\u00a0<strong>developmental dysplasia of the hip</strong> (DDH). The image shows one knee (affected knee) at a lower level compared to the other, which is known as <strong>Galeazzi's sign.</strong></p>\n<p>Developmental dysplasia of the hip or congenital dysplasia of the hip is characterized by <strong>spontaneous dislocation of the hip joint before, during, or shortly after birth</strong>. Risk factors for DDH include-</p>\n<ul>\n<li>Sex of the baby - Female gender is more susceptible\u00a0</li>\n<li>Intrauterine positioning - Breech position\u00a0</li>\n<li>Oligohydramnios</li>\n<li>Genetic predisposition\u00a0</li>\n</ul>\n<p>Examination of the developmental dysplasia of the hip-</p>\n<ul>\n<li>Tests to check instability of the hip -\n<ul>\n<li><strong>Ortolani test</strong>: To perform this test, the infant is supine, with the hip and knee flexed. With the thumb placed over the medial thigh and the index finger on the greater trochanter, the hip is gently <strong>abducted</strong>. This reduces the femoral <strong>head into the acetabulum</strong> producing a palpable \"clunk\".\u00a0</li>\n<li><strong>Barlow test</strong>: This test is done within 2\u20133 days of birth. To perform this test, the infant is supine with the knees fully flexed and the hip at 90\u00b0 of flexion. Gentle <strong>adduction</strong> results in a posterior subluxation or <strong>dislocation</strong> of an easily dislocatable <strong>femoral</strong> <strong>head</strong>, producing a palpable \"clunk\"</li>\n</ul>\n</li>\n<li><strong>Galeazzi's test</strong>\u00a0is shown in the above image. It is done between 3 to 8-month aged children in\u00a0unilateral cases of developmental dysplasia of the hip\u00a0(DDH). To perform this test, the child is in the supine position with the hip and knee in flexion. The level of both the knee joints is noted with respect to a horizontal line. Normally both knees should be at the same level. In DDH, the affected knee is seen at a <strong>lower level</strong> indicating\u00a0femoral shortening. This is also known as the<strong>\u00a0Allis sign</strong>.\u00a0</li>\n<li>Marked\u00a0<strong>a</strong><strong>symmetry </strong>of the<strong>\u00a0inguinal, gluteal, thigh,\u00a0</strong>or<strong> popliteal folds</strong>.</li>\n<li>Decreased abduction on the affected side.</li>\n<li>Positive tredelenburg sign</li>\n<li>Limb-length discrepancy</li>\n</ul>\n<p>Treatment of DDH includes early closed reduction with splinting or casts. If closed reduction cannot be achieved in long-standing dislocations, an open reduction may become necessary.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<ul>\n<li>&lt; 6 months: Closed reduction with Pavlik harness or Von Rosen splint is done.\u00a0\u00a0</li>\n<li>6-18 months: Closed or open reduction with hip spica application is done.</li>\n<li>1.5\u00a0years- 3 years: Open reduction and pelvic or femoral osteotomies may be required</li>\n<li>3-8 years: Femoral shortening or pelvic osteotomies.</li>\n<li>&gt;8 years: Femoral and pelvic osteotomies or total hip replacement considered</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8927263bb0a74f0e9a91d80ba6a6c1fc.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A neonate has a cardiac murmur and the eye finding shown in the image below. Investigations revealed bilateral hearing defect. The mother gives a history of viral exanthem during the first trimester of the pregnancy. The most common cardiac defect seen in such neonates is:",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary stenosis"
      },
      {
        "id": 2,
        "text": "Patent ductus arteriosus"
      },
      {
        "id": 3,
        "text": "Ventricular septal defect"
      },
      {
        "id": 4,
        "text": "Atrial septal defect"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Maternal history of <strong>viral exanthem</strong> in the first trimester and the image showing the presence of <strong>bilateral congenital cataract\u00a0</strong>and <strong>hearing defect</strong> is suggestive of <strong>congenital rubella syndrome</strong>.\u00a0<strong>Patent ductus arteriosus</strong> is the <strong>most common cardiac defect associated</strong> with this condition.</p>\n<p>Congenital rubella syndrome is associated with rubella infection in mothers in early pregnancy. The <strong>classic triad</strong>\u00a0of congenital rubella syndrome includes:</p>\n<ul>\n<li>Sensorineural hearing loss</li>\n<li>Congenital cataract</li>\n<li>Congenital heart disease (most commonly: <strong>patent ductus arteriosus</strong>)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fd32b4d824de41568bff147cce9768ca.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An individual consumed a balanced meal containing carbohydrates, proteins, and fats. Immediately after the meal, assuming that carbohydrates were mainly metabolized, what will the respiratory quotient be?",
    "choices": [
      {
        "id": 1,
        "text": "1.0"
      },
      {
        "id": 2,
        "text": "0.8"
      },
      {
        "id": 3,
        "text": "0.7"
      },
      {
        "id": 4,
        "text": "0.5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 832\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>respiratory quotient </strong>(RQ) immediately after a balanced meal in which <strong>carbohydrates</strong> in the food were mainly metabolized will be <strong>1.0.</strong></p>\n<p>The respiratory quotient refers to the <strong>ratio</strong> of <strong>carbon dioxide production</strong> to <strong>oxygen</strong> <strong>utilization</strong>. It estimates the relative utilization of different foods by the body.</p>\n<p><strong>Carbohydrates-&nbsp;</strong>When carbohydrates are metabolized, one molecule of carbon dioxide is released when one molecule of oxygen is utilized. Therefore, the RQ of carbohydrates is <strong>1.&nbsp;</strong>This occurs <strong>immediately after a meal</strong> when the majority of <strong>carbohydrates </strong>are metabolized.</p>\n<p><strong>Fats-&nbsp;</strong>When fats are oxidized, with every 100 molecules of oxygen utilized, an average of 70 carbon dioxide molecules are released. The RQ of fat is therefore<strong> 0.70</strong>. This happens because when oxygen reacts with fats, a large amount of it combines with hydrogen from the fats, forming water instead of carbon dioxide.&nbsp;Around <strong>8-10 hours after</strong> <strong>a meal&nbsp;</strong>the carbohydrate stores are depleted and&nbsp;fats are utilized. The RQ becomes<strong>&nbsp;</strong><strong>0.70</strong>. In severe<strong> untreated diabetes,</strong> carbohydrates are not utilized as they require insulin. Hence, the RQ remains near that of <strong>fat metabolism</strong>, i.e., <strong>0.70</strong>.</p>\n<p><strong>Proteins-&nbsp;</strong>When <strong>proteins</strong> are oxidized, with every 100 molecules of oxygen utilized, an average of 80 carbon dioxide molecules are released. Therefore, the RQ of proteins is <strong>0.8.</strong>&nbsp;Protein utilization is better estimated by measuring <strong>nitrogen excretion</strong>. The average protein contains about 16% nitrogen. During the metabolism of the protein, most of the nitrogen is excreted as urea, uric acid, creatinine, and other nitrogen products in the urine and around 10% is excreted in the feces. The utilization of proteins mainly occurs during <strong>starvation,</strong> when the carbohydrate and the fat stores have been depleted.&nbsp;</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following patients can be intubated using succinylcholine as a muscle relaxant?",
    "choices": [
      {
        "id": 1,
        "text": "Patient with head injury"
      },
      {
        "id": 2,
        "text": "Patient with 45% burns"
      },
      {
        "id": 3,
        "text": "Patient with muscle dystrophy"
      },
      {
        "id": 4,
        "text": "Patient with liver disease"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Succinylcholine</strong> can be <strong>administered</strong> in <strong>liver disease.</strong></p>\n<p>Succinylcholine is a <strong>depolarizing</strong> muscle relaxant. It has a <strong>rapid onset of action</strong> and an <strong>ultra</strong>-<strong>short duration of action</strong>. It stimulates cholinergic receptors at the neuromuscular junction and muscarinic autonomic sites. The ultrashort duration of action is because it gets rapidly hydrolyzed by butyrylcholinesterase. A decreased concentration of butyrylcholinesterase will prolong the blockade produced by succinylcholine.</p>\n<div class=\"page\" title=\"Page 936\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In liver disease, the amount of <strong>butyrylcholinesterase</strong> will <strong>decrease</strong> (20% of normal), leading to <strong>prolonged</strong> neuromuscular <strong>blockade,</strong>\u00a0but it is not a major concern in clinical practice.</p>\n<p>Succinylcholine chloride is used to <strong>facilitate tracheal intubation</strong>. It provides skeletal muscle relaxation during surgery or mechanical ventilation.</p>\n</div>\n</div>\n</div>\n</div>\n<p>Succinylcholine is <strong>contraindicated</strong> in:\u00a0</p>\n<ul>\n<li>Burns patients</li>\n<li>Muscle dystrophies (like Duchenne muscular dystrophy)</li>\n<li>Known hypersensitivity</li>\n<li>Multiple trauma, head injury</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old boy presented with yellowish discoloration of the skin and sclerae for the last 3 days. He is otherwise asymptomatic. He had a viral fever one week ago which has now resolved. His investigations are shown below. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Dubin-Johnson syndrome"
      },
      {
        "id": 2,
        "text": "Rotor syndrome"
      },
      {
        "id": 3,
        "text": "Gilbert syndrome"
      },
      {
        "id": 4,
        "text": "Criggler-Najar type 1 syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient has a <strong>short history of jaundice</strong>, which <strong>appeared</strong>&nbsp;only <strong>during a</strong> <strong>period of stress</strong> (viral fever). The lab reports show <strong>increased unconjugated bilirubin</strong> (normal 0.2-0.8 mg/dL) and normal AST and ALT levels. All this points toward a diagnosis of <strong>Gilbert syndrome</strong>.</p>\n<p><strong>Gilbert syndrome</strong> is a <strong>benign</strong>, familial disorder characterized by<strong>&nbsp;mild intermittent jaundice&nbsp;</strong>usually seen <strong>during stress, fatigue, or alcohol use</strong>. The condition is recognized to arise from a mutation in the promoter region of the <em>UGT1A1</em>&nbsp;gene, which results in <strong>mildly decreased UDP-glucuronyltransferase production</strong>. This causes a reduction in the liver's ability to conjugate bilirubin, thus causing <strong>unconjugated hyperbilirubinemia</strong>. The <strong>total bilirubin</strong> value is <strong>usually &lt; 3 mg/dL</strong>.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Dubin-Johnson syndrome</strong>&nbsp;is a <strong>benign </strong>disease&nbsp;that is characterized by chronic&nbsp;<strong>conjugated</strong>&nbsp;<strong>hyperbilirubinemia </strong>and<strong> bilirubinuria</strong>. <strong>Patients</strong> are <strong>asymptomatic</strong> and other laboratory tests are normal.<strong> Liver biopsy</strong> shows characteristic <strong>deposition</strong> <strong>of</strong> <strong>black-colored</strong> <strong>pigment</strong> in the lysosomes of the centrilobular hepatocytes.</p>\n<p>Option B:&nbsp;<strong>Rotor syndrome</strong> is <strong>similar to Dubin-Johnson</strong> syndrome <strong>but</strong> has a <strong>milder</strong> presentation. <strong>Conjugated bilirubin</strong> levels are <strong>elevated</strong>. The <strong>liver</strong> biopsy <strong>does not</strong> <strong>show</strong> <strong>pigment</strong> <strong>deposition</strong>.</p>\n<p>Option D:&nbsp;<strong>Crigler-Najjar syndrome</strong> is another syndrome that has <strong>unconjugated hyperbilirubinemia</strong>. It is of two types, with <strong>type 1 </strong>having <strong>absent/trace</strong> <strong>UDP-glucoronyltransferase production</strong> and type 2 having &lt;10% of the normal enzyme activity. <strong>Type 1 </strong>is far <strong>more</strong> <strong>severe</strong> and leads to <strong>kernicterus</strong> and neurological damage <strong>in</strong> <strong>infancy</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 21-year-old male patient presents with low-grade fever, loss of weight,  dry nocturnal cough, dyspnea, and wheezing for the past 6 months  The eosinophil count is markedly increased along with a high level of serum IgE and filarial antibodies. Following treatment with diethylcarbamazine, he developed a severe allergic reaction. This is known as:",
    "choices": [
      {
        "id": 1,
        "text": "Mazzotti reaction"
      },
      {
        "id": 2,
        "text": "Jarisch\u2013Herxheimer reaction"
      },
      {
        "id": 3,
        "text": "Hoigne syndrome"
      },
      {
        "id": 4,
        "text": "Meyer's-Kouwenaar syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Following treatment with <strong>diethylcarbamazine (DEC)</strong>, the severe allergic reaction that may occur is known as the\u00a0<strong>Mazzotti reaction</strong>. It occurs due to the death of microfilariae.\u00a0The clinical scenario given above is suggestive of <strong>tropical pulmonary eosinophilia.</strong></p>\n<p>Tropical pulmonary eosinophilia is a manifestation of occult filariasis. It presents with low-grade fever, weight loss, and pulmonary symptoms like a dry nocturnal cough, dyspnea, and wheezing. There is an increase in the eosinophil count, IgE, and filarial antibodies. The condition is treated with DEC.</p>\n<p>Diethylcarbamazine is the drug of choice for filariasis. It is given orally (the dose is 6 mg/ kg body weight daily for 12 days). It has both macro and microfilaricidal properties. The <strong>Mazzotti reaction</strong> that may develop can be <strong>controlled</strong> with <strong>antihistamines</strong> and <strong>steroids</strong>.</p>\n<p>Other options:</p>\n<p>Option B- A\u00a0<strong>Jarisch\u2013Herxheimer reaction</strong>\u00a0is a\u00a0transient clinical phenomenon that occurs in patients infected with spirochetes like syphilis, leptospirosis, Lyme disease, and relapsing fever, who are treated with antibiotics. The reaction occurs within 24 hours of antibiotic\u00a0therapy.\u00a0It generally manifests as fever, chills, rigors, nausea and vomiting, headache, tachycardia, hypotension, hyperventilation, flushing, myalgia, and exacerbation of skin lesions. It is an acute,\u00a0self-limiting condition.</p>\n<p>Option C-<strong> Hoigne Syndrome </strong>is a pseudoanaphylactic or pseudoallergic\u00a0reaction\u00a0that occurs after intramuscular administration of penicillin G procaine or benzathine.\u00a0It is<strong>\u00a0</strong>not due to a penicillin allergy.\u00a0</p>\n<p>Option D-\u00a0<strong>Meyer's-Kouwenaar syndrome\u00a0</strong>is a synonym for <strong>occult filariasis</strong>. It occurs as a result of a <strong>hypersensitivity reaction to microfilariae\u00a0</strong><strong>antigens</strong>. Microfilariae are not found in the blood. It presents with massive eosinophilia, hepatosplenomegaly, and pulmonary symptoms.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Mr. Ramesh is a 55-year-old man who has pledged for cornea donation. History of which of the following diseases would render his cornea unfit for transplantation?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 3 and 5"
      },
      {
        "id": 3,
        "text": "2, 3, 4, 5"
      },
      {
        "id": 4,
        "text": "2, 3, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Diabetes and hypertension are not considered as a contraindication for carrying out cornea donation.</p>\n<p><strong>Contraindications</strong> for eye donation include <strong>Hepatitis B, Hepatitis C, HIV, syphilis, leprosy, tetanus, and COVID-19</strong>.</p>\n<p>In view of the recent pandemic, COVID -19 has also been included as a contraindication for eye donation as per the eye bank 2020 guidelines.</p>\n<p><strong>Contraindications for transplantation: </strong>These include conditions with a potential risk of transmission of local or systemic communicable disease from donor to recipient.</p>\n<ul>\n<li>Death of unknown cause.</li>\n<li>Death with progressive neurodegenerative diseases like\n<ul>\n<li>Chronic idiopathic demyelinating polyneuropathy</li>\n<li>Amyotrophic lateral sclerosis</li>\n<li>Multiple sclerosis</li>\n<li>Huntington\u2019s chorea</li>\n<li>Alzheimer\u2019s disease</li>\n<li>Myasthenia gravis</li>\n<li>Parkinson\u2019s syndrome</li>\n<li>Creutzfeldt-Jakob disease</li>\n</ul>\n</li>\n<li>Active meningitis, viral encephalitis</li>\n<li>Active septicemia at the time of death</li>\n<li>Active viral hepatitis</li>\n<li>Congenital rubella</li>\n<li>Reye\u2019s syndrome</li>\n<li>Suspected rabies and persons who, within the past six months, were bitten by an animal suspected to be infected with rabies</li>\n<li>Active miliary tuberculosis</li>\n<li>Hepatitis B surface antigen-positive donors,\u00a0Hepatitis C seropositive donors</li>\n<li>HTLV-I or HTLV-II infection</li>\n<li>HIV seropositive donors</li>\n<li>Active syphilis or seropositive for syphilis.</li>\n<li><strong>Leprosy</strong></li>\n<li><strong>COVID-19 i</strong><strong>nfection</strong></li>\n<li><strong>Tetanus</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs acts by causing irreversible inhibition of the initiation complex through binding of the 30S ribosomal subunit?",
    "choices": [
      {
        "id": 1,
        "text": "Chloramphenicol"
      },
      {
        "id": 2,
        "text": "Clindamycin"
      },
      {
        "id": 3,
        "text": "Gentamicin"
      },
      {
        "id": 4,
        "text": "Vancomycin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Aminoglycosides</strong>&nbsp;like <strong>gentamicin&nbsp;</strong>act by causing irreversible inhibition of the initiation complex through binding of the <strong>30S ribosomal subunit</strong>. They cause <strong>misreading</strong> and <strong>premature termination</strong> of <strong>mRNA translation.&nbsp;</strong></p>\n<p>Aminoglycosides include streptomycin, gentamicin, tobramycin, amikacin, and kanamycin. They are <strong>bactericidal</strong> and the killing is <strong>concentration-dependent.</strong></p>\n<p>They are used in the treatment of <strong>aerobic gram-negative bacterial</strong> infections such as urinary tract infections, mycobacterial infections, tularemia, respiratory infections in cystic fibrosis, and other pseudomonal infections. Anaerobic bacteria are intrinsically resistant to aminoglycosides because the&nbsp;<strong>transport </strong>of aminoglycosides&nbsp;across the cytoplasmic membrane<strong> requires oxygen</strong>. &nbsp;</p>\n<p>The adverse effects of aminoglycosides include-</p>\n<ul>\n<li><strong>Ototoxicity</strong>&nbsp;is characterized by irreversible <strong>high-frequency hearing loss</strong> and <strong>vestibular dysfunction. Streptomycin</strong> and <strong>gentamicin</strong> are the most <strong>vestibulotoxic.</strong> Amikacin, kanamycin, and neomycin mainly affect auditory functions.&nbsp;</li>\n<li><strong>Nephrotoxicity&nbsp;</strong>due to <strong>damage</strong> to <strong>proximal tubular cells.</strong> Neomycin is the most nephrotoxic. Streptomycin is the least nephrotoxic.</li>\n<li><strong>Acute neuromuscular blockade</strong> and apnea. Neuromuscular blockade may be <strong>reversed</strong> by <strong>intravenous</strong> administration of a <strong>Ca2+</strong> salt.&nbsp;</li>\n</ul>\n<div class=\"page\" title=\"Page 1046\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Other options</p>\n</div>\n</div>\n</div>\n</div>\n<p>Options A and B- <strong>Chloramphenicol</strong> and <strong>clindamycin</strong> act by binding to the <strong>50S</strong> subunit of the ribosome.</p>\n<p>Option D-&nbsp;<strong>Vancomycin</strong>&nbsp;is a glycopeptide that inhibits cell wall synthesis. It binds to terminal dipeptide D-Ala-D-Ala of peptidoglycan to inhibit cell wall synthesis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 52-year-old woman presented to the hospital with malaise, pain abdomen, and blood in the stools. On examination, the patient also has foot drop. Laboratory investigations reveal anemia, elevated ESR, and negative ANCA. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Polyarteritis nodosa"
      },
      {
        "id": 2,
        "text": "Takayasu arteritis"
      },
      {
        "id": 3,
        "text": "Cogan's syndrome"
      },
      {
        "id": 4,
        "text": "Wegener's granulomatosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most likely diagnosis in the given clinical scenario is <strong>polyarteritis nodosa</strong>. The presence of <strong>foot drop</strong> is highly suggestive of <strong>mononeuritis</strong> <strong>multiplex</strong>. Mononeuritis multiplex in combination with malaise, pain abdomen, blood in the stools, anemia, elevated ESR, and <strong>negative ANCA</strong> is highly suggestive of polyarteritis nodosa.</p>\n<div class=\"page\" title=\"Page 876\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Polyarteritis nodosa is necrotizing arteritis involving medium-sized vessels. It may present insidiously with fever, malaise, weight loss, arthralgia, myalgia, or neuropathy.<strong> Mononeuritis multiplex</strong> is most commonly seen as a <strong>foot drop</strong>. Patients also develop symptoms related to vasculitis of a particular organ system. Cutaneous manifestations are skin ulcers,\u00a0<strong>digital gangrene,</strong>\u00a0and <strong>livedo reticularis</strong>. Renal involvement is common and manifests as hypertension or renal failure. GI involvement presents as abdominal pain, nausea and vomiting, bleeding, bowel infarction, and perforation.</p>\n<p>There are no specific serologic tests. Laboratory investigations reveal <strong>anemia, leukocytosis, elevated ESR</strong>. Patients with classic polyarteritis nodosa are <strong>negative</strong> for <strong>ANCA</strong>. Diagnosis is confirmed only by confirming vasculitis on biopsy.</p>\n<p>Other options:</p>\n<p>Option B:<strong> Takayasu arteritis</strong>\u00a0is an inflammatory and stenotic disease of medium- and large-sized arteries- usually aortic arch and its branches. It is\u00a0suspected in a young woman with decreased or <strong>absent peripheral pulses</strong>, <strong>blood pressure discrepancies</strong>, and arterial <strong>bruits</strong>. There is elevated ESR, mild anemia, and <strong>elevated</strong> <strong>immunoglobulin</strong> levels. Diagnosis is confirmed with <strong>arteriography</strong>.</p>\n<p>Option C:\u00a0<strong>Cogan's syndrome</strong> is characterized by <strong>interstitial keratitis</strong> and <strong>vestibulo-auditory symptoms</strong>. Vasculitis of aorta and aortic valve may also be associated.</p>\n<p>Option D:\u00a0<strong>Wegener's granulomatosis\u00a0</strong>is a granulomatous vasculitis of the upper and lower respiratory tracts with glomerulonephritis. Laboratory findings include a markedly elevated ESR, mild anemia, leukocytosis, hypergammaglobulinemia, elevated rheumatoid factor. <strong>ANCA</strong> is usually <strong>positive</strong>.\u00a0</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 38-year-old woman presented with complaints of blurred vision and urinary incontinence for the past 2 months. MRI showed scattered plaques in the patient\u2019s brain and spinal cord. Over the next few months, some of these plaques diminished in size, while others appeared in new locations. These plaques would most likely show selective loss of which of the following proteins?",
    "choices": [
      {
        "id": 1,
        "text": "Synaptophysin"
      },
      {
        "id": 2,
        "text": "\u03b1-Synuclein"
      },
      {
        "id": 3,
        "text": "\u03b2-Amyloid"
      },
      {
        "id": 4,
        "text": "Myelin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical features are suggestive of <strong>multiple sclerosis,</strong> which is associated with selective <strong>loss of myelin.</strong></p>\n<p><strong>Multiple sclerosis (MS)</strong> is an autoimmune demyelinating disease characterized by episodes of neurological deficits occurring at different times, due to patchy white matter lesions that involve various sites of the brain.</p>\n<p>The condition is caused by an <strong>autoimmune response</strong> directed against components of the <strong>myelin sheath.</strong></p>\n<div class=\"page\" title=\"Page 1271\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In most cases, the initial manifestation includes unilateral visual impairment due to the involvement of the optic nerve <strong>(optic neuritis).&nbsp;</strong>Involvement of the brainstem causes cranial nerve signs such as <strong>ataxia, nystagmus,</strong> and <strong>internuclear ophthalmoplegia.&nbsp;</strong>Spinal cord lesions give rise to <strong>motor</strong> and <strong>sensory impairment</strong> of the trunk and limbs, <strong>spasticity,</strong> and <strong>loss of bladder control.&nbsp;</strong>The course of MS varies, with many relapses and remissions.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man was arrested by the police for disrupting peace in a hotel. He refused to pay his hotel bills saying that he was the prime minister and all services are free for him. When the hotel staff confronted him, he got angry and damaged some hotel property. What are his symptoms suggestive of?",
    "choices": [
      {
        "id": 1,
        "text": "Delusion of persecution"
      },
      {
        "id": 2,
        "text": "Delusion of control"
      },
      {
        "id": 3,
        "text": "Delusion of grandeur"
      },
      {
        "id": 4,
        "text": "Delusion of reference"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given symptoms are suggestive of a\u00a0<strong>delusion of grandeur (megalomania).</strong></p>\n<p><strong>Grandiose delusions,</strong>\u00a0<strong>delusions of grandeur, </strong>or<strong> megalomania</strong> refer to the exaggerated conception of one's importance, power, or identity. The patient may believe that he is a famous celebrity or has supernatural powers.</p>\n<p>A<strong> delusion</strong> is a false, firm, fixed (unshakable) belief that is not in keeping with the patient\u2019s socio-cultural and educational background.</p>\n<p>Delusions are of two types based on their origin:</p>\n<ul>\n<li><strong>Primary</strong>: Delusions that do not occur in response to another psychopathological form such as mood disorder.</li>\n<li><strong>Secondary</strong>: Delusions that are secondary to other morbid psychological conditions like depressive moods and hallucinations. They are understandable when a detailed psychiatric history and examination are available.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 37-year-old man, with no known medical illness, came for a routine medical check-up. His chest radiograph is presented to you. Identify the incorrect statement with respect to the X-ray shown below.",
    "choices": [
      {
        "id": 1,
        "text": "The structure marked number 2 is the right ventricular border"
      },
      {
        "id": 2,
        "text": "The structure marked 1 is the trachea"
      },
      {
        "id": 3,
        "text": "The structure marked 3 is the left ventricular border"
      },
      {
        "id": 4,
        "text": "The structure marked 4 is the aortic arch"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The incorrect statement is option A because the structure marked as <strong>2 is the right atrial border</strong> (not the right ventricular border). The given image is posteroanterior (PA) view of a normal chest x-ray. Structures marked in the X-Ray are as follows:</p>\n<ol>\n<li>Trachea</li>\n<li>Right atrial border</li>\n<li>Left ventricular border</li>\n<li>Aortic arch</li>\n</ol>\n<p>Chest x-rays can be described as <strong>posteroanterior</strong> (PA) or <strong>anteroposterior</strong> (AP) views. This indicates the direction in which the x-ray beam traverses from the patient to the detector.</p>\n<p><strong>PA</strong>&nbsp;<strong>view</strong> means that the x-ray <strong>beam enters from the posterior </strong>aspect of the patient and <strong>exits anteriorly</strong> to reach the film.</p>\n<p><strong> AP view</strong> means that the x-ray<strong> beam enters</strong> the patient from the <strong>anterior</strong> aspect and <strong>exits</strong> from the <strong>posterior</strong> aspect, reaching the film.</p>\n<p>A left lateral decubitus view is one taken with the patient&rsquo;s left side down.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2663f68aa6bb4cddb82de1441d6d74de.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/906a99e5684649ffadf62301c01e7192x1280x1337.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f6006abdd627401bbf1f83f050fbaa41x1024x1024.JPEG"
    ]
  },
  {
    "text": "Based on the new update to the MELD score i.e. MELD 3.0, an elderly woman with end-stage liver disease now has a higher score and is deemed eligible for a liver transplant. Which of the following is a new component that has been added to the MELD 3.0 scoring system?",
    "choices": [
      {
        "id": 1,
        "text": "Serum creatinine"
      },
      {
        "id": 2,
        "text": "Serum bilirubin"
      },
      {
        "id": 3,
        "text": "Serum sodium"
      },
      {
        "id": 4,
        "text": "Female gender"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The<strong> female gender</strong> is one of the <strong>new components</strong> that has been added to the <strong>MELD 3.0</strong> scoring system.</p>\n<p>The Model for End-Stage Liver Disease (MELD) is used as an indicator of short-term survival in patients with end-stage liver disease, and to determine organ allocation priorities for liver transplantation. According to the <strong>previous model, MELDNa</strong>, the <strong>components</strong> of the scoring system were:</p>\n<ul>\n<li>Serum creatinine</li>\n<li>Serum bilirubin</li>\n<li>Serum sodium, and</li>\n<li>INR (international normalized ratio)</li>\n</ul>\n<p>The <strong>updated MELD 3.0</strong> scoring system has added two additional components- <strong>serum albumin</strong> and <strong>female gender.</strong>&nbsp;</p>\n<p>The addition of these two components and certain adjustments made in the other components has led to a better scoring system.&nbsp;MELD 3.0 allows for a <strong>more accurate prediction of mortality</strong> than the previous MELDNa scoring system. An important improvement is that it addresses factors that can affect wait-list outcomes such as <strong>sex disparity</strong>. MELD 3.0 is able to <strong>correctly reclassify</strong> almost 9% of <strong>patients </strong>to a<strong> higher MELD tier,</strong> giving them a much <strong>better chance of transplantation,</strong> particularly in women.&nbsp;</p>\n<p>It is estimated that almost 20 waitlist deaths can be reduced per year with the new MELD 3.0 scoring system.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 24';
        const quizFilename = 'mini-test-24-127b0dcf.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>