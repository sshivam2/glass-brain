<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 009 (Histopathological Images) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A middle-aged woman presents with recurrent episodes of breathlessness, wheeze, and chest tightness. Auscultation of the chest shows bilateral wheeze. The image of a characteristic finding in the sputum is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary tuberculosis"
      },
      {
        "id": 2,
        "text": "Bronchial asthma"
      },
      {
        "id": 3,
        "text": "Chronic bronchitis"
      },
      {
        "id": 4,
        "text": "Asbestosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\"><span class=\"s1\">The given clinical scenario and the histological image showing <strong>Charcot&ndash;Leyden crystals</strong> (arrows), lakes of mucus, and numerous eosinophils, are&nbsp;<strong>diagnostic of bronchial asthma.</strong></span></p>\n<div class=\"page\" title=\"Page 689\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 689\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Asthma is characterized by&nbsp;<strong>reversible bronchoconstriction</strong>&nbsp;caused by airway hyperresponsiveness to a variety of stimuli.&nbsp;<strong>Atopic</strong>&nbsp;asthma is caused by a TH2 and IgE-mediated immunologic reaction to environmental allergens (<strong>type-1 hypersensitivity</strong>&nbsp;reaction). Triggers for&nbsp;<strong>non-atopic</strong>&nbsp;asthma are less clear but include&nbsp;<strong>viral</strong>&nbsp;infections and inhaled&nbsp;<strong>air pollutants</strong>.</p>\n<div class=\"page\" title=\"Page 689\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Genetic susceptibility for developing asthma:</p>\n<ul>\n<li><strong>Chromosome 5q</strong>&nbsp;- site of the&nbsp;<strong>susceptibility locus&nbsp;</strong>for asthma</li>\n<li>IL-13 gene polymorphisms (on 5q chromosome) - most consistent associations with asthma or allergic disease</li>\n<li>IL-4 receptor gene variants - associated with atopy, elevated total serum IgE, and asthma</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p class=\"p1\"><span class=\"s1\">The sputum of patients with bronchial asthma shows:</span></p>\n<ul class=\"ul1\">\n<li class=\"li1\"><span class=\"s1\"><strong>Charcot&ndash;Leyden crystals&nbsp;</strong>-&nbsp;made of an eosinophilic membrane protein called&nbsp;<strong>galectin 10</strong></span></li>\n<li class=\"li1\"><span class=\"s1\"><strong>Curschmann spirals&nbsp;</strong>-&nbsp;spirals of&nbsp;</span>mucus plugs from subepithelial mucous gland ducts or bronchioles</li>\n<li class=\"li1\"><span class=\"s1\"><strong>Creola bodies</strong>&nbsp;-<strong>&nbsp;</strong>desquamated epithelial cells</span></li>\n<li class=\"li1\"><span class=\"s1\">Numerous eosinophils</span></li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a049b5f8417742bbbc2686f89347bb2e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 57-year-old male presents with anasarca, nephrotic range proteinuria, and mild hepatomegaly. A biopsy specimen seen under polarised light shows the following appearance. What is the most likely stain used here?",
    "choices": [
      {
        "id": 1,
        "text": "Perl's Prussian blue stain"
      },
      {
        "id": 2,
        "text": "Alcian blue stain"
      },
      {
        "id": 3,
        "text": "Congo red stain"
      },
      {
        "id": 4,
        "text": "Warthin-Starry stain"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The given scenario is suggestive of systemic Amyloidosis.&nbsp;The image shows a <strong>congo-red stained</strong>&nbsp;biopsy specimen with&nbsp;<strong>apple-green birefringence under polarized light,&nbsp;</strong>diagnostic of&nbsp;<strong>amyloidosis</strong>.</span></p>\n<p><span data-preserver-spaces=\"true\">Amyloidosis refers to&nbsp;<strong>extracellular </strong>deposits of<strong> fibrillar proteins.&nbsp;</strong>Abnormal fibrils are produced by the aggregation of misfolded proteins. Amyloid appears as an&nbsp;<strong>amorphous, eosinophilic, hyaline, extracellular substance.</strong></span></p>\n<p><strong>K</strong><strong>idneys </strong>are the<strong> most frequently</strong> involved with<strong> heart being second.</strong>&nbsp;<strong>Cardiac involvement </strong>is the <strong>leading cause of death</strong> from AL amyloidosis.&nbsp;</p>\n<p>Renal amyloidosis usually manifests as proteinuria, often in the nephrotic range, and is associated with hypoalbuminemia, secondary hypercholesterolemia, hypertriglyceridemia, and&nbsp;edema or anasarca.&nbsp;</p>\n<p><span data-preserver-spaces=\"true\">The image shows a congo-red stained</span><span data-preserver-spaces=\"true\">&nbsp;biopsy specimen with (A)&nbsp;</span><strong><span data-preserver-spaces=\"true\">focal</span></strong><span data-preserver-spaces=\"true\">&nbsp;</span><strong><span data-preserver-spaces=\"true\">positive staining (orange-red)</span></strong><span data-preserver-spaces=\"true\">&nbsp;of amorphous extracellular material, and (B)&nbsp;</span><strong><span data-preserver-spaces=\"true\">apple-green birefringence under polarized light,&nbsp;</span></strong><span data-preserver-spaces=\"true\">diagnostic of&nbsp;</span><strong><span data-preserver-spaces=\"true\">amyloidosis</span></strong><span data-preserver-spaces=\"true\">.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/445792a05ced4b67bdf40f9b2ee00b51.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b2c1e1d1bba4085a97add1af8284d9dx384x207.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/413dc6635047404cbfed88e3376a00ddx720x576.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c5359bed8a1540009ea40d8be0511773x720x513.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4534a9d7e32041498e2d47ef6256ff3ax720x480.JPEG"
    ]
  },
  {
    "text": "The histopathological section of the cardiac tissue of an elderly man shows some pigmentation as seen below. Which of the following intracellular accumulations is it likely to be?",
    "choices": [
      {
        "id": 1,
        "text": "Dutcher bodies"
      },
      {
        "id": 2,
        "text": "Lipochrome"
      },
      {
        "id": 3,
        "text": "Mallory bodies"
      },
      {
        "id": 4,
        "text": "Cholesterol"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-preserver-spaces=\"true\">The <strong>brown</strong> intracellular accumulation that can be seen in this patient is <strong>lipochrome</strong> (lipid).&nbsp;It is also known as <strong>lipofuscin&nbsp;</strong>or&nbsp;<strong>wear-and-tear</strong> pigment.</span></p>\n<p><span data-preserver-spaces=\"true\">It is<strong>&nbsp;brownish-yellow</strong>, granular intracellular material, which accumulates in various tissues like the heart, liver, and brain. It is seen in&nbsp;<strong>normal</strong>&nbsp;<strong>ageing patients.&nbsp;</strong></span><span data-preserver-spaces=\"true\">The brown pigment in large amounts can give a characteristic appearance to the tissue called&nbsp;<strong>brown atrophy.</strong>&nbsp;</span><span data-preserver-spaces=\"true\">&nbsp;</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Lipofuscin&nbsp;</span></strong><span data-preserver-spaces=\"true\">(brown lipid):</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\"><strong>Derived </strong>through<strong> lipid peroxidation</strong> of polyunsaturated lipids of subcellular membranes.</span></li>\n<li><strong>Not injurious </strong>to the cell or its functions.</li>\n<li><span data-preserver-spaces=\"true\">Indicates <strong>free radical injury</strong> and <strong>lipid peroxidation</strong>.</span></li>\n<li><span data-preserver-spaces=\"true\">Seen in cells undergoing slow, regressive changes.</span></li>\n<li><span data-preserver-spaces=\"true\">Prominent in the liver, brain, and heart of ageing patients, patients with severe malnutrition, and cancer cachexia.</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Other options:</span></p>\n<p><span data-preserver-spaces=\"true\">Option A: Dutcher bodies are&nbsp;pale-staining <strong>intranuclear inclusions</strong> within plasma cells seen in multiple myeloma.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d71d15dbd6b74b9da3b58d3e211132ca.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3df6c1c04ea84219aa2457103c328780x1279x1153.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2d23ee07e4b64bd6a94e81ea1bb1f812x720x448.JPEG"
    ]
  },
  {
    "text": "An 8-year-old child presents with a history of morning headaches, vomiting, and lethargy for the past 6 months.  MRI scan showed a contrast-enhancing nodule in the cerebellum. Biopsy findings of the tumor are shown in the image. The tumors were positive for glial fibrillary acidic protein. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ependymoma"
      },
      {
        "id": 2,
        "text": "Pilocytic astrocytoma"
      },
      {
        "id": 3,
        "text": "Medulloblastoma"
      },
      {
        "id": 4,
        "text": "Oligodendroglioma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A clinical scenario of a child presenting with symptoms of increased intracranial tension with an image that shows <strong>Rosenthal fibers</strong>&nbsp;are suggestive of&nbsp;<strong>pilocytic astrocytoma</strong>.</p>\n<p><strong>Pilocytic astrocytoma&nbsp;</strong>is a brain tumour that occurs more often in <strong>children</strong> and <strong>young adults.&nbsp;</strong>These tumours are usually&nbsp;<strong>slow-growing </strong>and<strong> benign</strong>. The majority of neoplasms are located in the <strong>cerebellum</strong>. However, they can also appear around the third ventricle, optic nerves, spinal cord, and occasionally in the cerebral hemispheres.</p>\n<p>On<strong> brain</strong>&nbsp;<strong>MRI,&nbsp;</strong>it can be identified as a contrast-enhancing nodule. On microscopy, it has very limited brain invasion compared to infiltrative astrocytomas. The tumour is made up of <strong>bipolar</strong> cells with <strong>hair-like projections</strong> forming a dense fibrillary meshwork<strong>.</strong>&nbsp;These cells are positive for glial fibrillary acidic protein (<strong>GFAP</strong>). The characteristic features of this tumour are the presence of&nbsp;<strong>Rosenthal fibres</strong> and <strong>eosinophilic granular bodies</strong>.&nbsp;A <strong>Rosenthal fibre</strong> is a <strong>corkscrew-shaped eosinophilic</strong> inclusion while&nbsp;<strong>eosinophilic granular bodies&nbsp;</strong>are mulberry-shaped inclusions.</p>\n<p>In low-grade astrocytoma, surgical resection is the primary treatment modality, and in high-grade lesions, local irradiation is also done after surgical correction.</p>\n<p>The below image shows pilocytic astrocytoma with Rosenthal fibers (arrows) and dense fibrillary meshwork.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0ebc4d3587246729b3546c987d2ece4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f310299a9a6f4faea744f8f6a894b59ex600x457.JPEG"
    ]
  },
  {
    "text": "The structures shown in the below image are found in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Multiple myeloma"
      },
      {
        "id": 2,
        "text": "Meningioma"
      },
      {
        "id": 3,
        "text": "Schwanomma"
      },
      {
        "id": 4,
        "text": "Granulosa cell tumor"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows<strong> psammoma bodies. </strong>They&nbsp;are found in <strong>meningioma</strong>.</p>\n<p>Psammoma bodies are <strong>concentric, lamellated structures</strong> formed as a product of <strong>dystrophic calcification. </strong>They are<strong>&nbsp;</strong>associated with<strong> papillary</strong> <strong>histomorphology</strong>&nbsp;and are caused by <strong>infarction and calcification of papillae tips.&nbsp;</strong></p>\n<p>Conditions associated with psammoma bodies include-</p>\n<ul>\n<li>Papillary thyroid carcinoma</li>\n<li>Papillary renal cell carcinoma</li>\n<li>Serous cystadenocarcinoma</li>\n<li>Meningiomas.</li>\n</ul>\n<p>Meningiomas are predominantly&nbsp;<strong>benign</strong>&nbsp;tumors, usually attached to the dura. They are predominantly seen in females and in patients with&nbsp;<strong>neurofibromatosis type 2</strong>, which is an autosomal disorder associated with multiple meningiomas, schwannomas, and ependymomas.</p>\n<p>They arise from the&nbsp;<strong>meningothelial cells</strong>&nbsp;or&nbsp;<strong>arachnoid cap cells</strong>. The most common karyotypic abnormality is the loss of the long arm of&nbsp;<strong>chromosome 22</strong>.&nbsp;Meningiomas often express hormone receptors (eg: Progesterone), hence, they may grow rapidly in pregnancy.</p>\n<p>Meningiomas are rubbery, rounded, or bosselated dural masses. They compress the underlying brain tissue. They present with&nbsp;headaches, seizures, or focal neurological deficits.&nbsp;</p>\n<p>The tumor spreads in a sheet-like manner along the surface of the dura causing reactive<strong>&nbsp;hyperostotic changes</strong>&nbsp;in adjacent bones. They are mostly located in cerebral convexities. The lesions may be finely gritty due to numerous psammomatous calcification.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Russell bodies</strong> are cytoplasmic globular <strong>inclusions</strong> that are seen in <strong>multiple myeloma</strong>.</p>\n<p>Option C:&nbsp;<strong>Verocay bodies</strong> are<strong>&nbsp;spindle cells</strong> that are arranged to form central &ldquo;nuclear-free zones&rdquo; ramified by <strong>palisading nuclei</strong> and are seen in <strong>Schwanomma</strong>.</p>\n<p>Option D:&nbsp;<strong>Call-Exner bodies</strong> are <strong>diagnostic</strong> gland-like immature <strong>follicles</strong> that are filled with an acidophilic material and are seen in <strong>granulosa cell tumours </strong>of the <strong>ovary</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/58bf0c136f16415ab232f4a5d3f0b77a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old child presented with 15 days of cough. On examination, cervical lymphadenopathy was noted and the lymph node biopsy showed the following features. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tuberculosis"
      },
      {
        "id": 2,
        "text": "Leprosy"
      },
      {
        "id": 3,
        "text": "Sarcoidosis"
      },
      {
        "id": 4,
        "text": "Syphilis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical history and histopathological findings showing&nbsp;<strong>caseating granuloma </strong>are suggestive of <strong>tuberculosis</strong>.</p>\n<p>The <strong>microscopic</strong> <strong>picture</strong> shows the <strong>caseating granuloma.</strong> Eosinophilic necrotic debris known as <strong>caseation</strong>, bordered by collections of <strong>epithelioid cells,</strong> Langhan giant cells and lymphocytes can be seen. Epitheloid cells merge to form <strong>Langhan's giant cell</strong> where nuclei arranged in <strong>a horseshoe shape</strong> (a characteristic feature of tuberculosis).&nbsp;</p>\n<p>Clinically, tuberculosis presents with chronic cough, fever, weight loss, swollen lymph nodes.</p>\n<p>Other options:</p>\n<p>Option B- <strong>Leprosy</strong> presents with <strong>skin lesions and nerve involvement</strong> with loss of sensation.</p>\n<p>Option C- <strong>Sarcoidosis</strong> shows giant cells with <strong>cytoplasmic inclusions, non-caseating granuloma</strong> with <strong>fibroblastic</strong> <strong>proliferation</strong> at the periphery.</p>\n<p>Option D- <strong>Syphilis</strong> shows&nbsp;thickened capsule/ hyperplasia of capsule accompanied by <strong>fibrosis, perivascular inflammation</strong> and infiltration of chronic inflammatory cells.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/304681f5fb7b41bcb0f854de45455f46.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60-yr-old man presents with dyspnea and cough. Chest x-ray studies reveal irregular linear densities, particularly in both lower lobes. Histopathological examination of lung biopsy is shown below. This patient may develop all the following diseases except__________.",
    "choices": [
      {
        "id": 1,
        "text": "Occupational asthma"
      },
      {
        "id": 2,
        "text": "Mesothelioma"
      },
      {
        "id": 3,
        "text": "Lung carcinoma"
      },
      {
        "id": 4,
        "text": "Laryngeal carcinoma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shows beaded rods of <strong>asbestos bodies</strong>&nbsp;<strong>(ferruginous bodies)</strong> seen in <strong>asbestosis</strong>. Asbestosis would not lead to<strong> laryngeal carcinoma.</strong>&nbsp;<strong>L</strong><strong>ung carcinomas</strong>, <strong>colon</strong> <strong>carcinomas</strong> and <strong>mesotheliomas</strong> develop in workers exposed to asbestos.</p>\n<p>The disease-causing capabilities of the different forms of asbestos depend on concentration, size, shape, and solubility. Asbestos generally occurs in 2 forms - <strong>Serpentine chrysotile</strong> and <strong>Amphibole</strong>. Amphiboles, though less prevalent than chrysotiles are more pathogenic and are involved in the occurrence of mesothelioma, a malignant tumour derived from the lining cells of the pleural surfaces.</p>\n<p>In contrast to other inorganic dust, asbestos acts as a <strong>tumour initiator</strong> and a <strong>tumour promoter</strong>. Some of its oncogenic effects are mediated by reactive free radicals generated by the asbestos fibres.</p>\n<div class=\"page\" title=\"Page 698\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Asbestosis is marked by <strong>diffuse pulmonary interstitial fibrosis</strong> and the presence of multiple <strong>asbestos bodies.&nbsp;</strong><strong>Asbestos bodies</strong> are golden-brown, fusiform, or beaded rods with a translucent center and consist of asbestos fibers coated with an iron-containing proteinaceous material&nbsp;and arise when <strong>macrophages phagocytose asbestos fibers.</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">Other inorganic particulates may become coated with similar <strong>iron-protein complexes</strong> and are called <strong>ferruginous bodies</strong>.</p>\n<p class=\"ng-binding\">Asbestosis begins as fibrosis around the <strong>respiratory bronchioles</strong> and <strong>alveolar ducts</strong> and most commonly arises in the <strong>lower lobe. Pleural plaques </strong>are well-circumscribed plaques of dense collagen that are often calcified and are the most common manifestation of asbestos exposure.</p>\n<p class=\"ng-binding\">Clinical features include,</p>\n<ul>\n<li class=\"ng-binding\"><strong>Dyspnoea</strong></li>\n<li class=\"ng-binding\"><strong>Productive cough</strong></li>\n</ul>\n<p>The chest x-ray shows <strong>irregular linear densities</strong> in the lower lobes and a honeycomb pattern in advanced cases.</p>\n<p>The disease may remain stable or progress to respiratory failure, Cor pulmonale and death.</p>\n<p>Asbestos exposure is linked with 6 disease processes:</p>\n<ul>\n<li>Parenchymal Interstitial Fibrosis ( Asbestosis)</li>\n<li>Localised pleural plaques or rarely diffuse pleural fibrosis</li>\n<li>Recurrent pleural effusion</li>\n<li>Lung carcinoma&nbsp;</li>\n<li>Malignant pleural and peritoneal mesothelioma&nbsp;</li>\n<li>Laryngeal cancer.</li>\n</ul>\n<p>Cigarette smoking increases the risk of lung cancer in people with asbestos exposure.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Occupational asthma</strong> may be triggered by fumes (epoxy resins, plastics), organic and chemical dusts (wood, cotton, platinum), gases (toluene), or other chemicals (formaldehyde, penicillin products).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e3a2d7c5a05b41c1b8070dcc477ca419.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old male patient presents with severe dyspnoea. Echocardiography showed mitral stenosis with vegetation. The vegetation present on the mitral valve was excised and its HPE image is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rheumatic valvular disease"
      },
      {
        "id": 2,
        "text": "Infective endocarditis"
      },
      {
        "id": 3,
        "text": "Myxoma"
      },
      {
        "id": 4,
        "text": "Sarcoidosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given HPE image depicts <strong>Aschoff bodies,&nbsp;</strong>suggestive of<strong> rheumatic valvular disease.</strong></p>\n<p><strong>Aschoff's bodies</strong>&nbsp;are the lesions found in the heart during&nbsp;<strong>acute rheumatic fever</strong>. They are composed of foci of T lymphocytes, activated macrophages called&nbsp;<strong>Anitschkow cells</strong>, and&nbsp;occasional plasma cells.&nbsp;Anitschkow cells have abundant cytoplasm and central round-to-ovoid nuclei with chromatin that is centrally <strong>condensed</strong> into a slender, <strong>wavy ribbon</strong>. Hence, they are also called <strong>caterpillar cells</strong>.</p>\n<div class=\"page\" title=\"Page 1860\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Rheumatic fever is the leading cause of mitral stenosis. During acute rheumatic fever, Aschoff bodies may be found in any of the three layers of the heart.&nbsp;</p>\n</div>\n</div>\n</div>\n</div>\n<p>Chronic inflammation leads to diffuse thickening and fibrosis of the valve leaflets, often with calcific deposits.&nbsp;<strong>Fibrinoid necrosis</strong>&nbsp;occurs due to inflammation of the endocardium and the left-sided valves. Over these areas of necrosis, small vegetations called&nbsp;<strong>verrucae</strong>&nbsp;develop along the lines of closure. Irregular thickenings present in the subendocardium are called&nbsp;<strong>MacCallum plaques.</strong></p>\n<p>In chronic RHD, the mitral valve leaflet is thickened, with commissural fusion and shortening. There is thickening and fusion of the tendinous cords. This can lead to narrowing the mitral orifice, leading to a&nbsp;<strong>fish mouth appearance (button hole)</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dca02d20b2ae474d831ba022f1b13e4d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old male patient is diagnosed with acute myeloid leukemia. The peripheral blood smear picture is given in the image. The cell indicated by the arrow is best described as:",
    "choices": [
      {
        "id": 1,
        "text": "Auer rod"
      },
      {
        "id": 2,
        "text": "Flaming promyelocyte"
      },
      {
        "id": 3,
        "text": "Faggot cell"
      },
      {
        "id": 4,
        "text": "Dusky promyelocyte"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given cell shows <strong>multiple Auer rods</strong> <strong>clustered together</strong> within a single cell resembling a bundle of sticks. Such cells have been termed as &ldquo;<strong>Faggot cells</strong>&rdquo; (faggot in French means <strong>bundle of sticks</strong>). &nbsp;</p>\n<p>Since the question specifically asks about the <strong>cell</strong>, the best answer is Faggot cell (not Auer rods).</p>\n<p><strong>Auer rods</strong> are distinctive needle-like azurophilic granules present numerously in AML with the t(15;17) aberration (acute promyelocytic leukaemia).</p>\n<p>Other options:</p>\n<ul>\n<li>The term <strong>flaming promyelocyte</strong> has been coined to describe cells that appear to be &ldquo;breaking apart&rdquo;, taking on a vibrant reddish-purple hue with the apparent liberation of granules into the surrounding cellular matrix.</li>\n<li>Promyelocytes containing fine granules appear &ldquo;dusky&rdquo; or &ldquo;hazy&rdquo; and are referred to as such.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2ff43cc382e641b8a38dcbff1f231810.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old boy presents with weight loss, fever, and a painless swelling in the area of his jaw. CBC reveals anemia and lymphocytosis. Biopsy findings from the swelling are seen in the image below. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hodgkin's disease"
      },
      {
        "id": 2,
        "text": "Acute lymphocytic leukemia"
      },
      {
        "id": 3,
        "text": "Chloroma"
      },
      {
        "id": 4,
        "text": "Burkitt's lymphoma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical presentation and biopsy findings of <strong>starry sky </strong>appearance point&nbsp;towards a diagnosis of <strong>Burkitt's lymphoma.</strong></p>\n<p>The biopsy image shows tumor cells with <strong>multiple small nucleoli,&nbsp;</strong>minimal cytoplasm, and<strong> high mitotic index</strong>&nbsp;closely apposed to each other forming a dark blue background (the \"sky\"). These cells have a high turnover rate. The macrophages get stuffed in between along with cellular debr is, they are called&nbsp;<strong>tingible body macrophages. </strong>Upon fixation, the cytoplasm washes away leaving behind white spaces filled with debris ( the \"stars\")<strong>. </strong>This produces a&nbsp;<strong>starry sky appearance</strong>, which is classical to <strong>Burkitt lymphoma.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e8523728b71846b68d498683907cf876.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/621f51b06c25459e989f496e5de2b48bx1280x613.JPEG"
    ]
  },
  {
    "text": "A 7-year-old child presents with fever, erythematous rash, and bone pain. X-ray of the skull shows multiple lytic lesions. Skin biopsy shows prominent nuclear grooves with eosinophils as in the image below. Immunohistochemistry for S100, CD1a is also shown in the images below. What would be the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rosai-Dorfman disease"
      },
      {
        "id": 2,
        "text": "Kimura disease"
      },
      {
        "id": 3,
        "text": "Langerhans cell histiocytosis"
      },
      {
        "id": 4,
        "text": "Juvenile Xanthogranuloma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical scenario along with the histopathological image showing Langerhans cells with <strong>folded nuclei</strong> (image A),\u00a0<strong>CD1a</strong> (image B),<strong>\u00a0</strong>and<strong> positive S100</strong> (image C), is suggestive of <strong>Langerhans\u00a0cell histiocytosis (LCH)</strong>.</p>\n<p><strong>LCH</strong> occurs due to the proliferation of a special type of immature dendritic cells, called\u00a0<strong>Langerhans cells.\u00a0</strong>Their\u00a0normal function is to present antigens. The most common mutation is the\u00a0<strong>BRAFV600E</strong> gain-of-function mutation.</p>\n<p>It is characterized by\u00a0<strong>single </strong>or<strong> multiple osteolytic bone lesions\u00a0</strong>and<strong>\u00a0</strong>can also infiltrate nearly every organ, like the skin (of the scalp), lungs, liver, spleen, bone marrow, or the central nervous system.\u00a0</p>\n<p class=\"p1\">LCH can present as the following clinical entities:</p>\n<ul>\n<li class=\"p1\">Multifocal multisystem Langerhans cell histiocytosis\u00a0<strong>(Letterer-Siwe disease) </strong>- mostly seen in <strong>infants</strong></li>\n<li class=\"p1\">Unifocal and multifocal uni system Langerhans cell histiocytosis\u00a0<strong>(eosinophilic granuloma) -</strong>\u00a0The combination of bone defects, diabetes insipidus, and exophthalmos is called the\u00a0<strong>Hand-Sch\u00fcller-Christian triad </strong>- mostly seen in younger<strong>\u00a0children</strong></li>\n<li class=\"p1\">Pulmonary LCH\u00a0- mostly seen in <strong>adults</strong></li>\n</ul>\n<p class=\"p p-first\"><strong>Clinical features</strong> include\u00a0pain and swelling in the affected area. When calvarium is affected, it results in otitis media and mastoiditis. Spinal involvement results in compression fractures and neurological involvement. Vertebral involvement results in a rapid flattening of the vertebral body (vertebra plana).</p>\n<p>Histopathologically,\u00a0Langerhans cells have a single large nucleus with a characteristic folded or grooved nucleus (<strong>coffee-bean</strong>\u00a0appearance) with small inconspicuous nucleoli.\u00a0<strong>Birbeck granules</strong>\u00a0are seen in the cytoplasm.\u00a0The tumour cells specifically express\u00a0<strong>HLA-DR, S-100, and CD1a\u00a0</strong>and\u00a0<strong>langerin (CD207)\u00a0</strong>markers.</p>\n<p>The image below shows a histopathological image of Langerhans cells with folded nuclei.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2fbbeffc94204b3ea6679408352f925e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8e2de3624e2d488bb0ceed9e750a13d0x1280x864.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aaed24736ede47e39a739d32c36e475fx720x803.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6ed459141ada43a8a337fdc7be36a0b3x720x828.JPEG"
    ]
  },
  {
    "text": "A 36-year-old male presented with skin-coloured umbilicated nodules. Microscopy is as shown below. The most likely diagnosis is______.",
    "choices": [
      {
        "id": 1,
        "text": "Herpes virus"
      },
      {
        "id": 2,
        "text": "Verruca vulgaris"
      },
      {
        "id": 3,
        "text": "Molluscum contagiosum"
      },
      {
        "id": 4,
        "text": "Lichen planus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given microscopic image shows large, ellipsoid, homogeneous, cytoplasmic inclusion in cells of the stratum granulosum and the stratum corneum classically seen in <strong>molluscum contagiosum.</strong></p>\n<p><strong>Molluscum contagiosum&nbsp;</strong>is a common, self-limited viral disease of the skin caused by a <strong>poxvirus.&nbsp;</strong>Poxvirus is brick-shaped and is the largest pathogenic poxvirus in humans.</p>\n<p>Individual lesions are firm, pruritic, and pink to skin-coloured <strong>umbilicated papules.</strong> A curd-like material can be expressed from the central umbilication</p>\n<p>Tzanck smear: intracytoplasmic molluscum bodies (<strong>Henderson&ndash;Patterson bodies</strong>), the largest known inclusion bodies.</p>\n<p>Microscopic examination:<strong> Cuplike verrucous epidermal hyperplasia</strong> and&nbsp;<strong>Molluscum bodies:</strong>&nbsp;large, ellipsoid, homogeneous, cytoplasmic inclusion in cells of the stratum granulosum and the stratum corneum.</p>\n<p>Molluscum bodies contain numerous virions.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a5ea68cb4a694e3aa898b75cc4baea47.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bb7339621bed4a09bec7e9fcb719a21cx484x500.JPEG"
    ]
  },
  {
    "text": "The absence of the structure marked as A will not present as",
    "choices": [
      {
        "id": 1,
        "text": "Pernicious anemia"
      },
      {
        "id": 2,
        "text": "Achlorhydria"
      },
      {
        "id": 3,
        "text": "Vit B12 Deficiency"
      },
      {
        "id": 4,
        "text": "Zollinger ellison syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The eosinophilic-appearing cells marked as&nbsp;<strong>A</strong>&nbsp;are the&nbsp;<strong>parietal cells.</strong>&nbsp;Their absence does not present as<strong>&nbsp;</strong>&nbsp;<strong>Zollinger-Ellison Syndrome</strong>. Instead, their proliferation presents as Zollinger-Ellison Syndrome.&nbsp;The cells marked as <strong>B</strong> are <strong>Chief cells.&nbsp;</strong></p>\n<div class=\"page\" title=\"Page 776\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Zollinger-Ellison Syndrome<strong>&nbsp;</strong>is caused by&nbsp;<strong>gastrin-secreting neuroendocrine tumours</strong>. Gastrinomas are almost always found in the small intestine or pancreas. The most remarkable feature found in the stomach is an increase in&nbsp;<strong>oxyntic mucosal thickness</strong>&nbsp;due to massive&nbsp;<strong>parietal cell hyperplasia.</strong></p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Pernicious anemia</strong>&nbsp;is an autoimmune disease characterized by the presence of&nbsp;<strong>autoantibodies</strong>&nbsp;that impairs the production or activity of the&nbsp;<strong>intrinsic</strong>&nbsp;<strong>factor (IF)</strong>, which is required for the&nbsp;<strong>uptake&nbsp;</strong>of<strong>&nbsp;vitamin B12</strong>. There are three types of autoantibodies namely, type I, II, and III. The action of each of these include:</p>\n<ul>\n<li>Autoantibody type I prevents the binding of vitamin B12 to the intrinsic factor (IF).</li>\n<li>Autoantibody type II prevents the binding of vitamin B12-IF complex to the ileal receptors.</li>\n<li>Autoantibody type III acts against the &alpha; and &beta; subunits of the gastric proton pump, which impairs the production of intrinsic factor.</li>\n</ul>\n<p>These patients also develop&nbsp;<strong>chronic</strong>&nbsp;<strong>atrophic gastritis,</strong>&nbsp;characterized by loss of parietal cells, infiltration of lymphocytes and plasma cells, and megaloblastic changes in mucosal cells.</p>\n<p>&nbsp;</p>\n<p>Since parietal cells <strong>secrete gastric acid</strong>, their absence results in defective gastric acid secretion, a condition known as <strong>achlorhydria</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9554ea1a12754b1f895972f9ce5130bd.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 17-year-old boy presented with intussusception and was taken up for surgery. He was found to have multiple polyps. The resected section was sent for histopathology and the whole mount image of the specimen is given below. Identify the lesion.",
    "choices": [
      {
        "id": 1,
        "text": "Tubulovillous adenoma"
      },
      {
        "id": 2,
        "text": "Hamartomatous polyp"
      },
      {
        "id": 3,
        "text": "Adenocarcinoma"
      },
      {
        "id": 4,
        "text": "Hyperplastic polyp"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical feature of intussusception and multiple polyps and the histologic picture showing an\u00a0<strong>arborizing pattern</strong> of connective tissue, smooth muscle, lamina propria, and glands are suggestive of\u00a0<strong class=\"ng-binding\">Peutz\u2013Jeghers Syndrome,\u00a0</strong><span class=\"ng-binding\">which</span><strong class=\"ng-binding\">\u00a0</strong><span class=\"ng-binding\">is a type of <strong>hamartomatous polyp</strong> of the small intestine.</span></p>\n<p>It is an autosomal dominant condition characterized by <strong>hamartomatous polyps</strong> of the intestinal tract and <strong>melanosis</strong> of the mouth and the <strong>lips</strong>.\u00a0</p>\n<p>Clinical features:</p>\n<ul>\n<li><strong>Hamartomatous polyps</strong>\u00a0of the intestinal tract</li>\n<li><strong>Hyperpigmentation</strong>\u00a0of the buccal mucosa, lips, perianal skin, and digits</li>\n<li>Increased (2% to 10%) risk for\u00a0<strong>cancer of the intestinal tract</strong>, with cancers reported throughout the intestinal tract,\u00a0<strong>from the stomach to the rectum</strong>.</li>\n<li>Increased risk for\u00a0<strong>extraintestinal malig\u00adnant neoplasms</strong>, including cancer of the breast, ovary, cervix, fallopian tubes, thyroid, lung, gallbladder, bile ducts, pancreas, and testicles.</li>\n</ul>\n<p>Management:</p>\n<ul>\n<li><strong>Surgery</strong> is indicated in cases where there is <strong>bleeding</strong>, <strong>obstruction</strong>, <strong>intussusception</strong>, or <strong>adenomatous changes</strong> of the polyp.</li>\n<li>If surgery is done for these indications attempts should be made to remove as much as polyps as possible.\u00a0</li>\n<li><strong>Regular screening</strong> with endoscopic studies should be done due to the increased risk of malignancies.</li>\n<li>Screening of other malignancies like breast and cervix are also important.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6663824399be46789cfc3f75feb70973.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a84b97547987411784cfa2d9950c0db9x1280x768.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a31fe35c587424d8b91f6fd8b8abca9x396x298.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cdc99e69be4d4668b07b53ce71189898x720x540.JPEG"
    ]
  },
  {
    "text": "A 48-year-old patient presented with scrotal swelling. Investigations for testicular tumours  revealed that LDH was raised but AFP was within normal limits. Following orchidectomy, the following histological picture was observed. Which of the following  is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Yolk sac tumour"
      },
      {
        "id": 2,
        "text": "Teratoma"
      },
      {
        "id": 3,
        "text": "Seminoma"
      },
      {
        "id": 4,
        "text": "Embryonal carcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario, high LDH with normal AFP levels, and the given histology picture showing<strong> fried egg</strong> appearance are highly suggestive of <strong>testicular seminoma.</strong></p>\n<p>In <strong>yolk sac</strong> <strong>tumors</strong> and <strong>embryonal carcinoma</strong>, <strong>AFP</strong> is <strong>elevated</strong> whereas in <strong>teratoma</strong> <strong>LDH</strong> is <strong>normal</strong>.&nbsp;</p>\n<p>Seminoma is the most common testicular tumour. It is common in men between 20-40 years of age.</p>\n<p>The patients usually present with a&nbsp;<strong>painless testicular lump</strong>. If a testicular tumour is suspected, blood samples are taken from the patient for the evaluation of the tumour markers (hCG, LDH, and AFP), and a&nbsp;<strong>high inguinal orchidectomy</strong>&nbsp;is performed for diagnosis.</p>\n<p>Further treatment of seminoma depends on the stage of the tumor. Stage I tumors, whose levels of tumor markers decline after orchidectomy may not require further treatment. Stage II-IV tumors require radiotherapy and chemotherapy. The chemotherapeutic agents used are&nbsp;<strong>bleomycin, etoposide,</strong>&nbsp;and <strong>platin-based</strong>&nbsp;agents (<strong>BEP)</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/15451b359e8c457d977ab29a6e53d692.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old woman who had a long history of dyspnea, chronic cough with sputum, and wheezing dies of respiratory failure following a bout of lobar pneumonia. She was a non-smoker and non-alcoholic.  The lung at autopsy is shown in the image below. Which of the following conditions is most likely to cause the pathological changes shown?",
    "choices": [
      {
        "id": 1,
        "text": "Alpha 1 antitrypsin deficiency"
      },
      {
        "id": 2,
        "text": "Cystic fibrosis"
      },
      {
        "id": 3,
        "text": "Mutation in dynein arms"
      },
      {
        "id": 4,
        "text": "Antibodies aganist type 4 collagen"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above gross specimen shows emphysematous damage involving enlargement of entire acinus suggestive of <strong>panacinar</strong> <strong>emphysema</strong>, which is caused due to <strong>alpha 1 antitrypsin deficiency.</strong></p>\n<p>In panacinar (pan lobular) emphysema, the acini are uniformly enlarged from the level of the <strong>respiratory</strong> <strong>bronchiole</strong> to the <strong>terminal blind alveoli.</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Alpha-1 antitrypsin (&alpha;1AT) is a&nbsp;<strong>plasma glycoprotein</strong>&nbsp;synthesized predominantly by&nbsp;<strong>hepatocytes.&nbsp;</strong>&alpha;1AT&nbsp;<strong>deficiency</strong>&nbsp;is an autosomal-recessive disorder of&nbsp;<strong>protein misfolding</strong>. The liver<strong>&nbsp;</strong>is affected&nbsp;due to the accumulation of the misfolded protein within hepatocytes. It&nbsp;presents as&nbsp;<strong>chronic hepatitis, cirrhosis, or hepatocellular carcinoma</strong>. Liver biopsy shows round-to-oval cytoplasmic globular inclusions in hepatocytes that are strongly<strong>&nbsp;periodic acid&ndash;Schiff</strong>&nbsp;(PAS)-<strong>positive</strong>&nbsp;and&nbsp;<strong>diastase-resistant</strong>.&nbsp;</p>\n<div class=\"page\" title=\"Page 858\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Deficiency of&nbsp;&alpha;1AT protein results in excessive degradation of alveoli by neutrophil elastase, causing&nbsp;<strong>panacinar emphysema.&nbsp;</strong>This occurs at an earlier age and is of greater severity if the individual smokes.&nbsp;In this type, the acini from the respiratory bronchiole to the terminal alveoli are uniformly enlarged.</p>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ada368c9c05444d6a925d28d61b2ec45.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 15-year-old boy presents with swelling in the upper diaphyseal part of the tibia. X-ray of the swelling showed a periosteal reaction. A histopathological image of the biopsy is given below. Immunohistochemistry was positive for synaptophysin and mic 2. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Osteosarcoma"
      },
      {
        "id": 2,
        "text": "Ewing sarcoma"
      },
      {
        "id": 3,
        "text": "Metastatic neuroblastoma"
      },
      {
        "id": 4,
        "text": "Osteoclastoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario along with the image showing<strong>\u00a0small round blue cells</strong> and\u00a0immunohistochemistry (IHC) positive for <strong>synaptophysin</strong> and <strong>mic-2</strong> point to a likely diagnosis of <strong>Ewing sarcoma</strong>.\u00a0</p>\n<p>Ewing\u00a0sarcoma<strong>\u00a0</strong>is the <strong>2nd most common</strong>\u00a0bone sarcoma in children. The majority of the patients affected are usually\u00a0<strong>&lt;20 years</strong> of age. It has a slight <strong>male</strong> predominance.\u00a0</p>\n<p>It commonly involves the\u00a0<strong>diaphysis</strong>\u00a0of the <strong>long bones</strong> like the <strong>femur</strong>,<strong> tibia</strong>, fibula, and humerus and <strong>flat bones</strong> of the <strong>pelvis</strong>. The majority of Ewing sarcomas have<strong> t(11:22)</strong>.\u00a0</p>\n<p>Patients present with\u00a0<strong>painful enlarging mass</strong>, fever, and anaemia. The affected area is usually tender, swollen, and warm. Laboratory findings may show an elevated WBC count and erythrocyte sedimentation rate (ESR).\u00a0</p>\n<p>A histopathological examination of Ewing sarcoma shows sheets of<strong> uniform, round cells </strong>arranged in<strong> Homer-Wright rosettes.</strong><strong>\u00a0</strong>These cells are of neuroectodermal origin and have minimal cytoplasm and abundant glycogen. When they are arranged around a central fibrillary core in the form of clusters, the appearance is termed\u00a0<strong>Homer-Wright rosettes.\u00a0</strong>Immunohistochemistry is usually\u00a0positive for<strong> synaptophysin </strong>and<strong> mic-2.</strong></p>\n<p>Given below is the histopathological appearance of\u00a0Ewing sarcoma.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/07c24b9bbadb44aea23a29cba1f073be.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9003f86ee1384b5c938b3096d52cc98cx1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a40fa82d61e43fe834545ba3e782885x1279x1048.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f99343856f124715846432a4a29e62b6x720x1363.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/660d962942824c67b7a48a238f3a7b59x1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9424f27b6514a5e9ff11fcfcc92c10cx720x765.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2c756ed405974a7e941ed0f99971568dx800x570.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1ef15ab45b4f4b9899cc3960b4ccffedx1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fa42e7411944499863d9f1d71934b6bx720x912.JPEG"
    ]
  },
  {
    "text": "A 30-year-old female presented with painful blisters on the skin and oral mucosa. Direct immunofluorescence is given below. Which of the following is false regarding the same?",
    "choices": [
      {
        "id": 1,
        "text": "Antibodies against Desmoglein 3"
      },
      {
        "id": 2,
        "text": "Antibodies against Desmoglein 1"
      },
      {
        "id": 3,
        "text": "Supra basal acantholytic blister is a characteristic feature"
      },
      {
        "id": 4,
        "text": "Antibodies against hemidesmosomes"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The direct immunofluorescence image showing <strong>fish net pattern</strong> is diagnostic of<strong>&nbsp;pemphigus </strong>where the antibodies are against the <strong>desmosomal </strong>adhesion proteins, <strong>not hemidesmosomes.</strong></p>\n<p><strong>Antibodies against hemidesmosomes</strong> that link basal keratinocytes to the underlying basement membrane are <strong>seen in bullous pemphigoid</strong>.</p>\n<p>Pemphigus is a blistering disorder caused by autoantibodies against desmosomes that result in the dissolution of intercellular attachments within the epidermis and mucosal epithelium. In pemphigus vulgaris, the cells immediately above the basal layer of the epidermis are involved, leading to the characteristic <strong>suprabasal acantholytic blister.</strong></p>\n<p>Variants of pemphigus are:</p>\n<ul>\n<li>Pemphigus Vulgaris,</li>\n<li>Pemphigus Vegetans,</li>\n<li>Pemphigus foliaceous,</li>\n<li>Pemphigus Erythematosus,</li>\n<li>Paraneoplastic Pemphigus&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/59e6a5294ffb4b82a61175d3aa5258e1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d0268d8740ee4727915a5687dfefbfa1x443x358.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3498513499e746d788a7a9f483815951x401x601.JPEG"
    ]
  },
  {
    "text": "Which of the following heart tumours exhibit the histologic pattern as shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Cardiac Myxomas"
      },
      {
        "id": 2,
        "text": "Papillary fibroelastoma"
      },
      {
        "id": 3,
        "text": "Cardiac Rhabdomyoma"
      },
      {
        "id": 4,
        "text": "Cardiac Rhabdomyosarcoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given histological slide shoes abundant spider cells. They are seen in Rhabdomyoma.</p>\n<p>Microscopically,&nbsp;they are composed of <strong>bizarre, markedly enlarged myocytes</strong>. Routine histologic processing often artifactually reduces the abundant cytoplasm to thin strands that stretch from the nucleus to the surface membrane, an appearance referred to as <strong>&ldquo;spider&rdquo; cells</strong>.</p>\n<p>&nbsp;<strong>Rhabdomyoma:</strong></p>\n<ul>\n<li><strong>Most frequent primary tumor of the&nbsp;pediatric heart</strong></li>\n<li>50% of cases are associated with <strong>tuberous sclerosis</strong>, with mutations in the tumor-suppressor genes <em>TSC1</em> and <em>TSC2</em>.</li>\n<li>Usually multiple and prefer ventricles preferentially</li>\n<li>Often regress spontaneously and may,&nbsp;therefore, be considered as hamartomas</li>\n</ul>\n<p>&nbsp;</p>\n<p>Image: Spider cell in rhabdomyoma</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/78201465dac545bba3707a08e7754860.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6c9d4b5c41494c3190c81add1122b5c5x623x455.PNG"
    ]
  },
  {
    "text": "The following is a histopathological image of the thyroid mass. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Medullary carcinoma of thyroid"
      },
      {
        "id": 2,
        "text": "Papillary carcinoma of thyroid"
      },
      {
        "id": 3,
        "text": "Follicular carcinoma of thyroid"
      },
      {
        "id": 4,
        "text": "Anaplastic carcinoma of thyroid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The histopathological image shows the presence of\u00a0<strong>amyloid-rich stroma</strong>\u00a0(pinkish material) and nests of polygonal cells, which are findings suggestive of <strong>medullary carcinoma of thyroid.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5fb38b7565364d3d8a365f322be2ce22.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/13978ae15e1548d297146ee93c34b3f0x1279x1050.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9affd63531ca4189945bff000d2db13ex1279x1042.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cd65f2d47b9e46a5b1aba25a8accaa7dx800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f0c87e50b4243b78b271621dda8028bx1280x853.JPEG"
    ]
  },
  {
    "text": "A patient presented with abdominal distension and intermittent fever. Peripheral smear findings were normal. A tumor was resected and the histopathology image of resected lymph node is shown below. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Angiolymphoma"
      },
      {
        "id": 2,
        "text": "Hodgkin's lymphoma"
      },
      {
        "id": 3,
        "text": "IgG4-related disease"
      },
      {
        "id": 4,
        "text": "Castleman disease"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Based on the given clinical and histopathological findings the most likely diagnosis is <strong>Castleman disease</strong>.</p>\n<p>The lymph node has&nbsp;multiple areas of follicular hyperplasia(germinal centres) with the vascular core.</p>\n<p><strong>Castleman disease (Angiofollicular</strong><strong>&nbsp;lymph node hyperplasia)</strong> is a heterogeneous group of lymphoproliferative disorders.</p>\n<p>Both HHV-8-associated MCD(multicentric Castleman disease) and UCD(unicentric Castleman disease) and HHV-8-negative/idiopathic MCD (iMCD) have elevated levels of human interleukin (IL)-6.</p>\n<p>There are 3 major histological subtypes:</p>\n<ol>\n<li style=\"font-weight: 400;\"><strong>Hypervascular</strong>( Unicentric Castleman disease): small, regressed or atrophic germinal centres, &ldquo;onion skin appearance of mantle zone around germinal centres, Lollipop appearance: blood vessels radially penetrate atrophic germinal centres.</li>\n<li style=\"font-weight: 400;\"><strong>Plasma cell subtype</strong> (can be multicentric or unicentric): hypertrophic germinal centres, increased vascularity.</li>\n<li style=\"font-weight: 400;\"><strong>Mixed variant</strong> (multicentric): a mix of hypervascular and plasma cell subtype features in the same lymph node.</li>\n</ol>\n<p>Patients with multicentric disease present with multiple enlarged lymph node regions. All patients have systemic symptoms like <strong>night sweats, weight loss, weakness, </strong>and<strong> fatigue</strong>. Hepatosplenomegaly is present in most patients.</p>\n<p><strong>Hodgkins's lymphoma</strong> has characteristic <strong>Reed-Sternberg</strong> cells in sections of a lymph node.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1b43a892594f460792db531fc39e9e0d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following is the bone marrow biopsy of a 60-year-old man with easy fatiguability,  back pain, and multiple lytic lesions in the skull. Likely diagnosis is______",
    "choices": [
      {
        "id": 1,
        "text": "CML"
      },
      {
        "id": 2,
        "text": "CLL"
      },
      {
        "id": 3,
        "text": "Multiple myeloma"
      },
      {
        "id": 4,
        "text": "Hairy cell leukemia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical history along with the biopsy picture showing<strong> Russell bodies </strong>is suggestive of <strong>multiple myeloma.&nbsp;</strong></p>\n<p><strong> Russell bodies&nbsp;</strong>are eosinophilic, large, homogeneous immunoglobulin-containing inclusions usually found in a plasma cell undergoing excessive synthesis of immunoglobulins. It is characteristic of the distended endoplasmic reticulum in multiple myeloma.</p>\n<p><strong>Clinical features </strong></p>\n<ul>\n<li><strong>Bone pain</strong> is the most common symptom</li>\n<li><strong>Renal failure</strong>&nbsp;-Acute oliguric or non-oliguric kidney failure may be present due to <strong>hypercalcemia, hyperuricemia, light-chain cast injury, or primary amyloidosis</strong></li>\n<li>Pallor and soft tissue masses</li>\n<li><strong>Fever</strong> occurs with infection</li>\n<li>Patients may have neurologic signs related to neuropathy or <strong>spinal cord compression</strong></li>\n<li><strong>Hyperviscosity syndrome</strong> (mucosal bleeding, vertigo, nausea, visual disturbances, alterations in mental status, hypoxia)</li>\n</ul>\n<p>Bone marrow biopsy shows round or oval cells with an eccentric nucleus composed of coarsely clumped chromatin, a densely basophilic cytoplasm, and a<strong> perinuclear clear zone </strong>containing the<strong> Golgi apparatus.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f4bd566439be49269de0c152655021b5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/05140e9970854743acf94cef5c6d7d24x720x542.JPEG"
    ]
  },
  {
    "text": "A young sexually active male presented with multiple polypoid growths over his penis. Histopathological picture of an excised lesion is as shown below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Condyloma lata"
      },
      {
        "id": 2,
        "text": "Bowen's disease"
      },
      {
        "id": 3,
        "text": "Condyloma acuminata"
      },
      {
        "id": 4,
        "text": "Verrucous carcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given histopathological image shows <strong>papillary (villous) architecture</strong> with acanthosis and koilocytosis of squamous epithelium, which are characteristic findings of <strong>condyloma acuminatum.</strong></p>\n<div class=\"page\" title=\"Page 974\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Condyloma acuminatum is a <strong>benign&nbsp;warty lesion</strong> that occurs in the <strong>anogenital region.</strong>&nbsp;It is caused by human papillomavirus <strong>(HPV)</strong>&nbsp;<strong>types 6 (most frequent)</strong> and<strong>&nbsp;11, </strong>which are <strong>sexually transmitted.</strong></p>\n<div class=\"page\" title=\"Page 974\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Grossly</strong>, they consist of single or multiple sessile or pedunculated, red <strong>papillary excrescences </strong>on<strong>&nbsp;</strong>the<strong>&nbsp;</strong>coronal sulcus and the inner surface of the prepuce.</p>\n<div class=\"page\" title=\"Page 974\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Microscopically</strong>, the characteristic features include the following:</p>\n<ul>\n<li>A branching <strong>villous structure</strong> with connective tissue stroma</li>\n<li>Epidermis showing&nbsp;<strong>hyperkeratosis</strong> and <strong>acanthosis</strong> (thickening)</li>\n<li>Cytoplasmic vacuolization of the squamous cells <strong>(koilocytosis)</strong> is&nbsp;characteristic of HPV infection.</li>\n<li>No evident dysplasia</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/224438835b7a489db767182f0539b95c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1e075a46a364c25a5d0e91a54859624x1053x842.JPEG"
    ]
  },
  {
    "text": "Immunohistochemistry for HER2 protein expression performed in 3 patients with breast carcinoma showed the following results. Which of the following patient should be subjected to fluorescence in-situ hybridization?",
    "choices": [
      {
        "id": 1,
        "text": "Patient A"
      },
      {
        "id": 2,
        "text": "Patient C"
      },
      {
        "id": 3,
        "text": "Patients B and C"
      },
      {
        "id": 4,
        "text": "Patients A and C"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The immunohistochemistry (IHC) pattern of&nbsp;<strong>patient C</strong>&nbsp;reveals moderately strong circumferential staining (faint brown color) in &gt;10 % of cells, which is classified as <strong>2+</strong> or <strong>equivocal</strong> staining. Hence, she should be subjected to fluorescence in situ hybridization (<strong>FISH</strong>) to <strong>confirm</strong> <strong>HER2-positive</strong>&nbsp;gene amplification status.</p>\n<p>The IHC of <strong>patient A</strong>&nbsp;shown below is <strong>negative</strong> for&nbsp;<strong>HER2.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bf03b0b3f9b745988877f9399262133c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e7eadae9aaf1403399eadaa2ef3cc625x1280x1252.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4cb27d72e8614595ae8b4e0ce2a8d0dex1280x1323.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d1f88f168044be7a084c2f861fe2a7cx1280x1322.JPEG"
    ]
  },
  {
    "text": "A 40-year-old man presents with complaints of facial puffiness and frothy urine. Given below is the histological image of the condition. What do you think is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Membranous nephropathy"
      },
      {
        "id": 2,
        "text": "Focal segmental glomerulosclerosis"
      },
      {
        "id": 3,
        "text": "Membranoproliferative nephritis"
      },
      {
        "id": 4,
        "text": "Dense deposit disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows uniform, diffuse thickening of the glomerular capillary wall(intense pink)&nbsp;characteristic of <strong>membranous nephropathy</strong>.</p>\n<p>Membranous nephropathy is one of the most common causes of nephrotic syndrome. It is a form of chronic immune-complex-mediated disease.</p>\n<ul>\n<li>Light microscopy: Diffuse thickening of the glomerular capillary wall without cellular proliferation.&nbsp;Irregular spikes projecting from the basement membrane are best seen with silver stains.</li>\n<li>Immunofluorescence microscopy:&nbsp;granular deposits containing Ig and complement along the glomerular basement membrane</li>\n<li>Electron micrograph:&nbsp;electron-dense subepithelial deposits (epi membranous spikes) and effacement of foot processes of podocytes</li>\n</ul>\n<div class=\"page\" title=\"Page 920\">The silver stain of the glomerulus highlights the proteinaceous basement membranes in black. There are characteristic \"<strong>spikes\" </strong>of the basement membrane between the immune deposits of membranous nephropathy.&nbsp;The black basement membrane material shown here appears as&nbsp;<strong>projections&nbsp;</strong>in the capillary loops.&nbsp;</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ade5195333df48caad1715bf84943439.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/14de4faa32f6428793277d7d8e12fbcax800x533.JPEG"
    ]
  },
  {
    "text": "A 51-year-old male patient came with complaints of hematuria to the clinic. On examination, he was normotensive and had pedal edema. Investigations revealed the patient had no glycosuria and had a creatinine of 9. His renal biopsy is shown below. Which of the following investigations should be done to identify the disease?",
    "choices": [
      {
        "id": 1,
        "text": "ANA"
      },
      {
        "id": 2,
        "text": "Anti GBM antibodies"
      },
      {
        "id": 3,
        "text": "HIV RNA"
      },
      {
        "id": 4,
        "text": "Serum electrophoresis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Based on the given clinical history and microscopy showing <strong>crescents,</strong>\u00a0<strong>RPGN (type -1) </strong>is suspected. To confirm <strong>anti-GBM </strong>(Glomerular basement membrane) <strong>antibody testing</strong>\u00a0should be done.</p>\n<p class=\"ng-binding\"><strong>Type 1 RPGN</strong>\u00a0includes\u00a0renal limited disease\u00a0and\u00a0<strong>Goodpasture's</strong>\u00a0<strong>disease</strong>. In this condition, antibodies are produced against the non-collagenous domain of the<strong>\u00a0\u03b13 chain</strong>\u00a0of\u00a0<strong>collagen IV</strong>\u00a0of the GBM.</p>\n<p>Microscopy findings of Goodpasture's disease are:</p>\n<ul>\n<li>Immunofluorescence -\u00a0<strong>l</strong><strong>inear deposits\u00a0</strong>of<strong>\u00a0Ig\u00a0</strong>and<strong>\u00a0complement\u00a0</strong>along the glomerular basement membrane</li>\n<li>Electron microscopy -\u00a0<strong>wrinkling</strong>\u00a0of the glomerular basement membrane with\u00a0<strong>focal disruptions\u00a0</strong>without any immune complex deposition.</li>\n</ul>\n<p>A variant of Goodpasture's disease with\u00a0<strong>pulmonary involvement</strong>\u00a0is known as\u00a0<strong>Goodpasture's syndrome.</strong></p>\n<p>Option A:<strong> ANA</strong>(Antinuclear Antibody) testing is done if <strong>SLE</strong> is suspected. Electron microscopy will show immune complex deposits.</p>\n<p>Option C: <strong>HIV RNA</strong> in case of <strong>focal segmental glomerulosclerosis</strong>. Electron microscopy will show diffuse podocyte injury with complete foot process effacement.\u00a0</p>\n<p>Option D:\u00a0<strong>Serum electrophoresis</strong> is done for <strong>multiple myeloma</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/524e94573a524eed81434a719c5566d1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An ICU patient on central venous catheter developed sepsis. The blood culture shows the growth of bacterial colonies. The peripheral blood smear picture of the individual is given. The structure marked by the arrow indicates ____.",
    "choices": [
      {
        "id": 1,
        "text": "Toxic granule"
      },
      {
        "id": 2,
        "text": "Dohle body"
      },
      {
        "id": 3,
        "text": "Barr body"
      },
      {
        "id": 4,
        "text": "Cytoplasmic vacuole"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given peripheral smear, prepared from an individual with <strong>bacterial sepsis</strong>, shows a reactive&nbsp;<strong>Dohle body.</strong></p>\n<p>Reactive changes in neutrophils seen with leukocytosis in severe inflammation:</p>\n<ul>\n<li><strong>D&ouml;hle bodies</strong> are patches of the&nbsp;<strong>dilated endoplasmic reticulum</strong> that appear as <strong>sky-blue</strong> cytoplasmic &ldquo;<strong>puddles</strong>.&rdquo;</li>\n<li><strong>Cytoplasmic vacuoles&nbsp;</strong>&nbsp;</li>\n<li><strong>Toxic granules</strong>&nbsp;are <strong>coarser</strong> and <strong>darker</strong> than the normal neutrophilic granules and represent abnormal azurophilic (primary) granules as shown below.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/726e95f378664a00825163119c27dfe5.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/367ead97a4834d999c7d0bdf81d3a058x221x228.JPEG",
      "https://cdn1.dailyrounds.org/uploads/193712e3eeb344f4b78b7356572950e1x239x211.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1e5102ceaa304851a56d4cdf70e6d4a7x857x652.PNG"
    ]
  },
  {
    "text": "A pathologist is examining a liver biopsy specimen from a patient with liver disease. The following finding is noted. Which of the following is the most likely cause of this finding?",
    "choices": [
      {
        "id": 1,
        "text": "Atherosclerosis"
      },
      {
        "id": 2,
        "text": "Hepatitis B"
      },
      {
        "id": 3,
        "text": "Alcoholism"
      },
      {
        "id": 4,
        "text": "Hemolysis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given histopathological image shows hepatic <strong>macro-vesicular steatosis</strong>&nbsp;along with <strong>intraparenchymal cholestasis</strong>, which is suggestive of <strong>fatty</strong> <strong>liver</strong>. This condition can occur due to&nbsp;<strong>alcoholism</strong>.</p>\n<p>The lipid accumulates in the hepatocytes as <strong>vacuoles</strong>. These vacuoles have a <strong>clear appearance</strong> on hematoxylin and eosin staining.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ac9ad6aba7b141be903544f82ed80c7d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/813ac7433a95416f8c4a6fe0968ae57cx1280x1179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1738f18e668b41cab9b49af7768a9b11x1280x1179.JPEG"
    ]
  },
  {
    "text": "An autopsy of the lung of a female patient, who died of complications post-delivery, is shown in the histological image below.  What could be the pathogenesis?",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary embolism"
      },
      {
        "id": 2,
        "text": "Marrow embolism"
      },
      {
        "id": 3,
        "text": "Air embolism"
      },
      {
        "id": 4,
        "text": "Amniotic fluid embolism"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">The given image shows the presence of&nbsp;<strong>laminated swirls</strong>&nbsp;of squamous cells in the&nbsp;<strong>pulmonary arteriole</strong>&nbsp;which is characteristically seen in&nbsp;<strong>amniotic fluid embolism</strong>(AFE).</p>\n</div>\n</div>\n<p>AFE is a life-threatening obstetric emergency characterized by&nbsp;<strong>sudden cardiorespiratory collapse</strong>&nbsp;and disseminated intravascular coagulation (<strong>DIC</strong>). The underlying cause is the&nbsp;infusion of amniotic fluid or fetal tissue into the maternal circulation via a&nbsp;<strong>tear</strong>&nbsp;in the&nbsp;<strong>placental membranes</strong>&nbsp;or&nbsp;<strong>rupture</strong>&nbsp;of&nbsp;<strong>uterine veins</strong>.</p>\n<p>Findings at autopsy include:</p>\n<ul>\n<li>Substances in the maternal pulmonary micro-vasculature\n<ul>\n<li>Squamous cells shed from fetal skin</li>\n<li>Lanugo hair</li>\n<li>Fat from vernix caseosa</li>\n<li>Mucin derived from the fetal respiratory or gastrointestinal tract&nbsp;</li>\n</ul>\n</li>\n<li>Marked pulmonary edema</li>\n<li>Diffuse alveolar damage</li>\n<li>Presence of fibrin thrombi in many vascular beds due to DIC</li>\n</ul>\n<p><strong>Other options:</strong></p>\n<ul>\n<li><strong>Aggregates</strong> of <strong>platelets</strong> represent&nbsp;<strong>thrombosis</strong>.</li>\n<li><strong>Fat globules</strong> are seen in <strong>fat embolism</strong>, usually after severe trauma.&nbsp;</li>\n<li><strong>Gas bubbles</strong> in vessels from air embolism can be a rare event in some obstetric procedures, but it is an unlikely event in natural deliveries.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3b071dc51dac4280955cefd5a61fcbbe.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A nephrectomy specimen of a 40-year-old man showed the following histological picture. The familial cancer syndrome most likely to be associated with this type is  ____________",
    "choices": [
      {
        "id": 1,
        "text": "Von Hippel-Lindau syndrome"
      },
      {
        "id": 2,
        "text": "Hereditary leiomyomatosis and renal cell cancer syndrome"
      },
      {
        "id": 3,
        "text": "Birt-Hogg-Dube syndrome"
      },
      {
        "id": 4,
        "text": "Tuberous sclerosis complex"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image is of&nbsp;<strong>chromophobe renal cell carcinoma </strong>is&nbsp;most likely to be associated with<strong>&nbsp;Birt&ndash;Hogg&ndash;Dube</strong></p>\n<p>Chromophobe carcinoma&nbsp;is thought to arise from the&nbsp;<strong>intercalated cells</strong>&nbsp;of the collecting ducts. It is composed of cells with prominent cell membranes and <strong>pale eosinophilic cytoplasm</strong>, usually with a <strong>halo</strong> <strong>around the nucleus</strong>.&nbsp;They are arranged in solid sheets with a concentration of the largest cells around blood vessels.&nbsp;</p>\n<p>Cytogenetic examination of the tumor shows multiple&nbsp;<strong>chromosome losses</strong>&nbsp;and&nbsp;<strong>extreme hypodiploidy.&nbsp;</strong>It has an&nbsp;<strong>excellent prognosis</strong>&nbsp;compared to clear cell and papillary cancers.&nbsp;</p>\n<p>Close differential diagnoses are&nbsp;as follows:</p>\n<ul>\n<li>Oncocytoma: They also consist of large eosinophilic cells having small, round, benign-appearing nuclei that have large nucleoli. However, they do not show perinuclear halo.</li>\n<li>Clear cell RCC:&nbsp;<strong>Pale eosinophilic cytoplasm&nbsp;</strong>in chromophobe RCC distinguishes it from the&nbsp;<strong>clear appearance</strong>&nbsp;of the cytoplasm due to the accumulation of glycogen and lipids in clear-cell RCC.</li>\n</ul>\n<p class=\"p1\"><strong><span class=\"s1\">Other options:</span></strong></p>\n<ul class=\"ul1\">\n<li class=\"li1\"><span class=\"s1\">Hereditary leiomyomatosis and renal cell cancer syndrome: Papillary RCC</span></li>\n<li class=\"li1\"><span class=\"s1\">Tuberous sclerosis: Angiomyolipoma</span></li>\n<li class=\"li1\"><span class=\"s1\">Von Hippel<strong>&ndash;</strong>Lindau<strong>&nbsp;</strong></span><span class=\"s1\">syndrome: Clear-cell RCC</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a757725458c146f2a54bb900020b63f6.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 009 (Histopathological Images)';
        const quizFilename = 'fmge-mini-test-009-histopathological-images-ef886ede.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>