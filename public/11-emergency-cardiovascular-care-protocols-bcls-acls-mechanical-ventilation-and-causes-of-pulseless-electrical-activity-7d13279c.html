<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11 Emergency Cardiovascular Care Protocols (Bcls, Acls, Mechanical Ventilation) And Causes Of Pulseless Electrical Activity - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">13</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>You are walking in a park when you notice an elderly person collapse in front of you. Which of the following is the first step in managment of this patient?\u00a0\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Initiate chest compressions"
      },
      {
        "id": 2,
        "text": "Check for scene safety"
      },
      {
        "id": 3,
        "text": "Call for help"
      },
      {
        "id": 4,
        "text": "Check carotid pulse"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B)\u00a0Check scene safety\u00a0</strong></p>\n\n<p><strong>Explanation:\u00a0</strong></p>\n\n<ul>\n\t<li><strong>Ensure scene safety:</strong> before starting any BLS, ensure the environment is safe. Remove the victim from any immediate danger, such as standing water or traffic.</li>\n\t<li>Tap on the shoulder and speak loudly in a language the victim could understand to <strong>elicit a response </strong>from the victim.</li>\n\t<li><strong>Call for help</strong>, inform the emergency medical system, and get emergency equipment.\u00a0</li>\n\t<li>Check for the<strong> <span class=\"customMeta\" data-dictid=\"8593e48e0416927771834eaedb0bfd\">carotid</span> pulse</strong> for 5\u201310 seconds and the <strong>breathing effort </strong>simultaneously by looking for chest rise.\u00a0\n\t<ul>\n\t\t<li><strong>Normal breathing with a definite <span class=\"customMeta\" data-dictid=\"8593e48e0416927771834eaedb0bfd\">carotid</span> pulse</strong>: the victim needs to be assessed every 2 min or earlier to determine any change in condition.</li>\n\t\t<li><strong>Abnormal or no breathing with a definite <span class=\"customMeta\" data-dictid=\"8593e48e0416927771834eaedb0bfd\">carotid</span> pulse</strong>: the victim is in <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> arrest and should be provided normal <span class=\"customMeta\" data-dictid=\"9de1765e531692777200d737a38c98\">tidal</span> volume breaths every 5 s or 12 breaths every minute using mouth-to-mouth, mouth-to-mask, or bag-mask device ventilation.</li>\n\t\t<li><strong>Abnormal or no breathing without a definite <span class=\"customMeta\" data-dictid=\"8593e48e0416927771834eaedb0bfd\">carotid</span> pulse</strong>: the victim is in <span class=\"customMeta\" data-dictid=\"0f0e2f0fe91692777183bfa6c6a156\">cardiopulmonary</span> arrest and requires high-quality CPR including cycles of <span class=\"customMeta\" data-dictid=\"56af81fad316927771843d2b4b1e4f\">compression</span> and breaths at the earliest. <strong>(Option A)</strong></li>\n\t</ul>\n\t</li>\n</ul>\n\n<ul>\n\t<li>A cycle of CPR is 30 chest compressions: 2 breaths with the speed of chest compressions at 120/min and <span class=\"customMeta\" data-dictid=\"56af81fad316927771843d2b4b1e4f\">compression</span> depth at 5\u20136 cm.</li>\n\t<li>Once the emergency equipment is available, like an AED or defibrillator, they are used for further resuscitation.</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"Steps of Basic Cardiac Life Support (BCLS) outside the hospital\" data-author=\"\" data-hash=\"8756\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"683\" src=\"https://image.prepladder.com/notes/ybhvfBsrtQ9GgJtaFcvG1744302116.png\" width=\"519\" /></p>\n\n<p><strong>Automated External Defibrillator:</strong></p>\n\n<ul>\n\t<li>Turn On the AED.</li>\n\t<li>Follow audio instructions: Listen to the voice prompts provided by the AED.</li>\n\t<li>Attach pads: Place the AED pads on the victim\u2019s chest while continuing chest compressions, <strong>one in the right <span class=\"customMeta\" data-dictid=\"71409dc88a1692777190aedbc558b6\">infraclavicular</span> region and 2nd below the left <span class=\"customMeta\" data-dictid=\"9fdffd913216927771936512ee5b2a\">nipple</span> into the axilla.</strong></li>\n\t<li>Analyze Heart Rhythm: allow the AED to assess the <span class=\"customMeta\" data-dictid=\"0c0ace39ac16927771898a14fb0cc3\">heart rhythm</span> and ensure no one is touching the victim during this analysis.</li>\n\t<li>Deliver Shock: if the AED indicates, administer the <span class=\"customMeta\" data-dictid=\"9dfcfd203016927771875d7fe03efb\">electric shock</span> as directed.</li>\n\t<li>Resume CPR: immediately continue CPR, starting with chest compressions.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/ybhvfBsrtQ9GgJtaFcvG1744302116.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/TT4JiY5NuzpvdcEEkqH01752115519.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/o24M9U5DlSuDlrzie4Ox1752115588.mp3"
  },
  {
    "text": "<p>You are intern posted in ICU. Nurse calls you to assist for a sepsis patient whose ECG monitor is showing the following display and she has started chest compressions. Which of the following is the first step in managment of this patient?\u00a0</p>\n\n<p style=\"text-align:center\"><img alt=\"ECG pattern seen in Ventricular Fibrillation\" data-author=\"\" data-hash=\"8763\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"204\" src=\"https://image.prepladder.com/notes/UvsEFj8FghHUawIAdirz1744302492.png\" width=\"857\" /></p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Intubate the patient"
      },
      {
        "id": 2,
        "text": "Defibrillation"
      },
      {
        "id": 3,
        "text": "Cardioversion"
      },
      {
        "id": 4,
        "text": "Amiodarone"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer is B: Defibrillation</strong></p>\n\n<ul>\n\t<li>ECG shows chaotic, <span class=\"customMeta\" data-dictid=\"863f5457381692777190f05632a8b2\">irregular</span> waveforms without distinct QRS complexes or P waves seen in\u00a0<strong>ventricular fibrillation. This is a shockable rythm\u00a0</strong></li>\n\t<li><strong>Immediate defibrillation</strong> is the primary treatment to restore a normal heart rhythm</li>\n</ul>\n\n<p>\u00a0</p>",
    "question_images": [
      "https://image.prepladder.com/notes/UvsEFj8FghHUawIAdirz1744302492.png"
    ],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/FCTiDgCPKbmTlBkjRC3P1752115665.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/dBHnNWGl9BU1b78d6N2i1752115771.mp3"
  },
  {
    "text": "<p>65 year old patient with anterior wall MI develops asystole. Which of the following is the first step in managment of this patient?\u00a0\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Asses for reversible causes"
      },
      {
        "id": 2,
        "text": "Check pulse"
      },
      {
        "id": 3,
        "text": "Chest compressions @30:2"
      },
      {
        "id": 4,
        "text": "10 ml 1:10,000 Epinephrine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct answer- </strong>C:\u00a0Chest compressions @30:2</p>\n\n<p>Patient has developed Asystole/ Flat line ECG. First step would be to start CPR @30:2 to ensure <span class=\"customMeta\" data-dictid=\"82cc227a1c169277718387905b50c6\">blood flow</span> to cerebral circulation. Epinephrine should be given as soon as possible. It may not be avaliable immediately and securing IV line will also take time.\u00a0</p>\n\n<p><strong>Reversible Causes of <span class=\"customMeta\" data-dictid=\"e1fb96fd2416927771830dfed40e14\">Cardiac</span> Arrest\u00a0</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:475px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>H's </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>T's </strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hypovolemia</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Tension pneumothorax</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hypoxia</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Tamponade (cardiac)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hydrogen <span class=\"customMeta\" data-dictid=\"4b2f2a6d0a16927771902f60fa9ff7\">ion</span> (acidosis)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Toxins</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hypo-/Hyperkalemia</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Thrombosis (coronary MI</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hypothermia</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Thrombosis (pulmonary embolism)</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/cZkYsniw0FKKuVrM0aSs1752115838.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/vGVc4Cl4TmRw7hYRGR6l1752115902.mp3"
  },
  {
    "text": "<p><strong>Assertion: </strong>Cardioversion is the preferred treatment for hemodynamic compromise caused by\u00a0 supraventricular tachycardia\u00a0<br />\n<strong>Reason: </strong>Synchronized direct current (DC) shock is administered at the peak of the R wave to avoid R on T phenomenon\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Both assertion and reason are true, and the reason is a correct explanation of the assertion."
      },
      {
        "id": 2,
        "text": "Both assertion and reason are true, but the reason is not a correct explanation of the assertion."
      },
      {
        "id": 3,
        "text": "The assertion is true, but the reason is false."
      },
      {
        "id": 4,
        "text": "The assertion is false, but the reason is true."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option A is correct\u00a0</p>\n\n<p>The <strong>R-on-T phenomenon</strong> refers to a shock falling on the <strong>T wave (ventricular repolarization)</strong>, which can <strong>induce <span class=\"customMeta\" data-dictid=\"fc8cac43cc16927772015049bb5ab8\">ventricular</span> fibrillation</strong>.</p>\n\n<p><strong>Synchronized cardioversion</strong> times the shock with the <strong>R wave</strong>, avoiding this risk.\u00a0</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Feature</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Cardioversion</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Defibrillation</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\"><strong>Definition</strong></td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>A synchronized electrical shock to reset the <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> heart rhythm.</p>\n\n\t\t\t<div style=\"text-align:center\">\n\t\t\t<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"Illustration of Cardioversion\" data-author=\"Jmarchn\" data-hash=\"8772\" data-license=\"CC BY-SA 3.0\" data-source=\"https://en.wikipedia.org/wiki/Cardioversion#/media/File:Cardioversion.svg\" data-tags=\"April2025\" height=\"208\" src=\"https://image.prepladder.com/notes/0rzG9Tw7NjHej0EM0fRx1744302905.png\" width=\"247\" />\n\t\t\t<figcaption>{{caption_text}}</figcaption>\n\t\t\t</figure>\n\t\t\t</div>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>An unsynchronized shock to correct life-threatening arrhythmias.</p>\n\n\t\t\t<div style=\"text-align:center\">\n\t\t\t<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"View of defibrillator electrode position and placement\" data-author=\"PhilippN\" data-hash=\"8774\" data-license=\"CC BY-SA 3.0\" data-source=\"https://en.wikipedia.org/wiki/Defibrillation#/media/File:Defibrillation_Electrode_Position.jpg\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/1XEnwydKEesPz1M5PjuX1744302985.png\" />\n\t\t\t<figcaption>{{caption_text}}</figcaption>\n\t\t\t</figure>\n\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:121px\">\n\t\t\t<p style=\"text-align:center\"><strong>Mechanism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:259px\">\n\t\t\t<p>Synchronized with the R wave in the ECG (delivered at the peak of the R wave)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:244px\">\n\t\t\t<p>Delivered irrespective of the R wave (unsynchronized)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:121px\">\n\t\t\t<p style=\"text-align:center\"><strong>Physiological Effect</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:259px\">\n\t\t\t<p>Stops <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> contractions to allow the heart to reset, followed by the SA <span class=\"customMeta\" data-dictid=\"b10ce4acbf169277719323ffd12306\">node</span> resuming normal activity</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:244px\">\n\t\t\t<p>Halts all <span class=\"customMeta\" data-dictid=\"c34137b40a1692777187edcef44647\">electrical activity</span> in the heart, hoping normal rhythm restarts</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:121px\">\n\t\t\t<p style=\"text-align:center\"><strong>Indications</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:259px\">\n\t\t\t<p>Performed in arrhythmias where the heart is still contracting but irregularly, such as:\u00a0</p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Paroxysmal Supraventricular Tachycardia (PSVT)</li>\n\t\t\t\t<li>Atrial <span class=\"customMeta\" data-dictid=\"6ae0ac06031692777202699c4c75a0\">Fibrillation</span> (AF)</li>\n\t\t\t\t<li>Atrial Flutter</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:244px\">\n\t\t\t<p>Performed in life-threatening arrhythmias where the heart is not pumping blood effectively, such as:</p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Ventricular <span class=\"customMeta\" data-dictid=\"6ae0ac06031692777202699c4c75a0\">Fibrillation</span> (VF)</li>\n\t\t\t\t<li>Pulseless <span class=\"customMeta\" data-dictid=\"fc8cac43cc16927772015049bb5ab8\">Ventricular</span> Tachycardia (VT)</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:121px\">\n\t\t\t<p style=\"text-align:center\"><strong>Energy Level</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:259px\">\n\t\t\t<p>Usually lower energy levels (e.g., 50-100 joules for AF)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:244px\">\n\t\t\t<p>Usually higher energy levels (e.g., 150-360 joules for VF)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:121px\">\n\t\t\t<p style=\"text-align:center\"><strong>Performed in</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:259px\">\n\t\t\t<p>Elective procedure, typically not in emergencies.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:244px\">\n\t\t\t<p>Emergencies (like during a <span class=\"customMeta\" data-dictid=\"e1fb96fd2416927771830dfed40e14\">cardiac</span> arrest).</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:121px\">\n\t\t\t<p style=\"text-align:center\"><strong>Complications</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:259px\">\n\t\t\t<p>Less risk of inducing dangerous arrhythmias due to synchronization.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top; width:244px\">\n\t\t\t<p>Higher risk of inducing other arrhythmias (e.g., R-on-T phenomenon) if the shock is delivered improperly.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/0rzG9Tw7NjHej0EM0fRx1744302905.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/PgS2TEgI2BgPqCoeUa7B1752116033.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/FFKsy7g65uFhvWiWLSQi1752116125.mp3"
  },
  {
    "text": "<p>You are resuscitating a patient with following ECG tracing in ER. CPR is given @30:2 and 10 ml of 1: 10,000 adrenaline is given twice at interval of 3 minutes but the tracing is still the same. What is next best step in managment of this patient\u00a0</p>\n\n<p style=\"text-align:center\"><img alt=\"ECG pattern seen in Asystole\" data-author=\"\" data-hash=\"8766\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"255\" src=\"https://image.prepladder.com/notes/lz9zqS4AVzrs3kxG792J1744302688.png\" width=\"829\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Repeat 10 ml of 1: 10,000 adrenaline iv"
      },
      {
        "id": 2,
        "text": "Repeat 1 ml of 1: 10,000 adrenaline iv"
      },
      {
        "id": 3,
        "text": "Give DC shock 200J biphasic"
      },
      {
        "id": 4,
        "text": "Give DC shock 360J monophasic"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Correct answer is <strong>A</strong>:\u00a0Repeat 10 ml of 1: 10,000 adrenaline</p>\n\n<p>Repeated <span class=\"customMeta\" data-dictid=\"35b6a8aeb416927771805fcc2e7dfb\">adrenaline</span> administration in asytole may convert this flat line ECG into <span class=\"customMeta\" data-dictid=\"fc8cac43cc16927772015049bb5ab8\">ventricular</span> <span class=\"customMeta\" data-dictid=\"6ae0ac06031692777202699c4c75a0\">fibrillation</span> which can\u00a0 then be given <span class=\"customMeta\" data-dictid=\"66e0f32ec216927771851ee930e967\">defibrillation</span> to restore normal <span class=\"customMeta\" data-dictid=\"b0046463171692777198e0beea83e7\">sinus</span> rythm.\u00a0\u00a0</p>\n\n<p><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"500\" src=\"https://image.prepladder.com/content/NcnslMsFs5dS2bxX5nQT1752143074.png\" width=\"500\" /></p>",
    "question_images": [
      "https://image.prepladder.com/notes/lz9zqS4AVzrs3kxG792J1744302688.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/NcnslMsFs5dS2bxX5nQT1752143074.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/Mpgt7OFwLZ4hBkHVU6V81752116438.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/m3yKfVgpuEIwLTt6oCzY1752116807.mp3"
  },
  {
    "text": "<p>A 65-year-old male in the ICU is having crashing blood pressure. ECG tracing shows Ventricular fibrillation. 200 J biphasic shock is given to patient. Which of the following is next best step for managment of this patient?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Amiodarone"
      },
      {
        "id": 2,
        "text": "Start CPR"
      },
      {
        "id": 3,
        "text": "Secure advanced airway"
      },
      {
        "id": 4,
        "text": "Epinephrine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Option B: Start CPR\u00a0\u00a0</strong></p>\n\n<p>Immediately after defibrillation, the rythm make some time to reset to normal. During this time, chest compressions must continue@30:2.\u00a0</p>\n\n<p><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"1273\" src=\"https://image.prepladder.com/content/805yweBLQ9ADvg3RUbLO1752143141.png\" width=\"800\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/805yweBLQ9ADvg3RUbLO1752143141.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/CbtUEKdDI0xlnERNW6E91752117420.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/ii7FNFFQRLFFrgDbbqVo1752117503.mp3"
  },
  {
    "text": "<p>An alcoholic is admitted with diagnosis acute pancreatitis. On day 2 evening, he is shifted to ICU for Ventilator assistance for ARDS. Which of the following statements is not correct regarding the management of this patient?\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Set tidal volume of 12 mL/kg lean body weight"
      },
      {
        "id": 2,
        "text": "Prone positioning"
      },
      {
        "id": 3,
        "text": "Set FiO2 at 1.0 and then titrate down to maintain pO2 55- 80 mm Hg"
      },
      {
        "id": 4,
        "text": "Adjust Respiratory rate to keep pH > 7.3"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Correct answer is: A:\u00a0Set <span class=\"customMeta\" data-dictid=\"9de1765e531692777200d737a38c98\">tidal</span> volume of 12 mL/kg lean body weight</p>\n\n<p>Tidal volume should be kept at 6 ml per kg of lean body weight to enable. FiO2 (Fraction of Inspired Oxygen) is\u00a0Initially set at 1.0 (100% oxygen) and then <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> to the lowest level needed to maintain adequate oxygenation. Permissive <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">hypercapnia</span> is allowed so keeping a pH of >7.3 is fine while adjusting <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> rate.\u00a0</p>\n\n<p><strong>Ventilator Settings for ARDS\u00a0</strong></p>\n\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:100%\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td><strong>Parameter\u00a0</strong></td>\n\t\t\t<td><strong>Recommended Setting\u00a0</strong></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Mode\u00a0</td>\n\t\t\t<td>Volume Assist-Control (AC) or Pressure-Control Ventilation</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Tidal Volume (VT)</td>\n\t\t\t<td>4-6 mL/kg of predicted body weight (PBW) - Prevents barotrauma/volutrauma\u00a0</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Plateau Pressure\u00a0</td>\n\t\t\t<td>\u2264 30 cm H<sub>2</sub>O - to reduce lung injury\u00a0</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>PEEP</td>\n\t\t\t<td>use PEEP -FiO<sub>2</sub>\u00a0titration\u00a0table (typically 5 -15 cm H<sub>2</sub>O, can go up to 20 in severe ARDS)</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>FiO2</td>\n\t\t\t<td>Strat with 100% (1.0), then <span class=\"customMeta\" data-dictid=\"6ed68ca4781692777200701c57e5a3\">titrate</span> down to maintain SpO<sub>2</sub> 88-95% or PaO<sub>2</sub> 55-80 mmHg</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Respiratory Rate</td>\n\t\t\t<td>Adjust to maintain pH \u2265 7.30 (can be up to 35/min); permissive <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">hypercapnia</span> is allowed\u00a0</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Driving Rate\u00a0</td>\n\t\t\t<td>Keep <15 cm H<sub>2</sub>O - (Driving pressure = Plateau pressure - PEEP)</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>I:E Ratio</td>\n\t\t\t<td>Typically 1:1 to 1:2 (can prolong <span class=\"customMeta\" data-dictid=\"2cbabc42d21692777187c451566867\">expiration</span> if needed)</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Prone Positioning\u00a0</td>\n\t\t\t<td>Consider if PaO<sub>2</sub>/FiO<sub>2</sub> < 150 despite <span class=\"customMeta\" data-dictid=\"208cf74d74169277719486afd05eb3\">optimal</span> settings</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/rPC21EXvw6xX9c0kx5Nd1752117592.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/JeHvDmzWmAZ81hhDS9pc1752117982.mp3"
  },
  {
    "text": "<p>A 58-year-old male patient with chronic obstructive pulmonary disease (COPD) is admitted to the hospital and placed on mechanical ventilation. His arterial blood gas analysis shows the following values: PaO2: 86 mmHg, PaCO2: 50 mmHg and pH: 7.32. Which of the following management strategies should be prioritized for this patient?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Decrease the tidal volume to improve ventilation."
      },
      {
        "id": 2,
        "text": "Increase the FiO2 immediately to avoid oxygen toxicity."
      },
      {
        "id": 3,
        "text": "Increase PEEP to improve oxygenation and maintain lung recruitment."
      },
      {
        "id": 4,
        "text": "Increase the expiratory time to promote CO2 washout"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Answer is D:\u00a0Increase the <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> time to promote CO2 washout</p>\n\n<p>In a mechanically ventilated COPD patient, the most appropriate strategy is to <strong>increase <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> time to enhance CO\u2082 <span class=\"customMeta\" data-dictid=\"67d67b341916927772029cd0d951df\">washout</span> and prevent air trapping</strong>. These patients have prolonged <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> resistance, and allowing insufficient <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> time can lead to <strong>dynamic <span class=\"customMeta\" data-dictid=\"301f9a675d16927771892fb39029d3\">hyperinflation</span> and auto-PEEP</strong>, worsening ventilation.</p>\n\n<p>Decreasing <span class=\"customMeta\" data-dictid=\"9de1765e531692777200d737a38c98\">tidal</span> volume (Option A) would reduce <span class=\"customMeta\" data-dictid=\"48780228371692777192344586b3b3\">minute ventilation</span> and worsen hypercapnia. Increasing FiO\u2082 (Option B) is unnecessary as the patient\u2019s PaO\u2082 is adequate, and excessive oxygen may depress <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> drive in COPD. While increasing PEEP (Option C) may help alveolar <span class=\"customMeta\" data-dictid=\"9bb62ce0f71692777197fcc2b5f29c\">recruitment</span> in restrictive lung diseases, it must be used cautiously in COPD due to the risk of worsening air trapping. Therefore, <strong>optimizing <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> time by reducing <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> rate and adjusting the I:E ratio is the safest and most effective intervention</strong> in this scenario.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/NsEy2RnF4xuSzXUoh5tP1752092766.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/cmET3QHpX09wJvvxjtsk1752093033.mp3"
  },
  {
    "text": "<p>A 35-year-old male with Guillain-Barr\u00e9 Syndrome develops progressive respiratory muscle weakness and is placed on mechanical ventilation. Which of the following ventilator modes is most appropriate in this setting?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Pressure Support Ventilation"
      },
      {
        "id": 2,
        "text": "Synchronized Intermittent Mandatory Ventilation"
      },
      {
        "id": 3,
        "text": "Assist-Control Mechanical Ventilation"
      },
      {
        "id": 4,
        "text": "Continuous Positive Airway Pressure"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Correct answer is C:\u00a0Assist-Control Mechanical Ventilation</p>\n\n<p><strong>Assist-Control (ACMV)</strong> provides full <span class=\"customMeta\" data-dictid=\"f14b6fe4d3169277720152885b1b38\">ventilatory</span> support, delivering breaths whether initiated by the patient or not \u2014 <strong>ideal</strong> for <span class=\"customMeta\" data-dictid=\"8b19cd5e161692777193ad958e52e0\">neuromuscular</span> weakness like GBS.<br />\n<strong>PSV (option A)</strong>\u00a0 requires some <span class=\"customMeta\" data-dictid=\"f71e485d131692777199151d1076d2\">spontaneous</span> <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> effort, which GBS patients may lack.<br />\n<strong>SIMV (option B)</strong> allows <span class=\"customMeta\" data-dictid=\"f71e485d131692777199151d1076d2\">spontaneous</span> breathing between mandatory breaths but may lead to fatigue in GBS.<br />\n<strong>CPAP (option D)</strong> is a non-invasive mode suited for <span class=\"customMeta\" data-dictid=\"f71e485d131692777199151d1076d2\">spontaneous</span> breathing and <strong>not indicated</strong> for <span class=\"customMeta\" data-dictid=\"f14b6fe4d3169277720152885b1b38\">ventilatory</span> failure from <span class=\"customMeta\" data-dictid=\"8b19cd5e161692777193ad958e52e0\">neuromuscular</span> paralysis.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/bE3KHK0Jdlevdm9h84Hz1752092274.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/k2GiqaVxH8mRiB1cTllS1752092409.mp3"
  },
  {
    "text": "<p>A 60-year-old male is on mechanical ventilation for acute hypoxemic respiratory failure (Type 1). His latest ABG shows:<br />\n<strong>pH: 7.43, PaCO\u2082: 38 mmHg, PaO\u2082: 54 mmHg, HCO\u2083\u207b: 24 mEq/L.</strong><br />\nWhich of the following changes should be made to improve his oxygenation?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Increase tidal volume"
      },
      {
        "id": 2,
        "text": "Increase FiO\u2082"
      },
      {
        "id": 3,
        "text": "Decrease respiratory rate"
      },
      {
        "id": 4,
        "text": "Increase minute ventilation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Correct answer is B: Increase Fio2</p>\n\n<p>The patient has <strong>Type 1 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure</strong> (low PaO\u2082 with normal PaCO\u2082), indicating a <strong>pure <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> problem</strong>.<br />\n<strong>Increasing FiO\u2082</strong> is the most direct and effective way to raise PaO\u2082.It is alos the lastest and simplest way to improve oxygenation. It provides immediate increase in alveolar oxygen concentration and thus raises PaO\u2082 quickly. Always <span class=\"customMeta\" data-dictid=\"6ed68ca4781692777200701c57e5a3\">titrate</span> FiO\u2082 up to 60% (0.6) before increasing PEEP.<br />\n<strong>Increasing <span class=\"customMeta\" data-dictid=\"9de1765e531692777200d737a38c98\">tidal</span> volume (A)</strong> or <strong>minute <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> (D)</strong> would reduce CO\u2082, not help oxygenation.<br />\n<strong>Decreasing RR (C)</strong> would worsen <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> by <span class=\"customMeta\" data-dictid=\"ff02aa40d51692777191246d4a9b87\">lowering</span> <span class=\"customMeta\" data-dictid=\"48780228371692777192344586b3b3\">minute ventilation</span> and overall alveolar exposure to oxygen.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/JmLwKENAzSHM4yZD0thz1752092113.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/IaBZKidlhOvGehrA8JII1752092178.mp3"
  },
  {
    "text": "<p>A 28-year-old male is admitted to the ICU after sustaining blunt chest trauma in a motor vehicle accident. Chest imaging reveals pulmonary contusions. After 48 hours, he develops severe hypoxemia with PaO\u2082/FiO\u2082 ratio of 110, bilateral infiltrates on chest X-ray, and no signs of left heart failure. What is the most appropriate next step in management?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Insert a wide-bore needle in the fifth intercostal space"
      },
      {
        "id": 2,
        "text": "Start intravenous furosemide to reduce pulmonary edema"
      },
      {
        "id": 3,
        "text": "Begin low tidal volume mechanical ventilation"
      },
      {
        "id": 4,
        "text": "Initiate high-flow nasal cannula oxygen therapy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Answer is C: Low volume ventilation\u00a0</p>\n\n<p>This patient has developed ARDS, likely secondary to <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> contusion, confirmed by <span class=\"customMeta\" data-dictid=\"625feb7e3a1692777183aa9d923cfd\">bilateral</span> infiltrates and low PaO\u2082/FiO\u2082 ratio. The cornerstone of ARDS management is lung-protective <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> using low <span class=\"customMeta\" data-dictid=\"9de1765e531692777200d737a38c98\">tidal</span> volumes (4\u20136 mL/kg of predicted body weight) to prevent <span class=\"customMeta\" data-dictid=\"f52005af9b169277720262a7fd6b3f\">volutrauma</span> and barotrauma. Option <strong>A </strong>(wide-bore needle) is used for tension pneumothorax, which would present with absent <span class=\"customMeta\" data-dictid=\"baa424d2de16927771836afd73785b\">breath sounds</span> and <span class=\"customMeta\" data-dictid=\"cdf4a197dd16927771881a652c8328\">hemodynamic</span> compromise, not <span class=\"customMeta\" data-dictid=\"89275101301692777186567d1912a0\">diffuse</span> infiltrates. Option <strong>B (Lasix) may be harmful here</strong>, as ARDS is due to <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> alveolar damage, not fluid overload. Option <strong>D</strong> (HFNC) is<strong> insufficient </strong>in moderate-to-severe ARDS, where <span class=\"customMeta\" data-dictid=\"1c5272ad3d1692777190e71409d07a\">invasive</span> <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> is required to maintain <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> and protect lungs.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/kNoiPVv79gY3VW6xBeSN1752091934.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/ajzdslZTgjmrabLLWFdS1752118168.mp3"
  },
  {
    "text": "<p>A 45-year-old male presents with acute shortness of breath, orthopnea, and bilateral pulmonary crackles. Work up shows elevated Pro-NT- BNP levels and ABG shows type 1 respiratory failure with pO2=60 mm Hg. Which of the following is best to improve his oxygenation status?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "High-flow nasal cannula"
      },
      {
        "id": 2,
        "text": "Urgent intubation"
      },
      {
        "id": 3,
        "text": "Non-rebreather mask"
      },
      {
        "id": 4,
        "text": "NIV using Bi-PAP"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Answer is D:\u00a0NIV using Bi-PAP</strong></p>\n\n<ul>\n\t<li>\n\t<p>The patient has <strong>acute <span class=\"customMeta\" data-dictid=\"da8747dcd51692777185e1ed0554cc\">decompensated</span> heart failure</strong> (orthopnea, crackles, elevated NT-proBNP) with <strong>Type 1 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure</strong> (hypoxemia without hypercapnia).</p>\n\t</li>\n\t<li>\n\t<p><strong>BiPAP (Bilevel Positive Airway Pressure)</strong> helps by:</p>\n\n\t<ul>\n\t\t<li>\n\t\t<p>Providing <strong>positive pressure during inspiration (IPAP)</strong> and <strong>expiration (EPAP)</strong>, improving <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> and offloading the failing left ventricle.</p>\n\t\t</li>\n\t\t<li>\n\t\t<p>Reducing <strong>preload and afterload</strong>, thus relieving <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> <span class=\"customMeta\" data-dictid=\"18b452e75916927771864c9ad533e1\">edema</span> and improving gas exchange.</p>\n\t\t</li>\n\t</ul>\n\t</li>\n\t<li>\n\t<p><strong>HFNC</strong> improves <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> but lacks the <span class=\"customMeta\" data-dictid=\"3121d7693a169277719696af2cead1\">positive pressure</span> support needed in <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> edema.</p>\n\t</li>\n\t<li>\n\t<p><strong>Invasive ventilation</strong> is reserved for severe <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> distress, altered mental status, or failure of NIV.</p>\n\t</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/KXISAoW3TwIuX1EKg3kZ1752091537.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/rXPfR01xgJQadejnUV7n1752091724.mp3"
  },
  {
    "text": "<p>A 68-year-old male with a history of COPD presents with increasing dyspnea, productive cough, and confusion. Arterial blood gas (ABG) shows pH 7.30, pCO\u2082 58 mmHg, and pO\u2082 55 mmHg. He is hemodynamically stable. What is the next best step in management?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Immediate endotracheal intubation"
      },
      {
        "id": 2,
        "text": "Noninvasive positive-pressure ventilation"
      },
      {
        "id": 3,
        "text": "Intravenous antibiotics only"
      },
      {
        "id": 4,
        "text": "High-flow nasal cannula oxygen therapy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Answer is B:\u00a0Noninvasive positive-pressure ventilation</p>\n\n<p>This patient with <strong>COPD exacerbation</strong> shows <strong>moderate hypercarbia</strong> (pH 7.30, pCO\u2082 58 mmHg) and <strong>respiratory acidosis</strong>, which is an indication of<strong> NIV</strong>. NIV, such as BiPAP, can reduce the work of breathing, improve gas exchange, and prevent the need for intubation. Since the patient is hemodynamically stable and able to protect his airway, NIV is the appropriate next step.</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<h3><strong>Noninvasive Positive-Pressure <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">Ventilation</span> (NIV)</strong></h3>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>NIV refers to positive-pressure <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> delivered through a <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> or full-face mask, either at a continuous pressure (CPAP) or with varying inspiratory and <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> pressures (BiPAP).</p>\n\n\t\t\t<p><strong>Modes:</strong><br />\n\t\t\tModern noninvasive ventilators can provide full support, including volume control ventilation.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Indications</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Acute <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure:</strong> This treatment is effective for conditions that respond quickly to treatment, reducing the need for prolonged mechanical ventilation.</li>\n\t\t\t\t<li><strong>COPD exacerbations:</strong> NIV benefits moderate <span class=\"customMeta\" data-dictid=\"56e9e8596a16927771895aaa2e49e0\">hypercarbia</span> <strong>(pH 7.25-7.35),</strong> reducing the need for <span class=\"customMeta\" data-dictid=\"83e66fab2f1692777190a43a6e300f\">intubation</span> and hospital stay. Severe <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> <span class=\"customMeta\" data-dictid=\"6caf3a39f416927771807e122b9032\">acidosis</span> (pH < 7.2) may require <span class=\"customMeta\" data-dictid=\"b45075a0e1169277719252465ca5ba\">mechanical ventilation</span> with intubation. <strong>(Option B)</strong></li>\n\t\t\t\t<li><strong>Cardiogenic <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> oedema:</strong> Acts as adjunctive therapy, improving gas exchange and <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> <span class=\"customMeta\" data-dictid=\"00c0f6c5371692777192d9df3f64b2\">mechanics</span> alongside <span class=\"customMeta\" data-dictid=\"09562877f516927771865e4cf1fd7e\">diuresis</span> and vasodilators.</li>\n\t\t\t\t<li><strong>Chronic <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure:</strong> This is useful in restrictive lung diseases (e.g., severe scoliosis, <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> muscle weakness) and chronic <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">hypercapnia</span> in COPD, reducing hospital admissions when used nocturnally.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<h3><strong>Advantages </strong></h3>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Reduces work of breathing</li>\n\t\t\t\t<li>Improves <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> compliance</li>\n\t\t\t\t<li>Recruits collapsed (atelectatic) alveoli</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Requires less <span class=\"customMeta\" data-dictid=\"b81cee1b5f16927771987099f651a0\">sedation</span> compared to <span class=\"customMeta\" data-dictid=\"1c5272ad3d1692777190e71409d07a\">invasive</span> ventilation</li>\n\t\t\t\t<li>Shortens hospital stay</li>\n\t\t\t\t<li>Lowers <span class=\"customMeta\" data-dictid=\"83e66fab2f1692777190a43a6e300f\">intubation</span> rates without the risks of <span class=\"customMeta\" data-dictid=\"cdccef317a1692777187a7bc217232\">endotracheal</span> intubation</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Contraindications</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Inability to protect the <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> (e.g., severe encephalopathy)</li>\n\t\t\t\t<li>High <span class=\"customMeta\" data-dictid=\"831d67ad8a1692777182763ca62e4b\">aspiration</span> risk (e.g., vomiting, upper GI bleeding)</li>\n\t\t\t\t<li>Difficulty clearing <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> secretions</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Facial trauma/surgery</li>\n\t\t\t\t<li>Upper <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> obstruction</li>\n\t\t\t\t<li>Significant <span class=\"customMeta\" data-dictid=\"cdf4a197dd16927771881a652c8328\">hemodynamic</span> instability</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Immediate <span class=\"customMeta\" data-dictid=\"cdccef317a1692777187a7bc217232\">endotracheal</span> <span class=\"customMeta\" data-dictid=\"83e66fab2f1692777190a43a6e300f\">intubation</span> </strong><strong>(Option A)</strong>: Reserved for severe <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> <span class=\"customMeta\" data-dictid=\"6caf3a39f416927771807e122b9032\">acidosis</span> (pH < 7.2) or failed NIV. This patient\u2019s pH is 7.30, indicating moderate acidosis.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Intravenous antibiotics only </strong><strong>(Option C)</strong>: While antibiotics may be needed, they do not address <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure or hypercarbia.</p>\n\n<p>\u00a0</p>\n\n<p><strong>High-flow <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> <span class=\"customMeta\" data-dictid=\"7611186da51692777183be9dcf4063\">cannula</span> oxygen therapy </strong><strong>(Option D)</strong>: Helps with <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> but does not manage <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">hypercapnia</span> or improve <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> as NIV does in COPD exacerbations.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/dPgnMIBoBDOjmKADKAG61752091357.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/B30nLxeec5YBR7RpFSJ81752091422.mp3"
  }
];
        let quizName = '11 Emergency Cardiovascular Care Protocols (Bcls, Acls, Mechanical Ventilation) And Causes Of Pulseless Electrical Activity';
        let hierarchy = ["PrepLadder", "qBank", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>