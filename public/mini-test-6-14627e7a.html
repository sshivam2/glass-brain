<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 6 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2022-23
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 42-year-old man presented with a history of heartburn after heavy meals for the past 4 years. A biopsy of the lower esophageal mucosa is obtained by upper gastrointestinal endoscopy. The microscopic picture is shown below. What is the most likely cellular adaptation observed?",
    "choices": [
      {
        "id": 1,
        "text": "Metaplasia"
      },
      {
        "id": 2,
        "text": "Hyperplasia"
      },
      {
        "id": 3,
        "text": "Atrophy"
      },
      {
        "id": 4,
        "text": "Dysplasia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario along with the image showing the replacement of stratified squamous epithelium with <strong>intestinal-type columnar epithelium</strong>&nbsp;with <strong>goblet cells</strong> is<strong>&nbsp;</strong>suggestive of&nbsp;<strong>Barret's esophagus</strong>. The most likely cellular adaptation observed is <strong>metaplasia</strong>.&nbsp;</p>\n<p><strong>Metaplasia</strong>&nbsp;is a<strong> reversible</strong> cellular adaptation characterized by the <strong>replacement</strong> of&nbsp;<strong>one differentiated cell type</strong>&nbsp;(epithelial or mesenchymal) by <strong>another</strong>&nbsp;cell type. It usually represents an adaptive response in which one cell type is replaced by another more capable of&nbsp;<strong>handling </strong>the <strong>stressor</strong>.&nbsp;</p>\n<p>The various types of metaplasia are:</p>\n<ul>\n<li><strong>Squamous metaplasia&nbsp;</strong>-&nbsp;\n<ul>\n<li>Airways - normal pseudostratified epithelium is replaced by the squamous epithelium. It may occur due to&nbsp;<strong>chronic</strong>&nbsp;<strong>smoking</strong>&nbsp;or a&nbsp;<strong>deficiency </strong>of<strong> retinoic acid</strong></li>\n<li>Urinary bladder - normal transitional epithelium is replaced by squamous epithelium. It may occur due to<strong> bladder stones&nbsp;</strong></li>\n</ul>\n</li>\n<li><strong>Columnar metaplasia&nbsp;</strong>-&nbsp;\n<ul>\n<li>Esophagus - normal squamous epithelium of the esophagus is replaced by the glandular columnar epithelium (<strong>Barret's esophagus</strong>). It may occur in patients with<strong> chronic gastroesophageal reflux disease</strong></li>\n</ul>\n</li>\n<li><strong>Connective tissue metaplasia&nbsp;</strong>-&nbsp;\n<ul>\n<li>Muscle - formation of bone in the muscle tissue; the condition is known as&nbsp;<strong>myositis ossificans</strong>. This may occur secondary to <strong>intramuscular hemorrhage</strong></li>\n</ul>\n</li>\n</ul>\n<p>The images below show squamous and columnar metaplasia, respectively.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4390112c60d5433aaf54fe2e63a5f497.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ce9c87b14f684b71901c4a90b17f3cb0x1279x938.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9cb15fd915da49b9ac7a957f12f83348x1023x899.JPEG"
    ]
  },
  {
    "text": "A child was brought to the pediatric emergency with complaints of him appearing lethargic and irritable when touched. On examination, his skin is dry, eyes are sunken and hyperreflexia is present. Blood reports show serum sodium to be 150 mEq/L and high serum osmolarity. Which of the following is correct regarding the initial resuscitation of this case?",
    "choices": [
      {
        "id": 1,
        "text": "Fast normal saline infusion"
      },
      {
        "id": 2,
        "text": "Slow normal saline infusion"
      },
      {
        "id": 3,
        "text": "Slow Ringer lactate infusion"
      },
      {
        "id": 4,
        "text": "Fast Ringer lactate infusion"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario describing a lethargic child with <strong>hyperreflexia</strong>, <strong>irritability, dry skin</strong>, and <strong>sunken eyes</strong> in the setting of hypernatremia is suggestive of&nbsp;<strong>hypernatremic dehydration.</strong>&nbsp;The initial resuscitation should include a&nbsp;<strong>slow</strong> infusion of <strong>normal saline</strong> rather than ringer lactate.</p>\n<p>Hypernatremic dehydration is the <strong>most dangerous type of dehydration.</strong>&nbsp;Children are often <strong>lethargic</strong>, and they may be irritable when touched. Hypernatremia may cause<strong> fever, hypertonicity, and hyperreflexia.&nbsp;</strong></p>\n<p>Hypernatremia causes the movement of water from brain cells into the hypertonic extracellular fluid, causing brain cell shrinkage and shearing of blood vessels within the brain. If not treated can lead to <strong>central nervous system hemorrhages </strong>and<strong> thrombosis.</strong></p>\n<p>The <strong>fluid deficit is corrected slowly</strong> as rapid treatment of hypernatremic dehydration causes the movement of water from the extracellular space into brain cells, leading to <strong>cerebral edema, seizures, brain herniation</strong>,&nbsp;and even death.&nbsp;To minimize the risk of cerebral edema during the correction of hypernatremic dehydration, the serum sodium concentration should not decrease by &gt;10 mEq/L every 24 hr. The deficits in severe hypernatremic dehydration may need to be corrected over 2-4 days.</p>\n<p>The initial resuscitation requires the restoration of intravascular volume with normal saline (NS). <strong>Ringers lactate should not be used</strong> as it is<strong> more hypotonic than NS</strong> and may result in&nbsp;a very<strong> rapid decrease </strong>in serum concentrations, especially if multiple fluid boluses are necessary.</p>\n<p>(Note: Vice versa for hyponatremic dehydration, if hyponatremic dehydration is treated rapidly with 3% saline, it increases the risk of <strong>central pontine myelinolysis</strong>)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An unconscious young man was rushed to the emergency department. On examination, his pulse rate was 190/min and his blood pressure was 70/40 mmHg. His electrocardiogram is given below. What is the next step in management?",
    "choices": [
      {
        "id": 1,
        "text": "DC cardioversion"
      },
      {
        "id": 2,
        "text": "Adenosine"
      },
      {
        "id": 3,
        "text": "Valsalva maneuver"
      },
      {
        "id": 4,
        "text": "Verapamil"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario and the electrocardiogram (ECG) showing <strong>narrow QRS complexes</strong> <strong>without P waves</strong> and pseudo R waves in aVR lead suggest&nbsp;<strong>paroxysmal supraventricular tachycardia</strong>&nbsp;(PSVT). As the patient is <strong>hemodynamically unstable</strong>, the next step in management is&nbsp;<strong>DC&nbsp;(direct current) cardioversion</strong>.</p>\n<p><strong>PSVT&nbsp;</strong>is a narrow QRS complex tachycardia with sudden onset and termination. They mainly present with <strong>dizziness</strong> and<strong> palpitations</strong>.&nbsp;Evaluation of these patients includes monitoring of vitals and ECG.</p>\n<p>Management is as follows:</p>\n<p>1)&nbsp;When the patient is&nbsp;<strong>hemodynamically stable</strong>:</p>\n<ul>\n<li><strong>Carotid sinus massage</strong>&nbsp;can be done. It is avoided if carotid bruit is present and if a prior history of stroke is seen</li>\n<li><strong>Valsalva maneuver</strong>&nbsp;is done if the patient is cooperative</li>\n<li><strong>Intravenous adenosine</strong>&nbsp;is useful in most cases. However, its usage is <strong>contraindicated</strong> in patients with <strong>prior cardiac transplantation</strong>. It can aggravate bronchospasm and <strong>atrial fibrillation</strong>, hence must be used with great caution in such patients.</li>\n<li>Intravenous calcium channel blockers such as <strong>verapamil</strong> or diltiazem and beta-blockers are helpful but can cause <strong>hypotension</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c505c1611e164808a0e05d6ac4045c78.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4ed33fa054940e6ba065e38515bc960x510x812.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1dc472db7fb944628257c562573c212cx1280x1845.JPEG"
    ]
  },
  {
    "text": "A female patient presented with midline neck swelling to the outpatient department. While examining the thyroid gland, you observe that the swelling does not extend superiorly. which of the following structure is responsible for that?",
    "choices": [
      {
        "id": 1,
        "text": "Thyrohyoid membrane"
      },
      {
        "id": 2,
        "text": "Sternothyroid"
      },
      {
        "id": 3,
        "text": "Pretracheal fascia"
      },
      {
        "id": 4,
        "text": "Ligament of berry"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>upward extension</strong> of the<strong> thyroid swelling</strong> is <strong>prevented</strong> by the attachment of the <strong>sternothyroid</strong>&nbsp;to the thyroid cartilage. The thyroid gland can only enlarge anteriorly, posteriorly, laterally, and inferiorly. The superior extension of thyroid swelling is limited by two muscles namely: <strong>sternothyroid and sternohyoid.</strong></p>\n<p>Other options:</p>\n<p>Option A: <strong>Thyrohyoid membrane&nbsp;</strong>is a fibro-elastic ligament, which arises from the superior margin of the thyroid cartilage, and gets attached to the hyoid bone. It <strong>facilitates </strong>the<strong> upward movement</strong> of the larynx during swallowing.</p>\n<p>Option C: <strong>Pretrachial fascia&nbsp;</strong>encloses the thyroid gland and is attached to the larynx. This attachment is responsible for the<strong> movement</strong> of the enlarged thyroid gland<strong> on deglutition.</strong></p>\n<p>Option D: The <strong>ligament&nbsp;of berry,&nbsp;</strong>also called suspensory ligament extends from the cricoid cartilage to the thyroid. Its attachment <strong>prevents the thyroid gland from sinking down</strong> into the mediastinum.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8e01e6ae25d4469c87daf416396f3e94x1280x1330.JPEG"
    ]
  },
  {
    "text": "A 3-year-old child presents with fever, loose stools, and blood in the stool. On microscopic examination, plenty of pus cells were found and culture on MacConkey agar showed colorless colonies. What is the enrichment medium used to isolate the organism from the stool sample?",
    "choices": [
      {
        "id": 1,
        "text": "Robertson cooked meat broth"
      },
      {
        "id": 2,
        "text": "Alkaline peptone water"
      },
      {
        "id": 3,
        "text": "Selenite F broth"
      },
      {
        "id": 4,
        "text": "Brain heart infusion broth"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The given clinical vignette of\u00a0</span><strong><span data-preserver-spaces=\"true\">dysentery\u00a0</span></strong><span data-preserver-spaces=\"true\">(bloody stools) and\u00a0</span>abdominal pain<span data-preserver-spaces=\"true\">\u00a0in a child is suggestive of\u00a0</span><strong><span data-preserver-spaces=\"true\">bacillary dysentery\u00a0</span></strong><span data-preserver-spaces=\"true\">most likely caused due to\u00a0</span><strong><span data-preserver-spaces=\"true\">Shigella.</span></strong><span data-preserver-spaces=\"true\">\u00a0<strong>Selenite F broth</strong> is used as an\u00a0</span><strong><span data-preserver-spaces=\"true\">enrichment media</span></strong><span data-preserver-spaces=\"true\">\u00a0for dysentery-causing bacteria like\u00a0</span>Shigella.</p>\n<p>Enrichment media<span data-preserver-spaces=\"true\">\u00a0is used to suppress commensal bacteria while allowing the pathogen to remain viable and grow.</span></p>\n<div class=\"page\" title=\"Page 300\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Shigellae are short, gram-negative rods that are non-motile, non-sporing, and non-capsulated. They\u00a0are indole positive, urea and oxidase negative, and ferment glucose.\u00a0Colonies on\u00a0MacConkey agar are <strong>colorless</strong> due to the <strong>absence</strong> of <strong>lactose fermentation</strong>. Hektoen enteric (HE) agar, xylose-lysine-deoxycholate agar (XLD), and deoxycholate citrate agar (DCA) are the highly selective mediums used for subculture. Growth is inhibited on Wilson and Blair bismuth sulphite medium.</p>\n<p><strong><span data-preserver-spaces=\"true\">Dysentery/Shigellosis</span></strong><span data-preserver-spaces=\"true\">\u00a0is a type of food poisoning caused by infection with the\u00a0</span><strong>Shigella</strong><span data-preserver-spaces=\"true\">\u00a0species. It acts by\u00a0<strong>inactivating </strong>the<strong> 60s ribosomal</strong>\u00a0subunit thereby inhibiting protein synthesis.\u00a0It is spread through faeco-oral transmission.\u00a0It causes acute onset of symptoms (fever, abdominal cramps) with dysentery and tenesmus. It also gives a positive Sereny test.</span></p>\n</div>\n</div>\n</div>\n<p><span data-preserver-spaces=\"true\">Other options:</span></p>\n<p>Option A:<strong><span data-preserver-spaces=\"true\"> Robertson's cooked meat broth</span></strong><span data-preserver-spaces=\"true\">\u00a0is used for the culture of\u00a0</span><strong><span data-preserver-spaces=\"true\">anaerobic organisms.\u00a0</span></strong></p>\n<p>Option B:\u00a0<strong><span data-preserver-spaces=\"true\">Alkaline peptone water</span></strong><span data-preserver-spaces=\"true\">\u00a0is used for\u00a0</span><strong><span data-preserver-spaces=\"true\">vibrio cholera\u00a0</span></strong><span data-preserver-spaces=\"true\">causing\u00a0</span><strong><span data-preserver-spaces=\"true\">watery diarrhea. </span></strong>It is an enrichment media.</p>\n<p>Option D:<strong><span data-preserver-spaces=\"true\"> Brain-heart infusion broth</span></strong><span data-preserver-spaces=\"true\">\u00a0is an\u00a0</span><strong><span data-preserver-spaces=\"true\">enriched media.\u00a0</span></strong><span data-preserver-spaces=\"true\">It is used for the cultivation of\u00a0</span><strong><span data-preserver-spaces=\"true\">fastidious organisms.\u00a0</span></strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young patient who is a known case of glaucoma presented with sudden onset of decreased vision. Following an ophthalmic examination, a provisional diagnosis of glaukomflecken was made. This condition refers to:",
    "choices": [
      {
        "id": 1,
        "text": "Posterior subcapsular opacities secondary to angle closure glaucoma"
      },
      {
        "id": 2,
        "text": "Anterior subcapsular opacities secondary to angle closure glaucoma"
      },
      {
        "id": 3,
        "text": "Corneal opacity secondary to open angle glaucoma"
      },
      {
        "id": 4,
        "text": "Corneal opacity secondary to angle closure glaucoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Glaukomflecken&nbsp;</strong>refers to <strong>anterior subcapsular lenticular</strong> opacity&nbsp;secondary to <strong>angle-closure glaucoma.</strong></p>\n<div class=\"page\" title=\"Page 313\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Marked elevation of<strong> intraocular pressure</strong> in acute congestive angle closure may cause small anterior <strong>grey-white</strong> subcapsular or capsular opacities to form within the <strong>pupillary area</strong>. This is called glaukomflecken and indicates <strong>focal infarcts</strong> of the lens epithelium. This finding is strongly suggestive of a <strong>previous episode</strong> of acute congestive angle closure.</p>\n</div>\n</div>\n</div>\n</div>\n<p>The images below show glaukomflecken in a patient with angle closure glaucoma.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4d0206a33d504957a7fb0bf79441ba02x245x203.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0ff6f62c03eb4efab3072477fc55dd52x266x185.PNG"
    ]
  },
  {
    "text": "A patient was diagnosed with pulmonary tuberculosis and was started on first-line antitubercular drugs. Which of the following drugs acts by inhibiting the production of mycolic acid?",
    "choices": [
      {
        "id": 1,
        "text": "Isoniazid"
      },
      {
        "id": 2,
        "text": "Rifampin"
      },
      {
        "id": 3,
        "text": "Pyrazinamide"
      },
      {
        "id": 4,
        "text": "Ethambutol"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Isoniazid</strong> is the first-line antitubercular drug that acts by inhibiting the synthesis of <strong>mycolic acid</strong>.</p>\n<p><strong>Isoniazid</strong> is a first-line bactericidal drug that is used for the treatment of tuberculosis. This drug enters bacilli by <strong>passive diffusion</strong>. It then gets activated to its toxic form by the enzyme <strong>catalase-peroxidase&nbsp;</strong>(the enzyme encoded by the <strong>Kat gene</strong>).</p>\n<p>Normally, InhA and KasA are involved in the synthesis of mycolic acid. Upon activation, the reactive metabolite of isoniazid forms complexes with <strong>NAD</strong> that inhibit <strong>InhA</strong> and <strong>KasA</strong>. Hence, isoniazid inhibits the production of <strong>mycolic acid</strong>.</p>\n<p>The reactive isoniazid metabolite also forms complexes with <strong>NADP</strong>. This complex inhibits mycobacterial dihydrofolate reductase which results in the interruption of <strong>DNA synthesis</strong>.</p>\n<p>Side effects of isoniazid include:</p>\n<ul>\n<li><strong>Peripheral neuritis</strong> due to interference with the production of active coenzyme pyridoxal phosphate from pyridoxine. Therefore, <strong>pyridoxine 10 mg/day (vitamin B6)</strong> is given prophylactically along with isoniazid to prevent neurotoxicity.</li>\n<li><strong>Hepatitis- isoniazid</strong> must be stopped at the first sign of hepatotoxicity.</li>\n<li>Rashes</li>\n<li>Anemia</li>\n<li>Arthralgia</li>\n</ul>\n<p>Toxicity of isoniazid results in <strong>metabolic acidosis</strong> and <strong>seizures</strong>.&nbsp;</p>\n<p>Other options:</p>\n<p>Option B: <strong>Rifampin</strong> is the first-line antitubercular drug. It binds to <strong>DNA-dependent RNA polymerase</strong> to form a stable drug-enzyme complex. This complex suppresses RNA synthesis. Side effects of rifampin are <strong>hepatitis</strong>, flu-like illness, and urine and secretions may become <strong>orange-red</strong> but this is harmless.</p>\n<p>Option C: <strong>Pyrazinamide</strong> is a prodrug that is activated by the enzyme pyrazinamidase (encoded by the <strong>pncA gene</strong>). It is converted into an active metabolite pyrazinoic acid. This metabolite makes the intracellular environment acidic which collapses the <strong>transmembrane proton motive force, </strong>thereby killing the bacteria. Hepatotoxicity and hyperuricemia are the common side effects.</p>\n<p>Option D: <strong>Ethambutol</strong> inhibits arabinose transferase III, thereby decreasing arabinogalactan biosynthesis. This results in disruption in mycobacterial <strong>cell wall synthesis</strong>. The important side effect of ethambutol is <strong>optic neuritis</strong>, resulting in decreased visual acuity and <strong>loss of red-green discrimination.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All the following enzymes are highly active in fasting state, except ____.",
    "choices": [
      {
        "id": 1,
        "text": "Glycogen phosphorylase"
      },
      {
        "id": 2,
        "text": "HMG CoA synthase"
      },
      {
        "id": 3,
        "text": "Pyruvate dehydrogenase"
      },
      {
        "id": 4,
        "text": "Pyruvate carboxylase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>All the options are active in the fasting state, except pyruvate dehydrogenase. <strong>Pyruvate dehydrogenase&nbsp;</strong>is highly <strong>active</strong> in the <strong>well-fed/high insulin/dephosphorylated state.</strong></p>\n<p>The metabolic changes that take place in fasting and fed states are.</p>\n<table style=\"width: 358px; height: 352px;\">\n<tbody>\n<tr>\n<td style=\"width: 86px;\">\n<p><strong>Metabolic process</strong></p>\n</td>\n<td style=\"width: 100.2px;\">\n<p><strong>Fasting state/ low insulin-glucagon ratio</strong></p>\n</td>\n<td style=\"width: 74.8px;\">\n<p><strong>Fed state/ high insulin-glucagon ratio </strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 86px;\">\n<p>Gluconeogenesis</p>\n</td>\n<td style=\"width: 100.2px;\">\n<p>Increased</p>\n</td>\n<td style=\"width: 74.8px;\">\n<p>Decreased</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 86px;\">\n<p>Glycogenolysis</p>\n</td>\n<td style=\"width: 100.2px;\">\n<p>Increased</p>\n</td>\n<td style=\"width: 74.8px;\">\n<p>Decreased</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 86px;\">\n<p>Ketogenesis</p>\n</td>\n<td style=\"width: 100.2px;\">\n<p>Increased</p>\n</td>\n<td style=\"width: 74.8px;\">\n<p>Decreased</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 86px;\">\n<p>Glycogenesis</p>\n</td>\n<td style=\"width: 100.2px;\">\n<p>Decreased</p>\n</td>\n<td style=\"width: 74.8px;\">\n<p>Increased</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Other options:</p>\n<p>Option A: <strong>Glycogen phosphorylase</strong> is the rate-limiting enzyme of <strong>glycogenolysis</strong> and is decreased in the fed state.</p>\n<p>Option B: <strong> HMG CoA synthase </strong>is the rate-limiting enzyme of <strong>ketogenesis</strong> and is decreased in the fed state.</p>\n<p>Option D: <strong> Pyruvate carboxylase </strong>is the enzyme involved in <strong>gluconeogenesis.</strong> It converts pyruvate to oxaloacetate. Its levels is decreased in the fed state.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old male patient presents with fever, headache, cough with scanty sputum, and a sore throat for the past 2 weeks. He also complains of multiple joint pains. A chest x-ray is shown below. Culture shows a fried egg appearance on PPLO agar. Which of the following treatment options would not be recommended for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Azithromycin"
      },
      {
        "id": 2,
        "text": "Ciprofloxacin"
      },
      {
        "id": 3,
        "text": "Doxycycline"
      },
      {
        "id": 4,
        "text": "Levofloxacin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario with symptoms of a <strong>URTI, arthralgias</strong>, and culture showing <strong>fried egg</strong> appearance on <strong>PPLO</strong> agar is suggestive of atypical pneumonia caused by&nbsp;<strong>mycoplasma. </strong>It<strong>&nbsp;</strong>does not warrant the use of&nbsp;ciprofloxacin as treatment.</p>\n<p><em>Mycoplasma</em> is a major cause of atypical pneumonia in both children and adults. Clinically it has a very non-specific presentation and commonly presents with <strong>URTI (tracheobronchitis/ pharyngitis), wheezing, and cough.</strong>&nbsp;It is also characterized by its <strong>extrapulmonary manifestations</strong>. Extrapulmonary manifestations include cold agglutinin disease (IgM mediated AIHA), Erythema multiforme or SJS, arthralgia with adenopathy, Guillain-Barre syndrome, myocarditis, pericarditis, and encephalitis.</p>\n<p>Investigations include PCR of respiratory secretions and chest x-rays. On chest x-ray, the most common pattern is that of <strong>peribronchial pneumonia</strong> with <strong>thickened bronchial markings</strong>, streaky <strong>interstitial infiltrations</strong>, and sub-segmental atelectasis. On PPLO agar (Dienes method) it shows a biphasic with fried-egg appearance.</p>\n<p>Treatment options for <em>Mycoplasma pneumoniae</em> infection include:</p>\n<ul>\n<li><strong>Macrolides (e.g. azithromycin)</strong></li>\n<li>Tetracyclines (e.g. doxycycline)</li>\n<li>Respiratory fluoroquinolones (e.g. levofloxacin)</li>\n</ul>\n<p>Azithromycin is the drug of choice for management. Doxycycline is the second-best drug for the management of atypical pneumonia.</p>\n<p>However, <strong>ciprofloxacin and ofloxacin</strong> are <strong>not</strong> recommended because of their high minimal inhibitory concentrations against <em>Mycoplasma pneumoniae</em> isolates and their poor performance in experimental studies.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/89e84f94f3274dd4b3fbbc50685fc3c8.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child is brought to the outpatient department with reduced hearing for the past 2-3 months. He was diagnosed with serous otitis media. What is the otoscopy finding you expect in this child?",
    "choices": [
      {
        "id": 1,
        "text": "Hemorrhagic blebs on the tympanic membrane"
      },
      {
        "id": 2,
        "text": "A dull and opaque tympanic membrane with clear effusion"
      },
      {
        "id": 3,
        "text": "Cart-wheel appearance of tympanic membrane"
      },
      {
        "id": 4,
        "text": "A pearly white mass in the deep meatus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Otoscopy of&nbsp;<strong>serous otitis media </strong>shows a&nbsp;<strong>dull</strong> and <strong>opaque tympanic membrane</strong> with <strong>clear</strong>&nbsp;<strong>effusion</strong>.</p>\n<p>Serous otitis media<strong>&nbsp;</strong>is also known as&nbsp;secretory otitis media or mucoid otitis media or<strong> glue ear.&nbsp;</strong>It is characterized by the accumulation of nonpurulent effusion in the middle ear cleft.&nbsp;</p>\n<p>The causes of serous otitis media include <strong>malfunctioning </strong>of the<strong> eustachian tube</strong> (adenoid hyperplasia, chronic sinusitis or tonsillitis or rhinitis, palatal defects, tumors of nasopharynx) or <strong>increased secretory activity</strong> of the middle ear mucosa&nbsp;(allergy, unresolved otitis media, viral infections).</p>\n<p>It is often seen in children <strong>5-8 years</strong> of age. They present with&nbsp;<strong>hearing loss, delayed and defective speech,</strong> and mild earaches&nbsp;with&nbsp;upper respiratory tract infections.</p>\n<p>Otoscopy reveals a <strong>dull</strong>,&nbsp;<strong>opaque, and retracted tympanic membrane</strong> with loss of light reflex, a thin leash of vessels along the handle of the malleus, fluid levels, and <strong>air bubbles</strong> behind the tympanic membrane.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a39e53abc26143e58e19d010246f6e38x482x458.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b1ea2f014e2a4e0d8d238ef09e50fce0x1210x1199.JPEG"
    ]
  },
  {
    "text": "A 26-year-old male patient presented with pain in the right knee region for the past three months. On examination, the right knee region is swollen and there is a reduced range of motion. An x-ray taken for further evaluation reveals the following. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Aneurysmal bone cyst"
      },
      {
        "id": 2,
        "text": "Osteochondroma"
      },
      {
        "id": 3,
        "text": "Osteoclastoma"
      },
      {
        "id": 4,
        "text": "Osteosarcoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario along with the x-ray showing an expansile, eccentric, sub-articular<strong> soap bubble appearance </strong>is&nbsp;suggestive of<strong> Giant cell tumor</strong>&nbsp;(GCT) or&nbsp;<strong>Osteoclastoma</strong>.</p>\n<p>Osteoclastoma usually affects young adults of age <strong>20 to 40 years</strong> with slight female predominance. It is seen exclusively in adults and affects the <strong>epiphysis</strong> of long bones,&nbsp;commonly in the <strong>distal end</strong> of the&nbsp;<strong>femur&nbsp;</strong>followed by the<strong> proximal tibia</strong>.&nbsp;Common presenting complaints are <strong>swelling</strong> and vague<strong> pain</strong>. Sometimes, the patient presents for the first time with a <strong>pathological fracture</strong> through the lesion.</p>\n<ul>\n<li><strong>Important x-ray features of a GCT</strong>\n<ul>\n<li>A <strong>solitary</strong>, possibly loculated, lytic lesion in the&nbsp;<strong>epiphysis.</strong></li>\n<li><strong>Eccentric</strong> location, most often subchondral.</li>\n<li>Expansion of the overlying cortex.</li>\n<li><strong>Soap bubble appearance - </strong>The tumor is homogeneously lytic with <strong>trabeculae </strong>of the<strong> remnants of bone</strong> traversing it, giving it a <strong>loculated appearance </strong>called soap bubble appearance.</li>\n<li>No calcification within the tumor.</li>\n<li>No or minimal reactive sclerosis around the tumor.</li>\n</ul>\n</li>\n</ul>\n<p>Histologically, GCTs consist&nbsp;of undifferentiated spindle cells profusely interspersed with <strong>multi-nucleated giant cells</strong>. The tumor stroma is well-vascularized with bands of cellular or collagenous fibrous tissue. The image below shows the histopathology of osteoclastoma.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/baf1f551d317466c80518404f1177b74.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2707a711e0184f4cb355bb20f3a26442x1280x1184.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/df36ff24abd54fee8a8062ac8f0f0c1dx720x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/81203bf6d18b48b4ad333bac68159e38x720x1299.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d3fe78f78b60407f9a80a5810769a6aex720x765.JPEG"
    ]
  },
  {
    "text": "A 40-year-old woman comes to the psychiatry OPD with complaints of low mood for the past 2 weeks, reduced socialization, decreased appetite, and inability to sleep for the past 3 months. She also complains of frequent backache and headache, with early morning awakening. What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Conversion disorder"
      },
      {
        "id": 2,
        "text": "Somatic symptom disorder"
      },
      {
        "id": 3,
        "text": "Dysthymic\u00a0disorder"
      },
      {
        "id": 4,
        "text": "Major depressive disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p class=\"p1\">The given clinical scenario of low mood for the past<strong>&nbsp;2 weeks</strong>&nbsp;along with reduced appetite, reduced interest in socialization, somatic symptoms, and disturbed sleep<strong>, </strong>points towards a diagnosis of <strong>depression (major depressive disorder).</strong>&nbsp;</p>\n<p>The diagnostic criteria for major depressive disorder are:</p>\n<p>A. Five or more of the following symptoms have been present during the <strong>same 2-week period.&nbsp;</strong>Atleast<strong> one of the symptoms</strong> is either <strong>depressed mood</strong> or <strong>loss of interest</strong> or pleasure.</p>\n<ol>\n<li>Depressed mood most of the day</li>\n<li>Markedly diminished interest or pleasure in activities (anhedonia)</li>\n<li>Significant weight loss when not dieting or weight gain, decrease or increase in appetite</li>\n<li>Insomnia or hypersomnia</li>\n<li>Psychomotor agitation or retardation</li>\n<li>Fatigue or loss of energy</li>\n<li>Feelings of worthlessness or excessive or inappropriate guilt</li>\n<li>Diminished ability to think or concentrate, or indecisiveness</li>\n<li>Recurrent thoughts of death, recurrent suicidal ideation</li>\n</ol>\n<p>B. The symptoms cause <strong>clinically significant distress</strong> or<strong> impairment</strong> in social, occupa&shy;tional, or other important areas <strong>of functioning.</strong></p>\n<p>C. The episode is <strong>not attributable to</strong> the physiological effects of<strong> a substance</strong> or to another medical condition.</p>\n<p>D. The occurrence of the major depressive episode <strong>is not better explained by</strong> schizoaf&shy;fective disorder, schizophrenia, schizophreniform disorder, delusional disorder, or other specified and unspecified <strong>schizophrenia spectrum and other psychotic disorders.</strong></p>\n<p>E. There has <strong>never been</strong> a <strong>manic</strong> episode or a <strong>hypomanic episode</strong>.</p>\n<p>Other Options:<br /><br />Option A: <strong>Conversion disorder</strong> is a condition with symptoms or deficits that involve&nbsp;<strong>voluntary motor</strong>&nbsp;or&nbsp;<strong>sensory functions</strong>. Though it points to an underlying medical condition, in reality, it arises due to&nbsp;<strong>psychological factors</strong>. The symptoms are&nbsp;<strong>not intentionally produced</strong>&nbsp;and the gain obtained is primarily psychological.&nbsp;</p>\n<p>It can be associated with depressive disorders, anxiety disorders, personality disorders, and somatization disorders. Paralysis,&nbsp;<strong>blindness</strong>, and mutism are the most frequently seen conversion disorder symptoms. Anesthesia and paresthesia of the extremities, abnormal movements, and gait disturbance are the other features commonly seen.&nbsp;</p>\n<p>Option B:&nbsp;<strong>Somatic symptom disorder</strong>&nbsp;is characterized by the fear of having a serious illness based on the person's misinterpretation of bodily symptoms. The symptoms are persistent for&nbsp;<strong>over 6 months.&nbsp;</strong>It equally affects men and women and is commonly seen in the&nbsp;<strong>third decade</strong>&nbsp;of life. It is associated with&nbsp;<strong>poor insight.</strong>&nbsp;Patients believe that they have a serious disease that has not yet been detected and they can&shy;not be persuaded otherwise. Their convictions persist despite negative laboratory results, the benign course of the alleged disease over time, and reassurances from doctors.</p>\n<p>Option C:&nbsp;&nbsp;<strong>Dysthymic&nbsp;disorder&nbsp;</strong>is the presence of a <strong>persistently depressed mood</strong> that lasts most of the day and is continuous. There are also feelings of guilt, irritability, and anger associated with it. These symptoms are present for <strong>at least 2 years</strong>.&nbsp;It is distinguished from major depressive disorder by the fact that patients mention that they have always been depressed. There will never be an episode of mania/hypomania in this condition.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which type of mechanical asphyxia does the image shown below represent?",
    "choices": [
      {
        "id": 1,
        "text": "Burking"
      },
      {
        "id": 2,
        "text": "Bansdola"
      },
      {
        "id": 3,
        "text": "Mugging"
      },
      {
        "id": 4,
        "text": "Garroting"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The type of mechanical asphyxia shown in the image is <strong>m</strong><strong>ugging.</strong></p>\n<p><strong>Mugging</strong> is a type of <strong>strangulation</strong> caused by <strong>holding the neck </strong>of the <strong>victim\u00a0</strong>in the <strong>crook of the elbow</strong>. Pressure is then exerted either on the front of the larynx or at one or both sides by the forearm and upper arm. In mugging, the attack is\u00a0usually made <strong>from behind</strong>. The image below shows strangulation by mugging.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/40e95773a1c44aa79f39da8e6fdd8c29.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4e7d53599a8b48168b62ba588dc8d9dex1280x1713.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/28f8f234ad1246b998bf5284e9e6de6dx1280x1317.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/057130193d6d4b7eb978e43038b8ed05x1280x1091.JPEG"
    ]
  },
  {
    "text": "A woman presented to the emergency department one hour after the spillage of hot coffee on her hands. On examination, the following finding was seen on her right hand. The injuries were extremely painful when touched. The capillary refilling time and pinprick sensations were normal. Which degree of burns would this fall under?",
    "choices": [
      {
        "id": 1,
        "text": "First degree"
      },
      {
        "id": 2,
        "text": "Second degree superficial"
      },
      {
        "id": 3,
        "text": "Second degree deep"
      },
      {
        "id": 4,
        "text": "Third degree"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of a&nbsp;<strong>second-degree superficial burn</strong>. The points that favor the diagnosis are the presence of blisters, tenderness over the injured skin, normal capillary refilling time, and normal pinprick sensations. The <strong>epidermis</strong>&nbsp;and <strong>papillary dermis</strong> (the upper part of the dermis) are involved in this case. These burns will heal without scarring in 2 weeks.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5759756aeee14cf5a787c9d8b9e53055.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A middle-aged woman presented with multiple erosions on the skin and oral mucosa. The histopathology of her skin biopsy is given below. Which of the following characteristic pattern is seen in the direct immunofluorescence study of such lesions?",
    "choices": [
      {
        "id": 1,
        "text": "Speckled"
      },
      {
        "id": 2,
        "text": "Granular"
      },
      {
        "id": 3,
        "text": "Fish net"
      },
      {
        "id": 4,
        "text": "Linear"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: left;\">The given histological image shows the characteristic <strong>row </strong>of<strong> tombstones appearance</strong>&nbsp;seen in <strong>pemphigus vulgaris</strong>. The characteristic pattern seen in the direct immunofluorescence study of such lesions is the<strong> fish net pattern</strong>/ chicken-wire appearance.&nbsp;</p>\n<p style=\"text-align: left;\"><strong>Pemphigus vulgaris</strong> is a <strong>chronic immunobullous</strong> disorder characterized by the presence of <strong>antibodies</strong> against <strong>desmosomal proteins</strong>&nbsp;expressed in the <strong>skin</strong> and <strong>mucosa.</strong>&nbsp;In the <strong>skin</strong>, <strong>desmoglein 1</strong> is mostly seen in <strong>all layers</strong>, while desmoglein 3 is more in the lower layers. In the <strong>oral mucosa</strong>, <strong>desmoglein 3</strong> is seen in all layers and desmoglein 1 is present in lower layers.</p>\n<p style=\"text-align: left;\">Clinically, the patients present with&nbsp;ill-defined, <strong>irregular, slow-to-heal </strong>oral lesions&nbsp;and erosions.&nbsp;<strong>Flaccid blisters</strong> filled with <strong>clear fluid </strong>may&nbsp;arise on normal skin or an erythematous base. The rupture&nbsp;of such blisters produces&nbsp;<strong>painful erosions&nbsp;</strong>and heals&nbsp;<strong>without scarring.&nbsp;</strong>Lesions may also involve the mucosa of the conjunctiva, nasopharynx, larynx, esophagus, urethra, vulva, or cervix.&nbsp;</p>\n<p style=\"text-align: left;\"><strong>Nikolsky's sign</strong> is positive which is elicited by applying firm <strong>tangential</strong> sliding pressure with a finger on lesional or perilesional skin. This leads to the separation of<strong>&nbsp;</strong>the normal\u2010looking epidermis from the dermis, producing <strong>erosion.</strong></p>\n<p style=\"text-align: left;\"><strong>Direct immunofluorescence</strong>&nbsp;is considered the most accurate&nbsp;<strong>confirmatory&nbsp;test</strong>&nbsp;of this condition. It shows intercellular&nbsp;<strong>IgG</strong> and <strong>C3</strong> deposition&nbsp;on the <strong>surface </strong>of <strong>keratinocytes</strong> throughout the epidermis in <strong>normal, perilesional skin,</strong>&nbsp;in a&nbsp;<strong>characteristic fishnet/chickenwire appearance&nbsp;</strong>as seen below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5fe2828017b44d06999cdb061c0ad670.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/44836fa9df094deab7c35b5ec0a196b3x1279x1302.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea55e6373d764d269353c4a3eb06d31ax510x502.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f06a9a2d8f4248cb83b32a9edd3417ddx655x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad2094c1fa814382bc7d05005eafa535x720x552.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/93a5c1b8369a4c41ae47030b32cc24c9x384x218.JPEG"
    ]
  },
  {
    "text": "A young man with pulmonary tuberculosis presented with back pain. History revealed non-compliance to ATT, hence he was suspected to have Pott's spine. Pick the incorrect statement about the radiographic appearance of this condition.",
    "choices": [
      {
        "id": 1,
        "text": "Bird's nest abscess signifies paravertebral abscess formation"
      },
      {
        "id": 2,
        "text": "Narrowing of the disc space is the earliest finding"
      },
      {
        "id": 3,
        "text": "Fibrous ankylosis of the spine is a common sequel"
      },
      {
        "id": 4,
        "text": "Sclerotic appearance indicates the healing stage"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The incorrect statement about Pott's spine is that fibrous ankylosis of the joints occurs as a sequel. Tuberculosis of all joints results in fibrous ankylosis except in the <strong>spine</strong> where&nbsp;<strong>bony ankylosis </strong>is a<strong>&nbsp;common sequel.</strong></p>\n<p>The tuberculous infection first involves the vertebral bodies and the<strong> intervertebral disc</strong>. Hence, the early radiographic features include the <strong>rarefaction/ osteopenic</strong> appearance of the involved vertebrae and the reduction or <strong>narrowing</strong> of the <strong>intervertebral&nbsp;disc space.</strong></p>\n<p>In&nbsp;<strong>later stages</strong>, the infection leads to <strong>para-vertebral abscess</strong> formation and vertebral destruction. These features can be seen on a radiograph as<strong>&nbsp;bird&rsquo;s nest abscess</strong>&nbsp;and&nbsp;<strong>anterior wedging&nbsp;</strong>of<strong>&nbsp;vertebrae, respectively</strong>. When the disease is in the<strong>&nbsp;healing phase</strong>, the&nbsp;<strong>sclerotic&nbsp;</strong>appearance of<strong>&nbsp;vertebrae</strong>&nbsp;can be seen.</p>\n<p>The below image shows the MRI spine of a patient with tuberculous spondylodiscitis of the lumbar spine.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc99bad61e614a81b52cbf0b0e59f8ddx478x586.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/de3ab45038d64599af116d04ad9cb7efx720x708.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/87631c3ed5714b1aae6168264ce61530x1280x3667.JPEG"
    ]
  },
  {
    "text": "An enthusiastic researcher found a positive correlation between the incidence of respiratory problems and the rising pollution in a district. He collected data from the district hospitals and the pollution control board. What is the type of study done here?",
    "choices": [
      {
        "id": 1,
        "text": "Ecological study"
      },
      {
        "id": 2,
        "text": "Case control study"
      },
      {
        "id": 3,
        "text": "Randomized control trial"
      },
      {
        "id": 4,
        "text": "Cohort study"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The study described above is an example of an <strong>ecological study.</strong></p>\n<p>The\u00a0ecological study is a type of analytical study that analyzes the health status and its relation with other variables. It is also called\u00a0<strong>correlational study</strong>, and\u00a0it uses\u00a0<strong>population</strong>\u00a0as a\u00a0<strong>unit </strong>of<strong> study</strong>.</p>\n<p>In the given scenario, the study was done with the district population, from which we can infer that the <strong>population</strong> was taken as the unit of the study.\u00a0<span style=\"font-size: 14px;\">Also, the study was done to </span><strong style=\"font-size: 14px;\">correlate</strong><span style=\"font-size: 14px;\"> the incidence of respiratory problems and pollution in the existing community.</span></p>\n<table style=\"width: 517px; height: 409px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\"><strong>Type of epidemiological study</strong></td>\n<td style=\"height: 18px; width: 190.516px;\"><strong>Unit of study</strong></td>\n</tr>\n<tr style=\"height: 46px;\">\n<td style=\"height: 46px; width: 310.484px;\">\n<p><strong>Analytical studies (hypothesis testing)</strong></p>\n</td>\n<td style=\"height: 46px; width: 190.516px;\">\u00a0\u00a0\u00a0</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Cohort study/ Follow up study</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Individual</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Case-control study</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Individual</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Cross-sectional study/ Prevalence study</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Individual</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Ecological study/ Correlational study</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Population</td>\n</tr>\n<tr style=\"height: 53px;\">\n<td style=\"height: 53px; width: 310.484px;\">\n<p><strong>Experimental studies (hypothesis confirmation)</strong></p>\n</td>\n<td style=\"height: 53px; width: 190.516px;\">\u00a0</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Randomized control trial/ Clinical trials</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Patients</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Field trial</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Healthy people</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"height: 18px; width: 310.484px;\">\n<ul>\n<li>Community trial</li>\n</ul>\n</td>\n<td style=\"height: 18px; width: 190.516px;\">Community</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old man who developed severe tachycardia was rushed to the emergency room. The resident begins to massage the carotid region of his neck to bring down the heart rate. Which of the following mechanisms is responsible for this phenomenon?",
    "choices": [
      {
        "id": 1,
        "text": "Decreased activity of cardioinhibitory center"
      },
      {
        "id": 2,
        "text": "Increased activity of rostral ventrolateral medulla"
      },
      {
        "id": 3,
        "text": "Increased glossopharyngeal firing"
      },
      {
        "id": 4,
        "text": "Decreased venous compliance"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given scenario, the doctor has performed a <strong>carotid sinus massage</strong> to slow the heart rate. This stimulates the <strong>baroreceptor reflex&nbsp;</strong>leading to&nbsp;an&nbsp;<strong>increased</strong>&nbsp;<strong>afferent</strong> nerve/ <strong>glossopharyngeal nerve firing</strong> to the <strong>nucleus tractus solitarius.</strong><strong>&nbsp;</strong></p>\n<p><strong>Carotid sinus massage</strong></p>\n<p><strong>Procedure</strong>- It is performed with the patient supine and the head turned slightly away from the side being stimulated. Before performing massage the doctor should always auscultate to check for the presence of <strong>carotid bruit</strong>. If bruit is present, it should not be performed. The area of the carotid sinus, at the artery&rsquo;s bifurcation, is palpated with two fingers at the angle of the jaw until a good pulse is felt. A minimal amount of pressure is applied over the carotid sinus. If there is no effect, a side-to-side or rotating motion of the fingers over the site is performed for up to 5 seconds. ECG should be performed to assess the response.</p>\n<p><strong>Mechanism</strong></p>\n<p>Pressure over the carotid sinus stimulates the baroreceptors. These&nbsp;signals are transmitted through small <strong>Hering&rsquo;s nerves</strong> to the <strong>glossopharyngeal nerves</strong> and then to the <strong>nucleus tractus solitarius (NTS)</strong> in the medulla. These signals&nbsp;release glutamate and activate the&nbsp;<strong>CVLM</strong>&nbsp;(caudal ventrolateral medulla). This in turn <strong>inhibits</strong>&nbsp;<strong>RVLM</strong>&nbsp;(rostral ventrolateral medulla) considered the&nbsp;<strong>vasoconstrictor center&nbsp;</strong>for the brain and the heart. Simultaneously, this pathway also&nbsp;<strong>excites</strong> the <strong>vagal</strong> parasympathetic center. The <strong>stimulation of the vagus</strong> results in a <strong>slowing </strong>of<strong> impulse generation </strong>in the <strong>SA node </strong>and a&nbsp;<strong>slowing </strong>of <strong>conduction </strong>velocity in the&nbsp;<strong>AV node.&nbsp;</strong>This in total combination results in lowering of blood pressure and heart rate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/15055f5cca6841f09d3723c9c7574556x1280x2026.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e66e0ede6107455f9c39a5cfa72e08b2x1280x1674.JPEG"
    ]
  },
  {
    "text": "A 27-year-old primigravida woman at 34 weeks of gestation is reported to have an amniotic fluid index of 4 cm. Which of the following fetal anomaly can be associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Renal agenesis"
      },
      {
        "id": 2,
        "text": "Anencephaly"
      },
      {
        "id": 3,
        "text": "Cleft lip"
      },
      {
        "id": 4,
        "text": "Esophageal atresia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>An amniotic fluid index(AFI) of <strong>4 cm</strong> is suggestive of <strong>oligohydramnios</strong>&nbsp;which can be associated with <strong>renal agenesis</strong>.</p>\n<p>Oligohydramnios is a condition where there is decreased production of amniotic fluid.&nbsp;Sonographically, it is defined when the <strong>single deepest pocket</strong> of liquor is<strong>&nbsp;&lt;2 cm</strong> or when the amniotic fluid index (AFI) is<strong> less than 5 cm</strong> (less than 5 percentile).</p>\n<p>The fetus begins producing urine between <strong>8 - 11 weeks</strong> of gestation. However, it does not become a major part of the composition of amniotic fluid until the second trimester. For this reason, fetuses with kidney abnormalities do not become evident until after 18 weeks of gestation.&nbsp;</p>\n<div class=\"page\" title=\"Page 247\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Causes of Oligohydraminios:</p>\n<ul>\n<li>Placental abnormalities: <strong>Amnion nodosum&nbsp;</strong>(failure of secretion by the cells of the amnion covering the placenta)</li>\n<li>Maternal complications leading to <strong>uteroplacental insufficiency</strong>: pre-eclampsia, vascular disease</li>\n<li>Renal Anomalies:\n<ul>\n<li>Bilateral <strong>renal agenesis</strong></li>\n<li>Bilateral multicystic dysplastic kidney</li>\n<li>Unilateral renal agenesis with contralateral multicystic dysplastic kidney</li>\n<li>The infantile form of autosomal recessive polycystic kidney dis&shy;ease</li>\n<li>Fetal bladder outlet obstruction - <strong>posterior urethral valves</strong>, urethral atresia, or stenosis</li>\n</ul>\n</li>\n<li>Complex fetal anomalies: <strong>persistent cloaca </strong>and<strong> sireno&shy;melia</strong>&nbsp;(mermaid syndrome).</li>\n<li><strong>Post-dated pregnancy</strong></li>\n<li>Drugs: ACE inhibitors, ARBs, NSAIDs when taken in the 2nd or 3rd trimester</li>\n</ul>\n</div>\n</div>\n</div>\n<p>Consequently, polyhydramnios is defined as a<strong> deepest vertical pocket</strong> of <strong>more than 8 cm</strong> or an <strong>AFI</strong> of <strong>more than 24 cm</strong>. There are various mechanisms that can lead to <strong>polyhydramnios</strong> such as:&nbsp;</p>\n<ul>\n<li>Maternal causes\n<ul>\n<li>Diabetes(Overt diabetes/Gestational diabetes)</li>\n<li>Cardiac diseases</li>\n<li>Renal Diseases</li>\n</ul>\n</li>\n<li>Fetal causes\n<ul>\n<li>Neural tube defects</li>\n<li><strong>Anencephaly</strong></li>\n<li><strong>Cleft lip/palate</strong>, micrognathia</li>\n<li>Congenital diaphragmatic hernia</li>\n<li><strong>Esophageal </strong>and<strong> duodenal atresia</strong></li>\n<li>Aneuploidy</li>\n<li><strong>Hydrops fetalis</strong> due to&nbsp;Rh alloimmunization,&nbsp;nonimmune hydrops, cardiothoracic anomalies, fetal cirrhosis and fetal TORCH infections, parvovirus B19 infection</li>\n<li>Twin pregnancy, Twin to Twin transfusion syndrome</li>\n<li><strong>Bartter syndrome</strong></li>\n<li><strong>Sacrococcygeal teratoma</strong></li>\n<li>High-output cardiac states</li>\n</ul>\n</li>\n<li>Placental causes\n<ul>\n<li>Chorangioma of placenta\n<div class=\"page\" title=\"Page 274\">&nbsp;</div>\n</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young woman presented with a butterfly-shaped malar rash, a history of recurrent oral ulcers, and pain in multiple joints. Investigations revealed pancytopenia and IgG antibodies to double-stranded DNA. What is her diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Dermatomyositis"
      },
      {
        "id": 2,
        "text": "Behcet's disease"
      },
      {
        "id": 3,
        "text": "Rheumatoid arthritis"
      },
      {
        "id": 4,
        "text": "Systemic lupus erythematosus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This woman with a butterfly-shaped malar rash, a history of recurrent oral ulcers, pain in multiple joints with thrombocytopenia, and antibodies to double-stranded DNA has a diagnosis of <strong>systemic lupus erythematosus</strong> (<strong>SLE</strong>).</p>\n<p>SLE is an <strong>autoimmune disorder</strong> that results in damage to multiple organs and organ systems in the body most commonly seen in&nbsp;<strong>women</strong> of <strong>reproductive age</strong>.&nbsp;&nbsp;</p>\n<p><strong>Clinical</strong> and <strong>immunological manifestations </strong>in<strong> SLE</strong>:</p>\n<ol>\n<li>Skin\n<ul>\n<li>acute, subacute cutaneous manifestations (photosensitivity, <strong>malar</strong> or maculopapular rash)</li>\n<li>chronic cutaneous manifestations (discoid lupus, panniculitis, lichen planus like)&nbsp;</li>\n</ul>\n</li>\n<li><strong>Oral</strong> or <strong>nasal ulcers</strong></li>\n<li>Non-scarring alopecia</li>\n<li><strong>Synovitis </strong>involving <strong>&ge;2</strong> <strong>joints</strong></li>\n<li>Serositis (pleurisy, pericarditis)</li>\n<li>Renal:&nbsp;\n<ul>\n<li>Protein/Creatinine ratio &gt;0.5</li>\n<li>RBC casts</li>\n</ul>\n</li>\n<li>Neurologic: seizures, psychosis, myelitis, neuropathy, confusional state</li>\n<li>Hemolytic anemia</li>\n<li>Leukopenia</li>\n<li>Thrombocytopenia</li>\n<li><strong>Immunological manifestations</strong>\n<ul>\n<li>Antinuclear antibodies &gt;reference value (positive in &gt;98% patients)</li>\n<li><strong>Anti-dsDNA &gt;reference value (specific)</strong></li>\n<li>Anti-Smith antibody (specific)</li>\n<li>Antiphospholipid antibody (lupus anticoagulant, false-positive rapid plasma reagin)</li>\n<li>Low serum complement</li>\n</ul>\n</li>\n</ol>\n<p>To <strong>diagnose</strong> SLE, at least<strong> 4 </strong>out of <strong>11&nbsp;</strong>of the above criteria must be positive. However, if a <strong>renal biopsy</strong> is suggestive of <strong>lupus nephritis</strong> and <strong>lupus autoantibodies</strong> are positive then four criteria are not required.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a9fd4549688a483d8e3c6f4542a8a9e6x512x395.PNG"
    ]
  }
];
        let quizName = 'Mini Test 6';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2022-23"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>