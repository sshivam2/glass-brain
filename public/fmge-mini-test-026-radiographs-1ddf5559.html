<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 026 (Radiographs) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "An elderly man is being evaluated for exertional dyspnea, cough, and weight loss. His chest CT is given below. What is it suggestive of?",
    "choices": [
      {
        "id": 1,
        "text": "Emphysematous lung"
      },
      {
        "id": 2,
        "text": "Atypical pneumonia"
      },
      {
        "id": 3,
        "text": "Calcified granulomas"
      },
      {
        "id": 4,
        "text": "Interstitial fibrosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>CT scan</strong> shows <strong>emphysematous lungs</strong>, with reduced parenchymal markings and focal areas of low attenuation. This represents the emphysematous destruction of the lung, indicative of<strong> hyperinflation</strong>.</p>\n<p>Radiographic studies in COPD show:</p>\n<ul>\n<li>Emphysematous bullae</li>\n<li>A paucity of parenchymal markings</li>\n<li>Hyperlucency suggests the presence of emphysema</li>\n<li>Increased lung volumes and<strong> flattening </strong>of the<strong> diaphragm</strong> suggest hyperinflation</li>\n</ul>\n<p>Option B: Atypical pneumonia shows patchy bilateral ground-glass opacities.</p>\n<p>Option C: Calcified granulomas are seen as dense, bright nodules.</p>\n<p>Option D: Interstitial fibrosis shows a honeycomb pattern of the lung parenchyma as shown below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/00216d2bff154422bba82a4fa85d9c9d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2a4c2e6ed9534c45ae3752d9ca23c784x246x157.JPEG"
    ]
  },
  {
    "text": "A 3-month-old male child was brought with a history of fever and respiratory distress. Suspecting pneumonia, a chest X-ray was ordered. Which of the following is the most likely causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Klebsiella pneumoniae"
      },
      {
        "id": 2,
        "text": "Streptococcus pneumoniae"
      },
      {
        "id": 3,
        "text": "Mycoplasma pneumoniae"
      },
      {
        "id": 4,
        "text": "Staphylococcus aureus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The X-ray shows pneumatoceles (air-filled cysts within lung parenchyma), which most commonly occur in pneumonia caused by <em><strong>Staphylococcus aureus</strong>.</em></p>\n<p>Pneumonia caused by Staphylococcus may be<strong> primary</strong> or <strong>secondary</strong> (after a viral infection such as influenza).</p>\n<p>Clinical features include high fever, abdominal pain,&nbsp;dyspnoea, and tachycardia. S. aureus often causes <strong>necrotizing pneumonitis</strong> that may be associated with complications like&nbsp;early development of empyema, pneumatocele, pyopneumothorax, and bronchopleural fistulas.</p>\n<p>Pneumatocoele can also be caused by&nbsp;<em>Streptococcus pneumoniae</em>,&nbsp;<em>Haemophilus influenzae</em>, <em>E. coli</em>,&nbsp;group A <em>streptococci</em>,&nbsp;<em>Klebsiella pneumoniae</em>, etc. However, Staphylococcus aureus is <strong>most commonly </strong>implicated<strong>.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1153e8303561479bae79b847e9de42f1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the imaging procedure shown below.",
    "choices": [
      {
        "id": 1,
        "text": "Mammography"
      },
      {
        "id": 2,
        "text": "MRI"
      },
      {
        "id": 3,
        "text": "CT"
      },
      {
        "id": 4,
        "text": "Ultrasound"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The imaging procedure shown above is mediolateral oblique <strong>mammography.</strong></p>\n<p>The mammogram is an X-ray picture of the breast. The anode in the X-ray tube is made up of <strong>molybdenum</strong>. The X-ray film used is <strong>single-sided</strong> coated films.</p>\n<p>Views used are:</p>\n<ul>\n<li>Craniocaudal</li>\n<li>Mediolateral oblique</li>\n</ul>\n<p>The father of mammography is <strong>Robert Egan.</strong></p>\n<p>Uses of the mammogram:</p>\n<ul>\n<li>Routine screening for DCIS.</li>\n<li>The most important sign of malignancy in mammogram is <strong>clustered</strong> <strong>micro calcification </strong>(more than 5 particles in 1 cm&sup2;, 3 particles of less than 0.5 mm size)</li>\n</ul>\n<p>The image below shows different types of calcifications.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d80f2bf0d6e047289cac567b40f539b0.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ded4bb1b93c447edbb65d123128a5e10x440x252.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c1af0d2dc99404daac1b1778eb2015ax541x239.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c6abe2151d7848afb0eb6318097886b7x720x612.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c8c13d2c8d8403d921af078f89b2ca1x1000x864.GIF"
    ]
  },
  {
    "text": "Identify the structure marked as A in the CT scan shown below:",
    "choices": [
      {
        "id": 1,
        "text": "Descending aorta"
      },
      {
        "id": 2,
        "text": "Superior vena cava"
      },
      {
        "id": 3,
        "text": "Ascending aorta"
      },
      {
        "id": 4,
        "text": "Right pulmonary artery"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked as \"A\" in the CT Thorax is the ascending aorta.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/99cb3f8d9b2b4589bfa24beae73f9301.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5f5adf74c834012affd52151888d55bx531x478.JPEG"
    ]
  },
  {
    "text": "A neonate is being evaluated for urinary abnormalities. Ultrasonography reveals the following finding. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Vesicoureteric reflux"
      },
      {
        "id": 2,
        "text": "Posterior urethral valve"
      },
      {
        "id": 3,
        "text": "Ureterocele"
      },
      {
        "id": 4,
        "text": "Retrocaval ureter"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows a dilated proximal urethra&nbsp;and associated thick-walled distended bladder on ultrasound that resembles a keyhole. This&nbsp;<strong>keyhole sign</strong> is seen in the presence of&nbsp;<strong>posterior urethral valves.</strong>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cdcaff6aa4b54917ba73eba6804f400a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6dd68290a43f40d6912bfb67bb60a003x1280x1369.JPEG"
    ]
  },
  {
    "text": "A child with recurrent UTIs is suspected to have a congenital renal anomaly. The following picture is seen on IV urography. Based on these findings, which of the following would you suspect?",
    "choices": [
      {
        "id": 1,
        "text": "Retrocaval ureter"
      },
      {
        "id": 2,
        "text": "Vesicoureteric reflux"
      },
      {
        "id": 3,
        "text": "Medullary sponge kidney"
      },
      {
        "id": 4,
        "text": "Multicystic dysplastic kidney"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows a right-sided<strong> fish hook&nbsp;</strong>or <strong>S-shaped&nbsp;</strong>ureter. It describes the appearance of a&nbsp;<strong>retrocaval ureter</strong> as the right ureter hooks behind the IVC.</p>\n<p><strong>Circumcaval </strong>or retrocaval ureter is a developmental anomaly of the inferior vena cava (<strong>IVC</strong>). It is due to abnormal development of the right supracardinal system. There is a <strong>persistent</strong>&nbsp;right posterior<strong> cardinal vein&nbsp;</strong>that ends up passing in front of the ureter. The anomaly <strong>always</strong> occurs on the <strong>right side</strong>, as this is the side of the normal IVC.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c8c0a53b31d04449aeaaa97e79409dbe.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2cac9fcfb46e4d52af3e55a449bd518fx1280x1587.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a8813ec2e13487c894176ae6f3f7c31x1280x1587.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c63b681645c34d5e903aaa36fc14e9cax1280x1535.JPEG"
    ]
  },
  {
    "text": "A 59-year-old man is being evaluated for a change in bowel habits associated with abdominal discomfort. A barium enema study was done and is shown below. What is the likely diagnosis of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Ileocaecal TB"
      },
      {
        "id": 2,
        "text": "Irritable bowel syndrome"
      },
      {
        "id": 3,
        "text": "Carcinoma colon"
      },
      {
        "id": 4,
        "text": "Sigmoid diverticulosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario along with the barium study showing<strong> apple core sign </strong>is suggestive of <strong>carcinoma colon.</strong></p>\n<p><strong>Apple core</strong> sign/<strong>napkin ring</strong> sign describes a short&nbsp;segment of irregular circumferential stricture involving the large bowel. It has shouldered margins resembling an apple core. The appearance is classically described on contrast enema studies and is almost always due to a stenosing annular&nbsp;colon carcinoma.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/78148dd94b304c6882f2021f68fbf9f4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5e2c79e5945a41d69d037f640ad416d1x720x576.JPEG"
    ]
  },
  {
    "text": "All of the following could be the cause of the following X-ray finding except:",
    "choices": [
      {
        "id": 1,
        "text": "Duodenal ulcer perforation"
      },
      {
        "id": 2,
        "text": "Post laparoscopy"
      },
      {
        "id": 3,
        "text": "Chilaiditi syndrome"
      },
      {
        "id": 4,
        "text": "Acute intestinal obstruction"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given X-ray shows <strong>air under the diaphragm</strong> which is suggestive of <strong>pneumoperitoneum</strong>. Acute intestinal obstruction does not cause pneumoperitoneum.</p>\n<p>Causes of pneumoperitoneum include:</p>\n<ul>\n<li>Bowel perforation\n<ul>\n<li>Peptic ulcer</li>\n<li>Ischemic bowel</li>\n<li>Necrotizing enterocolitis</li>\n</ul>\n</li>\n<li>Small bowel perforation\n<ul>\n<li>Trauma</li>\n<li>Penetrating injuries</li>\n</ul>\n</li>\n<li>Causes other than perforation are:\n<ul>\n<li><strong>Chilaiditi syndrome</strong>&nbsp;- the intestine is seen between the liver and diaphragm giving a false impression of free air</li>\n<li><strong>Sub-phrenic abscess</strong></li>\n<li><strong>Postoperatively,</strong> air may be present in the abdomen for up to 7 days</li>\n</ul>\n</li>\n</ul>\n<div class=\"ng-scope\">\n<p>An intestinal obstruction would show <strong>multiple dilated loops</strong> on X-ray with possible<strong> air-fluid levels</strong>. Only when the obstruction becomes severe and there is a perforation, pneumoperitoneum occurs.</p>\n<p>The image given below is an abdominal radiograph showing multiple dilated loops with air-fluid levels suggestive of intestinal obstruction.</p>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/47b6b553694d45539456e8fd44ed83e1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad752d9e3f1e46c286cfb0b0538dc1bex508x599.JPEG"
    ]
  },
  {
    "text": "A 62-year-old man presents to the casualty with a severe headache, fever, and vomiting for the past 5 hours. There is no history of trauma. CT head is shown below. What is the most common cause for his presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Saccular aneurysms"
      },
      {
        "id": 2,
        "text": "Uncontrolled diabetes"
      },
      {
        "id": 3,
        "text": "Microaneurysms"
      },
      {
        "id": 4,
        "text": "Atherosclerosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given scenario is suggestive of<strong> non-traumatic</strong> <strong>subarachnoid haemorrhage.</strong>&nbsp;The most common cause for this condition<strong>&nbsp;</strong>is the <strong>rupture</strong> of a <strong>berry aneurysm,&nbsp;</strong>also known as a&nbsp;<strong>saccular aneurysm</strong>.</p>\n<p>CT shows&nbsp;hyperattenuating material filling the subarachnoid space, which&nbsp;is suggestive of&nbsp;SAH. Most commonly, it&nbsp;occurs around the<strong> circle of Willis</strong>&nbsp;due to the&nbsp;rupture of a berry aneurysm&nbsp;at this location.</p>\n<p>Most <strong>unruptured</strong> intracranial aneurysms are completely <strong>asymptomatic</strong>.&nbsp;Prodromal symptoms occasionally suggest the site of the enlarging unruptured aneurysm. For example, cranial nerve III palsy with loss of ipsilateral light reflex and focal pain above or behind the eye suggests an expanding aneurysm at the junction of the posterior communicating artery and internal carotid artery.</p>\n<p><strong>Ruptured aneurysms</strong> cause an excruciating<strong>&nbsp;thunderclap headache </strong>followed by a<strong> transient loss of consciousness.</strong></p>\n<p>Non-contrast CT&nbsp;scan is the investigation of choice for SAH. LP shows&nbsp;xanthochromatic CSF.</p>\n<p>Treatment involves <strong>clipping or coiling</strong> the aneurysm to eliminate the risk of rebleeding.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7de2025aa6e84d8b84a9d462edad9941.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the imaging and structure marked as A.",
    "choices": [
      {
        "id": 1,
        "text": "MRCP - Right hepatic duct"
      },
      {
        "id": 2,
        "text": "ERCP - Cystic duct"
      },
      {
        "id": 3,
        "text": "MRCP - Common bile duct"
      },
      {
        "id": 4,
        "text": "ERCP - Pancreatic duct"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image depicts an <strong>MRCP</strong> (magnetic resonance cholangiopancreatography) and the structure marked as A is the <strong>common bile duct</strong>.</p>\n<p>MRCP is a non-invasive test showing a heavy <strong>T2 weighted</strong> image. Endoscope or contrast medium is not used as <strong>bile</strong>&nbsp;itself serves as a <strong>contrast</strong> medium.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0f04a3f8b1384de382f084d050176ebb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ca7bc3b7b6b446c0b4f5f67f89e02230x1280x1369.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bd32162a7b9b41d0972161c4995855e7x1280x1339.JPEG"
    ]
  },
  {
    "text": "The chest x-ray of a child who presented with progressive breathlessness is given below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tetralogy of Fallot"
      },
      {
        "id": 2,
        "text": "Coarctation of aorta"
      },
      {
        "id": 3,
        "text": "Transposition of great arteries"
      },
      {
        "id": 4,
        "text": "Ebstein's anomaly"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image shows a&nbsp;<strong>boot-shaped heart</strong><strong>&nbsp;</strong>which is seen in tetralogy of Fallot<strong>&nbsp;</strong>(<strong>TOF</strong>).&nbsp;It shows an <strong>upturned </strong>cardiac<strong> apex</strong> due to <strong>right ventricular hypertrophy</strong> and a concave pulmonary arterial segment.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/02bdade43ff24e579de32828b5b272a7.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a170536f91d84d1b92fd614a5c5209fcx502x574.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc3fc2d79cab4532b02230477ac33ab7x510x603.GIF"
    ]
  },
  {
    "text": "A 24-year-old primigravida has come for an antenatal ultrasound examination. The sonographic image appears as shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Spina bifida"
      },
      {
        "id": 2,
        "text": "Anencephaly"
      },
      {
        "id": 3,
        "text": "Holoprosencephaly"
      },
      {
        "id": 4,
        "text": "Omphalocele"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows the <strong>lemon sign</strong>, which is seen in <strong>spina bifida.</strong></p>\n<p><strong>Spina bifida</strong>\u00a0is the common\u00a0<strong>open neural tube defect</strong>\u00a0associated with hydrocephalus and<strong> Arnold-Chiari II </strong>malformation. It is the most common open neural tube disorder.</p>\n<p>Spina bifida is characterized by a cleft in the vertebral column with a corresponding defect in the skin so that the<strong> meninges and spinal cord are exposed.</strong></p>\n<p><strong>The lemon sign</strong> is related to changes in the configuration of the <strong>fetal frontal bone</strong> that loses convexity, becoming concave or linear at ultrasonography, and can be found during the <strong>first six months of gestation.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/280bbf1f2f154b0e9b4d202758f10ad2.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d1942720aaa54f17aff0720e1f27f6adx510x548.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1d5ea08e2e14850b4b08465ddddd40ex510x785.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4a41a85c34b46ed8a5b6d1cc0c85e6ax510x739.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aa48c86d5f874668b54996c4516d9cd0x512x392.PNG"
    ]
  },
  {
    "text": "A 15 year old patient with history of spinal tuberculosis was brought to the hospital with low grade fever, dull backache and persistent flexion of hip joint. Hip joint motion was limited and painful. Identify the muscle affected in the CT image.",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical vignette of a patient with low-grade fever, dull backache, and persistent flexion of the hip joint with a history of spinal tuberculosis is suggestive of <strong>psoas abscess</strong>&nbsp;involving the <strong>psoas muscle</strong>,<strong>&nbsp;</strong>marked<strong>&nbsp;2&nbsp;</strong>in the given image<strong>.&nbsp;</strong>CT scan shows a mass in the psoas muscle lateral to the vertebral column which is diagnostic of the same.</p>\n<p>Psoas abscess<strong>&nbsp;</strong>occurs due to a collection of pus&nbsp;in the<strong>&nbsp;</strong>iliopsoas compartment. The compartment is retroperitoneal and hence, the abscess is also called a&nbsp;<strong>retroperitoneal</strong> abscess. The compartment contains iliacus and iliopsoas muscles. The psoas compartment muscles lie in close proximity to major abdominal organs and is richly supplied by iliolumbar, external iliac and common femoral arteries. Owing to these reasons, there is hematogenous spread of infections like <strong>tuberculosis</strong> leading to abscess.</p>\n<p>Clinical presentation is with back pain, fever, and lassitude. The hip may be in fixed flexion or there may be pain on passive extension.<br />CT is performed for diagnosis. Treatment is with percutaneous CT-guided drainage and antibiotic therapy.</p>\n<p>Other muscles marked in the image are depicted below.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cb429399b7cc4680a7318fe57157338d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6773c1adab414e7bbb63ee98dc50f18ax600x905.JPEG"
    ]
  },
  {
    "text": "Based on the X-ray of the hand given below, what is the likely age of the person?",
    "choices": [
      {
        "id": 1,
        "text": ">18 years"
      },
      {
        "id": 2,
        "text": "<17 years"
      },
      {
        "id": 3,
        "text": "<12 years"
      },
      {
        "id": 4,
        "text": "<10 years"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given X-ray shows the <strong>appearance of pisiform(&gt;10 years) but no fusion of base of 1st metacarpal(&lt;17 years)</strong>. Among the given options, the likely answer seems to be &lt;17 years.</p>\n<p>The <strong>base</strong> of all <strong>metacarpals</strong> appears at 2-3 years of age and fuse at 15-17 years of age. Since it is <strong>not fused</strong> in this case, the age is <strong>&lt;17 years</strong>. If it has fused the likely age is &gt;15 years&nbsp;</p>\n<p><strong>Pisiform</strong> ossification center appears at 10-12 years of age. Since it is <strong>present</strong> in this case, the age of the child is<strong>&nbsp;more than 10 years.&nbsp;</strong>If it had not appeared, the likely age is &lt;12 years.</p>\n<p>Ossification Centres of Carpal Bones:</p>\n<ul>\n<li>Capitate: 1-3 months</li>\n<li>Hamate: &nbsp;2-4 months</li>\n<li>Triquetral: 2-3 years</li>\n<li>Lunate: 3-4 years</li>\n<li>Scaphoid: 4-6 years</li>\n<li>Trapezium: 5-6 years</li>\n<li>Trapezoid: 5-6 years</li>\n<li>Pisiform: 10-12 years</li>\n</ul>\n<p>The lower end of the radius appears at 2 years of age and fuses at 18-19 years of age. The lower end of the ulna appears at 5-6 years of age and fuses at 17-18 years of age. Here, both remain unfused indicating further that the age is likely to be less than 18.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/90f22ca7826b43c190392005ae8bc894.jpg"
    ],
    "explanation_images": []
  },
  {
    "text": "The skull X-ray of a patient who presented with bone pains is shown below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Paget's disease"
      },
      {
        "id": 2,
        "text": "Multiple myeloma"
      },
      {
        "id": 3,
        "text": "Hyperparathyroidism"
      },
      {
        "id": 4,
        "text": "Osteomyelitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The radiograph shows <strong>cotton wool skull</strong>&nbsp;which is diagnostic of <strong>Paget&rsquo;s disease.</strong></p>\n<p>Radiological features during the early phase of this disease include osteolytic (lucent) regions which is later followed by coarse trabeculae and bony enlargement. Sclerotic changes occur much later in the disease process. The lesions seen are:</p>\n<ul>\n<li>Osteoporosis circumscripta: large, well-defined lytic lesion</li>\n<li><strong>Cotton wool appearance</strong>: mixed lytic and sclerotic lesions of the skull</li>\n<li>Diploic widening: both inner and outer calvarial tables are involved, with the former usually more extensively affected</li>\n<li><strong>Tam o'Shanter sign</strong>: frontal bone enlargement, with the appearance of the skull falling over the facial bones, like a Tam o' Shanter hat.</li>\n</ul>\n<p>The image below shows cotton wool appearance on skull X-ray:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f7c33759eb044ebca54ef646e7e4a4c1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/00125f11309f4ce2a41aca620101003bx618x458.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4dfaf00f8bc54e588edb2627851ea14bx613x526.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8c30a2b1ce204a899388623cc95d468fx406x268.JPEG"
    ]
  },
  {
    "text": "Identify the doppler image of the fetus given.",
    "choices": [
      {
        "id": 1,
        "text": "Normal Diastolic flow"
      },
      {
        "id": 2,
        "text": "Normal systolic flow"
      },
      {
        "id": 3,
        "text": "Absent Diastolic"
      },
      {
        "id": 4,
        "text": "Absent systolic"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image represents normal diastolic flow.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/34fc7b32d0184cfea1d778b438224216.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f0fa89c94ed7410ea8f5e70b76ad8d2fx600x1281.JPEG"
    ]
  },
  {
    "text": "A primigravida at 12 weeks of gestation presents with complaints of the expulsion of grape-like vesicles per vaginum for 1 day. She was diagnosed as a case of molar pregnancy on USG.  In addition, she has an adnexal lesion as given below.  What is the likely finding____",
    "choices": [
      {
        "id": 1,
        "text": "Multiple fibroid"
      },
      {
        "id": 2,
        "text": "Colloid cyst"
      },
      {
        "id": 3,
        "text": "Theca lutein cyst"
      },
      {
        "id": 4,
        "text": "Polycystic ovarian disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given USG image shows <strong>theca lutein cysts</strong> in the ovary. The ovaries contain multiple theca-lutein cysts in 25 to 60 percent of women with a complete mole.</p>\n<p>They are usually <strong>bilateral</strong> and are also seen in <strong>multiple pregnancy</strong>. These likely result from the<strong> overstimulation of lutein elements</strong> by massive amounts of <strong>hCG</strong>. The contained fluid is rich in chorionic gonadotropin. It also contains estrogen and progesterone.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/25433e9f949944aaa98a41787a175a3b.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old woman presented with post-menopausal bleeding. Ultrasonography revealed a mass with feeding vessel as shown in the image below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fibroid uterus"
      },
      {
        "id": 2,
        "text": "Endometrial polyp"
      },
      {
        "id": 3,
        "text": "Endometrial carcinoma"
      },
      {
        "id": 4,
        "text": "Leiomyosarcoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">Visualisation of a <strong>feeding vessel</strong> on colour doppler is characteristic of an&nbsp;<strong>endometrial polyp</strong>.</p>\n<p class=\"p1\">These are<strong>&nbsp;</strong><strong>homogeneous, isoechoic </strong>lesions that are continuous with the endometrium and preserve the endomyometrial interface. They may be centrally cystic, corresponding to dilated fluid-filled glands.</p>\n<p class=\"p1\">Benign endometrial polyps may occur at all ages, with their greatest prevalence after age 50. They are a common cause of <strong>postmenopausal bleeding.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0dca4ba685964932a44655b81794f504.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The pelvic ultrasound of a 35-year-old woman is given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Singleton pregnancy"
      },
      {
        "id": 2,
        "text": "Monochorionic twins"
      },
      {
        "id": 3,
        "text": "Partial abortion"
      },
      {
        "id": 4,
        "text": "Dichorionic twins"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows the 'T-sign' seen in&nbsp;a <strong>monochorionic twin</strong> pregnancy.</p>\n<p>In monochorionic pregnancy, the chorion does not extend between the layers of the intertwin membrane. Thus, the inter-twin membrane comes to an abrupt halt in a T-configuration at the edge of the amniotic sac.</p>\n<p>The image given below shows the T sign</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9f016f8cef1a4bfcad84f518695d3c79.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3ce06d4567a649e28a073c67031c8722x800x600.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ac09b3a2d7d24aa387f3981d8bdedf62x1280x1132.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0310abab34e34f57b8c2b75f43066083x1000x864.GIF"
    ]
  },
  {
    "text": "The full red arrow head in the below image represents _______",
    "choices": [
      {
        "id": 1,
        "text": "Yolk sac"
      },
      {
        "id": 2,
        "text": "Decidua parietali"
      },
      {
        "id": 3,
        "text": "Decidua Capsularis"
      },
      {
        "id": 4,
        "text": "Chorion"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The full red arrowhead represents the&nbsp;<strong>yolk sac</strong>. The empty red arrowhead shows the double ring: outer - decidua parietalis; inner decidua capsularis.</p>\n<p>The sign is called<strong>&nbsp;double decidua sign,</strong>&nbsp;is seen in the first trimester transvaginal sonogram. It is useful to confirm an early intrauterine location for the pregnancy.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/23919d296121474eb7423230e07026a1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old man is suffering from increasing difficulty in bending forward with increasing stiffness of the spine and reduced chest movements. A CT was performed and shown below, the likely diagnosis is?",
    "choices": [
      {
        "id": 1,
        "text": "Ankylosing spondylitis"
      },
      {
        "id": 2,
        "text": "Rheumatoid arthritis"
      },
      {
        "id": 3,
        "text": "Reiter's syndrome"
      },
      {
        "id": 4,
        "text": "Fluorosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above scenario and the CT findings are suggestive of&nbsp;<strong>a</strong><strong>nkylosing spondylitis&nbsp;</strong>(AS).</p>\n<p><strong>Diagnostic criteria</strong> for AS:</p>\n<ul>\n<li>Insidious onset</li>\n<li>Morning stiffness&nbsp;</li>\n<li>Symptoms begin early at age &lt;40 years</li>\n<li>Improvement with exercise</li>\n<li>Persistence for &gt;3 months &nbsp;</li>\n</ul>\n<p>Examination findings in AS:</p>\n<ul>\n<li>Loss of lumbar lordosis</li>\n<li>Increased thoracic kyphosis</li>\n<li>Diminished spinal movements</li>\n<li>Decreased chest expansion ( &lt;7 cm)</li>\n<li><strong>Positive tests for sacroiliac joint involvement</strong></li>\n</ul>\n<p>Important X-ray features of AS:</p>\n<ul>\n<li class=\"p1\">Sacro-iliac joints:\n<ul>\n<li class=\"p1\">Cardinal sign/<strong>earliest</strong> sign &ndash; <strong>erosion</strong> and fuzziness of the <strong>sacroiliac</strong> joints</li>\n<li class=\"p1\">Later -&nbsp;peri-articular sclerosis and bony ankylosis of the joint</li>\n</ul>\n</li>\n<li class=\"p1\">Vertebral changes:\n<ul>\n<li class=\"p1\"><strong>Earliest</strong> - flattening of the normal anterior concavity of the vertebral body (&lsquo;<strong>squaring</strong>&rsquo;)</li>\n<li class=\"p1\">Later - ossification of the ligaments around the intervertebral discs produces syndesmophytes (bridges) between adjacent vertebrae</li>\n<li class=\"p1\"><strong>Bamboo</strong> <strong>spine</strong> appearance- due to bridging at several vertebral levels</li>\n</ul>\n</li>\n</ul>\n<p>The image below shows the bamboo spine appearance in AS.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7f6e8f6de1134197996732bba7926fa1.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e9c104bf06d1448194b3a509b22a565fx419x659.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad0994b9667f4f399ff080de0f6d7a2fx600x2086.JPEG"
    ]
  },
  {
    "text": "A construction worker presented with pain and swelling of his right arm after falling on his side from a height. An upper arm X-ray was done which is given below. Which nerve is most likely to be injured in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Axillary nerve"
      },
      {
        "id": 2,
        "text": "Ulnar nerve"
      },
      {
        "id": 3,
        "text": "Radial nerve"
      },
      {
        "id": 4,
        "text": "Median nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">In the above clinical scenario, the history and radiograph suggest a&nbsp;closed <strong>fracture</strong> of the <strong>shaft </strong>of the<strong> humerus.&nbsp;</strong>The <strong>radial nerve</strong> is <strong>commonly damaged</strong> in this condition.</p>\n<p class=\"p1\">It manifests as an inability to dorsiflex the wrist and digits (<strong>wrist drop</strong> and<strong> finger drop</strong>). <strong>Numbness</strong> occurs on the <strong>dorsoradial</strong> <strong>aspect</strong> of the hand and the dorsal aspect of the radial 3 1/2 digits.&nbsp;</p>\n<p class=\"p1\"><strong>Management of humerus shaft fractures</strong>:&nbsp;</p>\n<ul>\n<li class=\"p1\">Conservative management using a <strong>hanging cast</strong> or <strong>U-slab</strong> for <strong>2-3 weeks</strong> followed by functional bracing</li>\n<li class=\"p1\"><strong>Surgical fixation</strong> by compression plating, interlocking intramedullary nail, semi-flexible pins, or an external fixator is indicated in:\n<ul>\n<li>Open fractures</li>\n<li>Pathological fractures</li>\n<li>Unstable humeral and forearm fractures (floating elbow)</li>\n<li>Radial nerve palsy</li>\n</ul>\n</li>\n</ul>\n<p>The below X-ray shows shaft of humerus fracture.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/469d36306faa4295882c8f05c3323209.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fbfae747209d4cea9974c1694abf7783x366x600.PNG"
    ]
  },
  {
    "text": "A 5-year-old child was brought to the paediatrician with complaints of bilateral knee pain. His bone mineral density is normal.  The X-ray image of the joints is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Scurvy"
      },
      {
        "id": 2,
        "text": "Rickets"
      },
      {
        "id": 3,
        "text": "Metaphyseal dysplasia"
      },
      {
        "id": 4,
        "text": "Pycnodysostosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical presentation and the X-ray showing <strong>Pelkan spurs, Trummerfeld zone, and Frenkel's line</strong> are suggestive of <strong>scurvy.</strong></p>\n<p>Radiological findings in scurvy:</p>\n<ul>\n<li><strong>Frenkel's line -\u00a0</strong>Zone of provisional calcification\u00a0at the growing\u00a0metaphysis\u00a0is seen as a dense, white line called the Frankel's line<strong>.</strong></li>\n<li><strong>Pelkan spurs -\u00a0</strong>These are metaphyseal spurs\u00a0formed due to fractures manifesting at the cortical margins.\u00a0</li>\n<li><strong>Wimberger\u2019s ring sign -\u00a0</strong>The<strong>\u00a0sclerotic rim</strong>\u00a0around the epiphysis forms this appearance.</li>\n<li><strong>Trummerfeld zone</strong>. - Lucent metaphyseal band underlying Frankel line.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/41502e8823ea4700bafa61c1d652bcb9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f048e650f0ed42d18cd66daa345ae8fcx1280x1203.JPEG"
    ]
  },
  {
    "text": "A 24-year old male patient was brought to the emergency department following a road traffic accident. His heart rate was 100/min, respiratory rate was 24/min, and his chest X-ray is given below. Which of the following is contraindicated in him?",
    "choices": [
      {
        "id": 1,
        "text": "Nasogastric tube insertion"
      },
      {
        "id": 2,
        "text": "Chest tube insertion"
      },
      {
        "id": 3,
        "text": "Log roll"
      },
      {
        "id": 4,
        "text": "Epidural anaesthesia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows elevation of left hemidiaphragm with bowel and stomach in place. The probable cause would be diaphragmatic hernia following blunt injury due to a road traffic accident. In this condition, <strong>chest tube</strong> insertion (option B) is <strong>contraindicated</strong>.&nbsp;</p>\n<p>Chest tube insertion/ thoracostomy is indicated in pneumothorax, hemothorax, chylothorax, pleural effusion, etc. Contraindications include pulmonary adhesions, pulmonary trauma, coagulopathy, and diaphragmatic hernia.</p>\n<p>A chest tube is inserted the in <strong>5th intercostal space</strong> anterior to the midaxillary line in the <strong>triangle of safety</strong>.&nbsp;It lies</p>\n<ul>\n<li>anterior to the midaxillary line</li>\n<li>above the level of the nipple</li>\n<li>below and lateral to the pectoralis major muscle</li>\n</ul>\n<p>&nbsp;Nasogastric tube insertion, log roll, and epidural anesthesia are not contraindicated in an acquired diaphragmatic hernia.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/40d9aebd27a743f2ba9d4dfb525288d5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3275c6a8e4974c78a574b0196dc33646x600x1759.JPEG"
    ]
  },
  {
    "text": "A man presented with complaints of chest pain and a feeling of food getting stuck in the esophagus, after a meal. He has asthma and is under treatment. PPIs were prescribed but it did not resolve the problem so a barium swallow was done and showed the following. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Eosinophilic esophagitis"
      },
      {
        "id": 2,
        "text": "Schatzki ring"
      },
      {
        "id": 3,
        "text": "Plummer-Vinson syndrome"
      },
      {
        "id": 4,
        "text": "Esophageal carcinoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario and imaging findings are suggestive of <strong>eosinophilic esophagitis.</strong></p>\n<p>Eosinophilic esophagitis is an <strong>idiopathic condition</strong> commonly affecting the <strong>proximal one-third</strong> of the <strong>esophagus.</strong> There is <strong>migration of eosinophils</strong> to the esophagus and they contribute to <strong>extensive tissue damage</strong> and <strong>inflammation</strong>.&nbsp;&nbsp;</p>\n<p>Clinical features include swallowing difficulty, food impaction, vomiting, and heartburn.</p>\n<p>Barium swallow shows the presence of a <strong>series of rings</strong> in the esophagus which is suggestive of <strong>eosinophilic esophagitis. </strong>These rings appear as stripes on the cat and is also known as the <strong>feline esophagus</strong>.</p>\n<p>Feline esophagus:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1db99cc0e9504fccaf37efa5382c04d7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4601bbc9f71240d486ac1ea787daeab4x592x472.JPEG"
    ]
  },
  {
    "text": "A 25-year-old male patient was brought to the ER after RTA, his RR is 25/min, BP is 80/45mmHg. On examination, hyper-resonance is heard over the left side of the chest. The chest X-ray performed is given below. What would be the appropriate management in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Wide bore needle insertion in the 5th intercostal space (ICS)"
      },
      {
        "id": 2,
        "text": "Wide bore needle insertion in the 5th ICS followed by an intercostal drain in the 5th ICS"
      },
      {
        "id": 3,
        "text": "Aspiration of the pleural fluid"
      },
      {
        "id": 4,
        "text": "No intervention needed"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given clinical scenario of <strong>hemodynamic instability</strong>, <strong>hyper resonance</strong> on the left side of the chest, and the X-ray are suggestive of <strong>tension pneumothorax</strong>.&nbsp;It is managed by inserting a <strong>wide-bore&nbsp;needle</strong> in the <strong>5th ICS</strong> followed by placing an <strong>intercostal drain</strong> in the <strong>5th ICS</strong>.</p>\n<p class=\"p1\"><strong>Traumatic pneumothorax</strong> can be:</p>\n<ul>\n<li class=\"p1\"><strong>Simple pneumothorax</strong>: Without hemodynamic instability</li>\n<li>Tension pneumothorax: With hemodynamic instability</li>\n</ul>\n<p>Management:</p>\n<ul>\n<li>Simple pneumothorax: Tube thoracostomy or chest tube insertion in the 5th ICS in the triangle of safety</li>\n<li>Tension pneumothorax:&nbsp;\n<ul>\n<li><strong>Immediate</strong> management: <strong>Needle decompression</strong> or <strong>needle thoracostomy</strong> i.e. insertion of a wide-bore needle in the 5th ICS anterior to the midaxillary line</li>\n<li><strong>Definitive</strong> management: <strong>Tube thoracostomy</strong> or <strong>chest tube insertion</strong> in the 5th ICS in the triangle of safety</li>\n</ul>\n</li>\n</ul>\n<p>The X-ray given below is showing a left-sided tension pneumothorax. There is a large, well-demarcated area devoid of lung markings on the left side. The yellow arrows are pointing to the tracheal deviation and the mediastinal shift to the right side.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fd79ebb07c0b4e089ba945c069c4ad9c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3ec76303e85e4f83911eab4ae64328cbx1280x1186.PNG"
    ]
  },
  {
    "text": "In a patient with abdominal pain and sterile pyuria, what is the finding shown in the image given?",
    "choices": [
      {
        "id": 1,
        "text": "Putty kidney"
      },
      {
        "id": 2,
        "text": "Nephrocalcinosis"
      },
      {
        "id": 3,
        "text": "Staghorn calculus"
      },
      {
        "id": 4,
        "text": "Psoas calcification"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a patient with&nbsp;<strong>abdominal pain</strong> with<strong> sterile pyuria,</strong>&nbsp;the given image finding points towards a diagnosis of a <strong>putty kidney</strong>. It is a characteristic finding of genitourinary tuberculosis (TB), specifically<strong> renal TB.&nbsp;</strong>The given image shows a homogenous and ground glass-like calcification of the kidney appearing like putty.</p>\n<p>It is caused by the dissemination of the organism through the bloodstream and is thus is always a secondary TB. There is either reinfection or reactivation of old TB.</p>\n<p>Genitourinary TB is a cause of <strong>sterile pyuria</strong>. Diagnosis is confirmed with a tuberculin test, or at least 3 consecutive early-morning specimens of urine are examined for acid-fast bacilli. They are stained with a Ziehl&ndash;Neelsen stain and subsequently cultured.</p>\n<p>CT is the most sensitive modality and is the preferred means of visualizing renal calcifications. CT urography is done to assess the various stages of renal TB and its manifestations which are as follows:</p>\n<ul>\n<li>Early: Papillary necrosis</li>\n<li>Progressive:\n<ul>\n<li>Multifocal strictures</li>\n<li>Generalized or focal hydronephrosis</li>\n<li>Mural thickening and enhancement</li>\n<li>Poorly enhancing renal parenchyma</li>\n</ul>\n</li>\n<li>End-stage:\n<ul>\n<li>Progressive hydronephrosis</li>\n<li>Amorphous dystrophic calcification that involves the entire kidney - <strong>putty kidney</strong></li>\n</ul>\n</li>\n</ul>\n<p>Treatment involves short-course therapy with antitubercular drugs like pyrazinamide, isoniazid, and rifampicin. Partial nephrectomy, nephrectomy, or reconstructive surgery is often done.</p>\n<p>Other options: Nephrocalcinosis is the deposition of calcium in the kidney parenchyma or tubules which is seen in hypercalcemia conditions like hyperparathyroidism. (option B)</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b104eb9b3c3e48e2bf3e6e9b966ebb8d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8ef8a12be91346fcbbf1110c83f50f74x490x649.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/11138d2cb6824c879bc3b2b05541cc10x502x449.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/671962f1854c4c7186982ec8d1359b23x441x548.PNG"
    ]
  },
  {
    "text": "Identify the investigation and the lesion depicted in the image given below.",
    "choices": [
      {
        "id": 1,
        "text": "Retrograde cystourethrogram with membranous urethra stricture"
      },
      {
        "id": 2,
        "text": "Retrograde cystourethrogram with penile urethral stricture"
      },
      {
        "id": 3,
        "text": "Micturating cystourethrography with bulbar stricture"
      },
      {
        "id": 4,
        "text": "Micturating cystourethrography with prostratic urethra stricture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p style=\"text-align: left;\">The given image shows <strong>retrograde cystourethrogram</strong> with findings consistent with <strong>penile urethral stricture</strong>.</p>\n<p style=\"text-align: left;\">The male urethra can be visualized by <strong>retrograde urethrography (RGU)</strong>&nbsp;or&nbsp;<strong>voiding cystourethrogram (VCU), </strong>also known as <strong>micturating cystourethrogram (MCU).</strong></p>\n<p style=\"text-align: left;\">In RGU, the urethra is visualized with the instillation of contrast into the <strong>anterior urethra</strong> (penile urethra and bulbar urethra). It is helpful for diagnosing <strong>anterior urethral abnormalities</strong>.</p>\n<p style=\"text-align: left;\">The following image shows an RGU with bulbar urethral stricture:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/feb95457cee241a89fdec62ec88c47fc.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3e25e9ceb90c490d861289d850eac22ex608x520.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08236bd5a4d343518c8760b7cb3d28f3x1080x1400.JPEG"
    ]
  },
  {
    "text": "All structures can be seen in the following x ray view except?",
    "choices": [
      {
        "id": 1,
        "text": "Frontal sinus"
      },
      {
        "id": 2,
        "text": "Sphenoid sinus"
      },
      {
        "id": 3,
        "text": "Maxillary sinus"
      },
      {
        "id": 4,
        "text": "Ethmoid sinus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>The above X Ray view is called as ' Caldwell's view'.</strong></p>\n<p>Structures seen in&nbsp;<strong>Caldwell's view&nbsp;</strong>are:</p>\n<ul>\n<li><strong>Frontal sinuses (seen best)</strong></li>\n<li>Ethmoid sinuses</li>\n<li>Maxillary sinuses</li>\n<li>Frontal process of the zygoma and the zygomatic process of the frontal bone</li>\n<li>Superior margin of orbit and lamina papyracea</li>\n<li>Superior orbital fissure</li>\n<li>Foramen rotundum (inferolateral to superior orbital fissure)</li>\n</ul>\n<p><strong>In Caldwell's view.</strong></p>\n<ul>\n<li>The nose and forehead are touching the x-ray film</li>\n<li>The X-ray beam is projected 15 degrees h</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a9a37bd00e5c47fba591baf3886cbdbc.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presents to you with bronchiectasis and chronic sinusitis. Chest X-Ray shows the following finding. Which of the following is the method of protection of the lower airway that's compromised in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Temperature regulation"
      },
      {
        "id": 2,
        "text": "Humidification"
      },
      {
        "id": 3,
        "text": "Mucociliary mechanism"
      },
      {
        "id": 4,
        "text": "Mucosal defense with immunoglobulins"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of <strong>chronic sinusitis</strong>, <strong>bronchiectasis</strong> and the X-ray showing dextrocardia (<strong>situs inversus</strong>) is suggestive of<strong> Kartagener syndrome.</strong>&nbsp;The <strong>mucociliary mechanism</strong> is compromised in this case, due to <strong>immotile</strong> cilia.&nbsp;</p>\n<p>The <strong>lower</strong> <strong>airway</strong> is protected by the following mechanisms:</p>\n<ul>\n<li><strong>Mucociliary mechanism</strong> - The inspired pathogens and dust are trapped&nbsp;on the viscous mucous blanket. By beating of the cilia, the mucus is&nbsp;carried to the nasopharynx to be swallowed.&nbsp;</li>\n<li><strong>Chemical mechanisms</strong> - Immunoglobulins such as IgA, IgE, and Lactoferrin, lysozyme provide innate immunity.</li>\n<li><strong>Sneezing</strong> - It is a protective reflex due to irritation of the nasal mucosa.</li>\n</ul>\n<p><strong>Temperature regulation</strong> and <strong>humidification</strong> are due to the large surface area of mucosa and highly vascular cavernous spaces. This is achieved by an&nbsp;increase or decrease in <strong>blood flow</strong> which in turn increase or decrease the <strong>size of turbinates.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c0a019b28abd4531b36e598a27e15726.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 026 (Radiographs)';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>