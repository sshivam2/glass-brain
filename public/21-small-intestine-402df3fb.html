<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>21 Small Intestine - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Surgery
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">31</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following statements is false regarding the surgical anatomy of the small intestine?",
    "choices": [
      {
        "id": 1,
        "text": "The duodenum is demarcated from the jejunum by the ligament of Treitz."
      },
      {
        "id": 2,
        "text": "The ileum makes up three-fifths of the small intestine."
      },
      {
        "id": 3,
        "text": "The blood supply to the jejunum may have four or five separate arcades with shorter vasa recta"
      },
      {
        "id": 4,
        "text": "The jejunum has a larger circumference, is thicker than the ileum"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> ligament of Treitz </strong>or the suspensory muscle of the duodenum is found at the <strong>junction</strong> of the <strong>duodenum and jejunum</strong>. It also forms the&nbsp;line of <strong>demarcation</strong> for <strong>gastrointestinal&nbsp;bleeding</strong>:</p>\n<ul>\n<li><strong>Upper</strong> GI bleeding - refers to bleeding <strong>proximal</strong> to the ligament of Treitz</li>\n<li><strong>Lower</strong> GI bleeding - refers to bleeding <strong>distal</strong> to the ligament of Treitz.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f5f077035ea426e8bceec840d2e0f72x1280x2065.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3adfd10ea03a433eb7aee6518c58a52dx1280x1267.JPEG"
    ]
  },
  {
    "text": "In a plain X-ray of the abdomen, the small bowel is said to be dilated if the diameter is more than  ______.",
    "choices": [
      {
        "id": 1,
        "text": "2 cm"
      },
      {
        "id": 2,
        "text": "3 cm"
      },
      {
        "id": 3,
        "text": "4 cm"
      },
      {
        "id": 4,
        "text": "5 cm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>small bowel</strong> is said to be&nbsp;<strong>dilated</strong> if the <strong>diameter is more than 3 cm </strong>in a plain X-ray.</p>\n<p>The&nbsp;following triad of findings is<strong>&nbsp;specific </strong>for<strong> small bowel obstruction</strong>&nbsp;on&nbsp;<strong>plain X-ray</strong> imaging of the abdomen:</p>\n<ul>\n<li>Dilated small bowel loops <strong>(&gt;3 cm in diameter)</strong></li>\n<li>Air-fluid levels seen on upright films&nbsp;</li>\n<li>A paucity of air in the colon.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/65cce0615af9418084c51f485eeb45c4x720x720.JPEG"
    ]
  },
  {
    "text": "In a suspected case of bowel obstruction, the presence of which of the following helps you to distinguish the small intestine from the large intestine?",
    "choices": [
      {
        "id": 1,
        "text": "Appendices epiploicae"
      },
      {
        "id": 2,
        "text": "Valvule conniventes"
      },
      {
        "id": 3,
        "text": "Tenia coli"
      },
      {
        "id": 4,
        "text": "Haustrations"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The presence of <strong>valvule conniventes (plicae circulares)&nbsp;</strong>helps to distinguish the <strong>small intestine</strong> from the large intestine. They are<strong> prominent mucosal folds </strong>seen in the gross examination of the small intestine&nbsp;and<strong>&nbsp;</strong>are also visible radiographically. They are&nbsp;more prominent in the&nbsp;<strong>jejunum</strong>.</p>\n<p>Radiological differences between small bowel and large bowel obstruction are:</p>\n<table>\n<tbody>\n<tr>\n<td>Radiological features</td>\n<td>Small bowel</td>\n<td>Large bowel</td>\n</tr>\n<tr>\n<td>Valvulae conniventes</td>\n<td>Present in jejunum</td>\n<td>Absent</td>\n</tr>\n<tr>\n<td>No of Loops</td>\n<td>Many</td>\n<td>Few</td>\n</tr>\n<tr>\n<td>Distribution of loops</td>\n<td>Central</td>\n<td>Peripheral</td>\n</tr>\n<tr>\n<td>Haustra</td>\n<td>Absent</td>\n<td>Present</td>\n</tr>\n<tr>\n<td>Diameter</td>\n<td>3-5 cm</td>\n<td>&gt;5 cm</td>\n</tr>\n<tr>\n<td>Solid faeces</td>\n<td>Absent</td>\n<td>Present</td>\n</tr>\n</tbody>\n</table>\n<p>Investigation of choice: <strong>CECT </strong>abdomen (<strong>adults</strong>); <strong>USG </strong>abdomen (<strong>children</strong>)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/20bcee9bbe60414a8d6601aab7d71da1x736x373.JPEG"
    ]
  },
  {
    "text": "A 42-year-old man with past history of inguinal hernia presented with sudden onset of severe abdominal pain that started 4 hours ago. His abdomen was tender and rigid along with a lump in the inguinal region with purplish skin changes. Which of the following is the ideal management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Resuscitative measures and arrange for immediate laparotomy"
      },
      {
        "id": 2,
        "text": "Conservative management with a nasogastric tube and IV fluid, assessment every 24 hrs"
      },
      {
        "id": 3,
        "text": "Perform an oral contrast study, followed by pneumatic decompression"
      },
      {
        "id": 4,
        "text": "Endoscopic decompression"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical vignette is suggestive of <strong>intestinal obstruction</strong>,&nbsp; due to a <strong>strangulated inguinal hernia</strong>. The ideal management is <strong>exploratory laparotomy</strong> as soon as possible with ongoing resuscitative measures until surgery.<br />Bowel strangulation is a type of mechanical bowel obstruction, associated with <strong>complete cessation</strong> of <strong>blood supply</strong> leading to irreversible loss of viability of the affected bowel segment. Inguinal hernias, most commonly of non-reducible type, are associated with a high chance of strangulation and need urgent medical intervention.</p>\n<p>Bowel strangulation can be suspected in the presence of</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">constant severe abdominal pain,&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">abdominal tenderness with <strong>rigidity</strong> and <strong>peritonism</strong>,&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">signs of <strong>shock</strong>, and lack of response to conservative management.&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Reduced bowel wall enhancement</strong> on CT&nbsp;</li>\n</ul>\n<p>When strangulation occurs in an external hernia, the lump is tense, tender, and irreducible with overlying <strong>skin changes</strong> (erythema or purplish discoloration).</p>\n<p>Supportive management:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">IV fluids</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Nasogastric tube to decompress the bowel and reduce abdominal distention</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">IV antibiotics (adequate coverage required for gram -ve and anaerobes)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Analgesia</li>\n</ul>\n<p>Definitive management:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Continue supportive management up to 72 hrs if suspicious of adhesions. Surgical exploration and adhesiolysis should be done if there is no improvement.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Immediate surgical exploration and resection of non-viable gut segments if suspicious of any of the following:</li>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"2\"><strong>Obstructed external hernia</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Clinical features suspicious of intestinal <strong>strangulation</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Obstruction in a &lsquo;virgin&rsquo; abdomen (i.e no prior history of intraabdominal surgery)</li>\n</ul>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A surgeon sees a necrotic bowel when operating on a child for an inguinal hernia. What is true about the resection and anastomosis of the bowel?",
    "choices": [
      {
        "id": 1,
        "text": "The surgeon must use chromic catgut"
      },
      {
        "id": 2,
        "text": "The surgeon must not include the submucosa in the sutures"
      },
      {
        "id": 3,
        "text": "The surgeon must use the single-layer, extramucosal suture technique"
      },
      {
        "id": 4,
        "text": "The surgeon must use the single-layer seromuscular suture technique"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The standard technique used currently for resection anastomosis of the bowel is a <strong>one-layer extra mucosal suture technique</strong>&nbsp;since it causes the <strong>least tissue necrosis and luminal narrowing</strong>. Interrupted and continuous single-layer suture techniques are adequate and safe.</p>\n<p>The extra mucosal suture must also include the<strong> submucosa</strong>&nbsp;because this layer has a high collagen content and it is the <strong>most stable suture layer</strong> in all sections of the gastrointestinal tract.</p>\n<p><strong>Catgut</strong> has now been <strong>replaced </strong>with <strong>absorbable synthetic polymers</strong>. Stapling devices can be used when speed is required.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child who underwent an appendicectomy is brought to the emergency with abdominal distension and vomiting. The mother tells that the child passed stools that looked like currant jelly. The ultrasound finding is shown below. What is the most likely location of this pathology in this child?",
    "choices": [
      {
        "id": 1,
        "text": "Colocolic"
      },
      {
        "id": 2,
        "text": "Rectosigmoid"
      },
      {
        "id": 3,
        "text": "Ileoileal"
      },
      {
        "id": 4,
        "text": "Ileocolic"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above image shows the coiled spring appearance</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b5bac3b00287420c977422d3e45cfedd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/963ee27ab03b4b03b453e06f2c28e509x720x339.JPEG"
    ]
  },
  {
    "text": "A 3-day-old neonate presents with abdominal distension and bilious vomiting. An erect X-ray of the abdomen is done and shown below. The neonate is taken up for surgery and an apple-peel bowel with loss of dorsal mesentery is seen. Which type of ileal atresia has this feature?",
    "choices": [
      {
        "id": 1,
        "text": "Type 1"
      },
      {
        "id": 2,
        "text": "Type 2"
      },
      {
        "id": 3,
        "text": "Type 3"
      },
      {
        "id": 4,
        "text": "Type 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Classification of Jejunoileal atresia:</p>\n<table width=\"433\">\n<tbody>\n<tr>\n<td width=\"100\">\n<p><strong>Type</strong></p>\n</td>\n<td width=\"333\">\n<p><strong>Feature</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"100\">\n<p>Type 1</p>\n</td>\n<td width=\"333\">\n<p>Mucosal web or diaphragm</p>\n</td>\n</tr>\n<tr>\n<td width=\"100\">\n<p>Type 2</p>\n</td>\n<td width=\"333\">\n<p>With an atretic cord between two blind ends of bowel with intact mesentery</p>\n</td>\n</tr>\n<tr>\n<td width=\"100\">\n<p>Type 3 a</p>\n</td>\n<td width=\"333\">\n<p>Complete separation of the blind ends of the bowel by a V-shaped mesenteric gap</p>\n</td>\n</tr>\n<tr>\n<td width=\"100\">\n<p>Type 3 b</p>\n</td>\n<td width=\"333\">\n<p>An <strong>apple peel</strong> or <strong>Christmas tree deformity</strong> with a large mesenteric gap</p>\n</td>\n</tr>\n<tr>\n<td width=\"100\">\n<p>Type 4</p>\n</td>\n<td width=\"333\">\n<p>Multiple atresias, with a string of sausage appearance</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fd7119bb99df437a8ce4bfd0e33fc38a.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dca6d08b92d6418a80b1c748c1028b3ax1280x4449.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/52089dbbb9a047a68a9be246dc192ad3x331x325.PNG"
    ]
  },
  {
    "text": "A child with complaints of abdominal pain and vomiting for the past 24 hours associated with tenderness over McBurney's point undergoes open appendicectomy. However, during surgery, the appendix was found to be normal. On exploration of the ileum, the following finding is seen. Which of the following statements is false regarding this condition?",
    "choices": [
      {
        "id": 1,
        "text": "It is a lead point for intussusception"
      },
      {
        "id": 2,
        "text": "Gastric mucosa is the most common heterotropic tissue"
      },
      {
        "id": 3,
        "text": "Arises at the mesenteric border"
      },
      {
        "id": 4,
        "text": "Located 60 cm proximal to ileocecal valve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario is suggestive of <strong>Meckel&rsquo;s diverticulitis</strong>. It arises from the <strong>antimesenteric border </strong>of the small intestine.</p>\n<p>Meckel&rsquo;s diverticulum is the most commonly encountered congenital anomaly of the small intestine. Meckel&rsquo;s diverticulum is caused by a <strong>failure </strong>of normal <strong>regression</strong> of the <strong>vitelline duct</strong> or omphalomesenteric duct that develops during weeks 5 to 7 of gestation. It contains all 3 layers of the intestine and hence it is a <strong>true diverticulum</strong>.&nbsp;</p>\n<p>It is located&nbsp;<strong>45 to 60 cm proximal </strong>to the <strong>ileocecal valve.</strong><strong>&nbsp;</strong>The most&nbsp;common <strong>heterotopic </strong>tissue within the <strong>Meckel&rsquo;s diverticulum </strong>is<strong>&nbsp;gastric mucosa </strong>(50%) followed by pancreatic mucosa(5%) and colonic mucosa.</p>\n<p>Most Meckel&rsquo;s diverticula are <strong>benign</strong> and are <strong>incidentally</strong> discovered. Its clinical features include:</p>\n<ul>\n<li>Gastrointestinal bleeding (most common)</li>\n<li><strong>Intestinal obstruction</strong>, which may occur as:&nbsp;&nbsp;\n<ul>\n<li>Volvulus</li>\n<li>Intussusception (ileo-ileal or ileo-colic)</li>\n<li>Incarcerated <strong>Littre&rsquo;s hernia.</strong></li>\n</ul>\n</li>\n</ul>\n<p>Complications of Meckel's diverticulum are:</p>\n<ul>\n<li>Diverticulitis - presents like appendicitis</li>\n<li>Perforation - resembles a perforated duodenal ulcer</li>\n<li>Peritonitis</li>\n<li>Neoplasms - <strong>neuroendocrine tumour </strong>(most common) &gt; adenocarcinoma&nbsp; &gt; GIST &gt; lymphoma.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4e44f622a1de4f85bca7e47113d8320e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2ee1269bed57481e9efe8bbeaf3f9cf3x600x684.PNG"
    ]
  },
  {
    "text": "What is the most common presentation of Meckel\u2019s diverticulum?",
    "choices": [
      {
        "id": 1,
        "text": "Lower GI bleeding"
      },
      {
        "id": 2,
        "text": "Constipation"
      },
      {
        "id": 3,
        "text": "Diarrhea"
      },
      {
        "id": 4,
        "text": "Abdominal pain"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most common presentation of Meckel&rsquo;s diverticulum is <strong>lower gastrointestinal bleeding.</strong></p>\n<p>Clinical features of Meckel's diverticulum include:</p>\n<ul>\n<li><strong>Lower GI&nbsp;bleeding</strong> (most common in <strong>children</strong> and overall)</li>\n<li>Abdominal pain</li>\n<li>Vomiting</li>\n</ul>\n<p>Another common presentation is an&nbsp;<strong>intestinal obstruction</strong> (most common in <strong>adults</strong>), which may occur due to:</p>\n<ul>\n<li>Volvulus</li>\n<li>Intussusception (ileo-ileal or ileo-colic)&nbsp;</li>\n<li>Incarcerated Littre&rsquo;s hernia.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following cannot be used to increase the sensitivity of the Tc-pertechnate scan in Meckel's diverticulum?",
    "choices": [
      {
        "id": 1,
        "text": "Glucagon"
      },
      {
        "id": 2,
        "text": "Pentagastrin"
      },
      {
        "id": 3,
        "text": "Cimetidine"
      },
      {
        "id": 4,
        "text": "Metoclopramide"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Metoclopramide is not used to increase the sensitivity of the Tc-pertechnate scan in Meckel's diverticulum.&nbsp;</p>\n<p><strong>Metoclopramide</strong> stimulates gastric motility and decreases the time available for the uptake of&nbsp;Tc-pertechnate. Hence it <strong>reduces sensitivity</strong>.</p>\n<p><sup>99m</sup>Tc-pertechnetate is preferentially taken up by the <strong>mucus-secreting cells of the gastric mucosa</strong> and <strong>ectopic gastric tissue.</strong></p>\n<p>The sensitivity of the Tc-pertechnate scan is increased by:</p>\n<ul>\n<li><strong>Glucagon</strong>: Relaxes the smooth muscles of the gastrointestinal tract. This decreases peristalsis, causing&nbsp;enhanced detection of the ectopic gastric mucosa in Meckel's diverticulum</li>\n<li><strong>Pentagastrin</strong>: Potent stimulator of gastric secretions. Increases uptake and secretion of pertechnetate by the gastric mucosa</li>\n<li><strong>Cimetidine</strong>: Increases radionuclide uptake, and decreases peptic secretion and the release of pertechnetate from the diverticular lumen. This results in higher radionuclide concentrations in the wall of the diverticulum.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What will be the investigation of choice in a child suspected to have Meckel\u2019s diverticula?",
    "choices": [
      {
        "id": 1,
        "text": "Tc-99 radionuclide scan"
      },
      {
        "id": 2,
        "text": "Barium study"
      },
      {
        "id": 3,
        "text": "Enteroclysis"
      },
      {
        "id": 4,
        "text": "Endoscopy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Most of the Meckel&rsquo;s diverticula are discovered <strong>incidentally</strong>. In the absence of bleeding, Meckel&rsquo;s diverticula are rarely diagnosed prior to the time of surgical intervention.</p>\n<p>Other investigations for Meckel's diverticulum:</p>\n<ul>\n<li><strong>Angiography&nbsp;</strong>is used to locate the site of bleeding in an acute hemorrhage.&nbsp;</li>\n<li><strong>CT scan&nbsp;</strong>has a very <strong>low sensitivity.&nbsp;</strong></li>\n<li><strong>Enteroclysis</strong><strong>&nbsp;</strong>has<strong>&nbsp;</strong>an accuracy of 75% but is usually not applicable during acute presentations.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0058e2da3c444e20afc460be0d164c7bx1024x862.JPEG"
    ]
  },
  {
    "text": "While performing an inguinal hernia repair in a 3-year-old boy, you notice Meckel\u2019s diverticulum as the content of the hernial sac. What is this hernia called?",
    "choices": [
      {
        "id": 1,
        "text": "Amyand\u2019s hernia"
      },
      {
        "id": 2,
        "text": "Narath's hernia"
      },
      {
        "id": 3,
        "text": "Cloquet's hernia"
      },
      {
        "id": 4,
        "text": "Littre\u2019s hernia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option A:<strong> Amyand&rsquo;s hernia</strong>&nbsp;is an <strong>inguinal </strong>hernia in which the hernia sac <strong>contains</strong> a normal or acutely inflamed <strong>appendix</strong>.</p>\n<p>Option B:<strong> Narath&rsquo;s hernia </strong>is seen in patients with&nbsp;<strong>congenital dislocation of the hip</strong>.&nbsp;It is a <strong>femoral </strong>hernia seen&nbsp;behind the femoral vessels.</p>\n<p>Option C:<strong> Cloquet&rsquo;s hernia </strong>is a type of <strong>femoral </strong>hernia where the sac lies&nbsp;under the pectineus fascia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/362187e7798048298b3ce3402d79e168x1200x1310.JPEG"
    ]
  },
  {
    "text": "While performing a laparotomy, the surgeon incidentally notices a narrow-mouthed, thickened  Meckel\u2019s diverticulum. What is the treatment of choice?",
    "choices": [
      {
        "id": 1,
        "text": "Resection of the diverticulum"
      },
      {
        "id": 2,
        "text": "Leave as such"
      },
      {
        "id": 3,
        "text": "Ligate at base"
      },
      {
        "id": 4,
        "text": "Resection with part of ileum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a <strong>narrow-mouthed, thickened </strong>Meckel&rsquo;s diverticulum,<strong> resection </strong>of the diverticulum is the treatment of choice<strong>.</strong></p>\n<p>When Meckel's diverticulum is found in the course of abdominal surgery:</p>\n<ul>\n<li>In cases of <strong>narrow-mouthed</strong>, thickened Meckel&rsquo;s diverticulum, <strong>resection</strong> of the diverticulum is the treatment of choice</li>\n<li>If it has a <strong>wide mouth </strong>and is <strong>not thickened, </strong>it&nbsp;can safely be <strong>left alone.</strong></li>\n</ul>\n<p>Rarely, Meckel's diverticulum is <strong>complicated</strong> by a&nbsp;<strong>meso-diverticular</strong> <strong>band</strong>, which is believed to be a remnant of a vitelline artery. In such&nbsp;<strong>symptomatic</strong> cases, the treatment is&nbsp;<strong>diverticulectomy </strong>with the<strong> removal of associated bands</strong> connecting the diverticulum to the abdominal wall or intestinal mesentery.</p>\n<div class=\"page\" title=\"Page 1191\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Segmental resection of the ileum</strong> that includes both the diverticulum and the adjacent ileal peptic ulcer should be performed if:</p>\n<ul>\n<li>&nbsp;There is bleeding from the diverticulum</li>\n<li>&nbsp;The base is inflamed or perforated</li>\n<li>&nbsp;The diverticulum contains a tumour.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most common site for acquired diverticula in the small intestine?",
    "choices": [
      {
        "id": 1,
        "text": "Duodenum"
      },
      {
        "id": 2,
        "text": "Jejunum"
      },
      {
        "id": 3,
        "text": "Proximal ileum"
      },
      {
        "id": 4,
        "text": "Distal ileum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most common site for <strong>acquired </strong>diverticula in the <strong>small intestine</strong> is the <strong>second part of the&nbsp;duodenum </strong>(Windsock's diverticulum).</p>\n<p>The<strong> colon</strong> is the most common site for acquired/false diverticula <strong>overall</strong>, followed by the duodenum.</p>\n<p><strong>Meckel&rsquo;s diverticulum</strong> is the most common <strong>true congenital diverticulum</strong> of the small bowel.</p>\n<p>A barium swallow showing a well-defined diverticulum in the second part of the duodenum (Windsock's diverticulum) is shown below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b51eccfc2dbc419c977b7a32167a2accx562x752.PNG"
    ]
  },
  {
    "text": "A 38-year-old man presents with dull aching abdominal pain for the past few weeks accompanied by loss of weight and appetite. A barium meal follow-through image is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Colon carcinoma"
      },
      {
        "id": 2,
        "text": "Intestinal lymphoma"
      },
      {
        "id": 3,
        "text": "Ileocecal tuberculosis"
      },
      {
        "id": 4,
        "text": "Crohn\u2019s disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The yellow color arrow marks indicate the <strong>shrunken caecum,</strong>&nbsp;stricturous <strong>narrowing of the terminal ileum</strong> and <strong>ileocaecal</strong> junction, and&nbsp;<strong>proximal ileal dilatation.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/20ad8d1b7f9248dc93b571eb5fb36983.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3fdf7aa812824cd69512d527169c4146x1200x1493.JPEG"
    ]
  },
  {
    "text": "A respiratory therapist presents to the OPD with abdominal pain. He also complains of low-grade fever, night sweats, and loss of weight. You investigate him for intestinal tuberculosis. Which of the following radiological signs are expected to be seen in him?",
    "choices": [
      {
        "id": 1,
        "text": "2, 4, 5"
      },
      {
        "id": 2,
        "text": "3, 4, 5"
      },
      {
        "id": 3,
        "text": "1, 2, 3"
      },
      {
        "id": 4,
        "text": "1, 3, 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Creeping fat sign and apple core sign are not the radiological findings seen in intestinal tuberculosis.</p>\n<p>The <strong>creeping fat sign</strong> refers to the widely separated bowel loops due to fibrofatty proliferation seen in <strong>Crohn's disease.</strong></p>\n<p>The <strong>apple core</strong> <strong>sign</strong> describes a short&nbsp;segment&nbsp;irregular circumferential stricture of the large bowel that has&nbsp;abrupt shouldered margins&nbsp;resembling an&nbsp;apple core. This appearance is classically seen in a stenosing annular&nbsp;<strong>colon carcinoma</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/751b33abff5d44ef846278dd67d474e0x554x325.PNG"
    ]
  },
  {
    "text": "Match the following radiological signs in intestinal tuberculosis with their respective appearance:",
    "choices": [
      {
        "id": 1,
        "text": "1 - C, 2 - B, 3 - D, 4 - A"
      },
      {
        "id": 2,
        "text": "1 - C, 2 - D, 3 - A, 4 - B"
      },
      {
        "id": 3,
        "text": "1 -D, 2 - A, 3 - B, 4 - C"
      },
      {
        "id": 4,
        "text": "1 - B, 2 - A, 3 - D, 4 - C"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correctly matched option is 1 - C, 2 - B, 3 - D, 4 - A.</p>\n<table style=\"height: 186px;\" width=\"505\">\n<tbody>\n<tr>\n<td style=\"width: 244.5px;\"><strong>Sign</strong></td>\n<td style=\"width: 244.5px;\"><strong>Appearance</strong></td>\n</tr>\n<tr>\n<td style=\"width: 244.5px;\">Sterlein sign</td>\n<td style=\"width: 244.5px;\">\n<p>Narrowing of the terminal ileum&nbsp;with a shortened cecum</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 244.5px;\">Gooseneck deformity</td>\n<td style=\"width: 244.5px;\">Loss of ileocecal angle&nbsp;with&nbsp;dilated terminal ileum</td>\n</tr>\n<tr>\n<td style=\"width: 244.5px;\">String sign</td>\n<td style=\"width: 244.5px;\">A persistent narrow stream of barium&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 244.5px;\">Fleischner sign&nbsp;</td>\n<td style=\"width: 244.5px;\">Thickening of the valve lips,&nbsp;with&nbsp;narrowing&nbsp;of the&nbsp;terminal ileum</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presented with pain abdomen, diarrhoea, and fever gradually increasing in a step ladder pattern over the past 2 weeks. A Widal test confirmed the diagnosis and he was admitted. A few days later, he developed intestinal perforation and was taken up for exploratory laparotomy. Which of the following findings would you see in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Longitudinal intestinal ulcers"
      },
      {
        "id": 2,
        "text": "Stricture formation"
      },
      {
        "id": 3,
        "text": "Pinpoint ulcers"
      },
      {
        "id": 4,
        "text": "Transverse intestinal ulcers"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\"><strong>Typhoid</strong> causes&nbsp;<strong>longitudinal ulcers</strong>.</p>\n<p class=\"p1\">Typhoid fever is caused by <strong>Salmonella typhi. </strong>It&nbsp;presents with <strong>step-ladder fever</strong> and <strong>abdominal pain</strong> after an incubation period of 10&ndash;20 days. Over the next week, the patient can develop:</p>\n<ul class=\"ul1\">\n<li class=\"li1\">Distension</li>\n<li class=\"li1\">Diarrhoea</li>\n<li class=\"li1\">Splenomegaly</li>\n<li class=\"li1\">Characteristic <strong>rose spots</strong> on the abdomen caused by a vasculitis</li>\n</ul>\n<p class=\"p1\">Surgical complications of typhoid are:</p>\n<ul>\n<li class=\"p1\"><strong>Paralytic ileus</strong></li>\n<li class=\"p1\">Intestinal haemorrhage</li>\n<li class=\"p1\">Free ileal <strong>perforation</strong> (characteristically occurs during the <strong>third week</strong> of the illness)</li>\n<li class=\"p1\">Cholecystitis</li>\n<li class=\"p1\">Longitudinal ulcers (usually situated in the distal ileum)</li>\n</ul>\n<p>Diagnosis of typhoid is confirmed by <strong>culture of blood or stool</strong>.</p>\n<p class=\"p1\">Treatment is by antibiotics, usually <strong>chloramphenicol</strong>.&nbsp;</p>\n<p class=\"p1\"><strong>Perforation</strong> requires <strong>surgery</strong> to wash out and close the ulcer. Intestinal resection is usually avoided. In unstable patients, with evidence of septic shock, the bowel should be exteriorized and the perforation closed after recovery. Paratyphoid infection also resembles typhoid fever and is treated in a similar manner.&nbsp;</p>\n<p class=\"p1\">Note: Transverse ulcers&nbsp;with stricture formation are seen in tuberculosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A lady underwent a left hemicolectomy for colon cancer 5 days back.  She now complains of abdominal discomfort and bloating. She is still unable to pass gas. On examination, the abdomen is distended and no bowel sounds are heard. X-ray shows gas-filled\u00a0loops of the\u00a0intestine with multiple air fluid levels. Which of the following will be part of the management plan of the patient?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3 and 4"
      },
      {
        "id": 2,
        "text": "2 and 5"
      },
      {
        "id": 3,
        "text": "2, 3 and 4"
      },
      {
        "id": 4,
        "text": "3 and 5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given <strong>post-op</strong> scenario after 72 hours of laparotomy with <strong>no passage of flatus</strong>, <strong>absent bowel sounds</strong>, and X-ray findings are suggestive of <strong>paralytic ileus</strong>. Initiation of oral intake and emergency laparotomy is\u00a0not done\u00a0in paralytic ileus.</p>\n<p>The return of normal motility post-surgery occurs in the following sequence:</p>\n<p>Small intestine (within the first 24 hours) \u2192 Stomach (within 48 hours) \u2192\u00a0Colon\u00a0(3 to 5 days).</p>\n<p><strong>Paralytic ileus</strong> is an <strong>adynamic/functional obstruction</strong>\u00a0in which there is a\u00a0failure of transmission of peristaltic waves. This is secondary to neuromuscular failure in the myenteric (<strong>Auerbach\u2019s</strong>)\u00a0and submucous (<strong>Meissner\u2019s</strong>)\u00a0plexuses. Since there are no rigorous contractions, there is <strong>no colicky pain</strong>.</p>\n<p>The resultant stasis leads to the following clinical features:</p>\n<ul>\n<li>Abdominal distension - marked and tympanitic</li>\n<li>Effortless vomiting\u00a0</li>\n<li>Absence of bowel sounds</li>\n<li>Absolute constipation</li>\n</ul>\n<p>Paralytic ileus takes on clinical significance if any of the following are observed at <strong>72 hours</strong> after laparotomy after handling of the bowel:</p>\n<ul>\n<li>No return of bowel sounds on auscultation</li>\n<li>No passage of flatus</li>\n</ul>\n<p>Radiologically, the abdomen shows <strong>gas-filled\u00a0loops</strong> of the\u00a0intestine with <strong>multiple air fluid levels</strong> in an erect X-ray. A CT scan is more accurate for differentiating functional from mechanical obstruction</p>\n<p>Paralytic ileus is managed by\u00a0<strong>nasogastric tube</strong>\u00a0<strong>decompression</strong> and <strong>restriction of oral intake</strong> until bowel sounds and the passage of flatus return. <strong>Electrolyte balance</strong> must be maintained.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 22-year-old male presents with purulent discharge from the umbilicus. He underwent laparoscopic appendicectomy 6 months back. X-ray sinogram of the patient reveals an enterocutaneous fistula tract as shown below. Which of the following aids in the spontaneous closure of the fistula?",
    "choices": [
      {
        "id": 1,
        "text": "Epithelialization of track"
      },
      {
        "id": 2,
        "text": "Foreign body in the fistula tract"
      },
      {
        "id": 3,
        "text": "High output fistula"
      },
      {
        "id": 4,
        "text": "Fistula track length of 3 cms"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario and the X-ray sinogram showing a <strong>fistula tract</strong> connecting the skin opening and the small intestine are suggestive of an <strong>enterocutaneous fistula. </strong>In this case, it is most likely due to the umbilical port used during appendicectomy.&nbsp;</p>\n<p>Fistula track length<strong> &gt;2.5 cms</strong> is <strong>likely to heal.&nbsp;</strong>Enterocutaneous fistulas<strong>&nbsp;</strong>of length<strong> &lt;2.5 cm </strong>are <strong>unlikely</strong> to heal and close.</p>\n<p>Enterocutaneous fistulas are classified according to their location and volume of daily output. These factors determine the treatment and mortality rates. <strong>Proximal fistulas</strong> are associated with <strong>higher output</strong>, greater fluid and electrolyte loss.&nbsp;<strong>Distal fistulas</strong> tend to have <strong>lower output,</strong> making them easier to manage and more likely to close spontaneously.</p>\n<table style=\"height: 248px;\" width=\"357\">\n<tbody>\n<tr style=\"height: 30px;\">\n<td style=\"width: 170.5px; text-align: center; height: 30px;\"><strong>Type of fistula</strong></td>\n<td style=\"width: 170.5px; text-align: center; height: 30px;\"><strong>Output/day</strong></td>\n</tr>\n<tr style=\"height: 55px;\">\n<td style=\"width: 170.5px; height: 55px;\">High-output fistula</td>\n<td style=\"width: 170.5px; text-align: center; height: 55px;\">&gt;500 mL</td>\n</tr>\n<tr style=\"height: 55px;\">\n<td style=\"width: 170.5px; height: 55px;\">Intermediate fistula</td>\n<td style=\"width: 170.5px; text-align: center; height: 55px;\">200 - 500 mL</td>\n</tr>\n<tr style=\"height: 55px;\">\n<td style=\"width: 170.5px; height: 55px;\">Low-output fistula</td>\n<td style=\"width: 170.5px; text-align: center; height: 55px;\">&lt;200 mL</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6d1eac14816a4a3290279f24465d46f5.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old man, who underwent exploratory laparotomy for acute abdomen develops a fever on the 5th postoperative day. The sutured site is erythematous and on the removal of two skin sutures, there is a leakage of gastrointestinal contents through the wound.  An electrolyte panel done shows hyponatremia, hypokalemia, and metabolic acidosis. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gastric fistula"
      },
      {
        "id": 2,
        "text": "Duodenal fistula"
      },
      {
        "id": 3,
        "text": "Sigmoid fistula"
      },
      {
        "id": 4,
        "text": "Ileal fistula"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is suggestive of an <strong>enterocutaneous fistula.</strong> From the electrolyte panel showing <strong>hyponatremia, hypokalemia and metabolic acidosis,</strong> a diagnosis of <strong>duodenal fistula</strong> can be made.&nbsp;</p>\n<p>The electrolyte abnormalities with <strong>gastric fistula</strong> are<strong>&nbsp;hypochloremia, hypokalemia, </strong>and<strong> metabolic alkalosis.</strong></p>\n<p>Enterocutaneous fistulas are classified according to their location and volume of daily output.</p>\n<ul>\n<li><strong>Proximal fistulas </strong>are associated with higher output, greater fluid, and <strong>electrolyte loss</strong>, and greater loss of digestive capacity.</li>\n<li><strong>Distal fistulas</strong> tend to have lower output, making them easier to manage and more<strong> likely to</strong> <strong>close spontaneously</strong>.</li>\n</ul>\n<p>Although both gastric and duodenal fistulas are proximal fistulas, <strong>duodenal fistulas</strong> receive an <strong>additional </strong>1 to 2 litres of <strong>enzymes, electrolytes,</strong> and <strong>water</strong> from the&nbsp;<strong>pancreatic and bile ducts</strong>. Hence duodenal fistulas are at greater risk for more electrolyte imbalance than gastric fistulas.</p>\n<p>The management of enterocutaneous fistula is based on well-established principles known as <strong>SNAP </strong>which includes:</p>\n<ul>\n<li><strong>S -&nbsp;S</strong>epsis elimination and skin protection</li>\n<li><strong>N - </strong>A&nbsp;period of parenteral <strong>n</strong>utrition may well be required</li>\n<li><strong>A -</strong>&nbsp;Anatomical <strong>a</strong>ssessment</li>\n<li><strong>P -</strong> Definitive <strong>p</strong>lanned surgery</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old bride-to-be presented with nausea, vomiting, and recurrent episodes of postprandial epigastric pain. She has lost nearly 25 kgs in the last 6 months to look good in her wedding dress. Proton pump inhibitors were tried but were unsuccessful. A barium meal follow-through of the patient is given below. Which of the following is false about her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Weight gain is part of the management"
      },
      {
        "id": 2,
        "text": "Lying in prone position postprandially improves symptoms"
      },
      {
        "id": 3,
        "text": "Surgical management is by duodenojejunostomy"
      },
      {
        "id": 4,
        "text": "The second part of duodenum is commonly involved"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In SMA syndrome, initial conservative management includes:</p>\n<ul>\n<li>Frequent small feedings&nbsp;</li>\n<li>Lying in a <strong>prone&nbsp;position</strong> or on the left side postprandially&nbsp;</li>\n<li><strong>Weight gain </strong>(to increase mesenteric fat pad and thereby<strong> increase the aorto-mesenteric angle)</strong></li>\n<li>Removal of a body cast in cast syndrome&nbsp;</li>\n</ul>\n<p><strong>Laparoscopic lysis of the ligament of Treitz</strong> is beneficial in few cases. If all the above treatments fail,&nbsp;<strong>duodenojejunostomy </strong>is done.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d6dffcf953154c009ca871ed9aa5555f.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/daf50ce5d9294b7f94f52570c1808a72x986x1032.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1d74aa730b1e4db99f884a652a2a1c99x600x1200.PNG"
    ]
  },
  {
    "text": "A young male, who wishes to pursue his higher studies abroad gets a chest X-ray done as a part of the immigration clearance. X-ray shows air under bilateral domes of the diaphragm. He is currently asymptomatic with normal vital signs.  What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pneumatosis cystoides intestinalis"
      },
      {
        "id": 2,
        "text": "Diverticulosis"
      },
      {
        "id": 3,
        "text": "Perforated peptic ulcer"
      },
      {
        "id": 4,
        "text": "Band with Meckel\u2019s diverticulum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Treatment involves:</p>\n<ul>\n<li>Management of the uncomplicated primary disease.</li>\n<li>When symptoms demand treatment, the <strong>first line </strong>is <strong>intermittent high flow oxygen therapy</strong>, providing a concentration of 70% continuously for 5 days by nasal specula.</li>\n<li>The cysts may also resolve with antibiotics, particularly&nbsp;<strong>metronidazole</strong>.</li>\n<li>In <strong>resistant cases</strong>, maintenance treatment with <strong>sulfasalazine </strong>may be helpful. The prognosis<strong>&nbsp;</strong>in most patients is that of the underlying disease.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/41727382920c4d20a4d8532d13d90b6cx1280x1337.JPEG"
    ]
  },
  {
    "text": "A 55-year-old man with IHD presents with sudden, severe, generalized abdominal pain and multiple episodes of vomiting. On examination, the pulse rate is 118bpm, rhythm is irregularly irregular, BP is 90/60 mmHg. The abdomen appears soft, non-distended, and bowel sounds are absent. Which of the following could be a likely diagnosis in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Acute severe pancreatitis"
      },
      {
        "id": 2,
        "text": "Ruptured aortic aneurysm"
      },
      {
        "id": 3,
        "text": "Acute mesenteric ischemia"
      },
      {
        "id": 4,
        "text": "Peptic ulcer perforation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of a patient with sudden onset severe abdominal pain which is out-of-proportion to the physical examination findings along with atrial fibrillation is suggestive of <strong>acute mesenteric ischemia.&nbsp;</strong></p>\n<p>Mesenteric ischemia may be acute or chronic. The&nbsp;<strong>superior mesenteric artery</strong>&nbsp;(SMA) is most likely affected. An <strong>embolus</strong> is the most common cause of SMA occlusion. Possible sources for SMA emboisation include:</p>\n<ul>\n<li>Left atrium in <strong>atrial fibrillation</strong></li>\n<li><strong>Previous history of ischemic heart disease/myocardial infarction</strong></li>\n<li>Vegetations on mitral and aortic valves associated with endocarditis&nbsp;</li>\n<li>An atheromatous plaque from an aortic aneurysm.</li>\n</ul>\n<p>Other causes of mesenteric ischemia include:</p>\n<ul>\n<li><strong>Atherosclerosis</strong>&nbsp;of mesenteric vessels</li>\n<li>Vasculitides</li>\n<li><strong>Venous thrombosis</strong>&nbsp;in factor V Leiden mutation</li>\n<li>Non-occlusive mesenteric ischemia due to alterations in splanchnic blood flow.</li>\n</ul>\n<p class=\"p1\">The most important clue to an early diagnosis of acute mesenteric ischemia is the&nbsp;<strong>sudden&nbsp;</strong>onset of&nbsp;<strong>severe abdominal pain</strong>&nbsp;in a patient with atrial fibrillation or&nbsp;<strong>atherosclerosis</strong>. The pain is typically in the&nbsp;<strong>central abdomen</strong>&nbsp;and out of proportion to the physical findings.</p>\n<p class=\"p1\">Associated clinical features include nausea, vomiting, diarrhea, abdominal distension, peritonitis, and the passage of bloody stools.</p>\n<p>The&nbsp;<strong>gold standard</strong>&nbsp;for the diagnosis of acute mesenteric ischemia is&nbsp;<strong>angiography</strong>, and management is&nbsp;<strong>laparotomy</strong>.&nbsp;The goal of operative exploration is to&nbsp;<strong>resect the compromised bowel</strong>&nbsp;and restore blood supply via&nbsp;<strong>embolectomy</strong>.</p>\n<p>Other options:&nbsp;</p>\n<p>Option B: A <strong>pulsatile abdominal mass</strong> is seen in the case of an <strong>abdominal aortic aneurysm</strong>.&nbsp;Acute pain and hypotension occur with rupture of the aneurysm, which requires an emergency operation.&nbsp;</p>\n<p class=\"p1\">Options A and D: Acute severe <strong>pancreatitis</strong> and <strong>peptic ulcer perforation</strong> have no association with atrial fibrillation. They usually present with pain over the upper abdomen associated with <strong>guarding</strong> and <strong>rigidity</strong> on examination.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the minimum dose of radiation that can cause radiation enteritis of the small intestine?",
    "choices": [
      {
        "id": 1,
        "text": "3000 cGy"
      },
      {
        "id": 2,
        "text": "4500 cGy"
      },
      {
        "id": 3,
        "text": "6000 cGy"
      },
      {
        "id": 4,
        "text": "7500 cGy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>&nbsp;</strong>The minimum radiation dose in the<strong> small intestine</strong> that can cause <strong>radiation enteritis</strong> is<strong> 4500cGy.</strong></p>\n<p><strong>Radiation enteritis</strong> is a common complication of radiation treatment aimed at the abdomen and pelvis. It causes diarrhea, nausea, vomiting, and stomach cramps.</p>\n<p>The amount of radiation appears to correlate with the probability of the development of radiation enteritis. In general, serious late complications are unusual if the total radiation dosage is less than 4000 cGy.&nbsp;<strong>Morbidity risk</strong> increases with dosages exceeding <strong>5000 cGy. </strong></p>\n<p>The table below shows various parts of GIT and the radiation doses that can cause enteritis.</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Part of GIT</strong></td>\n<td><strong>Radiation dose (in cGy)</strong></td>\n</tr>\n<tr>\n<td>Esophagus</td>\n<td>6000 to 7500</td>\n</tr>\n<tr>\n<td>Stomach</td>\n<td>4500 to 5000</td>\n</tr>\n<tr>\n<td>Small intestine &amp; colon</td>\n<td>4500 to 6500</td>\n</tr>\n<tr>\n<td>Rectum</td>\n<td>5500 to 8000</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient who is a known case of Crohn's disease underwent ileal resection for a stricture. Which of the following is not a part of the management of postoperative complications in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Folic acid administration"
      },
      {
        "id": 2,
        "text": "Serial transverse enteroplasty"
      },
      {
        "id": 3,
        "text": "Oral cholestyramine"
      },
      {
        "id": 4,
        "text": "Octreotide"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Administration of <strong>folic acid</strong> is done<strong>&nbsp;</strong>in <strong>jejunal resection</strong>. <strong>Ileal resection</strong> causes vitamin&nbsp;B12 deficiency which requires administration of <strong>parenteral vitamin B12.&nbsp;</strong></p>\n<div class=\"page\" title=\"Page 304\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Extensive resection of the small intestine (<strong>&lt;150 cm</strong> of <strong>remaining</strong> <strong>small intestine</strong>) can result in metabolic and nutritional consequences. This is&nbsp; known as <strong>short bowel syndrome.&nbsp;</strong>The presentation of the patient is dependent upon the site and extent of intestinal resection.</p>\n<div class=\"page\" title=\"Page 304\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>ileum</strong> is the <strong>only site</strong> of absorption of <strong>vitamin B12 and bile salts.</strong>&nbsp;Following resection of the ileum, the loss of bile salts increases resulting in <strong>fat malabsorption </strong>and<strong>&nbsp;</strong><strong>diarrhea</strong>. Other complications of resection include:</p>\n<div class=\"page\" title=\"Page 304\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 304\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Peptic ulcers</strong> - Due to gastric hypersecretion</li>\n<li><strong>Cholelithiasis</strong> - Due to interruption of the enterohepatic cycle of bile salts</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 1199\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Initial treatment priorities include repletion of fluid and electrolytes lost in severe diarrhoea by initiating&nbsp;<strong>TPN.&nbsp;</strong>Long-term management involves:</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 304\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Administration of <strong>oral cholestyramine</strong> to bind with bile salts</li>\n<li>Dietary fat restriction</li>\n<li>Parenteral <strong>vitamin B12</strong></li>\n<li>Proton pump inhibitors to lower gastric pH</li>\n<li><strong>Octreotide</strong> to reduce the volume of GI secretions</li>\n<li>Antimotility agents such as loperamide hydrochloride to delay small-intestinal transit</li>\n</ul>\n<p>Small intestine <strong>lengthening procedures</strong>&nbsp;done to increase absorption and transit time are:</p>\n<div class=\"page\" title=\"Page 1200\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Longitudinal intestinal lengthening and tailoring procedure (LILT)</li>\n<li>Serial transverse <strong>enteroplasty</strong> procedure (STEP)</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 1200\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Intestinal transplantation</strong> is indicated only in complicated cases.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true about the Tillaux sign?",
    "choices": [
      {
        "id": 1,
        "text": "Mass is felt in the periumbilical region"
      },
      {
        "id": 2,
        "text": "Mass is brilliantly transilluminant"
      },
      {
        "id": 3,
        "text": "Mass is mobile perpendicular to mesentery attachment line"
      },
      {
        "id": 4,
        "text": "Fluctuation is positive"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Tillaux's sign</strong> is said to be positive if the <strong>mass/swelling is mobile perpendicular to the mesentery attachment line</strong>. Tillaux&rsquo;s sign<strong> </strong>is seen in a&nbsp;<strong>mesenteric cyst.</strong></p>\n<div class=\"page\" title=\"Page 1083\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Mesenteric cysts</strong> occur either in the small intestine (60%) or the colon (40%) and can be classified as the following:</p>\n<ul>\n<li>Chylolymphatic (most common type)</li>\n<li>Enterogenous</li>\n<li>Urogenital remnant</li>\n<li>Dermoid</li>\n<li>Other causes: traumatic hematoma and cyst formation, tuberculous cold abscess of mesentery and hydatid cyst of the mesentery</li>\n</ul>\n<p>They most commonly occur in adults with a mean age of 45 years. It is more common in females than males (2:1). The most common presentation is a <strong>painless abdominal swelling near the umbilicus,</strong> which is smooth and not moving with respiration with&nbsp;<strong>Tillaux's triad</strong>:&nbsp;</p>\n<ul>\n<li>Soft, smooth swelling in the umbilical region</li>\n<li>Freely mobile in a direction perpendicular to the mesentery (Tillaux's sign)</li>\n<li>Zone of resonance around the cyst&nbsp;</li>\n</ul>\n<p>Other presentations include recurrent attacks of abdominal pain due to temporary impaction of a food bolus in a segment of the bowel narrowed by the cyst and vomiting.</p>\n<p>Complications of mesenteric cyst include torsion, rupture, infection and hemorrhage into the cyst.&nbsp;</p>\n<p><strong>Ultrasonography</strong> and <strong>CT</strong> are used to demonstrate mesenteric cysts.</p>\n<p>Treatment:</p>\n<ul>\n<li>Chlyolymphatic cyst is managed by <strong>enucleation</strong>.</li>\n<li>Enterogenous cyst is managed by removal of the cyst with resection of the adjacent bowel as it arises as a diverticulum or duplication from the adjacent bowel.&nbsp;</li>\n</ul>\n<p>In cases where complete excision is not possible due to the close proximity to vital structures, <strong>partial excision</strong> or <strong>marsupialization</strong> should be performed.</p>\n<div class=\"page\" title=\"Page 1084\">&nbsp;</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c905c8c84974e78b40b7defd0179d03x1280x1930.JPEG"
    ]
  },
  {
    "text": "What is the investigation of choice in a patient suspected to have a small bowel tumor?",
    "choices": [
      {
        "id": 1,
        "text": "Enteroclysis"
      },
      {
        "id": 2,
        "text": "CT scan"
      },
      {
        "id": 3,
        "text": "Barium meal follow-through"
      },
      {
        "id": 4,
        "text": "MRI"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Enteroclysis</strong> is the <strong>investigation of choice</strong> in patients with <strong>small bowel tumours.</strong></p>\n<p>Enteroclysis is a <strong>barium study</strong>\u00a0in which the <strong>contrast </strong>agent is put <strong>directly into the duodenum</strong> through a <strong>nasogastric tube.</strong></p>\n<p>Continued infusion of 500 to 1000 mL of thin barium sulfate and methylcellulose suspension is done and then viewed continuously with the use of either fluoroscopy or radiographs taken at frequent intervals. This technique is a <strong>double-contrast</strong> procedure that allows detailed imaging of the entire small intestine.</p>\n<p>Enteroclysis has a<strong> sensitivity </strong>of over <strong>90%</strong> in the detection of small bowel tumours and is the <strong>investigation of choice</strong>, particularly for<strong> tumours </strong>located in the <strong>distal small bowel.</strong></p>\n<p>Advantages of enteroclysis:</p>\n<ul>\n<li>The contrast is administered at a controlled rate directly in the small bowel, <strong>bypassing the regulatory action</strong> of the <strong>pylorus</strong>.</li>\n<li>The <strong>entire small bowel </strong>is demonstrated in a <strong>distended</strong> state, allowing <strong>better diagnosis</strong>. As a result of the dilatation, the following can be visualised:\n<ul>\n<li>Mild strictures</li>\n<li>Small sinus tracts and fistulas</li>\n<li>Minimal extrinsic compressions</li>\n<li>Skip lesions</li>\n<li>Proximal and distal extent of diffuse diseases.</li>\n</ul>\n</li>\n<li>The examination can be completed in <strong>15\u201330 minutes</strong>, thus reducing patient waiting time.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old man presents with complaints of breathlessness, dull aching abdominal pain, and diarrhea. On examination, his face and chest appear flushed. CT scan of the abdomen shows a tumor in the terminal ileum with liver metastasis. An increased levels of 5-HIAA is seen in a 24-hour urinary sample. Which of the following is false regarding the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Surgery should be done as soon as the diagnosis is made."
      },
      {
        "id": 2,
        "text": "MRI is the best method for staging of the disease."
      },
      {
        "id": 3,
        "text": "Somatostatin analogues provide symptomatic relief."
      },
      {
        "id": 4,
        "text": "Liver transplantation can be performed."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 1270\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The given clinical scenario is suggestive of <strong>carcinoid syndrome</strong> caused by a <strong>carcinoid tumour.</strong>&nbsp;The <strong>best method </strong>for the <strong>staging</strong> of a carcinoid tumour is the&nbsp;<strong>octreotide scan.</strong></p>\n<p>They are <strong>neuroendocrine tumours </strong>of the gastrointestinal tract. They arise from the <strong>enterochromaffin cells.</strong>&nbsp;They metastasize early to the <strong>regional</strong> <strong>lymph nodes</strong> and the <strong>liver.</strong></p>\n<p>Abdominal symptoms include:</p>\n<ul>\n<li>Pain</li>\n<li>Abdominal distension</li>\n<li>Lower GI bleeding</li>\n</ul>\n<p>Metastasis in these patients can cause <strong>increased production of serotonin</strong> leading to carcinoid syndrome with features like:</p>\n<ul>\n<li>Flushing</li>\n<li>Diarrhoea</li>\n<li>Bronchospasm</li>\n<li>Cardiac symptoms because of stenosis and insufficiency of the cardiac valves</li>\n</ul>\n<p>The <strong>diagnosis</strong> is made by an assessment of 5-hydroxy indole acetic acid (<strong>5-HIAA</strong>)<strong>&nbsp;</strong>in a<strong> 24-hour urine sample</strong>. It is positive in larger tumours only if metastases are present.&nbsp;&nbsp;</p>\n<p><strong>Ultrasonography, CT </strong>scan, and<strong> MRI</strong> may show the primary tumour and metastases. The best method for<strong> staging</strong> carcinoid tumours is by <strong>octreotide scan </strong>or<strong> somatostatin receptor&nbsp;scintigraphy </strong>(SRS).</p>\n<p>Treatment:</p>\n<div class=\"page\" title=\"Page 876\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Somatostatin </strong>and its analogues are used in the <strong>symptomatic treatment</strong> of carcinoid syndrome.&nbsp;</li>\n<li><strong>Surgery</strong> should be undertaken <strong>as soon as the diagnosis is made</strong>, even in the presence of liver metastases.</li>\n<li><strong>Resection of the primary tumour</strong> and mesenteric lymph node metastases is done.&nbsp;</li>\n<li>In the presence of <strong>liver metastasis -</strong>&nbsp;liver resection, transarterial embolization (TAE), chemoembolization (TACE), chemotherapy, and <strong>liver</strong> <strong>transplantation</strong> can be done.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a false statement about abdominal lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "MALT lymphoma is associated with H.pylori infection."
      },
      {
        "id": 2,
        "text": "Primary small-intestinal lymphomas are most commonly located in the jejunum."
      },
      {
        "id": 3,
        "text": "Lymphoma is the most common malignant neoplasm of spleen."
      },
      {
        "id": 4,
        "text": "Stomach is the most common site for extranodal lymphoma."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Primary small-intestinal lymphomas are most commonly located in the ileum.</p>\n<p>Option A:</p>\n<div class=\"page\" title=\"Page 500\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Primary gastric lymphomas are derived from B-cells and classified as diffuse large B-cell lymphomas (DLBCL) and <strong>mucosa-associated lymphoid tissue (MALT)</strong>. Both DLBCL and MALT are thought to be <strong>associated with chronic <em>Helicobacter pylori</em> infection</strong>. This linkage is better established for MALT, whereas the association between <em>H. pylori</em> infection and DLBCL is more controversial.</p>\n<div class=\"page\" title=\"Page 499\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option C:</p>\n<p>Lymphoma is the most common malignant neoplasm of the spleen.</p>\n<p>Option D:</p>\n<div class=\"page\" title=\"Page 499\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Gastric lymphoma accounts for the majority of extranodal lymphomas,&nbsp;representing approximately 50&ndash;75% of primary gastrointestinal lymphomas.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false regarding lymphoma of the small intestine?",
    "choices": [
      {
        "id": 1,
        "text": "B-cell lymphomas are chemo-resistant"
      },
      {
        "id": 2,
        "text": "It is the most common tumour of the small intestine in children"
      },
      {
        "id": 3,
        "text": "Resection is indicated in all symptomatic patients"
      },
      {
        "id": 4,
        "text": "Burkitt\u2019s lymphoma affects the ileocaecal junction"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>B-cell lymphomas</strong> are <strong>chemo-sensitive</strong>. T-cell lymphomas are chemo-resistant.</p>\n<p>Approximately one-third&nbsp;of <strong>GI lymphomas</strong> occur in the small bowel. In the small intestine, most commonly they are found in the<strong> ileum.&nbsp;</strong>In <strong>children</strong> &lt;10 years, lymphomas are the <strong>most common intestinal neoplasm</strong>. In adults, they constitute up to 25% of small bowel malignant tumours.</p>\n<p>Patients with <strong>celiac disease</strong> and <strong>immunodeficiency</strong>&nbsp;are at increased risk for the development of primary small intestine lymphomas.</p>\n<p>Clinical features include:</p>\n<ul>\n<li>Pain</li>\n<li>Weight loss</li>\n<li>Nausea</li>\n<li>Vomiting</li>\n<li>Bleeding</li>\n<li>Change in bowel habits</li>\n<li>Intestinal obstruction</li>\n</ul>\n<p>Small intestine lymphomas are usually&nbsp;<strong>larger than 5 cm.&nbsp;</strong>They may extend into the mucosa. Microscopic examination shows&nbsp;diffuse infiltration of the intestinal wall.</p>\n<p>In the <strong>absence of symptoms,</strong> they are often<strong> chemo-responsive </strong>and do not require surgery. In&nbsp;<strong>symptomatic</strong> patients, <strong>resection</strong> is indicated.&nbsp;</p>\n<ul>\n<li><strong>B-cell lymphomas</strong>&nbsp;are more <strong>chemosensitive</strong> and have high remission rates, with or without surgery.&nbsp;</li>\n<li><strong>T-cell lymphomas </strong>are more <strong>resistant to therapy</strong> and will progress to symptoms of obstruction or perforation if not resected.</li>\n</ul>\n<p>Small intestine lymphomas cause complications like <strong>haemorrhage</strong> and <strong>perforation</strong>.&nbsp;The best prognostic indicator is a response to systemic therapy. The five-year survival rate is 50% to 60%</p>\n<p>Note:</p>\n<ul>\n<li>The<strong> stomach</strong>&nbsp;(50&ndash;75%) is the&nbsp;<strong>most common site </strong>of lymphomas in the <strong>gastrointestinal system</strong>.</li>\n<li>Burkitt&rsquo;s lymphoma can aggressively affect the ileocaecal region.</li>\n<li>Lymphoma is the most common malignant neoplasm of the spleen.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '21 Small Intestine';
        let hierarchy = ["Marrow", "qBank", "Surgery"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>