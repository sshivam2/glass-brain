<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 16 (Cadaveric Images) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The suprascapular nerve\u00a0is the content of which of the following triangles marked in the neck region?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "3"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>suprascapular nerve&nbsp;</strong>(C5, C6) arises from the <strong>upper trunk of the brachial plexus</strong>. The nerve is a component of the&nbsp;<strong>subclavian triangle.</strong></p>\n<p>In the given image:</p>\n<ul>\n<li>A &ndash; Carotid triangle</li>\n<li>B &ndash; Occipital triangle<strong>&nbsp;</strong></li>\n<li>C &ndash; Subclavian triangle</li>\n<li>D &ndash; Muscular triangle</li>\n</ul>\n<p>Contents of the subclavian triangle are:</p>\n<ul>\n<li><strong>3<sup>rd</sup>&nbsp;part&nbsp;</strong>of Subclavian Artery and vein</li>\n<li>Suprascapular artery and vein, transverse cervical artery</li>\n<li>Supraclavicular lymph node</li>\n<li>Trunks of Brachial plexus</li>\n<li>Nerve to Serratus anterior</li>\n<li>Branches from upper trunk &ndash; N to Subclavius, Suprascapular nerve</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/18b88d484eba44ecad662be687e544ba.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d722883ae0a14eb08ea5a8d80d6c2327x1280x1559.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3a34ec6a82094f89ac3b063cc0dc5d98x960x720.JPEG"
    ]
  },
  {
    "text": "A patient presents with complaints of severe pain in her buttocks. The muscle marked in the image below is suspected to be inflamed. Which of the following nerves is likely to be involved due to its inflammation?",
    "choices": [
      {
        "id": 1,
        "text": "Obturator nerve"
      },
      {
        "id": 2,
        "text": "Sciatic nerve"
      },
      {
        "id": 3,
        "text": "Superior gluteal nerve"
      },
      {
        "id": 4,
        "text": "Inferior gluteal nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The muscle marked in the image is the <strong>piriformis</strong> and the clinical features are suggestive of <strong>piriformis syndrome. </strong>This occurs due to the entrapment of the <strong>sciatic nerve.</strong></p>\n<p><strong>Piriformis syndrome\u00a0</strong>is a clinical condition characterized by the\u00a0<strong>compression </strong>of the <strong>sciatic nerve</strong>\u00a0by the piriformis muscle. This can occur due to inflammation of the piriformis muscle. The patient will present with\u00a0<strong>pain along the distribution</strong>\u00a0of the sciatic nerve which is also known as\u00a0<strong>sciatica</strong>. It is triggered by sitting for a long time or running, climbing stairs, or applying firm pressure directly over the <strong>piriformis muscle. </strong></p>\n<p>Early signs include <strong>pain, tingling,</strong> or <strong>numbness</strong> in the <strong>buttocks.</strong> Later it may lead to severe pain extending down the length of the sciatic nerve.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8344257823f8414db1bae204dc2a154e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ac21c8967e7c4dab8e85784c415b71e0x258x400.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6dde33bcb25d4d0c9d4e37bb7b555270x960x720.JPEG"
    ]
  },
  {
    "text": "The structure marked in the cadaveric image given below, arises at the ______",
    "choices": [
      {
        "id": 1,
        "text": "Upper level of L1 vertebrae"
      },
      {
        "id": 2,
        "text": "Lower level of L1 vertebrae"
      },
      {
        "id": 3,
        "text": "Upper level of L3 vertebrae"
      },
      {
        "id": 4,
        "text": "Lower level of L2 vertebrae"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The marked structure can be identified as the<strong>\u00a0superior mesenteric artery,</strong>\u00a0as it lies\u00a0<strong>anterior and superior to the left renal vein.\u00a0</strong>The superior mesenteric artery originated from the\u00a0<strong>abdominal aorta at the level of the lower border of the L1 vertebra,</strong>\u00a0about 1 cm below the celiac trunk .</p>\n<p>Their branches are:</p>\n<ul>\n<li>Jejunal branches</li>\n<li>Ileal branches</li>\n<li>Middle colic artery</li>\n<li>Right colic artery</li>\n<li>Ileocolic artery</li>\n<li>Inferior pancreaticoduodenal artery</li>\n</ul>\n<p><strong>Clinical note - Nutcracker syndrome:</strong></p>\n<ul>\n<li>The compression of the left renal vein between the abdominal aorta and the superior mesenteric artery, appears in the sagittal plane, as if a nutcracker is crushing a nut (left renal vein).</li>\n<li>This condition is called nutcracker (left renal vein entrapment) syndrome.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/db3a91ca9ce9436ab17a42fc3085d259.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4de636412d0645e5af6438d0f9807196x800x600.JPEG"
    ]
  },
  {
    "text": "Given below is a dissected compartment of the leg. The nerve supplying these muscles does not give articular branches to?",
    "choices": [
      {
        "id": 1,
        "text": "Tarsal joints"
      },
      {
        "id": 2,
        "text": "2nd metatarsophalangeal joint"
      },
      {
        "id": 3,
        "text": "1st metatarsophalangeal joint"
      },
      {
        "id": 4,
        "text": "Tarsometatarsal joints"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given muscle is supplied by the&nbsp;<strong>deep peroneal nerve. </strong>It does not give articular branches to the <strong>2nd metatarsophalangeal joint</strong>.&nbsp;</p>\n<p>The above image shows the anterior compartment of the leg. The deep peroneal nerve is the nerve of the <strong>anterior compartment</strong> of the leg and the <strong>dorsum of the foot</strong>.&nbsp;It is one of the two <strong>terminal branch</strong>es of the <strong>common peroneal nerve</strong> arising <strong>between</strong> the <strong>neck of the fibula</strong> and <strong>peroneus longus</strong>. It accompanies the <strong>anterior tibial artery</strong>.&nbsp;</p>\n<p>The deep peroneal nerve gives <strong>articular branches</strong> to-</p>\n<ul>\n<li>Ankle joint</li>\n<li>Tarsal joints</li>\n<li>Tarsometatarsal joints</li>\n<li>1st metatarsophalangeal joint</li>\n</ul>\n<p><strong>Muscular branches</strong>-</p>\n<ul>\n<li>Tibialis anterior&nbsp;</li>\n<li>Extensor hallucis longus&nbsp;</li>\n<li>Extensor digitorium&nbsp; longus</li>\n<li>Peroneus tertius&nbsp;</li>\n<li>Extensor digitorium brevis&nbsp;</li>\n</ul>\n<p>The 2nd metatarsophalangeal joint is supplied by the medial plantar nerve.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/298164828a8c490483a4774bfefd24de.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4f392042d91240908b0055fce9452ec6x449x337.JPEG"
    ]
  },
  {
    "text": "A cadaveric specimen of the circle of Willis is given below. Which of the following marked structures represents the superior cerebellar artery?",
    "choices": [
      {
        "id": 1,
        "text": "D"
      },
      {
        "id": 2,
        "text": "C"
      },
      {
        "id": 3,
        "text": "B"
      },
      {
        "id": 4,
        "text": "A"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given cadaveric image is of the vascular structures(Circle of Willis) at the base of the brain. The structure marked as 'A' can be identified as the&nbsp;<strong>superior cerebellar artery </strong>as&nbsp;it is arising from the&nbsp;distal portion of the basilar artery,&nbsp;immediately before the formation of the posterior cerebral arteries(marked as B).</p>\n<p>The superior cerebellar artery supplies the pons, pineal body, superior medullary velum and tela choroidea of the third ventricle.</p>\n<p><strong>Circle of Willis or circulus arteriosus:</strong>&nbsp;Large arterial anastomosis that unites the internal carotid and vertebrobasilar systems. It lies in the subarachnoid space within the basal cisterns that surround the optic chiasma and infundibulum.</p>\n<p>The anterior cerebral arteries are derived from the internal carotid arteries and are linked by a small anterior communicating artery.</p>\n<p>Posteriorly, the two posterior cerebral arteries are formed by the division of the basilar artery. They are joined to the ipsilateral internal carotid artery by a posterior communicating artery.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/11e7aae1920e4c879cd29dec50f62482.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/db3679b2f0b64183a2a75da7a17eaedax1279x965.JPEG"
    ]
  },
  {
    "text": "Identify the cranial nerve that passes through the marked foramen marked in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Oculomotor nerve"
      },
      {
        "id": 2,
        "text": "Olfactory nerve"
      },
      {
        "id": 3,
        "text": "Optic nerve"
      },
      {
        "id": 4,
        "text": "Facial nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The marked structure is the&nbsp;<strong>superior orbital fissure</strong> and the&nbsp;<strong>oculomotor nerve</strong> passes through this fissure.</p>\n<p>Superior orbital fissure is divided into three compartments by the <strong>common tendinous ring</strong>. The oculomotor nerve passes through its <strong>i</strong><strong>ntermediate compartment</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f8dc54ead8f7489b8c95ced08e311754.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old male presented with rigidity, frequent falls, slow movements, tremors, and a short stepping gait when he entered the doctor's room. Which of the following areas is most likely to be affected?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of <strong>Parkinson's disease, </strong>which is associated with the\u00a0degeneration of<strong> substantia nigra (marked as \"C\").</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a7980296971e4b58a1fa808919e1a3b2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/70c6a96c5206407e91454d12c8367069x1280x879.JPEG"
    ]
  },
  {
    "text": "The middle meningeal artery enters into the middle cranial fossa through which of the following foramina?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "3"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The middle meningeal artery enters the middle cranial fossa through the <strong>foramen spinosum</strong>, labelled as <strong>3</strong> in the image.</p>\n<p>Foramina marked in the image are</p>\n<p><strong>1 - Foramen rotundum</strong></p>\n<p><strong>2 - Foramen ovale</strong></p>\n<p><strong>3 - Foramen spinosum</strong></p>\n<p><strong>4 - Jugular foramen</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5d9c54cdcee14e38b48c56e46c93b3c3.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/38db9393d25241fea9d0c86e8a2c78ebx1279x1050.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d67466b36b80458bb14d26f40cfb2f0fx1280x945.JPEG"
    ]
  },
  {
    "text": "Identify the marked artery.",
    "choices": [
      {
        "id": 1,
        "text": "Superior cerebellar artery"
      },
      {
        "id": 2,
        "text": "Posterior inferior cerebellar artery"
      },
      {
        "id": 3,
        "text": "Anterior inferior cerebellar artery"
      },
      {
        "id": 4,
        "text": "Posterior spinal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The artery marked is the<strong> posterior inferior cerebellar artery.&nbsp;</strong>This artery branches out from the vertebral artery and it is the largest branch of the vertebral artery.</p>\n<p>The following image shows the <strong>circle of Willis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/519a28e118e349c4ab17050f7ec09e1c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the structure marked in the diagram below:",
    "choices": [
      {
        "id": 1,
        "text": "Poupart\u2019s ligament"
      },
      {
        "id": 2,
        "text": "Lacunar ligament"
      },
      {
        "id": 3,
        "text": "Cooper\u2019s ligament"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure marked is the <strong>Lacunar ligament.</strong></p>\n<p><strong>Lacunar (Gimbernats) ligament </strong>- It&nbsp;is a thick triangular band of tissue formed from fibres of the medial end of the inguinal ligament and fascia lata.&nbsp; It forms the medial wall of the<strong> femoral canal.</strong> The apex of the triangle is attached to the pubic tubercle.</p>\n<p><strong>Inguinal (Poupart&rsquo;s) ligament</strong>&nbsp;- The thick external oblique aponeurosis stretched between ASIS (anterior superior iliac spine) and pubic tubercle.&nbsp;</p>\n<p><strong>Pectineal (Astley Coopers) ligament</strong>&nbsp;- A strong fibrous band that extends laterally along the pectineal line from the pectineal attachment of Lacunar ligament.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f0da32bfe81b4ddcbd149e8f9102d799.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c424e256483b491a9924a541d9e3a2fax1280x1640.JPEG"
    ]
  },
  {
    "text": "What is the nerve supply of the structure marked in the image?",
    "choices": [
      {
        "id": 1,
        "text": "Radial nerve"
      },
      {
        "id": 2,
        "text": "Median nerve"
      },
      {
        "id": 3,
        "text": "Ulnar nerve"
      },
      {
        "id": 4,
        "text": "Musculocutaneous nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>median nerve</strong> supplies the <strong>1st lumbrical&nbsp;</strong>which is marked.&nbsp;</p>\n<p>There are<strong> four</strong> lumbrical muscles. They originate from the&nbsp;tendons of the&nbsp;<strong>flexor digitorum profundus.&nbsp;</strong>It passes to the radial side of the corresponding fingers and is <strong>inserted</strong> into the <strong>dorsal digital expansion</strong> of the extensor digitorum.</p>\n<p>The action of lumbricals is <strong>flexion</strong> at the <strong>metacarpophalangeal joint</strong> and <strong>extension</strong> of interphalangeal joints.&nbsp;</p>\n<p>Lumbricals can be tested only along with interosseous muscle.&nbsp;The examiner will hold the metacarpophalangeal joint of the index finger in hyperextension. Then the patient is asked to extend the proximal interphalangeal joint against resistance. The test is repeated on other fingers as well.</p>\n<p>The <strong>median&nbsp;nerve </strong>innervates the first and second lumbricals. The&nbsp;<strong>deep terminal branch</strong> of the <strong>ulnar nerve</strong> innervates the third and the fourth.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dd2aa1b604774606b159c0443a1aa6d9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bdaee3063f1f4c859a4398c8fb0dfebex960x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1e901cf7bad9464986c1a00a985dc4ffx1280x1661.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e1e8863c826d451382e7938ad01a9cc2x602x422.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8aba95265cc5459f894b96f0ad1df948x720x872.PNG"
    ]
  },
  {
    "text": "Which of the following post-mortem changes is a result of hydrolysis of lipids under warm and humid weather?",
    "choices": [
      {
        "id": 1,
        "text": "Image 1"
      },
      {
        "id": 2,
        "text": "Image 2"
      },
      {
        "id": 3,
        "text": "Image 3"
      },
      {
        "id": 4,
        "text": "Image 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Hydrolysis of lipids</strong> under warm and humid weather would result in <strong>adipocere formation</strong>, which is seen in <strong>image 4.&nbsp;</strong></p>\n<p>Postmortem changes are classified on the basis of time:</p>\n<ul>\n<li>Immediate signs of death (at the time of somatic or clinical death):\n<ol>\n<li>Insensibility and loss of voluntary power</li>\n<li>Cessation of respiration</li>\n<li>Cessation of circulation</li>\n</ol>\n</li>\n<li>Early signs of death. It is seen in cellular death:\n<ol>\n<li>Pallor and loss of elasticity of the skin</li>\n<li>Eye changes</li>\n<li>Primary flaccidity of muscles</li>\n<li><strong>Algor mortis</strong>/Postmortem cooling</li>\n<li>Postmortem lividity/<strong>Suggillation</strong></li>\n<li><strong>Rigor mortis</strong></li>\n</ol>\n</li>\n<li>Late signs of death:\n<ol>\n<li>Putrefaction</li>\n<li><strong>Adipocere</strong></li>\n<li>Mummification</li>\n</ol>\n</li>\n</ul>\n<p><strong>Adipocere&nbsp;formation </strong>(Image 4) is a&nbsp;<strong>late sign</strong>&nbsp;of death.&nbsp;The transformation is brought about by the <strong>gradual hydrolysis </strong>and <strong>hydrogenation</strong> of pre-existing fats, including olein, into higher fatty acids. These higher fatty acids then join with calcium and ammonium ions to produce insoluble soaps, which since they are acidic, prevent putrefactive bacteria. The usual time for adipocere formation is between 3 to 6 months. Still, in countries like India, it is accelerated by the&nbsp;<strong>warm and humid</strong>&nbsp;weather, resulting in the beginning of adipocere formation as early as <strong>4&nbsp;to 5 days</strong>&nbsp;after death.&nbsp;</p>\n<p>Image 1. <strong>Marbling</strong>:&nbsp;It is&nbsp;seen when blood in the vessels is&nbsp;<strong>hemolyzed to sulfate-hemoglobin</strong>, which&nbsp;<strong>stains the vessel walls</strong>&nbsp;and the adjacent tissues, giving rise to a&nbsp;<strong>marbled appearance</strong>. The marbling of the skin&nbsp;<strong>begins&nbsp;</strong>at&nbsp;about&nbsp;<strong>24 hours</strong>&nbsp;and becomes prominent&nbsp;&nbsp;<strong>36&ndash;48 hours</strong>&nbsp;after death.&nbsp;It is a visible postmortem change that is characterized by linear branching patterns on skin that correspond to the course of superficial veins&nbsp;of the abdomen, shoulders, chest, and inguinal region.</p>\n<p>Image 2. Cadaveric lividity:&nbsp;<strong>Postmortem hypostasis/Postmortem staining/Postmortem lividity/Livor mortis/Suggilation&nbsp;</strong>refers to bluish-purple or<strong>&nbsp;reddish-purple discoloration</strong>&nbsp;of the skin due to the collection of blood in most superficial layers of the dermis in the dependent parts&nbsp;of the body.&nbsp;Fixation of hypostasis&nbsp;occurs&nbsp;6 &ndash; 12 hours after death and persists until putrefaction sets in.</p>\n<p>Image 3.&nbsp;Mummification:&nbsp;It occurs in the absence of moisture in the air and continuous action of<strong> dry or warmed air.&nbsp;</strong>It is a process of&nbsp;<strong>dehydration</strong>&nbsp;or drying and&nbsp;<strong>shriveling</strong>&nbsp;of the&nbsp;<strong>cadaver</strong>&nbsp;that occurs from the&nbsp;<strong>evaporation</strong>&nbsp;of&nbsp;<strong>water.</strong>&nbsp;The natural appearances of the body and general facial features are preserved.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bac9fd92b4b145aaaf97b5e794afb6b2.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A lesion of the structure marked in the below image causes?",
    "choices": [
      {
        "id": 1,
        "text": "Contralateral hemiplegia"
      },
      {
        "id": 2,
        "text": "Ataxia"
      },
      {
        "id": 3,
        "text": "Tinnitus"
      },
      {
        "id": 4,
        "text": "Ipsilateral facial palsy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked in the image is the&nbsp;<strong>pyramid&nbsp;</strong>containing<strong>&nbsp;</strong>the <strong>pyramidal tracts</strong>. A lesion here leads to <strong>contralateral hemiplegia.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/660b7effbf80426c954c922c07dc2dbb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/df61903d0aca4288aa664120c7c14e19x1280x1354.JPEG"
    ]
  },
  {
    "text": "Identify the muscle marked as A in the image given below:",
    "choices": [
      {
        "id": 1,
        "text": "Anconeus"
      },
      {
        "id": 2,
        "text": "Extensor carpi ulnaris"
      },
      {
        "id": 3,
        "text": "Extensor carpi radialis brevis"
      },
      {
        "id": 4,
        "text": "Extensor digitorum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The muscle labeled as <strong>A </strong>is<strong> anconeus</strong> and its functions are</p>\n<ul>\n<li>Abduction of the wrist in pronated position</li>\n<li>Accessory extension of elbow joint</li>\n</ul>\n<p>Other options:&nbsp;</p>\n<ul>\n<li>The muscle marked as <strong>B</strong> is <strong>extensor</strong> <strong>carpi</strong> <strong>radialis</strong>&nbsp;<strong>brevis</strong>, and it extends and abducts the wrist joint</li>\n<li>The muscle marked as<strong>&nbsp;C is extensor digitorum,</strong> and it mainly extends the index, middle, ring, and little fingers and also extends the wrist.</li>\n<li>The muscle marked as <strong>D</strong><strong>&nbsp;is extensor carpi ulnaris,</strong> and it extends and adducts the wrist joint.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0efdd9c94fa1419aba065ee7593d16fa.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ccf3983f3a9412db94b365bad66a425x1280x1850.JPEG"
    ]
  },
  {
    "text": "The diaphragmatic surface of the heart is shown below. Identify the structures marked X and Y.",
    "choices": [
      {
        "id": 1,
        "text": "Posterior interventricular artery and middle cardiac vein"
      },
      {
        "id": 2,
        "text": "Posterior interventricular artery and small cardiac vein"
      },
      {
        "id": 3,
        "text": "Right coronary artery and middle cardiac vein"
      },
      {
        "id": 4,
        "text": "Left coronary artery and small cardiac vein"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked X is the <strong>posterior interventricular artery</strong> and the structure marked Y is the <strong>middle cardiac vein </strong>which can be identified as it drains into the<strong> coronary sinus</strong>. Both these structures lie in the <strong>posterior interventricular sulcus</strong>.</p>\n<p><strong>Tributaries of coronary sinus</strong>&nbsp;include the following:</p>\n<ul>\n<li>Great cardiac vein</li>\n<li>Middle cardiac vein</li>\n<li>Small cardiac vein</li>\n<li>Posterior vein of the left ventricle</li>\n<li>Oblique vein(of&nbsp;<strong>Marshall</strong>) of the left atrium&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/398e5a2beaf642a08ca93a5981b829ef.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a0ac0b67cc12415d8a6d323efd2e8dadx1280x2059.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4a3503dc08ab4538a6eacf108e8d71f2x1280x1750.JPEG"
    ]
  },
  {
    "text": "What is the function of the muscle marked as A in the image below, at the metacarpophalangeal joint?",
    "choices": [
      {
        "id": 1,
        "text": "Flexion"
      },
      {
        "id": 2,
        "text": "Extension"
      },
      {
        "id": 3,
        "text": "Adduction"
      },
      {
        "id": 4,
        "text": "Abduction"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The muscle marked 'A' are <strong>lumbricals</strong> and they cause&nbsp;<strong>flexion</strong>&nbsp;at the <strong>metacarpophalangeal joints</strong>.</p>\n<p class=\"p1\">Lumbricals are intrinsic muscles of the hand that <strong>flex</strong> the <strong>metacarpophalangeal joints (MCP)</strong> and <strong>extend</strong> the <strong>interphalangeal joints (PIP</strong>&nbsp;&amp; <strong>DIP</strong>).</p>\n<p class=\"p1\">They originate from Flexor digitorum profundus.</p>\n<ul>\n<li class=\"p1\">The lateral two are unipennate, supplied by the Median nerve.</li>\n<li class=\"p1\">The medial two are bipinnate, supplied by the Ulnar nerve.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/592d89e80d0946f2a2e341196acda953.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74dd5448b8024a11930a76e5ea0c8803x717x599.PNG"
    ]
  },
  {
    "text": "Identify the structure marked in the image given below:",
    "choices": [
      {
        "id": 1,
        "text": "Ulnar Nerve"
      },
      {
        "id": 2,
        "text": "Ulnar Artery"
      },
      {
        "id": 3,
        "text": "Superficial Radial Artery"
      },
      {
        "id": 4,
        "text": "Median Nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure marked in the image is the <strong>ulnar artery,</strong>&nbsp;seen contributing to the superficial palmar arch.</p>\n<p>It <strong>passes deep to the Guyon's canal</strong> in the wrist and contributes to the superficial and deep <strong>palmar arch.</strong>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/657d843ccfef4cca818eed6d02b03e8f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b76f71b3fafa4830bb4556f828bb10b3x1280x1108.JPEG"
    ]
  },
  {
    "text": "The following image shows first cervical vertebra, superior view. Part of the bone marked as Number 7 gives attachment to:",
    "choices": [
      {
        "id": 1,
        "text": "Ligamentum nuchae"
      },
      {
        "id": 2,
        "text": "Ligamentum flavum"
      },
      {
        "id": 3,
        "text": "Longus colli"
      },
      {
        "id": 4,
        "text": "Rectus capitis anterior"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Part of bone (Atlas) marked as number 7 is <strong>posterior arch,</strong> and&nbsp;its inferior border gives attachment to <strong>ligamentum flavum</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/314362713d3841f6939a0d2be8361167.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ebdc1b3bbcb421abb1803c62aacc1e2x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2e491421877f46f69e956d2a8831463bx638x479.JPEG"
    ]
  },
  {
    "text": "A boy with a history of a fall from a tree presents with a lurching gait and dragging of his feet. Which of the following structures are involved?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure responsible for&nbsp;<strong>lurching gait</strong> in the child is <strong>gluteus medius</strong>&nbsp;represented by <strong>2</strong>.</p>\n<p>The gluteus medius originates from the outer surface of the ileum between the anterior and posterior gluteal lines. Insertion of the muscle is at the lateral surface of the greater trochanter.&nbsp;It is supplied by the <strong>superior gluteal nerve</strong>.</p>\n<p>Gluteus medius and minimus are powerful <strong>abductors</strong> of the hip joint. Mechanism of actions of gluteus medius and minimus:</p>\n<ul>\n<li>When the leg on one side is lifted off the ground, the <strong>gluteus medius and minimus muscles</strong>, on the opposite supported side, exert traction on the hip bone by acting from the femur. This action results in a&nbsp;<strong>slight raising of the pelvis</strong> on the <strong>unsupported side</strong>, which helps maintain the trunk in the upright position.</li>\n<li>The actions of these muscles are affected when there is an injury to the superior gluteal nerve, neck of the femur, or loss of normal angulation of the shaft of the femur. This occurs in conditions like paralysis of the glutei, developmental dysplasia of the hip, etc.</li>\n<li>When the <strong>gluteus medius and minimus are paralyzed</strong>, the <strong>pelvis sinks down on the unsupported (normal) side</strong>, when the patient tries to stand on the affected limb. This leads to a&nbsp;<strong>positive Trendelenburg's sign </strong>with a<strong>&nbsp;</strong>characteristic lurching gait - the patient lurches towards the affected side with contralateral pelvis drop.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/32f3f8913aca4209bc77a5e2edb34eac.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08c8c95e71014a448774c2a7ac0f0a6dx1280x4280.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ebbde3edd95e43ce84048037a1d66bd8x1280x1141.JPEG"
    ]
  },
  {
    "text": "A patient presented with paradoxical respiration. Which of the following nerves (as marked in the image below) is most likely to be affected?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Paradoxical respiration</strong> occurs due to the damage of the <strong>phrenic nerve,</strong> which is marked as <strong>D</strong>, in the given image.</p>\n<p>The structures marked in the image are:</p>\n<p>A. Right vagus nerve</p>\n<p>B. Left vagus nerve</p>\n<p>C. Recurrent laryngeal nerve</p>\n<p>D. Right phrenic nerve</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d54a83e5315b4dfcae128c8d50b38c5d.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/804b0d5f1e8d46a784c87c39bfa660d2x1280x959.JPEG"
    ]
  },
  {
    "text": "Marked structure is derived from the______",
    "choices": [
      {
        "id": 1,
        "text": "Endocardial cushions"
      },
      {
        "id": 2,
        "text": "Septum primum"
      },
      {
        "id": 3,
        "text": "Left venous valve"
      },
      {
        "id": 4,
        "text": "Bulbous venosus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked is the <strong>membranous part of the interventricular septum </strong>that&nbsp;is derived from<strong>&nbsp;endocardial cushions.</strong></p>\n<p>Endocardial cushions&nbsp;are soft&nbsp;tissue masses that protrude in the atrioventricular and conotruncal regions.&nbsp;</p>\n<ul>\n<li><strong>Atrioventricular cushions</strong> are derived from&nbsp;<strong>overlying endocardial cells. </strong></li>\n<li>The <strong>conotruncal cushions</strong> are derived from the <strong>neural crest cells</strong>.&nbsp;</li>\n</ul>\n<p class=\"p1\"><strong>Endocardial cushions</strong> contribute to the formation of:</p>\n<ul>\n<li class=\"p1\">Atrial septa</li>\n<li class=\"p1\">Ventricular septa (membranous portion)</li>\n<li class=\"p1\">Atrioventricular canals</li>\n<li class=\"p1\">Atrioventricular valves</li>\n<li class=\"p1\">Aortic and pulmonary channels</li>\n</ul>\n<p class=\"p1\">Defects in endocardial cushion formation can result in cardiac malformations, including ASDs, VSDs and defects involving the great vessels (transposition of the great vessels, common truncus arteriosus, and tetralogy of Fallot).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/30d604119ec548588fc0b560ff9922c8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following muscles is not supplied by the structure marked in the image?",
    "choices": [
      {
        "id": 1,
        "text": "Thyrohyoid"
      },
      {
        "id": 2,
        "text": "Sternothyroid"
      },
      {
        "id": 3,
        "text": "Sternohyoid"
      },
      {
        "id": 4,
        "text": "Inferior belly of omohyoid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The marked structure is <strong>ansa cervicalis</strong> and <strong>t</strong><strong>hyrohyoid</strong>&nbsp;is <strong>not supplied by it</strong>.&nbsp;</p>\n<p><strong>Ansa cervicalis</strong>:&nbsp;</p>\n<ul>\n<li>It is a loop of nerves which are a part of cervical plexus.</li>\n<li>It is made up of two roots.\n<ul>\n<li>The upper root has contributions from the <strong>first cervical</strong> spinal nerve</li>\n<li>The lower root has contributions from the <strong>second </strong>and <strong>third cervical spinal nerves</strong>.</li>\n</ul>\n</li>\n<li>It innervates <strong>sternohyoid, sternothyroid </strong>and<strong> omohyoid muscles</strong>.</li>\n</ul>\n<p><strong>Thyrohyoid</strong> and <strong>geniohyoid</strong> are not supplied by ansa cervicalis. They are supplied by the <strong>first cervical spinal nerve</strong>, via the <strong>hypoglossal nerve.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/078614f3f01d4333998ba9eb8c1410b1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2b71d4796d14e5589a8fd0b78c9c8e1x1280x1248.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3abb01a217ca4ca89f8662eb3754335fx1280x1515.JPEG"
    ]
  },
  {
    "text": "Identify the structure marked by the red arrow in the given image?",
    "choices": [
      {
        "id": 1,
        "text": "Musculocutaneous nerve."
      },
      {
        "id": 2,
        "text": "Median Nerve"
      },
      {
        "id": 3,
        "text": "Ulnar nerve"
      },
      {
        "id": 4,
        "text": "Medial cord"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The marked structure is the <strong>musculocutaneous nerve</strong>.&nbsp;</p>\n<p>The structure can be identified as<strong>&nbsp;the musculocutaneous nerve</strong> as it pierces the<strong> coracobrachialis muscle</strong> in its course and also supplies the<strong> biceps brachii.&nbsp;</strong>The root value of the musculocutaneous nerve&nbsp;is <strong>C5, C6, C7.</strong></p>\n<p>The <strong>musculocutaneous nerve </strong>supplies all the <strong>muscles of the anterior compartment </strong>of the arm, which include <strong>coracobrachialis, brachialis,</strong> and <strong>biceps&nbsp;brachii muscles.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ed4e0d36e4e7486188ff21d91240154b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3cd2cb8873c34c61a13d334f9182bb34x960x720.JPEG"
    ]
  },
  {
    "text": "All of the following supply the marked structure except :",
    "choices": [
      {
        "id": 1,
        "text": "Right coronary artery"
      },
      {
        "id": 2,
        "text": "Anterior interventricular artery"
      },
      {
        "id": 3,
        "text": "Marginal artery"
      },
      {
        "id": 4,
        "text": "Diagonal artery"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The structure marked is the <strong>right ventricle.</strong> It is<strong> not supplied</strong> by the <strong>diagonal artery.</strong></p>\n<p>The diagonal artery is a <strong>branch of the anterior interventricular artery </strong>supplying the <strong>left ventricle. </strong>This is present in about 30-50% of the population.</p>\n<p>The right ventricle is mostly supplied by the right coronary artery and its branches such as the marginal artery. (Options A and C)</p>\n<p>The anterior interventricular artery gives off 1-2 anterior right ventricular branches. (Option B)</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/29473dab9ef549128b37ae5756b597ac.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/df33c2540efc45d8ba50a7ed265e1882x1280x1773.JPEG"
    ]
  },
  {
    "text": "A specimen of the posterior surface of the larynx is kept in an anatomy practical exam and a structure is marked with red. What would be the action of the structure?",
    "choices": [
      {
        "id": 1,
        "text": "Adducts the vocal cords"
      },
      {
        "id": 2,
        "text": "Abducts the vocal cords"
      },
      {
        "id": 3,
        "text": "Tenses the vocal cords"
      },
      {
        "id": 4,
        "text": "Relaxes the vocal cords"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows the posterior view of the larynx and the marked muscle is&nbsp;the <strong>posterior cricoarytenoid</strong>.&nbsp;Its action is to <strong>abduct the vocal cords</strong> and <strong>open</strong> the glottis. The <strong>posterior cricoarytenoid muscle </strong>is identified by<strong>&nbsp;</strong>its origin from the <strong>posterior surface</strong> of the cricoid<strong>.</strong>&nbsp;</p>\n<p>The posterior cricoarytenoid muscle <strong>arises </strong>from the <strong>posterior surface of the cricoid lamina</strong> and is attached to the upper and posterior surfaces of the muscular processes of the ipsilateral arytenoids. It is innervated by a branch of the<strong> recurrent laryngeal nerve</strong>. They are <strong>active </strong>in the production of <strong>unvoiced sounds.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/85574121651c472989c1bf0ea1fc3d29.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/648d8cf164504713b8fb9a45b04b96b1x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/887d5473925944c8b2515b313b2a572cx363x500.PNG"
    ]
  },
  {
    "text": "What is the action of the muscle at the hip, which is attached to the marked area in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Abduction and external rotation"
      },
      {
        "id": 2,
        "text": "Extension and lateral rotation"
      },
      {
        "id": 3,
        "text": "Extension, adduction, and lateral rotation"
      },
      {
        "id": 4,
        "text": "Flexion and abduction"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows the <strong>posterior surface</strong> of the <strong>femur,</strong> and the structure marked is <strong>gluteal tuberosity,</strong> to which the <strong>gluteus maximus</strong> muscle is attached. The action of gluteus Maximus is the <strong>extension</strong> and<strong> lateral rotation\u00a0</strong>of the hip joint.</p>\n<p>The<strong> gluteus maximus</strong> muscle, which is the <strong>chief extensor</strong> of the thigh at the hip joint, has<strong> superficial and deep fibres.</strong> The <strong>deep fibres</strong> insert into the <strong>gluteal tuberosity,</strong> and<strong> </strong>the<strong> superficial</strong> fibres insert into the<strong> iliotibial tract.\u00a0</strong></p>\n<p>The Gluteus maximus muscle is supplied by the <strong>inferior gluteal nerve (L5, S1, S2).</strong> It is an antigravity muscle and it plays a key role in <strong>standing up </strong>from a <strong>sitting position</strong> and maintaining an erect posture. Its other actions include<strong> lateral rotation</strong> and <strong>abduction</strong> of the thigh and knee stabilization in conjunction with the tensor fasciae latae muscle.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/34ee80b981bd40d1bcd23e3468ac332e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a6da93129d44c2da6fb5e45db7650bdx1280x2117.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7e62a3100058410c81175cda31837e9fx1280x2117.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/848431333a554cea9a21db474161bc8ax1280x2213.JPEG"
    ]
  },
  {
    "text": "All of the following form the marked structure except:",
    "choices": [
      {
        "id": 1,
        "text": "2nd Dorsal interossei"
      },
      {
        "id": 2,
        "text": "Lumbricals"
      },
      {
        "id": 3,
        "text": "Extensor digitorum"
      },
      {
        "id": 4,
        "text": "2nd Palmar interossei"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The structure marked in the image is the <strong>dorsal digital expansion </strong>of the middle finger<strong>. Palmar interossei</strong> do not attach to the middle finger and therefore it <strong>does not</strong> contribute to the dorsal digital expansion of the middle finger.&nbsp;</p>\n<p><strong>Palmar interossei</strong> are <strong>unipennate</strong> muscles originating from their own metacarpal bone. Their function is <strong>adduction</strong>. The middle finger does not need adduction and hence does not have palmar interossei.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b97dc3204c3742b6b39575442be2fdb4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/809cfc926f6e4543bd2ca1893bca2b86x652x621.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c85c1c7f9c04dad8ed9a940e5dcf7b3x584x620.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/87316e35245a423f8e196987918786f6x717x599.PNG"
    ]
  },
  {
    "text": "Identify the bony prominence marked in the image below",
    "choices": [
      {
        "id": 1,
        "text": "Greater trochanter"
      },
      {
        "id": 2,
        "text": "Lesser trochanter"
      },
      {
        "id": 3,
        "text": "Trochanteric crest"
      },
      {
        "id": 4,
        "text": "Intertrochanteric line"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The bone depicted in the above image is the <strong>Femur</strong> and the bony prominence marked \"A\" is the <strong>lesser</strong> <strong>trochanter</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/094f0db8e6114c6ca0d9df4baf62a9ef.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/baa69266eea548cda60e17fa6eb07592x1280x2117.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4436d8bdeb52408a935ed9d93a517a4ex1280x2117.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/861dddebb2bf4bd18ea06845b1862135x1280x2213.PNG"
    ]
  },
  {
    "text": "Which of the following structures is related to the area marked as A in the given image below?",
    "choices": [
      {
        "id": 1,
        "text": "Superior vena cava"
      },
      {
        "id": 2,
        "text": "Azygos vein"
      },
      {
        "id": 3,
        "text": "Arch of aorta"
      },
      {
        "id": 4,
        "text": "Left brachiocephalic vein"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The cadaveric image shown is of the&nbsp;<strong>left lung</strong>.&nbsp;The&nbsp;<strong>arch of aorta&nbsp;</strong>is related to the area marked as A in the given image.&nbsp;</p>\n<p>The left lung is divided into superior and inferior lobes by the<strong> oblique fissure</strong>. The <strong>pulmonary root</strong> connects the <strong>medial surface</strong> of the <strong>lung</strong> to the <strong>heart </strong>and <strong>trachea</strong>. It is formed by structures that enter or leave the hilum. The left root is present inferior to the <strong>arch </strong>of the<strong> aorta.</strong></p>\n<p>The vertical sequence of structures at the <strong>left hilum</strong> from above to below is:</p>\n<ul>\n<li>Pulmonary artery</li>\n<li>Principal (hyparterial) bronchus, and</li>\n<li>Inferior pulmonary vein</li>\n</ul>\n<p>The arrangement of the lung hilar structures from the <strong>anterior </strong>to <strong>posterior</strong> in the order is:</p>\n<ul>\n<li>Pulmonary vein</li>\n<li>Pulmonary artery</li>\n<li>Primary bronchus</li>\n<li>Bronchial artery</li>\n</ul>\n<p>The cadaveric image given below shows the structures related to the hilum of the<strong> left lung</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6a7a286ecf1c47be8310752ccd520a15.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/21255dcd62d04bcba92d99113cda60f9x1200x1125.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc6a9c97cc2a445a9c8798575557ce75x1280x1053.PNG"
    ]
  },
  {
    "text": "True regarding the lesion of the structure marked by the red arrow  is:",
    "choices": [
      {
        "id": 1,
        "text": "Ape Thumb deformity"
      },
      {
        "id": 2,
        "text": "Claw hand"
      },
      {
        "id": 3,
        "text": "Carpal tunnel syndrome"
      },
      {
        "id": 4,
        "text": "Wrist drop"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The structure marked in the image is the <strong>radial nerve</strong> demonstrated in the <strong>cubital fossa</strong>. A lesion of the radial nerve leads to a <strong>wrist drop.</strong></p>\n<p><strong>Claw hand deformity</strong> is seen in a lesion of the <strong>ulnar nerve</strong>. (Option B)</p>\n<p><strong>Ape thumb deformity</strong> is seen in a lesion of the <strong>median nerve</strong>. (Option A)</p>\n<p>Contrast the cadaveric image showing the anterior view with the schematic image below showing a posterior view of Radial Nerve course</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0741f36c0f7432db053c86fea33a214.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bbbb84f8af2b4b4e9038c07a2003fdcex1280x2560.JPEG"
    ]
  }
];
        let quizName = 'Fmge Mini Test - 16 (Cadaveric Images)';
        const quizFilename = 'fmge-mini-test-16-cadaveric-images-270c4544.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>