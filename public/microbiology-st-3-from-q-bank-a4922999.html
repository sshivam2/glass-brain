<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microbiology St 3 (From Q-Bank) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2017 - 18
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Streptococcus toxin which is responsible for connective tissue breakdown is:-",
    "choices": [
      {
        "id": 1,
        "text": "Hyaluronidase"
      },
      {
        "id": 2,
        "text": "Streptolysin O"
      },
      {
        "id": 3,
        "text": "Streptolysin S"
      },
      {
        "id": 4,
        "text": "Streptococcus pyogenic exotoxin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Hyaluronidase is responsible for connective tissue breakdown.</p>\n<p><strong>Hyaluronidase:</strong></p>\n<ul>\n<li>This enzyme is produced by S. pyogenes as well as by other groups like B, C, G streptococci, Streptococcus suis, Streptococcus anginosus, and S. pneumoniae.</li>\n<li>The enzyme splits hyaluronic acid present in host connective tissue, thereby facilitating spread of the bacteria through tissues. The enzyme is antigenic.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Metachromatic granules are seen in:-",
    "choices": [
      {
        "id": 1,
        "text": "Cornyebacterium"
      },
      {
        "id": 2,
        "text": "E. coli"
      },
      {
        "id": 3,
        "text": "Vibrio"
      },
      {
        "id": 4,
        "text": "Pseudomonas"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Metachromatic granules/BabeErnest\u2019s granules/ Volutin granules:-</strong></p>\n<ul>\n<li>These granules, which are the accumulation of polymerized phosphates, are responsible for the beaded appearance of the bacteria.\u00a0</li>\n<li>The granules can be demonstrated by special staining techniques, such as Albert stain, Neisser stain, and Ponder stain.</li>\n<li>Their main function is to supply phosphate for nucleic acid synthesis, cell division, energy metabolism and as a source of phosphorous for nutrition.</li>\n</ul>\n<p><strong>Metachromic granules are seen in:-</strong></p>\n<ul>\n<li>Corynebacterium</li>\n<li>Spirillum</li>\n<li>Rhizobium</li>\n<li>Bacillus</li>\n<li>Gardenella vaginalis</li>\n<li>Bordetella pertusis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bf911e02cd9b49dc8d61356ac298e3c2x800x568.JPEG"
    ]
  },
  {
    "text": "A farmer presents with multiple discharging sinuses in the leg not responding to antibiotics. Most likely diagnosis is:-",
    "choices": [
      {
        "id": 1,
        "text": "Madurella"
      },
      {
        "id": 2,
        "text": "Microsporum"
      },
      {
        "id": 3,
        "text": "Nocardia"
      },
      {
        "id": 4,
        "text": "Sporothrix"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The causative agent here is madurella causing Eumycetoma</p>\n<p><strong>Mycetoma:-</strong></p>\n<ul>\n<li>Mycetoma is a chronic, granulomatous infection of the skin, subcutaneous tissues, fascia and bone, which most often affects the foot or the hand. It is, therefore, commonly known as Maduramycosis or Madura foot. Mycetoma occurs worldwide.</li>\n<li>Etiology:&nbsp; It can be divided into three types, eumycetomas, actinomycetomas and botryomycosis.</li>\n</ul>\n<p><strong>Pathogenesis:-</strong></p>\n<ul>\n<li>Triad of symptoms: Infection follows traumatic inoculation of the organism into the subcutaneous tissue from soil or vegetable sources, usually on thorns or splinters and results in tumefactions, deformities and draining sinuses discharging fungal colonies called grains or granules (triad of symptoms).&nbsp;</li>\n<li>Subcutaneous tissues of the feet, lower extremities, hands, and exposed areas are most often involved.</li>\n<li>Grains: Within host tissues the organisms develop to form compacted colonies (grains) 0.5&ndash;2 mm in diameter, the color of which depends on the organism responsible.</li>\n</ul>\n<p><strong>Laboratory Diagnosis </strong></p>\n<ul>\n<li>A. Direct Examination: The presence of grains in pus collected from draining sinuses or in biopsy material is diagnostic.</li>\n<li>B. Culture Samples should also be cultured, at both 25&ndash;30&deg;C and 37&deg;C, on brain-heart infusion agar or blood agar for actinomycetes and on Sabouraud agar (without cycloheximide) for fungi.</li>\n</ul>\n<p>Treatment:-</p>\n<p>The management of eumycetoma is difficult, involving surgical debridement or excision and chemotherapy. Actinomycetoma responds well to rifampicin in combination with sulfonamides or cotrimoxazole.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/776ca69e59744c4f81329ec0f9ebdff1x800x600.JPEG"
    ]
  },
  {
    "text": "A patient recently returned from sub-Saharan Africa presents with painless haematuria. This structure was found on microscopy of urine. It was measured at 125 micrometers in length. Identify this structure.",
    "choices": [
      {
        "id": 1,
        "text": "Schistosoma haematobium"
      },
      {
        "id": 2,
        "text": "Schistosoma mansoni"
      },
      {
        "id": 3,
        "text": "Schistosoma japonicum"
      },
      {
        "id": 4,
        "text": "Trichuris trichura"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This is an egg of Schistosoma haematobium, recognised by its characteristic size (110-170 micrometers in length), internal miracidia and terminal spine.</p>\n<p>The terminal spine differentiates it from Schistosoma mansoni and Schistosoma japonicum.</p>\n<p>Schistosoma haematobium primarily causes genito-urinary schistosomiasis.</p>\n<p>The life cycle of schistosomes with the intermediate snail host is represented below:-</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8ae0a7a073d54a8b96a8f111388afaad.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/45bf9c405e5340c38c3b4cc5e2fb28f4x800x569.PNG"
    ]
  },
  {
    "text": "A man presents with dysuria and clear urethral discharge. He is sexually active. Gram stain of a urethral swab shows neutrophils but no organisms. Which of the following is the most appropriate culture medium for the most common organism responsible for the above condition?",
    "choices": [
      {
        "id": 1,
        "text": "McCoy cells"
      },
      {
        "id": 2,
        "text": "Thayer-Martin agar"
      },
      {
        "id": 3,
        "text": "Robertson\u2019s  cooked meat"
      },
      {
        "id": 4,
        "text": "PPLO broth"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A sexually active man with dysuria, urethral discharge and absence of bacteria on Gram staining suggests a diagnosis of <strong>non-gonococcal urethritis</strong>. The most common organism causing this is <strong><em>Chlamydia trachomatis </em></strong>and thus, the most appropriate culture medium is <strong>McCoy cells </strong>(human synovial carcinoma cell line).</p>\n<p><strong><em>C. trachomatis</em></strong> is a small gram-negative bacte\u00adrium and an <strong>obligate intracellular </strong>parasite. Hence, selective culture media like the McCoy cells culture is used to isolate the organism. <em>C. trachomatis</em> appears as an intracytoplasmic inclusion body. It causes urogenital syndromes in men and women.\u00a0</p>\n<p>Urethritis in men can be caused by <strong><em>Neiserria gonorrheae</em></strong>, <em>C. trachomatis, Mycoplasma genitalium, Ureaplasma urealyticum, Trichomonas vaginalis, </em>HSV, and rarely adenovirus. Gram stain of urethral discharge from<strong> gonococcal urethritis</strong> would show the presence of \u2265 2 PMNs/1000x field and<strong> Gram-negative intracellular diplococci</strong>. Chlamydial co-infection is common in gonococcal urethritis. In the absence of bacteria on Gram staining, non-gonococcal urethritis is suspected, of which 30-40% of cases are caused by <em>Chalmydia trachomatis</em>.\u00a0</p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option B: </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Thayer\u2013Martin agar</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> is used for isolation of </span><em style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Neisseria spp.\u00a0</em></p>\n<p>Option C: <strong>Robertson\u2019s cooked meat </strong>is used for the culture of anaerobes, especially Clostridia</p>\n<p>Option D: Pleuropneumonia-like organisms (PPLO) broth is used to culture <em>Mycoplasma spp</em>. and <em>Ureaplasma spp</em>.</p>\n<p><strong>Note: </strong>In women, abnormal urethral gram stain showing &gt;10 PMNs/1000\u00c5~ field with dysuria but without coliform bacteriuria supports the diagnosis of chlamydial urethritis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Malarial parasite: which statement is false regarding communicability?",
    "choices": [
      {
        "id": 1,
        "text": "The gametocytes appear in blood 4-6 days in P. vivax"
      },
      {
        "id": 2,
        "text": "The gametocytes appear in blood 10-12 days in P. falciparum"
      },
      {
        "id": 3,
        "text": "The number of gametocytes increases in blood with time"
      },
      {
        "id": 4,
        "text": "The number of gametocytes increases by 1000 times"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Malaria is communicable as long as mature, viable gametocytes exist in the circulating blood is sufficient density to infect vector mosquitoes.</p>\n<p><strong>RG interval (time interval between appearance of ring form and gametocyte):-</strong></p>\n<ul>\n<li>In vivax infections: 4-5 days</li>\n<li>In falciparum infections: 10-12 days</li>\n</ul>\n<p>In P. falciparum, since the RBC cycle takes place in the vessels of internal organs, hence gametocyte takes time to come to the peripheral blood.</p>\n<p>Gametocytes are numerous during early stages (may exceed 1,000 per cubic mm of blood) and do not increase in blood with time.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Unsegmented eggs are seen in which parasite?",
    "choices": [
      {
        "id": 1,
        "text": "Trichuris trichura"
      },
      {
        "id": 2,
        "text": "Necator americanus"
      },
      {
        "id": 3,
        "text": "Ancylostoma"
      },
      {
        "id": 4,
        "text": "Dracunculus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Trichuris trichura has unsegmented, barrel shaped eggs with mucus plugs at the ends</p>\n<p>Eggs of hookworm (Necator americanus and Ancylostoma) are segmented and oval Dracunculus does not have an egg stage.</p>\n<p><strong>Trichuris trichura:-</strong></p>\n<ul>\n<li>Trichuris trichiura is a gastrointestinal nematode in the family Trichuridae , genus Trichuris</li>\n<li>T. trichiura worms are white in colour and roughly 30 to 50 mm in length. The male worm, which is smaller than the female, has a coiled posterior end</li>\n<li>The female worm sheds between 3,000 and 20,000 eggs per day</li>\n<li>The distinguishing feature of T. trichiura is the stichosome, which is a glandular structure encircling the slender oesophagus of the thin anterior half of the worm.</li>\n</ul>\n<p><strong>Symptoms:-</strong></p>\n<ul>\n<li>In moderate infections of 20 adult worms or less, the worms are confined to the caecum and the ascending colon.</li>\n<li>Symptoms include epigastric and lower abdominal pain, diarrhoea (rarely bloody), vomiting, flatulence and distention, weight loss, and increased blood and iron loss.</li>\n<li>In heavy infections of 200 adults worms or more (Trichuris dysentery syndrome), the worms are in the distal colon and rectum; therefore, symptoms include bloody diarrhoea with profuse mucous, abdominal pain and tenesmus, weight loss leading to cachexia, severe anaemia, rectal prolapse, moderate eosinophilia, and the \"clubbing\" of fingers.</li>\n<li>Chronic infection leads to impaired childhood growth, poor physical fitness and nutritional status. Around 0.005 ml of blood is lost per day per worm. In heavy infections, as much as 4 to 5 ml can be lost per day per worm.</li>\n</ul>\n<p><strong>Treatment</strong>: Mebendazole or albendazole</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An Injecting Drug User presents to the ED with the lesion (as shown) on his neck. He also has a fever. What is the important cause of his lesion?",
    "choices": [
      {
        "id": 1,
        "text": "Ecthyma gangrenosum"
      },
      {
        "id": 2,
        "text": "Cutaneous anthrax"
      },
      {
        "id": 3,
        "text": "Bubonic plague"
      },
      {
        "id": 4,
        "text": "Lymphocutaneous tularemia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The diagnosis, in this case, is cutaneous anthrax caused by Bacillus anthracis.</p>\n<p>Based on the mode of infection, human Anthrax presents in one of three ways:- Cutaneous, pulmonary, or intestinal. All types leading to fatal septicemia or meningitis.</p>\n<p><strong>Cutaneous Anthrax:-</strong></p>\n<ul>\n<li>Transmission - Cutaneous exposure to spores (enter through abraded skin)</li>\n<li>Cutaneous anthrax used to be caused by shaving brushes made with animal hair.</li>\n<li>It begins 2&ndash;5 days after infection as a small papule that develops within a few days into a vesicle filled with dark bluish black fluid.</li>\n<li>Rupture of the vesicle reveals a black eschar at the base, with a very prominent inflammatory ring of reaction around the eschar. This is sometimes referred to as a malignant pustule.</li>\n<li>The lesion is classically found on the hands, forearms, or head and is painless. The disease used to be common in dock workers carrying loads of hides and skins on their bare backs and hence was known as the &lsquo;hide porter&rsquo;s disease.&rsquo;</li>\n</ul>\n<p><strong>Pulmonary Anthrax:-</strong></p>\n<ul>\n<li>Pulmonary anthrax, known as &lsquo;wool-sorter&rsquo;s disease, because it used to be common in workers in wool factories, due to inhalation of dust from infected wool.</li>\n<li>It occurs in patients who handle raw wool, hides, or horsehair and acquire the disease by the inhalation of spores.</li>\n<li>This is a hemorrhagic pneumonia with a high fatality rate. Hemorrhagic meningitis may occur as a complication.</li>\n</ul>\n<p><strong>Intestinal Anthrax:- </strong></p>\n<ul>\n<li>Intestinal anthrax, is rare and occurs mainly in primitive communities who eat the carcasses of animals dying of anthrax.</li>\n<li>An individual may suffer after a day or so from hemorrhagic diarrhea, and dies rapidly from septicemia.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e3e055352a9a45348b4de95449350d3c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The usual incubation period of pertussis is:-",
    "choices": [
      {
        "id": 1,
        "text": "7-14 days"
      },
      {
        "id": 2,
        "text": "3-5 days"
      },
      {
        "id": 3,
        "text": "21-25 days"
      },
      {
        "id": 4,
        "text": "Less than 3 days"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The usual incubation period of pertussis is: 7-14 days.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All are catalase positive except:-",
    "choices": [
      {
        "id": 1,
        "text": "Shigella flexneri"
      },
      {
        "id": 2,
        "text": "Shigella boydii"
      },
      {
        "id": 3,
        "text": "Shigella dysenteriae type 1"
      },
      {
        "id": 4,
        "text": "Shigella sonnei"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This demonstrates the presence of catalase, an enzyme that catalyses the release of oxygen from hydrogen peroxide.</p>\n<p><strong>Method:-</strong></p>\n<ul>\n<li>One ml of hydrogen peroxide solution, H2 O2 (10 vol), is poured over a 24 hours nutrient agar slope culture of the test organism and the tube is held in a slanting position</li>\n<li>Alternatively, a small amount of the culture to be tested is picked from a nutrient agar slope with a clean sterile platinum loop or a clean, thin glass rod and dip it in a drop of 10% hydrogen peroxide on a clean glass slide.</li>\n</ul>\n<p><strong>Interpretation:-</strong></p>\n<ul>\n<li>Positive test: Immediate bubbling, easily observed (O2 formed)</li>\n<li>A false-positive reaction may be obtained if the culture medium contains catalase (e.g. blood agar), or if an iron wire loop is used.</li>\n</ul>\n<p><strong>Negative test</strong>: No bubbling (no O2 formed)</p>\n<p><strong>Positive and Negative Bacteria:-</strong></p>\n<p>Catalase positive: All members of Enterobacteriaceae except Shigella dysentriae type 1; Staphylococcus, Micrococcus, Bacillus</p>\n<p>Catalase negative: Shigella dysentriae type 1, Streptococcus, Clostridium.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Have a look at these pictures from two different patients with the same clinical condition, and answer the questions below:\nWhat is the likely clinical disease in these two patients?",
    "choices": [
      {
        "id": 1,
        "text": "Mumps"
      },
      {
        "id": 2,
        "text": "Chicken pox"
      },
      {
        "id": 3,
        "text": "Hand, Foot and Mouth syndrome"
      },
      {
        "id": 4,
        "text": "Herpes simplex infection"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Hand, foot and mouth disease is a clinical syndrome caused by enteroviruses. The most common enteroviruses causing this syndrome worldwide are Enterovirus 71 (EV71), Coxsackie A6 (CA6), Coxsackie A16 (CA16), and Coxsackie A10 (CA10)</p>\n<p>Classically the lesions are papulo-vesicular, but sometimes vesicles are not present.When the lesions only appear on the oro-pharynx, it is sometimes called &ldquo;herpangina&rdquo;.</p>\n<p>Most cases of Hand, Foot and Mouth Disease are mild and self-limiting. However serious complications (and fatalities) can occur with clinical syndromes such as aseptic meningitis,&nbsp;encephalitis &amp;&nbsp;acute flaccid paralysis. There may also be pulmonary oedema, possibly neurogenic in nature. These complications occur most commonly with EV71.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d07e0830548042799c83796a45cab1df.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Sleeping sickness is transmitted by?",
    "choices": [
      {
        "id": 1,
        "text": "Tsetse fly"
      },
      {
        "id": 2,
        "text": "House fly"
      },
      {
        "id": 3,
        "text": "Sand fly"
      },
      {
        "id": 4,
        "text": "Simulium fly"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>African trypanosomiasis</strong>, also known as&nbsp;<strong>sleeping sickness</strong>, is an arthropod-borne&nbsp;parasitic&nbsp;disease&nbsp;of humans and other animals.&nbsp;It is caused by&nbsp;protozoa&nbsp;of the species&nbsp;Trypanosoma brucei.</li>\n<li>Initially, in the first stage of the disease, there are fevers, headaches, itchiness, and joint pains. This begins one to three weeks after the bite.</li>\n<li>Weeks to months later the second stage begins with confusion, poor coordination, numbness and trouble sleeping.</li>\n<li>Diagnosis is via finding the parasite in a&nbsp;blood smear&nbsp;or in the fluid of a lymph node.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Eggs of which of the following parasite cause intense pruritis in perianal skin?",
    "choices": [
      {
        "id": 1,
        "text": "Ascaris"
      },
      {
        "id": 2,
        "text": "Hookworm"
      },
      {
        "id": 3,
        "text": "Enterobius vermicularis"
      },
      {
        "id": 4,
        "text": "Trichuris"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Eggs of enterobius vermicularis cause intense pruritis in perianal skin</p>\n<p><strong>Enterobius vermicularis (Pinworm):-</strong></p>\n<ul>\n<li>These worms are small, white, and threadlike, with the larger females ranging between 8-13 mm x 0.3-0.5 mm and the smaller males ranging between 2-5 mm x 0.1-0.2 mm.</li>\n<li>Females possess a long, pin-shaped posterior end. They dwell primarily in the cecum of the large intestine, from where the gravid females migrate at night to lay up to 15,000 eggs on the perineum.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/61c0ddd94d054a6b8c06e9158b6825dbx446x524.PNG"
    ]
  },
  {
    "text": "HIV infects which of the following cells?",
    "choices": [
      {
        "id": 1,
        "text": "NK cells"
      },
      {
        "id": 2,
        "text": "T- helper cells"
      },
      {
        "id": 3,
        "text": "T suppressor cells"
      },
      {
        "id": 4,
        "text": "Plasma cells"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>HIV infects T-helper cells</p>\n<p><strong>Pathogenesis of HIV infection:-</strong></p>\n<ul>\n<li>Infection is transmitted when the virus enters the blood or tissues of a person and comes into contact with a suitable host cell, principally the CD4 lymphocyte.</li>\n<li>The major determinant in the pathogenesis and disease caused by HIV is the virus tropism for CD4-expressing T cells and cells of the macrophage lineage.</li>\n<li>The primary pathogenic mechanism in HIV infection is the damage caused to the CD4+ T lymphocyte.</li>\n<li>The T4 cells decrease in numbers and the T4:T8 (helper: suppressor) cell ratio is reversed.</li>\n<li>An important feature in HIV infection is the polyclonal activation of B lymphocytes leading to hypergammaglobulinemia. In peripheral blood, lymphoid tissue and other tissues such as brain where HIV replication occurs, HIV targets CD4 positive (CD4+) cells and cells of the monocyte-macrophage lineage.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the organism seen in the image given below.",
    "choices": [
      {
        "id": 1,
        "text": "Ascaris lumbricoides"
      },
      {
        "id": 2,
        "text": "Trichuris trichura"
      },
      {
        "id": 3,
        "text": "Enterobius vermicularis"
      },
      {
        "id": 4,
        "text": "Hookworm"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This is a cellotape slide demonstrating eggs of Enterobius vermicularis (pinworm/threadworm). A strip of cellotape is applied to the peri-anal area just after the patient awakes (before washing)&nbsp;and then applied to a microscope slide.</p>\n<p><strong>Eggs of enterobius vermicularis:-</strong></p>\n<ul>\n<li>Bile non stained</li>\n<li>Planoconvex eggs containing larva inside</li>\n</ul>\n<p><strong>Life cycle of Enterobius vermicularis:-</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ee28c19d171e462faea409fa01486c69.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/072e4d8fb11d4a85929dc006963951c9x435x497.GIF"
    ]
  },
  {
    "text": "A patient who comes with a history of an insect bite while trekking is diagnosed to have scrub typhus. The weil-Felix reaction will show positivity for which of the following antigens?",
    "choices": [
      {
        "id": 1,
        "text": "OX-K"
      },
      {
        "id": 2,
        "text": "OX-K and OX-19"
      },
      {
        "id": 3,
        "text": "OX-2"
      },
      {
        "id": 4,
        "text": "OX-19"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> Weil&ndash;Felix</strong> reaction for <strong>scrub typhus</strong> shows positivity for <strong>OX K</strong>.</p>\n<p><strong>Weil&ndash;Felix test</strong> is a <strong>heterologous agglutination test</strong> used for the diagnosis of <strong>rickettsial</strong> infections. The test detects anti-rickettsial antibodies that cross-react with O antigens of certain nonmotile strains of <strong><em>Proteus</em></strong>. In this test, nonmotile strains of <em>Proteus vulgaris</em>&nbsp;<strong>OX 19</strong> and <strong>OX 2</strong> and<em> Proteus mirabilis</em> <strong>OX K</strong> are used as antigens. The Weil&ndash;Felix test becomes positive 10&ndash;20 days after infection.</p>\n<ul>\n<li>Sera from<strong> epidemic typhus</strong> shows a <strong>strong</strong> reaction with <strong>OX 19</strong> antigen and <strong>weakly</strong> agglutinates with <strong>OX 2</strong> antigen.&nbsp;</li>\n<li>Sera from <strong>endemic typhus</strong> shows a <strong>strong</strong> reaction with <strong>OX 19</strong> antigen and <strong>may weakly</strong> agglutinate with <strong>OX 2</strong> antigen.&nbsp;</li>\n<li>Sera from <strong>scrub typhus </strong>agglutinates with <strong>OX K</strong> antigen.</li>\n<li><strong>Weil&ndash;Felix test </strong>is <strong>negative</strong> or weakly reactive in <strong>Brill&ndash;Zinsser disease</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "DOC for mycoplasma pneumoniae is:-",
    "choices": [
      {
        "id": 1,
        "text": "Azithromycin"
      },
      {
        "id": 2,
        "text": "Amoxiclav"
      },
      {
        "id": 3,
        "text": "Doxycycline"
      },
      {
        "id": 4,
        "text": "Erythromycin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Mycoplasma pneumoniae:-</strong></p>\n<ul>\n<li>Infection with M. pneumoniae typically produces mild upper respiratory tract disease. More severe disease with lower respiratory tract symptoms occurs in less than 10% of patients.</li>\n<li>Tracheobronchitis can occur. Pneumonia (referred to as primary atypical pneumonia or walking pneumonia) can also develop.</li>\n<li>Incubation period: 1&ndash;3 weeks</li>\n<li>Secondary complications: otitis media, erythema multiforme (Stevens&ndash;Johnson syndrome), hemolytic anemia, myocarditis, pericarditis, and neurologic abnormalities.</li>\n</ul>\n<p><strong>Laboratory Diagnosis:-</strong></p>\n<ul>\n<li>Specimens: M. pneumoniae may be recovered from throat swabs, nasopharyngeal swabs, sputum, throat washings, bronchoalveolar lavage, tracheal aspirate and lung tissue specimens.</li>\n<li>Culture: Isolation medium containing bovine heart infusion (PPLO broth) with fresh yeast extract and horse serum supplemented with penicillin (to inhibit other bacteria), thallium acetate, glucose and with phenol red as a pH indicator</li>\n<li>A slight, gradual shift in the pH indicator over an 8&ndash;15 day period without gross turbidity suggests a true-positive culture.</li>\n<li>Colonies on agar media: Colonies of M. pneumoniae are small, betahemolytic and have a homogeneous granular appearance (&ldquo;mulberry shaped)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The best diagnostic procedure of M. tuberculosis is:-",
    "choices": [
      {
        "id": 1,
        "text": "PCR"
      },
      {
        "id": 2,
        "text": "Auramine rhodamine stain"
      },
      {
        "id": 3,
        "text": "Sputum examination"
      },
      {
        "id": 4,
        "text": "ESR"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>best diagnostic procedure</strong> of M. tuberculosis is <strong>sputum examination.</strong></p>\n<ul>\n<li>Sputum microscopy is the most dependable and conventional method for demonstration of AFB by ZN staining method.</li>\n<li>The smears are made from <strong>thick purulent part</strong> of the sputum and then are air dried, fixed by heating, and finally stained by ZN technique.</li>\n<li>The stained smear is examined under oil immersion lens (100). Acid-fast bacteria in a stained smear <strong>appear bright red against a blue background.</strong></li>\n<li>At least 50,000 to 1 lakh bacilli should be present per milliliter of sputum in order to be examined, taking about 10 minutes before giving a negative report.</li>\n<li>The presence of at least two or more typical bacilli in the smear is reported as positive for AFB.</li>\n</ul>\n<p>The smears are graded depending on the number of tubercle bacilli present in a stained smear on examination by oil immersion lens.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Microorganism is arranged characteristically in grape like clusters in gram stain of sputum. Identify the microorganism in image",
    "choices": [
      {
        "id": 1,
        "text": "Staphylococcus"
      },
      {
        "id": 2,
        "text": "Mycobacterium"
      },
      {
        "id": 3,
        "text": "Streptococcus"
      },
      {
        "id": 4,
        "text": "Neisseria"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Staphylococci are spherical cocci, arranged characteristically in grape like cluster. Cluster formation is due to cell division occurring in three planes, with daughter cells tending to remain in close proximity.</p>\n<ul>\n<li>GPC (Gram positive cocci) in cluster- Staphylococcus</li>\n<li>GPC in tetrad- Micrococcus (as cell division takes place in multiple planes)</li>\n<li>GPC in chain- Strepococcus</li>\n<li>GPC in pair- Pneumococci, Enterococci (as cell division takes place in single plane)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ef8794c44a0c46e2bfbf177364f696bf.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A stool examination was carried out which showed organism with darting motility. Which of the following organism may be present in stool?",
    "choices": [
      {
        "id": 1,
        "text": "Shigella"
      },
      {
        "id": 2,
        "text": "V. cholera"
      },
      {
        "id": 3,
        "text": "Campylobacter jejuni"
      },
      {
        "id": 4,
        "text": "Both b and c"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Vibrio has a single polar sheathed flagellum.</p>\n<p>Campylobacter has amphi or lophotrichous flagella also shows darting motility.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an immunologically privileged site?",
    "choices": [
      {
        "id": 1,
        "text": "Seminiferous tubule"
      },
      {
        "id": 2,
        "text": "Area postrema"
      },
      {
        "id": 3,
        "text": "Optic nerve"
      },
      {
        "id": 4,
        "text": "Loop of Henle"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong>\u00a0seminiferous tubules</strong>\u00a0are an<strong> </strong>immunologically privileged site.</p>\n<p>Immunologically privileged sites can tolerate the introduction of antigens without eliciting an immune response. This allows a higher likelihood of graft survival, even without perfect HLA matching. As a result, an allograft can be placed in these sites without endangering a rejection reaction.</p>\n<p>The unique immune tolerance in these regions is primarily due to the lack of effective lymphatic drainage, which prevents antigen presentation to the immune system, and the presence of blood-tissue barriers that restrict immune cell infiltration. Low vascularity contributes to immune privilege by minimising antigen exposure and immune cell recruitment.\u00a0</p>\n<p>Examples of immune-privileged sites are the anterior chamber of the eye, cornea, testes, and brain.\u00a0</p>\n<p>Note: Although part of the brain, the blood-brain barrier is absent at the area postrema, therefore it is not an immune-privileged site.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Hyperacute graft rejection is commonly seen in the transplants of:-",
    "choices": [
      {
        "id": 1,
        "text": "Bone marrow"
      },
      {
        "id": 2,
        "text": "Kidney"
      },
      {
        "id": 3,
        "text": "Liver"
      },
      {
        "id": 4,
        "text": "Heart"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Hyperacute graft rejection is seen in the kidney.</p>\n<p><strong>Hyperacute rejection:- </strong></p>\n<p>Hyperacute rejection occurs usually within the first few hours post-transplantation and is mediated by preformed antibodies against ABO or MHC antigens of the graft. Once the antibodies bind to the transplanted tissues, rejection can be caused either</p>\n<p style=\"padding-left: 30px;\">a)&nbsp;by activation of the complement system, which results in the chemotactic attraction of granulocytes and the triggering of inflammatory circuits, or</p>\n<p style=\"padding-left: 30px;\">b)&nbsp;by ADCC</p>\n<p>Pathological features of hyperacute rejection are the following:-</p>\n<ul>\n<li>This is associated with the formation of massive intravascular platelet aggregates leading to thrombosis, ischemia, and necrosis</li>\n<li>The hyperacute rejection episodes are irreversible and invariably results in graft loss. With proper cross-matching techniques, this type of rejection is almost 100% avoidable.</li>\n<li>The hyperacute rejection by antibodies to all human cellular antigens is the major limitation of xenogeneic transplantation (e.g., pig to human)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Large, irregular and necrotic pocks are seen on the Chorioallantoic membrane(CAM). Diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Herpes virus 2"
      },
      {
        "id": 2,
        "text": "Variola"
      },
      {
        "id": 3,
        "text": "Influenza virus."
      },
      {
        "id": 4,
        "text": "Cowpox"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Pocks on CAM showing large, irregular and necrotic pocks points to diagnosis of HSV 2.</p>\n<p>Small pocks represent HSV 1</p>\n<p><strong>Laboratory tests for diagnosis of herpes simplex infections:-</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Nonmotile clostridia is:-",
    "choices": [
      {
        "id": 1,
        "text": "Cl. Perfringens"
      },
      {
        "id": 2,
        "text": "Cl. Novyi"
      },
      {
        "id": 3,
        "text": "Cl. Botulinum"
      },
      {
        "id": 4,
        "text": "Cl. Difficile"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Morphology of Clostridium perfringens:-</strong></p>\n<ul>\n<li>Large gram-positive bacillus (about 4&ndash;6 &times; 1&mu;m)</li>\n<li>Rod-shaped</li>\n<li>Non motile Gram-positive bacterium</li>\n<li>Pleomorphic</li>\n<li>Filamentou</li>\n<li>Capsulated and nonmotile</li>\n<li>Spores are typically oval, central or sub terminal</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "EHEC strain associated with HUS is:-",
    "choices": [
      {
        "id": 1,
        "text": "O157: H7"
      },
      {
        "id": 2,
        "text": "O7: H157"
      },
      {
        "id": 3,
        "text": "O37: H14"
      },
      {
        "id": 4,
        "text": "O157: H9"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>E. coli O157:H7, the most common strain causing EHEC diarrhea, has a small infective dose (around 100 bacilli) and spreads easily from child to child by the fecal&ndash;oral route.</p>\n<p><strong>Hemolytic uremic syndrome (HUS):-</strong></p>\n<ul>\n<li>Serious life-threatening complication, seen in 10&ndash;15% of children with EHEC diarrhea.</li>\n<li>Important manifestations include (i) microangiopathic hemolytic anemia, (ii) thrombocytopenia, and (iii) renal insufficiency</li>\n<li>Typically develops in the second week of illness, after recovery from diarrhea</li>\n<li>Presents with anemia, weakness, irritability, and oliguria or anuria</li>\n<li>Chronic renal failure may develop in 10% of patients with HUS</li>\n<li>Mortality rate&mdash;nearly 3&ndash;5%</li>\n<li>Stool culture for EHEC is always negative in patients with HUS</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Investigation of choice for follow-up evaluation in a patient who underwent therapy for syphilis is ______________ .",
    "choices": [
      {
        "id": 1,
        "text": "Fluorescent treponema antibody absorption test"
      },
      {
        "id": 2,
        "text": "Venereal disease research laboratory test"
      },
      {
        "id": 3,
        "text": "Treponema pallidum immobilisation test"
      },
      {
        "id": 4,
        "text": "Dark ground microscopy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Venereal disease research laboratory test (VDRL test)</strong> is the investigation of choice for follow-up evaluation in a patient who underwent therapy for syphilis. Failure of nontreponemal test titers to decrease fourfold within 12-24 months after therapy depending on the stage of syphilis (inadequate serologic response) might be indicative of treatment failure.</p>\n<p>Serologic tests for syphilis recommended by the Centers for Disease Control and Prevention (CDC):</p>\n<ol>\n<li><strong>Screening</strong> or <strong>diagnosis </strong>-<strong> RPR </strong>or<strong> VDRL</strong></li>\n<li>Quantitative measurement of antibodies to assess <strong>clinical syphilis activity</strong> or to <strong>monitor response</strong> to therapy - <strong>RPR </strong>or<strong> VDRL</strong></li>\n<li><strong>Confirmation</strong> of a syphilis diagnosis in a patient with a reactive RPR or VDRL test - <strong>FTA-ABS, TPHA, EIA/CIA&nbsp;</strong></li>\n</ol>\n<ul>\n<li><strong>RPR </strong>- Rapid plasma reagin test</li>\n<li><strong>FTA-ABS</strong> -&nbsp;Fluorescent treponema antibody absorption test&nbsp;</li>\n<li><strong>TPHA</strong> - Treponema pallidum hemagglutination assay&nbsp;</li>\n<li><strong>EIA</strong> - Enzyme immunoassay</li>\n<li><strong>CIA</strong> - Chemiluminescence immunoassay</li>\n</ul>\n<p>VDRL test is a <strong>slide flocculation test</strong> used widely for the diagnosis of syphilis.&nbsp;</p>\n<p>In this test, the serum is inactivated at 56&deg;C for 30 minutes and a measured volume of serum is placed on a special cavity slide. The cardiolipin antigen after preparation is added to the serum sample on a slide and is rotated on a VDRL rotator for a specified period of 4 minutes. In a <strong>positive test</strong>, the <strong>cardiolipin antigen</strong> reacts with reagin antibodies present in the infected serum and forms <strong>visible clumps</strong>. In a negative test, cardiolipin continues to remain as uniform crystals in the serum.</p>\n<p>The result of the test is reported as reactive, weak reactive, or nonreactive depending on the extent of the formation of the clumps. The VDRL test becomes positive 4&ndash;5 weeks after exposure to T. pallidum and 1&ndash;2 weeks after the appearance of the chancre. It is a <strong>highly sensitive test </strong>and the sensitivity of the test depends on the stage of the disease:-</p>\n<ul>\n<li>The test is 60&ndash;75% sensitive in primary syphilis</li>\n<li>The test is <strong>100% sensitive in secondary syphilis</strong></li>\n<li>High antibody titers may be found in patients developing gummatous lesions and neurovascular or cardiovascular complications.</li>\n<li>The test is usually negative in the tertiary stage of syphilis</li>\n<li>This test is negative in early primary syphilis, latent acquired syphilis, and late congenital syphilis</li>\n</ul>\n<p>Other options:</p>\n<p>Option A:&nbsp;Fluorescent treponema antibody absorption test (<strong>FTA-ABS</strong>) is an indirect immunofluorescence test used to detect specific treponemal antibodies. It is not available for routine testing as it is done only in suitably equipped labs.</p>\n<p>Option C: Treponema pallidum immobilization (<strong>TPI</strong>) test detects the presence of treponemal antibodies in the serum. Similar to the FTA-ABS test, it is also not available for routine testing.</p>\n<p>Option D:&nbsp;<strong>Dark ground microscopy</strong> is the most specific and sensitive technique to diagnose syphilis when an active chancre or condyloma lata is present.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A clinical specimen was obtained from the wound of a patient diagnosed as Nocardiosis. For the selective isolation of Nocardia species, which one of the following would be the best method?",
    "choices": [
      {
        "id": 1,
        "text": "Paraffin bait technique"
      },
      {
        "id": 2,
        "text": "Castaneda\u2019s culture method"
      },
      {
        "id": 3,
        "text": "Craige\u2019s tube method"
      },
      {
        "id": 4,
        "text": "Hair bait technique"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Nocardia species can grow at wide range of temperature. Selective growth is favored by incubation at 45&deg;C. The technique of paraffin baiting is the best method.</p>\n<p><strong>Paraffin bait technique:-</strong></p>\n<ul>\n<li>The specimen is homogenized with sterile glass beads and 2 ml of it is inoculated into carbon-free broth containing paraffin coated glass rod. The organisms grow on the rod at the air-liquid surface which may be subcultured onto agar media.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true regarding Arbo viruses?",
    "choices": [
      {
        "id": 1,
        "text": "Yellow fever is endemic in India"
      },
      {
        "id": 2,
        "text": "Dengue virus has only one serotype"
      },
      {
        "id": 3,
        "text": "Kyasanur forest disease is transmitted by ticks"
      },
      {
        "id": 4,
        "text": "Mosquito of culex visnoi- compex is the vector of Dengue fever"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Other options:-</strong></p>\n<ul>\n<li>Yellow fever virus is the prototype member of the Flaviviridae family. lt causes yellow fever, an acute, febrile, mosquito-borne illness that occurs only in Africa and Central and South America. It does not exist in India.</li>\n<li>Four types of dengue virus serotypes exist : DEN 1, DEN 2, and DEN 3 and 4</li>\n<li>Dengue virus is transmitted from person to person by Aedes aegypti mosquitoes</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Water lily sign is seen in infection due to:",
    "choices": [
      {
        "id": 1,
        "text": "Neurocysticercosis"
      },
      {
        "id": 2,
        "text": "Schistosomiasis"
      },
      {
        "id": 3,
        "text": "Filariasis"
      },
      {
        "id": 4,
        "text": "Echinococcus infection"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The&nbsp;<strong>water-lily sign</strong>&nbsp;is seen in&nbsp;hydatid infections&nbsp;when there is detachment of the endocyst membrane which results in floating membranes within the pericyst that mimic the appearance of a water lily.</p>\n<p>It is classically described on plain radiographs (mainly chest X-ray) when the collapsed membranes are calcified but may be seen on ultrasound, CT or MRI.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient from Kerala has presented to your OPD with fever. A magnified view of peripheral blood smear is shown below. Which of the following is false regarding the organism seen?",
    "choices": [
      {
        "id": 1,
        "text": "DEC provocation test is used to demonstrate microfilaria during the day"
      },
      {
        "id": 2,
        "text": "Second stage filariform larva is the infective form"
      },
      {
        "id": 3,
        "text": "Microfilaria is the major diagnostic form"
      },
      {
        "id": 4,
        "text": "Filarial stage of adult worms are responsible for disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Fever with a peripheral smear showing <strong>sheathed microfilaria</strong> with a pointed <strong>tail free of nuclei</strong> is suggestive of <em><strong>Wuchereria bancrofti.</strong></em> The <strong>third stage filariform larva</strong> is the <strong>infective form.</strong></p>\n<p><em>Wuchereria bancrofti</em>\u00a0infection is usually\u00a0asymptomatic<strong>. </strong>The symptoms are due to <strong>obstruction of lymphatics</strong> by the filarial stage of <strong>adult worms</strong>. The lymphatic vessels of the <strong>male genitalia </strong>are most commonly affected in bancroftian filariasis, producing\u00a0episodic funiculitis, epididymitis, and orchitis. Adenolymphangitis of the extremities is less common.\u00a0</p>\n<p><strong>Hydrocele</strong> is the most common sign of chronic bancroftian filariasis, followed by lymphedema, elephantiasis, and chyluria. The swelling involves the whole leg, the whole arm, the scrotum, the vulva, or the breast.\u00a0<strong>DEC provocation test</strong> is used to demonstrate <strong>microfilaria</strong> during the<strong> day</strong>.</p>\n<p>The image below shows the life cycle of\u00a0<em>Wuchereria bancrofti.</em></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a3585ecedce3443db89ceef9160269ef.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/158b719e193c4f96b5b54bde9ff948c8x439x319.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f4a3f3f470b144788b95c1e4af58ea33x1280x3534.JPEG"
    ]
  },
  {
    "text": "Pigment producing atypical mycobacteria is/are:-",
    "choices": [
      {
        "id": 1,
        "text": "M. fortuitum and M. chelonae"
      },
      {
        "id": 2,
        "text": "M. gordonae and M. szulgai"
      },
      {
        "id": 3,
        "text": "M. xenopi and MAC"
      },
      {
        "id": 4,
        "text": "M. ulcerans"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pigment producing atypical mycobacteria include:-</strong></p>\n<ul>\n<li>Photochromogens (bright yellow or orange coloured colonies): M. kansasii, M. marinum, M. simiae</li>\n<li>Scotochromogens (yellow-orange-red colonies): M. scrofulaceum, M. gordonae, M. szulgai</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "DOC of chlamydia in pregnancy?",
    "choices": [
      {
        "id": 1,
        "text": "Tetracycline"
      },
      {
        "id": 2,
        "text": "Doxycycline"
      },
      {
        "id": 3,
        "text": "Amoxycillin"
      },
      {
        "id": 4,
        "text": "Metronidazole"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Treatment of genital Chlamydias:-</strong></p>\n<p>Single dose azithromycin regimen is DOC</p>\n<p>Treatment of chlamydia in pregnancy:-</p>\n<ul>\n<li>Although not approved by the FDA for use in pregnancy, single dose regimen of azithromycin regimen appears to be safe and effective for this purpose.</li>\n<li>However, amoxicillin (500 mg three times a daily for 7 days) can also be given to pregnant women.</li>\n<li>The fluoroquinolones are contraindicated in pregnancy.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a good media to use for diagnosis of Legionnaires disease?",
    "choices": [
      {
        "id": 1,
        "text": "Thayer Martin media"
      },
      {
        "id": 2,
        "text": "BCYE agar"
      },
      {
        "id": 3,
        "text": "Border Gengou media"
      },
      {
        "id": 4,
        "text": "Chocolate agar"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The medium most commonly used for the isolation of legionellae is buffered charcoal-yeast extract (BCYE) agar</p>\n<p><strong>Culture media for Legionellae:-</strong></p>\n<p>Legionellae are nutritionally fastidious. Their growth is enhanced with iron salts and depends on the supplementation of media the L-cysteine. They have fastidious requirements and grow on complex media such as buffered charcoal, yeast extract (BCYE) agar, with L-cysteine and antibiotic supplements, with 5% CO2 , at pH 6.9, 35&deg;C and 90% humidity. Growth is slow and colonies take 3&ndash;6 days to appear.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Skin scraping and KOH preparation shows an abundance of yeast like cells and short branched filaments. Diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Malassezia"
      },
      {
        "id": 2,
        "text": "Trichophyton"
      },
      {
        "id": 3,
        "text": "Chlamydospores"
      },
      {
        "id": 4,
        "text": "Candida"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The causative agent is lipophilic, yeast like fungus<strong>&nbsp;Malassezia furfur (Pityrosporum orbiculare).</strong></p>\n<p>Pityriasis versicolor is a chronic usually asymptomatic, involvement of the stratum corneum, characterized by discrete or confluent macular areas of discoloration or de-pigmentation of the skin.</p>\n<p>The areas involved are mainly the chest, abdomen, upper limbs and back.</p>\n<p>Skin scraping and KOH preparation shows an abundance of yeast like cells and short branched filaments (Sphagetti and meatball appearance).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f5677dd6099d4527939e0494e89d0468.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 30 year old patient presented with history of jaundice for 10 days. His liver function tests showed bilirubin of 10 mg/dl, SGOT/SGPT- 1100, serum alkaline phosphatase- 240 IU. He was  positive for HbsAg. What should be the confirmatory test to establish acute hepatitis B infection?",
    "choices": [
      {
        "id": 1,
        "text": "IgM anti- HBc antibody"
      },
      {
        "id": 2,
        "text": "HbeAg"
      },
      {
        "id": 3,
        "text": "HBV DNA by PCR"
      },
      {
        "id": 4,
        "text": "IgG Anti- HBc antibody"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In this case scenario, IgM anti- HBc should be the confirmatory test to establish acute hepatitis B infection.</p>\n<p><strong>Detection of Viral Markers in hepatitis B infection:-</strong></p>\n<ul>\n<li><strong>HBsAg</strong>: HBsAg is the first marker to appear in blood after infection. HBsAg is usually detectable 2&ndash;6 weeks in advance of clinical and biochemical evidence of hepatitis and persists throughout the clinical course of the disease.&nbsp;</li>\n<li><strong>HBcAg</strong>: <strong>High levels of IgM-specific anti-HBc are frequently detected at the onset of clinical illness</strong>. Because this antibody is directed against the 27 nm internal core component of HBV, its appearance in the serum is indicative of viral replication. HBcAg is not demonstrable in circulation. It is the earliest antibody marker to be seen in blood, long before anti-HBe or anti-HBs. As anti-HBc remains lifelong, it serves as a useful indicator of prior infection with HBV.</li>\n<li><strong>HBeAg</strong>: HBeAg presence denotes high infectivity and its absence, along with the presence of anti-HBe, indicates low infectivity.</li>\n<li>Interpretation of serological markers in HBV infection:-</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/6380314bbdd54f678068b2bf609cc00dx526x195.PNG"
    ]
  },
  {
    "text": "Morphological appearance of Pneumocystis jiroveci infection of lung is best characterized by:-",
    "choices": [
      {
        "id": 1,
        "text": "Hemorrhagic and necrotizing pneumonia"
      },
      {
        "id": 2,
        "text": "ARDS with wide spread hyaline membrane formation"
      },
      {
        "id": 3,
        "text": "Interstitial pneumonitis with foamy intra alveolar exudates"
      },
      {
        "id": 4,
        "text": "Bronchopulmonary abscess formation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Morphological features of Pneumocystis jirovecii:-</strong></p>\n<p>The multiplication of the fungus in the lungs induces a hyaline or foamy alveolar exudate. In stained sections, the exudate filling the alveoli shows a characteristic honeycomb pattern. Chest radiographs may be normal or show diffuse interstitial infiltrates.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Second intermediate host to Diphyllobothrium latum is:-",
    "choices": [
      {
        "id": 1,
        "text": "Cyclops"
      },
      {
        "id": 2,
        "text": "Man"
      },
      {
        "id": 3,
        "text": "Snail"
      },
      {
        "id": 4,
        "text": "Fresh water fish"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Life cycle of Diphyllobothrium latum</p>\n<ul>\n<li>First intermediate host: freshwater crustacean</li>\n<li>Second intermediate host: Freshwater fish</li>\n<li>Infective stage of humans: Plerocercoid larvae</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/375754eb7f9044f59d63ff71a1a014b0x404x317.PNG"
    ]
  },
  {
    "text": "Which one of the following is false regarding chlamydia trachomatis?",
    "choices": [
      {
        "id": 1,
        "text": "Elementary body is metabolically active"
      },
      {
        "id": 2,
        "text": "It is biphasic"
      },
      {
        "id": 3,
        "text": "Reticulate body divides by binary fission"
      },
      {
        "id": 4,
        "text": "Inside the cell it evades phagolysosome fusion"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Growth Cycle of chlamydia:-</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9051d58d94c24db5867efe3ad53da79ex633x600.JPEG"
    ]
  },
  {
    "text": "A patient made a self diagnosis of athlete\u2019s foot (tinea pedis) and began using a product advertised on television. The condition improved but did not clear and then the patient showed himself to a dermatologist. A skin scraping was sent to the laboratory for culture, including culture for fungi. The fungal culture yielded a slow growing colony, which produced a few small macroconidia. This is consistent with isolation of a dermatophyte of the genera:-",
    "choices": [
      {
        "id": 1,
        "text": "Trichophyton"
      },
      {
        "id": 2,
        "text": "Microsporum"
      },
      {
        "id": 3,
        "text": "Epidermophyton"
      },
      {
        "id": 4,
        "text": "Trichosporon"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Trichophyton:</strong></p>\n<p>Trichophyton species infect hair, skin or nails</p>\n<p><strong>Colony characteristics:-</strong></p>\n<ul>\n<li>Colonies may be powdery, velvety or waxy, with pigmentation characteristic of different species.</li>\n<li>Microconidia are abundant and are arranged in clusters along the hyphae or borne on conidiophores.</li>\n<li>Macroconidia are relatively scanty. They are generally elongated, with blunt ends</li>\n<li>Macroconidia have distinctive shapes in different species and are of importance in species identification.</li>\n<li>Some species possess special hyphal characters, such as spiral hyphae, racquet mycelium and favic chandeliers</li>\n</ul>\n<p>Important Species: T. rubrum, T. mentagrophyte, T. tonsurans, T. schoenleinii, T. violaceum.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Tryptic Soy Agar shows golden yellow colonies as in plate. Identify the microorganism",
    "choices": [
      {
        "id": 1,
        "text": "Staphylococcus"
      },
      {
        "id": 2,
        "text": "Mycobacterium"
      },
      {
        "id": 3,
        "text": "Streptococcus"
      },
      {
        "id": 4,
        "text": "Neisseria"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Most stains of Staph aureus produce golden yellow pigment. The pigment doesn&rsquo;t diffuse into the medium. The pigment is believed to be a lipo-protein allied to carotene.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6f3c87cd199447048b652ee5c50b7a87.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/877ffb9dded44dd992cef968e0522378x394x147.PNG"
    ]
  },
  {
    "text": "The most common site for amebiasis is:-",
    "choices": [
      {
        "id": 1,
        "text": "Sigmoid colon"
      },
      {
        "id": 2,
        "text": "Transverse colon"
      },
      {
        "id": 3,
        "text": "Cecum"
      },
      {
        "id": 4,
        "text": "Hepatic flexure"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>&nbsp;</p>\n<p><strong>The most common site for amebiasis is cecum.</strong></p>\n<p>Amebiasis is caused by&nbsp;Entamoeba histolytica.</p>\n<p>Although most cases of amebiasis are asymptomatic, dysentery and invasive extraintestinal disease can occur.&nbsp;Amebic liver abscess&nbsp;is the most common manifestation of invasive amebiasis.</p>\n<ul>\n<li>E histolytica&nbsp;is transmitted via ingestion of the cystic form (infective stage) of the protozoa (fecal- oral route)</li>\n<li>Excystation then occurs in the terminal ileum or colon, resulting in trophozoites (invasive form)</li>\n<li>The trophozoites can penetrate and invade the colonic mucosal barrier, leading to tissue destruction, secretory bloody diarrhea, and colitis resembling&nbsp;inflammatory bowel disease.</li>\n<li>In addition, the trophozoites can spread hematogenously via the portal circulation to the liver or even to more distant organs</li>\n<li>E histolytica&nbsp;is capable of causing a spectrum of illnesses. Intestinal conditions resulting from&nbsp;<em>E histolytica</em>&nbsp;infection include the following:\n<ul>\n<li>Asymptomatic infection</li>\n<li>Symptomatic noninvasive infection</li>\n<li>Acute proctocolitis (dysentery)</li>\n<li>Fulminant colitis with perforation</li>\n<li>Toxic megacolon</li>\n<li>Chronic nondysenteric colitis</li>\n<li>Ameboma</li>\n<li>Perianal ulceration</li>\n</ul>\n</li>\n</ul>\n<p>Extraintestinal conditions resulting from&nbsp;E histolytica&nbsp;infection include the following:</p>\n<ul>\n<li>Liver abscess</li>\n<li>Pleuropulmonary disease</li>\n<li>Peritonitis</li>\n<li>Pericarditis</li>\n<li>Brain abscess</li>\n<li>Genitourinary disease</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "KOH preparation of foot lesion shows the presence of the fungus as round or irregular, dark brown and yeast like body with septae. Diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Chromoblastomycosis"
      },
      {
        "id": 2,
        "text": "Pityrosporum"
      },
      {
        "id": 3,
        "text": "Chlamydospores"
      },
      {
        "id": 4,
        "text": "Candida"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Chromoblastomycosis or verrucous dermatitis:</strong></p>\n<ul>\n<li>Warty cutaneous wart resembles the florets of cauliflower.</li>\n<li>The disease is usually confined to subcutaneous tissue of feet and lower legs.</li>\n<li>The most common fungi responsible are Fonsecaea.</li>\n<li>Diagnosis can be established by demonstration of round or irregular, dark brown and yeast like body with septae (Sclerotic body) in KOH mounts or in sections and by culture on Sabouraud&rsquo;s agar.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/984e510649ee46bc9f7549495d425d43.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The most common primary Immunodeficiency is:",
    "choices": [
      {
        "id": 1,
        "text": "Common variable immunodeficiency"
      },
      {
        "id": 2,
        "text": "Isolated IgA immunodeficiency"
      },
      {
        "id": 3,
        "text": "Wiskott- Aldrich syndrome"
      },
      {
        "id": 4,
        "text": "AIDS"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most common primary immunodeficiency is Isolated IgA immunodeficiency.</p>\n<p><strong>Selective IgA deficiency:- </strong></p>\n<ul>\n<li>Recurrent respiratory and genitourinary tract infections resulting from lack of secreted IgA on mucosal surfaces are common.</li>\n<li>Problems such as intestinal malabsorption, allergic disease, and autoimmune disorders may also be associated with low IgA levels.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Satellite papules are characteristic of following type of leprosy:-",
    "choices": [
      {
        "id": 1,
        "text": "Borderline tuberculoid (BT)"
      },
      {
        "id": 2,
        "text": "Polar tuberculoid (TT)"
      },
      {
        "id": 3,
        "text": "Borderline lepromatous (BL)"
      },
      {
        "id": 4,
        "text": "Polar lepromatous (LL)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Borderline tuberculoid leprosy:-</strong></p>\n<ul>\n<li>Borderline tuberculoid leprosy&nbsp;patients have anesthetic discrete plaques similar to those in tuberculoid leprosy. However, there are multiple lesions, usually more than five and fewer than 10. Lesions are larger, less well defined, and often contain satellite papules.</li>\n<li>Several peripheral nerve trunks are asymmetrically enlarged and neuropathy often results</li>\n<li>This form of leprosy may remain at this stage or can regress to the tuberculoid form; or it can progress to lepromatous form.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 15 year old girl was admitted to the infectious disease hospital with a provisional diagnosis of rabies. The most suitable clinical sample that can confirm the ante mortem diagnosis:-",
    "choices": [
      {
        "id": 1,
        "text": "Serum for antirabies IgG antibody"
      },
      {
        "id": 2,
        "text": "Skin biopsy specimen"
      },
      {
        "id": 3,
        "text": "CSF sample for viral culture"
      },
      {
        "id": 4,
        "text": "Giemsa stain on smear prepared from salivary secretions"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Rabies virus antigen can be detected in this girl in frozen sections of skin biopsies by the fluorescent antibody test.&nbsp;Skin biopsy specimen are examined for rabies antigen in the cutaneous nerves at the base of hair follicles.This is preferred over corneal impressions.</p>\n<p>However, RT-PCR is the available most sensitive assay for the diagnosis of rabies which can be detected in the saliva, skin.</p>\n<p><strong>Postmortem diagnosis of rabies includes:-</strong></p>\n<ul>\n<li>Demonstration of rabies virus antigen by immunofluorescence. Examination of salivary glands by immunofluorescence is useful.&nbsp;</li>\n<li>Demonstration of inclusion bodies (Negri bodies): finding of Negri bodies in the brain or the spinal cord</li>\n<li>Isolation of the rabies virus</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Capsular polysaccharide constitutes an important virulence factor responsible for protective antibody response. In which among the following bacteria is the protective response not due to capsular polysaccharide?",
    "choices": [
      {
        "id": 1,
        "text": "Haemophilus influenza"
      },
      {
        "id": 2,
        "text": "Streptococcus pneumoniae"
      },
      {
        "id": 3,
        "text": "Neisseria meningitidis"
      },
      {
        "id": 4,
        "text": "Bordetella pertussis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the given bacteria, the protective response in Bordetella pertussis is not due to capsular polysaccharides.</p>\n<p>Bordetella pertussis is a\u00a0<strong>gram-negative coccobacillus</strong>.\u00a0It produces various virulence factors and toxins that are responsible for the clinical disease.</p>\n<ul>\n<li><strong>Pertussis toxin</strong>\u00a0causes lymphocytosis, sensitization to histamine, and enhanced insulin secretion. It can be toxoided and the toxoid form is a major component of acellular pertusis vaccines.\u00a0</li>\n<li><strong>Filamentous hemagglutinin(FHA)</strong> promotes adherence of the B.pertussis to the cilia of respiratory tract and erythrocytes. It also has a hemagglutinin activity.\u00a0</li>\n<li><strong>Pertactin</strong> is an outer membrane protein (OMP) antigen present in all virulent strains. It is part of acellular pertusis vaccines and antibody to pertactin is seen in blood after immunization or infection in children</li>\n<li><strong>Tracheal cytotoxin</strong> causes destruction of the ciliated cells in the trachea.\u00a0</li>\n<li>Other virulence factors- Includes <strong>Adenylate cyclase, heat-labile toxin, lipopolysaccharide</strong>.</li>\n</ul>\n<p><strong>Capsulated bacteria include:-</strong></p>\n<ul>\n<li>Streptococcus pneumoniae</li>\n<li>Several groups of streptococci</li>\n<li>Neisseria meningitides</li>\n<li>Klebsiella</li>\n<li>Haemophilus influenza</li>\n<li>Yersinia</li>\n<li>Bacillus</li>\n</ul>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Latex agglutination study of the antigen in CSF helps in the diagnosis of:-",
    "choices": [
      {
        "id": 1,
        "text": "Cryptococcus"
      },
      {
        "id": 2,
        "text": "Candiasis"
      },
      {
        "id": 3,
        "text": "Aspergillosis"
      },
      {
        "id": 4,
        "text": "Histoplasmosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Cryptococcal capsular polysaccharide antigen can be detected in CSF and blood by latex agglutination and ELISA test</li>\n<li>Latex agglutination tests (latex fixation tests) are widely employed for the detection of antistreptolysin O(ASO), C-reactive protein (CRP), RA factor, human chorionic gonadotropin (HCG) and many other antigens.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient following use of contact lens, developed corneal ulcers and symptoms of conjunctivitis. Saline mount preparation of corneal scrapping shows polygonal cyst. What should be the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Acanthamoeba"
      },
      {
        "id": 2,
        "text": "Nagleria"
      },
      {
        "id": 3,
        "text": "Entamoeba"
      },
      {
        "id": 4,
        "text": "Giardia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The diagnosis in this case is acanthamoeba keratitis.</p>\n<p><strong>Acanthamoeba:</strong></p>\n<p>The life cycle consists of 2 stages: A trophozoite (which is 14-40 &micro;m in diameter) and a cyst (which has a double-layered wall with a diameter of 12-16 &micro;m). Cysts are quite resistant to environmental and chemical insults.</p>\n<p>This genus causes 3 clinical syndromes:</p>\n<ul>\n<li>Granulomatous amebic encephalitis (GAE)</li>\n<li>Disseminated granulomatous amebic disease (eg, skin, sinus, and pulmonary infections)</li>\n<li>Amebic ocular&nbsp;keratitis</li>\n</ul>\n<p>Acanthamoeba keratitis is a sight-threatening infection secondary to contamination of contact lenses. Patients with contact lenses should be warned of exposure to water containing ubiquitous&nbsp;Acanthamoeba&nbsp;cysts, especially by swimming, showering, and using homemade lens-cleaning solutions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which one of the following is a Gram negative fusiform gliding bacillus?",
    "choices": [
      {
        "id": 1,
        "text": "Eikinella"
      },
      {
        "id": 2,
        "text": "Capnocytophaga"
      },
      {
        "id": 3,
        "text": "Kingella"
      },
      {
        "id": 4,
        "text": "Moraxella"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Capnocytophaga are fusiform or filamentous gram negative coccobacilli.</p>\n<p>They are part of human oral flora, occasionally cause <strong>periodontal disease</strong> and sepsis in immunocompromised hosts.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Fungus colonizes in pre-existing pulmonary cavities such as in tuberculosis or cystic disease. The fungus grows into large balls. Microscopic examination shows as in figure. Diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Aspergillus"
      },
      {
        "id": 2,
        "text": "Rhizopus"
      },
      {
        "id": 3,
        "text": "Penicillia"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Diseases caused by Aspergillus:</strong></p>\n<ul>\n<li>Pulmonary aspergillosis (Aspergillus asthma, Bronchopulmonary aspergillosis and Aspergilloma)</li>\n<li>Disseminated aspergillosis</li>\n</ul>\n<p><strong>Microscopic examination:</strong></p>\n<ul>\n<li>Aspergillus has septate hyphae. Asexual conidia are arranged in chains, carried on elongated cells called sterigmata, borne on the expanded ends of conidiophores.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d7c8f750dd924dc9acb68febd190eb60.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Microbiology St 3 (From Q-Bank)';
        const quizFilename = 'microbiology-st-3-from-q-bank-a4922999.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2017 - 18"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>