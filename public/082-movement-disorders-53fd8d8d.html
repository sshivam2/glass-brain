<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>082 Movement Disorders - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">32</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following diseases primarily involves the marked structure?",
    "choices": [
      {
        "id": 1,
        "text": "Paralysis agitans"
      },
      {
        "id": 2,
        "text": "Depression"
      },
      {
        "id": 3,
        "text": "Alzheimers"
      },
      {
        "id": 4,
        "text": "Huntington chorea"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked in this transverse section of the brain at the level of superior colliculus is <strong>substantia nigra</strong>. Degeneration of substantia nigra is seen in <strong>Parkinson's disease</strong>, also known as <strong>paralysis agitans</strong>.</p>\n<p><strong>Substantia nigra</strong> is pigmented due to the presence of <strong>neuromelanin</strong> granules, which help in the synthesis of <strong>dopamine</strong>. In Parkinson's disease, there is an <strong>absence/reduced pigmentation</strong> of the substantia nigra.</p>\n<p><strong>Bradykinesia, rigidity</strong>, and <strong>resting tremor</strong> are classic features of Parkinson's disease. Because of motor disability, it is also referred to as paralysis agitans.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Depression</strong> is often a comorbid finding with Parkinson's disease, but is <strong>not</strong> due to damage to the substantia nigra.</p>\n<p>Option C: <strong>Alzheimer&rsquo;s disease</strong> is the most common cause of dementia. It is due to atrophy of the entorhinal cortex, located in the <strong>medial temporal lobe</strong>.</p>\n<p>Option D: <strong>Huntington&rsquo;s chorea</strong> is an autosomal dominant disorder of movement and cognition primarily involving the <strong>striatum</strong> (caudate nucleus and putamen).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/71be37076f91458cbdb3a43fada1746f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f813fbb8ee5461a8455492a12746f77x600x906.JPEG"
    ]
  },
  {
    "text": "What is the most common gene mutation seen in patients with familial Parkinson's disease?",
    "choices": [
      {
        "id": 1,
        "text": "Leucine-rich repeat kinase 2"
      },
      {
        "id": 2,
        "text": "Parkin"
      },
      {
        "id": 3,
        "text": "Alpha-synuclein gene missense mutation"
      },
      {
        "id": 4,
        "text": "PTEN-induced putative kinase 1"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most common form of monogenic familial PD is <strong>PARK8</strong>, caused by mutations in the leucine-rich repeat kinase-2 (<strong>LRRK2</strong>) <strong>gene</strong>.</p>\n<p><strong>Familial</strong> forms of <strong>parkinsonism</strong> (designated PARK1 through PARK13) have been associated with causative mutations in a number of nuclear genes. A few of these are:</p>\n<ul>\n<li>The&nbsp;<em>LRRK2</em> gene mutation&nbsp;causes autosomal dominant PD (<strong>PARK8</strong>). In this condition, Middle to late-onset PD is seen, which resembles typical PD and is responsive to levodopa.</li>\n<li>Mutations in alpha-synuclein (<strong>PARK 1 and PARK4)</strong>&nbsp;cause rare forms of familial PD and constitute the major component of Lewy bodies in sporadic PD.</li>\n<li>Parkin-associated PD <strong>(PARK 2)</strong> &amp;&nbsp;PINK1-associated PD <strong>(PARK6)</strong> are autosomal recessive seen in young-onset PD.</li>\n<li>Mutation in the glucocerebrosidase gene <strong>(<em>GBA</em>) gene</strong> of Gauchers represents the most <strong>important risk factor</strong> for the development of Parkinson's disease. Patients with PD who are GBA mutation carriers have a younger age at onset.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following features would you not expect to see in patients with Parkinson\u2019s disease?",
    "choices": [
      {
        "id": 1,
        "text": "Genitourinary disturbances"
      },
      {
        "id": 2,
        "text": "Orthostatic hypotension"
      },
      {
        "id": 3,
        "text": "Exaggerated deep tendon reflexes"
      },
      {
        "id": 4,
        "text": "Micrographia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Exaggerated deep tendon reflexes are not a feature of Parkinson's disease. Cardinal motor features in PD include:</p>\n<ul>\n<li>Resting tremors</li>\n<li>Bradykinesia</li>\n<li>Rigidity</li>\n<li>Gait disturbance / postural instability</li>\n</ul>\n<p>Mnemonic: TRAP - <strong>T</strong>remors + <strong>R</strong>igidity + <strong>A</strong>kinesia + <strong>P</strong>ostural instability</p>\n<ul>\n<li>Other motor features include:\n<ul>\n<li>Micrographia</li>\n<li>Masked facies (hypomimia)</li>\n<li>Reduced eye blinking</li>\n<li>Soft voice (hypophonia)</li>\n<li>Dysphagia</li>\n</ul>\n</li>\n<li>Non-motor features are:\n<ul>\n<li>Anosmia</li>\n<li>Sensory disturbance (pain)</li>\n<li>Mood Disorders (depression)</li>\n<li>Sleep disturbances (rapid eye movement behavior disorder)</li>\n<li>Autonomic:\n<ul>\n<li>GI disturbances</li>\n<li>Genitourinary disturbances</li>\n<li>Sexual dysfunction</li>\n<li>Orthostatic hypotension</li>\n</ul>\n</li>\n<li>Cognitive impairment</li>\n</ul>\n</li>\n</ul>\n<p>Parkinson&rsquo;s disease(PD)<strong>&nbsp;</strong>is the second most common neurodegenerative disorder after Alzheimer's disease.&nbsp;<strong>UK Brain Bank criteria</strong> is used for the diagnosis of PD.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 66-year-old man presents with complaints of resting tremor in his right hand, which improves with movement. He also says that he has difficulty initiating movements and his wife says his movements have been slow. On examination, rigidity is observed to passive arm movement and shuffling gait with a stooped posture is noticed.  Which of the following statements is false regarding the pathology of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Substantia nigra pars reticulata is unaffected by the disease process"
      },
      {
        "id": 2,
        "text": "Decreased striatal dopamine is seen in this condition"
      },
      {
        "id": 3,
        "text": "Degeneration of dopaminergic neurons in the substantia nigra pars compacta"
      },
      {
        "id": 4,
        "text": "Lewy bodies which containing degenerated tau protein are seen"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>Parkinson's disease </strong>and<strong> Lewy bodies</strong>&nbsp;seen in Parkinson's disease do not contain tau protein. They contain the protein <strong>&alpha;-synuclein.</strong></p>\n<p>Pathologic hallmarks of Parkinson's disease include:</p>\n<ul>\n<li>Degeneration of dopaminergic neurons in the <strong>substantia nigra pars compacta&nbsp;</strong>(SNc)</li>\n<li>Reduced striatal dopamine</li>\n<li>Intracytoplasmic proteinaceous inclusions called <strong>Lewy bodies,</strong> which contain the protein <strong>&alpha;-synuclein</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with Parkinson's disease says that he cannot even hold a coffee mug properly due to tremors. What is the frequency of the tremors likely to be?",
    "choices": [
      {
        "id": 1,
        "text": "4\u20136"
      },
      {
        "id": 2,
        "text": "8\u201310"
      },
      {
        "id": 3,
        "text": "10\u201312"
      },
      {
        "id": 4,
        "text": "6-10"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The frequency of <strong>resting tremors</strong> in <strong>Parkinson&rsquo;s disease</strong> is&nbsp;<strong>4&ndash;6</strong> Hz.</p>\n<p>More than 70 percent of patients with Parkinson's disease have tremors as the presenting feature. The classic parkinsonian tremor begins as a low-frequency, pill-rolling motion of the fingers, progressing to forearm pronation/supination and elbow flexion/extension.&nbsp;Other features of the tremors are:</p>\n<ul>\n<li>Typically asymmetric</li>\n<li>Occurs at rest</li>\n<li>Becomes less prominent with voluntary movement</li>\n</ul>\n<p>Frequency of various types of tremors: Physiological tremor (12 Hz ) &gt; Essential tremor (8&ndash;10 Hz) &gt; Resting tremor in PD (4&ndash;6 Hz ).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most common psychiatric disturbance seen in patients with Parkinson's disease?",
    "choices": [
      {
        "id": 1,
        "text": "Anxiety"
      },
      {
        "id": 2,
        "text": "Depression"
      },
      {
        "id": 3,
        "text": "Abulia"
      },
      {
        "id": 4,
        "text": "Visual hallucination"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>most common psychiatric disturbance</strong> seen in <strong>Parkinson's disease</strong> is <strong>depression</strong>.</p>\n<p>The non-motor symptoms seen in Parkinson's disease include:</p>\n<ul>\n<li>Cognitive dysfunction and <strong>subcortical dementia</strong></li>\n<li><strong>Psychosis </strong>and<strong> hallucinations</strong> - Visual hallucinations are the most common psychotic symptom</li>\n<li>Mood disorders:\n<ul>\n<li>Depression -&nbsp;most common psychiatric disturbance</li>\n<li>Anxiety -&nbsp;second most common psychiatric disturbance&nbsp;</li>\n<li>Abulia/apathy</li>\n</ul>\n</li>\n<li>Sleep disorders - <strong>insomnia</strong>, daytime sleepiness with sleep attacks, <strong>restless leg syndrome</strong></li>\n<li><strong>Autonomic dysfunction</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not an example of secondary parkinsonism?",
    "choices": [
      {
        "id": 1,
        "text": "Corticobasal syndrome"
      },
      {
        "id": 2,
        "text": "Dementia pugilistica"
      },
      {
        "id": 3,
        "text": "Post-encephalitic PD"
      },
      {
        "id": 4,
        "text": "Drug-induced Parkinsonism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Corticobasal syndrome</strong> is not an example of&nbsp;secondary parkinsonism. It s a type of <strong>Parkinson's plus syndrome</strong>.</p>\n<p>Causes of secondary Parkinsonism include:</p>\n<ul>\n<li>Repeated head trauma&mdash;<strong>dementia pugilistica</strong></li>\n<li><strong>Drug-induced</strong></li>\n<li>Tumor</li>\n<li><strong>Post-encephalitic PD</strong></li>\n<li>Toxins: manganese, MPTP, carbon monoxide, cyanide</li>\n<li>Vascular</li>\n<li>Liver failure</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most common cause of secondary parkinsonism?",
    "choices": [
      {
        "id": 1,
        "text": "Infection"
      },
      {
        "id": 2,
        "text": "Vascular"
      },
      {
        "id": 3,
        "text": "Neuroleptics"
      },
      {
        "id": 4,
        "text": "Trauma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Dopamine-blocking agents such as <strong>neuroleptics </strong>are the <strong>most</strong>&nbsp;<strong>common </strong>cause of<strong> secondary parkinsonism.</strong></p>\n<p>Causes of secondary Parkinsonism include:</p>\n<ul>\n<li>Repeated head trauma&mdash;dementia pugilistica</li>\n<li>Drug-induced</li>\n<li>Tumor</li>\n<li>Post-encephalitic PD</li>\n<li>Toxins: manganese, MPTP, carbon monoxide, cyanide</li>\n<li>Vascular</li>\n<li>Liver failure</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presented to the OPD with a shuffling gait,  slowed movements and speech,  and cogwheeling. He was started on a new drug recently. Which of the following drugs cannot cause this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Metoclopramide"
      },
      {
        "id": 2,
        "text": "Bezatropine"
      },
      {
        "id": 3,
        "text": "\u03b1-Methyldopa"
      },
      {
        "id": 4,
        "text": "Tetrabenazine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of <strong>secondary parkinsonism</strong>.&nbsp;<strong>Bezatropine</strong>, also known as benztropine, is used in the<strong> treatment of parkinsonism</strong>.&nbsp;It does not cause secondary parkinsonism.&nbsp;</p>\n<p>Benztropine is a centrally acting anticholinergic.&nbsp;It has been used for controlling tremors in drug-induced Parkinson's. Side effects include urinary dysfunction, glaucoma, and cognitive impairment.</p>\n<p>Drugs causing secondary parkinsonism:</p>\n<ul>\n<li>Neuroleptics (typical antipsychotics)</li>\n<li><strong>Metoclopramide</strong>, chlorpromazine</li>\n<li>Dopamine depleting agents (reserpine, tetrabenazine)</li>\n<li>Calcium channel blocker: Flunnarizine, Cinnarizine</li>\n<li>Lithium carbonate, amiodarone,&nbsp;<strong>&alpha;-Methyldopa</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a peripheral decarboxylase inhibitor?",
    "choices": [
      {
        "id": 1,
        "text": "Benserazide"
      },
      {
        "id": 2,
        "text": "Benztropine"
      },
      {
        "id": 3,
        "text": "Tetrabenazine"
      },
      {
        "id": 4,
        "text": "Trihexyphenidyl"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Benserazide</strong> is a peripheral decarboxylase inhibitor.</p>\n<p>Options B &amp; D: Benztropine and trihexyphenidyl are centrally acting anticholinergic agents.</p>\n<p>Option C: Tetrabenazine is a dopamine depleting agent. It causes drug-induced Parkinsonism.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 68-year-old woman presents to the casualty after she tripped over a stone. She has been having trouble sleeping and abdominal discomfort. Her daughter said that she has become forgetful and her movements are very slow. She is diagnosed with Parkinson's disease. Which of her symptoms will be relieved by treatment with levodopa?",
    "choices": [
      {
        "id": 1,
        "text": "Forgetfulness"
      },
      {
        "id": 2,
        "text": "Trouble sleeping"
      },
      {
        "id": 3,
        "text": "Abdominal discomfort"
      },
      {
        "id": 4,
        "text": "Slow movements"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Levodopa is useful in alleviating the <strong>bradykinesia&nbsp;</strong>(slow movement) seen in Parkinson's disease.</p>\n<table border=\"1\">\n<tbody>\n<tr>\n<td colspan=\"2\" width=\"301\">\n<p><strong>Levodopa in Parkinson's disease</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"301\">\n<p>Levodopa benefits</p>\n</td>\n<td width=\"301\">\n<p>Classic motor symptoms of Parkinson's disease:</p>\n<ul>\n<li>Bradykinesia</li>\n<li>Rigidity</li>\n<li>Tremor</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td width=\"301\">\n<p>Levodopa does<strong> not</strong> benefit</p>\n</td>\n<td width=\"301\">\n<p>Non-dopaminergic features:</p>\n<ul>\n<li>Freezing</li>\n<li>Falling</li>\n<li>Sleep disorders</li>\n<li>Dementia</li>\n<li>Autonomic dysfunction (GI disturbances, orthostatic hypotension etc.)</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a non-ergot dopamine agonist?",
    "choices": [
      {
        "id": 1,
        "text": "Bromocriptine"
      },
      {
        "id": 2,
        "text": "Apomorphine"
      },
      {
        "id": 3,
        "text": "Cabergoline"
      },
      {
        "id": 4,
        "text": "Pergoilde"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Apomorphine</strong> is a non-ergot dopamine agonist.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 75-year-old patient presents with an inability to move and speak. He has been experiencing increasing stiffness and slowness from the past 1 hour. He has an 8-year history of Parkinson's disease and takes his levodopa-carbidopa every day. The last dose was 4 hours back. What drug should be prescribed for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Rasagiline"
      },
      {
        "id": 2,
        "text": "Benztropine"
      },
      {
        "id": 3,
        "text": "Apomorphine"
      },
      {
        "id": 4,
        "text": "Selegillene"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical features of the patient are suggestive of a <strong>severe 'off' episode</strong>. The <strong>rescue agent</strong> for the treatment of severe 'off' episodes is <strong>apomorphine</strong>.</p>\n<p>Levodopa-induced motor complications consist of fluctuations in motor response ('on' episodes when the drug is working and 'off' episodes when parkinsonian features return) and involuntary movements are known as dyskinesias which typically complicate 'on' periods.</p>\n<p>Apomorphine is&nbsp;a <strong>non-ergot dopamine agonist</strong>. It has efficacy comparable to levodopa, but it must be administered parenterally (intravenous or subcutaneous) and has a very short half-life and duration of activity (45 min).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs has disease-modifying action in Parkinson's disease?",
    "choices": [
      {
        "id": 1,
        "text": "Levodopa"
      },
      {
        "id": 2,
        "text": "Carbidopa"
      },
      {
        "id": 3,
        "text": "Apomorphine"
      },
      {
        "id": 4,
        "text": "Selegiline"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Selegiline</strong> is a monoamine oxidase B&nbsp;(<strong>MAO-B</strong>)<strong>&nbsp;inhibitor</strong> known to have some <strong>disease-modifying</strong> action in <strong>Parkinson's disease</strong>. Studies have&nbsp;shown that selegiline significantly delayed the time until the emergence of disability necessitating the introduction of levodopa in untreated PD patients.&nbsp;</p>\n<p>MAO-B inhibitors include:</p>\n<ul>\n<li>Selegiline</li>\n<li>Rasagiline (more potent)</li>\n</ul>\n<p><strong>Cheese effect</strong>: inhibition of MAO-A isoform prevents the metabolism of tyramine in the gut, leading to a potentially fatal hypertensive reaction called the 'cheese effect'. It can be precipitated by tyramine-rich foods such as cheese, aged meat, and red wine.</p>\n<p>Selegiline and rasagiline do not functionally inhibit MAO-A isoform and are not associated with cheese effect in doses typically used in clinical practice.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements regarding the management of non-motor symptoms in patients with Parkinson's disease is false?",
    "choices": [
      {
        "id": 1,
        "text": "Depression should not be treated with antidepressants"
      },
      {
        "id": 2,
        "text": "Restless leg syndrome is treated by dopamine agonists"
      },
      {
        "id": 3,
        "text": "Sialorrhea  can be managed by anticholinergics"
      },
      {
        "id": 4,
        "text": "Low doses  of fludrocortisone  or midodrine provide control of autonomic symptoms"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Depression</strong> is treated with selective serotonin reuptake inhibitors (<strong>SSRIs</strong>). In cases of severe depression, other antidepressants are added.</p>\n<table style=\"height: 600px; width: 382px;\" width=\"382\">\n<tbody>\n<tr>\n<td style=\"width: 124.733px;\">Manifestations in Parkinson's\u00a0</td>\n<td style=\"width: 228.667px;\">Treatment</td>\n</tr>\n<tr>\n<td style=\"width: 124.733px;\">Depression\u00a0</td>\n<td style=\"width: 228.667px;\">\n<ul>\n<li><strong>SSRIs</strong></li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 124.733px;\">Insomnia</td>\n<td style=\"width: 228.667px;\">\n<ul>\n<li>Zolpidem</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 124.733px;\">Restless leg syndrome\u00a0</td>\n<td style=\"width: 228.667px;\">\n<ul>\n<li><strong>Gabapentenoids</strong></li>\n<li><strong>Dopamine agonist </strong></li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 124.733px;\">Erectile dysfunction\u00a0</td>\n<td style=\"width: 228.667px;\">\n<ul>\n<li>Sildenafil\u00a0</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 124.733px;\">Postural hypotension\u00a0</td>\n<td style=\"width: 228.667px;\">\n<ul>\n<li>Rehabilitation with postural exercise\u00a0</li>\n<li>Adding salt to the diet and elevating the head of the bed to prevent overnight sodium<br />natriuresis</li>\n<li>Low doses of <strong>fludrocortisone or midodrine</strong></li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 124.733px;\">Sialorrhea</td>\n<td style=\"width: 228.667px;\">\n<ul>\n<li><strong>Anticholinergic</strong></li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All are true about levodopa-induced motor complications except:",
    "choices": [
      {
        "id": 1,
        "text": "More likely to occur in males"
      },
      {
        "id": 2,
        "text": "Seen in younger individuals with severe disease"
      },
      {
        "id": 3,
        "text": "Seen with higher doses of levodopa"
      },
      {
        "id": 4,
        "text": "Rhythmic movements that predominantly involve the lower extremities"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Levodopa-induced motor complications</strong> are more likely to occur in <strong>females</strong>.&nbsp;</p>\n<p>The complications include transient, stereotypic, rhythmic movements that predominantly involve the lower extremities. It is seen in younger individuals with severe disease and also&nbsp;with higher doses of levodopa.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old woman on treatment for Parkinson\u2019s disease is brought to the OPD. Her husband is concerned because she has been shopping a lot and reached the maximum spending limit on 2 credit cards in the past week. She has also impulsively been buying several rabbits and raising them in their home. She admits feeling guilty after her purchases. Which of the following drugs is associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Dopamine precursors"
      },
      {
        "id": 2,
        "text": "Dopamine agonists"
      },
      {
        "id": 3,
        "text": "Dopamine depletors"
      },
      {
        "id": 4,
        "text": "Dopamine antagonists"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of <strong>compulsive shopping</strong>. Pathological gambling, hypersexuality, and compulsive eating and shopping are the adverse effects of <strong>dopamine agonists</strong>. Levodopa can also cause these effects, but to a lesser extent than dopamine agonists.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with Parkinson's disease has been scheduled to undergo deep brain stimulation. What is the target site for this procedure?",
    "choices": [
      {
        "id": 1,
        "text": "Subthalamic nucleus and globus pallidus internus"
      },
      {
        "id": 2,
        "text": "Subthalamic nucleus and globus pallidus externus"
      },
      {
        "id": 3,
        "text": "Substantia nigra pars compacta and globus pallidus externus"
      },
      {
        "id": 4,
        "text": "Substantia nigra pars reticulata and globus pallidus internus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The target site for <strong>deep brain stimulation</strong> in <strong>Parkinson&rsquo;s disease</strong> is the <strong>subthalamic nucleus (STN)</strong> and <strong>globus pallidus internus (GPi).</strong></p>\n<p>It helps improve tremors and reduce both 'off' time and dyskinesia. It does not improve features that fail to respond to levodopa. It does not prevent the development or progression of non-dopaminergic features such as freezing, falling, and dementia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an example of Parkinson's plus syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Progressive supranuclear palsy"
      },
      {
        "id": 2,
        "text": "Dementia pugilistica"
      },
      {
        "id": 3,
        "text": "Post-encephalitic PD"
      },
      {
        "id": 4,
        "text": "Drug-induced Parkinsonism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Progressive supranuclear palsy</strong> is an example of <strong>Parkinson's plus syndrome</strong>.&nbsp;</p>\n<p>Parkinson's plus syndrome or <strong>atypical parkinsonism</strong> refers to a group of conditions that present with parkinsonism (rigidity and bradykinesia) but are different from PD due to underlying differences in clinical manifestations and pathology. They may have&nbsp;degeneration of the striatum, globus pallidus, cerebellum, and brainstem as well as the SNc. These include multiple system atrophy (MSA), progressive supranuclear palsy (PSP), and corticobasal syndrome (CBS).</p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;PSP is often misdiagnosed as Parkinson&rsquo;s disease (PD). The substantia nigra is damaged in both diseases and this accounts for the overlapping symptoms which are observed, particularly in the initial stages. In PSP, impairment of cognitive functions occurs before the motor or ocular signs and this serves as an important distinguishing feature.&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:829,&quot;3&quot;:{&quot;1&quot;:0},&quot;5&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;6&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;7&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;8&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;11&quot;:4,&quot;12&quot;:0}\">PSP is often misdiagnosed as Parkinson&rsquo;s disease (PD). The substantia nigra is damaged in both diseases and this accounts for the overlapping symptoms which are observed.&nbsp; In PSP, impairment of cognitive functions occurs before the motor or ocular signs and this serves as an important distinguishing feature.</span></p>\n<p>Immunohistochemistry broadly classifies them into two subtypes: <strong>synucleopathies </strong>and<strong> tauopathies</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following features is not expected in a patient with atypical parkinsonism?",
    "choices": [
      {
        "id": 1,
        "text": "Late speech and gait impairment"
      },
      {
        "id": 2,
        "text": "Absence of rest tremor"
      },
      {
        "id": 3,
        "text": "Poor or no response to levodopa"
      },
      {
        "id": 4,
        "text": "No motor asymmetry"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Early speech</strong> and <strong>gait impairment</strong> are seen in <strong>atypical parkinsonism</strong>.</p>\n<p>Features of atypical parkinsonism include:</p>\n<ul>\n<li>Early speech and gait impairment</li>\n<li><strong>Absence of rest tremor</strong></li>\n<li><strong>No motor asymmetry</strong></li>\n<li><strong>Poor or no response to levodopa</strong></li>\n<li>Aggressive clinical course</li>\n<li>Symptoms of severe early autonomic involvement</li>\n<li>Early severe dementia also points towards atypical parkinsonism</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old man presented with Parkinsonism and cerebellar features. MRI showed the finding as shown in the image. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Drug induced parkinsonism"
      },
      {
        "id": 2,
        "text": "Multiple systems atrophy"
      },
      {
        "id": 3,
        "text": "Dementia pugilistica"
      },
      {
        "id": 4,
        "text": "Progressive supranuclear palsy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Parkinsonism, cerebellar features, and the 'hot cross bun' sign on&nbsp;MRI suggest <strong>multiple system atrophy</strong> (MSA).</p>\n<div class=\"page\" title=\"Page 3168\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>MSA manifests as a combination of parkinsonian, cerebellar, and autonomic features. Based on predominant clinical features it is further divided into :</p>\n<ul>\n<li>MSA-P:\n<ul>\n<li>Predominantly parkinsonian features are seen</li>\n<li>T2 weighted MRI demonstrates <strong>hyperintense putaminal rim</strong></li>\n</ul>\n</li>\n<li>MSA-C:\n<ul>\n<li>Predominantly cerebellar features are seen</li>\n<li>MRI shows cerebellar and brainstem atrophy causing <strong>pontine hot cross bun sign</strong></li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a24937c7b9ed4bf1a324b505ba92107a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "All of the following are the core clinical features for the diagnosis of Lewy body dementia except:",
    "choices": [
      {
        "id": 1,
        "text": "Fluctuating cognition"
      },
      {
        "id": 2,
        "text": "Recurrent visual hallucination"
      },
      {
        "id": 3,
        "text": "REM sleep behavior disorder"
      },
      {
        "id": 4,
        "text": "Orthostatic hypotension"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Orthostatic hypotension</strong> is <strong>not</strong> a <strong>core </strong>clinical feature of <strong>Lewy body dementia</strong> (LBD) as per <strong>DSM-5</strong>.</p>\n<p><strong>LBD</strong> also known as dementia with Lewy bodies is the second most type of <strong>progressive dementia</strong> after Alzheimer&rsquo;s disease. <strong>Protein deposits</strong>, called <strong>Lewy bodies</strong>, deposit in <strong>nerve cells</strong> in the <strong>brain</strong> region involved in thinking, memory, and movement (motor control)</p>\n<p><strong>Core features</strong> of LBD as per DSM-5 are <strong>fluctuating cognition</strong>, <strong>attention</strong>, <strong>alertness</strong>, <strong>recurrent visual hallucination,</strong> and <strong>Parkinsonian symptoms</strong>. Suggestive features are REM sleep behavior disorder and severe neuroleptic sensitivity.<br />Orthostatic hypotension, erectile dysfunction, and constipation are other features of LBD.</p>\n<p>Treatment of LBD includes <strong>rivastigmine</strong> and <strong>donepezil</strong> which may improve cognition, and reduce hallucinosis and delusion. <strong>Pimavanserin</strong> may be used to treat <strong>psychosis</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old man presented with Parkinsonian features which is unresponsive to levodopa. MRI image is given below. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Progressive supranuclear palsy"
      },
      {
        "id": 2,
        "text": "Multiple system atrophy type C"
      },
      {
        "id": 3,
        "text": "Hallevorden spatz disease"
      },
      {
        "id": 4,
        "text": "Parkinson's disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;According to a recent imaging study data, the insula and frontal cortex seem to be involved in the development of anxiety in adults with Parkinson's disease.&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:33563519,&quot;3&quot;:{&quot;1&quot;:0},&quot;4&quot;:{&quot;1&quot;:2,&quot;2&quot;:6989903},&quot;5&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;6&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;7&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;8&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;9&quot;:0,&quot;11&quot;:4,&quot;12&quot;:0,&quot;16&quot;:10,&quot;28&quot;:1}\">According to a recent imaging study data, the insula and frontal cortex seem to be involved in the development of anxiety in adults with Parkinson's disease.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3380e875f2444465a4ef96ae52e8c73c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0547b0e825084b15ae58a7245aa70786x510x506.GIF"
    ]
  },
  {
    "text": "An 8-year-old girl exhibits rapid, semi-purposeful, graceful, dance-like, involuntary movements. What is this finding?",
    "choices": [
      {
        "id": 1,
        "text": "Hemiballismus"
      },
      {
        "id": 2,
        "text": "Myoclonus"
      },
      {
        "id": 3,
        "text": "Chorea"
      },
      {
        "id": 4,
        "text": "Athetosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Rapid, semi-purposeful, graceful, dance-like, involuntary movements are seen in\u00a0<strong>chorea</strong>.</p>\n<table style=\"width: 33.6661%;\">\n<tbody>\n<tr>\n<td style=\"width: 100%;\" colspan=\"2\" width=\"102\">\n<p><strong>Hyperkinetic movement disorders:</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 17.0111%;\" width=\"102\">\n<p>Tremor</p>\n</td>\n<td style=\"width: 82.9889%;\" width=\"499\">\n<p>Rhythmic oscillation of a body part due to intermittent muscle contractions</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 17.0111%;\" width=\"102\">\n<p>Dystonia</p>\n</td>\n<td style=\"width: 82.9889%;\" width=\"499\">\n<p>Involuntary, sustained or repeated muscle contractions often associated with twisting movements and abnormal posture</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 17.0111%;\" width=\"102\">\n<p>Athetosis</p>\n</td>\n<td style=\"width: 82.9889%;\" width=\"499\">\n<p>Slow, distal, writhing, involuntary movements with a propensity to affect arms and hands</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 17.0111%;\" width=\"102\">\n<p>Chorea</p>\n</td>\n<td style=\"width: 82.9889%;\" width=\"499\">\n<p>Rapid, semi-purposeful, graceful, dance-like, non patterned, involuntary movements involving distal or proximal muscle groups</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 17.0111%;\" width=\"102\">\n<p>Myoclonus</p>\n</td>\n<td style=\"width: 82.9889%;\" width=\"499\">\n<p>Sudden, brief (&lt;100ms), jerk-like arrhythmic muscle twitches</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 17.0111%;\" width=\"102\">\n<p>Tics</p>\n</td>\n<td style=\"width: 82.9889%;\" width=\"499\">\n<p>Brief, repeated, stereotyped muscle contractions that can often be suppressed for a short time</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Sydenham's chorea (also called St. Vitus's dance) is a type of chorea that is typically seen in childhood (5-15 years)\u00a0with prior exposure to group A streptococcal infection and is thought to be autoimmune in nature. It is characterized by the acute onset of choreiform movements and behavioral disturbances and is self-limiting.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During rounds, you see that a patient diagnosed with stroke exhibits wild, flinging movements on his right side. Where is the lesion likely to be?",
    "choices": [
      {
        "id": 1,
        "text": "Caudate nucleus"
      },
      {
        "id": 2,
        "text": "Putamen"
      },
      {
        "id": 3,
        "text": "Subthalamic nucleus"
      },
      {
        "id": 4,
        "text": "Red nucleus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Unilateral wild, flinging movements are called <strong>hemiballismus</strong> and is seen due to a lesion in the <strong>subthalamic nucleus. </strong>The most common cause of hemiballismus is stroke.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most common acute drug-induced movement disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Akathisia"
      },
      {
        "id": 2,
        "text": "Dystonia"
      },
      {
        "id": 3,
        "text": "Tardive Dyskinesia"
      },
      {
        "id": 4,
        "text": "Myoclonus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>most common</strong> acute<strong> drug-induced movement disorder</strong> is&nbsp;<strong>dystonia</strong>.</p>\n<p>Drug-induced movement disorders<strong>&nbsp;</strong>are primarily associated with drugs that block dopamine receptors(neuroleptics) or central dopaminergic transmission. Neuroleptics are the commonest&nbsp;cause of this condition. Drug-induced movement disorders are classified as:</p>\n<ul>\n<li><strong>Acute</strong>: Dystonia is the most common acute hyperkinetic drug reaction; generalized in children, focal in adults.</li>\n<li><strong>Subacute</strong>: Akathisia is the commonest reaction in this category</li>\n<li><strong>Tardive syndromes: </strong>Develop after months to years of initiation of the drug.\n<ul>\n<li>Tardive dyskinesia is the most common. Choreiform movements affecting the mouth, lips, and tongue are seen. In severe cases, trunks, limbs, and respiratory muscles may also be affected.</li>\n<li>In one third, TD remits within 3 months of stopping the drug and improvement occur over several years.</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common movement disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Dystonia"
      },
      {
        "id": 2,
        "text": "Chorea"
      },
      {
        "id": 3,
        "text": "Athetosis"
      },
      {
        "id": 4,
        "text": "Essential tremor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The most common movement disorder is&nbsp;<strong>essential tremor</strong>.</p>\n<p>It can present in childhood but dramatically increases in prevalence over the age of 70 years. Essential tremor is characterized by a high-frequency tremor <strong>6-10 Hz</strong> that&nbsp;predominantly affects the upper extremities.</p>\n<p>The tremor is characteristically<strong> improved by alcohol</strong> and <strong>worsened by stress</strong>.</p>\n<table style=\"height: 100px;\" width=\"306\">\n<tbody>\n<tr>\n<td style=\"width: 145px;\">&nbsp;</td>\n<td style=\"width: 145px;\">Essential tremor</td>\n<td style=\"width: 145px;\">Parkinson's disease</td>\n</tr>\n<tr>\n<td style=\"width: 145px;\">Bradykinesia\uff0c<br />rigidity\uff0c micrographia</td>\n<td style=\"width: 145px;\">Absent</td>\n<td style=\"width: 145px;\">Present</td>\n</tr>\n<tr>\n<td style=\"width: 145px;\">Tremor</td>\n<td style=\"width: 145px;\">Usually postural</td>\n<td style=\"width: 145px;\">Usually resting</td>\n</tr>\n<tr>\n<td style=\"width: 145px;\">Tone</td>\n<td style=\"width: 145px;\">Normal</td>\n<td style=\"width: 145px;\">Cogwheel rigidity</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old man presents with a tremor in both hands that worsens when he is trying to eat or write something. He says that it gets worse when he is stressed and reduces when he drinks wine. His father also had similar symptoms. On examination, there are no resting tremors. Which of the following drugs can be used to control this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Valproate"
      },
      {
        "id": 2,
        "text": "Levetiracetam"
      },
      {
        "id": 3,
        "text": "Primidone"
      },
      {
        "id": 4,
        "text": "Carbamazepine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario is suggestive of <strong>essential tremor</strong>. It&nbsp;can be controlled by <strong>primidone</strong>.</p>\n<p>The drugs used to treat essential tremors are:</p>\n<ul>\n<li>Beta-blockers:&nbsp;propranolol, atenolol</li>\n<li>Anticonvulsants:\n<ul>\n<li>Primidone</li>\n<li>Gabapentine</li>\n<li>Topiramate</li>\n</ul>\n</li>\n</ul>\n<p>In severe and drug-resistant cases, surgical treatment involves targeting the <strong>ventral intermediate (VIM)&nbsp;nucleus of the thalamus</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 70-year-old male patient is scheduled to undergo deep brain stimulation for essential tremor. What is the target site for the procedure?",
    "choices": [
      {
        "id": 1,
        "text": "Subthalamic nucleus and globus pallidus internus"
      },
      {
        "id": 2,
        "text": "Anterior limb of internal capsule"
      },
      {
        "id": 3,
        "text": "Substantia nigra pars compacta"
      },
      {
        "id": 4,
        "text": "Ventral intermediate nucleus of thalamus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The target for <strong>deep brain stimulation</strong> in <strong>essential tremor</strong> is<strong> ventral intermediate </strong>(VIM) nucleus of the thalamus.</p>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align: center;\" width=\"213\">\n<p><strong>Disease</strong></p>\n</td>\n<td style=\"text-align: center;\" width=\"182\">\n<p><strong>Target sites for deep brain stimulation</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"213\">\n<p>Parkinson&rsquo;s disease</p>\n</td>\n<td width=\"182\">\n<p>Subthalamic nucleus (STN)</p>\n<p>Globus pallidus internus (GPi)</p>\n</td>\n</tr>\n<tr>\n<td width=\"213\">\n<p>Dystonia</p>\n</td>\n<td width=\"182\">\n<p>Globus pallidus internus (GPi)</p>\n</td>\n</tr>\n<tr>\n<td width=\"213\">\n<p>Depression</p>\n</td>\n<td width=\"182\">\n<p>Anterior limb of internal capsule and cingulum</p>\n</td>\n</tr>\n<tr>\n<td width=\"213\">\n<p>Obsessive-Compulsive Disorder&nbsp;(OCD)</p>\n</td>\n<td width=\"182\">\n<p>Anterior limb of the internal capsule</p>\n</td>\n</tr>\n<tr>\n<td width=\"213\">\n<p>Essential tremor</p>\n</td>\n<td width=\"182\">\n<p>Ventral intermediate (VIM) nucleus</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with a family history of Huntington's disease has come for genetic counselling. All of the following are true about this condition, except:",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal dominant inheritance"
      },
      {
        "id": 2,
        "text": "Trinucleotide repeat of CAG sequence"
      },
      {
        "id": 3,
        "text": "Westphal akinetic variant has good prognosis"
      },
      {
        "id": 4,
        "text": "Early onset cognitive impairment seen"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>MRI showing&nbsp;atrophy of caudate and putamen</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f3cd4fcd53c84a809407548d00b8c999x1280x1575.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94daa957c157440d9216e91069083745x1280x1576.JPEG"
    ]
  },
  {
    "text": "St. Vitus' dance is the other name for which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Huntigton's chorea"
      },
      {
        "id": 2,
        "text": "Sydenham's chorea"
      },
      {
        "id": 3,
        "text": "Athetosis"
      },
      {
        "id": 4,
        "text": "Hemibalismus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Sydenham's chorea</strong> was originally called St. Vitus's dance.</p>\n<p>Sydenham's chorea is more common in females. It is typically seen in childhood (5-1 5 years)&nbsp;with prior exposure to group A streptococcal infection and is thought to be autoimmune in nature.</p>\n<p>It is characterized by the acute onset of choreiform movements and behavioral disturbances.</p>\n<p>It is self limited.Treatment is generally restricted to those with severe chorea.The chorea generally responds to dopamine-blocking agents, valproic acid, and carbamazepine.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following features can be seen in patients with restless leg syndrome, except:",
    "choices": [
      {
        "id": 1,
        "text": "Symptoms worsen during the evening or night"
      },
      {
        "id": 2,
        "text": "Accompanied by an unpleasant sensation in the legs"
      },
      {
        "id": 3,
        "text": "Symptoms that begin or worsen with activity"
      },
      {
        "id": 4,
        "text": "Partial or complete relief by movement"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In restless leg syndrome (RLS), <strong>symptoms begin</strong> or worsen with <strong>rest</strong>. It is also called as Willis-Ekbom disease.</p>\n<p>The four core symptoms required for the diagnosis of RLS are:</p>\n<ul>\n<li>An urge to move the legs</li>\n<li>Usually caused or accompanied by an <strong>unpleasant sensation</strong> in the legs (creepy-crawly feeling, paresthesia, or burning)</li>\n<li>Symptoms that begin or worsen with rest and partial or complete <strong>relief by movement</strong></li>\n<li>Worsening during the evening or night</li>\n</ul>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Restless leg syndrome is a typical&nbsp;<strong>sensory-motor disorder</strong>&nbsp;that generally affects the legs during rest periods, especially sleep. There is an&nbsp;<strong>irresistible urge</strong>&nbsp;to<strong>&nbsp;shake</strong>&nbsp;the<strong>&nbsp;legs</strong>&nbsp;associated with&nbsp;<strong>burning sensation, itching,</strong>&nbsp;and&nbsp;<strong>cramps</strong>&nbsp;of the legs. In idiopathic cases, dopaminergic hypofunction is postulated.</p>\n<p>In patients with restless legs syndrome,<strong>&nbsp;iron stores</strong>&nbsp;are initially repleted, and the aggravating factors are eliminated. If RLS still persists, initial therapy with a&nbsp;<strong>gabapentinoid</strong>&nbsp;(pregabalin, gabapentin, gabapentin enacarbil) is preferred, rather than a dopamine agonist (pramipexole, ropinirole, rotigotine). This is due to the high frequency of intermediate and long-term augmentation with dopamine agonists, as well as their risk of impulse control disorders.</p>\n<p><strong>FDA-approved</strong>&nbsp;drugs for the&nbsp;<strong>treatment</strong>&nbsp;of restless leg syndrome:&nbsp;</p>\n<ul>\n<li>Gabapentin</li>\n<li>Ropinirole</li>\n<li>Pramipexole</li>\n<li>Rotigotine&nbsp;</li>\n</ul>\n<p>A dopamine agonist is used as an alternative in patients with increased risk for side effects from gabapentinoids, such as those with obesity and its complications, a past or present history of moderate to severe depression, a disorder causing gait instability or respiratory failure, and a history of substance use disorder.</p>\n</div>\n</div>\n<p>Non-pharmacological treatments that can be used in restless leg syndrome are:</p>\n<ul>\n<li>Avoiding alcohol at bedtime</li>\n<li>Massaging affected legs</li>\n<li>Hot baths</li>\n<li>Applying hot or cold to the affected area</li>\n<li>Engaging in moderate exercises</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '082 Movement Disorders';
        let hierarchy = ["Marrow", "qBank", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>