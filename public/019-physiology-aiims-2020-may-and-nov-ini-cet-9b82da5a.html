<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>019 Physiology Aiims 2020 (May And Nov Ini-Cet) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Physiology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">24</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 65-year old patient visits his family practitioner for a yearly examination. On examination, his BP was 190/100 mm Hg. His pulse pressure was 90 mm Hg. What would have decreased resulting in this increase in pulse pressure?",
    "choices": [
      {
        "id": 1,
        "text": "Myocardial contractility"
      },
      {
        "id": 2,
        "text": "Stroke volume"
      },
      {
        "id": 3,
        "text": "Arterial wall compliance"
      },
      {
        "id": 4,
        "text": "Cardiac output"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Pulse pressure increases with age due to <strong>decreased arterial wall compliance</strong>.</p>\n<p>With advancing age, there is an increase in systolic blood pressure. Whilst diastolic blood pressure falls after 60 years of age due to increased arterial stiffness (decreased compliance). As a result of these two changes, pulse pressure increases (&uarr;PP = &uarr;SBP - &darr;DBP).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following curves represents gamma-globin chain production?",
    "choices": [
      {
        "id": 1,
        "text": "Green Curve"
      },
      {
        "id": 2,
        "text": "Black Curve"
      },
      {
        "id": 3,
        "text": "Blue Curve"
      },
      {
        "id": 4,
        "text": "Orange curve"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given image, the Orange curve<strong>&nbsp;</strong>represents the gamma-globin chain production. Gamma globin chain is produced in the fetal period and drops to undetectable levels 6 months postpartum which is the pattern represented by the Orange curve.</p>\n<p>Hemoglobin in blood has different variants throughout life, in different proportions. The type of hemoglobin essentially depends on the combination of globin chains. Adult hemoglobin is made of 2 alpha and 2 beta chains, whereas fetal hemoglobin is made of 2 alpha and 2 gamma-globin chains. Other combinations of chains can be found in embryonic hemoglobin.</p>\n<p>Here,</p>\n<ul>\n<li>Gamma chain - Orange curve</li>\n<li>Alpha chain - Red curve</li>\n<li>Beta chain - Green curve</li>\n<li>Epsilon chain - Black curve</li>\n<li>Delta chain - Blue curve</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6f3facd7a9524712a22266f8a427fe3a.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Transcutaneous electric nerve stimulation is used to reduce pain. What is the mechanism behind this?",
    "choices": [
      {
        "id": 1,
        "text": "Central inhibition"
      },
      {
        "id": 2,
        "text": "Desensitization"
      },
      {
        "id": 3,
        "text": "Gate control theory"
      },
      {
        "id": 4,
        "text": "Descending inhibition"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Transcutaneous electrical nerve stimulation</strong> (TENS) used for pain relief is based on the&nbsp;<strong>gate theory of pain</strong>.&nbsp;This method uses electrodes to activate A&alpha; and A&beta; fibers near the injury to relieve pain.</p>\n<p><strong>Gate control theory</strong> is based on the <strong>inhibition of pain pathway in the spinal cord</strong>. Various sensory inputs from a particular dermatome reach the dorsal horn of the spinal cord. The pain is transmitted via A-delta and C fibers, whereas, A-beta fibers carry tactile sensations (touch, pressure) and A-alpha fibers carry proprioception.</p>\n<p>When these large-diameter A-beta/A-alpha fibers are stimulated, they inhibit the pain pathway in the spinal cord. This inhibition is thought to result from the <strong>local lateral inhibition of interneurons</strong> in the spinal cord.</p>\n<p>Gate control theory operates at the&nbsp;<strong>substantia gelatinosa</strong> of the&nbsp;<strong>dorsal horn of the spinal cord</strong>.</p>\n<p>The given image depicts the gate control theory of pain:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/282b5f42ca40421795588ad74e57cdffx1280x1037.JPEG"
    ]
  },
  {
    "text": "Which of the following is not required for calculation of creatinine clearance?",
    "choices": [
      {
        "id": 1,
        "text": "Urine creatinine"
      },
      {
        "id": 2,
        "text": "Serum creatinine"
      },
      {
        "id": 3,
        "text": "24 hour urine output"
      },
      {
        "id": 4,
        "text": "Volume of serum passing through kidney in 24 hours"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The volume of plasma passing through the kidney in 24 hours is not used in the calculation of creatinine clearance.</p>\n<p>The parameters used to calculate <strong>creatinine clearance (C<sub>Cr</sub>)</strong> are:</p>\n<ul>\n<li>Urine creatinine</li>\n<li>Serum creatinine</li>\n<li>24hr urine output</li>\n</ul>\n<p>The formula used to calculate creatinine clearance (C<sub>Cr</sub>) is:</p>\n<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; U<sub>Cr</sub> &times; V &frasl; P</strong><sub><strong>Cr&nbsp;</strong>&nbsp;</sub>where,</p>\n<p>U<sub>Cr -&nbsp;</sub>Urine creatinine(mg/dl)</p>\n<p>P<sub>Cr -&nbsp;</sub>Serum creatinine(mg/dl)</p>\n<p>V - Urine volume(ml/24 hrs)</p>\n<p><strong>Creatinine</strong> is a <strong>metabolite of muscle metabolism</strong> and is <strong>cleared</strong> from the body mostly by <strong>glomerular filtration</strong>. Therefore, the clearance of creatinine is used to <strong>assess GFR</strong>.</p>\n<p>Urine collection for the measurement of creatinine clearance may be subject to practical constraints. Therefore, approximate changes in GFR can be obtained by measuring the&nbsp;<strong>serum creatinine concentration</strong>, which is <strong>inversely proportional</strong> to <strong>GFR</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A neuron is receiving 400 inputs from 150 sensory neurons. This is an example of?",
    "choices": [
      {
        "id": 1,
        "text": "Divergence"
      },
      {
        "id": 2,
        "text": "Convergence"
      },
      {
        "id": 3,
        "text": "Feedback inhibition"
      },
      {
        "id": 4,
        "text": "Feedforward excitation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A single neuron receiving 400 inputs from 150 sensory neurons is an example of\u00a0<strong>c</strong><strong>onvergence.</strong></p>\n<p>Convergence means signals from multiple inputs\u00a0uniting to excite a single neuron. It can be of 2 types:</p>\n<ul>\n<li>Convergence\u00a0from a single source</li>\n<li>Convergence\u00a0from multiple sources</li>\n</ul>\n<p>The importance of\u00a0convergence is that neurons are almost never excited\u00a0by an action potential from a single input terminal.\u00a0However, action potentials converging on the neuron\u00a0from multiple terminals provide enough spatial summation\u00a0to bring the neuron to the threshold required for\u00a0discharge.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Calculate the ECF volume in a volunteer in whom 10 gm of mannitol was injected in venous blood. At equilibrium urinary excretion of mannitol was found to be 10% and the plasma concentration of mannitol was 65 mg/100 ml.",
    "choices": [
      {
        "id": 1,
        "text": "14L"
      },
      {
        "id": 2,
        "text": "10L"
      },
      {
        "id": 3,
        "text": "28L"
      },
      {
        "id": 4,
        "text": "20L"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">ECF volume of the above volunteer is calculated to be <strong>14 L.</strong></p>\n<p class=\"ng-binding\">The ECF volume can be calculated using the formula:</p>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\"><img class=\"ng-scope\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/9ddfeb532f3b4162af5301ce970e31eax542x120.JPEG\" width=\"371\" height=\"82\" /></div>\n<div class=\"ng-scope\">Where,</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<ul>\n<li>V = ECF volume</li>\n<li>Amount injected = 10 gm</li>\n<li>Amount of mannitol excreted = 10% of 10 gm = 1gm</li>\n<li>Plasma concentration of mannitol = 65 mg/100mL = 0.65 gm/L&nbsp;</li>\n</ul>\n<p><strong>Calculation:</strong></p>\n<p>&nbsp;ECF Volume = (10-1)/0.65</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 13.8 L =&nbsp;<strong>approximately 14 L</strong></p>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Mannitol cannot cross cell membranes, hence, it will be distributed&nbsp;in ECF but not in ICF. Thus mannitol is a marker&nbsp;for ECF volume and therefore calculating the volume of distribution of mannitol gives the value of ECF volume.</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Gibbs-Donnan equilibrium is mainly due to?",
    "choices": [
      {
        "id": 1,
        "text": "Phosphate"
      },
      {
        "id": 2,
        "text": "Bicarbonate in the intracellular compartment"
      },
      {
        "id": 3,
        "text": "Calcium in the extracellular compartment"
      },
      {
        "id": 4,
        "text": "Intracellular proteins"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Gibbs-Donnan equilibrium is mainly due to <strong>intracellular proteins.</strong></p>\n<p><strong>Donnan and Gibbs </strong>showed that \"When an ion on one side of a membrane cannot diffuse through the membrane, the distribution of other ions to which the membrane is permeable is affected in a predictable way\".</p>\n<p>According to this, in the presence of<strong>&nbsp;intracellular proteins,</strong> which are <strong>negatively charged non-diffusable</strong>&nbsp;ions, the distribution of other ions to which the membrane is permeable is affected in a predictable way (Donnan Effect) so that at equilibrium their concentration ratios are equal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of these hormones have intracellular receptors?",
    "choices": [
      {
        "id": 1,
        "text": "Thyroxine"
      },
      {
        "id": 2,
        "text": "Epinephrine"
      },
      {
        "id": 3,
        "text": "Glucagon"
      },
      {
        "id": 4,
        "text": "Parathormone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Thyroxine hormone</strong> act by binding to intracellular nuclear receptors.</p>\n<p>All other hormones mentioned in the options bind to receptors on the cell membrane.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Intercellular communication in eukaryotes is by?",
    "choices": [
      {
        "id": 1,
        "text": "Lysosome"
      },
      {
        "id": 2,
        "text": "Peroxisome"
      },
      {
        "id": 3,
        "text": "Exosome"
      },
      {
        "id": 4,
        "text": "Genome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Intercellular communication in eukaryotes is by<strong>&nbsp;Exosome.</strong></p>\n<p>In the last decade, a class of small, heterogeneous, secreted vesicles, broadly termed as&nbsp;<strong>extracellular vesicles</strong>&nbsp;have been identified.</p>\n<p>These extracellular vesicles have been implicated as a new and important mediator of cell-cell communication that likely contributes importantly to both normal and pathologic physiology.</p>\n<p>These vesicles are enclosed by a lipid bilayer.</p>\n<p>They are heterogeneous in size (30-2000 nm diameter), and are generated by at least two distinct mechanisms:</p>\n<ul>\n<li><strong>Microvesicles </strong>are generated by budding from the<strong> plasma membrane of a source cell.</strong></li>\n<li><strong>Exosomes </strong>are generated from the multivesicular body (MVB).</li>\n</ul>\n<p>Note: The terms microvesicle and exosome are often lumped together as simply exosomes.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In skeletal muscle, dihydropyridine and ryanodine receptors are coupled by?",
    "choices": [
      {
        "id": 1,
        "text": "Chemically"
      },
      {
        "id": 2,
        "text": "Electrically"
      },
      {
        "id": 3,
        "text": "Chemically and then electrically"
      },
      {
        "id": 4,
        "text": "Mechanically"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In <strong>skeletal muscle</strong>, dihydropyridine and ryanodine receptors show <strong>mechanical coupling </strong>involving structural interaction between the two.</p>\n<p>Dihydropyridine receptors (DHPRs) are <strong>voltage-gated Ca2+ channels </strong>in the T tubule membrane.&nbsp;</p>\n<p>The ryanodine receptor (RyR) is a ligand-gated Ca2+ channel with Ca2+ as its natural ligand.</p>\n<p>Skeletal muscle excitation-contraction (E-C) coupling is thought to occur by a \"mechanical coupling\" mechanism involving protein-protein interactions that lead to activation of the sarcoplasmic reticulum ryanodine receptor by the voltage-sensing transverse (T-) tubule dihydropyridine receptor.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In negative feedback, feedback gain of infinity is seen in which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Blood volume control by kidney"
      },
      {
        "id": 2,
        "text": "Temperature control in hypothalamus"
      },
      {
        "id": 3,
        "text": "BP control by barorecptors"
      },
      {
        "id": 4,
        "text": "Infinite gain is not possible"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In negative feedback, <strong>feedback gain</strong> of <strong>infinity</strong>&nbsp;could be seen in&nbsp;<strong>blood volume control by the kidney.</strong></p>\n<p>When the blood volume falls below the equilibrium, the renal&ndash;body fluid mechanism causes the blood volume returns back to the equilibrium point resulting in zero error and hence the gain of kidney in its ability to regulate blood volume is infinity (&infin;).</p>\n<p>The degree of effectiveness with which a regulatory system maintains constant conditions is determined by the gain of the negative feedback system.&nbsp;</p>\n<p><strong>Gain= Correction/Error</strong></p>\n<p>Example: If an external or internal factor led to a decrease in mean blood pressure from 100 mm Hg to 80 mm Hg. Activation of a negative feedback mechanism i.e. baroreflex leads to a correction of blood pressure to 96 mm Hg. So in this case,</p>\n<ul>\n<li>Correction = 16 mm Hg</li>\n<li>Error = 4 mm Hg</li>\n<li>Gain = Correction/Error = 16/4 = 4</li>\n</ul>\n<p>Note: A <strong>gain of 0</strong> would imply a <strong>total failure of the regulatory system</strong> and a <strong>gain of infinity&nbsp;</strong>(&infin;) would indicate <strong>complete restoration</strong> of the regulated variable.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The image below shows simple muscle twitch along with the time trace, recorded in a frog gastrocnemius muscle. Calculate the minimum tetanizing frequency. (The time tracer was made with a 100Hz tuning fork).",
    "choices": [
      {
        "id": 1,
        "text": "25 per second"
      },
      {
        "id": 2,
        "text": "15 per second"
      },
      {
        "id": 3,
        "text": "17 per second"
      },
      {
        "id": 4,
        "text": "20 per second"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p class=\"p1\"><strong>Tetanization</strong>:</p>\n<p class=\"p1\">The features of muscle contraction can be demonstrated by eliciting single muscle twitches. The adding together of individual twitch contractions to increase the intensity of overall muscle contraction is <strong>Summation.\u00a0</strong>Summation occurs in two ways:</p>\n<ul class=\"ul1\">\n<li class=\"li1\">by increasing the number of motor units contracting simultaneously, which is <strong>multiple \ufb01ber summations.</strong></li>\n<li class=\"li1\">by increasing the frequency of contraction, which is called frequency<strong>\u00a0summation and can lead to tetanization.</strong></li>\n</ul>\n<p class=\"p1\">When the frequency of a contraction reaches a critical level, the successive contractions eventually fuse together, and the whole muscle contraction appears to be completely smooth and continuous, this is called<strong> tetanization.\u00a0</strong>Beyond this point, a further increase in the frequency, will not result in increased force of contraction.</p>\n<p class=\"p1\"><strong>Tetanization </strong>occurs in two ways:</p>\n<ul class=\"ul1\">\n<li class=\"li1\"><strong>Complete tetanus </strong>occurs when no relaxation occurs between stimuli.</li>\n<li class=\"li1\"><strong>Incomplete tetanus </strong>when periods of incomplete relaxation take place between the summated stimuli.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/34ef06d3894942c9a681f6211dc63967.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/037de34e007545d79a483088b1b50c03x1280x2823.JPEG"
    ]
  },
  {
    "text": "Least frequency of slow waves is seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Duodenum"
      },
      {
        "id": 2,
        "text": "Ileum"
      },
      {
        "id": 3,
        "text": "Jejunum"
      },
      {
        "id": 4,
        "text": "Stomach"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Muscle contraction can occur only when the motor stimulus is provided during the depolarisation part of the BER.</p>\n<p>Thus, BER does not cause muscle contraction by itself, but controls the rate and organization sites of the muscle contractions, as in <strong>coordination </strong>of the <strong>peristaltic activity</strong> and setting the <strong>rhythm</strong> of<strong> segmentation</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3aedd333927b4607b4c6b1eca436466ex1020x730.JPEG"
    ]
  },
  {
    "text": "Macula densa is formed by which part of the nephron?",
    "choices": [
      {
        "id": 1,
        "text": "PCT"
      },
      {
        "id": 2,
        "text": "DCT"
      },
      {
        "id": 3,
        "text": "Afferent arteriole"
      },
      {
        "id": 4,
        "text": "Bowman's capsule"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The juxtaglomerular apparatus consists of the following parts:</p>\n<ul>\n<li><strong>Macula densa:</strong> At the end of the thick ascending limb of Henle, and at the beginning of the distal tubule, the tubular epithelial cells are specialized to form the macula densa. They detect sodium concentration of the fluid in the tubule<strong> (chemoreceptor). </strong>In response to <strong>elevated sodium</strong>, the macula densa cells trigger<strong>&nbsp;</strong>the<strong> contraction of the afferent arteriole</strong>, <strong>reducing</strong>&nbsp;the flow of blood to the glomerulus and the <strong>glomerular filtration rate</strong>. This happens as follows: When there is increased sodium, there is increased <strong>sodium-potassium ATPase activity which</strong>&nbsp;leads to increased <strong>ATP hydrolysis</strong> causing more <strong>adenosine</strong> formation. The adenosine receptors on the macula densa cells stimulate it to release<strong> more calcium</strong>, so that there is vasoconstriction of the afferent arteriole, thereby decreasing the <strong>GFR.</strong></li>\n<li>Lacis cells:<strong> Extraglomerular mesangial cells</strong> situated between afferent and efferent arteriole.</li>\n<li>Granular cells/JG cells:&nbsp;Modified <strong>smooth muscle cells of the afferent arteriole, </strong>they secrete renin.&nbsp;<strong>Fall in pressure</strong> in afferent arteriole stimulates renin release <strong>(mechanoreceptor)</strong>, which, in turn, <strong>increases blood pressure.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5461ebba66b64151ba826ae7f04b9317x1280x1384.JPEG"
    ]
  },
  {
    "text": "As filtrate flows through PCT,  the concentration of all of the following decreases except:",
    "choices": [
      {
        "id": 1,
        "text": "Aminoacid"
      },
      {
        "id": 2,
        "text": "Glucose"
      },
      {
        "id": 3,
        "text": "Chloride"
      },
      {
        "id": 4,
        "text": "Bicarbonate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>As the filtrate flows through the proximal convoluted tubule, the <strong>concentration of the chloride increases.</strong></p>\n<ul>\n<li>The concentration of <strong>chloride</strong> in the <strong>early part</strong> of the <strong>pCT is \u2248105 mEq/L.</strong></li>\n<li>As the sodium is reabsorbed, it preferentially carries <strong>glucose, amino acids,</strong> and <strong>bicarbonate.</strong></li>\n<li>This leaves behind the solute, that has a higher concentration of the <strong>chloride,</strong> which as it reaches the second half of the PCT is<strong> \u2248140 mEq/L.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "This is the graph depicting the filterability of dextran through the kidney, 1 representing complete filtration and 0 representing no filtration. Choose the substance A, B, C respectively.",
    "choices": [
      {
        "id": 1,
        "text": "Polycationic, Neutral, Polyanionic"
      },
      {
        "id": 2,
        "text": "Polyanionic, Neutral, Polycationic"
      },
      {
        "id": 3,
        "text": "Neutral, Polycationic, Polyanionic"
      },
      {
        "id": 4,
        "text": "Polyanionic, Polycationic, Neutral"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given graph, the order of filterability is<strong> A&gt;B&gt;C,</strong> which likely indicates that the substances are&nbsp;Polycationic, Neutral, Polyanionic.</p>\n<p>The glomerular filtration barrier is <strong>negatively charged,</strong> which will <strong>repel</strong> most of the negative charged <strong>(anionic substances).</strong> Whereas, the <strong>cationic</strong> <strong>substances</strong> are <strong>easily filtered.</strong></p>\n<p>Hence, the order of filterability would be:&nbsp;<strong>Polycationic &gt; Neutral &gt; Polyanionic</strong>, represented by A, B, and C in the graph shown.</p>\n<p>The glomerular filtration barrier consists of:</p>\n<ul>\n<li><strong>Endothelium </strong>of the capillary</li>\n<li><strong>Basement membrane:&nbsp;</strong>\n<ul>\n<li>Lamina densa - electron-dense layer. It contains type IV collagen</li>\n<li>Lamina rara interna -&nbsp;contains glycosaminoglycan heparan sulfate which has a negative charge</li>\n<li>Lamina rara externa - contains glycosaminoglycan heparan sulfate which has a negative charge</li>\n</ul>\n</li>\n<li>Layer of <strong>epithelial cells (podocytes)</strong> surrounding the outer surface of the capillary basement membrane</li>\n</ul>\n<div class=\"page\" title=\"Page 317\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The capillary endothelium is perforated by thousands of small holes called <strong>fenestrae</strong>, which measure from <strong>4 nm up to 8nm.</strong> Therefore, <strong>neutral substances</strong> with molecular diameters of less than 4 nm are freely filtered, and filtration of those with diameters of more than 8 nm approaches zero.</p>\n<p>However, in addition to the size of the particles, the filtration also depends mainly on the charge of the particle being filtered. The glomerular capillary wall consists of highly negatively charged proteins called <strong>sialoproteins,</strong> which repel the negatively charged substances (anions). The property can be studied by using charged dextran.</p>\n<p>When the filtration of the negatively and positively charged <strong>dextrans</strong> was studied, the results indicated that the <strong>negatively charged dextrans</strong> in the blood are <strong>repelled,</strong> with the result that filtration of anionic substances 4 nm in diameter is less than half that of neutral substances of the same size.</p>\n<p>This explains, why <strong>albumin</strong> despite having an effective molecular diameter of approximately 7 nm, has a very low filtration rate.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f9e9ddb302d944008de20d3d789832a1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Calculate the respiratory quotient (RQ) in a patient with 50kg body weight, if the CO2 exhaled is 200ml/min and O2 consumed is 250 ml/min.",
    "choices": [
      {
        "id": 1,
        "text": "0.8"
      },
      {
        "id": 2,
        "text": "1"
      },
      {
        "id": 3,
        "text": "1.25"
      },
      {
        "id": 4,
        "text": "1.5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 832\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The respiratory quotient is<strong> 0.8.</strong></p>\n<p>The respiratory quotient is the <strong>ratio</strong> of <strong>carbon dioxide production</strong> to <strong>oxygen</strong> <strong>utilization</strong>.</p>\n<p>In the given question, the <strong>CO<sub>2</sub> production</strong> is <strong>200mL/min,</strong> while the <strong>O<sub>2</sub> consumption</strong> is <strong>250mL/min.</strong></p>\n<p>Therefore,</p>\n<p><strong>Respiratory quotient</strong> = 200/250 = <strong>0.8</strong></p>\n<p>&nbsp;</p>\n<p><strong>The respiratory quotient (RQ)</strong> is used for determining the metabolic utilization of various foods.</p>\n<ul>\n<li>When <strong>carbohydrates</strong> are metabolized with one molecule of oxygen, one carbon dioxide molecule is released. Therefore, the <strong>RQ</strong> of <strong>carbohydrates&nbsp;= 1.</strong></li>\n<li>When&nbsp;<strong>fats</strong>&nbsp;are oxidized<strong>,</strong> for every 100 molecules of oxygen consumed, 70 molecules of CO<sub>2</sub> are released. Therefore, the <strong>RQ</strong> of <strong>fats is 0.70.</strong></li>\n<li>Similarly, the<strong> respiratory quotient </strong>for<strong> proteins </strong>is <strong>0.80.</strong></li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following types of amino acids are present in the transmembranous part of the membrane receptor?",
    "choices": [
      {
        "id": 1,
        "text": "Amphipathic"
      },
      {
        "id": 2,
        "text": "Hydrophobic"
      },
      {
        "id": 3,
        "text": "Hydrophilic"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The transmembranous part of the membrane receptor consists of hydrophobic amino acids.</p>\n<p>A membrane protein can be either integral protein (spans the thickness of the cell membrane) or peripheral&nbsp;protein (attached to the peripheral side of the membrane).&nbsp;The <strong>membrane-spanning segment</strong>&nbsp;of integral proteins are usually <strong>hydrophobic alpha-helices.</strong></p>\n<p>The central core of the cell membrane is hydrophobic. Integral proteins have their&nbsp;hydrophobic portions usually in the interior of the membrane and the hydrophilic portions towards the surfaces.&nbsp;The presence of these <strong>hydrophobic amino acids</strong> in the <strong>interior</strong> is a special adaptation that allows the protein to remain stable in the hydrophobic milieu of the cell membrane.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cff12cc1e0cf4a298dd52197a820deabx1279x818.JPEG"
    ]
  },
  {
    "text": "Which of the following is not a cause of secondary hyperparathyroidism?",
    "choices": [
      {
        "id": 1,
        "text": "Parathyroid adenoma"
      },
      {
        "id": 2,
        "text": "Lithium intake"
      },
      {
        "id": 3,
        "text": "Vitamin D deficiency"
      },
      {
        "id": 4,
        "text": "Chronic kidney disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Parathyroid adenoma</strong> is a benign tumor of the parathyroid gland, which causes <strong>primary hyperparathyroidism </strong>(not secondary).</p>\n<p><strong>Secondary hyperparathyroidism&nbsp;</strong>is characterized by <strong>high</strong> levels of <strong>parathyroid hormone</strong>, to compensate for the <strong>low</strong> levels of serum <strong>calcium</strong>, due to some other underlying condition.</p>\n<p>Causes of secondary hyperparathyroidism, include:</p>\n<ul>\n<li><strong>Chronic kidney disease:&nbsp;</strong>The damaged kidneys are unable to produce sufficient amounts of the active form of vitamin D, 1,25-dihydroxycholecalciferol. This further causes hypocalcemia and triggers PTH secretion.</li>\n<li><strong>Vitamin D deficiency</strong>: Causes hypocalcemia, which triggers the increased secretion of PTH.</li>\n<li><strong>Lithium</strong>: May cause an increased set-point of calcium for parathyroid<strong>&nbsp;</strong>hormone suppression, which leads to <strong>parathyroid hyperplasia.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following events occur immediately when a person changes his/her posture from supine to standing?",
    "choices": [
      {
        "id": 1,
        "text": "Decrease in firing from baroreceptor"
      },
      {
        "id": 2,
        "text": "Vagal output to cardiac fibres increase"
      },
      {
        "id": 3,
        "text": "Mesenteric Vasoconstriction"
      },
      {
        "id": 4,
        "text": "Increase cardiac contractility"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>There is a decreased firing from the baroreceptors.</p>\n<ul>\n<li>When a person <strong>stands up from a lying down position</strong>, it causes <strong>pooling of the blood</strong> in the legs, due to gravity. This <strong>reduces the venous return</strong> and causes a <strong>decrease</strong> in <strong>cardiac output.</strong></li>\n<li>Reduced cardiac output, leads to a <strong>fall in blood pressure,</strong> which in turn causes<strong> reduced firing from baroreceptors.</strong></li>\n<li>As a result, the <strong>vagal tone is suppressed</strong> leading to<strong> increased heart rate.</strong></li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true about skeletal muscle contraction?",
    "choices": [
      {
        "id": 1,
        "text": "2, 3, 4"
      },
      {
        "id": 2,
        "text": "3 only"
      },
      {
        "id": 3,
        "text": "1, 2, 4"
      },
      {
        "id": 4,
        "text": "1, 3, 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>During the contraction of the skeletal muscle, the&nbsp;Ca2<sup>+</sup> is released from the sarcoplasmic reticulum. Only statement 3 is correct.</p>\n<p><strong>Excitation contraction coupling</strong> refers to the process by which the membrane depolarization of the muscle fibre <strong>(excitation)</strong> leads to the <strong>contraction</strong> of the muscle.</p>\n<p>The steps of excitation-contraction coupling in skeletal muscle are as follows:</p>\n<ul>\n<li><strong>Motor-neuron discharge</strong> causes the release of <strong>acetylcholine</strong> at the motor endplate, which binds to the nicotinic acetylcholine receptors.</li>\n<li>This causes increased Na+ and K+ conductance in the endplate membrane, leading to the generation of<strong> end-plate potential,</strong> which is a local potential.</li>\n<li>When the local endplate potential reaches a threshold for the muscle fibre, and an <strong>action potential</strong> is generated.</li>\n<li>The generated action potential passes inward through the<strong> T tubules</strong>, leading to the spread of <strong>depolarisation.</strong></li>\n<li>The depolarization of the muscle fibre causes the <strong>release of Ca<sup>2+</sup></strong> from terminal cisterns of <strong>sarcoplasmic reticulum</strong> and diffusion to thick and thin filaments.</li>\n<li>The calcium released,&nbsp;<strong>binds&nbsp;to troponin C</strong>, uncovering myosin-binding sites on actin.</li>\n<li>The formation of<strong> cross-linkages between actin and myosin</strong> and sliding of thin on thick filaments causes contraction of the skeletal muscle.</li>\n</ul>\n<p><strong>Steps in relaxation:</strong></p>\n<ul>\n<li>The cytoplasmic calcium is pumped back into the sarcoplasmic reticulum, by the action of <strong>SERCA</strong> (sarcoplasmic endoplasmic reticulum calcium ATPase).</li>\n<li>Once the<strong> calcium concentration is lowered</strong>, the interaction between actin and myosin ceases, and the muscle <strong>relaxes.</strong>&nbsp;</li>\n</ul>\n<div class=\"page\" title=\"Page 116\">\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\"><strong>Other options:</strong></div>\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\"><strong>Statement 1:</strong> Incorrect - Extracellular calcium levels play an important role in muscle contraction. When there is a decrease in extracellular calcium as in hypocalcemia, the voltage-gated sodium channels are activated, which causes sodium influx. The increased intracellular sodium concentration causes sustained depolarization, which may lead to <strong>tetany.</strong></div>\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\"><strong>Statement 2:</strong> Incorrect -&nbsp;Ca2<sup>+</sup> is not released from mitochondria. It is released from the sarcoplasmic reticulum.</div>\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\"><strong>Statement 4:&nbsp;</strong>Voltage-gated calcium channels on T-tubules (part of sarcolemma) are activated by a depolarizing stimulus, which causes the release of calcium from the sarcoplasmic reticulum. The increased calcium concentration will eventually lead to muscle contraction.</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are correct regarding mechanisms of depolarisation, repolarisation, and hyperpolarisation in a skeletal muscle action potential?",
    "choices": [
      {
        "id": 1,
        "text": "2 and 4 are correct"
      },
      {
        "id": 2,
        "text": "1, 3, and 5 are correct"
      },
      {
        "id": 3,
        "text": "1, 4, and 5 are correct"
      },
      {
        "id": 4,
        "text": "2, 4, and 5 are correct"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The steps in an action potential in muscle fibre and the neuron, are similar except for the <strong>quantitative differences,</strong> such as:</p>\n<ul>\n<li><strong>RMP</strong> is -80 to -90 mV in skeletal muscle fibres, while it is about -70mV in neurons.</li>\n<li>The <strong>duration</strong> of the action potential in skeletal muscle is 1 to 5 msec, which is about 5 times longer than in the largest myelinated nerve fibre.</li>\n<li>The <strong>velocity</strong> of conduction is about 3-5m/s, which is about 1/13<sup>th</sup> of the velocity of the nerve fibre.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b827eaffd0bd4a0f9c2c9164046414a4x1280x1683.JPEG"
    ]
  },
  {
    "text": "Arrange the following events in the sequence in which they occur, after 'p wave' in ECG:",
    "choices": [
      {
        "id": 1,
        "text": "1-2-3-4"
      },
      {
        "id": 2,
        "text": "1-2-4-3"
      },
      {
        "id": 3,
        "text": "3-1-2-4"
      },
      {
        "id": 4,
        "text": "1-3-2-4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>The <strong>p wave in the ECG</strong> represents atrial depolarization, which causes contraction of the atria, represented by the <strong>'a' wave in the JVP.&nbsp;</strong>Atrial contraction causes <strong>final</strong> filling of the ventricles (fourth phase of ventricular diastole)&nbsp;</li>\n<li><strong>Atrial contraction&nbsp;</strong>is followed by the closure of the mitral valve, which causes the <strong>first-heart sound.</strong></li>\n<li>This is followed by the isovolumetric contraction of the ventricle, which causes <strong>c wave</strong> in JVP, due to bulging of the tricuspid valve. This is followed by the rapid ejection phase of the ventricle.</li>\n<li>The <strong>T wave</strong> of ECG occurs during ventricular repolarization, which is followed by the <strong>opening</strong> of the <strong>mitral valve,</strong> followed by&nbsp;<strong>rapid filling phase of the ventricle&nbsp;(second&nbsp; phase of ventricular diastole).</strong></li>\n</ul>\n<p>Note: Passive <strong>rapid filling</strong> occurs as the mitral valve opens just <strong>before</strong> atrial contraction occurs.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/650d94b4e5cf4e1d867a15093d360c20x1024x700.jpeg"
    ]
  },
  {
    "text": "Which of the following increases in COPD?",
    "choices": [
      {
        "id": 1,
        "text": "1 only"
      },
      {
        "id": 2,
        "text": "1 and 4"
      },
      {
        "id": 3,
        "text": "1 and 3"
      },
      {
        "id": 4,
        "text": "1 and 2"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Lung Capacities:</strong></p>\n<p>The total lung capacity can be broken down into alternative capacities that help to define functioning lungs.</p>\n<ul>\n<li>The <strong>vital lung capacity</strong>&nbsp;refers to the maximum amount of air expired from the fully inflated lung or maximum inspiratory level.</li>\n<li>The <strong>inspiratory capacity </strong>is the maximum amount of air inspired from the end-expiratory level.</li>\n<li>The <strong>functional residual capacity </strong>represents the volume of the air remaining in the lungs after expiration of a normal&nbsp;breath.&nbsp;Functional Residual Capacity (FRC) is <strong>expiratory reserve volume + residual volume.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '019 Physiology Aiims 2020 (May And Nov Ini-Cet)';
        let hierarchy = ["Marrow", "PYQs", "Physiology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>