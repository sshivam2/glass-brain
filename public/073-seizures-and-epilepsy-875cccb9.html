<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>073 Seizures And Epilepsy - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">28</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 30-year-old patient is undergoing EEG with his eyes open. What is the expected frequency of the waves being recorded?",
    "choices": [
      {
        "id": 1,
        "text": "< 4 Hz"
      },
      {
        "id": 2,
        "text": "4- 7 Hz"
      },
      {
        "id": 3,
        "text": "8- 13 Hz"
      },
      {
        "id": 4,
        "text": ">13 Hz"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Beta waves</strong> are seen on the <strong>EEG</strong> of an adult recorded with <strong>eyes open</strong>. The <strong>frequency</strong> of these waves on an EEG is <strong>&gt;13 Hz</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged obese man is being evaluated at the sleep clinic. During his EEG recording, he is awake with his eyes closed. Which of the following waves will be predominantly seen?",
    "choices": [
      {
        "id": 1,
        "text": "Predominant alpha waves with intermixed beta activity"
      },
      {
        "id": 2,
        "text": "Predominant beta waves with intermixed alpha activity"
      },
      {
        "id": 3,
        "text": "Predominant theta waves with intermixed delta activity"
      },
      {
        "id": 4,
        "text": "Predominant delta waves with intermixed theta activity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a normal adult awake patient lying quietly with his <strong>eyes closed</strong>, <strong>alpha</strong> waves are <strong>predominantly</strong> seen intermixed with a variable generalized beta activity.</p>\n<p>This alpha rhythm is attenuated when the eyes are opened.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/169a115416014488a724910b26ea5376x800x349.PNG"
    ]
  },
  {
    "text": "Which of the following is not a type of generalized epilepsy?",
    "choices": [
      {
        "id": 1,
        "text": "Childhood absence"
      },
      {
        "id": 2,
        "text": "Juvenile absence"
      },
      {
        "id": 3,
        "text": "Juvenile myoclonic"
      },
      {
        "id": 4,
        "text": "Jacksonian march"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Jacksonian march</strong> is a feature seen in <strong>focal seizures</strong>, not generalized epilepsy.</p>\n<p>In Jacksonian march, the abnormal motor movements<strong> begin</strong> in a very<strong> restricted region</strong> such as the fingers and gradually <strong>progress</strong> to include a <strong>larger portion</strong> of the extremity. It represents the spread of the seizure activity over a progressively larger region of the motor cortex.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d304f7ff93bb403eb7285a1fd078d330x1200x1368.JPEG"
    ]
  },
  {
    "text": "A 13-year-old boy presents with involuntary, sudden jerking movements of both upper limbs. They occur most frequently in the morning after awakening and are provoked by lack of sleep. This type of seizure is classified as ________.",
    "choices": [
      {
        "id": 1,
        "text": "Unknown onset"
      },
      {
        "id": 2,
        "text": "Focal and generalized onset"
      },
      {
        "id": 3,
        "text": "Focal onset"
      },
      {
        "id": 4,
        "text": "Generalised onset"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario is suggestive of <strong>juvenile myoclonic epilepsy\u00a0</strong>(JME). <strong>Myoclonic seizures</strong> are the predominant feature of JME and are now classified under both <strong>focal onset and generalized onset</strong> seizures.</p>\n<p><strong>Generalized</strong> seizures arise at some point in the brain but immediately and rapidly engage neuronal networks in <strong>both cerebral hemispheres</strong>.\u00a0</p>\n<p><strong>Focal</strong> seizures arise from a neuronal network either discretely localized within one brain region or more broadly distributed but still <strong>within a cerebral hemisphere.</strong></p>\n<p>Myoclonic seizures are characterized by:</p>\n<ul>\n<li>Preserved consciousness</li>\n<li>Preserved postural control</li>\n<li>Lack of postictal confusion</li>\n</ul>\n<p>JME is an <strong>epilepsy syndrome</strong> that has familial inheritance and begins in <strong>adolescence</strong>. It most commonly occurs in the <strong>morning</strong> and is<strong> provoked</strong> by <strong>sleep deprivation</strong>. JME is usually associated with <strong>GTCS</strong> and sometimes with absence seizures.<strong> EEG</strong> shows a typical <strong>4-6 Hz </strong>polyspike and wave pattern. Treatment includes administration of <strong>sodium valproate</strong>.\u00a0</p>\n<p><strong>2017 ILAE-International League Against Epilepsy Classification:</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8b20cc25a8f44d2980c78fd543cb7d44x1200x1368.JPEG"
    ]
  },
  {
    "text": "Which of the following is not seen in focal seizures?",
    "choices": [
      {
        "id": 1,
        "text": "Jacksonian march"
      },
      {
        "id": 2,
        "text": "Todd's paralysis"
      },
      {
        "id": 3,
        "text": "Epilepsia partialis continua"
      },
      {
        "id": 4,
        "text": "Ictal cry"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The<strong> ictal cry</strong> is seen in generalized, tonic-clonic seizures (<strong>GTCS</strong>). Jacksonian march, Todd's paralysis, and Epilepsia partialis continua are features of focal seizures.</p>\n<p><strong>Jacksonian march</strong> is a feature seen in focal seizures wherein the abnormal motor movements begin in a very restricted region such as the fingers and gradually progress to include a larger portion of the extremity. It represents the spread of seizure activity over a progressively larger region of the motor cortex.</p>\n<p><strong>Todd&rsquo;s paralysis </strong>is a transient focal temporary paralysis usually persisting for a few minutes to hours (maximum up to 48 hours) in the postictal phase.</p>\n<p><strong>Epilepsia partialis continua </strong>refer to continued focal seizures for hours or days. It is often refractory to medical therapy.</p>\n<p>Tonic contraction of the muscles of expiration&nbsp;and the larynx at the onset of&nbsp;a generalized tonic-clonic seizure will produce a loud moan or <strong>ictal cry</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old girl is brought to the OPD with complaints of frequent fainting and sudden falls while playing. She sometimes falls off while sitting in the classroom hitting her head to the desk. She regains consciousness immediately and resumes her activity, and has normal behavior after such episodes. The girl is otherwise healthy. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Typical absence seizures"
      },
      {
        "id": 2,
        "text": "Atonic seizures"
      },
      {
        "id": 3,
        "text": "Syncope"
      },
      {
        "id": 4,
        "text": "Atypical absence seizures"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given history is most consistent with <strong>atonic seizures</strong>. Atonic seizures are characterized by a <strong>sudden loss of postural control&nbsp;</strong>and there is <strong>no postictal confusion</strong>.</p>\n<p>Options A and D: <strong>Absence seizures</strong> usually present as blank stares or unresponsiveness for a few seconds. <strong>Postural control</strong> is <strong>not lost</strong> during absence seizures.</p>\n<p>Option C:&nbsp;The girl regains consciousness immediately and has no associated complaints like sweating, fatigue, or tachycardia. She also resumes her activity after the episodes. Also, there is no precipitating factor that points towards syncope. Hence it is unlikely to be<strong> syncope</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-year-old boy is brought to the hospital. He is found to have a sudden brief lapse of consciousness with preserved postural control. No confusion is reported after regaining consciousness. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Atonic seizures"
      },
      {
        "id": 2,
        "text": "Myoclonic seizures"
      },
      {
        "id": 3,
        "text": "Absence seizures"
      },
      {
        "id": 4,
        "text": "Generalized tonic clonic seizures"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option A: Atonic seizures are characterized by a <strong>sudden loss</strong> of <strong>postural control</strong>.</p>\n<p>Option B: Myoclonic seizures have <strong>preserved consciousness</strong>. They involve a sudden brief jerking movement involving the entire body or a part of it.</p>\n<p>Option D: Generalised tonic-clonic seizures are characterized by<strong> post-ictal confusion</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3bab740325924cb58492e3b1a4e8a822x1279x1242.JPEG"
    ]
  },
  {
    "text": "An unconscious patient with a history of seizures is brought to the ED. He then develops muscular flaccidity and excessive salivation. After a few minutes, he begins to regain consciousness and is in a confused state. This phenomenon is associated with which of the following types of seizures?",
    "choices": [
      {
        "id": 1,
        "text": "GTCS"
      },
      {
        "id": 2,
        "text": "Absence seizures"
      },
      {
        "id": 3,
        "text": "Atonic seizures"
      },
      {
        "id": 4,
        "text": "Myoclonic seizures"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The scenario is suggestive of <strong>post-ictal confusion</strong> which is seen in <strong>generalized tonic-clonic seizures</strong>.</p>\n<p>It is not seen in absence seizures, atonic seizures or myoclonic seizures.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 15-year-old boy presents to the clinic with involuntary, sudden jerking movements of both upper limbs. They occur most frequently in the morning after awakening and are provoked by a lack of sleep. EEG demonstrates bilaterally synchronous spike-and-slow- wave discharges. Which of the following features is not seen in this type of seizure?",
    "choices": [
      {
        "id": 1,
        "text": "Post-ictal paralysis"
      },
      {
        "id": 2,
        "text": "Preserved postural control"
      },
      {
        "id": 3,
        "text": "Lack of postictal confusion"
      },
      {
        "id": 4,
        "text": "Preserved consciousness"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of <strong>myoclonic seizures</strong>. Post-ictal paralysis is not seen in these seizures.</p>\n<p>Myoclonic seizures are characterized by preserved consciousness (rarely very short loss of consciousness), preserved postural control,\u00a0Lack of postictal confusion.</p>\n<div class=\"page\" title=\"Page 3098\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Myoclonic seizures usually coexist with other forms of generalized seizures but are the predominant feature of <strong>juvenile myoclonic epilepsy</strong> (JME). The EEG shows bilaterally synchronous spike-and-slow wave discharges.\u00a0</p>\n<p>JME or <strong>Janz's syndrome</strong> is an epilepsy syndrome that has familial inheritance and begins in <strong>adolescence</strong>. It most commonly occurs in the <strong>morning</strong> and is <strong>provoked</strong> by<strong> sleep deprivation</strong>. JME is usually associated with <strong>GTCS</strong> and sometimes with absence seizures. EEG shows a typical <strong>4-6 Hz</strong> polyspike and wave pattern. Treatment includes administration of <strong>sodium valproate</strong>.\u00a0</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following EEG is that of a 6-year-old girl who is easily distracted in class and exhibits poor scholastic performance. Seizures are precipitated by hyperventilation. What is the diagnosis ?",
    "choices": [
      {
        "id": 1,
        "text": "Myoclonic seizures"
      },
      {
        "id": 2,
        "text": "Atonic seizures"
      },
      {
        "id": 3,
        "text": "Absence seizures"
      },
      {
        "id": 4,
        "text": "Clonic seizures"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>EEG shows generalized symmetric <strong>3 Hz spike</strong> and wave pattern. This is seen in <strong>absence seizures</strong>.</p>\n<p>Absence seizures are characterized by a sudden brief lapse of consciousness with <strong>preserved postural control</strong> that lasts only a few seconds. However, there is <strong>no post-ictal confusion</strong>.</p>\n<p><strong>Hyperventilation provokes</strong> these EEG discharges and also the seizures.</p>\n<p><strong>Ethosuximide</strong> is the <strong>drug of choice</strong> in typical absence seizures.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fe1856fa68ca48789a3444be078c5a7c.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b95a435b09ec4564987dbfbf992d6140x1280x1180.JPEG"
    ]
  },
  {
    "text": "What is the first-line agent for treating a patient with generalized tonic-clonic seizures?",
    "choices": [
      {
        "id": 1,
        "text": "Phenytoin"
      },
      {
        "id": 2,
        "text": "Carbamazepine"
      },
      {
        "id": 3,
        "text": "Ethosuximide"
      },
      {
        "id": 4,
        "text": "Valproate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>first-line</strong> agents in the treatment of generalized tonic-clonic seizures <strong>(GTCS)</strong> are <strong>Valproate, levetiracetam,&nbsp;</strong>and <strong>lamotrigine</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 16-year-old boy developed abnormal jerking movements that started in his left hand and gradually involved the entire arm. Following this, the patient experienced weakness and difficulty in moving the left arm for about an hour. Two similar episodes have also occurred in the past. Which of the following is the first-line drug for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Carbamazepine"
      },
      {
        "id": 2,
        "text": "Valproate"
      },
      {
        "id": 3,
        "text": "Ethosuximide"
      },
      {
        "id": 4,
        "text": "Topiramate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario describes <strong>Jacksonian march </strong>followed by<strong> Todd&rsquo;s palsy</strong>. These are characteristics of a<strong> focal seizure</strong>. Among the given drugs, the first-line drug for focal seizures is <strong>carbamazepine</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following can be used as first-line agents in patients with typical absence seizures, except:",
    "choices": [
      {
        "id": 1,
        "text": "Levetiracetam"
      },
      {
        "id": 2,
        "text": "Ethosuximide"
      },
      {
        "id": 3,
        "text": "Lamotrigine"
      },
      {
        "id": 4,
        "text": "Valproate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Levetiracetam is not the first-line agent for the treatment of typical absence seizures.</p>\n<p>First-line drugs for:</p>\n<ul>\n<li><strong>Typical absence seizures</strong>: Ethosuximide (<strong>drug of choice</strong>), valproate, and lamotrigine</li>\n<li><strong>Atypical absence seizures</strong>: Valproate</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is used as the first-line antiepileptic drug in the treatment of both generalized as well as focal seizures?",
    "choices": [
      {
        "id": 1,
        "text": "Valproate"
      },
      {
        "id": 2,
        "text": "Carbamazepine"
      },
      {
        "id": 3,
        "text": "Lamotrigine"
      },
      {
        "id": 4,
        "text": "Phenytoin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Lamotrigine</strong> is a <strong>first-line</strong> drug in the treatment of both<strong> generalized</strong> tonic-clonic and<strong> focal</strong> seizures.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the drug of choice for a patient with generalized epilepsy syndrome having mixed seizures?",
    "choices": [
      {
        "id": 1,
        "text": "Ethosuximide"
      },
      {
        "id": 2,
        "text": "Carbamazepine"
      },
      {
        "id": 3,
        "text": "Phenytoin"
      },
      {
        "id": 4,
        "text": "Valproate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Valproate</strong> is the drug of choice in <strong>generalized epilepsy</strong> syndrome <strong>having mixed seizures</strong>. It is particularly effective in absence, myoclonic and atonic seizures.&nbsp;</p>\n<p>Valproate is usually first given alone (<strong>monotherapy</strong>) and if ineffective, another drug such as lamotrigine may be added.</p>\n<p>In generalized epilepsy, drugs such as <strong>phenytoin</strong>, <strong>carbamazepine</strong>, and oxcarbazepine can increase the number of seizures. They can also provoke new seizure types - myoclonic or absence seizures. Hence, they are <strong>avoided</strong>.</p>\n<p><strong>Ethosuximide</strong> is the drug of choice in <strong>typical absence seizures</strong> and is not used for GTCS.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 34-year-old man is brought to the emergency department with violent shaking of arms and legs for the past 1 hour. He is a chronic alcoholic whose last intake was 2 days ago. IV lorazepam and phenytoin are administered to this patient. After 5 minutes, the seizures have not stopped. What is the next best step in the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Phenobarbitone"
      },
      {
        "id": 2,
        "text": "Lorazepam"
      },
      {
        "id": 3,
        "text": "Propofol"
      },
      {
        "id": 4,
        "text": "Thiamine infusion"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>With seizures occurring for 1 hour, this patient is suffering from <strong>status epilepticus</strong>. A second dose of <strong>lorazepam</strong> can be given to control this patient's seizures if there is no response after 5 minutes of administration of the first dose.\u00a0</p>\n<p>Status epilepticus refers to <strong>continuous</strong> seizures or <strong>repetitive</strong>, <strong>discrete</strong> seizures with <strong>impaired consciousness</strong> in the <strong>inter-ictal period</strong>. For practical purposes, it is defined as any one of the following:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Continuing seizures &gt;5 minutes or</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">No regaining of consciousness between 2 seizures.</li>\n</ul>\n<p>Management of status epilepticus:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b2c4d09f0aae43149167777293a4c3c6x1280x1788.JPEG"
    ]
  },
  {
    "text": "A 16-year-old girl, who is taking antiepileptics, has had a seizure-free period of 6 months. She has no family history of epilepsy. Her EEG is now normal and she has a normal neurological exam and intelligence. What would your advice be?",
    "choices": [
      {
        "id": 1,
        "text": "Stop the treatment and follow up"
      },
      {
        "id": 2,
        "text": "Gradually taper the drug and stop treatment"
      },
      {
        "id": 3,
        "text": "Continue treatment for another 18 months"
      },
      {
        "id": 4,
        "text": "Continue lifelong treatment with antiepileptics"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Other options:</p>\n<p>Option A: <strong>Sudden cessation</strong> of drug therapy may cause <strong>recurrence</strong> of seizure hence not advised.</p>\n<p>Option B: The patient has a seizure-free interval of only 6 months and therefore, is not yet eligible for considering medication withdrawal.</p>\n<p>Option D: Life-long treatment is not necessary in this case as the patient meets all the above-mentioned criteria for drug withdrawal after 2 years.</p>\n<p>Note: <strong>Juvenile myoclonic epilepsy</strong> (JME), the most common idiopathic generalized epilepsy syndrome is known to have a high risk of seizure recurrence, and hence <strong>antiepileptics</strong> are continued <strong>lifelong</strong> in a majority of patients.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man on antiepileptic therapy for GTCS presents with weight gain, alopecia and thrombocytopenia. Which of the following antiepileptic drugs is the most likely cause for this presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Phenytoin"
      },
      {
        "id": 2,
        "text": "Carbamazepine"
      },
      {
        "id": 3,
        "text": "Lamotrigine"
      },
      {
        "id": 4,
        "text": "Valproate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Weight gain</strong>, <strong>alopecia</strong>, and <strong>thrombocytopenia</strong> are the side effects of <strong>valproate</strong> use.</p>\n<p>Adverse effects of Sodium&nbsp;Valproate (mnemonic: <strong>VALPROATE</strong>)</p>\n<ul>\n<li><strong>V</strong>omiting</li>\n<li><strong>A</strong>lopecia</li>\n<li><strong>L</strong>iver toxicity</li>\n<li><strong>P</strong>ancreatitis</li>\n<li><strong>R</strong>ash</li>\n<li><strong>O</strong>besity</li>\n<li><strong>A</strong>norexia</li>\n<li><strong>T</strong>eratogenicity (most common: spina bifida), thrombocytopenia, tremors&nbsp;</li>\n<li><strong>E</strong>dema</li>\n</ul>\n<p>The first-line agents for treating GTCS are valproate, leviteracetam, and lamotrigine.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following features would you not expect to see in a patient with West syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Infantile spasms"
      },
      {
        "id": 2,
        "text": "Abnormal EEG"
      },
      {
        "id": 3,
        "text": "Developmental regression"
      },
      {
        "id": 4,
        "text": "Caf\u00e9 au lait"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Caf&eacute; au lait</strong> is a neurocutaneous marker seen in <strong>neurofibromatosis</strong>, not a component of West syndrome.&nbsp;</p>\n<p>The <strong>triad</strong> of <strong>West syndrome</strong> is:</p>\n<ul>\n<li>Infantile spasms (also called Salaam spells)</li>\n<li>Developmental regression</li>\n<li>Hypsarrhythmia (abnormal EEG)</li>\n</ul>\n<p>West syndrome is treated with:</p>\n<ul>\n<li>ACTH injections</li>\n<li>Vigabatrin if associated with tuberous sclerosis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 4-month-old child was brought with repeated epileptic spasms. The child had reached his normal milestone at the age of 2\u2009months. But the parents noticed that he lost the ability to hold his head steadily and he recently couldn't track light or sound. The EEG findings are shown below. What is the drug of choice for the treatment of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "ACTH"
      },
      {
        "id": 2,
        "text": "Vigabatrin"
      },
      {
        "id": 3,
        "text": "Gabapentin"
      },
      {
        "id": 4,
        "text": "Pregabalin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given scenario is of <strong>infantile</strong> <strong>spasms</strong>, <strong>developmental regression&nbsp;</strong>and the EEG showing <strong>hypsarrhythmia</strong> is suggestive&nbsp;of <strong>West syndrome.</strong> The drug of choice for this condition is <strong>ACTH.&nbsp;</strong></p>\n<p>West syndrome&nbsp;is a rare type of epilepsy syndrome that begins in <strong>infancy</strong>. It is&nbsp; characterized by a triad of</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Infantile spasm (also called <strong>salaam spells</strong>)&nbsp;is a convulsive disease characterized by brief, symmetric axial muscle contraction (neck, trunk, and/or extremities).</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Developmental regression</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Hypsarrhythmia (Himalayan wave pattern) on EEG: Characterized by a&nbsp;high-voltage, slow, chaotic background with multifocal spikes&nbsp;</li>\n</ul>\n<p>Treatment of West syndrome includes:</p>\n<ul>\n<li>ACTH</li>\n<li>Vigabatrin if associated with <strong>tuberous sclerosis</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d6d904bf59764876ac6c40c43d33cab9.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs is effective in controlling infantile spasms in a patient who has the neurocutaneous marker as shown in image?",
    "choices": [
      {
        "id": 1,
        "text": "Prednisolone"
      },
      {
        "id": 2,
        "text": "ACTH"
      },
      {
        "id": 3,
        "text": "Vigabatrin"
      },
      {
        "id": 4,
        "text": "Gabapentin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows a <strong>Shagreen patch</strong>, which is a typical feature of tuberous sclerosis.&nbsp;<strong>Vigabatrin</strong> is effective in the control of seizures in patients with tuberous sclerosis.</p>\n<p><strong>Tuberous sclerosis </strong>(Bourneville disease) is an <strong>autosomal dominant</strong> disease caused by mutations in either the<strong> <em>TSC1</em></strong> or the <strong><em>TSC2</em> gene</strong>. The clinical features seen are as follows:&nbsp;</p>\n<ul>\n<li>Seizures</li>\n<li>Intellectual disability</li>\n<li>Adenoma sebaceum (facial angiofibromas)</li>\n<li>Shagreen patch</li>\n<li>Hypomelanotic macules</li>\n<li>Periungual fibromas</li>\n<li>Renal angiomyolipomas</li>\n<li>Cardiac rhabdomyomas.</li>\n</ul>\n<p>A Shagreen patch is an irregularly thickened, slightly elevated, soft, skin-colored plaque, usually in the <strong>lumbosacral region</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/67b3cdb78be5479e8b6cc6bd725f3921.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 14-year-old boy develops an episode of involuntary jerky movements of the left hand accompanied by a repetitive chewing movement. He had a blank look on his face and was unresponsive during this episode. He also has no memory of the episode. EEG was normal and MRI showed hippocampal sclerosis. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Juvenile myoclonic epilepsy"
      },
      {
        "id": 2,
        "text": "Lennox-Gastaut syndrome"
      },
      {
        "id": 3,
        "text": "Gelastic epilepsy"
      },
      {
        "id": 4,
        "text": "Mesial temporal lobe epilepsy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario of <strong>focal seizure </strong>with<strong> impaired consciousness</strong> which along with<strong> hippocampal sclerosis</strong> is suggestive of <strong>mesial temporal lobe epilepsy</strong>.</p>\n<p>The following image shows left hippocampal sclerosis:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/52adefba5adc43cdac6b7b288d8751b7x1280x687.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is false regarding mesial temporal lobe epilepsy ?",
    "choices": [
      {
        "id": 1,
        "text": "It results in focal seizures with dyscognitive features"
      },
      {
        "id": 2,
        "text": "The person experiences an\u00a0aura\u00a0before the seizure"
      },
      {
        "id": 3,
        "text": "It is associated with a family history of epilepsy"
      },
      {
        "id": 4,
        "text": "Seizures can be controlled with anticonvulsants such as carbamazepine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Seizures of <strong>mesial temporal lobe epilepsy</strong> are not controlled with carbamazepine. The condition is <strong>refractory to anticonvulsant</strong> therapy but <strong>responds well</strong> to <strong>surgical intervention</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs must be avoided in myoclonic seizures?",
    "choices": [
      {
        "id": 1,
        "text": "Valproate"
      },
      {
        "id": 2,
        "text": "Levatriacetam"
      },
      {
        "id": 3,
        "text": "Ethosuxamide"
      },
      {
        "id": 4,
        "text": "Oxcarbazepine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Oxcarbazepine</strong> is known to <strong>worsen myoclonic seizures</strong> and is therefore contraindicated in it.</p>\n<p>Drugs like carbamazepine, oxcarbazepine and phenytoin can worsen the myoclonic, absence, tonic and atonic seizures and are therefore avoided.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is seen in patients with Lennox-Gastaut syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Atypical febrile seizures"
      },
      {
        "id": 2,
        "text": "Single type of seizures"
      },
      {
        "id": 3,
        "text": "EEG showing less than 3Hz Spike and wave discharge"
      },
      {
        "id": 4,
        "text": "Good prognosis with adequate control"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>EEG showing <strong>&lt;3Hz spike</strong> and <strong>wave</strong> discharge is a characteristic feature of <strong>Lennox-Gastaut syndrome</strong>.</p>\n<p>Lennox-Gastaut syndrome is a rare type of epilepsy syndrome that begins in <strong>childhood</strong>. It may occur due to various reasons such as developmental anomalies, mutations, trauma, infections, etc. It is characterized by a typical triad of&nbsp;</p>\n<ul>\n<li aria-level=\"1\">Multiple seizure types</li>\n<li aria-level=\"1\">Intellectual disability&nbsp;</li>\n<li aria-level=\"1\">Typical &lt;3 Hz spike and wave pattern on EEG</li>\n</ul>\n<p>Treatment includes administration of anti-epileptic drugs such as <strong>lamotrigine</strong> and <strong>sodium valproate</strong>. It is frequently refractory to medical therapy and usually has a poor prognosis.</p>\n<p>Note:&nbsp;EEG with <strong>symmetric&nbsp;3 Hz</strong> spike and wave&nbsp;pattern is seen in <strong>typical absence seizure</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false regarding Lafora\u2019s disease?",
    "choices": [
      {
        "id": 1,
        "text": "Myoclonus is seen"
      },
      {
        "id": 2,
        "text": "Autosomal recessive"
      },
      {
        "id": 3,
        "text": "Diagnosis by DNA sequencing"
      },
      {
        "id": 4,
        "text": "Treatment with glucocerebrosidase infusions"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Glucocerebrosidase infusions are not the treatment for Lafora's disease<strong>.</strong>&nbsp;There is no approved treatment for<strong> Lafora body disease</strong>.</p>\n<p>The mainstay of management is <strong>anti-epileptic drugs</strong>, valproate in particular; however, other AEDs such as topiramate, ethosuximide, and phenobarbital can be used to control seizures. Most recently, perampanel, a new AMPA receptor antagonist AED, is shown to be effective.</p>\n<p>Lafora body disease is an <strong>autosomal recessive</strong> neurodegenerative disease and has an adolescent onset. It is associated with polyglucosan intracellular inclusion bodies. It is characterized by:&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Progressive myoclonus</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Epileptic seizures</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Dementia&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Ataxia.&nbsp;</li>\n</ul>\n<p>Diagnosis is by <strong>DNA sequencing</strong>. Death usually occurs within 10 years of the onset of the disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are at a criminal court to provide medical testimony. The trial ends with the accused being sentenced to life imprisonment. Abruptly, the convict breaks into uncontrollable laughter. Within minutes, he collapses and starts to have a seizure. His lawyer reports that he has a childhood seizure disorder. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gelastic seizures"
      },
      {
        "id": 2,
        "text": "Kluver Bucy syndrome"
      },
      {
        "id": 3,
        "text": "Witzelsucht"
      },
      {
        "id": 4,
        "text": "Pseudobulbar affect"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given scenario is suggestive of a\u00a0<strong>gelastic seizure.\u00a0</strong></p>\n<p>This condition is\u00a0also known as gelastic epilepsy, and is a rare type of\u00a0seizure\u00a0that involves a <strong>sudden burst of energy</strong>, usually in the form of\u00a0<strong>laughing</strong>\u00a0or crying. It is seen when the\u00a0seizure focus is within the <strong>left prefrontal cortex.\u00a0</strong>Gelastic seizures have been associated classically with hypothalamic hamartomas.</p>\n<p>Option A:<strong> Kluver Bucy syndrome\u00a0</strong>is characterized by hypersexuality, placidity, a tendency to explore the environment with the mouth, inability to recognize the emotional significance of visual stimuli, and constantly shifting attention, called hypermetamorphosis.</p>\n<p>Option B: <strong>Witzelsucht </strong>is<strong>\u00a0</strong>a tendency to joke and make puns.</p>\n<p>Option C: <strong>Pseudobulbar affect</strong> is defined by involun\u00adtary, sudden, and frequent episodes of laughing or crying that are generally out of proportion or inappropriate to the situation.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old girl is brought to the OPD following a generalized tonic-clonic seizure. She had previous episodes of sudden falls at school and also sometimes stares with a blank face. She is also found to be having poor scholastic performance. Her EEG reveals a slow spike and wave pattern.  What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Focal seizures progressing to generalized seizures"
      },
      {
        "id": 2,
        "text": "Myoclonic epilepsy progressing to generalized seizures"
      },
      {
        "id": 3,
        "text": "Lenox-Gastaut syndrome"
      },
      {
        "id": 4,
        "text": "Atypical absence seizures"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario reveals <strong>multiple types of seizures</strong> such as atonic seizures (sudden falls), absence seizures (blank stares and unresponsive), and generalized tonic-clonic seizures in this patient. This is a characteristic feature of<strong> Lenox-Gastaut syndrome</strong>.&nbsp;</p>\n<p>Lennox-Gastaut syndrome is a rare type of epilepsy syndrome that begins in <strong>childhood</strong>. It may occur due to various reasons such as developmental anomalies, mutations, trauma, infections, etc. It is characterized by a typical triad of&nbsp;</p>\n<ul>\n<li aria-level=\"1\">Multiple seizure types</li>\n<li aria-level=\"1\">Intellectual disability&nbsp;</li>\n<li aria-level=\"1\">Typical &lt;3 Hz spike and wave pattern on EEG</li>\n</ul>\n<p>Treatment includes administration of anti-epileptic drugs such as <strong>lamotrigine</strong> and <strong>sodium valproate</strong>. It is frequently refractory to medical therapy and&nbsp;usually has a poor prognosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '073 Seizures And Epilepsy';
        const quizFilename = '073-seizures-and-epilepsy-875cccb9.html';
        let hierarchy = ["Marrow", "qBank", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>