<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recent Updates Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "About incentives in NTEP, which of the following statements are true?",
    "choices": [
      {
        "id": 1,
        "text": "2 Only"
      },
      {
        "id": 2,
        "text": "1, 2, 3"
      },
      {
        "id": 3,
        "text": "1, 3"
      },
      {
        "id": 4,
        "text": "1, 3, 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>True</strong> statements about <strong>NTEP incentives</strong> are:</p>\n<p><strong>1. 500 rupees are monthly for nutritional supplementation.</strong></p>\n<p><strong>3. 500 rupees are provided for every case notification.</strong></p>\n<p><strong>NTEP(National Tuberculosis Elimination Program)</strong> is run by the Government of India <strong>to combat and reduce </strong>the disease burden caused by <strong>Tuberculosis</strong> <strong>in India</strong>. It is based on four strategic pillars of \"<strong>Detect - Treat - Prevent - Build</strong>\". Under the umbrella of NTEP, various schemes provide incentives and financial benefits to patients as well as health workers.</p>\n<p>Under <strong>Nikshay Poshan Yojana</strong>, a financial <strong>incentive of Rs.500/- per month</strong> is provided for nutritional support to <strong>each notified TB patient </strong>for the duration for which the patient is on anti-TB treatment.</p>\n<p>Under the <strong>TB Mukt Bharat Abhiyan</strong>, <strong>monthly food baskets</strong> are provided to <strong>patients suffering from TB</strong>. These methods are aimed to reduce the out-of-pocket expenditure of patients with TB.</p>\n<p>Also <strong>under</strong> <strong>Nikshay, Rupees 500</strong> are provided to <strong>health workers and private practitioners</strong> for <strong>notifying</strong> about a confirmed TB case. The guideline for <strong>TB notification</strong> under the <strong>NTEP</strong> is within <strong>30 days (a month)</strong> of receiving a new case. The notification must be done to the <strong>District Health Officer </strong>or<strong> the Chief Medical Officer</strong> of a District Hospital by the practitioner who diagnosed it.</p>\n<p>Also under the<strong> Direct Transfer Benefit scheme of Nikshay</strong> on successful completion of treatment, treatment providers are given <strong>2000 rupees</strong> for <strong>treating drug-sensitive, </strong>and<strong> 5000 rupees </strong>for treating <strong>drug-resistant TB.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are true regarding the WHO Next Generation Partograph?",
    "choices": [
      {
        "id": 1,
        "text": "1,3,4,5"
      },
      {
        "id": 2,
        "text": "1,2,4,5"
      },
      {
        "id": 3,
        "text": "1,2,3"
      },
      {
        "id": 4,
        "text": "2,4,5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>True </strong>statements about the <strong>WHO Next Generation Partograph/WHO Labour Care Guide</strong> are:</p>\n<p>2.)The active phase begins from 5cm of cervical dilatation</p>\n<p>4.)The second stage of labour is also plotted</p>\n<p>5.)It is to be used in all levels of healthcare</p>\n<p>WHO Labour Care Guide is the labour monitoring tool that includes new recommendations from the WHO based on emerging evidence on normal labour progression. The new <strong>WHO Next Generation Partograph</strong>(2020) differs from the previous <strong>WHO-modified partograph(2000) </strong>in the following aspects:</p>\n<p>a.)Documentation of labour progression starts only in the <strong>active</strong> stage and begins from <strong>5 cm</strong> of cervical dilatation.</p>\n<p>b.)<strong>No action and alert lines</strong>. Rather it has time-based cut-offs\u00a0for\u00a0each centimetre\u00a0of cervical dilatation to guide the obstetrician to take action.</p>\n<p>c.)Monitoring of the <strong>second stage of labour</strong> is included.</p>\n<p>d.)Addition of a section on <strong>supportive care</strong> of the mother- labour companionship, pain relief, oral fluid intake and posture.</p>\n<p>e.)<strong>Strength of</strong> Uterine <strong>contraction</strong> is <strong>not recorded</strong>, only frequency and duration of the contraction are noted.</p>\n<p>The <strong>WHO\u00a0labour care guide</strong> is to be implemented in <strong>all levels of health care(</strong>primary, secondary and tertiary) and is to be implemented globally(but especially in resource-limited countries). <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">It includes assessments and observations that are essential for the care of <strong>all pregnant women, regardless of their risk status.</strong></span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bed66248c3fc43d782052756d085c0ebx724x1024.JPEG"
    ]
  },
  {
    "text": "All of the following are indications of Retrograde intrarenal surgery to remove renal stones except?",
    "choices": [
      {
        "id": 1,
        "text": "Renal stone <2cm"
      },
      {
        "id": 2,
        "text": "Upper pole calculi"
      },
      {
        "id": 3,
        "text": "Obese patient"
      },
      {
        "id": 4,
        "text": "History of bleeding diathesis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Lower pole calculi </strong>and not of the Upper pole <strong>is an indication to perform RIRS</strong>(<strong>Retrograde intrarenal surgery</strong>).</p>\n<p><strong>RIRS</strong> is an <strong>endoscopic</strong> approach for <strong>managing renal stones</strong>. A slimmer and more flexible URS(Ureterorenoscopes) with an active defection of the tip and <strong>laser technology </strong>is used to perform RIRS. The scope has thinner fibres which allow <strong>for retrograde access</strong> to the <strong>kidney via the ureteric orifice.</strong> Thus it provides as an</p>\n<p><strong>Indications</strong> for <strong>Retrograde intrarenal surgery </strong>(RIRS) are:</p>\n<ul>\n<li>&nbsp;Renal stones &lt;2 cm.</li>\n<li>Lower pole calculi.</li>\n<li>Obesity</li>\n<li>Musculoskeletal deformities (e.g. kyphoscoliosis) and renal anomalies (horseshoe kidney or pelvic kidney).</li>\n<li>Bleeding diathesis.&nbsp;</li>\n</ul>\n<p><strong>RIRS</strong> <strong>avoids</strong> the <strong>morbidity</strong> associated <strong>with percutaneous nephrolithotomy (PCNL)</strong>. Laser is used as an energy source for stone fragmentation. URS and RIRS can also be used in patients with bleeding disorders, as they are <strong>less invasive than PCNL</strong>. <strong>Complications</strong> include <strong>ureteric perforation </strong>and<strong> avulsion </strong>although they occur less frequently with highly flexible scopes.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following parameters are included in the Eckardt score for achalasia?",
    "choices": [
      {
        "id": 1,
        "text": "2,3,4"
      },
      {
        "id": 2,
        "text": "1,3,4"
      },
      {
        "id": 3,
        "text": "1,2,4"
      },
      {
        "id": 4,
        "text": "1,2,3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>Achalasia-Eckardt score</strong> includes <strong>4</strong> <strong>parameters</strong>. They are <strong>weight loss, dysphagia, Retrosternal pain </strong>and<strong> Regurgitation</strong>. <strong>Abdominal</strong> pain is <strong>not a part</strong> of the scoring.</p>\n<p>Achalasia is a primary oesophagal motility disorder. It is characterized by the <strong>absence</strong> of oesophagal<strong>\u00a0peristalsis</strong>\u00a0and\u00a0<strong>impaired lower oesophagal sphincter (LES) relaxation </strong>in response to swallowing.\u00a0</p>\n<p>It presents with a characteristic\u00a0<strong>triad</strong> of Dysphagia, Regurgitation and Weight loss. On the barium swallow, the <strong>bird's beak appearance</strong> of the oesophagus is seen in Achalasia. <strong>Esophageal manometry</strong> is the \"gold standard\" investigation for diagnosis. The manometry findings seen in Achalasia are <strong>impaired LES relaxation</strong>\u00a0and\u00a0<strong>absent peristalsis\u00a0</strong>with <strong>elevated LES pressure. </strong>Endoscopy and biopsy are usually carried out to rule out cancer.</p>\n<p>The \u2018<strong>Eckardt score</strong>\u2019 has been developed <strong>to assess the severity </strong>of symptoms and<strong> monitor outcomes </strong>in patients with Achalasia.</p>\n<table style=\"border-collapse: collapse; width: 100.052%;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 18.5452%;\"><strong>Score</strong></td>\n<td style=\"width: 18.5452%;\"><strong>Weight loss(in kgs)</strong></td>\n<td style=\"width: 18.5452%;\"><strong>Dysphagia\u00a0</strong></td>\n<td style=\"width: 18.5452%;\"><strong>Retrosternal pain</strong></td>\n<td style=\"width: 18.5452%;\"><strong>Regurgitation</strong></td>\n</tr>\n<tr>\n<td style=\"width: 18.5452%;\"><strong>0</strong></td>\n<td style=\"width: 18.5452%;\">None</td>\n<td style=\"width: 18.5452%;\">None</td>\n<td style=\"width: 18.5452%;\">None</td>\n<td style=\"width: 18.5452%;\">None</td>\n</tr>\n<tr>\n<td style=\"width: 18.5452%;\"><strong>1</strong></td>\n<td style=\"width: 18.5452%;\">&lt;5</td>\n<td style=\"width: 18.5452%;\">Occasionally</td>\n<td style=\"width: 18.5452%;\">Occasionally</td>\n<td style=\"width: 18.5452%;\">Occasionally</td>\n</tr>\n<tr>\n<td style=\"width: 18.5452%;\"><strong>2</strong></td>\n<td style=\"width: 18.5452%;\">5-10</td>\n<td style=\"width: 18.5452%;\">Daily</td>\n<td style=\"width: 18.5452%;\">Daily</td>\n<td style=\"width: 18.5452%;\">Daily</td>\n</tr>\n<tr>\n<td style=\"width: 18.5452%;\"><strong>3</strong></td>\n<td style=\"width: 18.5452%;\">&gt;10</td>\n<td style=\"width: 18.5452%;\">Each meal</td>\n<td style=\"width: 18.5452%;\">Each meal\u00a0</td>\n<td style=\"width: 18.5452%;\">Each meal</td>\n</tr>\n</tbody>\n</table>\n<p>A <strong>higher score</strong> translates to <strong>severe disease</strong>.</p>\n<p><strong>Achalasia management</strong> can be medical, including <strong>sublingual nitroglycerin, nitrates or calcium channel blockers.</strong> But medical management has a limited role in the treatment and surgical intervention is sooner or later needed. <strong>Laparoscopic myotomy, pneumatic balloon dilatation and POEM(Peroral endoscopic myotomy) </strong>are effective treatments for achalasia.</p>\n<p>\u00a0</p>\n<p>The image below shows the <strong>Bird's beak appearance</strong> of the oesophagus on the barium swallow.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c63c94d7ab9479d8f8b01ec64882fffx513x962.JPEG"
    ]
  },
  {
    "text": "Which of the following is not true about the modified Duke criteria for a definitive diagnosis of infective endocarditis?",
    "choices": [
      {
        "id": 1,
        "text": "Presence of single pathological criteria is definitive of infective endocarditis"
      },
      {
        "id": 2,
        "text": "Fever >38.0\u00b0C (>100.4\u00b0F) is a minor criteria"
      },
      {
        "id": 3,
        "text": "The diagnosis of endocarditis is rejected if an alternative diagnosis is established"
      },
      {
        "id": 4,
        "text": "Presence of 1 major + 2 minor is definitive endocarditis in clinical criteria"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>If clinical criteria are used, definitive endocarditis is defined by the presence of\u00a0<strong>2 major\u00a0</strong>(or)\u00a0<strong>1 major + 3 minor </strong>(or)\u00a0<strong>5 minor criteria.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are true regarding TB drug resistance?",
    "choices": [
      {
        "id": 1,
        "text": "1,2,3,4"
      },
      {
        "id": 2,
        "text": "2,3"
      },
      {
        "id": 3,
        "text": "2 Only"
      },
      {
        "id": 4,
        "text": "1 only"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>True</strong> statements is&nbsp;<strong>MDR-TB implies resistance to Isoniazid and Rifampicin.</strong></p>\n<p>The <strong>NTEP</strong> classifies drug resistance patterns for TB into <strong>5&nbsp;groups:</strong>&nbsp;</p>\n<table border=\"1\" cellspacing=\"1\" cellpadding=\"1\">\n<tbody>\n<tr>\n<td rowspan=\"2\"><strong>Types of Drug Resistance TB (DR TB)</strong></td>\n<td colspan=\"4\" rowspan=\"1\"><strong>Resistant to</strong></td>\n</tr>\n<tr>\n<td><strong>Isoniazid (H)</strong></td>\n<td><strong>Rifampicin (R)</strong></td>\n<td><strong>Fluroquinolones (FQ) =&nbsp;</strong><br /><strong>Ofloxacin,&nbsp;Levofloxacin,&nbsp;</strong><br /><strong>Moxifloxacin</strong></td>\n<td><strong>Group A Drugs =&nbsp;</strong><br /><strong>Bedaquiline/&nbsp;Linezolid</strong></td>\n</tr>\n<tr>\n<td>H Mono / Poly Drug Resistance</td>\n<td><strong>Resistant</strong></td>\n<td><strong>Sensitive</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n</tr>\n<tr>\n<td>Rifampicin Resistance (RR)</td>\n<td><strong>Unknown/ Sensitive</strong></td>\n<td><strong>Resistant</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n</tr>\n<tr>\n<td>Multi Drug Resistance TB (MDR TB</td>\n<td><strong>Resistant</strong></td>\n<td><strong>Resistant</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n</tr>\n<tr>\n<td>Pre-Extensive Drug Resistance (Pre -XDR)</td>\n<td><strong>Resistant</strong></td>\n<td><strong>Resistant</strong></td>\n<td><strong>Resistant</strong></td>\n<td><strong>Unknown/ Sensitive</strong></td>\n</tr>\n<tr>\n<td>Extensive Drug Resistance (XDR)</td>\n<td><strong>Resistant</strong></td>\n<td><strong>Resistant</strong></td>\n<td><strong>Resistant</strong></td>\n<td><strong>Resistant</strong></td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following IT platforms with their relevant application.",
    "choices": [
      {
        "id": 1,
        "text": "1-c, 2-b, 3-d, 4-a"
      },
      {
        "id": 2,
        "text": "1-a, 2-d, 3-b, 4-c"
      },
      {
        "id": 3,
        "text": "1-c, 2-d, 3-b, 4-a"
      },
      {
        "id": 4,
        "text": "1-c, 2-d, 3-a, 4-b"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct match is 1-c, 2-d, 3-b, 4-a:</p>\n<table style=\"border-collapse: collapse; width: 385px; height: 149px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 189px;\"><strong>IT- Platform:</strong></td>\n<td style=\"width: 189px;\"><strong>Used for:</strong></td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">1.) Kilkari</td>\n<td style=\"width: 189px;\">c.) Pregnant women and new mothers</td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">2.) Mobile academy</td>\n<td style=\"width: 189px;\">d.) Training of ASHA</td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">3.) Nikshay</td>\n<td style=\"width: 189px;\">b.) TB patient monitoring</td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">4.) Nikusth</td>\n<td style=\"width: 189px;\">a.) Leprosy patient monitoring</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p><strong>Kilkari<em>\u00a0</em></strong>is a new scheme under <strong>NRHM</strong>(National Rural Health Mission). It is a <strong>mobile health education service</strong> that provides <strong>pregnant</strong> women, <strong>new mothers</strong>, and their families with timely, accessible, accurate and relevant information about Reproductive, Maternal, Neonatal and Child health.\u00a0<span data-preserver-spaces=\"true\">It consists of an <strong>Interactive pre-recorded Voice Response (IVR)</strong> system, which informs pregnant women about pregnancy and child health care, covering the expected events from the <strong>4th month of conception</strong> until the <strong>child is one year</strong> <strong>old</strong></span><strong><span data-preserver-spaces=\"true\">. </span></strong><span data-preserver-spaces=\"true\">Each call is for\u00a0</span><strong><span data-preserver-spaces=\"true\">2 minutes </span></strong>and s<span data-preserver-spaces=\"true\">ervices are available in all states in their\u00a0</span><strong><span data-preserver-spaces=\"true\">regional dialects.</span></strong></p>\n<p><strong>Mobile Academy</strong> is a <strong>Reproductive Maternal Neonatal and Child health training course </strong>designed to refresh <strong>ASHA</strong> workers\u2019 knowledge of life-saving preventative health behaviours and improve the quality of their engagement with new and expecting mothers and their families.\u00a0</p>\n<p><strong>Nikusth</strong><strong>\u00a0</strong>is a real-time\u00a0<strong>web-based system</strong>\u00a0for data management for\u00a0<strong>leprosy</strong> cases. It is software for <strong>monitoring</strong>\u00a0leprosy patients,<strong>\u00a0</strong>with a\u00a0<strong>patient tracking mechanism</strong>\u00a0launched by the Health &amp; Family Welfare Minister Government of India.</p>\n<p><strong>NIKSHAY</strong> is a web-based solution for monitoring\u00a0\u00a0<strong>TB</strong>\u00a0<strong>patients.\u00a0</strong>(The word is a combination of two Hindi words NI and KSHAY, meaning eradication of TB).</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Auxiliary liver transplantation is beneficial in which of the following conditions:",
    "choices": [
      {
        "id": 1,
        "text": "Acute liver failure"
      },
      {
        "id": 2,
        "text": "Hepatocellular carcinoma"
      },
      {
        "id": 3,
        "text": "Genetic Hemochromatosis"
      },
      {
        "id": 4,
        "text": "Chronic viral hepatitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Auxiliary liver transplantation</strong> is beneficial in <strong>acute liver failure.</strong></p>\n<p>Auxiliary liver transplantation involves implanting a healthy liver graft <strong>heterotopically </strong>or<strong> orthotopically</strong> while leaving the whole or part of the native liver intact. The <strong>auxiliary partial orthotopic LT (APOLT)</strong> technique is used in patients with<strong> acute liver failure</strong> and <strong>metabolic diseases </strong>(primary hypercholesterolemia, glycogen storage disorders, organic acidemia, etc). In acute liver failure, this technique helps in native liver regeneration and <strong>immunosuppression withdrawal</strong>. In children with metabolic liver diseases, this technique helps in <strong>future gene therapy</strong>.</p>\n<p>Options B, C, and D are chronic liver diseases not suitable for auxiliary liver transplantation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 21-year-old male patient is admitted to the emergency department due to breathlessness and hypotension after penetrating trauma to the chest. His heart sounds are muffled and the ECG findings are given below. Which of the following is not indicated in managing this patient?",
    "choices": [
      {
        "id": 1,
        "text": "I.V fluids"
      },
      {
        "id": 2,
        "text": "e-FAST"
      },
      {
        "id": 3,
        "text": "Pericardiocentesis"
      },
      {
        "id": 4,
        "text": "Left antero-lateral thoracotomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given patient came with <strong>penetrating chest trauma </strong>and had <strong>muffled heart sounds.</strong> The ECG shows\u00a0<strong>decreased voltage</strong>\u00a0and\u00a0<strong>electrical alternans</strong> (alternating amplitude of QRS complexes). All these features suggest the diagnosis of <strong>Cardiac Tamponade secondary to penetrating trauma</strong>. <strong>Needle Pericardiocentesis</strong> is <strong>not done</strong> for patients with Cardiac tamponade after <strong>penetrating</strong> trauma.</p>\n<p><strong>Cardiac tamponade</strong>\u00a0is characterized by the accumulation of fluid in the\u00a0<strong>pericardial space</strong>\u00a0leading to\u00a0<strong>impairment of diastolic relaxation</strong> of the cardiac chambers. This leads to a decline in cardiac output. The characteristic signs of cardiac tamponade are <strong>Beck's triad, </strong>which consists<strong> of </strong><strong>hypotension, </strong><strong>muffled heart sounds,\u00a0</strong>and\u00a0<strong>elevated jugular venous pressure.</strong></p>\n<p><strong>ECG</strong>\u00a0shows\u00a0<strong>reduced voltage </strong>and <strong>electrical alternans.</strong>\u00a0Electric alternans\u00a0is a specific finding caused by the\u00a0anteroposterior swinging\u00a0of the heart with each contraction. When the heart is nearer to the chest wall, it leads to an increased amplitude deflection on the ECG, whereas, a lower amplitude deflection is seen when the heart moves away from the chest wall.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f9445de15bd442a4917eb1889cb012eb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d34269cd1a0b463dbc4794ed662ad203x1280x1090.JPEG"
    ]
  },
  {
    "text": "As per the IAP standard treatment guidelines 2022, which of the following factors are considered risk factors for developing subsequent epilepsy in a child with febrile seizures?",
    "choices": [
      {
        "id": 1,
        "text": "Only 1 and 3"
      },
      {
        "id": 2,
        "text": "Only 2 and 4"
      },
      {
        "id": 3,
        "text": "1,2,3,4"
      },
      {
        "id": 4,
        "text": "Only 3 and 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Risk factors</strong> for developing <strong>subsequent epilepsy</strong> in a child with febrile seizures include:</p>\n<ol>\n<li>Family history of epilepsy</li>\n<li>Any neurodevelopmental problem</li>\n<li>Prolonged or focal febrile seizures</li>\n<li>Febrile status epilepticus</li>\n</ol>\n<p><strong>Febrile seizures</strong> are described as seizures that occur in children of the age of <strong>6&ndash;60 months </strong>with a temperature of <strong>38&ordm;C</strong>&nbsp;(<strong>100.4&deg;F) or higher</strong>, without underlying intracranial infections or prior unprovoked seizures. <strong>Epilepsy</strong> is a disorder of the brain characterized by a predisposition to generate <strong>repeated seizures.&nbsp;</strong>Children with <strong>simple</strong> febrile seizures have a <strong>1% risk of developing epilepsy</strong> <strong>by</strong> the age of<strong> 7 years</strong> (<strong>same as the general population</strong>) and 2.4% by 25 years of age.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which is the new IAP recommendation for the first line treatment of Rickets in children?",
    "choices": [
      {
        "id": 1,
        "text": "Stoss therapy"
      },
      {
        "id": 2,
        "text": "Bolus on day 1, followed by Daily Vitamin D supplementation"
      },
      {
        "id": 3,
        "text": "Daily treatment with Vitamin D"
      },
      {
        "id": 4,
        "text": "Alternate day Vitamin D supplementation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>IAP(Indian Academy of Pediatrics)</strong> now recommends <strong>daily&nbsp; Vitamin D as the first line of treatment </strong>in children with <strong>rickets</strong>.</p>\n<p>A deficiency of vitamin D results in poor mineralization of the bone, leading to <strong>rickets in childre</strong>n. Rickets presents with&nbsp;skeletal changes&nbsp;like&nbsp;bowing of legs&nbsp;and&nbsp;bone pain once the child starts to walk. Prominent costochondral joints (<strong>rachitic rosary</strong>), craniotabes, scoliosis, fractures, dental anomalies and alopecia may also be seen. <strong>Radiological features</strong>&nbsp;show&nbsp;<strong>cupping at metaphyses</strong>,&nbsp;<strong>fraying</strong>, and&nbsp;<strong>widening of the growth plate</strong>.</p>\n<p><strong>IAP</strong> has updated the <strong>treatment guidelines</strong> for children with <strong>rickets</strong>:</p>\n<p><strong>Daily treatment </strong>with <strong>oral</strong> <strong>Vitamin</strong> <strong>D</strong> preparations is recommended, as daily supplementation is more physiological. The duration of treatment is <strong>at least 12 weeks.</strong> Vitamin D dosage is <strong>2000 I.U in infants </strong>and <strong>3000 I.U in children over one year of age</strong>. <strong>Calcium</strong> <strong>intake of 50-75 mg/kg/day </strong>(not exceeding 500 mg/day) must be ensured through diet or supplementation with vitamin D. <strong>Monitoring</strong> during treatment is done with <strong>radiographs</strong> and lab values of <strong>Serum calcium, phosphate, alkaline phosphatase and serum 25 (OH)D levels.</strong></p>\n<p><strong>Stoss therapy</strong> was earlier used for treating Vitamin D deficiency. Here,&nbsp;<strong>300,000-600,000 IU</strong> of vitamin D was administered orally or intramuscularly in 2 or 4 doses <strong>over 1 day</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following diseases is not included in NP-NCD?",
    "choices": [
      {
        "id": 1,
        "text": "Non alcoholic fatty liver disease"
      },
      {
        "id": 2,
        "text": "Chronic Kidney disease"
      },
      {
        "id": 3,
        "text": "Hypothyroidism"
      },
      {
        "id": 4,
        "text": "COPD"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Hypothyroidism is not included in the NP-NCD program<strong>.</strong></p>\n<p>The <strong>NPCDCS</strong> (National Program for Prevention and Control of Cancer, Diabetes, Cardiovascular Diseases and Stroke) has been <strong>changed to NP-NCD </strong>(<strong>National Program for Prevention and Control of Non-Communicable Diseases</strong>). It now includes initiatives and guidelines on the prevention and management of new diseases like:</p>\n<ul>\n<li><strong>Non-alcoholic fatty liver disease</strong></li>\n<li><strong>Chronic Kidney disease</strong></li>\n<li><strong>Asthma, COPD</strong></li>\n<li><strong>STEMI</strong></li>\n<li><strong>Stroke</strong></li>\n</ul>\n<p>It continues to<strong> include</strong> the <strong>diseases</strong> already covered in <strong>NPCDCS</strong>. For effective program management, the NCD divisions have been established at <strong>National, State, and District headquarters </strong>to ensure the activities' planning, implementation, monitoring, and evaluation.</p>\n<p>The NPCDCS program was first introduced under the NHM(National Health Mission) umbrella in 2010, to prevent screen, and treat Non-communicable diseases in India. In 2018, Non-Communicable Diseases like Cardiovascular diseases, Cancer, Chronic Respiratory Diseases, Diabetes, and other NCDs were estimated to account for 63% of all deaths, thus making them the leading causes of death. <strong>Hypothyroidism </strong>has<strong> never</strong> been a<strong> part of the program</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a component of the REDS path in the National suicide prevention strategy?",
    "choices": [
      {
        "id": 1,
        "text": "Reduce suicidal deaths by 2% in the next 5 years"
      },
      {
        "id": 2,
        "text": "Enhance health services to provide suicide prevention strategies"
      },
      {
        "id": 3,
        "text": "Develop community resilience, and societal support for suicide prevention"
      },
      {
        "id": 4,
        "text": "Strengthen surveillance and evidence generation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The&nbsp;<strong>National Suicide Prevention Strategy (NSPS)</strong> is a multisectoral approach that will involve national and international government ministries, families and communities, and educational institutes. It aims to <strong>reduce suicide mortality by 10%</strong> in India by <strong>2030.</strong></p>\n<p>It recommends<strong> REDS </strong>path for suicide prevention.</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>R</strong>einforce leadership, partnership, and institutional capacity in the country</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>E</strong>nhance the health services capacity to provide suicide prevention services</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>D</strong>evelop community resilience, societal support for suicide prevention and reduce stigma against suicidal behaviours</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>S</strong>trengthen surveillance and evidence generation.&nbsp;</li>\n</ul>\n<p><strong>Objectives</strong></p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">To establish<strong> effective surveillance mechanism</strong> for suicide prevention in <strong>next 3 years</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">To establish <strong>psychiatric OPDs</strong> that provide suicide prevention services through District Mental Health Programme, within <strong>next 5 years</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">To <strong>integrate mental well-being curriculum</strong> in all educational institutes within <strong>next 8 years</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a new drug approved by the FDA for the treatment of Rett syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Olcegepant"
      },
      {
        "id": 2,
        "text": "Lasmiditan"
      },
      {
        "id": 3,
        "text": "Trofinetide"
      },
      {
        "id": 4,
        "text": "Erenumab"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span style=\"font-size: 12pt;\"><strong>Trofinetide</strong> is the newly <strong>FDA-approved drug</strong> for the treatment of <strong>Rett syndrome.</strong></span></p>\n<p><span style=\"font-size: 12pt;\">The mechanism by which trofinetide exerts therapeutic effects in patients with Rett syndrome is<strong> unknown</strong>. It is a synthetic analog of the amino\u2010terminal tripeptide of insulin-like growth factor (IGF-1) designed to treat the core symptoms of Rett syndrome by <strong>potentially reducing neuroinflammation and supporting synaptic function of the protein fragment glypromate (GPE).&nbsp;</strong>IGF-1 is produced by both major types of brain cells &ndash; neurons and glia; IGF-1 in the brain is critical for both normal development and response to injury and disease<strong>.&nbsp;</strong>Trofinetide has been shown to <strong>inhibit the production of inflammatory cytokines,</strong> <strong>inhibit overactivation of microglia and astrocytes</strong>, and <strong>increase the amount of available IGF-1 </strong>that can bind to IGF-1 receptors.</span></p>\n<p><span style=\"font-size: 12pt;\">It is<strong>&nbsp;</strong>Indicated for the treatment of <strong>Rett syndrome.</strong></span></p>\n<p><span style=\"font-size: 12pt;\"><strong>Adverse effects</strong> include diarrhea, vomiting, fever, seizure, anxiety, decreased appetite, fatigue, nasopharyngitis</span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-size: 16px;\">Other options:</span></p>\n<p><span style=\"font-size: 16px;\">Option A:&nbsp;<strong>Olcegepant</strong>&nbsp;is a calcitonin gene-related peptide (<strong>CGRP</strong>)&nbsp;<strong>antagonist</strong> which was considered for the treatment of&nbsp;<strong>migraine,</strong>&nbsp;but discontinued.</span></p>\n<p><span style=\"font-size: 16px;\">Option B:&nbsp;<strong>Lasmiditan</strong>&nbsp;is&nbsp;</span><span style=\"font-size: 12pt;\">a nontriptan 5HT1F receptor&ndash;selective agonist&nbsp;</span><span style=\"font-size: 16px;\">and is used to treat migraine.</span></p>\n<p><span style=\"font-size: 16px;\">Option D:&nbsp;<strong>Erenumab</strong> is a&nbsp;<strong>CGRP (calcitonin gene-related peptide) blocking antibody</strong>&nbsp;used in the treatment migraine.</span>&nbsp;</p>\n<p>&nbsp;</p>\n<p>Note: The spelling of the drug in the options has been corrected from Trofin<strong data-stringify-type=\"bold\">i</strong>tide to Trofin<span style=\"background-color: #ffff00;\"><strong data-stringify-type=\"bold\">e</strong></span>tide.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Open vial policy is not applicable to which of the following vaccines?",
    "choices": [
      {
        "id": 1,
        "text": "Hepatitis B"
      },
      {
        "id": 2,
        "text": "BCG"
      },
      {
        "id": 3,
        "text": "Pentavalent vaccine"
      },
      {
        "id": 4,
        "text": "Rotoviral vaccine in New container"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Open vial policy</strong> is not applicable for BCG and measles vaccines.</p>\n<p>It is <strong>applicable</strong> for:</p>\n<ul>\n<li>DPT</li>\n<li>TT</li>\n<li><strong>Hepatitis B</strong> vaccine</li>\n<li><strong>OPV</strong></li>\n<li><strong>Pentavalent</strong> vaccine</li>\n<li>Rotavirus vaccine (New version with the VVM on the side)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-month-old male child with a cough and cold for the last 7 days is taken to an ASHA worker by his mother. On examination, the child had a respiratory rate of 42 breaths/min and no chest indrawing or grunting.  What would be the next step followed by the ASHA worker?",
    "choices": [
      {
        "id": 1,
        "text": "ASHA herself advices for home-based care"
      },
      {
        "id": 2,
        "text": "ASHA  refers the child to the nearby PHC"
      },
      {
        "id": 3,
        "text": "ASHA gives the first dose of oral Amoxicillin"
      },
      {
        "id": 4,
        "text": "ASHA gives the first dose of injectable Amoxicillin and refers to District hospital"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>next best step</strong> for the <strong>ASHA</strong> worker is to <strong>herself give advice for home-based care.</strong></p>\n<p>The <strong>6-month</strong>-old child with a cough and cold for 7 days, having a <strong>respiratory rate of 42 breaths per minute</strong> and <strong>no</strong> <strong>chest indrawings </strong>or<strong> grunting</strong> is classified as <strong>\"No pneumonia\".</strong> According to the latest <strong>SAANS</strong> guidelines (<strong>Social Awareness and Actions to Neutralize Pneumonia Successfully)</strong>, for a child with No Pneumonia, an ASHA worker on her own will advise Home-based care for the child.\u00a0</p>\n<p><strong>Home-based care</strong> includes:</p>\n<ul>\n<li>Exclusive breastfeeding for &lt;6 months old child as much as possible.</li>\n<li>For older children give plenty of oral fluids</li>\n<li>Home-made soothing cough remedies can be given to children more than 6 months old.</li>\n<li>Mothers should be taught about the danger signs and report to the ASHA worker or ANM if any danger signs develop.</li>\n</ul>\n<p>For classifying Pneumonia, <strong>SAANS guidelines </strong>of India\u00a0are similar to the <strong>IMNCI protocols</strong> of WHO, <strong>except</strong> it <strong>allows ASHA to take the decision for advising Home based treatment</strong> as she has been trained for classifying Pneumonia. Also in the SAANS guidelines<strong> Chest indrawing is a feature of severe pneumonia, </strong>while it comes under Pneumonia in the IMNCI guidelines.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a4f8278785984aec8966e3e0b39cb7d0x1280x1813.JPEG"
    ]
  },
  {
    "text": "All of the following surgical procedures can be conducted in a Primary Health Center (PHC) except _____.",
    "choices": [
      {
        "id": 1,
        "text": "Vasectomy"
      },
      {
        "id": 2,
        "text": "Cholecystectomy"
      },
      {
        "id": 3,
        "text": "Incision and drainage of abscesses"
      },
      {
        "id": 4,
        "text": "Hydrocelectomy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Cholecystectomy is not a surgical procedure that is conducted in a PHC. The surgical&nbsp;procedures done in PHC include <strong>suturing</strong> of wounds,<strong> incision and drainage </strong>of abscesses,<strong> v</strong><strong>asectomy</strong>, <strong>tubectomy</strong>, and<strong>&nbsp;hydrocelectomy</strong>.</p>\n<p>Services provided under PHC:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a false statement about the Indian Hypertension Control Initiative (IHCI)?",
    "choices": [
      {
        "id": 1,
        "text": "The IHCI monitoring personnel includes cardiovascular health officers and senior treatment supervisors"
      },
      {
        "id": 2,
        "text": "Provision of real-time blood pressure monitoring for all patients via information systems"
      },
      {
        "id": 3,
        "text": "The IHCI provides 30-day medication for individuals registered for hypertension management"
      },
      {
        "id": 4,
        "text": "The target is a 90% reduction in the prevalence of hypertension by the year 2025"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The false statement about the Indian Hypertension Control Initiative is a 90% reduction in the prevalence of hypertension by the year 2025.\u00a0</p>\n<p>The IHCI is an initiative by the <strong>MoHFW, WHO, ICMR, and state governments</strong> to control hypertension in India. It has adopted the goal of <strong>\u201c25 by 25\u201d</strong> to <strong>reduce the prevalence of hypertension</strong> in India <strong>by 25% by 2025</strong>. The activities of IHCI are monitored by the <strong>cardiovascular health officers (CVHO's)</strong> at the state and district level and by the <strong>senior treatment supervisors (STS's)</strong> at the sub-district level.\u00a0The IHCI has strengthened the prevention of hypertension by ensuring the <strong>provision of antihypertensive medications</strong> for <strong>30 days</strong> to all patients registered under the IHCI.</p>\n<p>The 5 components of IHCI are:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Use of <strong>standardized hypertension treatment protocols</strong> approved by national and global policies.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Availability of recommended protocol drugs</strong> to provide a regular and uninterrupted supply of medications.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Task-sharing </strong>and<strong> team-based care</strong> involving nurses, health workers, and ASHAs to improve treatment compliance.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Patient-centered services</strong> provide easy access to BP monitoring at Health &amp; wellness centers and PHCs.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Information systems</strong> that provide real-time BP monitoring to improve patient follow-ups: Use of the <strong>\u201cSimple App\u201d</strong> in all IHCI states.</li>\n</ol>\n<p>*Note: Amlodipine, telmisartan, and chlorthalidone are the drugs of choice in the standardized treatment protocols of the IHCI.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 46-year-old male was diagnosed with a colorectal polyp. He was operated and a sessile, hyperplastic polyp measuring 24mm in diameter was completely removed. No evidence of an invasive disease was noted. What follow-up should be advised to this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Site check after 6 months by colonoscopy"
      },
      {
        "id": 2,
        "text": "Colonoscopy after every year"
      },
      {
        "id": 3,
        "text": "One-off colonoscopy at 3 years"
      },
      {
        "id": 4,
        "text": "No further follow-up is required"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>For a <strong>sessile</strong>, <strong>hyperplastic</strong> <strong>colorectal</strong> <strong>polyp</strong> measuring <strong>24mm</strong> in diameter, <strong>follow-up</strong> is done with a <strong>one-off colonoscopy at 3 years.</strong></p>\n<p><strong>Colorectal polyp</strong> is the term used for any <strong>protrusion</strong> of the <strong>mucosa </strong>of the colon and rectum. It encompasses a variety of <strong>histologically different tumours</strong> (like inflammatory polyps, hamartomatous polyps, serrated polyps, adenomas and malignant polyps). Polyps can occur singly, synchronously in small numbers or as part of a polyposis syndrome.\u00a0</p>\n<p><strong>Metaplastic or hyperplastic polyps</strong> are common and are <strong>generally</strong> considered <strong>benign</strong>. Sessile serrated lesions and hyperplastic polyps \u226510 mm may lead to dysplasia and malignancy along what is termed as the \u2018serrated pathway\u2019. Such polyps should be <strong>removed</strong> and a <strong>follow-up colonoscopy</strong> should be arranged.</p>\n<p>Based on the histological findings upon excision, follow-up is done as below:</p>\n<table style=\"border-collapse: collapse; width: 515px; height: 228px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 139.828px;\"><strong>Biopsy findings</strong></td>\n<td style=\"width: 155.766px;\">\u00a0</td>\n<td style=\"width: 209.406px;\"><strong>Follow-up protocol</strong></td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 139.828px; height: 22.3984px;\">Colo rectal cancer</td>\n<td style=\"width: 155.766px; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 209.406px; height: 22.3984px;\">A colonoscopy is done every year</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 139.828px; height: 22.3984px;\"><strong>&gt;20mm sessile polyp-</strong></td>\n<td style=\"width: 155.766px; height: 22.3984px;\"><strong>-if completely resected</strong></td>\n<td style=\"width: 209.406px; height: 22.3984px;\"><strong>One-off Followup Colonoscopy after 3 years</strong></td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 139.828px; height: 44.7969px;\">\u00a0</td>\n<td style=\"width: 155.766px; height: 44.7969px;\">-if residual disease present</td>\n<td style=\"width: 209.406px; height: 44.7969px;\">Site check at 2-6 months, yearly colonoscopy thereafter</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 139.828px; height: 22.3984px;\">High-risk polyp and\u00a0</td>\n<td style=\"width: 155.766px; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 209.406px; height: 22.3984px;\">One-off Follow-up Colonoscopy after 3 years</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 139.828px; height: 22.3984px;\">Low-risk polyp</td>\n<td style=\"width: 155.766px; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 209.406px; height: 22.3984px;\">No specific follow-up</td>\n</tr>\n</tbody>\n</table>\n<p>Thus in this patient follow-up colonoscopy after three years should be advised to look for recurrence.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a false statement regarding liver transplantation (LT)?",
    "choices": [
      {
        "id": 1,
        "text": "The ideal graft weight to recipient weight ratio (GRWR) in living donor transplant is >0.8 %."
      },
      {
        "id": 2,
        "text": "In domino LT, liver grafts with metabolic diseases is used as they are structurally and functionally normal."
      },
      {
        "id": 3,
        "text": "Extended criteria donors and paired-exchange LT decrease waitlist mortality."
      },
      {
        "id": 4,
        "text": "Reduced size LT involves dividing the whole liver into right lobe for an adult patient and left lateral segments for pediatric patients."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The false statement regarding liver transplantation is <strong>option D</strong>. <strong>Reduced-size liver transplantation</strong> involves the <strong>resection</strong> of a <strong>full-size liver</strong> to appropriately fit in the abdominal cavity of small adults/adolescents. It is reserved only for <strong>urgent transplantation</strong>.&nbsp;On the contrary, <strong>split LT</strong> involves <strong>dividing</strong> the whole donor liver into a <strong>left lateral segment</strong> (segments II and III) for a <strong>pediatric</strong> patient and a <strong>right lobe</strong> (segments I, IV-VIII) for an <strong>adult</strong> patient.</p>\n<p>Option A: The required graft volume in a living donor transplant is measured by graft weight to recipient weight ratio <strong>(GRWR)</strong> or ratio of graft volume <strong>(GV)</strong> to recipient standard liver volume<strong> (SLV)</strong>. The ideal<strong> GRWR</strong> is <strong>&gt;0.8 %</strong> or <strong>GV/SLV</strong> is <strong>&gt; 35%</strong>. The <strong>remnant</strong> donor liver mass is kept at <strong>&gt;30%</strong> for safe regeneration.</p>\n<p>Option B: <strong>Domino liver transplant</strong> involves transplanting a liver from a<strong> donor with metabolic disease</strong> (eg: familial amyloid polyneuropathy) to a <strong>recipient with end-stage liver disease</strong> (eg: hepatocellular carcinoma). The donor also receives an LT (healthy donor) and is prioritized over the end-stage liver disease recipient. As a liver with metabolic diseases is structurally and functionally normal, it can prolong the recipient&rsquo;s life by at least 15-20 years as they will not develop the metabolic disease immediately.</p>\n<p>Option C: <strong>Extended criteria donors/ECDs</strong> (liver grafts extracted from donors after circulatory death) and <strong>paired-exchange technique</strong> are used to <strong>decrease waitlist mortality</strong>. However, ECDs have poor graft function due to prolonged hypoxia and are associated with higher infection transmission and biliary complications.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Recent Updates Mini Test - -Tmt';
        const quizFilename = 'recent-updates-mini-test-tmt-075e6388.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>