<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>52 Internal And External Genitalia - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Anatomy
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">22</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following forms the marked structure?",
    "choices": [
      {
        "id": 1,
        "text": "External oblique aponeurosis"
      },
      {
        "id": 2,
        "text": "Muscle fibres of internal oblique"
      },
      {
        "id": 3,
        "text": "Fascia transversalis"
      },
      {
        "id": 4,
        "text": "Colle\u2019s fascia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Fascia transversalis</strong> forms the <strong>internal spermatic fascia</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c523daa0fcc541099cb66ebd0ee6a884.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following structures of the inguinal canal lies outside the internal spermatic fascia?",
    "choices": [
      {
        "id": 1,
        "text": "Pampiniform plexus of veins"
      },
      {
        "id": 2,
        "text": "Testicular artery"
      },
      {
        "id": 3,
        "text": "Testicular nerve plexus"
      },
      {
        "id": 4,
        "text": "Ilioinguinal nerve"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The<strong> ilioinguinal nerve</strong>&nbsp;lies <strong>outside&nbsp;</strong>the<strong> internal spermatic fascia </strong>of the spermatic cord.</p>\n<p><strong>Ilioinguinal nerve</strong>&nbsp;is not the content of the spermatic cord but it is the&nbsp;<strong>content</strong>&nbsp;of the&nbsp;<strong>inguinal canal</strong>.&nbsp;<span data-preserver-spaces=\"true\">The&nbsp;</span>ilioinguinal nerve<span data-preserver-spaces=\"true\">&nbsp;lies</span><strong><span data-preserver-spaces=\"true\">&nbsp;inferior</span></strong><span data-preserver-spaces=\"true\">&nbsp;to the cord in the inguinal canal.<strong>&nbsp;</strong>It provides innervation to the groin and medial aspect of the thigh, the upper part of the scrotum, and the penile root.<strong>&nbsp;</strong>It&nbsp;may be commonly<strong> injured</strong> during&nbsp;<strong>open hernia repair.&nbsp;</strong></span></p>\n<p><span data-preserver-spaces=\"true\">The&nbsp;<strong>spermatic cord</strong>&nbsp;is a structure that passes through the inguinal canal in males. The&nbsp;<strong>inguinal canal</strong>&nbsp;is a natural passageway between the muscle layers of the anterior abdominal wall in the region of the groin. It transmits the&nbsp;<strong>spermatic cord</strong>&nbsp;in males, the&nbsp;<strong>round ligament</strong>&nbsp;of the uterus in females, and the&nbsp;<strong>ilioinguinal nerve</strong>&nbsp;in both sexes.<br /></span></p>\n<p>The&nbsp;<strong>contents of the spermatic cord</strong>&nbsp;include:</p>\n<div class=\"page\" title=\"Page 1119\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Cremaster muscle fibers</li>\n<li><strong>Testicular artery</strong> and&nbsp;<strong>pampiniform plexus of veins</strong></li>\n<li><strong>Genital branch</strong>&nbsp;of the<strong>&nbsp;genitofemoral nerve</strong></li>\n<li>Vas deferens</li>\n<li>Cremasteric vessels</li>\n<li>Lymphatics</li>\n<li>Processus vaginalis</li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Coverings of the spermatic cord from inside to outside are:<br /></span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Internal spermatic fascia from fascia transversalis</span></li>\n<li><span data-preserver-spaces=\"true\">Cremasteric fascia</span></li>\n<li><span data-preserver-spaces=\"true\">External spermatic fascia from external oblique aponeurosis&nbsp;</span></li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/25a980644a984639b1691744622c7205x1279x1263.JPEG"
    ]
  },
  {
    "text": "Which of the following arteries gives rise to the cremasteric artery?",
    "choices": [
      {
        "id": 1,
        "text": "Internal pudendal artery"
      },
      {
        "id": 2,
        "text": "External pudendal artery"
      },
      {
        "id": 3,
        "text": "Inferior epigastric artery"
      },
      {
        "id": 4,
        "text": "Obturator artery"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> inferior epigastric artery,&nbsp;</strong>a branch of the external iliac artery&nbsp;gives rise to the <strong>cremasteric artery.</strong></p>\n<p>The cremasteric artery travels along with the spermatic cord to supply the cremaster muscle and other coverings of the cord.&nbsp;</p>\n<p>When the <strong>testicular artery</strong> is <strong>interrupted</strong>, there will be formation of <strong>collaterals</strong> from the <strong>cremasteric</strong> and <strong>deferential arteries</strong>. This will prevent the ischemia of the testis.</p>\n<p>Note: The <strong>Fowler-Stephens orchidopexy</strong> done for <strong>undescended abdominal testis</strong> is based on this collateral formation. In the first stage, testicular vessels are clipped laparoscopically to promote the collateral formation along the vas deferens. In the second stage, the testis along with collaterals and vas deferens are mobilized to the scrotum.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged man presents with right scrotal swelling and pain. On examination, transillumination is positive, and cough impulse is absent. His condition is due to the accumulation of fluid in which layer of the testis?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is a <strong>hydrocele. </strong>It is due to the accumulation of fluid in the<strong> tunica vaginalis</strong>&nbsp;of the testis that is derived from the&nbsp;<strong>peritoneum.</strong></p>\n<table style=\"height: 152px; width: 954px;\">\n<tbody>\n<tr>\n<td style=\"width: 240.4375px;\"><strong>Layers&nbsp;</strong><strong>of the testicular capsule&nbsp;</strong></td>\n<td style=\"width: 696.5625px;\"><strong>Features</strong></td>\n</tr>\n<tr>\n<td style=\"width: 240.4375px;\"><strong>Tunica vaginalis</strong></td>\n<td style=\"width: 696.5625px;\">\n<p><strong>Outermost</strong> layer</p>\n<p>Derived from processes vaginalis (embryological extension of peritoneum)</p>\n<p>Contains parietal and visceral layer with a potential space in between</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 240.4375px;\"><strong>Tunica albuginea</strong></td>\n<td style=\"width: 696.5625px;\">\n<p><strong>Intermediate</strong> tough layer made up of collagen fibers</p>\n<p>Numerous fibrous septa extend into the testis to form mediastinum testis</p>\n<p>Blood vessels, nerves, and testicular duct traverses the testicular capsule via the mediastinum testis</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 240.4375px;\"><strong>Tunica vasculosa</strong></td>\n<td style=\"width: 696.5625px;\">\n<p><strong>Innermost</strong> layer</p>\n<p>Contains plexus of blood vessels and loose connective tissue</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Clinical note: When the part of processus vaginalis between the internal inguinal ring and testis fails to obliterate, it forms a communication between the abdominal cavity and scrotum. This results in the formation of congenital inguinal hernia and&nbsp;congenital hydrocele.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ed96230d75d54434be2963f51006cbda.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/15a16b3dabb94c5998d4df92d4225966x1280x1309.JPEG"
    ]
  },
  {
    "text": "A 34-year-old man underwent surgery for an indirect inguinal hernia. During the procedure, the surgeon accidentally injured a nerve which has led to decreased sensation over the anterior one-third region of the scrotum and anteromedial region of the thigh. Which of the following nerves is most likely to be injured?",
    "choices": [
      {
        "id": 1,
        "text": "Perineal nerve"
      },
      {
        "id": 2,
        "text": "Posterior cutaneous nerve of thigh"
      },
      {
        "id": 3,
        "text": "Iliohypogastric nerve"
      },
      {
        "id": 4,
        "text": "Genitofemoral nerve"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>genitofemoral nerve</strong> is likely to be injured.&nbsp;The <strong>genital branch </strong>of the genitofemoral nerve innervates the <strong>anterior one-third</strong> of the <strong>scrotum</strong>, and the <strong>femoral branch</strong> innervates the <strong>anteromedial</strong> region of the<strong> thigh</strong>.&nbsp;</p>\n<table style=\"height: 192px; width: 465.78125px;\">\n<tbody>\n<tr style=\"height: 15px;\">\n<td style=\"width: 149px; height: 15px;\"><strong>Part of the scrotum</strong></td>\n<td style=\"width: 202px; height: 15px;\"><strong>Nerve supply</strong></td>\n<td style=\"width: 101.78125px; height: 15px;\"><strong>Root value</strong></td>\n</tr>\n<tr style=\"height: 40px;\">\n<td style=\"width: 149px; height: 40px;\">Anterior one-third</td>\n<td style=\"width: 202px; height: 40px;\">\n<p>Ilioinguinal nerve</p>\n<p>Genital branch of genitofemoral nerve</p>\n</td>\n<td style=\"width: 101.78125px; height: 40px;\">&nbsp;L1</td>\n</tr>\n<tr style=\"height: 47px;\">\n<td style=\"width: 149px; height: 47px;\">Posterior two-third</td>\n<td style=\"width: 202px; height: 47px;\">\n<p>Perineal branch of the posterior cutaneous nerve of thigh</p>\n<p>Posterior scrotal branches of the perineal nerve</p>\n</td>\n<td style=\"width: 101.78125px; height: 47px;\">&nbsp;S3&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>Clinical note: Considering the root values of the nerves supplying the scrotum, the spinal block should be given <strong>above </strong>the<strong> level of L1&nbsp;</strong>to anesthetise it.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which part of the epididymis contains sperms with low amplitude and high-frequency tail movements?",
    "choices": [
      {
        "id": 1,
        "text": "C"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "A"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The&nbsp;<strong>tail of the epididymis </strong>(marked as C) contains sperms with low amplitude and high-frequency tail movements.</p>\n<p>The motility of sperm plays an important role in the process of fertilization. Sperms acquire their <strong>motility </strong>and<strong> maturation </strong>in the<strong> epididymis.</strong></p>\n<table style=\"height: 174px; width: 759.421875px;\">\n<tbody>\n<tr>\n<td style=\"width: 292px;\"><strong>Head of the epididymis</strong></td>\n<td style=\"width: 453.421875px;\"><strong>Tail of the epididymis</strong></td>\n</tr>\n<tr>\n<td style=\"width: 292px;\">\n<p>High amplitude and low-frequency tail movements</p>\n</td>\n<td style=\"width: 453.421875px;\">\n<p>Low amplitude and high-frequency tail movements</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 292px;\">Responsible for the <strong>subtle motion</strong> of the sperms</td>\n<td style=\"width: 453.421875px;\">\n<p>Responsible for the <strong>rapid forward progression</strong> and aids in <strong>fertilization</strong></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>The epididymis&nbsp;has the following three parts:</p>\n<table style=\"height: 100px; width: 757px;\">\n<tbody>\n<tr>\n<td style=\"width: 157.8125px;\"><strong>Parts of the epididymis</strong></td>\n<td style=\"width: 586.1875px;\"><strong>Features</strong></td>\n</tr>\n<tr>\n<td style=\"width: 157.8125px;\"><strong>Head</strong></td>\n<td style=\"width: 586.1875px;\">Receives the immature spermatozoa from the superior pole of the testis through the efferent ducts</td>\n</tr>\n<tr>\n<td style=\"width: 157.8125px;\"><strong>Body</strong></td>\n<td style=\"width: 586.1875px;\">\n<p>Efferent ducts from the head open into the tubules of the epididymis</p>\n<p>These tubules coalesce forming a single, highly coiled tubule</p>\n<p>The wall of the body contains smooth muscles which propel the sperms towards the tail during ejaculation</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 157.8125px;\"><strong>Tail</strong></td>\n<td style=\"width: 586.1875px;\">The coiled tubule passes through the tail and continues as the vas deferens</td>\n</tr>\n</tbody>\n</table>\n<p>Clinical note:&nbsp;Cystic degeneration of epididymis can result in <strong>epididymal cysts</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/922285ad74f743fd9ce81e1dff506bda.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4dceb6493ae449249662c9f6f8caa99ax1280x1464.JPEG"
    ]
  },
  {
    "text": "A 50-year-old man was admitted to the emergency department with pain over the flank, associated with pain in the scrotum. On examination, you note a left-sided varicocele. CT scan revealed venous occlusion. Which of the following veins are most likely to be occluded?",
    "choices": [
      {
        "id": 1,
        "text": "Left suprarenal vein"
      },
      {
        "id": 2,
        "text": "Superior mesenteric vein"
      },
      {
        "id": 3,
        "text": "Left renal vein"
      },
      {
        "id": 4,
        "text": "Inferior venacava"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>left renal vein</strong> is likely to be occluded in this case. The <strong>left testicular vein</strong> drains into the left renal vein.<strong>&nbsp;</strong>Occlusion of the left renal vein impedes the blood flow in the left testicular veins. As a result, the veins become swollen and cause pain on the affected side.</p>\n<p>Venous drainage of the testis:</p>\n<p>The <strong>pampiniform plexus</strong> of veins arising from the testes&nbsp;ascend through the inguinal canal and abdomen. They&nbsp;coalesce to form the testicular veins during their course.</p>\n<ul>\n<li>The<strong> left testicular vein</strong> drains into the <strong>left renal vein</strong> at a right angle.</li>\n<li>The <strong>right testicular vein</strong> drains into the <strong>inferior vena cava</strong> at an acute angle.</li>\n</ul>\n<p>Clinical note: Varicose dilatation of the veins draining the testis is called <strong>varicocele.</strong> 90% of the varicocele occurs on the left side and mostly this is due to the absence or incompetence of valves in the testicular vein.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95acad8ca5eb48a2bb6662590fabea27x600x632.JPEG"
    ]
  },
  {
    "text": "Which of the following zones of the prostate primarily encircles the ejaculatory duct?",
    "choices": [
      {
        "id": 1,
        "text": "Fibromuscular zone"
      },
      {
        "id": 2,
        "text": "Transitional zone"
      },
      {
        "id": 3,
        "text": "Central zone"
      },
      {
        "id": 4,
        "text": "Peripheral zone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Note: Some regard fibromuscular stroma as a zone, but as per Gray's anatomy, 41e, there are only three distinct zones in the glandular prostate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7f43fcb60b864aefa2be6884f5567ac9x600x568.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is false about the prostate?",
    "choices": [
      {
        "id": 1,
        "text": "2 and 4"
      },
      {
        "id": 2,
        "text": "2 and 5"
      },
      {
        "id": 3,
        "text": "1, 3 and 5"
      },
      {
        "id": 4,
        "text": "1, 2 and 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Statements 1, 2 and 5 are false.&nbsp;</p>\n<p>The <strong>prostatic ducts</strong> open into the <strong>prostatic sinus&nbsp;</strong>in the prostatic urethra. The urethral crest is a midline ridge in the posterior wall of the prostatic urethra. The shallow depressions on either side of the ridge are called&nbsp;prostatic sinuses.</p>\n<p>The glandular part of the prostate contains <strong>numerous follicles</strong> separated by <strong>fibromuscular stroma.</strong> These <strong>follicles</strong> are lined by <strong>single-layered </strong>or pseudostratified<strong> columnar epithelium</strong>.</p>\n<p>Small eosinophilic colloid <strong>amyloid bodies </strong>called<strong> corpora amylacea</strong> are frequently seen within a follicle.</p>\n<p>The <strong>ducts</strong> of the <strong>prostate follicles</strong> are lined by <strong>bilayered epithelium</strong> (basal cuboidal and apical columnar).&nbsp;The secretions of the prostate are <strong>acidic</strong> and contain acid phosphatase, amylase, prostate-specific antigen (PSA), fibrinolysis, and zinc.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a36e4da3f71488db7851f21b0b974cdx600x574.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is false about seminal vesicles?",
    "choices": [
      {
        "id": 1,
        "text": "It is lined by pseudo-stratified columnar epithelium"
      },
      {
        "id": 2,
        "text": "It is supplied by inferior vesical artery"
      },
      {
        "id": 3,
        "text": "It acts as a storehouse for sperms"
      },
      {
        "id": 4,
        "text": "The secretions are alkaline"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Seminal vesicles do not store sperms.</p>\n<p>Seminal vesicles are paired <strong>accessory glandular</strong> structures of the male reproductive system located at the <strong>base of the prostate.&nbsp;</strong>The duct of the seminal vesicle joins with vas deferens to form the <strong>ejaculatory duct.&nbsp;</strong>The mucosa of the seminal vesicle is highly <strong>folded</strong> and is lined by <strong>pseudostratified columnar epithelium.</strong></p>\n<p>They secrete white-yellow viscous fluid and contribute to at least&nbsp;<strong>two-thirds </strong>of the volume of the<strong> semen.</strong> Secretions are rich in <strong>fructose,</strong> coagulation proteins, and prostaglandins. They are<strong> alkaline</strong> and play an important role in the <strong>motility </strong>and<strong> metabolism </strong>of the sperms.</p>\n<p>The <strong>vesiculo-deferential artery</strong>, a branch of the umbilical artery is the primary arterial supply of the seminal vesicles. Additional blood supply is from the <strong>inferior vesical artery</strong>. Venous drainage is by the vesiculo-deferential veins and inferior vesical plexus.&nbsp;Lymphatic drainage is to the <strong>internal iliac nodes</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following arteries gives rise to helicine arteries of the penis?",
    "choices": [
      {
        "id": 1,
        "text": "Dorsal artery of the penis"
      },
      {
        "id": 2,
        "text": "Deep artery of the penis"
      },
      {
        "id": 3,
        "text": "Bulbourethral artery"
      },
      {
        "id": 4,
        "text": "Perineal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The below image shows a cross-section of the shaft of the penis and the arteries supplying them.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f31c09511e364e3c87a648d57a6e88a4x600x790.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3ad7aefb65c9486ea8d192a29ba0db46x600x603.JPEG"
    ]
  },
  {
    "text": "Which part of the male urethra appears stellate in the transverse section?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>membranous part</strong>\u00a0(marked as 1) of the male urethra appears <strong>stellate</strong> in the transverse section.</p>\n<table style=\"height: 599px; width: 758px;\">\n<tbody>\n<tr style=\"height: 100px;\">\n<td style=\"width: 101px; height: 100px;\"><strong>Parts of the urethra</strong></td>\n<td style=\"width: 238.234375px; height: 100px;\"><strong>Extent</strong></td>\n<td style=\"width: 12.765625px; height: 100px;\">\n<p><strong>Appearance in transverse section</strong></p>\n</td>\n<td style=\"width: 114px; height: 100px;\"><strong>Structures opening</strong></td>\n<td style=\"width: 131px; height: 100px;\"><strong>Lining epithelium</strong></td>\n<td style=\"width: 195px; height: 100px;\"><strong>Clinical/anatomical significance</strong></td>\n</tr>\n<tr style=\"height: 108px;\">\n<td style=\"width: 101px; height: 108px;\">\n<p><strong>Pre-prostatic urethra </strong></p>\n<p>(1 cm)</p>\n</td>\n<td style=\"width: 238.234375px; height: 108px;\">From the base of the bladder to prostate</td>\n<td style=\"width: 12.765625px; height: 108px;\">Stellate</td>\n<td style=\"width: 114px; height: 108px;\">Small periurethral glands</td>\n<td style=\"width: 131px; height: 108px;\">\n<p>Transitional epithelium</p>\n</td>\n<td style=\"width: 195px; height: 108px;\">\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0-\u00a0</td>\n</tr>\n<tr style=\"height: 222px;\">\n<td style=\"width: 101px; height: 222px;\">\n<p><strong>Prostatic urethra </strong></p>\n<p>(3 to 4 cm)</p>\n</td>\n<td style=\"width: 238.234375px; height: 222px;\">Enclosed within the prostate</td>\n<td style=\"width: 12.765625px; height: 222px;\">Crescentic</td>\n<td style=\"width: 114px; height: 222px;\">\n<p>Prostatic ducts</p>\n<p>Ejaculatory duct</p>\n</td>\n<td style=\"width: 131px; height: 222px;\">\n<p>Transitional (till the opening of the ejaculatory duct)</p>\n<p>Pseudostratified or stratified columnar below the opening of ejaculatory duct</p>\n</td>\n<td style=\"width: 195px; height: 222px;\">Verumontanum is used as a surgical landmark for the urethral sphincter during TURP</td>\n</tr>\n<tr style=\"height: 126px;\">\n<td style=\"width: 101px; height: 126px;\">\n<p><strong>Membranous urethra </strong></p>\n<p>(2 to 2.5 cm)</p>\n</td>\n<td style=\"width: 238.234375px; height: 126px;\">From the prostate to the bulb of the penis</td>\n<td style=\"width: 12.765625px; height: 126px;\">Stellate\u00a0</td>\n<td style=\"width: 114px; height: 126px;\">\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-\u00a0 \u00a0</td>\n<td style=\"width: 131px; height: 126px;\">Pseudostratified or stratified columnar\u00a0</td>\n<td style=\"width: 195px; height: 126px;\">External urethral sphincter encircles the membranous urethra\u00a0</td>\n</tr>\n<tr style=\"height: 37px;\">\n<td style=\"width: 101px; height: 37px;\"><strong>Bulbar urethra\u00a0</strong></td>\n<td style=\"width: 238.234375px; height: 37px;\">Enclosed within the bulb (root) of the penis</td>\n<td style=\"width: 12.765625px; height: 37px;\">Transverse\u00a0</td>\n<td style=\"width: 114px; height: 37px;\">Ducts of bulbourethral (Cowper's) glands</td>\n<td style=\"width: 131px; height: 37px;\">Pseudostratified or stratified columnar\u00a0</td>\n<td style=\"width: 195px; height: 37px;\">\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -\u00a0</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 101px; height: 18px;\">\n<p><strong>Penile urethra </strong></p>\n<p>(15 cm - bulbar and penile)</p>\n</td>\n<td style=\"width: 238.234375px; height: 18px;\">Enclosed within the penile shaft\u00a0</td>\n<td style=\"width: 12.765625px; height: 18px;\">Transverse\u00a0</td>\n<td style=\"width: 114px; height: 18px;\">Ducts of the Littre glands</td>\n<td style=\"width: 131px; height: 18px;\">Distal end has stratified squamous epithelium\u00a0</td>\n<td style=\"width: 195px; height: 18px;\">\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -\u00a0</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2425ae84446b457a8d286d2a9924b2dc.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9724ce7936474c2a98d1c994439bd1efx1280x1572.JPEG"
    ]
  },
  {
    "text": "Which of the following is the periurethral gland in males?",
    "choices": [
      {
        "id": 1,
        "text": "Cowper's glands"
      },
      {
        "id": 2,
        "text": "Bartholin's glands"
      },
      {
        "id": 3,
        "text": "Skene's glands"
      },
      {
        "id": 4,
        "text": "Littre glands"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Littre glands</strong> are the <strong>periurethral glands</strong> in males. These glands are numerous in the penile urethra. They <strong>secrete mucus</strong> prior to ejaculation which helps in lubrication.</p>\n<p>Option A:<strong> Cowper's glands</strong>&nbsp;are the <strong>bulbourethral glands</strong> found in <strong>males.</strong> They are located lateral to the membranous urethra and opens via a duct into the bulbar urethra by piercing the perineal membrane. Their function is to <strong>secrete mucin</strong> during sexual arousal.</p>\n<p>Option C: <strong>Skene's glands</strong>&nbsp;are the <strong>paraurethral glands</strong> found in females. These open on either side of the urethra. They are considered homologous to the male prostate.</p>\n<p>Option B:<strong> Bartholin's glands</strong>&nbsp;are known as the<strong> greater vestibular glands</strong> in females. These glands are located in the posterior part of the vestibule and open through a duct into the vaginal orifice. They <strong>secrete mucus</strong> during sexual arousal for lubrication.</p>\n<p>Clinical note: Since all these glands open via a duct into the orifices, any <strong>obstruction</strong> in the <strong>duct</strong> can result in <strong>cyst formation. </strong>They&nbsp;can get infected and necessitate removal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/439e3db8eb534d14aa209789c97ab75ax600x738.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c86a5e96331a488193e9635fa9cf791ex1280x1533.JPEG"
    ]
  },
  {
    "text": "A patient presented with an enlarged inguinal lymph node. The most likely primary cause is",
    "choices": [
      {
        "id": 1,
        "text": "Testicular cancer"
      },
      {
        "id": 2,
        "text": "Anal cancer"
      },
      {
        "id": 3,
        "text": "Sigmoid colon cancer"
      },
      {
        "id": 4,
        "text": "Prostate cancer"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely primary cause of an enlarged <strong>inguinal lymph node</strong> is <strong>anal cancer.&nbsp;</strong></p>\n<p>Lymphatics from the anal canal <strong>distal</strong> to the <strong>dentate line</strong> (anal margin) drains into the&nbsp;<strong>inguinal lymph nodes</strong>. Hence, anal cancer arising distal to dentate line can cause enlarged inguinal lymph nodes. Lymphatics <strong>proximal</strong> to the dentate line&nbsp;(anal canal) drains into <strong>internal iliac lymph nodes</strong> through superior rectal lymphatics.</p>\n<p>Option A: In testicular cancer, lymphatic spread occurs to the paraaortic lymph nodes.</p>\n<p>Option C: In sigmoid colon cancer, lymphatic spread occurs to the regional lymph node and then to the central lymph node.</p>\n<p>Option D: In prostate cancer, lymphatic spread occurs to the:</p>\n<ul>\n<li>Lymph nodes beside the internal iliac vein and in the hollow of the sacrum</li>\n<li>External iliac lymph nodes.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following structures form the angle of anteversion?",
    "choices": [
      {
        "id": 1,
        "text": "Uterus and bladder"
      },
      {
        "id": 2,
        "text": "Uterus and cervix"
      },
      {
        "id": 3,
        "text": "Cervix and vagina"
      },
      {
        "id": 4,
        "text": "Cervix and bladder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The angle of <strong>anteversion</strong> is formed between the long axis of the&nbsp;<strong>cervix </strong>and the long axis of the<strong> vagina.</strong></p>\n<p>The angle of&nbsp;<strong>anteflexion&nbsp;</strong>which is formed by the body of the <strong>uterus </strong>and the long axis of the <strong>cervix.</strong></p>\n<p>When the whole of the uterus leans backwards at an angle to the vagina, it is called&nbsp;<strong>retroversion.</strong> If the uterus angles backwards in relation to cervix it is called <strong>retroflexion</strong><strong>.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/97b0fa86c11147938f740d39070d8462x1280x1399.JPEG"
    ]
  },
  {
    "text": "A 24-year-old primipara was brought to the ER with lower abdominal pain 6 hours after delivering her baby. On examination, pallor and cold clammy skin were present. Pulse was feeble and BP was 70/50 mm Hg. A bedside ultrasound revealed a broad ligament hematoma. Which of the following is not a content of the involved structure?",
    "choices": [
      {
        "id": 1,
        "text": "Round ligament"
      },
      {
        "id": 2,
        "text": "Fallopian tubes"
      },
      {
        "id": 3,
        "text": "Lymph nodes"
      },
      {
        "id": 4,
        "text": "Ovaries"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>ovaries</strong> are not the contents of the broad ligament.</p>\n<p>Ovaries are suspended in the pelvic cavity by the<strong> mesovarium. </strong>It&nbsp;attaches only the hilum of the ovary to the posterior surface of the broad ligament.&nbsp;The majority of the <strong>ovarian surface</strong> is covered by a single layer of<strong> cuboidal epithelium</strong> which imparts a <strong>dull white color</strong> to the ovaries.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following ligaments attaches the ovary to the lateral angle of the uterus?",
    "choices": [
      {
        "id": 1,
        "text": "Round ligament"
      },
      {
        "id": 2,
        "text": "Suspensory ligament"
      },
      {
        "id": 3,
        "text": "Mesovarium"
      },
      {
        "id": 4,
        "text": "Ovarian ligament"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>ovarian ligament</strong> (ligament of the ovary) attaches the inferomedial extremity of the <strong>ovary </strong>to the<strong> lateral angle </strong>of the<strong> uterus.</strong></p>\n<p>Other ligamentous supports of the ovaries:\u00a0</p>\n<ul>\n<li><strong>Infundibulo pelvic ligament\u00a0</strong>(suspensory ligament) - attaches the<strong> lateral surface </strong>of the<strong> ovary</strong> to the peritoneum lining the <strong>lateral pelvic wall.</strong> It contains the ovarian vessels and nerves.</li>\n<li><strong>Mesovarium</strong>\u00a0- a short peritoneal fold that attaches the <strong>ovary </strong>to the back of the<strong> broad ligament.</strong> This carries blood vessels and nerves to the hilum of the ovary.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c0f5e1e264874f03b1f994001acff4bdx1280x1242.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6cbee3c97cd6434495825e89acd01cbex1280x1396.JPEG"
    ]
  },
  {
    "text": "A 45-year woman presented with abdominal pain, distension, anorexia, and weight loss. Ultrasound abdomen revealed a unilocular cyst with a solid component arising from the right ovary.  CA-125 level is elevated. The tumor spreads to which of the following lymph nodes?",
    "choices": [
      {
        "id": 1,
        "text": "External iliac nodes"
      },
      {
        "id": 2,
        "text": "Internal iliac nodes"
      },
      {
        "id": 3,
        "text": "Obturator nodes"
      },
      {
        "id": 4,
        "text": "Para-aortic nodes"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>serous cystadenocarcinoma</strong> of the ovary. It spreads to the <strong>para-aortic nodes</strong> as the ovary is drained by them alongside the origin of the ovarian arteries.</p>\n<table style=\"height: 433px; width: 629.8125px;\">\n<tbody>\n<tr style=\"height: 0.21875px;\">\n<td style=\"width: 614.8125px; height: 0.21875px;\" colspan=\"2\">\n<h4>Lymphatic drainage of the female reproductive tract</h4>\n</td>\n</tr>\n<tr style=\"height: 41px;\">\n<td style=\"width: 132px; height: 41px;\"><strong>Vulva</strong></td>\n<td style=\"width: 482.8125px; height: 41px;\">\n<p>Skin of labia, clitoris, and perineum - Superficial inguinal nodes</p>\n<p>Clitoris -&nbsp;Deep inguinal (Cloquet's) node, internal iliac nodes</p>\n</td>\n</tr>\n<tr style=\"height: 10px;\">\n<td style=\"width: 132px; height: 10px;\"><strong>Vagina</strong></td>\n<td style=\"width: 482.8125px; height: 10px;\">\n<p>Upper vagina -&nbsp;Internal and External Iliac nodes</p>\n<p>Middle vagina -&nbsp;Internal Iliac nodes</p>\n<p>Lower vagina (below hymen) -&nbsp;Superficial Inguinal nodes</p>\n</td>\n</tr>\n<tr style=\"height: 43px;\">\n<td style=\"width: 132px; height: 43px;\"><strong>Cervix</strong></td>\n<td style=\"width: 482.8125px; height: 43px;\">External iliac, internal iliac and obturator nodes&nbsp;</td>\n</tr>\n<tr style=\"height: 69px;\">\n<td style=\"width: 132px; height: 69px;\"><strong>Uterus&nbsp;</strong></td>\n<td style=\"width: 482.8125px; height: 69px;\">\n<p>Fundus -<strong>&nbsp;</strong>Para-aortic nodes</p>\n<p>Isthmus of the tube and round ligament -&nbsp;Superficial inguinal lymph nodes</p>\n<p>Body -<strong>&nbsp;</strong>External iliac, internal iliac and obturator nodes</p>\n</td>\n</tr>\n<tr style=\"height: 27px;\">\n<td style=\"width: 132px; height: 27px;\"><strong>Fallopian Tubes</strong></td>\n<td style=\"width: 482.8125px; height: 27px;\">\n<p>Para-aortic, internal iliac, and superficial inguinal nodes(via round ligament)</p>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 132px; height: 18px;\"><strong>Ovaries</strong></td>\n<td style=\"width: 482.8125px; height: 18px;\">Para-aortic lymph nodes</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The lining epithelium of the fallopian tube is similar to which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Epithelium of stomach"
      },
      {
        "id": 2,
        "text": "Epithelium of trachea"
      },
      {
        "id": 3,
        "text": "Epithelium of bronchioles"
      },
      {
        "id": 4,
        "text": "Epithelium of proximal convoluted tubule"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>lining epithelium</strong> of the <strong>fallopian tube</strong> is a single layer of <strong>ciliated columnar epithelium. </strong>It is similar to the epithelium of the<strong> bronchioles.</strong></p>\n<p>The ciliated epithelial cells are predominant in the <strong>distal part</strong> of the fallopian tube. There is an increase in the height and number of cilia in these cells during the <strong>estrogenic phase</strong> of the menstrual cycle.</p>\n<p>Other cells in the fallopian tube epithelium include:</p>\n<ul>\n<li><strong>Secretory or peg cells -&nbsp;</strong>maximally located in the proximal portion of the tube. These cells are active around the time of ovulation, and their secretions help in the capacitation of sperms.</li>\n<li><strong>Intraepithelial lymphocytes</strong> - may present occasionally.&nbsp;</li>\n</ul>\n<p>Option A: Epithelium of stomach - simple columnar</p>\n<p>Option B: Epithelium of trachea - Pseudostratified ciliated columnar</p>\n<p>Option D: Epithelium of proximal convoluted tubule - cuboidal with microvilli.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following ligaments extends from the cervix and vagina to the lateral pelvic wall?",
    "choices": [
      {
        "id": 1,
        "text": "Broad ligament"
      },
      {
        "id": 2,
        "text": "Pubocervical ligament"
      },
      {
        "id": 3,
        "text": "Round ligament"
      },
      {
        "id": 4,
        "text": "Cardinal ligament"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The&nbsp;<strong>cardinal ligament </strong>(transverse cervical ligament or ligament of Mackenrodt) extends from the <strong>side of the cervix</strong> and <strong>lateral fornix</strong> of the vagina to the <strong>pelvic wall.</strong></p>\n<p>Other ligaments of the uterus:</p>\n<ul>\n<li><strong>Broad</strong> ligament&nbsp;- peritoneal fold covering the ovaries and fallopian tubes. It has three parts named after the structures it covers, i.e., mesosalpinx, mesovarium, and mesometrium (largest part).</li>\n<li><strong>Pubocervical</strong> ligament<strong> - </strong>attaches the anterior aspect of the cervix and upper vagina to the posterior aspect of the pubic bones.</li>\n<li><strong>Round</strong> ligaments<strong> - </strong>arises from the lateral cornua of the uterus, passes through the inguinal canal, and attaches to the labia majora.&nbsp;</li>\n<li><strong>Uterosacral</strong> ligaments - passes from the back of the uterus and cervix to the anterior surface of the sacrum.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da8e0cdac8c14fa68793db7f99a5279bx600x791.JPEG"
    ]
  },
  {
    "text": "Which of the following structures is not related to the posterior surface of the vagina?",
    "choices": [
      {
        "id": 1,
        "text": "Rectovaginal septum"
      },
      {
        "id": 2,
        "text": "Recto uterine pouch"
      },
      {
        "id": 3,
        "text": "Waldeyer's fascia"
      },
      {
        "id": 4,
        "text": "Perineal body"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Waldeyer's fascia </strong>(presacral fascia)&nbsp;forms the&nbsp;posterior relationship of the <strong>rectum</strong> and is&nbsp;not related to the vagina. It lines the anterior surface of the sacrum.</p>\n<p>Relations of the vagina:</p>\n<table style=\"height: 341px;\" width=\"518\">\n<tbody>\n<tr style=\"height: 47px;\">\n<td style=\"width: 83.65625px; height: 47px;\"><strong>Parts of vagina</strong></td>\n<td style=\"width: 96.140625px; height: 47px;\"><strong>Anterior relation</strong></td>\n<td style=\"width: 141.796875px; height: 47px;\"><strong>Posterior relation</strong></td>\n<td style=\"width: 168.4375px; height: 47px;\"><strong>Lateral relation</strong></td>\n</tr>\n<tr style=\"height: 223px;\">\n<td style=\"width: 83.65625px; height: 223px;\"><strong>Upper third</strong></td>\n<td style=\"width: 96.140625px; height: 223px;\">Bladder</td>\n<td style=\"width: 141.796875px; height: 223px;\">Peritoneum of the rectouterine pouch</td>\n<td style=\"width: 168.4375px; height: 223px;\">\n<p>Levator ani</p>\n<p>Transverse cervical ligament</p>\n<p>Pubocervical ligament</p>\n<p>Uterosacral ligament</p>\n<p>Ureter and uterine artery (related to the lateral fornix)</p>\n</td>\n</tr>\n<tr style=\"height: 47px;\">\n<td style=\"width: 83.65625px; height: 47px;\"><strong>Middle third</strong></td>\n<td style=\"width: 96.140625px; height: 47px;\">Bladder</td>\n<td style=\"width: 141.796875px; height: 47px;\">Rectovaginal fascia/septum</td>\n<td style=\"width: 168.4375px; height: 47px;\">Pubovaginalis muscle</td>\n</tr>\n<tr style=\"height: 47px;\">\n<td style=\"width: 83.65625px; height: 47px;\"><strong>Lower third</strong></td>\n<td style=\"width: 96.140625px; height: 47px;\">Urethra</td>\n<td style=\"width: 141.796875px; height: 47px;\">Perineal body</td>\n<td style=\"width: 168.4375px; height: 47px;\">Bulbospongiosus</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f2affe0d1406454ba5c2b953c3eef5ecx1280x1286.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ceace5513d7444f3af84c60c46b6b0e6x600x555.JPEG"
    ]
  },
  {
    "text": "Which of the following gives rise to azygous arteries of the vagina?",
    "choices": [
      {
        "id": 1,
        "text": "Internal iliac artery"
      },
      {
        "id": 2,
        "text": "Obturator artery"
      },
      {
        "id": 3,
        "text": "External iliac artery"
      },
      {
        "id": 4,
        "text": "Median sacral artery"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> internal iliac artery</strong> gives rise to the <strong>azygous arteries</strong> of the vagina.</p>\n<p>The azygous arteries are <strong>longitudinal median vessels</strong> and run on the anterior and posterior surfaces of the vagina. The vagina also receives blood supply from the uterine, internal pudendal, and middle rectal branches of the internal iliac artery.</p>\n<p>Blood supply of the female reproductive system:</p>\n<table style=\"height: 709px; width: 629px;\">\n<tbody>\n<tr style=\"height: 22px;\">\n<td style=\"width: 86px; height: 22px;\"><strong>Structure</strong></td>\n<td style=\"width: 251px; height: 22px; text-align: center;\"><strong>Arterial supply</strong></td>\n<td style=\"width: 271px; height: 22px; text-align: center;\"><strong>Venous drainage</strong></td>\n</tr>\n<tr style=\"height: 34px;\">\n<td style=\"width: 86px; height: 34px;\">\n<p><strong>&nbsp;</strong></p>\n<p><strong>Vulva</strong></p>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 251px; height: 34px;\">\n<p>Superficial and deep external pudendal arteries of the femoral artery</p>\n<p>Internal pudendal artery (inferior part of the vulva)</p>\n</td>\n<td style=\"width: 271px; height: 34px;\">Via external pudendal veins to the long saphenous vein&nbsp;</td>\n</tr>\n<tr style=\"height: 113px;\">\n<td style=\"width: 86px; height: 113px;\">\n<p>&nbsp;</p>\n<p><strong>Clitoris</strong></p>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 251px; height: 113px;\">\n<p>&nbsp;</p>\n<p>Branches of the internal pudendal artery</p>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 271px; height: 113px;\">\n<p>Via deep dorsal veins into the internal pudendal vein</p>\n<p>Via superficial dorsal veins into the external pudendal and long saphenous veins</p>\n</td>\n</tr>\n<tr style=\"height: 6px;\">\n<td style=\"width: 86px; height: 6px;\"><strong>Vagina</strong>&nbsp;</td>\n<td style=\"width: 251px; height: 6px;\">\n<p>Azygous arteries of the vagina from the internal iliac artery</p>\n</td>\n<td style=\"width: 271px; height: 6px;\">\n<p>&nbsp;Via vaginal vein into the internal iliac vein</p>\n</td>\n</tr>\n<tr style=\"height: 61px;\">\n<td style=\"width: 86px; height: 61px;\"><strong>Uterus</strong></td>\n<td style=\"width: 251px; height: 61px;\">\n<p>Uterine artery from the anterior division of the internal iliac artery</p>\n</td>\n<td style=\"width: 271px; height: 61px;\">\n<p>Via uterine veins into the internal iliac vein&nbsp;&nbsp;</p>\n</td>\n</tr>\n<tr style=\"height: 51px;\">\n<td style=\"width: 86px; height: 51px;\"><strong>Fallopian tube</strong></td>\n<td style=\"width: 251px; height: 51px;\">\n<p>Medial two-third - uterine artery</p>\n<p>Lateral one-third - ovarian artery&nbsp;</p>\n&nbsp;</td>\n<td style=\"width: 271px; height: 51px;\">\n<p>Medial two-third - via uterine plexus into the internal iliac vein</p>\n<p>Lateral one third - via the pampiniform plexus into the IVC on the right and the renal vein on the left</p>\n</td>\n</tr>\n<tr style=\"height: 57px;\">\n<td style=\"width: 86px; height: 57px;\"><strong>Ovary</strong>&nbsp;</td>\n<td style=\"width: 251px; height: 57px;\">Ovarian artery (direct branch of the abdominal aorta)</td>\n<td style=\"width: 271px; height: 57px;\">\n<div title=\"Page 1784\">\n<p>Ovarian veins emerge as a pampiniform plexus and form the ovarian veins draining into the IVC on the right, and the renal vein on the left side.</p>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '52 Internal And External Genitalia';
        let hierarchy = ["Marrow", "qBank", "Anatomy"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>