<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>148 Ent Inicet 2023 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / ENT
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">14</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 22 year old male presented with progressive left sided facial swelling for 2 weeks. There is history of traumatic injury with wood two months back. CECT nose and paranasal sinuses shows mass in subcutaneous tissue of left cheek. Biopsy of specimen shows foreign body granuloma with positive PAS and GMS stain. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Phycomycosis"
      },
      {
        "id": 2,
        "text": "Midline lethal granuloma"
      },
      {
        "id": 3,
        "text": "NK/T cell lymphoma"
      },
      {
        "id": 4,
        "text": "IgG4 granuloma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Other options:</strong></p>\n<p><strong>Option D: IgG4-related disease</strong> (IgG4-RD) is characterized by tissue infiltrates dominated by IgG4 antibodies (the hallmark of the disease). The pathogenesis of this condition is not understood. This condition leads to fibrosis and obliterative phlebitis. The patients may present as Riedel's thyroiditis, autoimmune pancreatitis, or idiopathic orbital inflammation. But not with <strong>ptosis as shown in the image.&nbsp;</strong>Diagnosis is established by <strong>positive fibrosis and the presence of plasma cells&nbsp;</strong>on biopsy.&nbsp;Rituximab is known to be beneficial. Sometimes, as a rare presentation, this can mimic Wegener's granulomatosis.</p>\n<p><strong>Option B: Midline lethal granuloma&nbsp;</strong>is a rare disease. It is characterized by necrotizing destruction and mutilation of the nose and other structures of respiratory passages. Generally, it is a diagnosis of exclusion. CT may be helpful in picking up the lesions. Negative c-ANCA and fungal stains also aid in the diagnosis.&nbsp;</p>\n<p><strong>Option C: NK/T cell lymphoma&nbsp;</strong>is a <strong>destructive lesion</strong> usually starting on one side of nose involving the upper lip, oral cavity, maxilla and sometimes even extending to orbit.Histologically polymorphic lymphoid tissue with angiocentric and angioinvasive features is seen. Immunochemical staining of biopsy material should be done for<strong> CD56+</strong> marker for diagnosis. Nearly all cases of T/NK cel lymphomas are associated with<strong> EB virus. Localized</strong> T/NK-cell lymphoma is treated by<strong> radiation</strong> while a <strong>disseminated</strong> disease requires <strong>chemotherapy</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8647d29ee4054858b404e09556d6041f.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Arrange the following structures in the hearing pathway from the receptors to the cortex -",
    "choices": [
      {
        "id": 1,
        "text": "3-2-4-6-7-5-1"
      },
      {
        "id": 2,
        "text": "2-3-4-6-7-5-1"
      },
      {
        "id": 3,
        "text": "2-3-6-4-5-7-1"
      },
      {
        "id": 4,
        "text": "3-2-6-4-7-5-1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct sequence of the auditory pathway is <strong>spiral ganglion</strong> -<strong> cochlear nucleus</strong> - <strong>Olivary complex</strong> -<strong>Lateral leminiscus</strong>-<strong> Inferior colliculus</strong>-<strong>Medial geniculate body-Auditory Cotex</strong>&nbsp;</p>\n<p>The spiral ganglion situated in Rosenthal's canal contains bipolar cells. The dendrites of these bipolar cells join to form the cochlear branch of the vestibulocochlear nerve which ends in the cochlear nuclei.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e41df44ff9ef4779a03d5417ecbc3668x1280x1441.JPEG"
    ]
  },
  {
    "text": "Identify the nerve block shown in the given image",
    "choices": [
      {
        "id": 1,
        "text": "Nasociliary nerve"
      },
      {
        "id": 2,
        "text": "Anterior ethmoidal nerve"
      },
      {
        "id": 3,
        "text": "Sphenopalatine nerve"
      },
      {
        "id": 4,
        "text": "Greater palatine nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image represents an anterior ethmoidal nerve block.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/144de01ff13149dabf6e588a1f49679c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/38038b3d86e349a3bc88ebfbce263c46x1280x1390.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5f4f5906fc340568c1de587e14b7e04x720x905.JPEG"
    ]
  },
  {
    "text": "Arrange the following in the sequence of auditory pathway:",
    "choices": [
      {
        "id": 1,
        "text": "1-2-3-4-5"
      },
      {
        "id": 2,
        "text": "5-4-3-2-1"
      },
      {
        "id": 3,
        "text": "2-1-3-4-5"
      },
      {
        "id": 4,
        "text": "3-4-5-1-2"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct sequence of the auditory pathway is <strong>spiral ganglion</strong>&nbsp;(2) -<strong> cochlear nucleus</strong>&nbsp;(1) - <strong>superior olivary nucleus</strong>&nbsp;(3) -<strong> inferior colliculus</strong>&nbsp;(4) - <strong>medial geniculate body&nbsp;</strong>(5).&nbsp;</p>\n<p>The <strong>spiral ganglion</strong> contains <strong>bipolar cells</strong> whose dendrites form the <strong>afferent supply</strong> for inner and outer <strong>hair cells</strong>&nbsp;of the organ of Corti and whose axons form the <strong>cochlear</strong> division of <strong>CN VIII</strong> that <strong>end in</strong> the <strong>cochlear nuclei</strong>.</p>\n<p>The auditory pathway&nbsp;can be remembered with the mnemonic <strong>E.C.O.L.I.M.A</strong></p>\n<div><strong>E</strong>ighth nerve&nbsp;</div>\n<div><strong>C</strong>ochlear nuclei&nbsp;</div>\n<div><strong>O</strong>livary complex&nbsp;</div>\n<div><strong>L</strong>ateral lemniscus&nbsp;</div>\n<div><strong>I</strong>nferior colliculus&nbsp;</div>\n<div><strong>M</strong>edial geniculate body&nbsp;</div>\n<div><strong>A</strong>uditory cortex</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e41df44ff9ef4779a03d5417ecbc3668x1280x1441.JPEG"
    ]
  },
  {
    "text": "A 14-year-old is brought to the opd with complaints that she is able to hear the sound of speech but has difficulty understanding words. Her PTA and BERA were inconsistent with each other, with PTA being more or less normal. Her middle latency and cortical responses were absent. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Michel aplasia"
      },
      {
        "id": 2,
        "text": "Auditory neuropathy"
      },
      {
        "id": 3,
        "text": "Malingering"
      },
      {
        "id": 4,
        "text": "Cochlear otosclerosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the clinical scenario, the history of a child presenting with complaints of inability to understand words with abnormal BERA and normal PTA(Pure Tone Audiometry) is suggestive of <strong>auditory neuropathy.</strong></p>\n<p><strong>Auditory neuropathy/auditory dyssynchrony</strong>&nbsp;is a condition that<strong> affects</strong> the <strong>neural processing of auditory stimuli</strong>.</p>\n<p><strong><span style=\"font-size: 12pt;\">Pathophysiology</span></strong></p>\n<div class=\"topbullet\">\n<ul>\n<li>Injury to the synaptic junction between inner hair cells of the cochlea and dendrites of spiral ganglion neurons</li>\n<li>Direct damage to the dendrites of the spiral ganglion neurons</li>\n<li>Direct injury to the spiral ganglion neurons</li>\n<li>Direct axonal damage to the auditory nerve&nbsp;</li>\n</ul>\n</div>\n<div class=\"topbullet\">\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Auditory neuropathy should be suspected in any<strong> child </strong>with<strong> severe speech and language delay</strong> out of proportion with the presumed hearing loss. </span></p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">All of the following must be present in newborns to diagnose auditory neuropathy:</span></p>\n</div>\n<div class=\"topbullet\">\n<ul>\n<li>Absent or <strong>severely abnormal ABR</strong> test results at maximal stimulus (100 dBnHL)</li>\n<li><strong>Normal </strong>outer hair cell function as determined by <strong>OAEs</strong>(Otoacoustic emission)</li>\n<li><strong>Absent or elevated stapedial reflex</strong> thresholds</li>\n</ul>\n<div class=\"topbullet\">\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">In addition, <strong>adults</strong> with mildly to moderately<strong> abnormal pure tone thresholds</strong> and <strong>speech discrimination scores out of proportion </strong>with suspected hearing loss should undergo additional evaluation. Some patients may have normal or slightly elevated audiogram pure tone thresholds&nbsp;</span></p>\n</div>\n<div class=\"topbullet\">\n<p>Management includes <strong>conventional hearing aids</strong>. If a child does not progress with hearing aid devices and shows limited speech discrimination abilities, <strong>cochlear implantation</strong> is the next viable option.</p>\n</div>\n<p>Other options</p>\n<p><strong>Option A:</strong></p>\n<div class=\"page\" title=\"Page 157\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Michel aplasia: </strong>There is a complete absence of bone and a membranous labyrinth. Even the petrous apex is absent but external and middle ears may be completely unaffected. The child presents with congenital sensorineural hearing loss. No hearing aids or cochlear implantation can be used.</p>\n</div>\n</div>\n</div>\n<p><strong>Option B: </strong></p>\n<p><strong>Malingering(Nonorganic hearing loss)</strong></p>\n<div class=\"page\" title=\"Page 65\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In this type of hearing loss, there is no organic lesion. <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Usually, there is a motive to claim some compensation for being exposed to industrial noises, head injury, or ototoxic medication. The patient may present with any of the three clinical situations: </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Total hearing loss in both ears, total loss in only one ear, or exaggerated loss in one or both ears.</span></p>\n<p><strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Investigations</span></strong></p>\n<div class=\"page\" title=\"Page 65\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Inconsistent results on Repeat Pure Tone and Speech Audiometry Tests</strong>: Normally, the results of repeat tests are within +5 dB. A variation greater than 15 dB is diagnostic of nonorganic hearing loss (NOHL).</p>\n<p><strong>Absence of Shadow Curve</strong>: Normally, a shadow curve can be obtained while testing bone conduction, if the healthy ear is not masked. This is due to the transcranial transmission of sound to the healthy ear. The absence of this curve in a patient complaining of unilateral deafness is diagnostic of NOHL.</p>\n<div class=\"page\" title=\"Page 66\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Inconsistency in PTA and SRT:</strong> Normally, the pure tone average (PTA) of three speech frequencies (500, 1000, and 2000 Hz) is within 10 dB of the speech reception threshold (SRT). An SRT is better than PTA by more than 10 dB points to NOHL.</p>\n<div class=\"page\" title=\"Page 66\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Stenger Test</strong>: It helps in identifying malingering&nbsp;</p>\n<div class=\"page\" title=\"Page 66\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Acoustic Reflex</strong>: Threshold Normally, the stapedial reflex is elicited at 70-100 dB sensation level. If the patient claims total deafness but the reflex can be elicited, it indicates nonorganic hearing loss (NOHL).</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p><strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option C:</span></strong></p>\n<p><strong><span data-preserver-spaces=\"true\">Otosclerosis&nbsp;</span></strong>is the disease of the bony labyrinth in which a normal dense endochondral layer of the bony otic capsule is replaced by irregularly laid spongy bone. It has a positive family history with an&nbsp;<strong><span data-preserver-spaces=\"true\">autosomal dominant trait.</span></strong>&nbsp;It is more commonly seen in&nbsp;<strong><span data-preserver-spaces=\"true\">females&nbsp;</span></strong>between<strong><span data-preserver-spaces=\"true\">&nbsp;20-30 years&nbsp;</span></strong>of age and the hearing loss is aggravated during&nbsp;<strong><span data-preserver-spaces=\"true\">pregnancy and menopause</span></strong>. It may be associated with osteogenesis imperfecta and a viral infection like<strong><span data-preserver-spaces=\"true\">&nbsp;measles.&nbsp;</span></strong></p>\n<p><strong><span data-preserver-spaces=\"true\">Stapedial otosclerosis&nbsp;</span></strong>is the<strong><span data-preserver-spaces=\"true\">&nbsp;most common&nbsp;</span></strong>type of otosclerosis. Here the lesion starts just in front of the oval window in an area called<strong><span data-preserver-spaces=\"true\">&nbsp;fissula ante fenestram.</span></strong></p>\n<p>Patients present with a&nbsp;<strong>bilateral conductive</strong>&nbsp;type of&nbsp;<strong>hearing loss, tinnitus</strong>&nbsp;(commonly in cochlear type and active stage),&nbsp;<strong>paracusis Willisii</strong> (better hearing in noisy surroundings than in a quiet place), vertigo, and a monotonous, well-modulated soft speech.</p>\n<p>The tympanic membrane is quite&nbsp;<strong>normal</strong>&nbsp;and<strong>&nbsp;mobile.&nbsp;</strong>Eustachian tube function is also normal. Pure tone audiometry shows a&nbsp;<strong>dip at 2000 Hz</strong>&nbsp;in the&nbsp;<strong>bone conduction</strong>&nbsp;curve known as the&nbsp;<strong>Carhart's notch</strong>. Tympanometry shows an&nbsp;<strong>As type</strong>&nbsp;of tympanogram in which there is reduced compliance at or near the ambient air pressure.</p>\n<p>On examination,&nbsp;<strong>Schwartz sign/flamingo flush</strong>&nbsp;showing a red blush of the tympanic membrane due to vascularity can be seen.</p>\n<p>Treatment includes medical, surgical management, and hearing aids. Medical management with<strong><span data-preserver-spaces=\"true\">&nbsp;sodium fluoride&nbsp;</span></strong>is used in the active stage to speed up the maturity of the active focus and halt further cochlear loss. The&nbsp;<strong><span data-preserver-spaces=\"true\">treatment of choice&nbsp;</span></strong>is surgical management which includes <strong><span data-preserver-spaces=\"true\">stapedotomy/stapedectomy&nbsp;</span></strong>with the placement of a prosthesis.&nbsp;<strong><span data-preserver-spaces=\"true\">Hearing aids&nbsp;</span></strong>are used in patients who refuse or are unfit for the surgery.</p>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A South Indian male cattle breeder comes with complaints of frank intermittent epistaxis. The examination of the nose is given below. A biopsy was taken and HPE appears as shown below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Nasal polyp"
      },
      {
        "id": 2,
        "text": "Rhinosporidiosis"
      },
      {
        "id": 3,
        "text": "Hemangioma"
      },
      {
        "id": 4,
        "text": "Rhinopyma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical image showing a <strong>polyp</strong> and the histopathology showing several <strong>sporangia</strong> is suggestive of <strong>rhinosporidiosis.&nbsp;</strong></p>\n<p><strong>Rhinosporidiosis</strong>&nbsp;is a chronic granulomatous disease caused by <strong>Rhinosporidium seeberi<em>. </em></strong>It is most prevalent in&nbsp;rural districts, among persons bathing in public ponds or&nbsp;working in stagnant water, such as <strong>rice fields. </strong>Most common in persons in the <strong>age range of&nbsp;15&ndash;40</strong>; <strong>males</strong> are more commonly affected than females.</p>\n<p>The rhinoscopic examination&nbsp;will reveal papular or <strong>nodular, smooth-surfaced lesions&nbsp;that become pedunculated</strong> and acquire a <strong>papillomatous or&nbsp;proliferative appearance</strong>. The lesions are pink, red, or purple in color. Histopathology shows several <strong>sporangia</strong>, oval, or round in shape and <strong>filled with spores.</strong></p>\n<p>The <strong>treatment of choice</strong> is <strong>surgical excision of lesions</strong>,&nbsp;with or without cauterization.&nbsp;Not many drugs are effective against this&nbsp;disease. Dapsone has been tried with some success.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/287024b98ab940f3ba09525abd8b1712.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are correct about hair cells?",
    "choices": [
      {
        "id": 1,
        "text": "i, ii, iv"
      },
      {
        "id": 2,
        "text": "i, ii, iii"
      },
      {
        "id": 3,
        "text": "i, iii, iv"
      },
      {
        "id": 4,
        "text": "ii, iii, iv"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Statements i, ii, and iii are correct.</p>\n<p>Statement i:\u00a0There is <strong>1 row</strong> of <strong>inner hair cells</strong> and <strong>3 rows</strong> of <strong>outer hair cells</strong> is a correct statement.\u00a0</p>\n<p>Statement ii:\u00a0<strong>Inner hair cells</strong> are responsible for <strong>transmitting auditory impulses</strong> is a correct statement. Inner hair cells are richly supplied by afferent cochlear fibres and are probably more important in the transmission of auditory impulses.</p>\n<p>Statement iii: The majority\u00a0of the <strong>afferent fibres of spiral ganglion</strong> supply the inner hair cells is a correct statement. <strong>Ninety-five percent</strong> of <strong>afferent fibres</strong> of spiral ganglion <strong>supply the inner hair cells</strong> while only <strong>five percent supply</strong> the <strong>outer hair cells.</strong> <strong>Efferent fibres</strong> to the hair cells come from the <strong>olivocochlear bundle.</strong></p>\n<p>Statement iv: Outer hair cells are important in the modulation of basilar membrane action is an incorrect statement.\u00a0<strong>Outer hair cells</strong> mainly receive efferent innervation from the olivary complex and are concerned with <strong>modulating the function of inner hair cells.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 7-year-old male presents with progressive bulging of the right eye with a diminision of vision since 1 day. He has a history of URTI and on examination, it is seen that he also has nasal congestion with active discharge. The CT scan of the PNS is seen. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Sinusitis with preseptal cellulitis"
      },
      {
        "id": 2,
        "text": "Sinusitis with orbital cellulitis"
      },
      {
        "id": 3,
        "text": "Sinusitis with subperiosteal abcess"
      },
      {
        "id": 4,
        "text": "Sinusitis with orbital abscess"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<div class=\"page\" title=\"Page 215\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In the given clinical scenario, a male patient with symptoms of an <strong>upper respiratory tract infection </strong>(URTI)\u00a0exhibits <strong>opacity</strong> in the <strong>right ethmoidal sinus</strong>, as shown by the CT image, suggesting a probable diagnosis of <strong>sinusitis. </strong>CT scans show a typical lenticular rim-enhancing collection adjacent to the lamina papyracea with a fat plane between it and the displaced medial rectus muscle, suggesting a diagnosis of\u00a0<strong>Sinusitis with subperiosteal abscess.</strong></p>\n<div class=\"page\" title=\"Page 1161\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Orbital complications occur most commonly following ethmoid sinusitis as the ethmoid sinus is separated from the orbit by a thin papery bone known as <strong>lamina papyracea.</strong> Also, the venous supply of orbit and ethmoid sinuses is the same and additionally, these veins are valveless (superior and inferior ophthalmic veins). It can vary in degree and severity and is typically graded with the <strong>Chandler classification.</strong></p>\n<table style=\"width: 557px; height: 404px;\">\n<tbody>\n<tr>\n<td style=\"width: 518.775px; text-align: center;\" colspan=\"5\">Chandler stages</td>\n</tr>\n<tr>\n<td style=\"width: 93.7625px;\">Stage 1</td>\n<td style=\"width: 93.7625px;\">Stage 2</td>\n<td style=\"width: 99.7125px;\">\u00a0Stage 3</td>\n<td style=\"width: 86.1125px;\">\u00a0Stage 4</td>\n<td style=\"width: 145.425px;\">\u00a0Stage 5</td>\n</tr>\n<tr>\n<td style=\"width: 93.7625px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Preseptal cellulitis</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 93.7625px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Postseptal cellulitis or orbital cellulitis without abscess</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 99.7125px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Subperiosteal abscess</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 86.1125px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Orbital abscess</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 145.425px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Cavernous sinus thrombosis/abscess</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 93.7625px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Inflammation does not extend beyond the orbital septum (where the medial orbital periosteal reflection attaches to the medial eyelid at the tarsal plate).</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 93.7625px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Inflammation extends into the tissues of the orbit.</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 99.7125px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>There is abscess formation deep to the periosteum of the orbital bones, typically at the lamina papyracea from ethmoid sinusitis.</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 86.1125px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>There is abscess formation within the orbit which has breached the periosteum.</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 145.425px;\">\n<div class=\"page\" title=\"Page 1164\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The inflammatory process has extended into the cavernous sinus which thromboses and may progress to abscess formation.</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 1163\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Contrast-enhanced computed tomography</strong> (CT) is advised as <strong>first-line imaging</strong> because of its superiority in demonstrating bony anatomy and pathology of the orbit and sinuses with its speed and ease of examination. <strong>MRI</strong> provides outstanding <strong>soft tissue detail</strong> without radiation exposure.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a94c8c262cd942b69c4fb466cdac0996.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which type of synovial joint is seen in the picture?",
    "choices": [
      {
        "id": 1,
        "text": "Ball and socket"
      },
      {
        "id": 2,
        "text": "Saddle"
      },
      {
        "id": 3,
        "text": "Pivot"
      },
      {
        "id": 4,
        "text": "Plane"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>malleo-incudal </strong>joint is a <strong>saddle</strong> type.</p>\n<p>The type of joint between the middle ear ossicles is a\u00a0<strong>synovial joint. </strong>The<strong> incudostapedial</strong> joint is a\u00a0<strong>ball and socket type.</strong></p>\n<p>Note: The image in the question has been updated to include the arrow which was initially missing.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0ab6f994f4cd47709e4b04e822940715.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The audiogram given in the image below is seen in ______.",
    "choices": [
      {
        "id": 1,
        "text": "Ototoxicity"
      },
      {
        "id": 2,
        "text": "Presbycusis"
      },
      {
        "id": 3,
        "text": "Noise induced hearing loss"
      },
      {
        "id": 4,
        "text": "Endolymphatic hydrops"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option C: In <strong>noise-induced hearing loss</strong>, audiometry shows a\u00a0<strong>typical notch at 4000 Hz</strong>. As the duration of noise exposure increases, the notch becomes deeper and wider, involving lower and higher frequencies.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3c6c3768ec1c4ad7ab5f32dd08e4ed0f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0cb11f00c57a4a8680f4f8b5bba18adfx1280x1803.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/59360a00559541cfad59db9d4d396aabx1280x1623.JPEG"
    ]
  },
  {
    "text": "A farmer presents with unilateral obstruction of the nasal cavity and nasal bleeding. A mass is found and removed. A biopsy is shown below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rhinosporidiosis"
      },
      {
        "id": 2,
        "text": "Rhinoscleroma"
      },
      {
        "id": 3,
        "text": "Inverted papilloma"
      },
      {
        "id": 4,
        "text": "Angiofibroma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p style=\"text-align: justify;\">Option C:\u00a0<strong>Inverted papilloma</strong>\u00a0(transitional cell papilloma) is a tumour originating from the\u00a0<strong>nonolfactory mucosa</strong>\u00a0of the nose (Schneiderian membrane) and paranasal sinuses. The\u00a0<strong>unilateral</strong>\u00a0growth of hyperplastic papillomatous tissue into the stroma characterizes this condition.\u00a0It primarily affects\u00a0<strong>men</strong>\u00a0aged\u00a0<strong>40-70</strong>\u00a0and presents\u00a0<strong>unilaterally</strong>\u00a0with symptoms such as\u00a0<strong>nasal obstruction</strong>, nasal discharge, and\u00a0<strong>epistaxis</strong>. Invasive growth into the sinuses or orbit can lead to\u00a0<strong>proptosis</strong>, diplopia, and lacrimation.\u00a0 A\u00a0<strong>biopsy</strong>\u00a0<span class=\"word\">is</span>\u00a0<span class=\"word\">essential\u00a0</span><span class=\"word\">for</span>\u00a0<span class=\"word\">diagnosis. Histology shows\u00a0a thin respiratory epithelium\u00a0overlying the surface and an</span>\u00a0underlying stroma containing\u00a0<strong>multiple nodules</strong>\u00a0of thick neoplastic epithelium<strong>\u00a0growing inward.\u00a0</strong></p>\n<p>Option D:\u00a0<span class=\"word\"><strong>Juvenile nasopharyngeal angiofibroma</strong>\u00a0is seen almost exclusively in males in the age group of 10\u201320 years and is very rarely seen in older people and females.\u00a0</span>Profuse, recurrent, and spontaneous epistaxis is the most common presentation.\u00a0Diagnosis is mostly clinical.\u00a0<strong>Contrast-enhanced CT</strong>\u00a0scan of the head is the<strong>\u00a0investigation of choice</strong>\u00a0that reveals\u00a0<strong>anterior bowing</strong>\u00a0of the posterior wall of the maxillary sinus (<strong>Antral sign/Holman Miller sign</strong>) which is pathognomonic of angiofibroma.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a843e12cc6f743d2a128bbedf4e5b578.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9dfa25ffcf94451795200fb4cfdf7eecx512x399.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5af7361582884ff9aa548a5b7867d604x512x341.PNG"
    ]
  },
  {
    "text": "Out of the four given statements, which is true about coughing?",
    "choices": [
      {
        "id": 1,
        "text": "i, ii, iii"
      },
      {
        "id": 2,
        "text": "i, iv"
      },
      {
        "id": 3,
        "text": "ii, iv"
      },
      {
        "id": 4,
        "text": "ii, iii"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">Coughing is a type of<strong> forceful expiration</strong>. During forceful expiration, when pressure builds up, the <strong>glottis opens</strong> and then the air comes out. The <strong>cough reflex</strong> is a <strong>protective mechanism</strong> of the larynx to <strong>expel irritants</strong> and keep the airway clear.</p>\n<p class=\"p1\">Coughing begins with a <strong>deep</strong> inspiration followed by a <strong>forced expiration against a closed glottis</strong>. This increases the intrapleural pressure to 100 mm Hg or more. The glottis is then suddenly opened, producing an explosive outflow of air at velocities up to 965 km (600 ml) per hour.</p>\n<div class=\"page\" title=\"Page 1119\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Both chemical and mechanical stimuli can initiate the cough reflex. Chemical or mechanical irritation of the respiratory mucosa stimulates the <strong>afferent </strong>internal laryngeal nerve, which is the branch of the superior laryngeal nerve of the <strong>vagus nerve.\u00a0</strong>These sensory fibres <strong>synapse</strong> in the nucleus tractus solitarius in the medulla oblongata. Complex neural networks here generate the conscious 'urge to cough' while also sending efferent signals to the various muscles involved in generating an effective cough which include the adductors of the <strong>vocal cord</strong>, the <strong>diaphragm</strong>, the <strong>external intercostals </strong>and the muscles of the <strong>anterior abdominal wall</strong>.</p>\n</div>\n</div>\n</div>\n</div>\n<p class=\"p1\"><strong>Other Options</strong></p>\n<p class=\"p1\">\u00a0Statement ii and iii: It is the forceful expiration, not just a normal expiration or deep inspiration which opens the glottis.</p>\n<p class=\"p1\">\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old female presents with progressive bilateral hearing loss, in the right ear more than left.  After the initial evaluation, a stapedotomy of the right ear was planned. What might've been the tuning fork test results of the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Bilateral Rinne's negative, Weber's lateralized to the right"
      },
      {
        "id": 2,
        "text": "Bilateral Rinne's negative, Weber's lateralized to the left"
      },
      {
        "id": 3,
        "text": "Bilateral Rinne's positive, Weber's lateralized to the right"
      },
      {
        "id": 4,
        "text": "Bilateral Rinne's positive, Weber's lateralized to the left"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given clinical scenario, a female with <strong>progressive bilateral hearing loss</strong>, in the right ear more than the left, and a stapedotomy of the right ear was planned. <strong>Stapedotomy surgery</strong> is done for <strong>otosclerosis.</strong> Otosclerosis results in <strong>conductive hearing loss</strong> so, the tuning fork test results of the patient will be\u00a0<strong>Bilateral Rinne's negative, Weber's lateralized to the right.</strong></p>\n<p>As there is <strong>conductive hearing loss</strong> in both ears, like that associated with otosclerosis (which may require a stapedotomy), the <strong>bilateral Rinne</strong> test will be <strong>negative</strong>. In Weber's test, the sound lateralizes to the affected ear, which, in this case, is the right ear with more significant hearing loss.</p>\n<p>Tuning fork tests are performed commonly with tuning forks of frequencies such as 128, 256, 512, 1024, etc. The tuning fork of <strong>512 Hz</strong> is considered ideal as forks of lower frequencies produce a sense of bone vibration, while those of higher frequencies have a shorter decay time.</p>\n<p><strong>Rinne\u2019s test</strong>\u00a0is done by placing a vibrating tuning fork on the patient\u2019s mastoid and when he stops hearing, it is brought beside the external auditory meatus (EAC). If he still hears the sound,\u00a0<strong>air conduction </strong>(AC)\u00a0is better than\u00a0<strong>bone conduction </strong>(BC) i.e.<strong> AC&gt;BC</strong>. The inferences are as follows:</p>\n<ul>\n<li>Rinne's test is considered\u00a0<strong>positive </strong>(normal)\u00a0when the air conduction<strong>\u00a0AC&gt;BC</strong>\u00a0is seen in normal people and people with <strong>sensorineural deafness.</strong></li>\n<li>It is considered\u00a0<strong>negative</strong>\u00a0when the\u00a0<strong>BC&gt;AC,</strong>\u00a0and is seen in patients with\u00a0<strong>conductive deafness</strong>.\u00a0</li>\n</ul>\n<p><strong>Weber test\u00a0</strong>is done by placing a\u00a0vibrating tuning in the middle of the forehead or the vertex and the patient is asked in which ear the sound is heard. The inferences are as follows:</p>\n<ul>\n<li>Normal result is achieved when the sound heard equally in both ears</li>\n<li>In conductive deafness, it is lateralized to the worse ear</li>\n<li>In <strong>sensorineural deafness</strong>, it is <strong>lateralized</strong> to the <strong>better ear.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3fa3f86cc7e74fc3b274886bd12d3332x1279x1605.JPEG"
    ]
  },
  {
    "text": "A 60-year-old man can only hear when words are shouted. What is the degree of his hearing impairment?",
    "choices": [
      {
        "id": 1,
        "text": "Moderate hearing loss < 50%"
      },
      {
        "id": 2,
        "text": "Moderately severe hearing loss  < 70%"
      },
      {
        "id": 3,
        "text": "Profound hearing loss  > 80%"
      },
      {
        "id": 4,
        "text": "Severe hearing loss  > 70%"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given clinical scenario, the patient\u00a0can only hear when words are shouted, which is a severe hearing loss. The degree of his hearing impairment will be\u00a0<strong>Severe hearing loss &gt; 70%.</strong></p>\n<p>Our <strong>normal conversational speech</strong> is only up to <strong>60 dB</strong>. If we have to shout, it means the patient is having a hearing loss greater than 60 dB.</p>\n<p>WHO grades of hearing loss:</p>\n<table style=\"width: 889px;\">\n<tbody>\n<tr>\n<td style=\"width: 218.328px;\"><strong>Grade of hearing loss range</strong></td>\n<td style=\"width: 191.336px;\"><strong>Range of hearing loss</strong></td>\n<td style=\"width: 216.141px;\"><strong>Performance</strong></td>\n<td style=\"width: 207.008px;\"><strong>Recommendation</strong></td>\n</tr>\n<tr>\n<td style=\"width: 218.328px;\">0: No impairment</td>\n<td style=\"width: 191.336px;\">25 dB or better</td>\n<td style=\"width: 216.141px;\">No or very slight hearing problems. Able to hear whispers</td>\n<td style=\"width: 207.008px;\">None</td>\n</tr>\n<tr>\n<td style=\"width: 218.328px;\">1: Slight impairment</td>\n<td style=\"width: 191.336px;\">26-40 dB</td>\n<td style=\"width: 216.141px;\">Able to hear and repeat words spoken in normal voice at 1 meter</td>\n<td style=\"width: 207.008px;\">Counselling. Hearing aids may be needed</td>\n</tr>\n<tr>\n<td style=\"width: 218.328px;\">2: Moderate impairment</td>\n<td style=\"width: 191.336px;\">41-60 dB</td>\n<td style=\"width: 216.141px;\">Able to hear and repeat words using raised voice at 1 meter</td>\n<td style=\"width: 207.008px;\">Hearing aids are usually recommended</td>\n</tr>\n<tr>\n<td style=\"width: 218.328px;\">3: Severe impairment</td>\n<td style=\"width: 191.336px;\">61-80 dB</td>\n<td style=\"width: 216.141px;\">Able to hear some words when shouted into better ear</td>\n<td style=\"width: 207.008px;\">Hearing aids needed. If no hearing aids available, lip reading should be taught</td>\n</tr>\n<tr>\n<td style=\"width: 218.328px;\">4: Profound</td>\n<td style=\"width: 191.336px;\">81 dB or greater</td>\n<td style=\"width: 216.141px;\">\n<p>\u00a0Unable to hear and understand even a shouted voice whether in quiet or noise.</p>\n</td>\n<td style=\"width: 207.008px;\">\n<p>Hearing aids may help in understanding words. Additional rehabilitation is needed. Lip-reading and sometimes signing essential</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;World Hearing Day 2023 observed on March 3, will highlight the importance of integrating ear and hearing care within primary care, as an essential component of universal health coverage. The theme for the this year's campaign is \\&quot;Ear and hearing care for all, let\u2019s make it a reality\\&quot;&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:829,&quot;3&quot;:{&quot;1&quot;:0},&quot;5&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;6&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;7&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;8&quot;:{&quot;1&quot;:[{&quot;1&quot;:2,&quot;2&quot;:0,&quot;5&quot;:{&quot;1&quot;:2,&quot;2&quot;:0}},{&quot;1&quot;:0,&quot;2&quot;:0,&quot;3&quot;:3},{&quot;1&quot;:1,&quot;2&quot;:0,&quot;4&quot;:1}]},&quot;11&quot;:4,&quot;12&quot;:0}\"><strong>World Hearing Day 2023</strong> observed on March 3, will highlight the importance of integrating ear and hearing care within primary care, as an essential component of universal health coverage. The theme for this year's campaign is \"Ear and hearing care for all, let\u2019s make it a reality\"</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '148 Ent Inicet 2023';
        let hierarchy = ["Marrow", "PYQs", "ENT"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>