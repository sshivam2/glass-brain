<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluation Of Hearing Loss Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2024-25
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following tests is best used to assess the eustachian tube function in patients with intact or perforated tympanic membranes?",
    "choices": [
      {
        "id": 1,
        "text": "Valsalva maneuver"
      },
      {
        "id": 2,
        "text": "Toynbee maneuver"
      },
      {
        "id": 3,
        "text": "Politzerization"
      },
      {
        "id": 4,
        "text": "Tympanometry"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Tympanometry</strong> is a\u00a0<strong>test </strong>used<strong>\u00a0</strong>to assess <strong>eustachian tube (ET) dysfunction </strong>in patients with an\u00a0<strong>intact</strong> or <strong>perforated tympanic membrane (TM)</strong>. It is an objective measure of ET function. Although politzerization can be used, tympanometry is better than politzerization.</p>\n<p>Tympanometry allows for the visualization of the changes in the movement of TM in response to variations in external canal pressure. The disadvantage of this method is that middle ear pathologies can overshadow ET function.</p>\n<p>Other tests of ET function include\u00a0Toynbee\u2019s test, phototubometry, saccharine/dye tests in perforated ears, and sonotubometry.</p>\n<p>Politzerization (Option C) is an\u00a0<strong>unsafe</strong>\u00a0and outdated ET function test. It can lead to\u00a0<strong>complications</strong>\u00a0like TM rupture, scarring of ET, epistaxis, and the spread of nasal/pharyngeal infection to the middle ear.</p>\n<p>The other listed procedures (Options A and B) are used for ET function testing, but they are done in cases where the tympanic membrane is intact.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man presented with difficulty in hearing. A pure-tone audiogram was obtained, which is shown below. What is the interpretation of this audiogram?",
    "choices": [
      {
        "id": 1,
        "text": "Left-sided mixed hearing loss"
      },
      {
        "id": 2,
        "text": "Left-sided conductive hearing loss"
      },
      {
        "id": 3,
        "text": "Right-sided mixed hearing loss"
      },
      {
        "id": 4,
        "text": "Right-sided conductive hearing loss"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given audiogram is suggestive of\u00a0<strong>left-sided mixed</strong>\u00a0hearing loss.\u00a0</p>\n<p>Interpretation<strong>\u00a0</strong>of the audiogram:</p>\n<ul>\n<li><strong>Blue</strong> colour indicates the\u00a0<strong>left</strong>\u00a0ear.</li>\n<li><strong>&gt;</strong> indicates bone conduction (BC), and the threshold is &gt;25 dB. Hence,\u00a0<strong>BC\u00a0</strong>is abnormal, which implies<strong>\u00a0</strong>that\u00a0the abnormality is in the<strong> sensorineural\u00a0</strong>pathway.</li>\n<li><strong>\u00d7\u00a0</strong>indicates air conduction (AC), and the threshold is &gt;15 dB. Hence,\u00a0<strong>AC\u00a0</strong>is\u00a0abnormal.</li>\n<li>Both AC and BC are abnormal. It indicates sensorineural hearing loss.</li>\n<li>In addition, the\u00a0<strong>air-bone gap\u00a0</strong>is present, which implies <strong>conductive hearing loss.</strong></li>\n<li>Hence, the interpretation is left-mixed hearing loss.</li>\n</ul>\n<p>A mixed type of hearing loss presents with defects in both conductive and sensorineural pathways. This type of hearing loss is seen in <strong>chronic suppurative otitis media</strong> and <strong>otosclerosis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ea2a96c4301541ba92dcdb3408a15a6c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old male patient with presbycusis comes to the clinic for a routine check-up while you are working as an intern in the ENT department. Your professor asks you to perform the Bing test, which you promptly do by placing a vibrating tuning fork on the mastoid process and alternatively pressing and releasing the tragus. Which among the following findings do you expect in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Patient says that there is no change in the hearing"
      },
      {
        "id": 2,
        "text": "Patient hears the sound louder when the ear canal is open"
      },
      {
        "id": 3,
        "text": "Patient hears the sound louder when the ear canal is occluded"
      },
      {
        "id": 4,
        "text": "Patient experiences dizziness when the ear canal is occluded"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Among the given options, option C is correct. This patient with <strong>presbycusis,</strong> which causes <strong>sensorineural </strong>hearing loss, will hear the <strong>sound louder</strong> when the ear canal is <strong>occluded</strong>.\u00a0</p>\n<p>The test performed here is the<strong> Bing test</strong>\u2014a test of bone conduction. It is done to evaluate the effect of occlusion of the ear on hearing.</p>\n<p>It is performed by placing a vibrating tuning fork on the mastoid of the patient. Then, the tragus is pressed inwards and released alternately to occlude and open the external ear canal. The findings will depend on the type of hearing loss.</p>\n<ul>\n<li>Bing<strong> positive </strong>- It is seen in patients with normal hearing and those with <strong>sensorineural</strong> hearing loss. The sound is louder when the ear canal is occluded and softer when the canal is open. Therefore, in this patient with presbycusis, which causes a sensorineural type of hearing loss, the sound is heard louder when the ear canal is occluded.</li>\n<li>Bing <strong>negative </strong>- It is seen in patients with <strong>conductive</strong>\u00a0hearing loss. They do not appreciate any change in the loudness.\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged man complained of decreased hearing in his left ear. The following test is done. The man can hear the tuning fork vibrations over his left mastoid but not in front of his left ear. Identify the test performed and the type of hearing loss.",
    "choices": [
      {
        "id": 1,
        "text": "Weber\u2019s test; Conductive hearing loss"
      },
      {
        "id": 2,
        "text": "Rinne\u2019s test; Conductive hearing loss"
      },
      {
        "id": 3,
        "text": "Weber\u2019s test; Sensorineural hearing loss"
      },
      {
        "id": 4,
        "text": "Rinne\u2019s test; Sensorineural hearing loss"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span style=\"font-size: 12pt;\">The test shown in the above image is <strong>Rinne\u2019s test</strong>. Based on the given scenario, it is found that the patient can hear the tuning fork vibrations over the mastoid but not in front of the ear. Hence, it suggests that <strong>bone conduction</strong> is <strong>greater</strong> than <strong>air conduction</strong> (BC&gt;&gt;AC) which is seen in<strong> conductive hearing loss</strong>.</span></p>\n<p><span style=\"font-size: 12pt;\">There are <strong>two</strong> major types of hearing loss:</span></p>\n<ul>\n<li><span style=\"font-size: 12pt;\"><strong>Conductive hearing loss</strong> - due to <strong>impaired sound transmission</strong> in the external and middle ears. It affects all sound frequencies. Causes include cerumen/wax plugging of the external auditory canal, otitis externa, otitis media, perforation of the eardrum and otosclerosis.\u00a0</span></li>\n<li><span style=\"font-size: 12pt;\"><strong>Sensorineural hearing loss</strong> - caused by damage to the <strong>neural</strong> components of hearing - cochlear hair cells, the cochlear nerve or central auditory pathways. Its causes include aminoglycoside toxicity, prolonged noise exposure, autoimmune disorders, trauma, cerebellopontine angle tumours and stroke.\u00a0</span></li>\n</ul>\n<p><span style=\"font-size: 12pt;\">These types of hearing losses can be differentiated with the help of<strong> tuning fork tests</strong>. Eg:<strong> </strong>Rinne\u2019s, Weber\u2019s and Schwabach\u2019s tests.\u00a0</span></p>\n<p><span style=\"font-size: 12pt;\">In <strong>Rinne\u2019s test</strong>, a vibrating tuning fork is first placed on the mastoid bone of the patient. This tests <strong>bone conduction</strong> (BC). When the patient stops hearing the sound, the vibrating tuning fork is placed in front of the ear. This tests <strong>air conduction</strong> (AC). In a <strong>normal ear</strong>, AC is greater than BC, and <strong>Rinne\u2019s</strong> is said to be <strong>positive</strong>.\u00a0</span></p>\n<p><span style=\"font-size: 12pt;\"><strong>Weber\u2019s test</strong> is performed by placing a vibrating tuning fork on the <strong>vertex</strong> of the skull. The patient closes their eyes and compares the sound heard in either ear. It tests <strong>bone conduction</strong> (BC). In a normal patient, the vibrations are heard <strong>equally</strong> on <strong>both sides</strong>.</span></p>\n<p><span style=\"font-size: 12pt;\">The findings of Rinne\u2019s test and Weber\u2019s test in different types of hearing loss are shown below:\u00a0</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0bbb4068182f4fba80ff098ca94bedf2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1107efb0ae344844854e4c2470e38f40x1279x1605.JPEG"
    ]
  },
  {
    "text": "A 52-year-old female patient presents with unilateral tinnitus and progressive hearing loss at higher tones. She also classically complains of difficulty in understanding speech and inability to feel her contact lenses. Audiometric tests were done as follows. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Presbycusis"
      },
      {
        "id": 2,
        "text": "Meniere's disease"
      },
      {
        "id": 3,
        "text": "Noise induced hearing loss"
      },
      {
        "id": 4,
        "text": "Vestibular schwannoma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario, along with the interpretation of audiometric tests, is suggestive of the diagnosis as <strong>Vestibular schwannoma</strong>.</p>\n<p>Vestibular schwannoma is a <strong>benign tumour</strong> arising from the vestibular nerve due to the abnormal proliferation of Schwann cells. <strong>Bilateral vestibular schwannoma </strong>is seen in<strong> neurofibromatosis type 2. </strong>It is common in <strong>both sexes</strong> between <strong>40-60</strong> years of age. It usually presents with <strong>unilateral tinnitus </strong>and<strong> progressive retro-cochlear sensorineural hearing loss</strong> at <strong>higher tones </strong>with<strong> poor speech discrimination.</strong>\u00a0</p>\n<p>Tumour growth presents with <strong>corneal </strong>and<strong> facial hypesthesia </strong>(inability to feel the contact lens in the given case)\u00a0due to the involvement of the <strong>trigeminal nerve</strong>. Involvement of the <strong>facial nerve</strong> presents as hypoaesthesia of the posterior meatal wall, known as the <strong>Hitzelbergers sign</strong> and <strong>defective taste </strong>and<strong> lacrimation</strong>. Involvement of <strong>lower cranial nerves</strong> presents as dysphagia, aspiration, voice change, and regurgitation. Rarely cerebellar symptoms may also be seen.</p>\n<ul>\n<li>Pure tone audiometry reveals <strong>sensorineural hearing loss</strong>, particularly in high frequencies.</li>\n<li>Speech audiometry shows the <strong>roll-over phenomenon</strong>.</li>\n<li>The <strong>absence</strong> of the <strong>recruitment phenomenon</strong> is noted.</li>\n<li><strong>Short Increment Sensitivity Index (SISI)</strong> ranges from 0-20%.</li>\n<li><strong>Brainstem Evoked Response Audiometry (BERA)</strong> demonstrates a significant delay of &gt;0.2 ms in wave V between the two ears.</li>\n<li>Magnetic Resonance Imaging (MRI) with <strong>gadolinium contrast</strong> is considered the <strong>gold standard</strong> for diagnosis.</li>\n</ul>\n<p><strong>Surgical removal</strong> by X-knife, Gamma knife, or Cyberknife is the <strong>treatment of choice</strong>. <strong>Radiotherapy has no role</strong>.\u00a0</p>\n<p>Other options:</p>\n<p>Option A - <strong>Presbycusis</strong> is the <strong>physiological</strong> hearing loss due to <strong>old age</strong> and usually manifests at <strong>65 years</strong> of age. Presbycusis occurs due to sensory, neural, metabolic, and conductive pathologies and presents <strong>predominantly cochlear </strong>hearing loss patterns. <strong>High-frequency hearing loss</strong> with <strong>tinnitus</strong>\u00a0are the presenting complaints with <strong>positive</strong> <strong>recruitment</strong> phenomenon. Additional features of corneal hypesthesia are absent.\u00a0</p>\n<p>Option B - <strong>Meniere's</strong> <strong>disease,</strong> also known as endolymphatic hydrops, occurs due to overdistension of the inner ear with endolymph. It is <strong>more</strong> <strong>common</strong> in <strong>males</strong> than females. It may be unilateral or bilateral. <strong>Cardinal</strong> <strong>features</strong> are:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Episodic vertigo</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Fluctuating</strong> <strong>hearing</strong> <strong>loss</strong> of <strong>cochlear</strong> type</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Tinnitus</strong>\u00a0\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Sense of <strong>fullness</strong> or pressure in the involved ear.</li>\n</ul>\n<p>Option C - <strong>Noise-induced hearing loss</strong>(NIHL) is a preventable cause of hearing loss and is an occupational hazard. NIHL causes damage to <strong>outer</strong> <strong>hair</strong> cells more than the inner hair cells, starting in the basal turn of the <strong>cochlea</strong>. There is <strong>symmetrical</strong> <strong>hearing</strong> <strong>loss</strong>\u00a0and shows a cochlear pattern on audiometric tests. The audiogram in NIHL shows a typical <strong>notch</strong>\u00a0at <strong>4000</strong> <strong>Hz</strong>, both for air and bone conduction. <strong>Speech frequencies are also affected.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old patient comes to the ENT outpatient department with complaints of difficulty in hearing in the left ear. Rinne\u2019s test shows bone conduction is better than air conduction. Weber test shows lateralization towards the left ear. The absolute bone conduction test is normal. What will be the inference of Schwabach's test in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Lengthened as compared to the examiner"
      },
      {
        "id": 2,
        "text": "Shortened as compared to the examiner"
      },
      {
        "id": 3,
        "text": "Same as compared to the examiner"
      },
      {
        "id": 4,
        "text": "Difficult to interpret with the given data"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The patient here complains of hearing loss. <strong>Rinne's</strong> test showing <strong>BC&gt;AC </strong>in the left ear, <strong>Weber's</strong> test <strong>lateralizing</strong> to the <strong>left</strong> ear, and a <strong>normal ABC</strong> test are suggestive of <strong>conductive deafness</strong> in his <strong>left</strong> ear. <strong>Schwabach\u2019s</strong> test is <strong>lengthened</strong> in conductive deafness.</p>\n<p><strong>Tuning fork tests</strong> are performed commonly with tuning forks of frequencies such as 128, 256, 512, 1024, etc. The tuning fork of <strong>512 Hz</strong> is considered <strong>ideal </strong>as forks of lower frequencies produce a sense of bone vibration, while those of higher frequencies have a shorter decay time. Some examples of commonly done tuning fork tests are as follows:<br /><br />In <strong>Schwabach's test</strong>, the bone conduction of the patient is compared with that of the examiner, but unlike the absolute bone conduction test, the EAC is not occluded. Inferences are as follows:</p>\n<ul>\n<li>Normal: The test result is the same as that of the examiner</li>\n<li>Conductive deafness: The test result is lengthier than that of the examiner</li>\n<li>Sensorineural deafness: The test result is shorter than that of the examiner</li>\n</ul>\n<p><strong>Rinne\u2019s test</strong> is done by placing a vibrating tuning fork on the patient\u2019s mastoid, and when he stops hearing, it is brought beside the external auditory meatus(EAC). If he still hears the sound, air conduction (AC) is better than bone conduction (BC). The inferences are as follows:</p>\n<ul>\n<li>Rinne's test is considered <strong>positive(normal)</strong> when the air conduction <strong>AC&gt;BC</strong> is seen in normal people and people with <strong>sensorineural deafness</strong>.</li>\n<li>It is considered <strong>negative</strong> when the <strong>BC&gt;AC</strong> and is seen in patients with <strong>conductive deafness</strong>. It suggests a minimum hearing loss of 15 - 20 dB.</li>\n</ul>\n<p><strong>Weber's test</strong> is done by placing a vibrating tuning in the middle of the forehead or the vertex, and the patient is asked in which ear the sound is heard. The inferences are as follows:</p>\n<ul>\n<li>Normal result is achieved when the sound is heard equally in both ears</li>\n<li>In <strong>conductive</strong> deafness, it is lateralized to the <strong>worst ear</strong>.</li>\n<li>In <strong>sensorineural</strong> deafness, it is lateralized to the <strong>better ear</strong>.</li>\n</ul>\n<p>In the <strong>absolute bone conduction(ABC) test</strong>, the patient\u2019s bone conduction is compared with that of the examiner after occluding (by pressing the tragus inwards) EAC of both the patient and the examiner to prevent the ambient noise from entering through the AC route. It is used to assess <strong>cochlear deafness</strong>.</p>\n<ul>\n<li>Normal result: The test result is the same as the examiner.</li>\n<li>Conductive deafness: The test result is the same as the examiner.</li>\n<li>Sensorineural deafness: The test result is reduced to that of the examiner.</li>\n</ul>\n<p>Note: The ABC test and Schwabach's test are done assuming the hearing of the examiner is normal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a subjective test for hearing?",
    "choices": [
      {
        "id": 1,
        "text": "Speech Audiometry"
      },
      {
        "id": 2,
        "text": "Brainstem Evoked Response Audiometry"
      },
      {
        "id": 3,
        "text": "Otoacoustic emissions"
      },
      {
        "id": 4,
        "text": "Impedance audiometry"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Speech audiometry</strong>\u00a0is a <strong>subjective</strong> test for hearing because it requires the patient to actively respond to sound stimuli to assess their hearing.</p>\n<p>Other examples of subjective tests are <strong>tuning fork tests</strong> and <strong>pure tone audiometry.<br /><br /></strong>Other options:<strong><br /><br /></strong>Option B:<strong> Otoacoustic emission</strong>\u00a0is an objective test that records the low-intensity sounds produced by the outer hair cells of a normal cochlea.<strong><br /><br /></strong>Option C:<strong> Brainstem Evoked Response Audiometry </strong>is an objective test that records electrical activity occurring in the auditory pathway.<strong><br /></strong></p>\n<p>Option D:<strong> Impedance audiometry </strong>is an objective test and consists of tympanometry and acoustic reflex measurements.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old male patient presents with tinnitus and difficulty in hearing for 2 months. He mentions that he is taking hydrochlorothiazide for hypertension. He works at a cement manufacturing factory. Otoscopy findings are normal. Rinne\u2019s test result is positive in both ears. Audiometry results are shown below. What is the likely cause of his hearing loss?",
    "choices": [
      {
        "id": 1,
        "text": "Medication adverse effect"
      },
      {
        "id": 2,
        "text": "Otosclerosis"
      },
      {
        "id": 3,
        "text": "Noise-induced hearing loss"
      },
      {
        "id": 4,
        "text": "Presbycusis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The pure-tone audiogram shown in the given image shows an <strong>acoustic dip at 4000 Hz,\u00a0</strong>which is characteristic of <strong>noise-induced hearing loss.\u00a0</strong></p>\n<p>The patient's employment history (working at a cement factory) suggests constant exposure to <strong>loud noise. </strong>Positive Rinne's test result in both ears suggests that air conduction is better than bone conduction, i.e. absence of conductive hearing loss or presence of sensorineural hearing loss.</p>\n<p>Repeated exposure to loud sounds above 85 dB or single exposure to loud sounds above 120\u2013155 dB, such as explosions and gunshots, can lead to noise-induced hearing loss. It results in <strong>bilateral sensorineural hearing loss</strong> and is caused by irreversible damage to the <strong>stereocilia</strong> of<strong> hair cells</strong> in the <strong>organ of Corti.</strong>\u00a0</p>\n<p>The patient presents with tinnitus and difficulty in hearing in a noisy environment.\u00a0This condition is <strong>irreversible</strong> and is managed with hearing aids.\u00a0</p>\n<p>Audiometry shows a <strong>typical notch at 4000 Hz</strong>. As the duration of noise exposure increases, the notch becomes deeper and wider, involving lower and higher frequencies.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1ba766d4b0e5456cb30060b3695d3033.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3e4f04431541405ba1245591c8a9a740x1280x1623.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc32a95b9eae427f9d38e0037d5e0e28x720x517.JPEG"
    ]
  },
  {
    "text": "Which of the following is incorrect regarding Schwabach's test?",
    "choices": [
      {
        "id": 1,
        "text": "Test is performed with the meatus occluded"
      },
      {
        "id": 2,
        "text": "Lengthened in conductive deafness"
      },
      {
        "id": 3,
        "text": "Reduced in sensorineural deafness"
      },
      {
        "id": 4,
        "text": "Bone conduction of the patient is compared with that of examiner"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Meatus</strong> is <strong>not occluded</strong> while performing the <strong>Schwabach test.</strong></p>\n<p>In Schwabach's test, the bone conduction of the patient is compared with that of the normal hearing person (examiner), but unlike the absolute bone conduction test, the EAC is not occluded. Inferences are as follows:</p>\n<ul>\n<li>Normal - same as the examiner</li>\n<li>Conductive deafness - lengthened than that of the examiner</li>\n<li>Sensorineural deafness - shortened than that of the examiner</li>\n</ul>\n<p><strong>TUNING FORK TESTS:</strong><br />I) Rinne\u2019s test:</p>\n<p>A vibrating tuning fork is <strong>placed</strong> on the patient\u2019s <strong>mastoid</strong>, and when he stops hearing, it is brought beside the meatus. If he can still hear it, air conduction is better than bone conduction.</p>\n<ul>\n<li>Positive<strong> -</strong>\u00a0when the air conduction (AC) is<strong>\u00a0</strong>longer or louder than bone conduction (BC). Seen in normal persons and persons with sensorineural deafness.</li>\n<li>Negative - when the bone conduction is better than air conduction. Seen in patients with conductive deafness.</li>\n</ul>\n<p>II) Weber test:</p>\n<p>A vibrating tuning fork is <strong>placed</strong> in the <strong>middle</strong> of the <strong>forehead</strong> or the <strong>vertex</strong>, and the patient is asked in which ear the sound is heard.</p>\n<ul>\n<li>Normal - heard equally in both ears</li>\n<li>Conductive deafness - lateralized to the worse ear</li>\n<li>Sensorineural deafness - lateralized to the better ear.</li>\n</ul>\n<p>III) Absolute Bone Conduction test:</p>\n<p>Here, the patient\u2019s bone conduction is compared with that of the examiner. The external auditory meatus of both the patient and the examiner should be occluded (by <strong>pressing</strong> the <strong>tragus</strong> <strong>inwards</strong>) to prevent the ambient noise from entering through the AC route.</p>\n<ul>\n<li>Normal - same as the examiner.</li>\n<li>Conductive deafness - same as the examiner.</li>\n<li>Sensorineural deafness - reduced than that of the examiner.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old male was subjected to a tuning fork test. A vibrating tuning fork was placed on the patient\u2019s mastoid, and when he stopped hearing, it was brought beside his external meatus. The patient could still hear the ringing sound. Repeating the same test in the opposite ear yielded the same result. On placing a vibrating tuning fork on his forehead, it was lateralized to the right ear. What is the likely inference?",
    "choices": [
      {
        "id": 1,
        "text": "Sensorineural hearing loss in the left ear"
      },
      {
        "id": 2,
        "text": "Sensorineural hearing loss in the right ear"
      },
      {
        "id": 3,
        "text": "Conductive hearing loss in the right ear"
      },
      {
        "id": 4,
        "text": "Conductive hearing loss in the left ear"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given scenario shows a positive<strong> </strong>Rinne test<strong>, </strong>indicating air conduction is better than bone conduction in both ears<strong>.\u00a0</strong>Since Weber\u2019s test is lateralized to the right ear and Rinne\u2019s test is normal, there is <strong>sensorineural</strong> <strong>hearing</strong> <strong>loss</strong> in the <strong>left</strong> <strong>ear</strong>.<br /><br /><strong>Rinne\u2019s test</strong> is done by placing a vibrating tuning fork on the patient\u2019s mastoid, and when he stops hearing, it is brought beside the external auditory meatus(EAC). If he still hears the sound, air conduction (AC) is better than bone conduction (BC). The inferences are as follows:</p>\n<ul>\n<li>It is considered <strong>positive </strong>(normal) when the <strong>AC&gt;BC. </strong>This is seen in normal people and people with sensorineural deafness.</li>\n<li>It is considered <strong>negative</strong> when the BC&gt;AC. This is seen in patients with conductive deafness. It suggests a minimum hearing loss of 15-20 dB.</li>\n</ul>\n<p>In the <strong>Weber</strong> test, a vibrating tuning fork is placed in the middle of the forehead, or the vertex and the patient is asked in which ear the sound is heard. Normally, it is heard equally in both ears. It is <strong>lateralized</strong> to the worse ear in conductive deafness and <strong>to the better ear in sensorineural deafness.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/250dd8e48bdb46259f04f4fb6e1b9479x1279x1605.JPEG"
    ]
  },
  {
    "text": "A 33-year-old lady presents with complaints of ear pain associated with impaired hearing. Further evaluation by otoscopy reveals a dull and lustreless tympanic membrane with prominent lateral process of the malleus. Which of the following curves will be obtained if she undergoes tympanometry?",
    "choices": [
      {
        "id": 1,
        "text": "2"
      },
      {
        "id": 2,
        "text": "1"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">In the given clinical case, otoscopy findings of a dull and lustreless tympanic membrane with prominent lateral process of the malleus, are highly suggestive of a <strong>retracted tympanic membrane.&nbsp;</strong>On Tympanometry, a <strong>Type C tympanogram </strong>(Curve 1)<strong> </strong>with <strong>normal compliance</strong> and <strong>negative</strong>&nbsp;<strong>pressure</strong> is seen in the case of<strong> </strong>a<strong> retracted tympanic membrane.</strong></p>\n<p>Features of retracted TM:</p>\n<ul>\n<li>TM is <strong>dull</strong> and <strong>lustreless.</strong></li>\n<li>The cone of light is absent or interrupted.</li>\n<li>The handle of the malleus appears foreshortened.</li>\n<li>The <strong>lateral</strong> process of the <strong>malleus</strong> becomes more <strong>prominent.</strong></li>\n<li>Anterior and posterior malleal folds become sickle-shaped.</li>\n</ul>\n<p class=\"p1\"><strong>Tympanometry:&nbsp;</strong>It is used in evaluating the <strong>status of the middle ear</strong> and the&nbsp;<strong>functioning of the eustachian tube</strong>. Results of tympanometry are plotted in the form of a <strong>tympanogram</strong>&nbsp;with:</p>\n<ul>\n<li><strong>Compliance</strong>&nbsp;on the&nbsp;<strong>Y&nbsp;</strong>axis (ease of mobility of TM)</li>\n<li>Middle ear&nbsp;<strong>pressure</strong>&nbsp;on the&nbsp;<strong>X</strong>&nbsp;axis (regulated by eustachian tube)</li>\n</ul>\n<p class=\"p1\"><strong> Principle</strong>: When a sound wave strikes the tympanic membrane, some of the sound energy is absorbed while the rest is reflected. A stiffer tympanic membrane would reflect more sound energy than a compliant one.</p>\n<div class=\"page\" title=\"Page 52\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Tympanometry has also been used to evaluate the function of the <strong>eustachian tube</strong> in cases of intact or perforated tympanic membrane. A pressure of &mdash;200 or +200 mm H<sub>2</sub>O is created in the middle ear and the person is asked to swallow 5 times in 20 seconds. The ability to equilibrate the pressure indicates <strong>normal</strong> tubal function. It <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">is also used in evaluating the </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">patency of the grommet</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> inserted in the tympanic membrane for treating serous otitis media.</span></p>\n<p>Curve 2- <strong>Type B</strong> curve. A <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">flat or dome-shaped graph. No change </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">in compliance with pressure changes. Seen in middle ear fluid or thick tympanic membrane.</span></p>\n<p>Curve 3- <strong>Type As</strong> curve. C<span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">ompliance is lower at or near ambient air </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">pressure. Seen in </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">otosclerosis or malleus fixation.</span></p>\n<p>Curve 4- <strong>Type Ad </strong>curve. <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">High compliance at or near ambient </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">pressure. Seen in ossicular discontinuity </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">or thin and lax tympanic membrane.</span></p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">By charting the compliance of the tympano-ossicular system against various pressure changes, different types of graphs called </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">tympanograms</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> are obtained. They are as follows:</span></p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f65c8da680334e9aa5ffde40c28a9ef3.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0ee955ecd78437ea4212f93c7082a5fx1280x2078.JPEG"
    ]
  },
  {
    "text": "A 13-month-old child presents to you at a local clinic where you are posted for community clinic duty. The parents are apprehensive that their child has difficulty in speech and hearing. Which of the following tests is not useful for assessing the hearing in this child?",
    "choices": [
      {
        "id": 1,
        "text": "Impedance audiometry"
      },
      {
        "id": 2,
        "text": "Otoacoustic emissions"
      },
      {
        "id": 3,
        "text": "Pure tone audiometry"
      },
      {
        "id": 4,
        "text": "Visual reinforcement audiometry"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Pure tone audiometry is not useful for assessing the hearing in this child as it cannot be utilised for this age group.<br /><br />Methods of hearing assessment in <strong>infants</strong> and <strong>children</strong>:\u00a0</p>\n<p>1. <strong>Objective </strong>tests:</p>\n<ul>\n<li>Auditory brainstem response</li>\n<li>Electrocochleography</li>\n<li><strong>Otoacoustic emissions</strong></li>\n<li><strong>Impedance audiometry\u00a0</strong></li>\n</ul>\n<p>2. Neonatal <strong>screening</strong> procedures:</p>\n<ul>\n<li>Arousal test</li>\n<li>ABR/OAEs</li>\n<li>Auditory response cradle\u00a0</li>\n</ul>\n<p>3. Distraction techniques (6-7 months)\u00a0</p>\n<p>4. Conditioning techniques:</p>\n<ul>\n<li><strong>Visual reinforcement audiometry </strong>(6 months to 2 years)</li>\n<li>\u00a0Play audiometry (2-5 years)</li>\n<li>Speech audiometry</li>\n</ul>\n<p>5. Behaviour observation audiometry:</p>\n<ul>\n<li>Moro\u2019s reflex</li>\n<li>Cessation reflex</li>\n<li>Cochleopalpebral reflex</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In the assessment of a patient with diminished hearing, the function of which of the following structures is tested when the tuning fork is struck and placed on the mastoid?",
    "choices": [
      {
        "id": 1,
        "text": "Cochlea"
      },
      {
        "id": 2,
        "text": "Ear ossicles"
      },
      {
        "id": 3,
        "text": "CN VIII"
      },
      {
        "id": 4,
        "text": "Tympanic membrane"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 48\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>When the tuning fork is struck and placed on the mastoid to assess bone conduction, the <strong>cochlea is stimulated directly</strong> by vibrations conducted <strong>through the bones of the skull. </strong>Therefore, it is a <strong>measure of cochlear function only</strong>.</p>\n<p>Tuning fork tests are used to assess <strong>air conduction (AC)</strong> and <strong>bone conduction (BC)</strong> in the hearing apparatus. To test <strong>AC</strong>, the tuning fork is struck and placed <strong>in front of the external auditory canal</strong>. The sound is conducted through the <strong>tympanic membrane, middle ear and ear ossicles to the inner ear. </strong>Hence, the <strong>conducting mechanism, as well as the cochlea,</strong> are assessed. However, to test <strong>BC</strong>, when the tuning fork is struck and placed on the <strong>mastoid </strong>or at the vertex, as is done in Weber's Test, the vibrations are conducted <strong>through skull bones </strong>and <strong>not through the ossicles,</strong> thereby\u00a0<strong>directly stimulating the cochlea.</strong></p>\n<p>Therefore, although it is called the 'bone conduction' test, it is not an assessment of the function of the ossicles but of the cochlea.</p>\n<p>For routine clinical practice, a tuning fork of <strong>512 Hz</strong> is ideal. The clinically relevant tuning fork tests performed include:</p>\n<ul>\n<li>Rinne's Test</li>\n<li>Weber's Test</li>\n<li>Absolute Bone Conduction (ABC) Test</li>\n<li>Gelle's Test</li>\n<li>Schwabach's Test</li>\n<li>Bing Test</li>\n</ul>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f77889f2b8d34731b2d5f9fe883e2e40x1279x1605.JPEG"
    ]
  },
  {
    "text": "A patient comes to the hospital complaining of reduced hearing in the right ear. You perform a diagnostic test using the following instrument. All of the following are uses of this instrument except?",
    "choices": [
      {
        "id": 1,
        "text": "To measure the acoustic reflex"
      },
      {
        "id": 2,
        "text": "For prescription of hearing aid"
      },
      {
        "id": 3,
        "text": "To determine the degree of hearing loss"
      },
      {
        "id": 4,
        "text": "To predict speech reception threshold (SRT)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image is of a <strong>digital audiometer</strong> (pure tone audiometer). A digital audiometer is a lightweight device that is portable and can be used to perform hearing tests, including pure tone audiometry. This device <strong>does not measure acoustic reflexes</strong>.\u00a0</p>\n<p>Acoustic reflex is measured using<strong>\u00a0</strong>the<strong> impedance audiometer.</strong></p>\n<p class=\"p1\">An audiometer is an electronic device that <strong>produces pure tones</strong>, which can be increased or decreased in 5 dB steps. The amount of intensity that has to be raised above the normal level is a measure of the degree of hearing loss at that frequency. This is charted in the form of a graph called an <strong>audiogram</strong>.</p>\n<p class=\"p1\">The difference in the thresholds of air and bone conduction (<strong>A\u2013B gap</strong>) is a measure of the <strong>degree of conductive deafness</strong>.</p>\n<p class=\"p2\">Uses of pure tone audiometer:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">To measure the threshold of hearing of air and bone conduction</li>\n<li aria-level=\"1\"><span style=\"font-weight: 400;\">Helps to </span>predict <strong>speech reception threshold</strong> (SRT)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">To diagnose the <strong>type</strong> and <strong>degree</strong> of hearing loss.</li>\n<li aria-level=\"1\"><span style=\"font-weight: 400;\">For the </span><strong>prescription</strong> of hearing aids</li>\n<li aria-level=\"1\"><span style=\"font-weight: 400;\">Helps to find the </span><strong>degree of handicap</strong> for medicolegal purposes</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">A record can be kept for future reference.</li>\n</ul>\n<p class=\"p2\"><strong>Impedance audiometry </strong>includes tympanometry<strong> </strong>and <strong>acoustic reflex measurement,</strong> which are\u00a0<strong>objective </strong>tests<strong>\u00a0</strong>of the<strong>\u00a0middle ear </strong>and<strong> eustachian tube functions</strong>\u00a0(conductive compartment of hearing).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a662c397893d4641b87bccfe3981cefc.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which among the following tests is not used for neonatal screening of hearing loss?",
    "choices": [
      {
        "id": 1,
        "text": "Distraction techniques"
      },
      {
        "id": 2,
        "text": "Otoacoustic emissions"
      },
      {
        "id": 3,
        "text": "Arousal test"
      },
      {
        "id": 4,
        "text": "Auditory response cradle test"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Among the given options, <strong>distraction techniques</strong> are not used for neonatal screening of hearing loss.\u00a0</p>\n<p>Distraction techniques are used in children of age <strong>6-7 months</strong>. High-frequency sounds, low-frequency sounds, whispered sounds and warbled tones are used to distract the child. The child responds by <strong>turning</strong> the <strong>head</strong> toward the source of sound if the hearing is intact.</p>\n<p>Other options:\u00a0</p>\n<p>Option B: Otoacoustic emissions (OAEs) are <strong>low-intensity sounds</strong> produced by the <strong>outer hair cells</strong> of a <strong>normal</strong> <strong>cochlea.</strong> It is an <strong>objective test</strong> of hearing. They can be used as <strong>screening tests</strong> for hearing in <strong>neonates.</strong> It can be used to diagnose neuropathy of the 8th cranial nerve. OAEs are absent in conditions like middle ear effusion and non-functional outer hair cells in the cochlea.</p>\n<p>Option C: <strong>Arousal test</strong> is used for screening neonatal hearing. Here, when the infant is in light sleep, high-frequency narrow-band noise is presented for 2 seconds. An infant with normal hearing is <strong>aroused from sleep</strong> twice when three such stimuli are given.\u00a0 \u00a0</p>\n<p>Option D:<strong> Auditory response cradle</strong> test\u00a0is used for screening neonatal hearing. In this, the <strong>behaviour</strong> of the baby lying in the cradle is monitored using <strong>transducers</strong> in response to auditory stimuli. It can identify infants with moderate, severe, or profound hearing loss.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In the given image, Graph A shows the electrocochleogram of a normal ear and Graph B of a diseased ear. Which of the following is the most probable diagnosis indicated by Graph B?",
    "choices": [
      {
        "id": 1,
        "text": "Acoustic neuroma"
      },
      {
        "id": 2,
        "text": "Meniere\u2019s disease"
      },
      {
        "id": 3,
        "text": "Glomus tumour"
      },
      {
        "id": 4,
        "text": "Otosclerosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most probable diagnosis indicated by Graph B is <strong>Meniere\u2019s disease</strong>.</p>\n<div class=\"page\" title=\"Page 143\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Normally, the ratio of summating potential (SP) to action potential (AP) is<strong> 30%</strong>. In M\u00e9ni\u00e9re\u2019s disease, the <strong>SP/AP ratio is greater than 30%\u00a0</strong>which is diagnostic.</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Electrocochleography (EcoG)</strong>:</p>\n<ul>\n<li>It is an <strong>objective</strong> test that records the electrical activity of the <strong>cochlea</strong> and <strong>8th</strong> <strong>nerve</strong> in response to auditory stimuli</li>\n<li><strong>Techniques</strong> employed: Transtympanic(invasive) and Extratympanic(non-invasive)</li>\n<li>The response is in the form of three phenomena as follows,<br />- <strong>Cochlear microphonics</strong>: measures the electrical activity that follows the stimulus and reflects the instantaneous displacement of the basilar membrane.<br />- <strong>Summating potential</strong>: measures the electrical activity of the hair cells within the organ of Corti.<br />- <strong>Action potential</strong>: electrical activity in the distal part of the auditory nerve.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cbc22c246e514dc498f5ed4e2cae5e20.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A vibrating tuning fork is placed on the mastoid while the changes in air pressure in the ear canal are brought about by Siegel\u2019s speculum. This test is positive in normal persons and in those with sensorineural hearing loss. It is negative when the ossicular chain is fixed or disconnected. What is the test discussed here?",
    "choices": [
      {
        "id": 1,
        "text": "Schwabach test"
      },
      {
        "id": 2,
        "text": "Absolute bone conduction test"
      },
      {
        "id": 3,
        "text": "Gelle\u2019s test"
      },
      {
        "id": 4,
        "text": "Bing test"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The test discussed here is\u00a0<strong>Gelle's test</strong><strong>.</strong></p>\n<p>It is a test of <strong>bone conduction </strong>and examines the effect of <strong>increased air pressure</strong> in the ear canal on hearing. Normally, when air pressure is increased in the ear canal by Siegel\u2019s speculum, it pushes the tympanic membrane and ossicles inwards, raises the intralabyrinthine pressure, and causes immobility of the basilar membrane and decreased hearing.</p>\n<p class=\"p1\">When the ossicular chain is fixed or disconnected, there will be no change in hearing. It was a popular test to find out stapes\u00a0fixation in <strong>otosclerosis</strong> but has now been superseded by\u00a0tympanometry.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old male patient presents with right-sided sensorineural hearing loss and tinnitus. On examining his ear, you notice numbness in the posterosuperior meatal wall of the external auditory canal. Which of the following speech audiometric graphs represents this condition?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "D"
      },
      {
        "id": 4,
        "text": "C"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given clinical scenario, symptoms of <strong>unilateral</strong> <strong>sensorineural hearing loss, tinnitus</strong> and numbness in the posterosuperior meatal wall of the external auditory canal <strong>(Hitzelberger</strong>\u00a0<strong>sign)\u00a0</strong>are highly suggestive of <strong>Acoustic Neuroma </strong>which shows the characteristic <strong>roll-over phenomenon (Graph D),</strong> in speech audiometry.</p>\n<p>In\u00a0<strong>speech audiometry</strong>,\u00a0the patient\u2019s ability to hear and understand speech is measured.\u00a0<strong>Speech reception threshold</strong>\u00a0and <strong>discrimination score</strong>/<strong>score percentage </strong>are studied under this test. The speech reception threshold is the lowest intensity of sound at which 50% of the words are repeated correctly by the patient, and the discrimination score is the <strong>percentage</strong> of test words correctly repeated by the patient and is calculated as follows:</p>\n<p>If a <strong>50</strong>-word list is used,<strong> 2%</strong> is given for each correct response, and if a <strong>25</strong>-word list is used, <strong>4%</strong> is given for each correct response.</p>\n<p><strong>The Roll-over phenomenon</strong> is seen on plotting the discrimination score against the amplitude of the sound. It is a feature of <strong>retro-cochlear/neural lesions</strong>\u00a0wherein the\u00a0<strong>speech discrimination</strong>\u00a0steadily\u00a0<strong>increases </strong>with intensity\u00a0but\u00a0<strong>suddenly drops</strong> significantly beyond a particular intensity of sound due to <strong>nerve fatigue</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/95d5b007a3a84ddc9362f16f09df096c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94528ef60add4332843f3ea11197b89fx1280x1416.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b81a62385fb4da491ea928f50073f81x800x593.JPEG",
      "https://cdn1.dailyrounds.org/uploads/a739e7ff470541d09a3375c08607fdda.JPEG"
    ]
  },
  {
    "text": "A 10-month-old baby is being evaluated for sensorineural hearing loss after an episode of meningitis. The patient is screened for the threshold of hearing using a test that comprises the following waveforms. Which waveform represents the lateral lemniscus?",
    "choices": [
      {
        "id": 1,
        "text": "Wave VI"
      },
      {
        "id": 2,
        "text": "Wave V"
      },
      {
        "id": 3,
        "text": "Wave III"
      },
      {
        "id": 4,
        "text": "Wave IV"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows the waveforms seen in <strong>brainstem evoked response audiometry</strong> (BERA), and <strong>wave\u00a0V</strong>\u00a0represents the <strong>lateral lemniscus</strong>.</p>\n<p>Brainstem evoked response audiometry (BERA) is an <strong>objective</strong> and <strong>non-invasive method</strong> of hearing assessment that detects electrical activity occurring in the auditory pathway. Stimuli are applied in the form of clicks or tone bursts, which then elicit brainstem responses. Normally, 7 waves are produced in the first 10 minutes.\u00a0</p>\n<ul>\n<li>Wave I by the distal part of the vestibulocochlear nerve</li>\n<li>Wave II by the proximal part of the vestibulocochlear nerve</li>\n<li>Wave III by the cochlear nucleus</li>\n<li>Wave IV by superior olivary complex</li>\n<li><strong>Wave V by lateral lemniscus</strong></li>\n<li>Waves VI and VII by the inferior colliculus</li>\n</ul>\n<p>The first, third, and fifth waves are the most stable and are used in measurements.</p>\n<p>Uses of BERA are:</p>\n<ul>\n<li>As a <strong>screening procedure</strong> for infants.</li>\n<li>To determine the <strong>threshold of hearing in infants</strong> also in children, and adults who <strong>do not cooperate</strong> and are <strong>malingerers</strong>.</li>\n<li>To <strong>diagnose brainstem pathology</strong>, e.g. multiple sclerosis or pontine tumors.</li>\n<li>To <strong>monitor</strong> VIII cranial nerve <strong>intraoperatively</strong> in surgery of acoustic neuroma to preserve the function of the cochlear nerve.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5311800407fa4b47b65e21f46fb28fbe.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b72d6b54935a490aa79c8b15a6d4bd6bx1280x2338.JPEG"
    ]
  },
  {
    "text": "A woman who came to the ENT Outpatient department was tested with the instrument given below for impaired hearing. Which of the following tests can be performed with this instrument?",
    "choices": [
      {
        "id": 1,
        "text": "2,3,5"
      },
      {
        "id": 2,
        "text": "3,4,5"
      },
      {
        "id": 3,
        "text": "1,2,4"
      },
      {
        "id": 4,
        "text": "1,2,5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span style=\"font-size: 12pt;\">The instrument given in the image is a\u00a0<strong>t</strong><strong>uning fork. Weber\u2019s test</strong>,\u00a0<strong>Schwabach\u2019s</strong> test, and <strong>Gelle\u2019s</strong> test can be done with a tuning fork.</span></p>\n<p><span style=\"font-size: 12pt;\"><strong>Tuning fork tests</strong> are performed commonly with tuning forks of frequencies such as 128, 256, 512, 1024, etc. The tuning fork of <strong>512 Hz</strong> is considered <strong>ideal</strong> as forks of lower frequencies produce a sense of bone vibration, while those of higher frequencies have a shorter decay time. Some examples of commonly done tuning fork tests are as follows:</span></p>\n<p><span style=\"font-size: 12pt;\"><strong>Weber\u2019s test </strong>is done by placing a vibrating tuning in the middle of the forehead or the vertex, and the patient is asked in which ear the sound is better heard. The inferences are as follows:</span></p>\n<ul>\n<li><span style=\"font-size: 12pt;\">It is reported as normal when the sound is heard equally in both ears</span></li>\n<li><span style=\"font-size: 12pt;\">In <strong>conductive</strong> deafness, it is lateralised to the <strong>worst</strong> ear.</span></li>\n<li><span style=\"font-size: 12pt;\">In <strong>sensorineural</strong> deafness it is lateralized to the <strong>better</strong> ear.</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ed0e6130ea984d71a27bdac1e7779db8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3fa3f86cc7e74fc3b274886bd12d3332x1279x1605.JPEG"
    ]
  }
];
        let quizName = 'Evaluation Of Hearing Loss Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2024-25"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>