<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>37  Nerve Supply Of Lower Limb  Lymph - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        DAMS / DQB / Anatomy
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">29</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "id": 50000,
    "choices": [
      {
        "id": 200000,
        "text": "Sural nerve"
      },
      {
        "id": 200001,
        "text": "Deep peroneal nerve"
      },
      {
        "id": 200002,
        "text": "Medial planter nerve"
      },
      {
        "id": 200003,
        "text": "Saphenous nerve"
      }
    ],
    "text": "A 10 year old boy taken for venesection of Great saphenous vein developed sudden pain & parasthesia on the medial aspect of great toe after giving incision over the vein & ligating it. Which of the following nerve is most likely involved in this case.",
    "unique_key": "Q9374234",
    "question_audio": null,
    "question_video": null,
    "map_id": 34913033,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Saphenous nerve The saphenous nerve is the correct answer because it provides sensory innervation to the medial aspect of the foot, including the great toe. The saphenous nerve is a branch of the femoral nerve and runs along the medial side of the leg. During a venesection procedure involving the great saphenous vein, there is a possibility that the saphenous nerve could be injured or compressed, especially when the incision is made over the vein or when the vein is ligated. This could result in symptoms such as pain and paresthesia (abnormal sensations like tingling or numbness) in the area of its sensory distribution, including the medial aspect of the great toe. Therefore, the nerve most likely involved in this scenario is the saphenous nerve. Incorrect Responses: (A) Sural nerve The sural nerve is a sensory nerve that provides sensation to the lateral aspect of the foot and ankle. It does not supply the medial side of the foot, particularly the medial aspect of the great toe, which is the area affected in this case. The sural nerve is located more on the lateral side of the lower leg and would not typically be affected during a procedure involving the great saphenous vein, which runs medially. (B) Deep peroneal nerve The deep peroneal nerve innervates muscles in the anterior compartment of the leg and provides sensory innervation to the web space between the first and second toes. However, it does not supply the medial aspect of the great toe. The deep peroneal nerve is not likely to be involved in this case, as the symptoms described are localized to the medial side of the foot and toe. (C) Medial plantar nerve The medial plantar nerve is a branch of the tibial nerve that supplies the medial side of the sole of the foot and the first three toes, but it does not typically provide sensory innervation to the medial aspect of the great toe. Its distribution is focused more on the plantar surface of the foot rather than the dorsomedial area. Therefore, it is not the nerve involved in this case.",
    "correct_choice_id": 200003,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/29158271697983820/29158271697983820.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/29158271697983820/29158271697983820.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50001,
    "choices": [
      {
        "id": 200004,
        "text": "Hip joint"
      },
      {
        "id": 200005,
        "text": "Knee joint"
      },
      {
        "id": 200006,
        "text": "Adductor longus"
      },
      {
        "id": 200007,
        "text": "Pectineus"
      }
    ],
    "text": "The posterior division of obturator nerve innervates \u2013",
    "unique_key": "Q9410645",
    "question_audio": null,
    "question_video": null,
    "map_id": 34694874,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Knee joint The posterior division of the obturator nerve innervates muscles that primarily act on the hip and knee joints. Among these muscles, it specifically innervates the adductor magnus, which is responsible for adduction of the thigh and has some role in extending the hip joint. However, the posterior division also contributes branches that provide sensory and motor innervation to the knee joint, making it the correct answer. The knee joint receives innervation from both the femoral and obturator nerves, and the posterior division plays a crucial role in providing motor innervation to muscles that affect knee stability and movement. Incorrect Responses: (A) Hip joint The obturator nerve, including both its anterior and posterior divisions, does contribute to the innervation of muscles that affect hip joint movement (such as adductor longus, adductor brevis, and adductor magnus). However, the obturator nerve itself does not directly innervate the hip joint. The innervation of the hip joint comes more directly from other sources such as the femoral nerve, the sciatic nerve, and the nerve to the quadratus femoris. Therefore, this is not the correct answer. (C) Adductor longus The adductor longus muscle is innervated by the anterior division of the obturator nerve, not the posterior division. The anterior division of the obturator nerve supplies this muscle, which is involved in thigh adduction and flexion at the hip joint. As such, the posterior division does not innervate the adductor longus. (D) Pectineus The pectineus muscle is innervated by both the femoral nerve and the obturator nerve, but the innervation comes from the anterior division of the obturator nerve rather than the posterior division. This muscle is responsible for flexion, adduction, and medial rotation of the thigh at the hip joint.",
    "correct_choice_id": 200005,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/16044241697984028/16044241697984028.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/16044241697984028/16044241697984028.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50002,
    "choices": [
      {
        "id": 200008,
        "text": "Sartorius"
      },
      {
        "id": 200009,
        "text": "Rectus femoris"
      },
      {
        "id": 200010,
        "text": "Tensor fasciae lata"
      },
      {
        "id": 200011,
        "text": "Articularis genu"
      }
    ],
    "text": "Femoral nerve does not supply \u2013",
    "unique_key": "Q6697280",
    "question_audio": null,
    "question_video": null,
    "map_id": 34363146,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Tensor fasciae lata. Explanation for Correct Answer: The femoral nerve does not supply the tensor fasciae lata muscle. This muscle, which is responsible for stabilizing the hip and the knee joint, is innervated by the superior gluteal nerve, not the femoral nerve. Despite its location in the anterior thigh region, the tensor fasciae lata is not part of the group of muscles innervated by the femoral nerve. Explanation for Incorrect Answers: (A) Sartorius: The sartorius muscle is innervated by the femoral nerve. It is the longest muscle in the body and plays a key role in hip flexion, abduction, and external rotation. Therefore, the femoral nerve provides motor innervation to this muscle. (B) Rectus femoris: The rectus femoris is part of the quadriceps group, and it is innervated by the femoral nerve. It is involved in knee extension and also assists in hip flexion, making it one of the key muscles that the femoral nerve supplies. (D) Articularis genu: The articularis genu muscle is also innervated by the femoral nerve. It is a small muscle located near the knee joint, and it functions to pull the synovial membrane of the knee joint during extension, helping prevent the membrane from being pinched.",
    "correct_choice_id": 200010,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/2138571697984160/2138571697984160.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/2138571697984160/2138571697984160.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50003,
    "choices": [
      {
        "id": 200012,
        "text": "Deep peroneal nerve"
      },
      {
        "id": 200013,
        "text": "Superficial peroneal nerve"
      },
      {
        "id": 200014,
        "text": "Tibial nerve"
      },
      {
        "id": 200015,
        "text": "Deltoid ligament"
      }
    ],
    "text": "Foot drop result as a result of injury to",
    "unique_key": "Q2471988",
    "question_audio": null,
    "question_video": null,
    "map_id": 34668938,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Deep peroneal nerve. Explanation for Correct Answer: Foot drop occurs when there is weakness or paralysis of the muscles responsible for dorsiflexion (lifting the foot) and eversion of the foot. The deep peroneal nerve (also known as the deep fibular nerve) innervates the muscles that control dorsiflexion, primarily the tibialis anterior, which is crucial for lifting the foot. When the deep peroneal nerve is damaged, the affected individual cannot dorsiflex the foot properly, leading to foot drop, a condition where the foot hangs limp and the individual struggles to lift it while walking. Therefore, the injury to the deep peroneal nerve causes foot drop, making option (A) correct. Explanation for Incorrect Answers: (B) Superficial peroneal nerve: The superficial peroneal nerve innervates the muscles responsible for eversion (turning the foot outward) and some cutaneous sensation on the dorsum of the foot. However, it does not directly control the muscles involved in dorsiflexion. Injury to the superficial peroneal nerve does not cause foot drop, which makes this option incorrect. (C) Tibial nerve: The tibial nerve innervates the muscles involved in plantarflexion (pointing the toes downwards), such as the gastrocnemius and soleus. While damage to the tibial nerve can lead to difficulties with plantarflexion, it does not cause foot drop, which is related to the inability to dorsiflex the foot. Therefore, this option is also incorrect. (D) Deltoid ligament: The deltoid ligament is a ligament in the ankle joint and has no involvement in the motor function of the foot. It is responsible for stabilizing the ankle, particularly preventing excessive eversion of the foot. Injury to the deltoid ligament does not lead to foot drop, as it does not affect the muscles responsible for dorsiflexion.",
    "correct_choice_id": 200012,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/41836701697984371/41836701697984371.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/41836701697984371/41836701697984371.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50004,
    "choices": [
      {
        "id": 200016,
        "text": "Common peroneal N."
      },
      {
        "id": 200017,
        "text": "Superficial peroneal N."
      },
      {
        "id": 200018,
        "text": "Anterior Tibial N."
      },
      {
        "id": 200019,
        "text": "Tibial N."
      }
    ],
    "text": "In injury to head of fibula, all are involved except -",
    "unique_key": "Q7711477",
    "question_audio": null,
    "question_video": null,
    "map_id": 34904259,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Tibial N. Explanation for the Correct Answer: Injury to the head of the fibula often affects the common peroneal nerve because it passes around the neck of the fibula and is vulnerable to compression or trauma at this site. When the common peroneal nerve is injured, it can lead to damage to its branches, including the superficial peroneal nerve and the deep peroneal nerve, which are responsible for the motor and sensory functions of the lower leg and foot. The common peroneal nerve provides motor function to the muscles in the anterior and lateral compartments of the leg, and sensory input to parts of the foot. The superficial peroneal nerve is a branch of the common peroneal nerve, and it supplies the muscles in the lateral compartment of the leg and provides sensation to the dorsum of the foot. The anterior tibial nerve is the deep branch of the common peroneal nerve and innervates the anterior compartment of the leg. However, the tibial nerve is not directly affected by an injury to the head of the fibula, as it travels down the posterior side of the leg. It is not a branch of the common peroneal nerve and is not involved in injuries to the head of the fibula. Explanation for Incorrect Answers: A. Common peroneal N.: The common peroneal nerve is directly involved in an injury to the head of the fibula. It can be compressed or injured due to its proximity to the fibular head. B. Superficial peroneal N.: The superficial peroneal nerve is a branch of the common peroneal nerve, and it would be affected in an injury to the fibula. C. Anterior Tibial N.: The anterior tibial nerve is a continuation of the deep branch of the common peroneal nerve, so it would also be involved in a fibular head injury.",
    "correct_choice_id": 200019,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/54832511697986238/54832511697986238.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/54832511697986238/54832511697986238.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50005,
    "choices": [
      {
        "id": 200020,
        "text": "1st web space of foot"
      },
      {
        "id": 200021,
        "text": "5th web space of foot"
      },
      {
        "id": 200022,
        "text": "Antero lateral dorsum of foot"
      },
      {
        "id": 200023,
        "text": "Lateral part of leg"
      }
    ],
    "text": "Deep peroneal nerve supplies \u2013",
    "unique_key": "Q9797654",
    "question_audio": null,
    "question_video": null,
    "map_id": 34910838,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) 1st web space of foot. Explanation for the Correct Answer: The deep peroneal nerve is a branch of the common peroneal nerve and innervates the muscles in the anterior compartment of the leg, which are primarily involved in dorsiflexion and extension of the toes. It also provides sensory innervation to the 1st web space of the foot \u2014 the area between the first and second toes. The deep peroneal nerve is responsible for sensation in the 1st web space, which is a common site for sensory testing in cases of peroneal nerve injury. Explanation for Incorrect Answers: B. 5th web space of foot: The 5th web space is typically supplied by the sural nerve, not the deep peroneal nerve. The sural nerve provides sensation to the lateral aspect of the foot and the little toe. C. Antero-lateral dorsum of foot: This region is mainly supplied by the superficial peroneal nerve, which innervates the skin on the dorsum of the foot, except for the area between the first and second toes (the 1st web space). D. Lateral part of leg: The lateral part of the leg is innervated by the superficial peroneal nerve, not the deep peroneal nerve, which mainly supplies the anterior compartment of the leg.",
    "correct_choice_id": 200020,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/14479501697986254/14479501697986254.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/14479501697986254/14479501697986254.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50006,
    "choices": [
      {
        "id": 200024,
        "text": "Lies outside femoral sheath"
      },
      {
        "id": 200025,
        "text": "Saphenous is largest cutaneous branch"
      },
      {
        "id": 200026,
        "text": "Supplies Quadriceps femoris"
      },
      {
        "id": 200027,
        "text": "Root value L2-L5"
      }
    ],
    "text": "True about femoral nerve are all except :",
    "unique_key": "Q5414486",
    "question_audio": null,
    "question_video": null,
    "map_id": 34333477,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Root value L2-L5. Explanation for the Correct Answer: The femoral nerve has root values L2-L4, not L2-L5. The femoral nerve is derived from the lumbar plexus, specifically from the L2, L3, and L4 spinal nerves. Therefore, option D is incorrect as it lists L5, which is not a part of the root values for the femoral nerve. Explanation for Incorrect Answers: A. Lies outside femoral sheath: This statement is correct. The femoral nerve lies outside the femoral sheath, while the femoral artery and femoral vein are contained within the sheath. The femoral nerve is located laterally to these vessels in the thigh. B. Saphenous is largest cutaneous branch: This statement is correct. The saphenous nerve, which is a branch of the femoral nerve, is the largest cutaneous branch. It supplies sensation to the skin of the medial aspect of the leg and foot. C. Supplies Quadriceps femoris: This statement is correct. The femoral nerve supplies the quadriceps femoris muscle, which is the primary extensor of the knee. It also supplies other muscles such as the sartorius and part of the pectineus muscle.",
    "correct_choice_id": 200027,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/46838831697987574/46838831697987574.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/46838831697987574/46838831697987574.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50007,
    "choices": [
      {
        "id": 200028,
        "text": "Medial cutaneous nerve of arm"
      },
      {
        "id": 200029,
        "text": "Lateral cutaneous nerve of thigh"
      },
      {
        "id": 200030,
        "text": "Ilioinguinal nerve"
      },
      {
        "id": 200031,
        "text": "Tibial nerve"
      }
    ],
    "text": "Meralgia paraesthesia is due to entrapment of which nerve -",
    "unique_key": "Q3232212",
    "question_audio": null,
    "question_video": null,
    "map_id": 34214847,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Lateral cutaneous nerve of thigh. Explanation for the Correct Answer: Meralgia paraesthesia is caused by the entrapment of the lateral cutaneous nerve of the thigh. This nerve supplies sensory innervation to the skin of the anterior and lateral thigh. When it gets compressed or entrapped, often at the level of the inguinal ligament, it can lead to symptoms like tingling, numbness, and pain on the outer thigh. This condition is commonly referred to as meralgia paraesthesia. Explanation for Incorrect Answers: A. Medial cutaneous nerve of arm: This is incorrect because the medial cutaneous nerve of the arm supplies sensory innervation to the skin of the medial side of the upper arm, not the thigh. Meralgia paraesthesia is not related to this nerve. C. Ilioinguinal nerve: This is incorrect because the ilioinguinal nerve provides sensory innervation to the skin of the lower abdomen, groin, and upper thigh, but it does not cause meralgia paraesthesia. The lateral cutaneous nerve of the thigh, not the ilioinguinal nerve, is responsible for this condition. D. Tibial nerve: This is incorrect because the tibial nerve is a major nerve in the leg that innervates muscles involved in plantarflexion and foot sensation, but it is not involved in meralgia paraesthesia, which specifically involves the lateral cutaneous nerve of the thigh.",
    "correct_choice_id": 200029,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/13115431697987762/13115431697987762.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/13115431697987762/13115431697987762.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50008,
    "choices": [
      {
        "id": 200032,
        "text": "Palmaris longus"
      },
      {
        "id": 200033,
        "text": "Flexor carpi radialis"
      },
      {
        "id": 200034,
        "text": "Palmaris longus"
      },
      {
        "id": 200035,
        "text": "Flexor polices longus"
      }
    ],
    "text": "WHICH MUSCLE DOES THE POINTED STRUCTURE REPRESENT<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/course_file_meta/395496212.jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q2509207",
    "question_audio": null,
    "question_video": null,
    "map_id": 34336551,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Flexor pollicis longus muscle. This muscle is located in the deep layer of the anterior compartment of the forearm. Its specific position\u2014originating from the anterior surface of the radius and the interosseous membrane, and traveling toward the thumb\u2014is accurately depicted in the image.",
    "correct_choice_id": 200035,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50009,
    "choices": [
      {
        "id": 200036,
        "text": "Popliteal fossa"
      },
      {
        "id": 200037,
        "text": "Fibular neck"
      },
      {
        "id": 200038,
        "text": "Lateral compartment of the leg"
      },
      {
        "id": 200039,
        "text": "Anterior compartment of the leg"
      },
      {
        "id": 200040,
        "text": "Medial malleolus"
      }
    ],
    "text": "A 12 years old male has a right leg cast after an accident. After some time, he complains of numbness of the dorsum of his right foot and on examnation, he cannot dorsiflex his right ankle. Which of the following is the most likely site of nerve compression in this patient?",
    "unique_key": "Q4571490",
    "question_audio": null,
    "question_video": null,
    "map_id": 34555144,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) numbness of the dorsum of his right foot is because of involvement of superficial peroneal nerve and patient cannot dorsiflex his right ankle is because of involvement of deep peroneal nerve. So the Correct Answerwer is Fibular neck where Common peroneal nerve may get compressed by tight cast.",
    "correct_choice_id": 200037,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/334631698326266/334631698326266.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/334631698326266/334631698326266.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50010,
    "choices": [
      {
        "id": 200041,
        "text": "Deep peroneal nerve"
      },
      {
        "id": 200042,
        "text": "Great saphenous vein"
      },
      {
        "id": 200043,
        "text": "Peroneal veins"
      },
      {
        "id": 200044,
        "text": "Posterior tibial artery"
      },
      {
        "id": 200045,
        "text": "Superficial peroneal nerve"
      }
    ],
    "text": "A 29-year-old previously healthy man comes to the hospital with a right leg injury after a cycling accident. He reports pain in the lower leg and inability to bear weight. X-ray reveals right tibial and fibular shaft fractures. The patient undergoes closed reduction and immobilization of thefractures. Several hours later, he has increasingly severe pain in his right leg. Physical examination shows increased tension within the anterior compartment. Which of the following structures is most likely to be compromised by this patient's acute complication?",
    "unique_key": "Q5444801",
    "question_audio": null,
    "question_video": null,
    "map_id": 34786082,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Acute compartment syndrome (ACS) is caused by increased pressure within fascial compartments of the limbs, leading to impaired perfusion. ACS can cause severe pain, myonecrosis, and nerve injury. The anterior compartment of the leg contains the deep peroneal (fibular)nerve, which is likely to be compromised byACS.",
    "correct_choice_id": 200041,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/42617241698328611/42617241698328611.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/42617241698328611/42617241698328611.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50011,
    "choices": [
      {
        "id": 200046,
        "text": "The common peroneal nerve was severed"
      },
      {
        "id": 200047,
        "text": "The peroneal muscles were detached from the head of the fibula"
      },
      {
        "id": 200048,
        "text": "The superficial peroneal nerve was severed"
      },
      {
        "id": 200049,
        "text": "The tibial nerve was severed"
      }
    ],
    "text": "An 18 -year-old athlete comes to the emergency department after falling while skating. There is a 3-cm laceration over the lateral aspect of the knee penetrating so deep that the head of the fibula is apparent. A radiograph of the leg is negative for any fractures. A noticeable foot-drop occurs while the patient walks. Further examination reveals inability to dorsiflex or evert the foot. Which of the following best explains her injury?",
    "unique_key": "Q2234619",
    "question_audio": null,
    "question_video": null,
    "map_id": 34473271,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) The common peroneal nerve wraps around the lateral aspect of the head of the fibula and is highly susceptible to damage during lacerations or blunt injuries to the lateral knee. Foot-drop with loss of dorsiflexion or eversion is characteristic.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/13_1(26).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200046,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/66516811698329388/66516811698329388.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/66516811698329388/66516811698329388.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50012,
    "choices": [
      {
        "id": 200050,
        "text": "Deep Peroneal N."
      },
      {
        "id": 200051,
        "text": "Superficial Peroneal N."
      },
      {
        "id": 200052,
        "text": "Saphenous N."
      },
      {
        "id": 200053,
        "text": "Sural N."
      }
    ],
    "text": "Nerve damaged when shunt is placed using great saphenous vein is?",
    "unique_key": "Q9804566",
    "question_audio": null,
    "question_video": null,
    "map_id": 34209929,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Option A-Deep Peroneal Nerve injury leads to foot drop. Option B-Superficial Peroneal Nerve injury leads to loss of eversion of foot. Option C-when a shunt is placed using great saphenous vein - saphenous nerve is at a high risk of injury as it runs along with it. Option D-Sural Nerve runs along with short saphenous vein.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/15(361).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200052,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/29699441698504129/29699441698504129.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/29699441698504129/29699441698504129.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50013,
    "choices": [
      {
        "id": 200054,
        "text": "Sural Nerve"
      },
      {
        "id": 200055,
        "text": "Saphenous Nerve"
      },
      {
        "id": 200056,
        "text": "Obturator Nerve"
      },
      {
        "id": 200057,
        "text": "Plantar Nerve"
      }
    ],
    "text": "A patient who underwent Varicose veins surgical treatment now presents with loss of sensation in medial leg. Which of the following nerve is injured in this patient?",
    "unique_key": "Q4216047",
    "question_audio": null,
    "question_video": null,
    "map_id": 34754456,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A-Sural Nerve lies in close relation with short saphenous nerve. Option B-When we are dealing with varicose vein,there is a risk of damage of great saphenous vein along with sapheneous nerve which runs in close relation to it. Option C-Obturator Nerve exits via obturator foramen and supplies adductors of thigh. Option D-Plantar Nerve supplies plantar aspect of foot.",
    "correct_choice_id": 200055,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/69296661698503976/69296661698503976.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/69296661698503976/69296661698503976.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50014,
    "choices": [
      {
        "id": 200058,
        "text": "2 and 3"
      },
      {
        "id": 200059,
        "text": "1 and 3"
      },
      {
        "id": 200060,
        "text": "3 and 4"
      },
      {
        "id": 200061,
        "text": "2 and 4"
      }
    ],
    "text": "During femoral cannulation, which nerve is blocked? 1) Lateral femoral cutaneous nerve 2) Femoral nerve 3) Genitofemoral nerve 4) Obturator nerve",
    "unique_key": "Q5566784",
    "question_audio": null,
    "question_video": null,
    "map_id": 34981868,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Lateral Femoral cutaneous nerve of thigh supply lateral side of thigh. Femoral nerve and Genitofemoral nerve supply the skin over femoral artery. hence,During femoral cannulation, these nerves are blocked. Obturator nerve supply medial side of thigh.",
    "correct_choice_id": 200058,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50015,
    "choices": [
      {
        "id": 200062,
        "text": "Sciatic Nerve"
      },
      {
        "id": 200063,
        "text": "Obturator Nerve"
      },
      {
        "id": 200064,
        "text": "Inferior rectal Nerve"
      },
      {
        "id": 200065,
        "text": "Pudendal Nerve"
      }
    ],
    "text": "Which of the following structure crosses the marked structure:<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/57(85).jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q2361942",
    "question_audio": null,
    "question_video": null,
    "map_id": 34238786,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Option A-Sciatic Nerve lies at inferior border of piriformis muscle. Option B-Obturator Nerve exits via obturator foramen. Option C-Inferior rectal Nerve is related to ischioanal fossa. Option D-Marked structure is ischial spine which is related to pudendal nerve as pudendal nerve nerve exits via greater sciatic foramen and re-enter via lesser sciatic foramen.",
    "correct_choice_id": 200065,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/71551821701776523/71551821701776523.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/71551821701776523/71551821701776523.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50016,
    "choices": [
      {
        "id": 200066,
        "text": "Femoral Nerve"
      },
      {
        "id": 200067,
        "text": "Common Peroneal Nerve"
      },
      {
        "id": 200068,
        "text": "Lateral cutaneous nerve of thigh"
      },
      {
        "id": 200069,
        "text": "Saphenous Nerve"
      }
    ],
    "text": "Most common nerve injured at the proximal end of the fibula is",
    "unique_key": "Q5637419",
    "question_audio": null,
    "question_video": null,
    "map_id": 34501772,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A-Femoral Nerve lies in femoral triangle of thigh. Option B-Common peroneal nerve winds around neck of fibula.hence,Most common nerve injured at the proximal end of the fibula is Common peroneal nerve.It leads to foot drop+loss of eversion.Deep peroneal nerve is a specific answer for foot drop. Option C-Lateral cutaneous nerve of thigh passes behind the lateral end of inguinal ligament. Option D-Saphenous Nerve runs along with great saphenous nerve.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/60_1(17).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200067,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/19196391701776574/19196391701776574.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/19196391701776574/19196391701776574.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50017,
    "choices": [
      {
        "id": 200070,
        "text": "Anterior"
      },
      {
        "id": 200071,
        "text": "Lateral"
      },
      {
        "id": 200072,
        "text": "Deep posterior"
      },
      {
        "id": 200073,
        "text": "Superficial posterior"
      }
    ],
    "text": "Compartment of leg without neurovascular bundle is?",
    "unique_key": "Q2100054",
    "question_audio": null,
    "question_video": null,
    "map_id": 34254974,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Option A-ANTERIOR COMPARTMENT has DEEP PERONEAL NERVE. Option B-LATERAL COMPARTMENT has SUPERFICIAL PERONEAL NERVE. Option C-DEEP POSTERIOR COMPARTMENT has TIBIAL NERVE. Option D-Gastrocnemius, Plantaris, soleus [GPS \u2013 SUPERFICIAL POSTERIOR COMPARTMENT] are supplied by tibial nerve, but in superficial posterior compartment nerve is not running.",
    "correct_choice_id": 200073,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/12722131701776751/12722131701776751.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/12722131701776751/12722131701776751.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50018,
    "choices": [
      {
        "id": 200074,
        "text": "A"
      },
      {
        "id": 200075,
        "text": "B"
      },
      {
        "id": 200076,
        "text": "C"
      },
      {
        "id": 200077,
        "text": "D"
      }
    ],
    "text": "Injury at which site causes failure of dorsiflexion?<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/4(23).png\" alt=\"Question Image\"></p>",
    "unique_key": "Q1190272",
    "question_audio": null,
    "question_video": null,
    "map_id": 34415648,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Option A-A is lateral epicondyle of femur. Option B-B is head of fibula. Option C-The site marked as \u2018C\u2019 in the given X-ray is the neck of fibula. Injury at this site causes failure of dorsiflexion (foot drop), loss of toe extension and eversion of the foot due to injury to the common fibular nerve. Sensory innervation of the dorsum of the foot including the first web space is also lost. The CPN (L4, L5, S1, S2) curves laterally round the neck of fibula and gets divided into the superficial and deep fibular nerves. Option D-D is shaft of tibia.",
    "correct_choice_id": 200076,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50019,
    "choices": [
      {
        "id": 200078,
        "text": "Gluteus Medius"
      },
      {
        "id": 200079,
        "text": "Piriformis"
      },
      {
        "id": 200080,
        "text": "Gluteus Minimus"
      },
      {
        "id": 200081,
        "text": "Tensor Fascia Lata"
      }
    ],
    "text": "Superior Gluteal nerve supplies all of the following except?",
    "unique_key": "Q1231667",
    "question_audio": null,
    "question_video": null,
    "map_id": 34788130,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A,C,D-Gluteus Medius,Gluteus Minimus and Tensor Fascia Lata are supplied by Superior Gluteal nerve. Option B-Nerve Supply of the Piriformis Muscle is from the ventral rami of the lower spinal nerves of the sacral plexus S1 and S2.",
    "correct_choice_id": 200079,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50020,
    "choices": [
      {
        "id": 200082,
        "text": "Sural nerve"
      },
      {
        "id": 200083,
        "text": "Deep peroneal nerve"
      },
      {
        "id": 200084,
        "text": "Medial planter nerve"
      },
      {
        "id": 200085,
        "text": "Saphenous nerve"
      }
    ],
    "text": "A 10 year old boy taken for venesection of Great saphenous vein developed sudden pain & parasthesia on the medial aspect of great toe after givin incision over the vein & ligating it. Which of the following nerve is most likely involved in this -",
    "unique_key": "Q1313521",
    "question_audio": null,
    "question_video": null,
    "map_id": 34098433,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Saphenous nerve. The saphenous nerve is the most likely nerve involved in this case. The saphenous nerve is a branch of the femoral nerve and provides sensory innervation to the medial aspect of the lower leg and foot, including the medial side of the great toe. During venesection or surgery on the great saphenous vein, the saphenous nerve can be inadvertently injured due to its anatomical proximity to the vein, especially around the medial aspect of the knee and lower leg. This can lead to symptoms such as pain and parasthesia (tingling) in the areas it innervates, including the medial side of the great toe. Reasons for Incorrect Options: A. Sural nerve: The sural nerve is a sensory nerve that provides innervation to the posterior and lateral aspects of the lower leg and foot. While the sural nerve might be affected by lower leg procedures, it does not supply the medial side of the great toe. Therefore, it is unlikely to cause parasthesia in this location after surgery on the great saphenous vein. B. Deep peroneal nerve: The deep peroneal nerve provides motor innervation to the anterior compartment of the leg and sensory innervation to the first web space of the foot (between the first and second toes). It does not innervate the medial side of the great toe, so it is not involved in this scenario. The symptoms described are not consistent with deep peroneal nerve involvement. C. Medial plantar nerve: The medial plantar nerve is a branch of the tibial nerve and innervates the sole of the foot, including the medial aspect of the first three toes, but it does not supply the medial side of the great toe. The medial plantar nerve is less likely to be involved in this case because the described symptoms occur more distally on the medial side of the great toe, which is supplied by the saphenous nerve.",
    "correct_choice_id": 200085,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50021,
    "choices": [
      {
        "id": 200086,
        "text": "Superficial inguinal LN"
      },
      {
        "id": 200087,
        "text": "Deep inguinal LN"
      },
      {
        "id": 200088,
        "text": "External iliac LN"
      },
      {
        "id": 200089,
        "text": "Popliteal LN"
      }
    ],
    "text": "The Lymphatic drainage from heel and lateral lateral part of foot is to:",
    "unique_key": "Q5782831",
    "question_audio": null,
    "question_video": null,
    "map_id": 34945740,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Popliteal lymph nodes. The lymphatic drainage from the heel and the lateral part of the foot primarily drains into the popliteal lymph nodes. These nodes are located in the posterior knee region and are responsible for draining lymph from the lower leg, including the heel and lateral aspects of the foot. The popliteal nodes receive lymph from superficial structures, including the foot and toes, and are part of the path that eventually leads to deeper lymphatic nodes further upstream. Reasons for Incorrect Options: A. Superficial inguinal lymph nodes: The superficial inguinal lymph nodes primarily receive lymph from the superficial tissues of the lower abdomen, external genitalia, and the anterior aspect of the thigh, but not from the heel or lateral part of the foot. Lymph from these areas typically drains into the popliteal nodes first, before being transported to the inguinal nodes. B. Deep inguinal lymph nodes: The deep inguinal lymph nodes are located near the femoral vessels and drain deeper structures of the lower limb, including the deep tissues of the thigh and lower leg. However, lymph from the heel and lateral foot predominantly first reaches the popliteal nodes before any further drainage toward the deep inguinal nodes. C. External iliac lymph nodes: The external iliac lymph nodes are responsible for draining lymph from deeper pelvic structures and the lower limb, but lymph from the heel and lateral part of the foot does not directly drain into them. The lymph from these areas would be filtered first through the popliteal nodes, then possibly through the deep inguinal nodes before reaching the external iliac nodes.",
    "correct_choice_id": 200089,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50022,
    "choices": [
      {
        "id": 200090,
        "text": "Genital branch of the genitofemoral nerve"
      },
      {
        "id": 200091,
        "text": "Ilioinguinal"
      },
      {
        "id": 200092,
        "text": "T 12"
      },
      {
        "id": 200093,
        "text": "Femoral"
      }
    ],
    "text": "The cremaster muscle is innervated by which of the following nerves -",
    "unique_key": "Q7173020",
    "question_audio": null,
    "question_video": null,
    "map_id": 34796130,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Genital branch of the genitofemoral nerve. The cremaster muscle, which is responsible for elevating the testis, is innervated by the genital branch of the genitofemoral nerve. This nerve arises from the lumbar plexus and specifically provides motor innervation to the cremaster muscle. The genital branch of the genitofemoral nerve travels with the spermatic cord and is responsible for the function of the cremaster muscle, which contracts during the cremasteric reflex. Therefore, option A is correct. Reasons for Incorrect Options: B. Ilioinguinal: The ilioinguinal nerve provides sensory innervation to the skin of the lower abdomen and the upper thigh, but it does not innervate the cremaster muscle. The ilioinguinal nerve passes through the inguinal canal but does not provide motor fibers to the cremaster muscle. Therefore, option B is incorrect. C. T12: T12 refers to the 12th thoracic spinal nerve, which is primarily involved in providing sensory innervation to the lower abdomen but does not innervate the cremaster muscle. The motor innervation to the cremaster muscle is specifically from the genital branch of the genitofemoral nerve. Therefore, option C is incorrect. D. Femoral: The femoral nerve supplies motor innervation to the muscles of the anterior thigh, such as the quadriceps, but it does not innervate the cremaster muscle. The femoral nerve does not have any direct role in the motor function of the cremaster muscle.",
    "correct_choice_id": 200090,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50023,
    "choices": [
      {
        "id": 200094,
        "text": "Vein"
      },
      {
        "id": 200095,
        "text": "Artery"
      },
      {
        "id": 200096,
        "text": "Nerve"
      },
      {
        "id": 200097,
        "text": "Lymph node"
      }
    ],
    "text": "What is medial most in femoral triangle -",
    "unique_key": "Q4608707",
    "question_audio": null,
    "question_video": null,
    "map_id": 34472961,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Lymph node lies in medial most position in femoral triangle<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/QID 5353 OR 5538.jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200097,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50024,
    "choices": [
      {
        "id": 200098,
        "text": "SI, S2"
      },
      {
        "id": 200099,
        "text": "SI, S2, S3"
      },
      {
        "id": 200100,
        "text": "S2, S3"
      },
      {
        "id": 200101,
        "text": "S2, S3, S4"
      }
    ],
    "text": "What is the root value of the posterior cutaneous nerve of the thigh?",
    "unique_key": "Q2344885",
    "question_audio": null,
    "question_video": null,
    "map_id": 34379786,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) S1, S2, S3. Explanation for the Correct Answer: The posterior cutaneous nerve of the thigh is primarily responsible for providing sensory innervation to the skin on the posterior side of the thigh and part of the popliteal fossa. Its root values are from the S1, S2, and S3 spinal nerves. This nerve is formed by the combination of branches from the sacral plexus and runs along the posterior thigh to supply cutaneous sensation. Explanation for Incorrect Answers: A. S1, S2: This combination does not provide full innervation to the posterior thigh, as the posterior cutaneous nerve also receives a contribution from S3. C. S2, S3: While S2 and S3 are part of the posterior cutaneous nerve\u2019s root values, S1 is also necessary to form the nerve. D. S2, S3, S4: The S4 spinal nerve is not involved in the formation of the posterior cutaneous nerve of the thigh. It primarily contributes to other structures, such as the pelvic floor and perineal area.",
    "correct_choice_id": 200099,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50025,
    "choices": [
      {
        "id": 200102,
        "text": "S, S2S3"
      },
      {
        "id": 200103,
        "text": "L4L5S, S2S3"
      },
      {
        "id": 200104,
        "text": "L, L2L3"
      },
      {
        "id": 200105,
        "text": "L2L3L4"
      }
    ],
    "text": "Root value of sciatic nerve",
    "unique_key": "Q4205964",
    "question_audio": null,
    "question_video": null,
    "map_id": 34479982,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) L4, L5, S1, S2, S3. Explanation for the Correct Answer: The sciatic nerve is formed by the ventral rami of the L4, L5, S1, S2, and S3 spinal nerves. It is the largest nerve in the body and is responsible for motor and sensory innervation to parts of the lower limb. The sciatic nerve originates from the lumbosacral plexus, specifically the sacral plexus, and is made up of these nerve roots (L4, L5, S1, S2, S3). Explanation for Incorrect Answers: A. S1, S2, S3: This option is incomplete. While the sciatic nerve does include contributions from S1, S2, and S3, it also includes L4 and L5, which are missing in this option. C. L1, L2, L3: The L1, L2, and L3 spinal nerves primarily contribute to the femoral nerve and obturator nerve, not the sciatic nerve. The sciatic nerve arises from L4 to S3. D. L2, L3, L4: The L2, L3, and L4 spinal nerves mainly contribute to the femoral nerve and obturator nerve, not the sciatic nerve. The sciatic nerve has roots from L4 to S3.",
    "correct_choice_id": 200103,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50026,
    "choices": [
      {
        "id": 200106,
        "text": "Gastrocnemius"
      },
      {
        "id": 200107,
        "text": "Plantaris"
      },
      {
        "id": 200108,
        "text": "Peroneus longus"
      },
      {
        "id": 200109,
        "text": "Tibialis posterior"
      }
    ],
    "text": "Tibial nerve supplies all except -",
    "unique_key": "Q7635740",
    "question_audio": null,
    "question_video": null,
    "map_id": 34125854,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Peroneus longus. Explanation for the Correct Answer: The tibial nerve is a branch of the sciatic nerve and is responsible for innervating most of the muscles in the posterior compartment of the leg, as well as some muscles in the plantar aspect of the foot. However, it does not innervate the peroneus longus muscle. The peroneus longus is supplied by the superficial peroneal nerve, not the tibial nerve. This muscle plays a key role in eversion and plantar flexion of the foot, but it lies in the lateral compartment of the leg, which is not innervated by the tibial nerve. Explanation for Incorrect Answers: A. Gastrocnemius: The gastrocnemius is a calf muscle involved in plantar flexion of the foot and flexion of the knee. It is innervated by the tibial nerve, which is responsible for controlling most of the muscles in the posterior compartment of the leg. B. Plantaris: The plantaris muscle, although small, is also innervated by the tibial nerve. It assists in plantar flexion and knee flexion, similar to the gastrocnemius, and is located in the posterior compartment of the leg. D. Tibialis posterior: The tibialis posterior is another muscle in the posterior compartment of the leg that is responsible for plantar flexion and inversion of the foot. It is innervated by the tibial nerve.",
    "correct_choice_id": 200108,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50027,
    "choices": [
      {
        "id": 200110,
        "text": "Styloid process"
      },
      {
        "id": 200111,
        "text": "Head"
      },
      {
        "id": 200112,
        "text": "Neck"
      },
      {
        "id": 200113,
        "text": "Shaft"
      }
    ],
    "text": "The common peroneal nerve can be rolled against the following part of the fibula-",
    "unique_key": "Q7917195",
    "question_audio": null,
    "question_video": null,
    "map_id": 34453016,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Neck. Explanation for the Correct Answer: The common peroneal nerve (also called the common fibular nerve) wraps around the neck of the fibula, making it an area where the nerve can be easily palpated or \"rolled\" against the bone. This nerve is particularly vulnerable to compression or injury in this location because it passes superficially just behind the fibula's neck. Compression in this region can lead to sensory and motor deficits in the areas supplied by the nerve, including the foot and lower leg. Explanation for Incorrect Answers: A. Styloid process: The styloid process is a bony prominence found on the distal end of the radius (in the forearm) and is unrelated to the common peroneal nerve, which is located in the lower leg. B. Head: While the head of the fibula is close to the common peroneal nerve's course, it is not the typical location where the nerve is easily rolled against the bone. The nerve tends to pass more prominently around the neck of the fibula, rather than the head. D. Shaft: The shaft of the fibula is too far away from the common peroneal nerve's path to be a location where the nerve could be easily rolled. The nerve travels around the neck of the fibula, not the shaft.",
    "correct_choice_id": 200112,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50028,
    "choices": [
      {
        "id": 200114,
        "text": "Sural nerve"
      },
      {
        "id": 200115,
        "text": "Saphenous nerve"
      },
      {
        "id": 200116,
        "text": "Deep peroneal nerve"
      },
      {
        "id": 200117,
        "text": "Lateral plantar nerve"
      }
    ],
    "text": "Skin of dorsum of first web space of foot is supplied by",
    "unique_key": "Q9151936",
    "question_audio": null,
    "question_video": null,
    "map_id": 34849635,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Deep peroneal nerve. Explanation for the Correct Answer: The deep peroneal nerve (or deep fibular nerve) is responsible for providing sensory innervation to the skin of the dorsum of the first web space of the foot. This nerve is a branch of the common peroneal nerve and supplies the skin between the first and second toes. Additionally, it innervates muscles responsible for dorsiflexion and extension of the toes, such as the tibialis anterior and extensor hallucis longus. Explanation for Incorrect Answers: A. Sural nerve: The sural nerve is a sensory nerve that innervates the posterolateral aspect of the lower leg and the lateral side of the foot, including the little toe. It does not provide sensation to the dorsum of the first web space. B. Saphenous nerve: The saphenous nerve is a branch of the femoral nerve and provides sensory innervation to the medial side of the lower leg and medial aspect of the foot. It does not supply the dorsum of the first web space, which is the domain of the deep peroneal nerve. D. Lateral plantar nerve: The lateral plantar nerve is a branch of the tibial nerve and primarily supplies muscles and skin on the lateral side of the sole of the foot, including the little toe and the lateral half of the fourth and fifth toes. It does not provide sensation to the dorsum of the first web space.",
    "correct_choice_id": 200116,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '37  Nerve Supply Of Lower Limb  Lymph';
        const quizFilename = '37-nerve-supply-of-lower-limb-lymph-f9e8cfc4.html';
        let hierarchy = ["DAMS", "DQB", "Anatomy"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on navigation
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>