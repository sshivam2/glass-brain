<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 039 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "An intellectually challenged teenager was diagnosed with a trinucleotide repeat mutation disease. On examination, his IQ is 49. He has a long face with a large mandible, everted large ears, a high-arched palate, and large testicles. What is the most likely nucleotide repeat sequence in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "CAG"
      },
      {
        "id": 2,
        "text": "CTG"
      },
      {
        "id": 3,
        "text": "CGG"
      },
      {
        "id": 4,
        "text": "GAA"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical vignette is suggestive of<strong> fragile X syndrome</strong>. The specific <strong>trinucleotide repeat</strong> sequence in fragile X syndrome is <strong>CGG.</strong></p>\n<p>Fragile X syndrome is the most common genetic cause of <strong>intellectual disability</strong>&nbsp;after Down's syndrome. It is due to the mutation in the <strong>familial mental retardation 1 gene (FMR1)&nbsp;</strong>located on the<strong> long arm </strong>of the<strong> X chromosome</strong>.&nbsp;</p>\n<p>It is associated with the phenomenon of&nbsp;<strong>anticipation</strong>,&nbsp;where the&nbsp;<strong>disease phenotype worsens</strong>&nbsp;over&nbsp;<strong>generations</strong>&nbsp;within a family. The affected males are&nbsp;<strong>intellectually disabled</strong>, with an&nbsp;<strong>IQ</strong>&nbsp;in the range of&nbsp;<strong>20 </strong>to <strong>60</strong>. Neuropsychiatric features include aggressive behavior, autism spectrum disorder,&nbsp;epilepsy, and anxiety/hyperactivity disorders.</p>\n<p>The characteristic phenotypic features include&nbsp;the following:</p>\n<ul>\n<li><strong>Long face</strong>&nbsp;with a&nbsp;<strong>large mandible</strong></li>\n<li><strong>Large&nbsp;everted&nbsp;ears</strong></li>\n<li><strong>Macro-orchidism </strong>(large testicles)</li>\n<li>Hyperextensible joints</li>\n<li><strong>High arched palate</strong></li>\n<li>Mitral valve prolapse</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the instrument given below.",
    "choices": [
      {
        "id": 1,
        "text": "Proctoscope"
      },
      {
        "id": 2,
        "text": "Sims' speculum"
      },
      {
        "id": 3,
        "text": "Cusco\u2019s speculum"
      },
      {
        "id": 4,
        "text": "Doyen's retractor"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The instrument shown in the image is<strong>&nbsp;a proctoscope.&nbsp;</strong></p>\n<p>A&nbsp;lubricated proctoscope to visualize lesions in the anus, anorectal junction, and lower rectum. Proctoscopy is done as an OPD procedure to detect hemorrhoids, polyps, or ulcers</p>\n<p><strong>Cusco&rsquo;s speculum</strong> is a self-retaining bivalve speculum used for <strong>visualisation of the cervix</strong>, <strong>vaginal fornices </strong>and for performing <strong>pap smear</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c3691143675d4f559dc50f0961aa3bb6.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d83f3c769c54152b53b9d75fc43e50cx360x270.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/038269f5325540f2bc86d1514c63f589x360x270.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/23156d3a9ed24d9ab277de68ad03bd7dx1279x1116.JPEG"
    ]
  },
  {
    "text": "During the evaluation of a patient with recurrent urinary tract infections, the following urographic finding was observed. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Horseshoe kidney"
      },
      {
        "id": 2,
        "text": "Medullary sponge kidney"
      },
      {
        "id": 3,
        "text": "Duplicated collecting system"
      },
      {
        "id": 4,
        "text": "Retrocaval ureter"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows the <strong>inferolateral displacement</strong> of the opacified lower pole due to an obstructed (and unopacified) upper pole. This is called the\u00a0<strong>drooping lily sign</strong>\u00a0and is observed in patients with a <strong>duplicated collecting system</strong><strong>.</strong>\u00a0</p>\n<p>This condition is characterized by an <strong>incomplete fusion </strong>of upper and lower pole moieties resulting in a variety of complete or incomplete duplications of the collecting system.</p>\n<p>Duplex collecting systems may also be complicated by vesicoureteric reflux, obstruction, or ureterocoele.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e6a35ae67ce2410c8fc898cef94dae3e.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The antiviral agent that is active against all herpes viruses and HIV is:",
    "choices": [
      {
        "id": 1,
        "text": "Foscarnet"
      },
      {
        "id": 2,
        "text": "Trifluridine"
      },
      {
        "id": 3,
        "text": "Acyclovir"
      },
      {
        "id": 4,
        "text": "Famciclovir"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Foscarnet</strong> is the antiviral agent that is active against <strong>all herpes viruses</strong> and <strong>HIV.</strong></p>\n<p><strong>Foscarnet</strong> is an inorganic pyrophosphate analog. It does not require activation by viral thymidine kinase for antiviral activity. It<strong>&nbsp;</strong>inhibits viral nucleic acid synthesis<strong>&nbsp;</strong>by <strong>directly&nbsp;inhibiting HSV DNA polymerase</strong> and HIV reverse transcriptase.</p>\n<p>Foscarnet is used to treat <strong>acyclovir-resistant</strong> <strong>herpes simplex virus</strong> (genital herpes) and <strong>varicella-zoster virus</strong> infections and <strong>ganciclovir-resistant </strong>cytomegalovirus (CMV) infections. It is also used as an alternative agent in CMV retinitis in AIDS, and CMV viremia in bone marrow transplant recipients.</p>\n<p>Common side effects of foscarnet include <strong>nephrotoxicity</strong> and <strong>hypocalcemia.</strong></p>\n<p>Foscarnet is mainly <strong>excreted</strong> by the <strong>kidneys</strong>.&nbsp;Therefore,<strong> dose reduction</strong> is <strong>necessary</strong> for renal impairment to avoid the accumulation of the drug and associated toxicity.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Trifluridine </strong>is a pyrimidine antimetabolite antiviral drug. It acts against <strong>herpes simplex virus -1, 2,</strong> and<strong> CMV</strong>. It is approved for use in herpes simplex keratitis.</p>\n<p>Option C: <strong>Acyclovir </strong>is active against <strong>herpes simplex virus -1, 2,</strong> varicella-zoster virus, Ebstein Barr virus, and partially against<strong> CMV. </strong>It is useful against a variety of herpes simplex infections like genital herpes, mucocutaneous herpes, herpes simplex encephalitis, keratitis, and chickenpox.</p>\n<p>Option D: <strong>Famcyclovir</strong> is active against <strong>herpes simplex</strong> and <strong>herpes zoster virus.</strong> It is used as a second-line agent for genital or orolabial herpes.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following public health centers do First Referral Units (FRUs) and non-FRUs belong to?",
    "choices": [
      {
        "id": 1,
        "text": "Health and Wellness Center - PHC"
      },
      {
        "id": 2,
        "text": "Health and Wellness Center - Sub-Center"
      },
      {
        "id": 3,
        "text": "Sub-District Hospital"
      },
      {
        "id": 4,
        "text": "Community Health Center"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>First Referral Units (<strong>FRUs</strong>) and <strong>non-FRUs</strong> belong to the Community Health Centers (CHCs).&nbsp;</p>\n<p>The Indian Public Health Standards (IPHS) guidelines are a code of standards for uniformity in health facilities in the Indian public health system, under the National Health Mission (NHM), Ministry of Health and Family Welfare (MoHFW), India. It aims to provide guidance on the <strong>infrastructure, human resources</strong>, drugs, diagnostics, equipment, quality, and governance requirements for delivering health services at all levels of facilities in the system.</p>\n<p>The <strong>2022 edition of IPHS</strong> mainly concentrates on comprehensive primary health care, increasing the human workforce, decentralized access to healthcare, and better implementation of universal health coverage.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b47a859b9af447c9ae8e38ba577392edx1280x1793.JPEG"
    ]
  },
  {
    "text": "A 67-year-old patient with a history of diabetes presented with swelling around the knee, restriction of movement, and minimal or no pain. The x-ray of the knee is given below. The diagnosis is _________.",
    "choices": [
      {
        "id": 1,
        "text": "Rheumatoid arthropathy"
      },
      {
        "id": 2,
        "text": "Osteoarthritis"
      },
      {
        "id": 3,
        "text": "Charcot arthropathy"
      },
      {
        "id": 4,
        "text": "Psoriatic arthropathy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The x-ray depicts <strong>severe joint destruction and instability</strong>, seen on (a) varus stress (b) neutral (c) valgus stress on the patient's knee joint. There is <strong>minimal pain </strong>and this&nbsp;<strong>indicates a neuropathic cause</strong> like <strong>Charcot arthropathy.</strong></p>\n<p>Charcot arthropathy is a neuroarthropathy commonly associated with diabetes.</p>\n<p><strong>Diabetes</strong> is the most common cause of Charcot arthropathy, while tertiary syphilis was one of the common causes previously.</p>\n<p>Though the exact pathogenesis of this disease is unclear, it is speculated that&nbsp;<strong>vascular</strong>,&nbsp;<strong>neurological</strong>, and&nbsp;<strong>metabolic changes</strong>&nbsp;associated with diabetes lead to this condition.</p>\n<p>Rheumatoid arthritis, osteoarthritis, and psoriatic arthropathy present with pain.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5b4241d307194526afc022819894cb91.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The structures shown in the below image are found in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Multiple myeloma"
      },
      {
        "id": 2,
        "text": "Meningioma"
      },
      {
        "id": 3,
        "text": "Schwanomma"
      },
      {
        "id": 4,
        "text": "Granulosa cell tumor"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows<strong> psammoma bodies. </strong>They&nbsp;are found in <strong>meningioma</strong>.</p>\n<p>Psammoma bodies are <strong>concentric, lamellated structures</strong> formed as a product of <strong>dystrophic calcification. </strong>They are<strong>&nbsp;</strong>associated with<strong> papillary</strong> <strong>histomorphology</strong>&nbsp;and are caused by <strong>infarction and calcification of papillae tips.&nbsp;</strong></p>\n<p>Conditions associated with psammoma bodies include-</p>\n<ul>\n<li>Papillary thyroid carcinoma</li>\n<li>Papillary renal cell carcinoma</li>\n<li>Serous cystadenocarcinoma</li>\n<li>Meningiomas.</li>\n</ul>\n<p>Meningiomas are predominantly&nbsp;<strong>benign</strong>&nbsp;tumors, usually attached to the dura. They are predominantly seen in females and in patients with&nbsp;<strong>neurofibromatosis type 2</strong>, which is an autosomal disorder associated with multiple meningiomas, schwannomas, and ependymomas.</p>\n<p>They arise from the&nbsp;<strong>meningothelial cells</strong>&nbsp;or&nbsp;<strong>arachnoid cap cells</strong>. The most common karyotypic abnormality is the loss of the long arm of&nbsp;<strong>chromosome 22</strong>.&nbsp;Meningiomas often express hormone receptors (eg: Progesterone), hence, they may grow rapidly in pregnancy.</p>\n<p>Meningiomas are rubbery, rounded, or bosselated dural masses. They compress the underlying brain tissue. They present with&nbsp;headaches, seizures, or focal neurological deficits.&nbsp;</p>\n<p>The tumor spreads in a sheet-like manner along the surface of the dura causing reactive<strong>&nbsp;hyperostotic changes</strong>&nbsp;in adjacent bones. They are mostly located in cerebral convexities. The lesions may be finely gritty due to numerous psammomatous calcification.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Russell bodies</strong> are cytoplasmic globular <strong>inclusions</strong> that are seen in <strong>multiple myeloma</strong>.</p>\n<p>Option C:&nbsp;<strong>Verocay bodies</strong> are<strong>&nbsp;spindle cells</strong> that are arranged to form central &ldquo;nuclear-free zones&rdquo; ramified by <strong>palisading nuclei</strong> and are seen in <strong>Schwanomma</strong>.</p>\n<p>Option D:&nbsp;<strong>Call-Exner bodies</strong> are <strong>diagnostic</strong> gland-like immature <strong>follicles</strong> that are filled with an acidophilic material and are seen in <strong>granulosa cell tumours </strong>of the <strong>ovary</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/58bf0c136f16415ab232f4a5d3f0b77a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old male patient presented after an episode of acute gastroenteritis and was infused with fluids. A while later, after fluid infusion, his heart rate rose to 122 bpm and he complained of palpitations. The presence of tachycardia can be explained by which of the following mechanisms?",
    "choices": [
      {
        "id": 1,
        "text": "Bezold-Jarisch reflex"
      },
      {
        "id": 2,
        "text": "Pulmonary chemoreflex"
      },
      {
        "id": 3,
        "text": "Bainbridge reflex"
      },
      {
        "id": 4,
        "text": "Cushing's reflex"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The presence of tachycardia can be explained by the\u00a0<strong>Bainbridge</strong> <strong>reflex.</strong></p>\n<p>It is a compensatory cardiac reflex where\u00a0there is an\u00a0<strong>increase\u00a0in the\u00a0heart rate\u00a0</strong>in response to <strong>raised atrial stretch. </strong></p>\n<p>In fluid overload states, commonly after <strong>excessive fluid infusion</strong>, there is <strong>distension of the atria</strong> due to increased blood volume. This <strong>distension</strong> activates the atrial stretch receptors which transmit the afferent signals to the medulla via the vagus nerve.\u00a0The efferent signals are then transmitted back through vagal\u00a0and sympathetic nerves. This leads to an increase in\u00a0the strength\u00a0of contraction of the heart and\u00a0<strong>tachycardia.</strong>\u00a0This reflex helps in preventing excess accumulation of blood in the atria, veins, and in the pulmonary circulation.</p>\n<p>Other options -\u00a0</p>\n<p>Option A:\u00a0<strong>Bezold-Jarisch reflex</strong> is due to the activation of <strong>chemosensitive vagal C fibers</strong>\u00a0in the cardiopulmonary region. They can be elicited after administering certain irritants like <strong>capsaicin</strong> or serotonin. It can also be activated during myocardial infarction and on exposure to radioactive dyes during coronary angiography. This reflex is characterized by <strong>profound\u00a0brady\u00adcardia, hypotension</strong>, and a brief period of <strong>apnea</strong> followed by <strong>rapid shallow breathing</strong>.\u00a0</p>\n<p>Option B<strong>: Pulmonary chemoreflex</strong> is due to the stimulation of the <strong>J-receptors</strong> (C receptors/juxta-pulmonary capillary receptors) which are stimulated when there is hyperinflation of the lung. This produces\u00a0reflex <strong>apnea</strong> followed by a <strong>rapid increase in breathing rate</strong>, <strong>bradycardia,</strong> and <strong>hypotension</strong>.</p>\n<p>Option D:<strong> Cushing's reflex </strong>is seen when the\u00a0<strong>intracranial\u00a0pressure\u00a0</strong>is<strong> raised </strong>where the blood supply to ventrolateral medulla neurons is compromised.\u00a0The local hypoxia and hypercapnia stimulate the neurons producing <strong>hypertension, bradycardia</strong>, and<strong> irregular respiration</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 34-year-old man with Crohn\u2019s disease presents with red tender swellings on the lower leg as shown below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pyoderma gangrenosum"
      },
      {
        "id": 2,
        "text": "Erythema nodosum"
      },
      {
        "id": 3,
        "text": "Sweet\u2019s syndrome"
      },
      {
        "id": 4,
        "text": "Ecthyma gangrenosum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario suggests a diagnosis of <strong>e</strong><strong>rythema nodosum</strong> seen in inflammatory bowel disease (IBD).\u00a0</p>\n<p>Erythema nodosum is a dermatologic manifestation of IBD. It is<strong>\u00a0</strong>seen in both ulcerative colitis and Crohn's disease. It manifests as <strong>tender erythematous</strong> <strong>nodules</strong> on the anterior surface of the lower legs, ankles, thighs, and arms.</p>\n<p>Option A: <strong>Pyoderma gangrenosum</strong> is a dermatological manifestation of IBD. It begins as pustular lesions which then ulcerate with necrotic foci and exudation.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fd0e2472028047c699f3b3c5a983ed32.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17a28a63418444c3b4d88da19ae2f05ax880x605.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e3143b2f02254c7ea92ecd571a79bc70x685x514.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c250c41b14fe4cee900baaf8dfb0f9c2x719x507.PNG"
    ]
  },
  {
    "text": "A patient presents with complaints of severe left loin pain and burning micturition. His erect abdominal X-ray is shown below. What is the best management for his condition?",
    "choices": [
      {
        "id": 1,
        "text": "Extracorporeal shockwave lithotripsy"
      },
      {
        "id": 2,
        "text": "Percutaneous nephrolithotomy"
      },
      {
        "id": 3,
        "text": "Percutaneous nephrostomy"
      },
      {
        "id": 4,
        "text": "Ureteroscopic removal"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given abdominal X-ray shows <strong>left staghorn renal calculi. </strong>The best treatment option for staghorn renal calculi is <strong>percutaneous nephrolithotomy (PCNL).</strong></p>\n<p><strong>Staghorn calculi </strong>is also known as <strong>triple phosphate stone. </strong>It occupies the renal pelvis and calyces.</p>\n<p><strong>PCNL:</strong><strong>&nbsp;</strong>Endoscopic instruments are passed into the kidney by percutaneous technique and stones are fragmented and removed. It is mainly used in treating large stones and stones in the proximal ureter.</p>\n<p>Indications of PCNL:</p>\n<ul>\n<li>Obstructions caused by anatomical abnormalities like pulviureteric junction obstruction, calyceal diverticula or ureteric obstruction</li>\n<li><strong>Staghorn calculi</strong></li>\n<li>Stones <strong>&gt;2.5 cm</strong> in size</li>\n<li>Stone composition - <strong>struvite</strong>, <strong>calcium oxalate monohydrate</strong> and <strong>cystine</strong> stones</li>\n<li><strong>Multiple stones</strong></li>\n<li><strong>Obese patients</strong> in whom <strong>ESWL</strong> is <strong>contraindicated </strong></li>\n<li>Stones not responding for ESWL</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ac9bdd68050f4bf3b862360b6757438a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ec2aa35ede5b4582ba611a596f1bfeedx1280x1688.JPEG"
    ]
  },
  {
    "text": "What is the sequence of pubertal changes in girls?",
    "choices": [
      {
        "id": 1,
        "text": "Thelarche\u2192Pubarche\u2192Menarche"
      },
      {
        "id": 2,
        "text": "Pubarche\u2192Thelarche\u2192Menarche"
      },
      {
        "id": 3,
        "text": "Pubarche\u2192Menarche\u2192Thelarche"
      },
      {
        "id": 4,
        "text": "Menarche\u2192Thelarche\u2192Pubarche"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The sequence of pubertal changes seen in girls is <strong>thelarche &rarr; pubarche &rarr; menarche.</strong></p>\n<div class=\"page\" title=\"Page 346\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Puberty marks the normal physiologic transition from childhood to sexual and reproductive maturity. The order of changes in puberty are:&nbsp;</p>\n</div>\n</div>\n</div>\n<ol>\n<li><strong>Thelarche -</strong>&nbsp;It refers to&nbsp;<strong>breast budding,</strong> and is the first visible sign. It indicates the competency of the hypothalamo-pituitary-ovarian axis. It appears between the age of<strong> 9-11 years</strong>, and is described using Tanner staging.</li>\n<li><strong>Adrenarche - </strong>It refers to the <strong>generation of androgens</strong> (estrogen and testosterone) from the adrenal gland.&nbsp;</li>\n<li><strong>Pubarche -&nbsp;</strong>It refers to the development of <strong>pubic hair,</strong> and occurs usually <strong>6 months after thelarche</strong>.&nbsp;It is also described using Tanner staging.</li>\n<li><strong>Menarche -&nbsp;</strong>It refers to the <strong>first</strong> occurrence of <strong>menstruation.</strong>&nbsp;</li>\n</ol>\n<p>Following breast and pubic hair growth, adolescents undergo an accelerated increase in height. This is known as <strong>growth spurt</strong> and occurs between ages <strong>10.5 to 13.5 years</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with impaired renal function was administered desflurane for general anesthesia. Which of the following statements is true regarding this drug?",
    "choices": [
      {
        "id": 1,
        "text": "Commonly used for induction in children"
      },
      {
        "id": 2,
        "text": "Rapid induction and recovery"
      },
      {
        "id": 3,
        "text": "Environmentally safe anesthetic"
      },
      {
        "id": 4,
        "text": "Less potent than nitrous oxide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Desflurane has <strong>rapid induction </strong>and<strong> recovery </strong>from anesthesia due to its <strong>low blood gas solubility</strong>.</p>\n<p>Other options:</p>\n<p>Option A: Desflurane is not&nbsp;used for induction in children as it is very <strong>pungent</strong>&nbsp;and may result in cough, <strong>laryngospasm</strong>, and bronchospasm.</p>\n<p>Option C: Desflurane is not environmentally safe as it has the <strong>maximum global warming</strong> <strong>potential</strong> among inhalational anesthetics. However,&nbsp;<strong>N<sub>2</sub>O</strong>&nbsp;contributes the&nbsp;<strong>most</strong> to increased climate impact&nbsp;(99.97%) as the consumption volumes of N<sub>2</sub>O far exceed those of other anesthetic gases.</p>\n<p>Option D: Desflurane is 17 times more potent than nitrous oxide.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A man regularly derives sexual gratification by inflicting pain upon his partner. He would often produce cuts and cigarette burns on his partner's arms. This is best described as?",
    "choices": [
      {
        "id": 1,
        "text": "Voyeurism"
      },
      {
        "id": 2,
        "text": "Fetishism"
      },
      {
        "id": 3,
        "text": "Sadism"
      },
      {
        "id": 4,
        "text": "Masochism"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario is suggestive of&nbsp;<strong>sexual sadism.&nbsp;</strong>It is seen more commonly in <strong>men</strong>. It develops due to early experiences of brutality in sex.</p>\n<p>The sadist may bite, beat, whip, produce cuts or cigarette burns etc on their sexual partner. In extreme cases, the victim's nipples may be bitten off, items such as a bottle or sticks are inserted into the vagina. <strong>Blunt trauma</strong> causing <strong>fractures</strong> and <strong>rupture of internal organs</strong> may also be seen.</p>\n<p>Other options:</p>\n<p>Option A -<strong> Voyeurism</strong> - It is the act of obtaining sexual gratification by <strong>observing an unsuspecting person</strong> who is naked, disrobing or engaging in sexual activity.</p>\n<p>Option B -<strong> Fetishism</strong> - It is a form of sexual behaviour in which gratification is associated with an <strong>abnormal stimulus</strong> which may be an object, activity or part of the body.</p>\n<p>Option D - <strong>Masochism</strong> - This is <strong>opposite</strong> to sadism. Sexual gratification is obtained by <strong>suffering the pain</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old child is brought with recurrent episodes of blood in his stool. Meckel\u2019s diverticulum is suspected. Which of the following can be used to confirm the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tc pyrophoshate"
      },
      {
        "id": 2,
        "text": "Tc 99m DTPA"
      },
      {
        "id": 3,
        "text": "Tc 99m MAG3"
      },
      {
        "id": 4,
        "text": "Tc 99m pertechnetate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Tc 99m pertechnetate</strong> scanning is used to confirm the diagnosis of <strong>Meckel's diverticulum</strong>.</p>\n<p>Other uses of Tc-99m pertechnetate include:</p>\n<ul>\n<li>Thyroid imaging</li>\n<li>Parathyroid imaging for distinguishing from the thyroid gland</li>\n<li>Testicular imaging</li>\n<li>Gastric emptying studies, intestinal and rectal functional studies</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman is planning a trip to Morocco, which is endemic for yellow fever. As per travel regulations, she receives the yellow fever vaccine. After how many days following vaccination is she eligible to travel?",
    "choices": [
      {
        "id": 1,
        "text": "5"
      },
      {
        "id": 2,
        "text": "10"
      },
      {
        "id": 3,
        "text": "15"
      },
      {
        "id": 4,
        "text": "7"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This woman is eligible to travel to the endemic area <strong>10 days</strong> after being <strong>vaccinated</strong> for <strong>yellow fever</strong>. This period is required for the majority of vaccine recipients to <strong>develop immunity</strong>.</p>\n<p>The&nbsp;<strong>17D vaccine</strong>&nbsp;is a&nbsp;<strong>live attenuated</strong>&nbsp;vaccine, administered <strong>subcutaneously</strong>.&nbsp;&nbsp;It is valid for a&nbsp;<strong>lifetime</strong>&nbsp;beginning 10 days after vaccination.&nbsp; The incubation period of yellow fever is&nbsp;<strong>3&ndash;6 days</strong>. Unvaccinated people are required to remain&nbsp;<strong>quarantined </strong>for<strong> 6 days&nbsp;</strong>(maximum period of incubation).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following measures are correct regarding the management of frostbite except:",
    "choices": [
      {
        "id": 1,
        "text": "Rewarming by asking the patient to exercise is not advised"
      },
      {
        "id": 2,
        "text": "Rapid rewarming can be accomplished by immersing the foot in a warm water bath"
      },
      {
        "id": 3,
        "text": "Rubbing/friction can be used to hasten up the process of rewarming"
      },
      {
        "id": 4,
        "text": "Tetanus prophylaxis must be given as there is increased risk of tetanus in frost bite"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Rewarming by<strong> exercise, rubbing, or friction</strong> is <strong>not advised.&nbsp;</strong></p>\n<p>In frostbite, tissue damage results from&nbsp;<strong>severe</strong>&nbsp;environmental&nbsp;<strong>cold exposure</strong>&nbsp;or from direct contact with a very cold object. Tissue&nbsp;injury results from both freezing and vascular stasis. It usually&nbsp;<strong>affects</strong>&nbsp;the distal aspects of the&nbsp;<strong>extremities</strong>&nbsp;or exposed parts of&nbsp;the face, such as the ears, nose, chin, and cheeks.</p>\n<p>Clinical features include <strong>decreased sensation </strong>(especially for pain, and temperature sensations) in the acral tips and extremities. Affected area appears waxy, mottled, or violaceous. Patients may have a wood-like sensation in the affected area.</p>\n<p>Treatment:</p>\n<ul>\n<li>Initial<strong>&nbsp;treatment</strong>&nbsp;is by rapid&nbsp;<strong>rewarming&nbsp;</strong>(or thawing), which is accomplished by immersion of the affected part in a <strong>water bath</strong> at&nbsp;temperatures of 37&deg;&ndash;40&deg;C (99&deg;&ndash;104&deg;F) for 30&ndash;60 min. Rewarming by exercise, rubbing, or friction is not advised.&nbsp;</li>\n<li><strong>Analgesics</strong> such as ibuprofen are often required during rewarming.</li>\n<li>Antithrombotics, <strong>thrombolytics</strong> and <strong>vasodilators</strong> such as prostacyclin can be given to improve circulation after rewarming.</li>\n<li>Frost bites are associated with an increased risk of <strong>infections</strong> and tetanus. Therefore, the injured area should&nbsp;be cleaned with soap or antiseptic, and sterile dressings should be&nbsp;applied. <strong>Tetanus prophylaxis must be given</strong>, but, empirical antibiotics are not recommended.</li>\n<li>The patient must be monitored for the development of compartment syndrome.</li>\n<li>Elective late&nbsp;<strong>amputation</strong> after imaging may be required in severe cases.</li>\n</ul>\n<p>Image showing frost bite of the toes</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e0a64eb40ba64ce5bb19166d95385f24x1280x956.JPEG"
    ]
  },
  {
    "text": "A patient with gastric cancer and Virchow's node developed a left-sided pleural effusion. An intercostal chest tube was inserted, and the following fluid was drained.  Which structure was likely the source of this effusion?",
    "choices": [
      {
        "id": 1,
        "text": "TB with pleural effusion"
      },
      {
        "id": 2,
        "text": "Thoracic duct"
      },
      {
        "id": 3,
        "text": "Esophageal injury"
      },
      {
        "id": 4,
        "text": "Azygos vein"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure affected in this case is the <strong>thoracic duct</strong>. It drains into the <strong>junction </strong>of the<strong> left jugular</strong> and<strong> left subclavian veins.</strong></p>\n<p>The given image shows chyle, and the case scenario is suggestive of <strong>chylothorax</strong> secondary to <strong>obstruction</strong> of the <strong>thoracic duct</strong> by Virchow's node.</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>A chylothorax occurs when the thoracic duct is disrupted and chyle accumulates in the pleural space. The most common cause of chylothorax is\u00a0<strong>trauma</strong>\u00a0(mainly thoracic surgery), but it may also result due to mediastinal tumors. Patients present with dyspnoea and a large pleural effusion.</p>\n</div>\n</div>\n<p>*Clinical note:</p>\n<p>In gastric cancer, metastasis to the left supraclavicular lymph node causes its enlargement, and it is known as Virchow's node. The Virchow's node is closely related to the thoracic duct at the site where it drains into the venous system, therefore its enlargement can mechanically obstruct the thoracic duct.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9d3b44a58bd343ddb52ebd15c84f1707.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f5767ed69d6e4ceebe0ab70ee5c0a11ex600x942.JPEG"
    ]
  },
  {
    "text": "Which among the following is not a cause of gradual painless defective vision?",
    "choices": [
      {
        "id": 1,
        "text": "Senile cataract"
      },
      {
        "id": 2,
        "text": "Corneal dystrophy"
      },
      {
        "id": 3,
        "text": "Refractive error"
      },
      {
        "id": 4,
        "text": "Methyl alcohol amblyopia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Methyl alcohol amblyopia</strong> causes<strong> sudden painless</strong> onset of defective vision. It is a toxic neuropathy of the optic nerve.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old patient comes to the OPD with a history significant for a mood disorder. Her moods can be charted as shown in the image given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cyclothymia"
      },
      {
        "id": 2,
        "text": "Dysthymia"
      },
      {
        "id": 3,
        "text": "Rapid cycling disorder"
      },
      {
        "id": 4,
        "text": "Hypomania"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The given image showing 3 episodes of depression and 2 episodes of mania <strong>within 1 year,</strong> points towards a diagnosis of <strong>rapid cycling bipolar disorder</strong>.&nbsp;</p>\n<p class=\"p1\">It is diagnosed when the patient has <strong>4 or more</strong> episodes of <strong>depression and/or mania or hypomania</strong> within <strong>one</strong>&nbsp;<strong>year</strong>. There must be less than 2 weeks of normalcy between the episodes or an immediate shift between the symptoms with no intervening normal mood.</p>\n<p>Risk factors:</p>\n<ul>\n<li>Female patients</li>\n<li>Hypothyroidism</li>\n<li>Alcoholism or substance abuse</li>\n<li>Antidepressants (if used without mood stabilizers)</li>\n<li>Cyclothymia</li>\n<li>Bipolar II disorder</li>\n</ul>\n<p>The <strong>drug of choice</strong> for rapid cycling disorder is <strong>valproate.&nbsp;</strong></p>\n<p>Note:&nbsp;If the phases of mania and depression <strong>alternate</strong> very rapidly in a matter of<strong> hours or days </strong>then&nbsp;the condition is known as <strong>ultra-rapid cycling disorder</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8f2413239943465999b55c608d0b0815.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following bacteria demonstrates tumbling type of motility at 25 \u00b0C, but is non-motile at 37 \u00b0C?",
    "choices": [
      {
        "id": 1,
        "text": "Listeria monocytogenes"
      },
      {
        "id": 2,
        "text": "Treponema pallidum"
      },
      {
        "id": 3,
        "text": "Clostridium tetani"
      },
      {
        "id": 4,
        "text": "Vibrio cholera"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><em><strong>Listeria monocytogenes</strong></em> demonstrates&nbsp;<strong>tumbling</strong> end-over-end motility at <strong>22&ndash;28 &deg;C</strong> but becomes non-motile at 37 &deg;C.&nbsp;</p>\n<p>Listeria monocytogenes is a gram-positive bacillus. These rods are facultatively intracellular and move&nbsp;from cell to cell using the host cell actin framework. It can grow&nbsp;at<strong>&nbsp;low refrigeration temperatures</strong>. They show tumbling motility at&nbsp;25&deg;C.&nbsp;But, at 37&deg;C, it is non-motile because the&nbsp;<strong>peritrichous</strong>&nbsp;<strong>flagella</strong>&nbsp;are produced by the bacillus optimally between 20&deg;C&nbsp;and 30&deg;C.</p>\n<p>The image below shows the tumbling motility of&nbsp;<em>L. monocytogenes.</em></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/463c39a05dd44991985fe914e7e222bex720x734.GIF"
    ]
  },
  {
    "text": "A 25-year-old woman with 16 weeks of gestation presents with cramping abdominal pain followed by the passage of fleshy mass per vaginum. The pain subsided following the expulsion. On examination, the uterus appeared smaller with the os closed and the bleeding had stopped. Ultrasound reveals an empty uterine cavity. This is a case of ____________ miscarriage.",
    "choices": [
      {
        "id": 1,
        "text": "Threatened"
      },
      {
        "id": 2,
        "text": "Complete"
      },
      {
        "id": 3,
        "text": "Inevitable"
      },
      {
        "id": 4,
        "text": "Missed"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical features are suggestive of <strong>complete miscarriage.</strong></p>\n<p>Expulsion of products of conception,<strong> en masse</strong>, is called a complete miscarriage.</p>\n<p>Features:</p>\n<ul>\n<li>Subsidence of abdominal pain</li>\n<li>Decreased or absent vaginal bleeding</li>\n<li>Uterus is smaller</li>\n<li>The cervical os is closed</li>\n<li>Examination of the expelled fleshy mass is found complete.</li>\n<li>USG - empty uterine cavity</li>\n</ul>\n<p>Abortion is the expulsion or extraction from the mother of an embryo or fetus weighing&nbsp;500 g or less when it is not capable of independent survival.</p>\n<p>Classification of abortion:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d01749d935b4409a791007540546e5ax1280x1480.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/854c2fcd5e714055ab0ca6b14640f88fx1280x6462.JPEG"
    ]
  },
  {
    "text": "The given emblem shows an organization related to which organism?",
    "choices": [
      {
        "id": 1,
        "text": "Mycobacterium tuberculosis"
      },
      {
        "id": 2,
        "text": "Mycobacterium leprae"
      },
      {
        "id": 3,
        "text": "Wuchereria bancrofti"
      },
      {
        "id": 4,
        "text": "Leishmania donovani"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image is the emblem of <strong>National Leprosy Eradication Programme (NLEP).&nbsp;</strong>Leprosy is&nbsp;caused by <em><strong>Mycobacterium leprae.</strong></em></p>\n<p><strong>Characteristics of NLEP emblem:</strong></p>\n<ul>\n<li>The <strong>lotus</strong> in the&nbsp;NLEP emblem<strong>&nbsp;</strong>symbolizes beauty and purity.</li>\n<li>A&nbsp;<strong>partially affected thumb,</strong>&nbsp;a&nbsp;<strong>normal forefinger,</strong>&nbsp;and the&nbsp;<strong>shape of a house </strong>symbolize that leprosy can be cured and that a patient with leprosy can be a useful member of society.</li>\n<li>The&nbsp;<strong>rising</strong>&nbsp;<strong>sun</strong> symbolizes hope and optimism.</li>\n<li>The emblem captures the spirit of hope and positivity in the eradication of leprosy.</li>\n</ul>\n<p>NLEP is a centrally sponsored health scheme of the Ministry of Health and Family Welfare, Govt. of India.</p>\n<p>Other options:</p>\n<p>Option A- Programme dealing with&nbsp;<strong><em>Mycobacterium tuberculosis</em></strong>, is&nbsp;<strong>National Tuberculosis Elimination Program</strong>&nbsp;(NTEP)</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ba5ff29862c44b43acd6ed8190605a64.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/af0419fa8df7413eaa2ff9f549fa1569x1280x1259.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ecd10ba1b8ef4b47bd4f6994ca1dc3e8x358x255.JPEG"
    ]
  },
  {
    "text": "A 56-year-old\u200b female patient presented with progressive dysphagia for solids, loss of weight, and loss of appetite. A barium swallow done is given below. Which of the following statements is false regarding this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Dysphagia is the most common earliest presenting symptom"
      },
      {
        "id": 2,
        "text": "The squamous cell variant usually affects the upper two-thirds and the adenocarcinoma variant usually affects the lower third"
      },
      {
        "id": 3,
        "text": "Common aetiological factors are tobacco and alcohol"
      },
      {
        "id": 4,
        "text": "The incidence of adenocarcinoma is increasing"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given barium study shows irregular narrowing, mucosal destruction, and shouldered margins which is suggestive of&nbsp;<strong>carcinoma esophagus.&nbsp;</strong>Dysphagia is the most common presenting symptom but is a <strong>late feature</strong> in&nbsp;carcinoma esophagus.</p>\n<p>Esophageal carcinoma is&nbsp;<strong>more commonly</strong>&nbsp;seen in&nbsp;<strong>men</strong>.&nbsp;<strong>Tobacco</strong>&nbsp;use and&nbsp;<strong>alcohol</strong>&nbsp;are&nbsp;<strong>strong risk factors</strong>.&nbsp;<strong>Adenocarcinoma</strong>&nbsp;and&nbsp;<strong>squamous cell carcinoma</strong>&nbsp;of the esophagus are the two&nbsp;<strong>most common</strong>&nbsp;types.&nbsp;The squamous cell variant usually affects the upper two-thirds and the adenocarcinoma variant usually affects the lower third.&nbsp;The incidence of adenocarcinoma is increasing.</p>\n<p><strong>Clinical features&nbsp;</strong>include:</p>\n<ul>\n<li>Dysphagia (most common)</li>\n<li>Regurgitation</li>\n<li>Vomiting</li>\n<li>Odynophagia</li>\n<li>Weight loss</li>\n</ul>\n<p>In the advanced stage, there can be hoarseness of voice due to recurrent laryngeal nerve palsy, horner&rsquo;s syndrome, chronic spinal pain, and diaphragmatic paralysis.</p>\n<p><strong>Flexible endoscopy with biopsy </strong>is preferred for<strong> confirmation </strong>of diagnosis<strong>.&nbsp;</strong>Other investigations include&nbsp;<strong>barium swallow</strong>,&nbsp;which shows a&nbsp;<strong>rat-tail appearance&nbsp;</strong>due to irregular narrowing or ulceration. Contrast-enhanced CT and PET can be used to assess distant metastasis.&nbsp;<strong>Endoscopic</strong>&nbsp;<strong>ultrasonography</strong>&nbsp;(<strong>EUS</strong>) is the investigation of choice to&nbsp;<strong>assess tumor invasion and lymph node metastasis.<br /></strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1123a97010154ee2844fbf84e00133e8.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the pathological basis for the given skin finding?",
    "choices": [
      {
        "id": 1,
        "text": "Lack of melanin"
      },
      {
        "id": 2,
        "text": "Loss of melanocytes"
      },
      {
        "id": 3,
        "text": "Loss of melanosomes"
      },
      {
        "id": 4,
        "text": "Melanocyte senescence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image is suggestive of <strong>vitiligo.</strong> The pathological basis of vitiligo is the <strong>loss of melanocytes.</strong></p>\n<p>Vitiligo is a common form of <strong>localized depigmentation</strong>.&nbsp;It is characterized by<strong> milky\u2010white sharply demarcated macules.&nbsp;</strong>It is an <strong>acquired</strong> condition resulting from the <strong>autoimmune destruction</strong> of dopa-positive <strong>melanocytes</strong> in the basal layer of the epidermis.</p>\n<p>Vitiligo can begin at any age but in the majority of cases becomes apparent in the third decade.&nbsp;The prevalence is most probably the same in both sexes or a slight female preponderance.</p>\n<p><strong>Electron microscopy</strong> studies confirm the loss of melanocytes.&nbsp;Wood's lamp examination shows<strong>&nbsp;milky-white fluorescence</strong>.</p>\n<p><strong>Koebner phenomenon&nbsp;</strong>defined as the development of lesions at sites of trauma to uninvolved skin of patients with cutaneous diseases is a well\u2010known phenomenon in vitiligo.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a21fd83de24f42fa8a6d77cbed16ae55.jpg"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/62cadc91564f4f71aab6c6a9da466034x1280x1054.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b2de6dbf7aae4ed5b2638d890761dbcax1280x1432.JPEG"
    ]
  },
  {
    "text": "Q.\u2002You are working as an intern in the ENT department. A child is brought to you with complaints of noisy breathing. On examination, you notice biphasic stridor in the child. Which of the following conditions can be ruled out in this child?",
    "choices": [
      {
        "id": 1,
        "text": "Vocal cord paralysis"
      },
      {
        "id": 2,
        "text": "Subglottic stenosis"
      },
      {
        "id": 3,
        "text": "Laryngeal papilloma"
      },
      {
        "id": 4,
        "text": "Laryngomalacia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Laryngomalacia</strong> causes<strong> inspiratory stridor</strong>. Hence, it is not considered as part of the differential diagnosis for biphasic stridor.</p>\n<p>Stridor is noisy respiration produced by turbulent airflow\u00a0through the narrowed air passages. It may be heard during\u00a0inspiration, expiration, or both.</p>\n<ul>\n<li><strong>Inspiratory stridor</strong> is often produced in obstructive lesions of supraglottis or pharynx, e.g. laryngomalacia or retropharyngeal abscess.</li>\n<li><strong>Biphasic stridor </strong>is seen in lesions of the glottis, subglottis, and cervical trachea, e.g. laryngeal papillomas, vocal cord paralysis, and subglottic stenosis.</li>\n<li><strong>Expiratory stridor</strong> is produced in lesions of thoracic trachea,\u00a0primary and secondary bronchi, e.g. bronchial\u00a0foreign body, and tracheal stenosis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74b4c98abb59427c8564c3236d75b224x1280x1826.JPEG"
    ]
  },
  {
    "text": "A 33-year old P3L3 woman complained of intermenstrual bleeding. On speculum examination, a polypoid lesion was visualized in the cervix, which was confirmed with the ultrasound shown below. What is the most appropriate management?",
    "choices": [
      {
        "id": 1,
        "text": "Wait and watch with serial sonograms"
      },
      {
        "id": 2,
        "text": "Removal with ring forceps"
      },
      {
        "id": 3,
        "text": "Oral contraceptive pills"
      },
      {
        "id": 4,
        "text": "Embolization of feeding vessel"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The above ultrasound image shows the presence of an <strong>endocervical polyp</strong>. The most appropriate treatment is <strong>avulsion using ring forceps</strong>.</p>\n<p class=\"p1\">Endocervical polyps are overgrowths of benign endocervical stroma covered by mucinous columnar epithelium. They appear as single, red, smooth elongated masses arising from the endocervical canal. Polyps range from a few millimeters to 2-3 cm in size and are more frequently seen in multiparas.</p>\n<p class=\"p1\">Endocervical polyps are usually <strong>asymptomatic</strong>, but also cause <strong>intermenstrual</strong> or <strong>postcoital</strong> bleeding or vaginal discharge. They are identified by inspection during a pelvic examination or&nbsp;during transvaginal sonography if they are located higher up.</p>\n<p class=\"p1\">They are typically <strong>benign</strong>. Premalignant or malignant transformation is rare. However, cervical cancer can also present as polypoid masses and can mimic these benign lesions.</p>\n<p class=\"p1\">Treatment:</p>\n<ul>\n<li class=\"p1\">Asymptomatic polyps usually don't need any intervention</li>\n<li class=\"p1\">Symptomatic:\n<ul>\n<li class=\"p1\"><strong>Removal with ring forceps</strong>: The polyp is twisted repeatedly about the base of its stalk to strangulate its feeding vessels. With a repeated twisting, the base will narrow and avulse.</li>\n<li class=\"p1\"><strong>Removal with punch biopsy forceps</strong> for smaller polyps</li>\n<li class=\"p1\"><strong>Electrosurgical excision or hysteroscopic removal</strong> for polyps with thick stalks</li>\n</ul>\n</li>\n</ul>\n<p>After the removal of polyps, the base can be cauterized to prevent bleeding and recurrence rate. Every excised polyp should be sent for further histological examination to rule out malignancy.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b73367762ab54ceba5cde9da294bc6bf.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A resident is examining a patient with bilateral leg swelling below the knees. He notes that on applying pressure, the indentation does not persist on release. What is the likely cause of the edema?",
    "choices": [
      {
        "id": 1,
        "text": "Myxedema"
      },
      {
        "id": 2,
        "text": "Nephrotic syndrome"
      },
      {
        "id": 3,
        "text": "Chronic lymphangitis"
      },
      {
        "id": 4,
        "text": "Acute lymphatic filariasis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Bilateral</strong>&nbsp;<strong>non-pitting</strong> edema in the lower limbs is suggestive of <strong>myxedema</strong>.</p>\n<p>Pretibial myxedema is a manifestation of <strong>Grave's disease</strong>. The triad of Grave's disease is <strong>orbitopathy</strong>, <strong>goiter,</strong> and <strong>pretibial</strong> <strong>myxedema.</strong></p>\n<p>This change is caused due to an increased <strong>glycosaminoglycan</strong> deposition in the skin giving it an edematous appearance. Despite this appearance, the skin does not pit with pressure.</p>\n<p>While chronic<strong> lymphangitis</strong> and acute lymphatic<strong> filariasis</strong> can also cause non-pitting edema, they usually have a <strong>unilateral</strong>/localized presentation.&nbsp;<strong>Nephrotic syndrome</strong> and heart failure cause&nbsp;<strong>bilateral pitting</strong> edema.</p>\n<p>Causes of <strong>generalized edema</strong> include:</p>\n<ul>\n<li>Heart failure</li>\n<li>Chronic renal failure</li>\n<li>Nephrotic syndrome</li>\n<li>Liver cirrhosis</li>\n</ul>\n<p>Causes of <strong>localized edema</strong> include:</p>\n<ul>\n<li>Thrombophlebitis</li>\n<li>Chronic lymphangitis</li>\n<li>Resection of regional lymph nodes</li>\n<li>Filariasis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presented with diarrhea, floating stools, and weight loss for 3 months. The biopsy of the intestine is shown below. His symptoms improved with folic acid intake. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Celiac disease"
      },
      {
        "id": 2,
        "text": "Whipple\u2019s disease"
      },
      {
        "id": 3,
        "text": "Tropical sprue"
      },
      {
        "id": 4,
        "text": "Short bowel syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical scenario with histopathology showing <strong>partial villous atrophy</strong> with <strong>inflammation of lamina propria,</strong> and<strong> improvement with folic acid intake</strong>&nbsp;suggest that the patient has <strong>tropical sprue.</strong></p>\n<p><strong>Tropical sprue</strong> is an acquired malabsorptive condition of probable <strong>infectious </strong>etiology. Patients present with <strong>diarrhea, steatorrhoea, weight loss</strong>, folic acid, and vitamin B12 <strong>deficiency.</strong> </p>\n<p>The small intestinal mucosal biopsy is <strong>diagnostic</strong> and reveals partial villous atrophy and mononuclear cell infiltration in the lamina propria.&nbsp;</p>\n<p>Broad-spectrum antibiotics such as <strong>tetracycline</strong> can be given for 6 months and <strong>folic acid</strong> is often curative. A gluten-free diet doesn't improve the condition.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Celiac disease</strong> is a <strong>gluten-sensitive enteropathy.</strong> Patients present with iron deficiency anaemia, weight loss, diarrhea, and malabsorption. Biopsy reveals blunting of villi, crypt hyperplasia, and inflammation propria. They respond to a gluten-free diet.</p>\n<p>The below image shows histopathological findings seen in celiac disease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8b5bea9fa75a450d89c60a80f08da83b.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/20ac1b3677294ec8a5789dfad8ee29a2x1280x853.6.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/86297e67cc454b109e8b0c9bafa8ecfbx1023x1534.JPEG"
    ]
  },
  {
    "text": "Which of the following is the defective DNA repair mechanism seen in patients with Severe Combined Immuno Deficiency (SCID)?",
    "choices": [
      {
        "id": 1,
        "text": "Non Homologous End Joining (NHEJ)"
      },
      {
        "id": 2,
        "text": "Homologous recombination"
      },
      {
        "id": 3,
        "text": "Nucleotide Excision repair"
      },
      {
        "id": 4,
        "text": "Mismatch repair"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>SCID is associated with a <strong>defective Non-Homologous End Joining (NHEJ). </strong></p>\n<p><strong>Non-homologous end-joining</strong>&nbsp;(NHEJ) is a mechanism by which a group of proteins mediates the recognition, processing, and direct ligation of the ends of two DNA fragments where a&nbsp;<strong>double-strand break</strong>&nbsp;in DNA has occurred. This is in contrast to&nbsp;<strong>homologous repair&nbsp;</strong>(HR), another mechanism,&nbsp;where an undamaged homologous DNA template is required to replace an adjacent damaged one.</p>\n<p>NHEJ deficiency confers combined immunodeficiency due to a failure to carry out recombination efficiently. NHEJ also functions in class switch recombination, another step enhancing T and B cell diversity.</p>\n<p><strong>Severe combined immunodeficiency (SCID)</strong></p>\n<ul>\n<li>Defects in&nbsp;<strong>both humoral</strong>&nbsp;and&nbsp;<strong>cell-mediated</strong>&nbsp;immune responses.</li>\n<li>Persons with SCID are extremely susceptible to recurrent, severe infections by a wide range of pathogens, including&nbsp;<strong>Candida albicans,&nbsp;Pneumocystis jirovecii,&nbsp;</strong>Pseudomonas&nbsp;species, cytomegalovirus, varicella,&nbsp;etc.</li>\n<li>The&nbsp;most common form&nbsp;is&nbsp;<strong>X-linked SCID</strong>, and hence, SCID is more<strong>&nbsp;common in boys</strong>&nbsp;than in girls. The genetic defect in the X-linked form is a&nbsp;mutation in the common &gamma;-chain (&gamma;c) subunit of cytokine receptors.</li>\n<li>The most common cause of <strong>autosomal-recessive</strong> SCID is a<strong>&nbsp;</strong>deficiency of<strong>&nbsp;the adenosine deaminase (ADA)</strong>&nbsp;enzyme.</li>\n<li>other gene mutations that can be seen in SCID are&nbsp;<strong>JAK3, RAG1,</strong>&nbsp;<strong>IL-7R,&nbsp;</strong>etc.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "eFAST is least helpful in diagnosing which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Pericardial Effusion"
      },
      {
        "id": 2,
        "text": "Pneumothorax"
      },
      {
        "id": 3,
        "text": "Retroperitoneal hematoma"
      },
      {
        "id": 4,
        "text": "Renal injury"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Among the given options, FAST&nbsp;(<strong>focussed assessment with sonography in trauma</strong>) is <strong>least</strong> useful in diagnosing&nbsp;<strong>retroperitoneal hematoma </strong>as&nbsp;the sensitivity of ultrasound for the detection of retroperitoneal hematomas is extremely poor.&nbsp;</p>\n<p><strong>Computed Tomography(CT Scan)</strong> is the <strong>investigation of choice for retroperitoneal injury</strong>, but it can <strong>only be done in a hemodynamically stable patient.</strong></p>\n<p>FAST is a rapid, non-invasive bedside test for detecting free fluid in the abdomen using sonography used to assess patients for potential thoracoabdominal injuries.&nbsp;</p>\n<p><strong>Technique:</strong></p>\n<ul>\n<li>The patient is placed in a <strong>supine</strong> position</li>\n<li>With a 3.5-5.0 MHz convex&nbsp;transducer the following&nbsp;regions are scanned :\n<ul>\n<li><strong>Subxiphoid</strong> transverse view: assess for pericardial effusion and left lobe liver injuries</li>\n<li>Longitudinal view of the <strong>right upper quadrant</strong>: assess for right liver injuries, right kidney injury, and Morison pouch</li>\n<li>Longitudinal view of the <strong>left upper quadrant</strong>: assess for splenic injury and left kidney injury</li>\n<li>Transverse and longitudinal views of the <strong>suprapubic region</strong>: assess the bladder and pouch of Douglas</li>\n</ul>\n</li>\n</ul>\n<p><strong>e</strong>FAST stands for <strong>extended</strong> FAST and incorporates Left and right <strong>thoracic views</strong> to assess for pneumothorax and haemothorax.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 039';
        const quizFilename = 'fmge-mini-test-039-4c62e45c.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>