<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fever Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A patient hailing from an area infested with mosquitoes presents with fever, chills, and myalgias. WBC count was 4000 cells/cu.mm, RBC was normal, and platelets were 90000 cells/cu.mm. He also had a maculopapular rash. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Dengue"
      },
      {
        "id": 2,
        "text": "Typhoid"
      },
      {
        "id": 3,
        "text": "Ebola haemorrhagic fever"
      },
      {
        "id": 4,
        "text": "Rift valley fever"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario with a patient hailing from a <strong>mosquito-infested</strong> area with fever and <strong>decreased platelet</strong> counts is diagnostic of<strong>\u00a0dengue</strong>.\u00a0</p>\n<p>Symptoms of severe dengue are headache, myalgias, retroorbital pain<strong>,</strong> end-organ\u00a0damage, pleural &amp; ascitic effusions and <strong>thrombocytopenia</strong> (&lt;100,000/ uL). Complications include mild hepatic injury, seizures, arrythmias and acute kidney injury.</p>\n<p>Diagnosis is made by <strong>NS1 antigen detection</strong> and <strong>IgM antibody assays</strong>. Treatment includes <strong>crystalloid infusion</strong> in mild cases and colloid infusion in severe cases, oxygen administration and close monitoring.</p>\n<p>Dengue is classified into <strong>dengue with or without warning signs</strong> and <strong>severe dengue</strong>. Dengue is to be suspected when a <strong>high fever</strong> (40\u00b0C/104\u00b0F) is accompanied by <strong>any two</strong> of the following symptoms during the febrile phase (2-7 days) which include severe headache, retro-orbital pain, arthralgia or myalgia, nausea, vomiting and maculopapular rash.</p>\n<p>Warning signs in dengue are:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">severe abdominal pain</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">persistent vomiting</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">tachypnea</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">bleeding gums or nose\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">fatigue</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">restlessness</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">hepatomegaly</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">malena or hematemesis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Anuj, a school-going kid has been brought to the pediatric OPD by his mother with complaints of fever for 3 weeks. She says her son has been skipping school because of the fever but in the evening he gets better and plays with his siblings. She also noticed a rash that appears along with fever and disappears spontaneously. He has a history of joint pain on and off since pre-school. On examination, generalized lymphadenopathy and hepatosplenomegaly are noted along with an evanescent erythematous rash on the trunk. Which of the following characteristically defines the fever associated with this child's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Quartan fever"
      },
      {
        "id": 2,
        "text": "Tertian fever"
      },
      {
        "id": 3,
        "text": "Quotidian fever"
      },
      {
        "id": 4,
        "text": "Continuous fever"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient has clinical features of <strong>systemic juvenile idiopathic arthritis (sJIA)</strong>, which is associated with&nbsp;quotidian fever.<strong> Q</strong><strong>uotidian fever </strong>-<strong>&nbsp;</strong>fever that rises to 39&deg;C (102.2&deg;F) once a day and returns to 37&deg;C (98.6&deg;F) between fever peaks</p>\n<p>Systemic JIA is characterized by a&nbsp;<strong>fever</strong>&nbsp;of at least 2 weeks and Arthritis in 1 or more joints + at least one of&nbsp;</p>\n<ol>\n<li>Evanescent erythematous rash that is non-pruritic and migratory with lesions lasting&lt;1 hr.</li>\n<li>Prominent visceral involvement, including hepatosplenomegaly</li>\n<li>Generalized lymphadenopathy</li>\n<li>Serositis</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions is a patient with fever unlikely to have clubbing?",
    "choices": [
      {
        "id": 1,
        "text": "Infective endocarditis"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Rheumatic fever"
      },
      {
        "id": 4,
        "text": "Bronchiectasis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Rheumatic fever is associated with fever but not clubbing while all the other conditions listed are known to be associated with clubbing.</p>\n<p><strong>Clubbing</strong> is a clinical finding characterized by <strong>selective bulbous enlargemen</strong>t of the <strong>distal segments</strong> of the <strong>fingers </strong>and <strong>toes</strong>. It occurs due to the <strong>proliferation of connective tissue</strong>, especially on the dorsal surface.</p>\n<p>Causes of clubbing:</p>\n<ul>\n<li>Pulmonary\n<ul>\n<li>Bronchogenic carcinoma</li>\n<li>Mesothelioma, asbestosis</li>\n<li>Lung abscess, empyema, <strong>bronchiectasis</strong></li>\n<li><strong>Tuberculosis</strong></li>\n<li>Cystic fibrosis</li>\n<li>Sarcoidosis</li>\n</ul>\n</li>\n<li>Gastrointestinal<br />\n<ul>\n<li>Inflammatory bowel disease - ulcerative colitis, Crohn's disease</li>\n<li>Sprue, celiac disease</li>\n<li>Gastric and colonic carcinoma</li>\n<li>Cirrhosis</li>\n<li>Chronic active hepatitis</li>\n</ul>\n</li>\n<li>Cardiovascular<br />\n<ul>\n<li>Cyanotic congenital heart disease</li>\n<li><strong>Infective endocarditis</strong></li>\n<li>Patent ductus arteriosus (causes differential clubbing)</li>\n<li>Aortic aneurysm\u00a0</li>\n<li>Arteriovenous malformations</li>\n<li>Atrial myxoma</li>\n<li>Endocrine</li>\n<li>Hyperthyroidism - Grave\u2019s disease</li>\n</ul>\n</li>\n<li>Neurological<br />\n<ul>\n<li>Hemiplegia (unilateral clubbing)</li>\n</ul>\n</li>\n<li>Hypertrophic osteoarthropathy is an associated feature in clubbing seen due to primary or metastatic lung disease, mesothelioma, bronchiectasis, and hepatic cirrhosis. It can be diagnosed using a bone radiograph or MRI.</li>\n</ul>\n<p><strong>Clinical methods</strong> to elicit clubbing:</p>\n<p><strong>Schamroth sign</strong>: This sign is elicited by placing the dorsal surfaces of terminal phalanges of corresponding right and left fingers together.<strong> Normal </strong>fingers create a <strong>diamond-shaped window</strong>, whereas in <strong>clubbed </strong>fingers, this diamond-shaped window is <strong>obliterated</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5562dbffddc541a4a95500e19a5b5840x600x1183.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e9961f1f363148cea7474e56f66173d7x600x861.JPEG"
    ]
  },
  {
    "text": "A 5 year old girl has 3 month history of joint pain and morning stiffness,  with swelling of knees and ankles. She also has eye pain and photophobia. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rheumatic fever"
      },
      {
        "id": 2,
        "text": "Juvenile idiopathic arthritis"
      },
      {
        "id": 3,
        "text": "Behcet syndrome"
      },
      {
        "id": 4,
        "text": "Chikungunya fever"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This given scenario is that of Juvenile idiopathic arthritis (JIA).</p>\n<p>It fulfills the criteria for JIA,which is -</p>\n<ul>\n<li>Age of onset: &lt;16 yr</li>\n<li>Duration of disease: At least more than or equal to 6 weeks</li>\n<li>Arthritis in at least 1 joint</li>\n<li>Exclusion of other forms of juvenile arthritis.</li>\n</ul>\n<p>JIA is an autoimmune disease that is associated with both humoral and cell mediated immunity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions may Faget's sign be noted?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 5"
      },
      {
        "id": 2,
        "text": "2, 4, 5"
      },
      {
        "id": 3,
        "text": "2, 3, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 2, 3, 4, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Relative bradycardia/Faget\u2019s sign</strong> is seen when patients have a <strong>lower heart rate than might be expected for a given body temperature.</strong></p>\n<p>It can be seen in all of the above conditions.</p>\n<p>The body temperature is often considered an independent determinant of heart rate. It is estimated that for <strong>every centigrade rise</strong> in temperature, the heart rate increases approximately by\u00a0<strong>10 bpm</strong>.</p>\n<p>Infectious organism causing relative bradycardia include:\u00a0</p>\n<ul>\n<li><strong>Salmonella typhi (typhoid/enteric fever)</strong></li>\n<li>Francisella tularensis</li>\n<li><strong>Brucella spp.</strong></li>\n<li>Coxiella burnetii (Q fever)</li>\n<li><strong>Leptospira interrogans (leptospirosis)</strong></li>\n<li>Legionella pneumophila</li>\n<li>Rickettsia spp.</li>\n<li>Orientia tsutsugamushi (scrub typhus)</li>\n<li>Corynebacterium diphtheriae</li>\n<li><strong>Plasmodium spp. (malaria)</strong></li>\n</ul>\n<p>Viruses/viral infections:</p>\n<ul>\n<li>Yellow fever virus</li>\n<li><strong>Dengue virus </strong></li>\n<li>Viral hemorrhagic fevers - Early in course of Marburg and Ebola</li>\n<li>Viral myocarditis</li>\n</ul>\n<p>Noninfectious causes include:</p>\n<ul>\n<li>Drug fever\u2028</li>\n<li>Beta-blocker use\u2028</li>\n<li>Central nervous system lesions</li>\n<li>Malignant lymphoma</li>\n<li>Factitious fever</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 27 year old P1L1 in the post-natal ward who delivered three days prior, has a temperature of 39\u00b0C on two occasions 24 hours apart. Which of the following points in her history would identify the most important risk factor for her fever?",
    "choices": [
      {
        "id": 1,
        "text": "Breastfeeding"
      },
      {
        "id": 2,
        "text": "Gestational age at delivery"
      },
      {
        "id": 3,
        "text": "Route of delivery"
      },
      {
        "id": 4,
        "text": "Immunisation status"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario is suggestive of <strong>puerperal fever</strong>. The <strong>route of delivery</strong>, i.e., whether vaginal or caeserean, is the <strong>single biggest risk factor</strong> for development of <strong>genital tract infection</strong>, which is the <strong>most common cause of puerperal fever.</strong></p>\n<p><strong>Puerperal fever</strong> is defined as a <strong>temperature of &gt;38\u00b0C</strong> recorded on <strong>2 separate occasions 24 hours apart</strong> within the <strong>first 10 days following delivery</strong>. The most common cause of puerperal fever is genital tract infection. Women who have delivered by <strong>caesarean section </strong>carry a significantly <strong>higher risk of developing infection</strong> as compared to those who have a normal vaginal delivery. Infection of the genital tract has also been termed<strong> puerperal sepsis </strong>and includes <strong>endometritis, endo-myometritis, </strong>and<strong> endo-parametritis, </strong>and a combination of all is called <strong>pelvic cellulitis</strong>. However, <strong>routine use of antibiotic prophylaxis </strong>has now reduced the incidence of puerperal fever following caesarean delivery.</p>\n<p><strong>The </strong>period following childbirth, from the time of the <strong>delivery of the placenta</strong>, is called <strong>puerperium</strong>. It is further subdivided into <strong>immediate</strong> - first 24 hours, <strong>early </strong>- first 7 days, and <strong>remote</strong> - 7 days to 6 weeks.</p>\n<p>A number of <strong>physiological changes</strong> take place during the puerperal period which include the<strong> involution of the uterus</strong>, discharge of<strong> lochia</strong> and onset of <strong>lactation.</strong> The presence of <strong>fever on the 3rd day</strong> after delivery which lasts for <strong>24 hours</strong> may occur due to <strong>breast engorgement</strong> is known as <strong>breast fever</strong>, which is<strong> self-limiting.</strong></p>\n<p>Other causes of puerperal fever include:</p>\n<ul>\n<li>urinary tract infection</li>\n<li>breast infection (abscess/mastitis)</li>\n<li>pelvic infection including septic pelvic thrombophlebitis</li>\n<li>respiratory infections</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following patients with fever, would a detailed family history lead directly to the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "32-year-old female who is febrile after receiving a blood transfusion"
      },
      {
        "id": 2,
        "text": "43-year-old male with periodic fever and recently diagnosed amyloidosis"
      },
      {
        "id": 3,
        "text": "23-year-old female with fever and eosinophilia and lymphadenopathy"
      },
      {
        "id": 4,
        "text": "18-year-old male with fever, joint pains and elevated CRP"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A <strong>positive family history</strong> of similar complaints in other individuals in the family of a patient with <strong>recurrent fever</strong> associated with the later diagnosis of <strong>amyloidosis </strong>would favor the diagnosis of <strong>Familial Mediterranean Fever (FMF).</strong></p>\n<p><strong>Familial Mediterranean Fever (FMF)\u00a0</strong>is an <strong>autosomal recessive</strong> inherited <strong>auto-inflammatory</strong> condition that occurs due to a defect in the <strong>FMF gene</strong> that encodes the protein <strong>pyrin.\u00a0</strong>It was first recognised in the population living close to the Mediterranean Sea, hence the name, but has also been identified in other regions. Pyrin activity leads to <strong>inflammasome activation</strong> that results in signs of <strong>acute attacks of inflammation</strong> in the patient such as <strong>recurrent fever, arthritis, peritonitis and pleuritis</strong>, with attacks lasting between 24-72 hours. Factors like exercise, emotional stress and pregnancy may act as triggers for the attacks.</p>\n<p><strong>AA Amyloidosis</strong> is a <strong>known common complication of FMF</strong>, especially in patients with a homozygous genotype. Patients are treated with <strong>daily oral colchicine </strong>which <strong>prevents attacks</strong> and also reduces the risk of developing systemic amyloidosis.</p>\n<p>Other options:</p>\n<p>Option A: A patient with a<strong> febrile reaction to a blood transfusion</strong> may have a positive family history of <strong>immune-mediated diseases</strong> (eg. IgA deficiency) but a family history alone would be insufficient to form a diagnosis before ruling out several other possibilities. A detailed<strong> past history </strong>of similar occurrences or haematological diseases would be more relevant in such a patient.</p>\n<p>Option C: A patient with <strong>fever, eosinophilia and lymphadenopathy </strong>should rather have a detailed<strong> medication history</strong> to rule out <strong>drug-induced fevers </strong>like<strong> DRESS syndrome</strong> and<strong> travel history</strong> to rule out<strong> parasitic infections</strong>.</p>\n<p>Option D: A young male with <strong>fever, joint pains and elevated CRP</strong> should raise the differential of <strong>rheumatic fever</strong> which could be elicited with a past history of recent sore throat. The patient should also be evaluated for <strong>systemic autoimmune illnesses</strong> (eg. <strong>Still's disease</strong>).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the typical sequence of events that take place to result in fever?",
    "choices": [
      {
        "id": 1,
        "text": "1-2-3-4-5"
      },
      {
        "id": 2,
        "text": "3-2-1-4-5"
      },
      {
        "id": 3,
        "text": "5-4-3-2-1"
      },
      {
        "id": 4,
        "text": "5-2-3-4-1"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Fever</strong> occurs due to an <strong>elevation in the hypothalamic set-point</strong> which acts as the thermoregulator of the body.</p>\n<p>In the setting of an infectious cause, <strong>pyrogens</strong> are released by the causative organism in the form of toxins or due to the activation of pyroegenic cytokines due to the presence of a foreign organism.</p>\n<p>\u2193</p>\n<p>This causes the synthesis of<strong> PGE2</strong>, whose levels are <strong>elevated</strong> in the<strong> organum vasculosum</strong> - a <strong>network of capillaries</strong> surrounding the hypothalamic regulatory centres: the <strong>preoptic anterior</strong> hypothalamus and the <strong>posterior </strong>hypothalamus.</p>\n<p>\u2193</p>\n<p>Increased PGE2 triggers the <strong>EP3 prostaglandin receptors</strong> in the glial cells of the brain</p>\n<p>\u2193</p>\n<p>release of <strong>cAMP</strong> from glial cells\u00a0</p>\n<p>\u2193</p>\n<p>\u00a0elevation of <strong>hypothalamic set-point </strong></p>\n<p>\u2193</p>\n<p><strong>Fever</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is unlikely in a patient presenting with complaints of fever and night sweats?",
    "choices": [
      {
        "id": 1,
        "text": "UTI"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Lymphoma"
      },
      {
        "id": 4,
        "text": "Menopause"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Fever with night sweats is unlikely in a patient with a urinary tract infection(UTI).</p>\n<p><strong>Fever with night sweats</strong> is a common presentation in <strong>chronic conditions</strong> rather than acute conditions.<strong> UTI </strong>generally has an <strong>acute </strong>presentation with patients complaining of <strong>high-grade fever</strong> associated with <strong>voiding symptoms</strong> such as <strong>burning micturition, haematuria</strong>, and other renal symptoms such as <strong>flank pain </strong>or <strong>abdominal pain</strong>.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Evening rise of temperature</strong> and <strong>night sweats</strong> is a common presentation in<strong> tuberculosis.\u00a0</strong>This is believed to be due to the diurnal variation in cortisol secretion which is reduced in the evening.</p>\n<p>Option C: Night sweats is one of the <strong>'B' symptoms</strong> associated with<strong> lymphomas.</strong></p>\n<p>Option D: Peri- and post-menopausal women typically complain of<strong> hot-flashes </strong>and <strong>night sweats.</strong></p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following patterns of fever is characteristic of Hodgkin's lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "Temperature remains elevated above normal, without touching the baseline, and the degree of fluctuation is <0.6 \u00b0C"
      },
      {
        "id": 2,
        "text": "Fever lasts for 3\u201310 days, followed by an afebrile period of 3\u201310 days"
      },
      {
        "id": 3,
        "text": "Temperature remains elevated above normal, without touching the baseline, and the degree of fluctuation is >0.6 \u00b0C"
      },
      {
        "id": 4,
        "text": "Acute fever followed by a remission lasting for 1\u20132 days; then, the fever reappears and lasts for 1-2 days"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Hodgkin's lymphoma and other lymphomas</strong> are typically associated with <strong>Pel-Ebstein fever, </strong>where the patient has\u00a0<strong>fever lasting for 3\u201310 days, followed by an afebrile period of 3\u201310 days.\u00a0</strong></p>\n<p>Other specific patterns of fever include:</p>\n<p><strong>Continuous fever </strong>is characterized by the temperature remaining elevated, <strong>without touching the baseline</strong>, and the<strong> fluctuation not exceeding 0.6\u00b0C</strong>. This type of fever is seen in cases of <strong>lobar pneumonia, infective endocarditis, enteric fever</strong>, etc. (Option A)</p>\n<p><strong>Remittent fever</strong> is characterized by temperature<strong> fluctuations exceeding 0.6\u00b0C</strong>, but <strong>without touching the baseline</strong>. (Option C)</p>\n<p><strong>Relapsing fever </strong>is characterized by several days of fever, followed by several days of an afebrile period, after which the cycle repeats (e.g. <strong>Borrelia</strong>, <strong>Leptospirosis</strong>)</p>\n<p><strong>Tertian fever</strong>\u00a0occurs on the <strong>first and third days</strong>. (e.g. infection with\u00a0Plasmodium <strong>vivax</strong>,\u00a0Plasmodium <strong>ovale</strong>, and\u00a0Plasmodium <strong>falciparum</strong>)</p>\n<p><strong>Quartan fever\u00a0</strong>occurs on the <strong>first and fourth days</strong>. (e.g. Plasmodium<strong> malariae </strong>infection)</p>\n<p><strong>Saddleback fever </strong>characterized by acute fever followed by a remission lasting for 1\u20132 days; then fever reappears and lasts for 1-2 days. This type of fever is typicall seen in <strong>dengue.</strong> (Option D)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient started on anticonvulsants 6 weeks ago presenting with a temperature of 38\u00b0C and a generalised rash is suspected to have a drug-induced fever. Which of the following drugs is unlikely to have caused this?",
    "choices": [
      {
        "id": 1,
        "text": "Carbamazepine"
      },
      {
        "id": 2,
        "text": "Lamotrigine"
      },
      {
        "id": 3,
        "text": "Levetiracetam"
      },
      {
        "id": 4,
        "text": "Phenytoin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Drug-induced fever,\u00a0</strong>is unlikely to be caused by levetiracetam.</p>\n<p>The other options mentioned, i.e., <strong>carbamazepine, lamotrigine </strong>and <strong>phenytoin</strong> are all <strong>aromatic anticonvulsants</strong> which are known to be associated with adverse events like <strong>drug-fever </strong>and <strong>DRESS syndrome</strong>. Levetiracetam is a non-aromatic anticonvulsant.</p>\n<p>Drugs are common causes of fever either due to side effects of the drug itself or due to an immune reaction to the drug. Drug-fever is also a differential in patients with fever of unknown origin and is to be ruled out before performing advanced investigations.</p>\n<p>DRESS stands for <strong>D</strong>rug <strong>R</strong>ash with <strong>E</strong>osinophilia and <strong>S</strong>ystemic <strong>S</strong>ymptoms. Patients present with a <strong>fever and generalised rash,</strong> but since in some cases there is no eosinophilia, the term <strong>Drug Induced Hypersensitivity Syndrome (DIHS)</strong> may be preferred. Commonly implicated medications include:</p>\n<ul>\n<li>Antiepileptics \u2013 carbamazepine, phenytoin, lamotrigine</li>\n<li>Antibiotics \u2013 vancomycin, amoxicillin, minocycline, piperacillin-tazobactam</li>\n<li>Sulpha drugs \u2013 sulphasalazine, dapsone, sulphadiazine</li>\n<li>Furosemide</li>\n<li>Omeprazole</li>\n<li>Ibuprofen\u00a0</li>\n</ul>\n<p>Patients with DRESS will recover fully, following <strong>withdrawal of the culprit drug</strong> and <strong>supportive management </strong>of the acute episode.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions is antipyretics not indicated?",
    "choices": [
      {
        "id": 1,
        "text": "Heat stroke"
      },
      {
        "id": 2,
        "text": "Febrile seizures"
      },
      {
        "id": 3,
        "text": "Hyperpyrexia"
      },
      {
        "id": 4,
        "text": "Viral fever"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Antipyretics</strong> are <strong>not indicated </strong>in the management of <strong>heat stroke </strong>or other <strong>environmentally induced hyperthermic states</strong> as antipyretics act at the hypothalamic thermoregulatory level. They may also exacerbate the complications (acute kidney injury, hepatic failure, DIC).</p>\n<p>Heat stroke is of 2 types:</p>\n<ul>\n<li><strong>Exertion-induced</strong>\u00a0<strong>heat stroke</strong> (EHS) is\u00a0seen in young, previously healthy people. It most commonly occurs in athletes, labourers, and military recruits working hard in a hot environment.</li>\n<li><strong>Sedentary/Classic/Epidemic heatstroke </strong>(CHS) is seen in elderly or infirm people during heat waves as their cardiovascular systems are\u00a0<strong>unable to adapt</strong>\u00a0to the stress of a hot environment to release sufficient heat. These patients are often compliant with prescribed medications that can impair tolerance to heat stress.</li>\n</ul>\n<p>Patients usually present with a sudden <strong>collapse.\u00a0</strong>The skin is <strong>dry, flushed,\u00a0</strong>and\u00a0<strong>hot. Sweating </strong>is <strong>absent</strong> in<strong> CHS\u00a0</strong>but<strong> present</strong> in about<strong> 50% of cases </strong>of <strong>EHS.\u00a0</strong>CNS dysfunction signs include\u00a0<strong>delirium</strong>, coma, and convulsions. Other complications include <strong>rhabdomyolysis</strong>, <strong>disseminated intravascular coagulation</strong> (DIC), and <strong>multiorgan failure.</strong></p>\n<p>The key points in the management of heat stroke includes:</p>\n<ul>\n<li><strong>Rapid cooling</strong>: this could be by <strong>s</strong><strong>praying</strong> the patient with <strong>cold water at 15\u00b0C; i</strong><strong>mmersion cooling</strong> in ice-cold water, <strong>cold thoracic </strong>and<strong> peritoneal lavage, </strong>and use of <strong>chilled intravenous fluids</strong> and\u00a0<strong>cooling blankets</strong> are less effective.</li>\n<li><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Continuous temperature monitoring</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> with a </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">rectal thermistor\u00a0</strong></li>\n<li><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Fluid</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> and <strong>electrolyte </strong>resuscitation</span></li>\n<li>Diagnosis and treatment of <strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">complications\u00a0</strong>like\u00a0<strong>rhabdomyolysis\u00a0</strong>and\u00a0<strong>myocardial injury.</strong></li>\n</ul>\n<p>Other Options:</p>\n<p>Option B: Although antipyretics have no role in controlling the convulsions in a child with febrile seizures, they are indicated in to control the fever in the child.</p>\n<p>Option C: Antipyretics are indicated in the management of hyperpyrexia seen in CNS haemorrhage or trauma to reduce the core body temperature and prevent the effects of hypothermia on the brain.</p>\n<p>Option D: Antipyretics do not treat viral infections but are indicated for symptomatic relief of fever and the associated myalgias and arthralgias that also occur due to peripheral prostaglandins.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "'Picket-fence' fever is typically associated with?",
    "choices": [
      {
        "id": 1,
        "text": "Cystitis"
      },
      {
        "id": 2,
        "text": "Pyelonephritis"
      },
      {
        "id": 3,
        "text": "Prostatitis"
      },
      {
        "id": 4,
        "text": "Catheter-associated UTI"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Picket-fence fever</strong> is associated with <strong>pyelonephritis</strong>.</p>\n<p><strong>Pyelonephritis </strong>refers to symptomatic infection of the\u00a0<strong>renal parenchyma</strong> and patients with a <strong>classic triad </strong>of <strong>loin pain, fever</strong> and<strong> costovertebral angle tenderness</strong>. The fever is typically described as <strong>picket-fence fever</strong> which is characterized by <strong>high-spiking fever with minimal variation</strong> that <strong>resolves over 72 hours of therapy.</strong></p>\n<p><strong>Uncomplicated and complicated UTI</strong> can clinically be well-distinguished by the<strong> presence of fever</strong> in the latter. <strong>Uncomplicated UTI</strong> is usually <strong>confined to the bladder</strong> and lacks systemic symptoms.<strong>\u00a0\u00a0</strong>Patients with <strong>cystitis </strong>(option A) present with voiding symptoms such as <strong>dysuria, urgency, supra-pubic pain</strong> and<strong> hematuria </strong>but f<strong>ever is not a common symptom.</strong></p>\n<p><strong>Fever</strong> suggests<strong> complicated UTI </strong>where the <strong>infection </strong>may have spread <strong>beyond the bladder</strong>. Patients with <strong>prostatitis </strong>(option C) may have fever but the more classical presentation involves dysuria and frequency associated with <strong>pelvic or perineal pain.\u00a0</strong>Catheter-associated UTI (option D) or UTI due to the presence of some foreign body (stones, stents etc) also cause complicated UTI and may have a <strong>more prolonged pattern of fever</strong> with a delayed response to therapy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old female patient in an old-age home is being evaluated for fever. Which of the following sites would provide the most accurate temperature recording in the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Oral cavity"
      },
      {
        "id": 2,
        "text": "Rectum"
      },
      {
        "id": 3,
        "text": "Axilla"
      },
      {
        "id": 4,
        "text": "Tympanic membrane"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Rectal </strong>temperature would provide the <strong>most accurate</strong> temperature recording in this patient.</p>\n<p>Although <strong>oral, axillary</strong> and <strong>tympanic </strong>membrane temperature recording may be <strong>more convenient</strong>, they are <strong>less accurate</strong> than rectal temperature, which has been documented to detect fever in elderly patients with more sensitivity and specificity.</p>\n<p>The<strong> rectal temperature</strong> is about <strong>0.4\u00b0C (0.7\u00b0F)higher than oral </strong>temperatures, which may be lower to mouth breathing and rapid or shallow breathing. Eardrum reflectance thermometers are now commonly used for geriatric patients but yield variable recordings. Axillary temperature recording is confounded by factors like sweat, skin thickness etc and hence is not accurate.</p>\n<p>Lower esophageal and pulmonary artery temperatures are most reflective of core body temperature but require invasive methods and hence are not applicable to the out-patient setting.\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman presents with a high fever, vomiting, and one episode of seizures. She appears confused. She is a known case of Graves' disease with medication non-compliance.  For the past few days, she has been feeling feverish and had a cough. On examination, she has warm, moist skin, and tremors. The cardiac monitor shows some arrhythmias. Which of the following is not part of the treatment?",
    "choices": [
      {
        "id": 1,
        "text": "Liothyronine"
      },
      {
        "id": 2,
        "text": "Lugol's iodine"
      },
      {
        "id": 3,
        "text": "Propranolol"
      },
      {
        "id": 4,
        "text": "Digoxin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient who has Graves' disease and an acute infection, now presents with high-grade fever, vomiting, one episode of seizure, and confusion. This is suggestive of a&nbsp;<strong>thyroid storm</strong> or thyrotoxic crisis. Management will not include&nbsp;<strong>Liothyronine. </strong>The patient is already in a state of thyrotoxicosis, in such cases, the addition of the most active form of thyroid hormone will be detrimental.</p>\n<p>L3/ Liothyronine has a rapid onset of action and is indicated only in conditions where rapid action is preferred like rare cases of&nbsp;<strong>myxedema coma</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The image below shows changes in body temperature (red line) in response to the changes in the set point of the hypothalamic temperature controller (dotted blue line). At which point does the patient experience chills?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The patient experiences chills at <strong>point 1</strong> in the above image.</p>\n<p>When the\u00a0<strong>hypothalamic set point is raised suddenly,</strong> the actual body temperature is still at the normal level. The body tries to conserve heat and causes\u00a0<strong>vasoconstriction and the patient feels cold.</strong>\u00a0Then, the patient experiences <strong>chill</strong>\u00a0and <strong>shivering</strong> until the actual body temperature reaches the setpoint.</p>\n<p>Once the body temperature reaches the setpoint, the patient feels<strong> neither cold nor hot.</strong></p>\n<p>When factors such as toxins that caused the setpoint to rise are removed from the blood, the setpoint suddenly falls. This point is called <strong>a crisis</strong> or <strong>flush</strong>. At this point, the actual body temperature is still at a higher level. As a result, the patient feels <strong>hot</strong>, and there is <strong>vasodilation</strong>. The body loses heat by intense <strong>sweating</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/181044e5063e4d0fae211160c35234e6.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/568708f3780d497e926ce1262633f95dx1280x1499.JPEG"
    ]
  },
  {
    "text": "A farmer was diagnosed with brucellosis. Which of the following patterns of fever will be seen in this disease?",
    "choices": [
      {
        "id": 1,
        "text": "Pel-Ebstein fever"
      },
      {
        "id": 2,
        "text": "Undulant fever"
      },
      {
        "id": 3,
        "text": "Relapsing fever"
      },
      {
        "id": 4,
        "text": "Saddleback fever"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Brucellosis</strong>\u00a0is a bacterial zoonosis caused by<strong>\u00a0</strong><em>Brucella sp</em>\u00a0which presents with <strong>undulant fever</strong>. It is referred to as undulant fever because of the <strong>rising</strong> and <strong>falling </strong>of fever like a wave\u00a0<strong>(remittent</strong> fever).\u00a0Patients may also have\u00a0arthralgia, muscular pain,\u00a0sweating, loss of weight, and appetite. CNS symptoms such as fatigue, irritability, and depression might also occur.\u00a0</p>\n<p>Other options</p>\n<p>Option A: <strong>Pel-Ebstein</strong> fever is seen in <strong>Hodgkin's lymphoma</strong>. It is characterized by\u00a0fever lasting 3\u201310 days\u00a0followed by afebrile periods of 3\u201310 days.</p>\n<p>Option C: <strong>Relapsing</strong>\u00a0fever is seen in infection with <em><strong>Borrelia recurrentis</strong>\u00a0</em>in which\u00a0days of fever are followed by a several-day afebrile period and then relapse into additional days of fever. A similar picture is also seen in malaria.</p>\n<p>Option D: <strong>Saddleback</strong> fever is seen in <strong>dengue</strong>.\u00a0\u00a0Saddleback fever is defined as\u00a0temperature &gt;37.5\u00b0C\u00a0 with defervescence of at least one day, followed by a second peak lasting at least one day.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A confirmed case of which of the following viral haemorrhagic fevers was found in India?",
    "choices": [
      {
        "id": 1,
        "text": "Ebola hemorrhagic fever"
      },
      {
        "id": 2,
        "text": "Yellow fever"
      },
      {
        "id": 3,
        "text": "Crimean congo hemorrhagic fever"
      },
      {
        "id": 4,
        "text": "Marburg hemorrhagic fever"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Crimean Congo hemorrhagic fever </strong>has been found in <strong>India. </strong></p>\n<p>Four cases were first described in India in <strong>2011</strong> <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">in the state of </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Gujarat. </strong>It is a <strong>severe</strong> form of viral hemorrhagic fever caused by negative sense ssRNA <strong>Nairovirus</strong> species. It is <strong>zoonotic</strong> in origin with <strong>Ixodes ticks</strong> as vectors with livestock as primary reservoirs. The outbreak was caused due to <strong>person-to-person</strong> transmission in a tertiary care hospital where the index patient (first identified case) was admitted.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following types of fever with their respective temperature variations.",
    "choices": [
      {
        "id": 1,
        "text": "1-A, 2-D, 3-B, 4-C"
      },
      {
        "id": 2,
        "text": "1-C, 2-D, 3-B, 4-A"
      },
      {
        "id": 3,
        "text": "1-B, 2-C, 3-A, 4-D"
      },
      {
        "id": 4,
        "text": "1-D, 2-B, 3-C, 4-A"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct match is:</p>\n<table style=\"width: 344.938px;\">\n<tbody>\n<tr>\n<td style=\"width: 131px;\"><strong>Type of fever</strong></td>\n<td style=\"width: 195.938px;\"><strong>Temperature variation</strong></td>\n</tr>\n<tr>\n<td style=\"width: 131px;\">1. Persistent</td>\n<td style=\"width: 195.938px;\">C. Temperature fluctuates &lt;1&deg;C during a day; always above baseline</td>\n</tr>\n<tr>\n<td style=\"width: 131px;\">2. Remittent</td>\n<td style=\"width: 195.938px;\">D.&nbsp;Temperature fluctuates &gt;2&deg;C during a day; always above baseline</td>\n</tr>\n<tr>\n<td style=\"width: 131px;\">3. Intermittent</td>\n<td style=\"width: 195.938px;\">B. Temperature elevated multiple times a day; touches baseline</td>\n</tr>\n<tr>\n<td style=\"width: 131px;\">4. PUO</td>\n<td style=\"width: 195.938px;\">A. Temperature &gt;38&deg;C on multiple occasions; no localizing signs</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>A temperature of <strong>&gt;99.9&deg;F</strong> or &gt;37.7&deg;C defines a <strong>fever</strong>. <strong>Body temperature</strong> also has a <strong>diurnal</strong> and <strong>seasonal variation</strong>, being <strong>higher in </strong>the<strong> winters</strong> and <strong>late afternoons</strong>, and <strong>lower</strong> <strong>in</strong> the <strong>summers</strong> and <strong>mornings</strong>. <strong>Rectal temperature</strong> measurements are <strong>higher</strong> <strong>than</strong> the <strong>oral readings</strong> <strong>and</strong> the unadjusted <strong>tympanic membrane temperature</strong> measurements.&nbsp;</p>\n<p>While monitoring the temperature readings in in-patients at the hospital, the following types of patterns can be noticed:</p>\n<ul>\n<li><strong>Persistent</strong> fever is the one where the <strong>temperature remains above the baseline</strong> throughout the day and it <strong>doesn't fluctuate by &gt;1&deg;C</strong> during this time.</li>\n<li><strong>Remittent</strong> fever is the one where the <strong>temperature remains above the baseline</strong> throughout the day, but it <strong>fluctuates by &gt;2&deg;C</strong> during this time.</li>\n<li><strong>Intermittent/spiking</strong> fever is one where the <strong>temperature is above the baseline only on a few occasions</strong> throughout the day, but is <strong>normal at other times</strong>.&nbsp;</li>\n</ul>\n<p>There is an entity known as <strong>pyrexia of unknown origin (PUO)</strong>. It has been defined as a <strong>temperature &gt;38&deg;C (101&deg;F)</strong> on <strong>two occasions</strong> but <strong>without a certain diagnosis</strong> despite <strong>1 week of inpatient evaluation</strong>. There are <strong>no localizing signs present</strong> to point to the origin of the fever. In developing countries, <strong>infections (such as tuberculosis) remain the most prominent cause</strong> of PUO. Other causes include <strong>autoimmune diseases</strong> (such as systemic lupus erythematosus, rheumatoid arthritis, vasculitis) and <strong>hematological</strong> and <strong>solid organ malignancies</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with a complex psychiatric history is on a monoamine oxidase (MAO) inhibitor. She visits her primary care physician with increasing depression. The physician adds a selective serotonin reuptake inhibitor (SSRI). Which of the following is she most likely to develop?",
    "choices": [
      {
        "id": 1,
        "text": "Fever, rigidity, dilated pupils, and hyperreflexia"
      },
      {
        "id": 2,
        "text": "Fever, dystonia, rigidity and normal pupils"
      },
      {
        "id": 3,
        "text": "Fever, normotonia, dilated pupils and normal reflexes"
      },
      {
        "id": 4,
        "text": "Fever, rigidity, normal pupils and reduced bowel sounds"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given clinical scenario, the symptoms of\u00a0<strong>fever</strong>, <strong>rigidity, hyperreflexia,\u00a0</strong>and <strong>dilated </strong>pupils are seen in the patient who is on a <strong>MAO inhibitor +\u00a0 SSRI. </strong>It is due to the<strong>\u00a0</strong>development of\u00a0<strong>serotonin syndrome.</strong></p>\n<p>Serotonin syndrome\u00a0occurs due to the concurrent administration of an SSRI with an MAO-inhibitor, L-tryptophan, or lithium, raising plasma serotonin concentrations to toxic levels. This serious and possibly fatal syndrome with the symptoms\u00a0</p>\n<ul>\n<li>diarrhea, diaphoresis, flushing, <strong>mydriasis</strong>, salivation</li>\n<li>restlessness</li>\n<li>extreme agitation, <strong>hyperreflexia</strong>, and rapid fluctuations in vitals</li>\n<li>myoclonus, <strong>hyperthermia</strong>, uncontrollable shivering, <strong>rigidity</strong>; and eventually</li>\n<li>delirium, status epilepticus, cardiovascular collapse, and death.\u00a0</li>\n</ul>\n<p>Treatment involves\u00a0<strong>removing the offending agent </strong>and<strong> supportive care</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fever Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>