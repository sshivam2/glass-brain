<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>092 Acute Leukemia - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">24</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "What is the most common type of leukemia in adults?",
    "choices": [
      {
        "id": 1,
        "text": "Acute myeloid leukemia"
      },
      {
        "id": 2,
        "text": "Adult acute lymphoblastic leukemia"
      },
      {
        "id": 3,
        "text": "Chronic myeloid leukemia"
      },
      {
        "id": 4,
        "text": "Chronic lymphoid leukemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Chronic lymphoid leukemia&nbsp;(<strong>CLL</strong>) is the most common type of leukemia in <strong>adults</strong>.</p>\n<p>The common types of leukemia in various age groups is as follows:</p>\n<ul>\n<li>Acute myeloid leukemia (<strong>AML</strong>) - most common <strong>acute leukemia</strong> in adults</li>\n<li>Acute lymphoid leukemia (<strong>ALL</strong>) - most common cancer in <strong>childhood.&nbsp;</strong>The most common subtype of ALL is&nbsp;<strong>B-cell</strong> ALL</li>\n<li>Non-Hodgkin's lymphoma (<strong>NHL</strong>) - most common<strong> lymphoid </strong>malignancy in<strong> adults</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a risk factor for acute myeloid leukemia?",
    "choices": [
      {
        "id": 1,
        "text": "Down's syndrome"
      },
      {
        "id": 2,
        "text": "Bloom syndrome"
      },
      {
        "id": 3,
        "text": "Fanconi anemia"
      },
      {
        "id": 4,
        "text": "Evan's syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Evan's syndrome does not predispose to acute&nbsp;myeloid leukemia (<strong>AML</strong>).</p>\n<p>The following conditions predispose to AML:</p>\n<p><strong>Genetic conditions:</strong></p>\n<ul>\n<li><strong>Down's syndrome</strong>:\n<ul>\n<li>Young children &lt;4 years</li>\n<li>Typically of the acute megakaryocytic subtype and associated with GATA1 mutations</li>\n<li>Excellent clinical outcomes&nbsp;</li>\n</ul>\n</li>\n<li>Defective DNA repair in conditions like&nbsp;ataxia telangiectasia,<strong> Fanconi anemia,&nbsp;</strong>and<strong> Bloom syndrome</strong>&nbsp;</li>\n</ul>\n<p><strong>Environmental factors:</strong></p>\n<ul>\n<li>Drugs:&nbsp;\n<ul>\n<li>Alkylating agents<strong> - c</strong>yclophosphamide, melphalan, dacarbazine, platinum compounds, after 4-6 years of exposure</li>\n<li>Topoisomerase II inhibitors <strong>-</strong> etoposide, after 1-3 years of exposure.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>Radiation - high dose radiation, therapeutic radiation in patients exposed to alkylating agents</li>\n<li>Chemicals - benzene, petroleum products, pesticide</li>\n</ul>\n<p><strong>Hematological disorders with increased risk of AML:</strong></p>\n<ul>\n<li>Myeloproliferative disorders</li>\n<li>Paroxysmal nocturnal hemoglobinuria</li>\n<li>Aplastic anemia</li>\n<li>Myelodysplastic syndrome</li>\n<li>Multiple myeloma</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old girl was referred with recurrent bacterial infections. Parents report that their first child also had similar features and died at the age of 18 months from myeloid leukemia. Investigations revealed markedly reduced absolute neutrophil count. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Bloom syndrome"
      },
      {
        "id": 2,
        "text": "Kostmann disease"
      },
      {
        "id": 3,
        "text": "Diamond-Blackfan syndrome"
      },
      {
        "id": 4,
        "text": "Chediak-Higashi syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This clinical scenario of <strong>congenital neutropenia</strong>&nbsp;is suggestive of <strong>Kostmann syndrome</strong>. It is associated with an increased risk of acute myeloid leukemia (<strong>AML</strong>).</p>\n<p>Kostmann syndrome occurs due to mutations in<strong>&nbsp;</strong>the <strong>G-CSF receptor</strong> and neutrophil elastase. This causes bone marrow failure specifically in the myeloid lineage. It presents in young children as <strong>recurrent</strong> <strong>bacterial</strong> <strong>infections</strong> (such as otitis media, cellulitis) and oral ulcers.&nbsp;</p>\n<p>Option A: Bloom syndrome occurs due to defects in DNA repair.&nbsp;It is not associated with neutropenia but has a higher risk of AML.&nbsp;</p>\n<p>Option C: Diamond-Blackfan syndrome refers to congenital erythroid aplasia. It is also associated with a higher risk of AML.&nbsp;</p>\n<p>Option D: Chediak-Higashi syndrome is due to defective phagolysosome formation. It is not associated with neutropenia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old man is being evaluated for suspected acute myeloid leukemia. He reports a fast-growing swelling in his mouth for the past 1 week. On examination, there is a greenish gingival mass with a necrotic surface. This presentation is likely associated with which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "AML M2"
      },
      {
        "id": 2,
        "text": "AML M3"
      },
      {
        "id": 3,
        "text": "AML M7"
      },
      {
        "id": 4,
        "text": "AML M5a"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This clinical scenario is suggestive of a <strong>chloroma</strong>. It is commonly associated with the<strong>&nbsp;M2</strong>&nbsp;subtype of acute myeloid leukemia, also called <strong>AML with maturation</strong>.</p>\n<p>Chloroma is also called<strong>&nbsp;myeloid sarcoma</strong>, extramedullary myeloid tumor, or granulocytic sarcoma. It is an extramedullary tumor mass consisting of myeloid blasts, with or without maturation<strong>. </strong>It is called chloroma due to the peculiar <strong>green color</strong>, caused by <strong>myeloperoxidase</strong>.&nbsp;The sites affected include&nbsp;<strong>orbit</strong> (most common), skull, oral cavity, paranasal sinuses, sternum, ribs, vertebrae, and pelvis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Patients suffering from which type of AML are more prone to develop disseminated intravascular coagulation?",
    "choices": [
      {
        "id": 1,
        "text": "Monocytic"
      },
      {
        "id": 2,
        "text": "Myelomonocytic"
      },
      {
        "id": 3,
        "text": "Monoblastic"
      },
      {
        "id": 4,
        "text": "Acute promyelocytic"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Disseminated intravascular coagulation (<strong>DIC</strong>) is commonly seen&nbsp;in patients with acute promyelocytic leukemia (<strong>APL</strong>).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Oral cavity examination of a 56-year-old man with suspected leukemia revealed the following. What subtype of AML is he likely to be suffering from?",
    "choices": [
      {
        "id": 1,
        "text": "M7"
      },
      {
        "id": 2,
        "text": "M5"
      },
      {
        "id": 3,
        "text": "M3"
      },
      {
        "id": 4,
        "text": "M2"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows swollen and spongy gums, indicating <strong>gum infiltration</strong>. This is a characteristic feature of acute monocytic leukemia (<strong>AML-M5</strong>).</p>\n<p>Infiltration of the gingivae, skin, soft tissues or meninges with leukemic blasts is characteristic of the monocytic subtypes and those with 11q23 chromosomal abnormalities.</p>\n<p>Less commonly, infiltration is also seen in acute myelomonocytic leukemia (<strong>AML-M4</strong>).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b9a5857597db45929ff7e63d72113b3d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following would be seen on flow cytometry of a patient with acute megakaryoblastic leukemia?",
    "choices": [
      {
        "id": 1,
        "text": "CD113"
      },
      {
        "id": 2,
        "text": "CD 117"
      },
      {
        "id": 3,
        "text": "CD 61"
      },
      {
        "id": 4,
        "text": "CD 13"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>On flow cytometry, the immunophenotype of <strong>acute megakaryoblastic leukemia</strong> is <strong>CD41</strong> and/or <strong>CD61</strong>&nbsp;positive (platelet-specific antigens).</p>\n<p>Flow cytometry is useful in establishing the different subtypes of AML:</p>\n<table style=\"height: 190px; width: 357.947px;\">\n<tbody>\n<tr>\n<td style=\"width: 141px;\"><strong>Phenotype</strong></td>\n<td style=\"width: 204.947px;\"><strong>CD markers</strong></td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Myeloblastic</td>\n<td style=\"width: 204.947px;\">CD11b,13,33,117</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Promyelocytic(M3)</td>\n<td style=\"width: 204.947px;\">CD13,33</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Myelomonocytic(M4)</td>\n<td style=\"width: 204.947px;\">CD11b,13,14,33</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Monocytic(M5)</td>\n<td style=\"width: 204.947px;\">CD11b,11c,13,14,33&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Erythroid(M6)</td>\n<td style=\"width: 204.947px;\">Glycophorin,spectrin</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Megakaryoblastic(M7)</td>\n<td style=\"width: 204.947px;\">CD41,61</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Basophilic</td>\n<td style=\"width: 204.947px;\">CD11,13,33,123</td>\n</tr>\n<tr>\n<td style=\"width: 141px;\">Mast cell</td>\n<td style=\"width: 204.947px;\">CD13,33,117</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true about the WHO classification of acute myeloid leukemia?",
    "choices": [
      {
        "id": 1,
        "text": "The clinical features are not considered to define the subtype"
      },
      {
        "id": 2,
        "text": "The cutoff value of blast cells for diagnosis is 20%"
      },
      {
        "id": 3,
        "text": "It is only based on morphological features of myeloid precursors"
      },
      {
        "id": 4,
        "text": "Chromosomal translocations along with > 20% blasts are needed for diagnosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The cutoff value of <strong>blast cells</strong> for the diagnosis of <strong>AML</strong> is <strong>20%</strong> according to the <strong>WHO</strong> classification.&nbsp;This classification is based on the&nbsp;<strong>clinical features, cytogenetic </strong>and<strong> molecular</strong> abnormalities in addition to <strong>morphology</strong>. This is in contrast to the&nbsp;previously used French-American-British (<strong>FAB</strong>) classification&nbsp;which was based on&nbsp;<strong>only</strong>&nbsp;<strong>morphology</strong> of myeloid precursors.</p>\n<p>The major changes in the WHO classification in contrast to FAB classification are:</p>\n<ul>\n<li>Blast cutoff for diagnosis of AML is <strong>20%</strong> (30% in FAB classification)&nbsp;</li>\n<li>Specific <strong>chromosomal rearrangements</strong>&nbsp;such as&nbsp;t (8;21), inv(16), t(16;16) and t (15;17) can define AML even with<strong> &lt; 20% blasts</strong>&nbsp;</li>\n<li><strong>Immunophenotyping</strong> (flow cytometry) is used to differentiate AML from ALL and to identify some subtypes of AML&nbsp;</li>\n<li>Myeloid dysplasia with blasts between 20-30% can benefit from therapy for myelodysplastic syndrome (decitabine, 5-azacytidine, cedazuridine)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man is referred for evaluation of severe anemia, persistent fever, and recurrent epistaxis. Lab investigations are given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Acute lymphoblastic leukemia"
      },
      {
        "id": 2,
        "text": "Acute myeloblastic leukemia"
      },
      {
        "id": 3,
        "text": "Preleukemia"
      },
      {
        "id": 4,
        "text": "Aleukemic leukemia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>acute myeloblastic leukemia</strong> (AML).</p>\n<p>According to the <strong>WHO criteria</strong>, the diagnosis of AML requires any<strong> one </strong>of the following:</p>\n<ul>\n<li>Blast cell count \u226520% either in the peripheral blood or\u00a0bone marrow</li>\n<li><strong>Presence</strong> of any one of the following <strong>cytogenetic abnormalities</strong>:\n<ul>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"1\" data-aria-level=\"1\">t(15;17)\u00a0</li>\n<li>t(8;21)\u00a0</li>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"3\" data-aria-level=\"1\">Inversion 16\u00a0or\u00a0t(16;16)</li>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"3\" data-aria-level=\"1\">t(9;22)</li>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"3\" data-aria-level=\"1\">NPM1 mutation (Nucleophosmin mutation)</li>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"3\" data-aria-level=\"1\">CEBPA mutation</li>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"3\" data-aria-level=\"1\">FLT3-ITD</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Patients with all of the following are classified as AML with recurrent cytogenetic abnormalities except:",
    "choices": [
      {
        "id": 1,
        "text": "t(16,16)"
      },
      {
        "id": 2,
        "text": "NPM1 mutation"
      },
      {
        "id": 3,
        "text": "CEBPA mutation"
      },
      {
        "id": 4,
        "text": "t(9,22)"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The chromosomal translocation <strong>t(9,22)</strong> is called the Philadelphia chromosome. It is seen in patients with <strong>CML</strong>.</p>\n<p>AML with recurrent genetic abnormalities includes the following chromosomal aberrations:</p>\n<ul>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"1\" data-aria-level=\"1\">t(15;17)&nbsp;</li>\n<li>t(8;21)&nbsp;</li>\n<li data-leveltext=\"%1)\" data-font=\"\" data-listid=\"17\" aria-setsize=\"-1\" data-aria-posinset=\"3\" data-aria-level=\"1\">Inversion 16&nbsp;or<strong>&nbsp;t(16;16)</strong></li>\n</ul>\n<p>Two gene mutations have been added to the&nbsp;criteria of AML with recurrent genetic abnormalities in addition to chromosomal aberrations.&nbsp;Both gene mutations are associated with a&nbsp;<strong>good prognosis.</strong></p>\n<ul>\n<li><strong>NPM1</strong> mutation: Nucleophosmin mutation</li>\n<li><strong>CEBPA</strong> mutation</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following cytogenetic abnormalities is seen in patients with acute promyelocytic leukemia?",
    "choices": [
      {
        "id": 1,
        "text": "t(15;17)"
      },
      {
        "id": 2,
        "text": "t(16;16)"
      },
      {
        "id": 3,
        "text": "RUNX1-RUNX1T1"
      },
      {
        "id": 4,
        "text": "CBF-\u03b2 mutation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>t(15,17)</strong> is associated with acute promyelocytic leukemia (<strong>APL</strong>).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old woman presented with fatigue and fever for the past 2 months. Investigations revealed pancytopenia and the following peripheral smear findings. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "AML"
      },
      {
        "id": 2,
        "text": "ALL"
      },
      {
        "id": 3,
        "text": "CML"
      },
      {
        "id": 4,
        "text": "CLL"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario and peripheral smear showing blast cells with<strong> peroxidase granules</strong>&nbsp;are suggestive of acute myeloid leukemia (<strong>AML</strong>).&nbsp;Peroxidase granules are <strong>dark blue-stained</strong> granules seen in the cytoplasm on peroxidase staining.&nbsp;</p>\n<p>Myeloperoxidase cytochemical activity is negative in&nbsp;chronic myeloid leukemia&nbsp;(CML) and blast crisis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1de3afe66ebb411baf86ba59f5c91a55.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following patients with AML has a better prognosis than the others?",
    "choices": [
      {
        "id": 1,
        "text": "A 48-year-old man newly diagnosed with AML with a family history of lymphoma"
      },
      {
        "id": 2,
        "text": "A 60-year-old woman who developed AML following chemotherapy for ovarian cancer"
      },
      {
        "id": 3,
        "text": "A 71-year-old man with a longstanding history of myelodysplastic syndrome"
      },
      {
        "id": 4,
        "text": "A 67-year-old woman evaluated with a 4-month history of pancytopenia prior to diagnosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Young age</strong> of onset is associated with a <strong>good prognosis</strong> in patients with AML. Family history does not affect the prognosis.</p>\n<p>Poor prognosis is seen in the following cases:</p>\n<ul>\n<li><strong>Advancing age</strong> (usually defined as <strong>&gt; 60 years</strong>)&nbsp;</li>\n<li>Previous hematologic disorders - myeloproliferative neoplasms and&nbsp;<strong>myelodysplastic</strong> syndrome</li>\n<li>Longstanding <strong>cytopenias &gt;3 months</strong> before diagnosis&nbsp;</li>\n<li>Therapy-related AML (<strong>chemotherapy</strong> for other cancers)</li>\n<li>Chromosomal aberrations with poor outcomes</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A pathologist is examining the peripheral smear of a patient with suspected leukemia. All of the following features are suggestive of a myeloblast except:",
    "choices": [
      {
        "id": 1,
        "text": "Auer rods"
      },
      {
        "id": 2,
        "text": "Prominent nucleoli"
      },
      {
        "id": 3,
        "text": "Phi bodies"
      },
      {
        "id": 4,
        "text": "Pelger-Huet anomaly"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Pelger-Huet</strong> anomaly refers to neutrophils with <strong>bilobed nuclei</strong> that occur as a benign, inherited condition. <strong>Pseudo-Pelger-Huet</strong> anomaly refers to an acquired defect seen in <strong>CML</strong>, <strong>myelodysplastic</strong> syndrome.&nbsp;</p>\n<p>Note: Chediak-Higashi syndrome is a rare autosomal recessive disorder with abnormal lysosomal trafficking (LYST gene). Presents with oculocutaneous albinism and immunodeficiency.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eb2d4b735e274611a79fe8ed2d02baa9x1064x1634.JPEG"
    ]
  },
  {
    "text": "A patient presents to the ER with a sudden-onset fever and the following painful rash over her face and upper limbs. CBC reveals neutrophilia. This presentation is associated with all of the following conditions except:",
    "choices": [
      {
        "id": 1,
        "text": "Acute myeloid leukemia"
      },
      {
        "id": 2,
        "text": "Crohn's disease"
      },
      {
        "id": 3,
        "text": "Systemic lupus erythematosus"
      },
      {
        "id": 4,
        "text": "Aplastic anemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This clinical presentation with painful edematous plaques is suggestive of <strong>febrile neutrophilic dermatosis</strong> or <strong>Sweet syndrome</strong>. It is not associated with aplastic anemia. It is associated with the following conditions:</p>\n<ul>\n<li>Acute myeloid leukemia (<strong>AML</strong>) - most common</li>\n<li>Inflammatory bowel disease (<strong>IBD</strong>)</li>\n<li>Solid malignancies of the genitourinary tract</li>\n<li>Systemic lupus erythematosus (<strong>SLE</strong>)</li>\n<li>Drugs - all-trans-retinoic acid, granulocyte colony-stimulating factor (G-CSF)</li>\n<li>Idiopathic Sweet syndrome - common in women following respiratory tract infection</li>\n</ul>\n<p>This condition presents with the following triad:</p>\n<ul>\n<li>Fever</li>\n<li>Neutrophilia</li>\n<li>Dense dermal infiltrate of neutrophils:&nbsp;\n<ul>\n<li><strong>Pinkish-red</strong> to reddish-brown edematous <strong>painful</strong> plaques</li>\n<li>Occur over the head, neck, extremities</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/90fc36735ada43a1ac4e06c99141b0a7.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the most commonly used complete remission induction regimen in patients with AML?",
    "choices": [
      {
        "id": 1,
        "text": "All-trans-retinoic acid and arsenic trioxide"
      },
      {
        "id": 2,
        "text": "L- asparginase"
      },
      {
        "id": 3,
        "text": "Cytarabine with anthracyclines"
      },
      {
        "id": 4,
        "text": "Cytarabine with alkylating agents"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most commonly used complete remission induction regimen in patients with <strong>AML</strong> is <strong>cytarabine</strong> and an <strong>anthracycline</strong> (e.g., daunorubicin, idarubicin).</p>\n<p>The treatment of AML is as follows:</p>\n<ul>\n<li><strong>Induction </strong>chemotherapy with a 7+3 regimen:<strong>\u00a0</strong>\n<ul>\n<li>Cytarabine - continuous intravenous infusion for <strong>7 days</strong></li>\n<li>IV daunorubicin on <strong>days</strong>\u00a0<strong>1,2,3</strong></li>\n<li>Side effects include neutropenia, sepsis</li>\n</ul>\n</li>\n<li><strong>Post-remission\u00a0</strong>therapy:\u00a0\n<ul>\n<li>High dose cytarabine</li>\n<li>Allogenic hematopoeitic\u00a0stem cell transplant</li>\n</ul>\n</li>\n</ul>\n<p>Novel agents include\u00a0gemtuzumab ozogamicin, a CD33 monoclonal antibody.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old man came with generalized bone pain, and easy bruisability for the past 6 months. His WBC count was 60,000 cu. mm and bone marrow aspiration revealed the following. Immunohistochemistry was positive for MPO and cytogenetic studies showed presence of t(15:17). What is the preferred treatment regimen?",
    "choices": [
      {
        "id": 1,
        "text": "Cytarabine"
      },
      {
        "id": 2,
        "text": "Arsenic trioxide"
      },
      {
        "id": 3,
        "text": "All transretinoic acid"
      },
      {
        "id": 4,
        "text": "Arsenic trioxide and all transretinoic acid"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>APL is characterized by<strong> t(15; 17)</strong>&nbsp;translocation resulting in the&nbsp;<strong>PML-RAR-alpha</strong> fusion gene (promyelocyte-retinoic acid receptor alpha).&nbsp;It is a <strong>highly curable </strong>subtype of leukemia. The treatment is as follows:</p>\n<ul>\n<li>Induction therapy:\n<ul>\n<li>ATRA + anthracycline (daunorubicin or idarubicin) or cytarabine (<span style=\"text-align: center;\">OR)</span></li>\n<li>ATRA + arsenic trioxide&nbsp;</li>\n</ul>\n</li>\n<li>Consolidation therapy:\n<ul>\n<li>Post remission anthracycline-based chemotherapy</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/673359cd5a6240de8e1730bbd82e271c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3a7241b9ca1c4a11b931b0fb6cc49d4fx250x364.JPEG"
    ]
  },
  {
    "text": "An 18-year-old girl with the diagnosis of acute promyelocytic leukemia was treated medically. She developed fever and tachypnea and a chest X-ray showed pulmonary infiltrates. What drug should she be given next?",
    "choices": [
      {
        "id": 1,
        "text": "Cytarabine"
      },
      {
        "id": 2,
        "text": "Dexamethasone"
      },
      {
        "id": 3,
        "text": "Doxorubicin"
      },
      {
        "id": 4,
        "text": "Methotrexate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario describes a patient of <strong>APL </strong>(acute promyelocytic leukemia) developing <strong>fever, tachypnea</strong>, and<strong> pulmonary infiltrates</strong> while <strong>on medical treatment</strong>. This is suggestive of <strong>APL differentiation syndrome</strong>, an <strong>adverse effect </strong>of <strong>all-trans-retinoic acid (ATRA)</strong>. The management involves glucocorticoids like <strong>dexamethasone</strong>.&nbsp;</p>\n<p>Along with <strong>glucocorticoids</strong>, the other management of APL differentiation syndrome includes <strong>chemotherapy </strong>for <strong>cytoreduction </strong>and <strong>supportive measures</strong>. In <strong>severe </strong>cases,<strong> temporary discontinuation of ATRA</strong> is necessary.</p>\n<p><strong>ATRA</strong> is an oral drug that induces the <strong>differentiation</strong> of leukemic cells bearing the <strong>t(15;17) </strong>chromosomal translocation. While ATRA reduces the incidence of <strong>DIC</strong> associated with <strong>cytarabine</strong> and <strong>daunorubicin</strong> used earlier in APL, it can cause <strong>APL differentiation syndrome</strong> due to the <strong>adhesion </strong>of differentiated neoplastic cells to the <strong>pulmonary vasculature endothelium</strong>.</p>\n<p>In <strong>low-risk APL </strong>patients with a low leukocyte count at presentation, a combination of <strong>ATRA </strong>and <strong>arsenic trioxide (ATO)</strong> has been found to be superior and is the current standard of care.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 47-year-old man with a diagnosis of acute myeloid leukemia with a blood type O negative blood group presents to the transplant clinic to discuss proceeding with an allogeneic stem cell transplant. Which of the following would be an optimal donor?",
    "choices": [
      {
        "id": 1,
        "text": "His identical twin brother"
      },
      {
        "id": 2,
        "text": "Umbilical cord transplant"
      },
      {
        "id": 3,
        "text": "His HLA identical 50-year-old brother who is otherwise healthy and is blood type O+"
      },
      {
        "id": 4,
        "text": "An HLA identical matched unrelated donor who is blood type O\u2013"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the case of acute myeloid leukemia (AML), <strong>allogeneic</strong> stem cell transplants are the <strong>treatment of choice</strong>. His<strong> HLA identical 50-year-old brother</strong> who is blood type <strong>O positive</strong> would be the <strong>best choice</strong>.</p>\n<p>Other options:</p>\n<p>Option A: An <strong>identical twin brother</strong> would <strong>not</strong> be the donor of choice. The therapeutic benefit of stem cell transplant in hematological malignancies is due to the <strong>graft-versus-leukemia (GvL)</strong>. Donor T lymphocytes attack malignant hematopoietic stem cells of the recipient that remain after high-dose chemotherapy. Despite having a <strong>low rate of graft versus host disease</strong> (GvHD), stem cells from an identical twin <strong>do not have</strong> a desirable degree of <strong>GvL effect</strong>, leading to <strong>higher</strong> rates of <strong>recurrence</strong> post-transplant.&nbsp;</p>\n<p>Option B: <strong>Autologous</strong> (umbilical cord transplant) is <strong>not recommended</strong> as <strong>higher</strong> rates of <strong>relapse</strong> have been reported.</p>\n<p>Option D: An <strong>HLA identical sibling</strong> is <strong>preferred over</strong> an <strong>unrelated HLA identical donor </strong>because there is a greater chance of matching for <strong>minor histocompatibility complex</strong> (mHC). This <strong>reduces</strong> the risk of <strong>GvHD</strong>. ABO compatibility is also important to consider, but a minor ABO mismatch (Rh mismatch) doesn't have any impact on hemolysis, graft-versus-host disease, or survival.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Individuals in which age group have the highest incidence of T-cell acute lymphoblastic lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "20-25 years"
      },
      {
        "id": 2,
        "text": "1-10  years"
      },
      {
        "id": 3,
        "text": "10-19 years"
      },
      {
        "id": 4,
        "text": "26-30 years"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The highest incidence of <strong>T-ALL</strong>\u00a0(T-cell acute lymphoblastic lymphoma) is at\u00a0<strong>10-19 years\u00a0</strong>(adolescence) when the thymus reaches the maximum size.</p>\n<p>On the other hand, <strong>B-ALL</strong> which is more common has a peak incidence at <strong>3 years</strong> (1-10 years). At this age, the number of normal bone marrow pre-B cells (the cell of origin) is at its greatest.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Children with Down's syndrome are at an increased risk of developing all of the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Acute lymphoid leukemia"
      },
      {
        "id": 2,
        "text": "Acute myeloid leukemia"
      },
      {
        "id": 3,
        "text": "Transient myeloproliferative disorder"
      },
      {
        "id": 4,
        "text": "Myelodysplastic disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Down's syndrome</strong> is not associated with myelodysplastic disorder. These patients are at increased risk of developing the following conditions:</p>\n<ul>\n<li>Acute lymphoid leukemia (ALL) - most commonly <strong>B-cell ALL</strong></li>\n<li>Acute myeloid leukemia (<strong>AML</strong>) - most commonly&nbsp;<strong>M7/megakaryoblastic&nbsp;</strong>subtype</li>\n<li>Transient myeloproliferative disorder:\n<ul>\n<li>Associated with <strong>GATA1</strong> mutations.</li>\n<li>Seen in&nbsp;10% of neonates, resolves in&nbsp;first 3 months of life</li>\n<li>Require close follow-up as 20-30% may develop AML by 3 years of life</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-year-old boy was brought with fever, weight loss,  and easy bruisability. Initial examination revealed severe pallor and significant lymphadenopathy. Peripheral smear revealed the following cells, which were also seen on bone marrow studies. Further investigations revealed CD10+ cells. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "T-cell ALL"
      },
      {
        "id": 2,
        "text": "Pro B-cell ALL"
      },
      {
        "id": 3,
        "text": "Pre B-cell ALL"
      },
      {
        "id": 4,
        "text": "Mature B-cell ALL"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This clinical scenario and image showing <strong>blast cells</strong> in a <strong>young</strong> child are suggestive of acute lymphoblastic leukemia (<strong>ALL</strong>). The presence of <strong>CD10</strong> is diagnostic of <strong>pre-B-cell</strong>\u00a0ALL.</p>\n<p><strong>CD10\u00a0</strong>is\u00a0also called the common ALL antigen (<strong>CALLA</strong>). It is the specific immunohistochemical marker for <strong>pre-B cell ALL</strong>.\u00a0This is the most common type of ALL and is associated with a <strong>good prognosis</strong>. However,\u00a0CD10 is negative in infantile leukemia, which is associated with translocation\u00a0(4;11).</p>\n<p>The <strong>immunohistochemistry</strong> of ALL is as follows:</p>\n<table style=\"height: 79px; width: 358.421px;\">\n<tbody>\n<tr>\n<td style=\"width: 155px; text-align: center;\">Type</td>\n<td style=\"width: 192.421px; text-align: center;\">CD marker</td>\n</tr>\n<tr>\n<td style=\"width: 155px;\">pro-B cell</td>\n<td style=\"width: 192.421px;\"><strong>CD34</strong>, <strong>CD19</strong>, CD79a</td>\n</tr>\n<tr>\n<td style=\"width: 155px;\">pre- B cell</td>\n<td style=\"width: 192.421px;\">CD19, CD79a, <strong>CD10</strong>, Tdt, Cytoplasmic Ig</td>\n</tr>\n<tr>\n<td style=\"width: 155px;\">Mature B cell</td>\n<td style=\"width: 192.421px;\">CD19, CD79a,CD20, CD21,CD22, Surface IgM and D</td>\n</tr>\n<tr>\n<td style=\"width: 155px;\">T cell</td>\n<td style=\"width: 192.421px;\">CD 2,3,4,5,6,<strong>7</strong></td>\n</tr>\n</tbody>\n</table>\n<p>Other abnormalities in ALL include:</p>\n<table style=\"height: 115px; width: 466px;\">\n<tbody>\n<tr>\n<td style=\"width: 117.013px;\">\u00a0</td>\n<td style=\"width: 148.974px;\">Good prognosis</td>\n<td style=\"width: 157.622px;\">Bad prognosis</td>\n</tr>\n<tr>\n<td style=\"width: 117.013px;\">Cytogenic</td>\n<td style=\"width: 148.974px;\">t(12,21)</td>\n<td style=\"width: 157.622px;\">\n<p>t(9,22),\u00a0t(4,11)</p>\n<p>Burkitt lymphoma-associated ALL / ALL-L3 -\u00a0t(2,8) , t(8,14), t(8,22)</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 117.013px;\">Molecular</td>\n<td style=\"width: 148.974px;\">\n<p>Hyperdiploidy</p>\n<p>HOX</p>\n<p>NOTCH 1 mutations</p>\n</td>\n<td style=\"width: 157.622px;\">\n<p>Hypodiploidy</p>\n<p>\u00a0</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ec64327e878d43ca8fea3da8142db3eb.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following indicate a good prognosis in children diagnosed with acute lymphoblastic leukemia?",
    "choices": [
      {
        "id": 1,
        "text": "3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 2, 3"
      },
      {
        "id": 3,
        "text": "2, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 2, 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In children with <strong>ALL</strong>, a <strong>good prognosis</strong> is indicated by <strong>low WBC</strong> count, <strong>female</strong> sex, and <strong>hyperdiploidy</strong>.</p>\n<p>Other abnormalities in ALL include:</p>\n<table style=\"height: 115px; width: 353px;\">\n<tbody>\n<tr>\n<td style=\"width: 83px;\">&nbsp;</td>\n<td style=\"width: 118px;\">Good prognosis</td>\n<td style=\"width: 131px;\">Bad prognosis</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Cytogenic</td>\n<td style=\"width: 118px;\">t(12,21)</td>\n<td style=\"width: 131px;\">\n<p>t(9,22),&nbsp;t(4,11)</p>\n<p>Burkitt lymphoma-associated ALL / ALL-L3 -&nbsp;t(2,8) , t(8,14), t(8,22)</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Molecular</td>\n<td style=\"width: 118px;\">\n<p>Hyperdiploidy</p>\n<p>NOTCH 1</p>\n<p>HOX</p>\n</td>\n<td style=\"width: 131px;\">Hypodiploidy</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old boy with Down's syndrome was brought with recurrent infections and bruising over his legs. Further workup was diagnostic of acute lymphoblastic leukemia and he was started on chemotherapy. Which of the following must be added on to prevent metastases to the central nervous system?",
    "choices": [
      {
        "id": 1,
        "text": "L-Asparginase"
      },
      {
        "id": 2,
        "text": "Prednisolone"
      },
      {
        "id": 3,
        "text": "Cytarabine"
      },
      {
        "id": 4,
        "text": "Methotrextate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Intrathecal methotrexate</strong> is used for <strong>CNS prophylaxis</strong> in acute lymphoblastic leukemia (ALL).&nbsp;It is essential in this condition as nearly 1/3 of patients develop CNS involvement at relapse without prophylactic therapy.</p>\n<p>The treatment of ALL is as follows:</p>\n<p><strong>Induction (4 weeks):</strong></p>\n<ul>\n<li>L-Asparaginase:\n<ul>\n<li>Single-dose</li>\n<li>Side effects - pancreatitis, thrombosis</li>\n</ul>\n</li>\n<li>Vincristine:\n<ul>\n<li>Weekly</li>\n<li>Side effects - neuropathy, SIADH</li>\n</ul>\n</li>\n<li>Prednisolone</li>\n</ul>\n<p><strong>Consolidation:</strong> Intrathecal methotrexate</p>\n<p><strong>Maintenance (</strong><strong>24-36 months):</strong></p>\n<ul>\n<li>6-Mercaptopurine</li>\n<li>Methotrexate</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '092 Acute Leukemia';
        let hierarchy = ["Marrow", "qBank", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>