<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>226 Surgery Aiims 2017 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Surgery
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A man met with a road traffic accident, which resulted in paralysis of both his upper and lower limbs. He has not passed urine and tenderness is elicited in the cervical region. What will you advise regarding radiography?",
    "choices": [
      {
        "id": 1,
        "text": "The patient should not be shifted and portable x-ray machine should be used after neck stabilization."
      },
      {
        "id": 2,
        "text": "Instruct the radiographer to take cervical and chest x-ray."
      },
      {
        "id": 3,
        "text": "Instruct the radiographer to take cervical x-ray AP and lateral view without any cervical support."
      },
      {
        "id": 4,
        "text": "Order a cervical x-ray and shift the patient from the trolley by himself."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical situation suggests a cervical spine injury due to trauma. The patient should not be shifted and a <strong>portable X-ray machine</strong> should be used for radiography after <strong>neck stabilization.</strong></p>\n<p>Management in a trauma patient with a suspected cervical fracture involves the following steps:</p>\n<ol>\n<li>Spinal immobilization with a <strong>rigid cervical collar</strong> and a <strong>long spine board</strong> is the immediate step in the management of blunt/penetrating cervical trauma cases.</li>\n<li>It is followed by a gross <strong>assessment</strong> of spinal cord function by eliciting extremity movement. Tenderness over the injured vertebrae or the presence of a deformity is indicative of an associated fracture.</li>\n<li>Imaging is done by X-ray or CT.&nbsp;<span style=\"font-size: 14px;\"><strong>Portable X-ray</strong> machines are preferred to avoid further injury while mobilizing the patient.&nbsp;</span><span style=\"font-size: 14px;\">They are useful in visualizing <strong>thoracic</strong> and <strong>lumbar</strong> vertebrae but <strong>not</strong></span><span style=\"font-size: 14px;\"><span style=\"font-size: 14px;\"><strong>&nbsp;the cervicothoracic junction</strong>.<strong> Cervical CT</strong> has been made the&nbsp;modality of choice in most emergency departments owing to the high quality of images that can be obtained.</span></span></li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 42-year-old woman presented with a history of painless breast lump measuring 6.2 X 4.5 cm in the left upper outer quadrant and no axillary nodes. Core cut biopsy showed ductal carcinoma in situ. She underwent tumor resection with adequate margins and postoperative HPE showed DCIS with intermediate-grade necrosis and with 6-mm clearance on margins. What is the next step of treatment?",
    "choices": [
      {
        "id": 1,
        "text": "No additional treatment"
      },
      {
        "id": 2,
        "text": "Adjuvant radiotherapy"
      },
      {
        "id": 3,
        "text": "Adjuvant chemotherapy"
      },
      {
        "id": 4,
        "text": "Adjuvant chemoradiotherapy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>According to Silverstein <strong>Van Nuys prognostic index</strong> for DCIS, the <strong>total score is 9. </strong>Hence, the patient would require <strong>adjuvant radiotherapy</strong>.</p>\n<p>Age: 42 years (score 2), size: 62mm (score 3), clearance margin: 6mm (score 2) with intermediate-grade necrotic features (score 2).</p>\n<p>Silverstein Van Nuys prognostic index for DCIS:</p>\n<table style=\"height: 196px; width: 81.1252%;\">\n<tbody>\n<tr>\n<td style=\"width: 21.6461%;\">Parameters&nbsp;</td>\n<td style=\"width: 22.6737%;\">Score 1&nbsp;</td>\n<td style=\"width: 22.7384%;\">Score 2&nbsp;</td>\n<td style=\"width: 26.6568%;\">Score 3</td>\n</tr>\n<tr>\n<td style=\"width: 21.6461%;\">Age (years)&nbsp;</td>\n<td style=\"width: 22.6737%;\">&ge;61&nbsp;</td>\n<td style=\"width: 22.7384%;\">40-60</td>\n<td style=\"width: 26.6568%;\">&lt;40&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 21.6461%;\">Size (mm)&nbsp;</td>\n<td style=\"width: 22.6737%;\">&le;15 mm&nbsp;</td>\n<td style=\"width: 22.7384%;\">16-40 mm</td>\n<td style=\"width: 26.6568%;\">&gt;40 mm&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 21.6461%;\">Margin (mm)</td>\n<td style=\"width: 22.6737%;\">&ge;10 mm&nbsp;</td>\n<td style=\"width: 22.7384%;\">1-9 mm&nbsp;</td>\n<td style=\"width: 26.6568%;\">&lt;1 mm</td>\n</tr>\n<tr>\n<td style=\"width: 21.6461%;\">Class (grade and necrosis)</td>\n<td style=\"width: 22.6737%;\">\n<p>Grades 1 and 2&nbsp;</p>\n<p>no necrosis&nbsp;</p>\n</td>\n<td style=\"width: 22.7384%;\">\n<p>Grades 1 or 2</p>\n<p>with necrosis&nbsp;</p>\n</td>\n<td style=\"width: 26.6568%;\">Grade 3 with or without necrosis</td>\n</tr>\n</tbody>\n</table>\n<p>Treatment:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Scores 4-6 with &gt;3mm margin: <strong>Excision alone&nbsp;</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Score 7 with &lt; 3 mm margin, score 8 with &gt; 3mm margin, score 9 with &gt;5mm margin: <strong>Excision with RT</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Score 9 with &lt; 5mm margin &amp; score 10-12: <strong>Mastectomy</strong></li>\n</ul>\n<p>If the patient is&nbsp;<strong>ER/PR+</strong>, adjuvant&nbsp;<strong>hormonal therapy</strong> with tamoxifen or an aromatase inhibitor is indicated. Current data does not support the use of HER-2-directed therapy in DCIS.&nbsp;</p>\n<p>Indications for adjuvant radiotherapy in breast cancer:&nbsp;</p>\n<ul>\n<li>Locally advanced breast cancers (T3, T4, N1, N2, N3)</li>\n<li>Following breast conservation surgery&nbsp;</li>\n<li>After mastectomy if tumor size &ge;5 cm, skin or chest wall involvement, lymphovascular invasion and axillary node-positive for metastasis.</li>\n</ul>\n<p><strong>Post-treatment surveillance</strong>&nbsp;after treatment for DCIS includes history, physical examination, and routine mammography (if applicable).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false regarding imaging in the primary survey of a trauma patient?",
    "choices": [
      {
        "id": 1,
        "text": "Hemodynamically unstable patient should not be sent for CT scan"
      },
      {
        "id": 2,
        "text": "All patients should have chest X-ray PA view only"
      },
      {
        "id": 3,
        "text": "X-ray of the pelvis is essential in primary survery"
      },
      {
        "id": 4,
        "text": "X-rays in primary survey must also be done in pregnant women"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Chest X-ray</strong> and<strong> X-ray pelvis</strong> are taken in <strong>AP view</strong> in the adjuncts to the primary survey of a trauma patient.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with renal calculus of > 4 cm of the staghorn type. What is the best management?",
    "choices": [
      {
        "id": 1,
        "text": "Extracorporeal shockwave lithotripsy"
      },
      {
        "id": 2,
        "text": "Percutaneous nephrolithotomy"
      },
      {
        "id": 3,
        "text": "Ureteroscopic removal"
      },
      {
        "id": 4,
        "text": "Retrorenal surgery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>best</strong> management for<strong> staghorn renal calculus</strong> of<strong> &gt;4 cm</strong> is percutaneous nephrolithotomy<strong> (PCNL)</strong>.&nbsp;</p>\n<p>The <strong>initial</strong> management of renal stones depends on the stone size and includes conservative management, extracorporeal shockwave lithotripsy <strong>(ESWL)</strong>, and PCNL. <strong>PCNL</strong> is preferred for stones <strong>&gt; 2cm</strong> in size and for <strong>staghorn calculi</strong>, while <strong>ESWL</strong> is used to treat renal stones of <strong>size 0.6 to 1.5</strong> cm.&nbsp;PCNL is indicated in</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Renal stones<strong> &gt;2 cm</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Staghorn calculus</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Failed shockwave lithotripsy (SWL) or retrograde intrarenal surgery (RIRS) for renal calculi</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Lower pole renal stones with anatomy that is unfavorable for ESWL</li>\n</ul>\n<p>Other options:</p>\n<p>Option C: <strong>Ureteroscopic removal</strong> is attempted for <strong>failed SWLs or PCNLs</strong>, and is <strong>not</strong> the <strong>first choice</strong> in the surgical management of renal stones.</p>\n<p>Option D:<strong> RIRS</strong> is a minimally invasive procedure similar to ureteroscopic removal, where the kidney is accessed using a <strong>slim and flexible ureteroscope</strong> in a retrograde manner via the<strong> ureteric orifice</strong>. It is indicated for <strong>lower pole</strong> renal stones <strong>&lt; 2 cm</strong>.&nbsp;&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following can be done to transport a polytrauma patient who is conscious except?",
    "choices": [
      {
        "id": 1,
        "text": "Strap their thorax, abdomen and lower limbs on a stretcher"
      },
      {
        "id": 2,
        "text": "Place in prone position to prevent aspiration"
      },
      {
        "id": 3,
        "text": "Put patient on lateral position and shift him immediately"
      },
      {
        "id": 4,
        "text": "Roll the patient onto a hard board"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Long spine boards</strong> with straps are helpful in the rapid transport of the patient from one place to another. The patient can be put on the long spine board by <strong>log-rolling</strong> (a technique where four people hold the patient and roll the patient like a log without allowing rotation or bending of the spine).</p>\n<p>Conscious and alert patient indirectly means that they don&rsquo;t need intubation and their airway is patent.&nbsp;If the patient is <strong>unconscious</strong> always <strong>check</strong> the <strong>airway</strong> and if needed, <strong>endotracheal intubation</strong> must be done immediately by various methods. Preferably by direct laryngoscopy and intubation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b42ec435b72b4a53b01fc3f802b51bb7x600x1200.PNG"
    ]
  },
  {
    "text": "Identify the condition.",
    "choices": [
      {
        "id": 1,
        "text": "Cholesterolosis"
      },
      {
        "id": 2,
        "text": "Strawberry gallbladder"
      },
      {
        "id": 3,
        "text": "Gallbladder polyps"
      },
      {
        "id": 4,
        "text": "Gallbladder carcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Options A and B: <strong>Cholesterolosis</strong> (<strong>s</strong><strong>trawberry</strong> <strong>gallbladder</strong>) is characterized by the accumulation of lipids (triglycerides, cholesterol precursors and cholesterol esters) in the lamina propria of the gallbladder wall. The nodules are less than 1 mm in diameter and there is mucous villous hyperplasia, which gives it a <strong>coarse</strong>, <strong>yellow</strong> and <strong>granular</strong> appearance, giving it a strawberry-like appearance. The given images below show cholesterolosis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dbe2a1d8317444f588e2eb0614dcb595.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/64ec8d9f0e824a66b33048308c981be0x358x281.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2e8340a134f94f8b8a488cd497e4fe24x1280x850.JPEG"
    ]
  },
  {
    "text": "Colour of 22G IV Cannula is?",
    "choices": [
      {
        "id": 1,
        "text": "Pink"
      },
      {
        "id": 2,
        "text": "Green"
      },
      {
        "id": 3,
        "text": "Blue"
      },
      {
        "id": 4,
        "text": "Yellow"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> 22G</strong> IV cannula is <strong>blue</strong> in colour.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Fr in size of Foley's catheter refers to:",
    "choices": [
      {
        "id": 1,
        "text": "Outer Diameter"
      },
      {
        "id": 2,
        "text": "Inner Diameter"
      },
      {
        "id": 3,
        "text": "Inner Circumference"
      },
      {
        "id": 4,
        "text": "Radius"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>French (Fr)</strong> measurement unit refers to the <strong>outer diameter</strong>.</p>\n<p>As per the French system, the <strong>outer circumference equals 3 times the outer diameter</strong>. One French unit (1 Fr) equals 1 mm of the outer circumference and 0.3 mm of the outer diameter. Therefore, the outer diameter in mm can be determined by dividing the Fr size by 3.</p>\n<p>Example: An <strong>18 Fr</strong> would have a <strong>circumference of 18 mm</strong> and an <strong>outer diameter of 6 mm.</strong>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A school bus full of children met with an accident. As the doctor in charge of triage, which of the following will you attend to first?",
    "choices": [
      {
        "id": 1,
        "text": "Airway Obstruction"
      },
      {
        "id": 2,
        "text": "Grade 4 Shock"
      },
      {
        "id": 3,
        "text": "Flail Chest"
      },
      {
        "id": 4,
        "text": "Severe head injury"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 371\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The patient with <strong>airway obstruction</strong>, categorized as <strong>red</strong>, should be attended to first.</p>\n<p>Triage is used to <strong>classify the priority of treatment. </strong>It is carried out at the site of the disaster to determine the&nbsp;<strong>priority for immediate medical attention</strong>,&nbsp;<strong>transportation, and</strong>&nbsp;<strong>admission</strong> to the hospital. Triage decisions are made by deciding which injuries constitute the <strong>greatest immediate threat to life</strong>. In general, airway problems are more rapidly lethal than breathing problems &gt; circulation problems &gt; neurologic injuries.</p>\n<p>The internationally accepted&nbsp;<strong>four-color coded</strong>&nbsp;system is commonly used. It includes:</p>\n<ul>\n<li>Red - High-priority attention or transfer</li>\n<li>Yellow - Medium priority</li>\n<li>Green - Ambulatory patients</li>\n<li>Black - Dead or moribund patients</li>\n</ul>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which parameter is the best guide to monitor the adequacy of fluid resuscitation in a patient?",
    "choices": [
      {
        "id": 1,
        "text": "Central venous pressure"
      },
      {
        "id": 2,
        "text": "Urine output"
      },
      {
        "id": 3,
        "text": "Blood pressure"
      },
      {
        "id": 4,
        "text": "Oxygen saturation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Urine output</strong> is the best measure of organ perfusion and the best monitor for adequacy of fluid resuscitation.</p>\n<p>Adequate end-organ perfusion is best indicated by urine output of &nbsp;<strong>&gt;0.5 to 1 mL/kg/h.</strong>&nbsp;However, it does not give a minute-to-minute value.</p>\n<p>The <strong>level of consciousness</strong> is an important <strong>marker </strong>for<strong> cerebral perfusion.</strong></p>\n<p>The only clinical indicators of <strong>perfusion of the</strong><strong> gastrointestinal tract </strong>and <strong>muscular beds</strong> are measures of <strong>lactic acidosis </strong>(lactate and base deficit) and <strong>mixed venous oxygen saturation</strong>.</p>\n<p>Other options:</p>\n<p>Option A:<strong> Central venous pressure (CVP)</strong> is the <strong>mean pressure</strong> in the <strong>superior vena cava, </strong>used for estimation of preload and right atrial pressure. Normal CVP ranges from 2 to 7 mm Hg (3 to 9 cm H<sub>2</sub>O). A sick or injured patient with a<strong> CVP&nbsp;&lt;3 mm Hg</strong> is presumed to be <strong>volume depleted</strong> and may be given fluids with relative safety. However, CVP is unreliable in assessing volume status or left ventricular function with respect to resusitation.</p>\n<p>Options C and D: Blood pressure and oxygen saturation do not reflect body fluid levels.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common presentation of abdominal desmoid tumor?",
    "choices": [
      {
        "id": 1,
        "text": "Abdominal pain"
      },
      {
        "id": 2,
        "text": "Abdominal mass"
      },
      {
        "id": 3,
        "text": "Fever"
      },
      {
        "id": 4,
        "text": "Rectal prolapse"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Explanation:&nbsp;</p>\n<p>The most common presentation of an abdominal desmoid tumor is an <strong>abdominal mass.&nbsp;</strong></p>\n<p>Desmoid tumors, also known as <strong>fibromatosis</strong>, <strong>aggressive fibromatosis</strong> or <strong>desmoid-type fibromatosis</strong> are locally aggressive tumors that <strong>lack</strong> metastatic potential.&nbsp;Desmoid tumors can be <strong>sporadic</strong> in origin or associated with <strong>familial adenomatous polyposis</strong>.&nbsp;</p>\n<p>These tumors arise from fibro-aponeurotic tissue and typically are manifested as a slowly growing mass. They present as firm, non-painful, non-tender masses in the abdominal wall, shoulder, hip and limbs, mesentery, and pelvis. They are also associated with trauma, pregnancy, and oral contraceptive usage.</p>\n<p>The investigation of choice for a desmoid tumor is <strong>MRI</strong>. It is superior to CT in defining the pattern and the extent of involvement and can determine recurrence after surgery. Diagnosis is established by a biopsy with immunohistochemistry, which stains <strong>positive</strong> for <strong>beta-catenin</strong>, actin and vimentin, and&nbsp;<strong>negative</strong> for desmin, cytokeratin and S-100.</p>\n<p>Treatment:&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">An<strong> initial observation</strong> is preferred for stable, asymptomatic, primary or recurrent desmoids, especially if surgery can cause high mortality.&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Surgical resection</strong> with negative margin clearance is reserved for patients with small abdominal wall tumors associated with pain or an increase in size.&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Tamoxifen</strong>&nbsp;and<strong>&nbsp;NSAIDs&nbsp;</strong>are used as<strong>&nbsp;first-line medical therapy.</strong>&nbsp;Other systemic treatment options are low-dose chemotherapy, tyrosinase kinase inhibitors, and full-dose chemotherapy</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Radiotherapy is preferred for candidates unfit for surgery, patients refusing surgery and when surgical resection is associated with high morbidity.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old child came with complaints of pain over the right lower quadrant and lower back pain. On examination, the patient had pain over the right side of the hip on passive extension with a mass in the right lumbar region pointing towards the groin. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pyelonephritis"
      },
      {
        "id": 2,
        "text": "Psoas abscess"
      },
      {
        "id": 3,
        "text": "Appendicitis"
      },
      {
        "id": 4,
        "text": "Torsion of right undescended testis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Treatment is done by <strong>percutaneous CT-guided drainage</strong> and appropriate <strong>antibiotics</strong>.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Pyelonephritis</strong> is usually associated with a history of urinary tract infection and sudden onset of pain in the flank and hypochondrium, not the lumbar region.</p>\n<p>Option C: <strong>Appendicitis (retrocaecal) </strong>can present with pain on passive extension of the hip (psoas sign), but the presence of a mass in the right lumbar region pointing towards the groin makes it an unlikely diagnosis.</p>\n<p>Option D: <strong>Testicular torsion</strong> is a surgical emergency condition presenting with sudden onset pain in the scrotum, groin and lower abdomen, tenderness, redness and edema of the scrotal skin.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68f3f0abe1d74f1aad24091084f4f153x600x727.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fc50a1d324ad42fba0bbc235e024ca24x287x210.PNG"
    ]
  },
  {
    "text": "Which layer is involved in blister formation in a superficial partial thickness burn?",
    "choices": [
      {
        "id": 1,
        "text": "Epidermis"
      },
      {
        "id": 2,
        "text": "Subcutaneous tissue"
      },
      {
        "id": 3,
        "text": "Papillary dermis"
      },
      {
        "id": 4,
        "text": "Reticular dermis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>papillary dermis</strong> is involved in <strong>blister</strong> formation in a <strong>superficial partial-thickness burn</strong>.</p>\n<p>First-degree burns involve only the epidermis, with pain, redness, and mild swelling.&nbsp;</p>\n<p><strong>Second-degree (partial thickness) burns</strong> involve the epidermis and some parts of the dermis (also known as partial-thickness burns). Further divided into:</p>\n<ul>\n<li><strong>Superficial </strong>second-degree burns - involves the upper part of the <strong>dermis (papillary)</strong> and shows pain, <strong>blisters</strong>, and severe swelling.</li>\n<li><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Deep </strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">second-degree burns - extends up to the </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">reticular layer of the dermis</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> and appears more <strong>pale and mottled</strong>, does not blanch to touch, but remains painful to pinprick.</span></li>\n</ul>\n<p>Third-degree or full-thickness burns involve the full thickness of the dermis and subcutaneous tissue.</p>\n<p>Fourth-degree burns involve deep structures such as muscle and bone.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Proper functioning of ICD tube is indicated by _____.",
    "choices": [
      {
        "id": 1,
        "text": "Continuous air bubbles coming out of the underwater drain"
      },
      {
        "id": 2,
        "text": "Oscillation of water column in the tube"
      },
      {
        "id": 3,
        "text": "Chest X-ray"
      },
      {
        "id": 4,
        "text": "Auscultation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Oscillation of the water column level</strong> (moving up and down during respiration) within the tube in the water seal chamber is indicative of a <strong>functioning (patent) ICD tube</strong>.&nbsp;</p>\n<p>During spontaneous respiration, the water level rises with inspiration and falls with expiration. Whereas during positive pressure ventilation, the opposite occurs. This oscillation is also known as tidaling.</p>\n<p>Other options:</p>\n<p>Option A: Continous bubbling indicates an air leak in the drainage system, which should be corrected</p>\n<p>Option B: Chest X-ray is useful for assessing the position of the ICD tube inside the chest, not its functioning.</p>\n<p>Option C: Auscultation is not useful for assessing the functioning of an ICD tube.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a preoperative surgical safety checklist, which of the following is not present?",
    "choices": [
      {
        "id": 1,
        "text": "Signature of the doctor"
      },
      {
        "id": 2,
        "text": "Consent"
      },
      {
        "id": 3,
        "text": "Functioning pulse oximeter"
      },
      {
        "id": 4,
        "text": "Sterility of instruments"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a preoperative patient surgical&nbsp;safety checklist, doctor&rsquo;s signature is not required.</p>\n<p>WHO Guidelines for Surgical Safety Checklist</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6d067fc4a08b4c94a759136fa808a183x937x722.PNG"
    ]
  },
  {
    "text": "A trauma patient suffers a renal laceration with urine extravasation. He is managed conservatively. However, after a few days, he presents with a urinoma. The next best management for this patient would be?",
    "choices": [
      {
        "id": 1,
        "text": "Ureteral stenting"
      },
      {
        "id": 2,
        "text": "Surgical repair and exploration"
      },
      {
        "id": 3,
        "text": "Observation"
      },
      {
        "id": 4,
        "text": "Percutaneous drainage"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The patient with a history of <strong>grade IV renal injury </strong>(renal laceration with urine extravasation) who develops a <strong>persistent urinoma </strong>(a mass formed by encapsulated extravasated urine) should be managed with the placement of an internal <strong>ureteral stent. </strong></p>\n<p>In patients not cured by ureteral stenting, percutaneous\u00a0nephrostomy or transcutaneous drain may be required.</p>\n<p><strong>Management of renal injuries</strong></p>\n<p><strong>Blunt trauma</strong> is the main cause of renal injuries and is self-limiting. Blunt trauma is mostly treated <strong>conservatively. </strong>Most penetrating injuries require surgical <strong>renal exploration.</strong></p>\n<ul>\n<li><strong>Grading</strong> of injury through <strong>CECT</strong></li>\n<li>If hemodynamically <strong>stable</strong>\n<ul>\n<li><strong>Conservative</strong> management - Bedrest &amp; hemodynamic monitoring</li>\n<li>In grade <strong>IV</strong>, a <strong>repeat CT</strong> scan to ensure the extravasation of urine has resolved.</li>\n</ul>\n</li>\n<li>If hemodynamically <strong>unstable</strong>\n<ul>\n<li>Surgical exploration and repair</li>\n<li>In grade V, <strong>nephrectomy.</strong></li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is considered balanced resuscitation?",
    "choices": [
      {
        "id": 1,
        "text": "Maintaining airway, breathing and circulation"
      },
      {
        "id": 2,
        "text": "Allow permissible hypotension"
      },
      {
        "id": 3,
        "text": "Maintain ph by ensuring acid-base balance"
      },
      {
        "id": 4,
        "text": "Fluid resuscitation by giving colloids and crystalloids"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Permissive hypotension</strong> is a part of balanced resuscitation in trauma management to<strong> avoid bleeding.</strong></p>\n<p>Damage control resuscitation (DCR) i.e. balanced resuscitation is used in the settings of major trauma. It aims to control hemorrhage and prevent coagulopathy prior to the development of the trauma triad of death (hypothermia, acidosis, and coagulopathy). The components of DCR include:</p>\n<ul>\n<li>Permissive hypotension until definitive surgical control&nbsp;</li>\n<li>Minimize crystalloid based resuscitation</li>\n<li>Early use of blood products (PRBCs, FFP, platelets, cryoprecipitate) in the ratio of 1:1:1</li>\n<li>Use of hemostatic agents such as tranexamic acid, recombinant factor 7a, prothrombin complex concentrates</li>\n</ul>\n<p>DCR has the following advantages:</p>\n<ul>\n<li>Minimizes the impact of trauma-induced coagulopathy</li>\n<li>Limits blood product waste</li>\n<li>Reduces the complications that occur with aggressive crystalloid resuscitation.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The flap shown in the picture is which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Serratus anterior flap"
      },
      {
        "id": 2,
        "text": "Pectoral myocutaneous  flap"
      },
      {
        "id": 3,
        "text": "TRAM flap"
      },
      {
        "id": 4,
        "text": "VRAM flap"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<table style=\"height: 395px; width: 609px;\">\n<tbody>\n<tr style=\"height: 13px;\">\n<td style=\"width: 185.062px; height: 13px;\" colspan=\"3\">\n<p><strong>Classification of muscle flaps</strong></p>\n</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 185.062px; height: 13px;\"><strong>Based on blood supply</strong></td>\n<td style=\"width: 181.938px; height: 13px;\">\n<p><strong>Random flap\u00a0</strong></p>\n<p>Unnamed vessel supplying flap</p>\n</td>\n<td style=\"width: 230px; height: 13px;\">\n<p><strong>Axial flap</strong></p>\n<p>Named vessel supplying flap.\u00a0 \u00a0\u00a0</p>\n</td>\n</tr>\n<tr style=\"height: 108.4px;\">\n<td style=\"width: 185.062px; height: 108.4px;\">\u00a0\n<p><strong>Method of movement</strong></p>\n</td>\n<td style=\"width: 181.938px; height: 108.4px;\">\n<p><strong>Local transfer\u00a0</strong></p>\n<p>Rotation flap</p>\n<p>Transposition flap</p>\n<p>Advancement flap</p>\n</td>\n<td style=\"width: 230px; height: 108.4px;\">\n<p><strong>Distant transfer\u00a0</strong></p>\n<p>Pedicle flap</p>\n<p>Free flap</p>\n<p>\u00a0</p>\n</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 185.062px; height: 13px;\">\n<p><strong>Based on composition</strong></p>\n\u00a0</td>\n<td style=\"width: 181.938px; height: 13px;\">\n<p><strong>Simple Flap</strong></p>\n<p>Cutaneous flap</p>\n<p>Musculocutaneous\u00a0</p>\n<p>Fasciocutaneous</p>\n</td>\n<td style=\"width: 230px; height: 13px;\">\n<p><strong>Composite flap</strong></p>\n<p>Osseocutaneous flap</p>\n<p>Sensory flap</p>\n<p>\u00a0</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/94ad53221e514ac3a77321bc5db3053f.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old patient presented with neck swelling which moves with deglutition as shown below. What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Branchial cyst"
      },
      {
        "id": 2,
        "text": "Cystic hygroma"
      },
      {
        "id": 3,
        "text": "Thyroglossal cyst"
      },
      {
        "id": 4,
        "text": "Cervical lymphadenopathy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Clinical features of thyroglossal cyst:</p>\n<ul>\n<li>Classically the cyst <strong>moves upwards</strong> on <strong>swallowing</strong> and on<strong> tongue protrusion.</strong>&nbsp;This indicates attachment to the hyoid bone.&nbsp;</li>\n<li>Swelling is smooth, soft, fluctuant (cystic), nontender, mobile, often transilluminant.</li>\n<li>Thyroid fossa is empty, if there is no thyroid in the normal location.</li>\n</ul>\n<div class=\"page\" title=\"Page 467\">\n<p>Complications of thyroglossal cyst:</p>\n<ul>\n<li>The most common complication is&nbsp;<strong>infection.</strong></li>\n<li>Thyroglossal&nbsp;<strong>fistula</strong>&nbsp;is an acquired condition that either follows&nbsp;<strong>infection</strong>&nbsp;of the cyst which&nbsp;<strong>bursts open or</strong>&nbsp;due to&nbsp;<strong>inadequate removal</strong>&nbsp;of the cyst.</li>\n<li>1% of thyroglossal duct cysts are found to be malignant of which the most common type of&nbsp;<strong>cancer</strong>&nbsp;is&nbsp;<strong>papillary</strong>&nbsp;(85%).</li>\n</ul>\n</div>\n<div class=\"page\" title=\"Page 467\">Neck swellings that move with deglutition are:</div>\n<ul>\n<li aria-level=\"1\">Thyroid swellings</li>\n<li aria-level=\"1\">Subhyoid bursitis&nbsp;</li>\n<li aria-level=\"1\">Dermoid cysts attached to the hyoid bone</li>\n</ul>\n<p>However, only the <strong>thyroglossal cyst</strong>&nbsp;<strong>moves</strong>&nbsp;with<strong>&nbsp;tongue protrusion</strong>. This is because the duct extends from the foramen caecum of the tongue to the isthmus of the gland.&nbsp;</p>\n<p><strong>Sistrunk&rsquo;s operation&nbsp;</strong>is performed to excise the cyst and prevent a recurrence. It involves the <strong>excision&nbsp;</strong>of the&nbsp;<strong>whole thyroglossal tract,</strong>&nbsp;involving removal of the&nbsp;<strong>body of the hyoid bone</strong>, and&nbsp;<strong>suprahyoid tract</strong>&nbsp;through the tongue base to the vallecula at the site of the primitive foramen caecum along with the core of tissue on either side.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f5a7d0bb849b4aa1bf7db6cc51aca449.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/98e4985058c24cb1ae1cbf0c79b41648x1280x1297.JPEG"
    ]
  },
  {
    "text": "A 28-year-old patient was brought to the casualty ward with high fever and pain abdomen.  He had a history of bloody diarrhea for several months. His past history was negative for long-term medications and previous surgeries. The abdominal X-ray image obtained is shown below. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Toxic megacolon"
      },
      {
        "id": 2,
        "text": "Volvulus"
      },
      {
        "id": 3,
        "text": "Ogilvie syndrome"
      },
      {
        "id": 4,
        "text": "Pneumatosis intestinalis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option D: <strong>Pneumatosis intestinalis</strong> is the presence of gas within the bowel wall seen in any part of the GI tract but most commonly in the <strong>jejunum</strong>. It is a pathognomic feature of <strong>necrotizing enterocolitis</strong>. X-ray of the abdomen will show intramural gas in the bowel.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dcc72c69ed284bff98f49e824afa5519.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68a94ae8b92b4bb9bbbd2db12b57b101x510x624.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3f5e35a47306454faa7025aa93bc9978x512x442.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/85839251fded41ae8184d0d5e386be66x1208x968.JPEG"
    ]
  },
  {
    "text": "A USG can detect lymph node metastases in a patient with breast cancer and clinically negative lymph nodes by what percentage?",
    "choices": [
      {
        "id": 1,
        "text": "50 \u2013 60%"
      },
      {
        "id": 2,
        "text": "10 \u2013 20%"
      },
      {
        "id": 3,
        "text": "20 \u2013 30%"
      },
      {
        "id": 4,
        "text": "30 \u2013 50%"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A <strong>USG</strong> can detect lymph node metastasis in a patient with clinically negative lymph nodes by <strong>50-60%</strong>.</p>\n<p>The <strong>clinical determination</strong> of axillary lymph node metastases has an accuracy of only<strong> 33%</strong>.</p>\n<p>Ultrasound (<strong>USG</strong>) is <strong>more sensitive</strong> than physical examination alone in determining axillary lymph node involvement during the preliminary staging of breast carcinoma.&nbsp;</p>\n<p><strong>Fine-needle aspiration cytology (FNAC) or core biopsy</strong> of sonographically indeterminate or suspicious lymph nodes can provide a more definitive diagnosis than USG alone.</p>\n<p>Ultrasonography can also be utilized to image the regional lymph nodes in patients with breast cancer. The <strong>sensitivity</strong> for the status of axillary nodes ranges from <strong>35% to 82%</strong> and <strong>specificity</strong> ranges from <strong>73% to 97%</strong>.</p>\n<p><strong>The features of a lymph node involved with cancer on USG include</strong>:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Cortical thickening</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Change in shape of the node to a more circular appearance</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Size larger than 10 mm&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Absence of a fatty hilum</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Hypoechoic internal echoes</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young boy was brought to the casualty with a history of fever and abdominal pain. On examination, he was febrile and his pulse rate was 104 beats/min. The CT scan image is shown below. Which of the following  signs is not seen in this disease?",
    "choices": [
      {
        "id": 1,
        "text": "McBurney's tenderness"
      },
      {
        "id": 2,
        "text": "Rovsing\u2019s  sign"
      },
      {
        "id": 3,
        "text": "Psoas sign"
      },
      {
        "id": 4,
        "text": "Ballance sign"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The patient's history and radiological findings are indicative of <strong>acute appendicitis</strong>. Ballance sign is <strong>not</strong> seen in acute appendicitis.</p>\n<p>Findings on CT that are suggestive of acute appendicitis include:</p>\n<ul>\n<li>Appendiceal dilatation (&gt;6 mm in diameter)&nbsp;</li>\n<li>Appendiceal wall thickening (&gt;3 mm) and enhancement</li>\n</ul>\n<p><strong>Ballance sign </strong>is seen due to a <strong>ruptured spleen</strong>. The ballance sign is positive if there is a <strong>fixed dullness</strong> to&nbsp;percussion&nbsp;in the <strong>left flank</strong> and <strong>shifting dullness</strong> to percussion in the <strong>right flank.</strong> The fixed dullness is due to the presence of coagulated blood near the lacerated spleen while the shifting dullness is due to the presence of blood in the peritoneal cavity.</p>\n<p>Option A:&nbsp;Deep tenderness at McBurney's point, known as&nbsp;<strong>McBurney's sign</strong>, is a sign of acute appendicitis.&nbsp;<strong>McBurney's point</strong>&nbsp;is a point at&nbsp;one-third of the distance from the anterior superior iliac spine and umbilicus.</p>\n<p>Option B:&nbsp;<strong>Rovsing sign</strong> is seen in appendicitis. <strong>Deep palpation</strong> of the <strong>left iliac fossa</strong> may cause pain in the right iliac fossa.</p>\n<p>Option C:&nbsp;<strong>Psoas sign</strong> is seen in appendicitis. Occasionally, an in\ufb02amed appendix lies on the psoas muscle, and the patient will lie with the right hip \ufb02exed, for pain relief.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b052aaad056f40eaa0fc783b2d48830e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy presented to the OPD with a scald injury of his arm. The lesion was pink, oozing, and painful to moving air and touch. Which of the following is the most appropriate management?",
    "choices": [
      {
        "id": 1,
        "text": "Silver sulphadiazine cream dressing"
      },
      {
        "id": 2,
        "text": "Excision and grafting"
      },
      {
        "id": 3,
        "text": "Paraffin gauze dressing"
      },
      {
        "id": 4,
        "text": "Collagen dressing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Scald</strong> injury (damage from contact with hot liquids) that appears pink in colour, has oozing, and pain is suggestive of a <strong>2nd-degree burn </strong>(i.e.&nbsp;<strong>p</strong><strong>artial-thickness burn</strong>).&nbsp;<span dir=\"ltr\" role=\"presentation\"><strong>Collagen dressing</strong> is the</span><span dir=\"ltr\" role=\"presentation\">&nbsp;most appropriate management for this injury.</span></p>\n<p>The <strong>best dressing</strong> for burn wounds is <strong>skin; collagen</strong>&nbsp;is a good substitute for skin, especially in <strong>partial-thickness burns</strong>. For <strong>full-thickness&nbsp;burns</strong>, sequential <strong>excision </strong>and<strong> grafting</strong> should be considered.</p>\n<p>Initial treatment for burns includes<strong> cleaning</strong>&nbsp;<strong><span dir=\"ltr\" role=\"presentation\">burnt areas </span></strong><span dir=\"ltr\" role=\"presentation\">and removing&nbsp;</span><span dir=\"ltr\" role=\"presentation\">loose dead skin</span><span dir=\"ltr\" role=\"presentation\">.</span><strong><span dir=\"ltr\" role=\"presentation\"> Blisters </span></strong><span dir=\"ltr\" role=\"presentation\">are </span><strong><span dir=\"ltr\" role=\"presentation\">de-</span><span dir=\"ltr\" role=\"presentation\">roofed</span><span dir=\"ltr\" role=\"presentation\">&nbsp;</span></strong><span dir=\"ltr\" role=\"presentation\">and </span> <span dir=\"ltr\" role=\"presentation\">an </span><span dir=\"ltr\" role=\"presentation\">appropriate dressing </span><span dir=\"ltr\" role=\"presentation\">is applied.<strong>&nbsp;</strong></span></p>\n<p><span dir=\"ltr\" role=\"presentation\"><strong>Biological dressing </strong>(collagen dressings, amniotic membrane, etc.) is the preferred dressing material, especially in partial thickness burns.&nbsp;</span></p>\n<p><span dir=\"ltr\" role=\"presentation\">If this is not available then a non-adhesive dressing like <strong>paraffin gauze</strong> impregnated with <strong>silver sulfadiazine&nbsp;(SSD) cream</strong>, colloidal silver, ionic silver cream, or silver nitrate cream can be applied. Since increased&nbsp;resistance to SSD has recently emerged, it should be <strong>judiciously used</strong> and reserved&nbsp;for <strong>deep dermal, full thickness, infected,&nbsp;</strong>and <strong>old neglected burns</strong>.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74510e75cc6845ff89d59e0319a190d5x1280x1307.JPEG"
    ]
  },
  {
    "text": "A 25-year-old pregnant women came with a history of thyroid swelling. FNAC report was suggestive of papillary carcinoma thyroid and the nodule was \u201ccold\u201d on scan. Which of the following will not be a treatment option for her?",
    "choices": [
      {
        "id": 1,
        "text": "Total thyroidectomy"
      },
      {
        "id": 2,
        "text": "Total thyroidectomy plus lymph node dissection"
      },
      {
        "id": 3,
        "text": "Radioiodine ablation of thyroid"
      },
      {
        "id": 4,
        "text": "Right hemithyroidectomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Radioactive ablation</strong> of the thyroid is an <strong>absolute contraindication</strong> in <strong>pregnancy</strong> as it can cause <strong>fetal goiter </strong>and<strong> hypothyroidism</strong>.&nbsp;</p>\n<p>Radioactive ablation of the thyroid is done using the radioactive isotope of iodine (<strong>I-131</strong>), which has a half-life of <strong>8 days</strong>. I-131 emits<strong> gamma rays </strong>(useful in imaging) and <strong>beta particles</strong> (useful in therapy). I-131 is concentrated within the thyroid follicles and emits radiation from within the tissue. The beta particles penetrate only 0.5-2 mm of the tissue. The thyroid follicular cells are affected from within and undergo pyknosis and necrosis followed by fibrosis without damage to neighboring tissues.&nbsp;</p>\n<p>Radioactive iodine is administered as the sodium salt of I-131 dissolved in water and taken orally.</p>\n<p>Therapeutic uses of radioactive iodine:</p>\n<ul>\n<li>Distant metastasis at diagnosis (papillary or follicular carcinoma)</li>\n<li>Incomplete tumor resection&nbsp;</li>\n<li>Patients at high risk for mortality or recurrence&nbsp;</li>\n<li>Graves disease&nbsp;</li>\n<li>Toxic multinodular goitre&nbsp;</li>\n</ul>\n<p>The average therapeutic dose is <strong>3-6 m curie</strong>, calculated based on previous tracer studies and thyroid size.</p>\n<p>Contraindications:&nbsp;</p>\n<ul>\n<li><strong>Pregnancy</strong>&nbsp;</li>\n<li>Lactation&nbsp;</li>\n<li>Young age (&lt;25 years)&nbsp;</li>\n<li>Moderate to severe Graves ophthalmopathy&nbsp;</li>\n</ul>\n<p>Management of differentiated thyroid cancer in pregnancy:&nbsp;</p>\n<ul>\n<li>Thyroidectomy after delivery for patients with no evidence of advanced disease or no rapid progression and in the second trimester for patients with rapid progression or signs of advanced disease.</li>\n<li>Radioactive iodine is contraindicated in pregnancy and lactation. If it is needed after delivery, breastfeeding shall be stopped at least 6 weeks before ablative therapy and mothers should be advised against nursing.</li>\n<li>Levothyroxine supplementation: as a suppressive treatment for those who decided to postpone surgery till the second trimester or after delivery, as a replacement therapy after thyroidectomy, and as a suppressive therapy for patients with residual disease.</li>\n<li>Differentiated thyroid cancer not responding to radioactive iodine can be treated with<strong> </strong>tyrosine kinase inhibitors.</li>\n</ul>\n<p>Diagnostic radioiodine scan:&nbsp; <strong>25&ndash;100 &micro; curie </strong>of I-131 is given; counting or scanning is done at intervals.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 41-year-old woman underwent treatment for breast cancer of 1.2 X 1 cm with positive axillary nodes. She completed radiotherapy and chemotherapy and is now receiving tamoxifen.  How will you follow up the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Annual mammogram"
      },
      {
        "id": 2,
        "text": "Regular checking of LFT once in 6 months"
      },
      {
        "id": 3,
        "text": "Follow-up with tumour markers once in 6 months"
      },
      {
        "id": 4,
        "text": "Yearly bone scans"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Follow-up of patients after treatment of breast cancer consists of a <strong>physical examination</strong> once in 3-6 months for the first 3 years and <strong>an annual mammogram.</strong></p>\n<p><strong>Mammography is the only imaging</strong> modality necessary for follow-up after breast cancer surgery. There is currently no role for tumor markers, serum investigations, or any other imaging studies like bone scans in routine follow-ups.</p>\n<p>Guidelines for follow-up after primary treatment:</p>\n<ul>\n<li><strong>Physical examination: </strong>every 3-6 months for the first 3 years, every 6-12 months for years 4 and 5, and annually thereafter.</li>\n<li><strong>Mammography: </strong>initially, 6 months after surgery, and thereafter, annually.</li>\n<li>Breast self-examination:<strong>&nbsp;</strong>Monthly&nbsp;</li>\n<li>Pelvic examination:&nbsp;Annually in patients taking tamoxifen</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient underwent laparoscopic cholecystectomy and was discharged after removing  the drain tube on the first postoperative day. On day three, the patient came back to the hospital and was febrile. On ultrasound examination, there was a 5 x 5 cm collection in the subhepatic space. Next best step is ______.",
    "choices": [
      {
        "id": 1,
        "text": "To give oral antibiotics since the given accumulation is normal"
      },
      {
        "id": 2,
        "text": "To re-explore the wound and insert a T-tube"
      },
      {
        "id": 3,
        "text": "Insert pigtail catheter for drainage"
      },
      {
        "id": 4,
        "text": "ERCP"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical situation suggests&nbsp;<strong>a bile duct injury</strong> identified on <strong>post-op day 3</strong> following laparoscopic cholecystectomy. The <strong>next best step</strong> after imaging would be to control inflammation by <strong>drainage </strong>of fluid collection&nbsp;<strong>(pigtail insertion and drainage)</strong> and administration of parenteral broad-spectrum antibiotics.</p>\n<p><strong>Bile duct injury </strong></p>\n<ul>\n<li>Usually is manifested in the <strong>postoperative period</strong></li>\n<li>Clinical features<strong> </strong>include fever, increasing abdominal pain, jaundice and bile leakage from an incision.</li>\n</ul>\n<p><strong>Imaging:</strong> Ultrasonography is done to assess for fluid collection and to evaluate the biliary tree<strong>.</strong></p>\n<p><strong>Treatment Strategy</strong></p>\n<ul>\n<li><strong>Control of infection, limiting inflammation </strong>\n<ul>\n<li>Percutaneous drainage of periportal fluid collections</li>\n<li>Parenteral antibiotics (option A)</li>\n</ul>\n</li>\n<li><strong>Clear and thorough delineation of entire biliary anatomy</strong>\n<ul>\n<li>Magnetic resonance cholangiopancreatography<em>&nbsp;</em>(MRCP) or percutaneous transhepatic cholangiography (PTC)</li>\n<li>Endoscopic retrograde cholangiopancreatography (ERCP), especially if a cystic duct stump leak is suspected</li>\n</ul>\n</li>\n<li><strong>Re-establishment of biliary-enteric continuity (surgery)</strong>\n<ol>\n<li>Tension-free, mucosa-to-mucosa anastomosis</li>\n<li>Roux-en-Y hepaticojejunostomy</li>\n</ol>\n</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: Re-exploration and repair in indicated for biliary leaks identified in within 48 hours post cholecystectomy.</p>\n<p>Option D: ERCP would be indicated if drainage using a pigtail catheter fails.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/01e363fe8e3344b78c45d8a2148d4b3cx1280x2262.JPEG"
    ]
  },
  {
    "text": "A 22-year-old boy was admitted to the casualty with a history of breathlessness following massage by his mother. He had a history of hairline ankle fracture and was on a below-knee cast which was removed recently. The most probable diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Pneumonitis"
      },
      {
        "id": 2,
        "text": "Septicemia"
      },
      {
        "id": 3,
        "text": "Acute MI"
      },
      {
        "id": 4,
        "text": "Pulmonary thromboembolism"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The management of PE will vary according to the risk stratification:</p>\n<ul>\n<li>A patient with&nbsp;<strong>high-risk PE</strong>&nbsp;will primarily be treated with&nbsp;<strong>anticoagulation and thrombolysis</strong>&nbsp;or&nbsp;<strong>catheter/surgical embolectomy</strong>.</li>\n<li>A patient with&nbsp;<strong>low-risk PE</strong>&nbsp;will be treated with&nbsp;<strong>anticoagulation alone</strong>, or an IVC filter as secondary prophylaxis.</li>\n<li>Patients with intermediate-risk PE require individualized treatment.&nbsp;</li>\n</ul>\n<p><strong>Anticoagulation</strong>&nbsp;can be done with the classical strategy of&nbsp;<strong>low-molecular-weight heparin</strong>&nbsp;followed by&nbsp;<strong>warfarin</strong>, or by low-molecular-weight heparin for 5 days, switched to novel oral anticoagulant like&nbsp;<strong>Dabigatran</strong>&nbsp;after that.&nbsp;<strong>Fibrinolysis</strong>, if indicated, is done with recombinant TPA administered over 2 hours. It can be done&nbsp;<strong>up to 14 days</strong> after the PE has occurred.</p>\n<p>Management of DVT:</p>\n<ul>\n<li><strong>Anticoagulation</strong>&nbsp;with low molecular weight heparin (LMWH) and unfractionated heparin (UFH) if renal impairment is present.</li>\n<li>After treatment with heparin, patients should be commenced on oral anticoagulants for at least&nbsp;<strong>3 months</strong>&nbsp;with either&nbsp;<strong>factor Xa inhibitors</strong>&nbsp;(rivaroxaban and apixaban) or&nbsp;<strong>direct</strong>&nbsp;<strong>thrombin</strong>&nbsp;<strong>inhibitors</strong>&nbsp;(dabigatran).</li>\n<li>Other measures such as rest, limb elevation and&nbsp;<strong>compression stockings</strong>&nbsp;are also used.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7d7a9f04416a4b8092e31c9214e48d85x1280x2263.JPEG"
    ]
  },
  {
    "text": "A 65-year-old man has the following lesion over the face. He complains of bleeding while itching. The most likely diagnosis is",
    "choices": [
      {
        "id": 1,
        "text": "Dermatofibrosarcoma"
      },
      {
        "id": 2,
        "text": "Marjolin\u2019s ulcer"
      },
      {
        "id": 3,
        "text": "BCC"
      },
      {
        "id": 4,
        "text": "Naevus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option D: Naevus is a common benign neoplasm caused due to mutations in the components of the RAS signaling pathway. It has various types, such as congenital naevus, blue naevus, Spitz naevus, halo naevus, and dysplastic naevus. The given image below shows a patient with multiple dysplastic nevi.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f4495dc81b004d9ebfd682b98e3b708e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0caeeb7b6c7d4d54a315bec750ce5d57x512x386.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ac7f15d9bd1f475cbfd4f1f4162de56ax1280x950.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b7ad06ca1ba249959d7e67a20534e5ddx800x1200.JPEG"
    ]
  },
  {
    "text": "A 54-year-old comes to the casualty with a history of massive hemoptysis. His routine investigation and chest X-ray were normal. Which of the following you will not do to prevent hemoptysis?",
    "choices": [
      {
        "id": 1,
        "text": "Bronchial artery embolization"
      },
      {
        "id": 2,
        "text": "Pulmonary artery embolization"
      },
      {
        "id": 3,
        "text": "Procoagulant drugs"
      },
      {
        "id": 4,
        "text": "Surgical removal of lobe"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Procoagulant drugs are not used to prevent hemoptysis. Procoagulant drugs like <strong>vasopressin</strong> are indicated only if there is an <strong>abnormal coagulation profile</strong>.</p>\n<p><strong>Massive hemoptysis</strong> is generally defined as the expectoration of over <strong>600 mL</strong> of blood within <strong>a 24-h period.</strong></p>\n<p>Treatment priorities in the management of massive hemoptysis:</p>\n<ul>\n<li>First priorities are to secure the <strong>airway</strong>, optimize <strong>oxygenation</strong> and <strong>stabilize the hemodynamic status</strong> by administering IV fluids.</li>\n<li><strong>Chest X-ray</strong> is the <strong>first&nbsp;investigation</strong> of choice. CT scan is done only in hemodynamically stable patients.</li>\n<li>If the bleeding site is known, the patient should be placed in a <strong>lateral decubitus position with the bleeding side down</strong> to prevent aspiration into the unaffected lung. Supplemental oxygen should be given.</li>\n<li>If large-volume bleeding continues or the airway is compromised, the patient should be <strong>intubated</strong> and undergo an <strong>emergency bronchoscopy.</strong></li>\n<li>The bleeding site is localized using <strong>flexible/rigid bronchoscopy.</strong>&nbsp;</li>\n<li>Control the hemorrhage:</li>\n<ul>\n<li>Endobronchially&nbsp;with Nd: YAG laser or bronchial occlusion</li>\n<li>Endovascularly with <strong>bronchial</strong> and/or <strong>pulmonary artery</strong> embolization</li>\n<li>Electrocauterization</li>\n<li><strong>Surgically </strong>with <strong>resection of the involved lobe</strong></li>\n</ul>\n</ul>\n<p>The cause of the hemoptysis must be determined to definitively prevent a recurrence.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old male met with an accident and came to the casualty with a contusion on the left precordium. His vitals are BP 120/80 mmHg,  RR \u2013 16/min.  Normal heart sounds were heard, but decreased breath sounds on the left side, and the trachea deviated to the right. Which of the following is the first line of management?",
    "choices": [
      {
        "id": 1,
        "text": "Needle thoracocentesis"
      },
      {
        "id": 2,
        "text": "Pericardiocentesis"
      },
      {
        "id": 3,
        "text": "Chest tube insertion"
      },
      {
        "id": 4,
        "text": "Open surgery"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of trauma, decreased breath sounds, and tracheal deviation <strong>with stable vitals</strong> are suggestive of a <strong>simple pneumothorax.</strong> Management involves <strong>inserting a chest tube.</strong></p>\n<p>Traumatic pneumothorax can be:&nbsp;</p>\n<ul>\n<li>Simple pneumothorax - <strong>with</strong>&nbsp;hemodynamic stability&nbsp;</li>\n<li>Tension pneumothorax - <strong>without hemodynamic stability&nbsp;</strong></li>\n</ul>\n<p>Initial management of simple pneumothorax with open sucking wound involves prompt <strong>closing of the defect with a sterile occlusive plastic dressing</strong> (e.g., Opsite), taped on three sides to act as a flutter-type valve followed by<strong> chest tube insertion </strong>as soon as possible in a site remote from the injury site.</p>\n<p>Other options:&nbsp;</p>\n<p>Option A: Features of <strong>tension pneumothorax</strong> include hypotension, dyspnea, distended neck veins, tracheal deviation, absent or decreased breath sounds, hyper-resonant note on percussion and normal heart sounds.&nbsp;The first line of management is<strong> needle thoracocentesis </strong>in the 5th intercostal space in the midaxillary line.</p>\n<p><strong>Definitive management</strong> - insertion of an intercostal tube in the triangle of safety. If a sucking wound is present, then it is covered with gauze pieces and taped on 3 sides.</p>\n<p>Option B and D: <strong>Pericardial tamponade </strong>resembles tension pneumothorax but there is no tracheal deviation, normal breath sounds, normal percussion note and muffled heart sounds. Initial management is by needle<strong> pericardiocentesis</strong> followed by <strong>definitive sternotomy</strong> or lateral thoracotomy.</p>\n<p><strong>REMEMBER RECENT UPDATE :(Acc to ATLS 10th edition ):</strong></p>\n<ul>\n<li style=\"list-style-type: none;\">\n<ul>\n<li>In adults, the needle thoracotomy location changed to the <strong>5th ICS mid-axillary line</strong> from the 2nd ICS midclavicular line.</li>\n<li>In the pediatric age group, the thoracotomy location remains at the <strong>2nd ICS mid-clavicular line.</strong></li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '226 Surgery Aiims 2017';
        let hierarchy = ["Marrow", "PYQs", "Surgery"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>