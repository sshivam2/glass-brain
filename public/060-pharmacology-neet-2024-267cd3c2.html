<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>060 Pharmacology Neet 2024 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Pharmacology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">24</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A man presents with mixed infection of Plasmodium vivax and Plasmodium falciparum in a health centre in Rajasthan. What is the dosage of the treatment given on the second day?",
    "choices": [
      {
        "id": 1,
        "text": "4 tablets of Artesunate 50mg + 6 tablets of Primaquine 2.5mg"
      },
      {
        "id": 2,
        "text": "4 tablets of Artesunate 50mg + 6 tablets of Primaquine 7.5mg"
      },
      {
        "id": 3,
        "text": "4 tablets of Artesunate 50mg + Sulphadoxine 1500mg + 6 tablets of Primaquine 2.5mg"
      },
      {
        "id": 4,
        "text": "4 tablets of Artesunate 45mg + Sulphadoxine 1500mg  + 6 tablets of Primaquine 7.5mg"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The dosage of the treatment given on the <strong>second day</strong> for <strong>mixed infection</strong> with <em><strong>Plasmodium vivax </strong></em>and<em><strong> Plasmodium falciparum </strong></em>is <strong>4 tablets of Artesunate 50mg + 6 tablets of Primaquine 2.5mg.</strong></p>\n<p>For treating mixed infections of <strong><em>Plasmodium vivax</em></strong> and <em><strong>Plasmodium falciparum</strong></em>, the following treatment regimen is recommended.\u00a0This approach ensures comprehensive treatment by addressing both the <strong>blood stages</strong> of <strong><em>Plasmodium falciparum</em> </strong>with <strong>ACT</strong> and the <strong>liver stages</strong> of <strong><em>Plasmodium vivax</em></strong> with <strong>Primaquine</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a1052845f6b14466b77a39d656743628x1280x1194.JPEG"
    ]
  },
  {
    "text": "Which drug is used to treat multiple myeloma that is known to cause reactivation of Herpes Zoster?",
    "choices": [
      {
        "id": 1,
        "text": "Bortezomib"
      },
      {
        "id": 2,
        "text": "Lenalidomide"
      },
      {
        "id": 3,
        "text": "Daratumumab"
      },
      {
        "id": 4,
        "text": "Elotuzumab"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The drug used to treat <strong>multiple myeloma </strong>and that has the potential to cause<strong>\u00a0reactivation</strong> of <strong>Herpes Zoster</strong> is <strong>bortezomib</strong>.</p>\n<p>Bortezomib is an <strong>inhibitor </strong>of <strong>proteasome-mediated protein degradation</strong>. It is central to the treatment of <strong>multiple myeloma</strong>, both untreated and relapsed. Bortezomib is given <strong>intravenously or subcutaneously</strong> and dosage depends upon the disease, route of administration, and the patient\u2019s history.\u00a0 It is known to predispose patients to the <strong>reactivation</strong> of<strong> herpesvirus</strong>, including <strong>Herpes Zoster</strong>.</p>\n<p>Adverse effects include <strong>thrombocytopenia</strong>, fatigue, <strong>peripheral neuropathy</strong>, neutropenia, anaemia, anorexia, nausea, limb pain, dizziness, etc. Other adverse events like cardiac tamponade, disseminated intravascular coagulation, toxic epidermal necrolysis, etc. have been reported.\u00a0</p>\n<p>Other options:</p>\n<p>Option B: <strong>Lenalidomide</strong> is the <strong>drug of choice</strong> in patients with <strong>myelodysplastic syndrome (MDS)</strong> associated with <strong>5q deletion</strong>, and is an <strong>immunomodulatory analogue</strong> of <strong>thalidomide</strong>. It <strong>suppresses bone marrow</strong> and is often associated with <strong>significant leukopenia</strong>.</p>\n<p>Option C: <strong>Daratumumab</strong> is a <strong>monoclonal antibody</strong> against <strong>CD-38</strong>.\u00a0</p>\n<p>Option D: <strong>Elotuzumab</strong> is a <strong>monoclonal antibody</strong> against <strong>SLAMF7</strong>, a glycoprotein expressed in <strong>multiple myeloma cells </strong>and <strong>natural killer cells</strong>. It is used in <strong>combination</strong> with <strong>lenalidomide</strong> and <strong>dexamethasone</strong> for the treatment of <strong>multiple myeloma</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presented with breathing difficulty and nasal polyposis when he took aspirin for fever. He faced this issue previously too when he took aspirin. Which among the following is not true about this?",
    "choices": [
      {
        "id": 1,
        "text": "There is no allergic sensitization to aspirin and its metabolites"
      },
      {
        "id": 2,
        "text": "Responds to Monteleukast"
      },
      {
        "id": 3,
        "text": "Occur on exposure to only aspirin"
      },
      {
        "id": 4,
        "text": "Occurs with exposure to other NSAIDs too that block COX 1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The diagnosis for this patient with <strong>breathing difficulty</strong> and <strong>nasal polyposis</strong>, triggered by <strong>aspirin</strong>, a <strong>COX-1 inhibitor</strong> is <strong>aspirin-induced asthma</strong>, also known as <strong>Samter's triad</strong>. The statement that is not true is that \"it occurs on exposure to only aspirin\", as this condition can also be <strong>triggered</strong> by <strong>other NSAIDs</strong> that <strong>inhibit COX-1,</strong> and is <strong>not</strong> restricted to just <strong>aspirin alone</strong>.</p>\n<p><strong>Samter's triad </strong>is also known as\u00a0<strong>aspirin-induced asthma </strong>or aspirin-sensitive asthma<strong>.</strong>\u00a0It consists of:</p>\n<ul>\n<li><strong>Nasal polyposis</strong></li>\n<li>Bronchial <strong>asthma</strong></li>\n<li><strong>Aspirin intolerance</strong></li>\n</ul>\n<p>A patient with Samter's triad experiences severe asthma and nasal polyposis triggered by aspirin or other COX-1 inhibitors. This condition involves <strong>nasal congestion, rhinorrhea, anosmia,</strong> and <strong>recurrent chronic rhinosinusitis</strong>, with <strong>acute asthma attacks</strong> often occurring a few hours after ingestion of these medications.</p>\n<p>These patients <strong>overproduce leukotrienes</strong> due to COX-1 inhibition and <strong>decreased prostaglandin E2 (PGE2)</strong> levels. Therefore, they should <strong>avoid COX-1 inhibitors</strong> like aspirin and most NSAIDs but can generally<strong> tolerate COX-2 inhibitors</strong> and <strong>acetaminophen</strong>.</p>\n<p>Treatment typically includes <strong>leukotriene modifiers</strong>, and in some cases, <strong>aspirin desensitization</strong> may be used to manage symptoms and allow the use of aspirin or NSAIDs if necessary for other conditions. Recent advances in treatment include biologics such as <strong>Dupilumab</strong> and <strong>IL-5 inhibitors</strong>, which are increasingly effective in managing aspirin-induced asthma and may replace aspirin desensitization except when ongoing aspirin or NSAID therapy is required.</p>\n<p>Other options:</p>\n<p>Option A: The reaction in aspirin-induced asthma is <strong>not</strong> due to an <strong>allergic sensitization</strong> but rather due to the inhibition of COX-1 and subsequent overproduction of leukotrienes.</p>\n<p>Option B: <strong>Montelukast</strong>, a l<strong>eukotriene receptor antagonist,</strong> is effective in managing symptoms of aspirin-induced asthma by counteracting the elevated levels of leukotrienes that contribute to inflammation and respiratory issues.</p>\n<p>Option D: It occurs with exposure to other NSAIDs too, that block COX-1. Patients with aspirin-induced asthma can react to other <strong>NSAIDs </strong>that <strong>inhibit COX-1</strong>, not just aspirin.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 75-year-old female presented with urinary incontinence. She also has cognition decline and dementia. Which of the following drugs is useful for treating urinary incontinence?",
    "choices": [
      {
        "id": 1,
        "text": "Tiotropium"
      },
      {
        "id": 2,
        "text": "Ipratropium"
      },
      {
        "id": 3,
        "text": "Tolterodine"
      },
      {
        "id": 4,
        "text": "Telenzipine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>For managing <strong>urinary incontinence</strong> in a 75-year-old female with <strong>cognitive decline</strong> and <strong>dementia</strong>, <strong>tolterodine</strong> is useful.</p>\n<p>Tolterodine is a <strong>muscarinic receptor antagonist</strong> specifically effective for treating urinary incontinence. It exhibits selectivity for the urinary bladder, which helps to minimize side effects compared to other antimuscarinic agents. This selectivity is <strong>beneficial</strong> for patients with <strong>cognitive decline </strong>or dementia, as it <strong>reduces </strong>the risk of <strong>adverse effects.</strong> Tolterodine is <strong>metabolized</strong> by <strong>CYP2D6</strong>, so its dosage may need adjustment based on individual CYP2D6 activity, making it a suitable option for managing urinary incontinence while minimizing potential side effects.</p>\n<p>Other muscarinic antagonists for urinary incontinence include <strong>oxybutynin, trospium chloride, darifenacin, solifenacin</strong>, and <strong>fesoterodine</strong>. <strong>Oxybutynin</strong>, though effective, often causes antimuscarinic side effects such as <strong>xerostomia</strong>. <strong>Trospium</strong> chloride, being a quaternary amine, is better tolerated and <strong>excreted primarily</strong> via the<strong> kidneys</strong>, requiring dosage adjustments in renal impairment. <strong>Darifenacin</strong> and <strong>solifenacin</strong> have selectivity for<strong> M3 receptors</strong>, which helps balance efficacy and side effects, while <strong>fesoterodine</strong>, a <strong>prodrug</strong>, provides a stable pharmacokinetic profile due to its <strong>conversion</strong> to <strong>tolterodine\u2019s active metabolite</strong>.</p>\n<p>Other Options:</p>\n<p>Option A: <strong>Tiotropium</strong> and Option C: <strong>Ipratropium</strong> are <strong>muscarinic antagonists</strong> used primarily for respiratory conditions such as <strong>chronic obstructive pulmonary disease (COPD)</strong> and <strong>asthma</strong>, rather than urinary incontinence. <strong>Tiotropium</strong> is a <strong>long</strong>-acting agent with selectivity for <strong>M1 </strong>and <strong>M3</strong> receptors, while <strong>Ipratropium</strong> is used more frequently for its<strong> short</strong>-acting effects.</p>\n<p>Option D: <strong>Telenzepine</strong>, an <strong>analogue</strong> of <strong>Pirenzepine</strong>, displays higher potency and selectivity for <strong>M1</strong> receptors compared to pirenzepine and is used in treating <strong>acid-peptic diseas</strong>e, not urinary incontinence.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 7-year-old boy presents with a two-week history of persistent fever, fatigue, and pallor. His parents also report easy bruising and gum bleeding. On examination, he is pale with petechiae on his legs, hepatosplenomegaly, and generalized lymphadenopathy. Blood tests show severe anemia, thrombocytopenia, and elevated white blood cell count with blast cells. What is the most appropriate initial treatment regimen for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "IVIG"
      },
      {
        "id": 2,
        "text": "Doxorubicin + Idarubicin"
      },
      {
        "id": 3,
        "text": "Prednisolone + vincristine"
      },
      {
        "id": 4,
        "text": "Radiotherapy of lymph nodes"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario suggests a diagnosis of <strong>Acute Lymphoblastic Leukemia </strong>(ALL), and standard initial treatment in children includes a chemotherapy regimen with drugs like <strong>prednisolone</strong> and <strong>vincristine</strong> during the<strong> induction phase</strong>.\u00a0</p>\n<p>Patients diagnosed with ALL present with symptoms of<strong> impaired marrow function</strong> like <strong>anaemia, infections</strong> secondary to neutropenia, and <strong>bleeding</strong> due to thrombocytopenia. Other symptoms include <strong>bone pain</strong>, generalized lymphadenopathy, splenomegaly, hepatomegaly, testicular enlargement, headache, vomiting, and nerve palsies.</p>\n<p>Treatment of ALL</p>\n<p><strong>Induction:</strong> L-Asparaginase, vincristine, prednisolone, and anthracycline<br /><strong>CNS prophylaxis </strong>with intrathecal methotrexate<br /><strong>Consolidation:</strong> Methotrexate, cytarabine\u00a0<br /><strong>Maintenance:</strong> 6-Mercaptopurine, methotrexate plus intrathecal therapy</p>\n<p>Other Options:</p>\n<p>Option A: IVIG: Intravenous immunoglobulin (IVIG) is <strong>not</strong> used for treating ALL.</p>\n<p>option B: Both <strong>doxorubicin</strong> and <strong>idarubicin</strong> <strong>are</strong> <strong>anthracyclines</strong> used in chemotherapy. While doxorubicin can be part of certain ALL treatment protocols, idarubicin is more commonly used in Acute Myeloid Leukemia (AML) rather than ALL. This combination is not typically used in the induction phase for ALL children.</p>\n<p>Option D: Radiotherapy is <strong>not</strong> a standard initial treatment for ALL. It may be considered in specific cases, such as central nervous system involvement or certain high-risk cases, but the primary treatment for ALL is systemic chemotherapy, not localized radiotherapy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Lignocaine is used in a loading dose for the treatment of arrhythmias. The loading dose of this drug depends upon which of the following factors?",
    "choices": [
      {
        "id": 1,
        "text": "Clearance"
      },
      {
        "id": 2,
        "text": "Volume of distribution"
      },
      {
        "id": 3,
        "text": "Plasma half life"
      },
      {
        "id": 4,
        "text": "Bioavailability"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>volume of distribution</strong> of the drug <strong>determines</strong> the<strong> loading dose</strong> of the drug.</p>\n<p><strong>Loading Dose</strong> = <strong>Volume of distribution</strong> x <strong>Desired steady-state plasma concentration</strong>.</p>\n<p>When the time to reach a steady-state is long, as it is for <strong>drugs</strong> with <strong>long half-lives,</strong> it may be desirable to <strong>administer</strong> a <strong>loading dose</strong> that promptly raises the concentration of the drug in plasma to the target concentration.</p>\n<p>Other options:</p>\n<p>Option A:<strong>\u00a0Clearance</strong> is used to determine the <strong>maintenance dose</strong>.\u00a0</p>\n<p>Maintenance dose = clearance x desired steady-state plasma concentration.</p>\n<p>Options C and D: Plasma <strong>half-life</strong> primarily <strong>determines</strong> the <strong>frequency</strong> of dosing, while <strong>bioavailability</strong> <strong>determines</strong> the <strong>route</strong> of administration.\u00a0Though bioavailability may affect the dose necessary, it will not be the primary factor considered during the calculation of the loading dose.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A hypertensive patient with chronic kidney disease was having frequent attacks of renal colic. Which of the following diuretics is used?",
    "choices": [
      {
        "id": 1,
        "text": "Furosemide"
      },
      {
        "id": 2,
        "text": "Mannitol"
      },
      {
        "id": 3,
        "text": "Hydrochlorothiazide"
      },
      {
        "id": 4,
        "text": "Spironolactone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>For a <strong>hypertensive</strong> patient with <strong>chronic kidney disease</strong> experiencing frequent attacks of <strong>renal colic</strong>, <strong>hydrochlorothiazide</strong>, a <strong>thiazide diuretic</strong>, is often used.</p>\n<p><strong>Thiazide diuretics</strong> are particularly effective in cases of <strong>calcium oxalate kidney stones</strong> because they <strong>reduce urinary calcium excretion</strong>. They work by acting on the <strong>distal convoluted tubule (DCT)</strong> of the nephron, where they<strong> inhibit</strong> the <strong>Na+/Cl- co-transporter</strong>. This <strong>inhibition decreases</strong> the <strong>intracellular sodium concentration</strong>, which, through compensatory mechanisms, leads to<strong> increased calcium reabsorption</strong> into the bloodstream.</p>\n<p>While this mechanism helps in <strong>decreasing urinary calcium</strong> and <strong>managing calcium oxalate stones</strong>, thiazide diuretics can also cause <strong>adverse effects</strong> such as <strong>hypokalemia</strong>, <strong>hyperuricemia</strong>, and <strong>hypercalcemia</strong>. The <strong>increased reabsorption</strong> of <strong>uric acid</strong> due to the diuretic effect can exacerbate conditions like <strong>gout</strong> and should be monitored carefully.</p>\n<p>In addition to their use in treating calcium oxalate kidney stones, thiazide diuretics are commonly prescribed for managing <strong>uncomplicated hypertension</strong> and treating <strong>edema</strong> associated with <strong>heart, liver</strong>, and <strong>kidney</strong> diseases. They are also used for conditions like <strong>osteoporosis</strong> and <strong>nephrogenic diabetes insipidus</strong>.\u00a0</p>\n<p>Other options:</p>\n<p>Option A: <strong>Furosemide</strong> is a <strong>diuretic</strong> that can <strong>increase calcium excretion</strong>, potentially <strong>raising PTH </strong>as the body tries to conserve calcium.</p>\n<p>Option B: <strong>Osmotic diuretics</strong>, like <strong>mannitol</strong>,<strong> retain water</strong> isoosmotically in the <strong>proximal convoluted tubule (PCT)</strong> and <strong>descending loop of Henle</strong> which are freely permeable to water. Luminal fluid is diluted and opposes NaCl reabsorption and promotes calcium excretion. They are indicated in <strong>raised intracranial tension</strong> and in <strong>dialysis disequilibrium</strong>.</p>\n<p>Option D: <strong>Spironolactone</strong> is a <strong>potassium-sparing diuretic</strong> and <strong>aldosterone antagonist</strong>. It works by <strong>competitively inhibiting aldosterone receptors</strong> in the distal tubules of the kidney.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the drug marked as 'X' in the image.",
    "choices": [
      {
        "id": 1,
        "text": "Clopidogrel"
      },
      {
        "id": 2,
        "text": "Amino caproic acid"
      },
      {
        "id": 3,
        "text": "Tenecteplase"
      },
      {
        "id": 4,
        "text": "Heparin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The drug marked as 'X' in the image is <strong>aminocaproic acid.</strong></p>\n<p><strong>\u03b5-Aminocaproic acid</strong>, a <strong>lysine analogue</strong> that competes with <strong>plasminogen</strong> for <strong>binding sites</strong> on <strong>fibrin</strong>. By blocking this interaction, \u03b5-Aminocaproic acid <strong>prevents</strong> the conversion of <strong>plasminogen</strong> into <strong>plasmin</strong>, thereby <strong>inhibiting fibrinolysis</strong>. This action makes it a useful agent for <strong>reversing</strong> the effects of <strong>fibrinolytic therapy</strong>.</p>\n<p>However, \u03b5-Aminocaproic acid should be administered with caution as it can <strong>suppress intrinsic fibrinolytic activity</strong>, potentially leading to complications such as <strong>disseminated intravascular coagulation (DIC)</strong>. To address this, <strong>fresh frozen plasma</strong> and <strong>cryoprecipitate</strong> may be used to restore fibrin and clotting factors.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/027728f8da6746d1b3504b71d1062798.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eaf426b95b65411ab20b432201766924x1280x1403.JPEG"
    ]
  },
  {
    "text": "Which of the following beta-adrenergic blockers are beneficial for patients with reduced ejection fraction and can reduce mortality in chronic heart failure without causing exacerbations over a few years?",
    "choices": [
      {
        "id": 1,
        "text": "Propanolol"
      },
      {
        "id": 2,
        "text": "Pindolol"
      },
      {
        "id": 3,
        "text": "Esmolol"
      },
      {
        "id": 4,
        "text": "Bisoprolol"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>beta-adrenergic blocker</strong> that is useful in patients with <strong>reduced ejection fraction a</strong>nd can<strong> reduce mortality </strong>in <strong>chronic heart failure </strong>without causing exacerbations over a few years is <strong>bisoprolol.</strong></p>\n<p><strong>Bisoprolol</strong> is preferred for use in patients having <strong>heart failure with reduced ejection fraction (HFrEF)</strong>.</p>\n<p>The <strong>exacerbation</strong> mentioned in the context of <strong>beta-blockers</strong> for heart failure refers to the potential <strong>worsening</strong> of <strong>heart failure symptoms</strong> in some patients, despite the overall benefits of these medications. They can sometimes lead to a<strong> decline</strong> in <strong>left ventricular function</strong>, particularly in individuals with <strong>limited cardiac reserve</strong> who rely heavily on <strong>adrenergic stimulation</strong>. This deterioration can manifest as <strong>increased heart failure symptoms</strong> or a <strong>decrease</strong> in <strong>cardiac function</strong>. The <strong>only beta-blockers</strong> that have been proven to<strong> improve</strong> the <strong>survival</strong> of patients with <strong>HFrEF</strong> or <strong>chronic HF</strong> are -</p>\n<ul>\n<li><strong>B</strong>isoprolol</li>\n<li><strong>M</strong>etoprolol</li>\n<li><strong>C</strong>arvedilol</li>\n</ul>\n<p><strong>HFrEF</strong> is a complex clinical syndrome where the ventricle fails to adequately fill with or eject blood, typically defined by an <strong>ejection fraction (EF) less than or equal to 40%</strong>. Key etiologies include <strong>coronary artery disease, valvular heart disease, congenital heart diseases, and autoimmune diseases like giant cell myocarditis</strong>. Patients with HFrEF commonly experience symptoms like <strong>dyspnea on exertion</strong>, orthopnea, and paroxysmal nocturnal dyspnea, and may present with <strong>pedal edema</strong>, elevated jugular venous pressure (JVP), ascites, and hepatomegaly on examination.</p>\n<p>The pharmacological <strong>management</strong> of HFrEF involves drugs with both <strong>symptomatic</strong> and <strong>mortality benefits</strong>, including <strong>Angiotensin receptor\u2013neprilysin inhibitors (ARNIs)</strong> such as sacubitril/valsartan, angiotensin-converting enzyme <strong>(ACE) inhibitors</strong> like ramipril and enalapril, \u03b2-blockers such as metoprolol and carvedilol, mineralocorticoid receptor antagonists like spironolactone and eplerenone,<strong> sodium-glucose cotransporter 2 (SGLT2) inhibitors </strong>like dapagliflozin, and hydralazine plus isosorbide dinitrate (noting a mortality benefit specifically in African-American patients). Drugs used primarily for<strong> symptomatic relief</strong>, such as <strong>loop diuretics</strong> (e.g., furosemide), and digoxin, are reserved for specific indications or during decompensation. <strong>Non-pharmacological </strong>therapies for HFrEF include <strong>implantable cardioverter-defibrillators (ICD) </strong>and <strong>cardiac resynchronization therapy.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which drug is used for maintenance therapy in opium addiction?",
    "choices": [
      {
        "id": 1,
        "text": "Buprenorphine"
      },
      {
        "id": 2,
        "text": "Naloxone"
      },
      {
        "id": 3,
        "text": "Butarphanol"
      },
      {
        "id": 4,
        "text": "Clonidine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The drug used among the following options for <strong>maintenance therapy</strong> in <strong>opium addiction</strong> is <strong>buprenorphine.</strong></p>\n<p>Buprenorphine is a <strong>partial \u03bc-opioid agonist</strong> and an <strong>antagonist</strong> at <strong>\u03b4 </strong>and <strong>\u03ba receptors</strong>. It is widely used both as an <strong>analgesic</strong> for <strong>chronic pain conditions</strong>, such as cancer pain, and as a treatment for <strong>opioid dependence</strong>, serving as an <strong>alternative </strong>to <strong>methadone</strong>.</p>\n<p>It effectively <strong>controls cravings</strong> and<strong> blocks </strong>the <strong>effects</strong> of <strong>higher-efficacy opioids</strong>. It is often administered in <strong>combination</strong> with <strong>naloxone</strong> to <strong>prevent misuse</strong>, although it may be given <strong>alone</strong> to <strong>pregnant women</strong> or individuals with <strong>naloxone allergies</strong>. Initial dosing typically starts at <strong>2-4 mg daily</strong>, with adjustments made to stabilize the dose at approximately <strong>12 to 16 mg/day</strong>.\u00a0</p>\n<p>For opioid use disorder, effective management includes both <strong>withdrawal </strong>and <strong>long-term treatment</strong> strategies. Withdrawal and detoxification generally start with <strong>managing physical dependence</strong> using medications like <strong>methadone </strong>or <strong>buprenorphine</strong>. <strong>Methadone</strong>, a <strong>full agonist</strong>, is used to stabilize and reduce withdrawal symptoms, while <strong>buprenorphine</strong> helps with cravings and has a <strong>lower risk</strong> of <strong>overdose</strong>.</p>\n<p><strong>Clonidine</strong> and <strong>lofexidine</strong>, <strong>alpha-2 agonists,</strong> are used to <strong>ameliorate withdrawal symptoms</strong>. Lofexidine, approved by the FDA, is the <strong>first non-opioid treatment</strong> specifically for <strong>opioid withdrawal </strong>in adults. <strong>Naltrexone</strong>, a long-acting opioid antagonist, is used as an adjunct in patients who are already <strong>opioid-free</strong>; however, it will <strong>precipitate acute withdrawal symptoms</strong> if administered to those still <strong>dependent</strong> on opioids.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient who recently underwent surgery has complaints of nausea and vomiting. He was prescribed a drug called aprepitant. What is its mechanism of action?",
    "choices": [
      {
        "id": 1,
        "text": "NK-3 antagonist"
      },
      {
        "id": 2,
        "text": "NK-2 agonist"
      },
      {
        "id": 3,
        "text": "NK-1 antagonist"
      },
      {
        "id": 4,
        "text": "NK-1 agonist"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>PONV Physiology: <span style=\"font-family: arial, helvetica, sans-serif; font-size: 12pt;\"><strong>Afferents</strong> from the <strong>chemoreceptor trigger zone </strong>(CTZ), <strong>vagal neurons</strong> in the gastrointestinal system, neurons from the vestibular system and midbrain afferents <strong>relay</strong> within the <strong>vomiting centre</strong> in the reticular formation of the brainstem which then project into the <strong>nucleus tractus solitarius</strong>.</span></p>\n<p><strong>Risk factors</strong> for PONV are divided into:</p>\n<ul>\n<li>Patient factors\n<ul>\n<li><strong>Female</strong>&gt;male</li>\n<li>Age<strong>&lt;50 years</strong></li>\n<li>Prior history of <strong>motion sickness</strong></li>\n<li><strong>Non-smokers</strong> &gt; smokers (<strong>CTZ</strong> is <strong>desensitized</strong>)</li>\n</ul>\n</li>\n<li>Preoperative factors\n<ul>\n<li>(<strong>Fasting </strong>and <strong>anxiety</strong>, while possibly contributing to PONV, have yet to be demonstrated)</li>\n</ul>\n</li>\n<li>Intraoperative factors\n<ul>\n<li>Surgical - <strong>Cholecystectomy, gynaecological</strong> and <strong>laparoscopic</strong> procedures have higher incidences</li>\n<li>Drugs - <strong>Nitrous oxide</strong>, <strong>Opioids</strong>, Cyclopropane,</li>\n<li><strong>General anaesthesia</strong> has a times <strong>more risk</strong> of developing PONV than regional anaesthesia.</li>\n</ul>\n</li>\n<li>Postoperative factors\n<ul>\n<li><strong>Pain</strong> and <strong>early ambulatio</strong>n contribute to a higher risk of PONV.</li>\n</ul>\n</li>\n</ul>\n<p><strong>Scoring systems </strong>used to grade PONV are<strong> </strong>the<strong> Apfel score </strong>and the<strong> Koivuranta score.</strong></p>\n<p>Drugs used in the <strong>prophylaxis</strong> and treatment of PONV:</p>\n<ul>\n<li>5-HT 3 antagonists - <strong>ondansetron</strong>, palonosetron</li>\n<li>Butyrophenones- <strong>droperidol</strong></li>\n<li><strong>Dexamethasone</strong></li>\n<li>Transdermal scopolamine</li>\n<li><strong>Aprepitant</strong></li>\n</ul>\n<p>Note:<strong> Double-blind studies</strong> have found <strong>no difference</strong> in the efficacy between <strong>aprepitant(NK1 antagonists)</strong> and <strong>ondansetron (5HT3 antagonist)</strong> in the <strong>first 24 hours</strong> following surgery. But <strong>after 24 hours</strong> <strong>aprepitant</strong> has proven to be <strong>more productive</strong> than ondansetron in the management of <strong>PONV</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/412d569ccab6464c923b959231b29e98x512x371.PNG"
    ]
  },
  {
    "text": "An HIV patient developed a fever and dry cough. He was diagnosed with TB. He is currently on Lamivudine, Zidovudine and Nevirapine. Which Anti -TB drug should be changed in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Isoniazid"
      },
      {
        "id": 2,
        "text": "Rifampicin"
      },
      {
        "id": 3,
        "text": "Streptomycin"
      },
      {
        "id": 4,
        "text": "Ethambutol"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Rifampicin </strong>should be avoided as it is a potent<strong> inducer </strong>of<strong> CYP enzymes </strong>including CYPs 1A2, 3A4, 2C9, and 2C19, which in turn\u00a0can <strong>induce </strong>the<strong> metabolism </strong>of<strong> nevirapine</strong> and results in <strong>therapeutic failure </strong>of <strong>ART.</strong></p>\n<p><strong>Rifabutin\u00a0</strong>causes the <strong>least induction</strong> of cytochrome enzymes and is therefore\u00a0<strong>preferred in HIV patients</strong> who are on<strong> protease inhibitors/NNRTIs.</strong></p>\n<p>Cytochrome enzyme-inducing potency of rifamycins is <strong>rifampicin &gt; rifapentine &gt; rifabutin.</strong></p>\n<p>Note:\u00a0</p>\n<table style=\"border-collapse: collapse; width: 44.9183%; height: 255.984px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.2543%; height: 22.3984px; text-align: center;\">Cytochrome p-450 inducers</td>\n<td style=\"width: 79.7457%; height: 22.3984px; text-align: center;\">Cytochrome p-450 inhibitors</td>\n</tr>\n<tr style=\"height: 233.586px;\">\n<td style=\"width: 20.2543%; height: 233.586px;\">\n<ul>\n<li>Barbiturates</li>\n<li>Carbamazepine</li>\n<li>Rifampin</li>\n<li>Phenytoin</li>\n<li>Aminoglutethimide</li>\n<li>Cigarette smoking</li>\n<li>Chronic alcoholism</li>\n</ul>\n</td>\n<td style=\"width: 79.7457%; height: 233.586px;\">\n<ul>\n<li>Macrolide antibiotics</li>\n<li>Azole antifungals</li>\n<li>Chloramphenicol</li>\n<li>Omeprazole</li>\n<li>Selective serotonin reuptake inhibitors (SSRIs)</li>\n<li>HIV protease inhibitors</li>\n<li>Cimetidine</li>\n<li>Ciprofloxacin</li>\n<li>Metronidazole</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old woman diagnosed with diarrhoea-predominant irritable bowel syndrome presented to the casualty with severe abdominal pain. She was prescribed a drug that exerts a direct spasmolytic effect on the smooth muscles of the gastrointestinal tract. Which drug could it be?",
    "choices": [
      {
        "id": 1,
        "text": "Dicyclomine"
      },
      {
        "id": 2,
        "text": "Scopolamine"
      },
      {
        "id": 3,
        "text": "Galantamine"
      },
      {
        "id": 4,
        "text": "Rivastigmine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Dicyclomine</strong> is a weak muscarinic receptor antagonist with non-specific <strong>direct spasmolytic</strong> effects on the smooth muscle of the gastrointestinal tract.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Scopolamine</strong> exerts <strong>spasmolytic activity</strong> indirectly through its <strong>antimuscarinic action</strong>. It is not preferred due to its adverse effects like drowsiness, dryness, and blurred vision.\u00a0</p>\n<p>Option C and D:\u00a0<strong>Galantamine</strong> and <strong>rivastigmine</strong> are <strong>central cholinesterase inhibitors</strong> and do not possess spasmolytic activity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is started on a 3 HP TPT regimen. Which of the following is true regarding the regimen?",
    "choices": [
      {
        "id": 1,
        "text": "There is more compliance in 3HP than 9H and 6H"
      },
      {
        "id": 2,
        "text": "No significant difference in 3HP, 6H, 9H"
      },
      {
        "id": 3,
        "text": "Chance of abortion in 3 HP is same as 6H"
      },
      {
        "id": 4,
        "text": "3HP regimen is less effective than 6H and 9H in preventing active TB"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The 3HP regimen, which involves <strong>once-weekly</strong> doses of <strong>Isoniazid</strong> and <strong>Rifapentine</strong> for <strong>12</strong> <strong>weeks</strong>, has been found to have <strong>higher patient compliance</strong> than the <strong>9-month</strong> regimen of <strong>Isoniazid (9H)</strong> and the <strong>6-month regimen (6H).</strong></p>\n<p>The <strong>shorter duration</strong> and <strong>reduced number</strong> of <strong>doses</strong> in the 3HP regimen make it more <strong>convenient</strong> and thus lead to better <strong>adherence.</strong> Studies have shown that patients are more likely to complete the 3HP regimen due to the shorter treatment duration and lower pill burden.</p>\n<p>TPT stands for <strong>Tuberculosis Preventive Therapy.</strong> It is a treatment given to individuals who are at <strong>high risk</strong> of <strong>developing active tuberculosis</strong> (TB) to prevent the progression from latent TB infection (where the person is infected with the TB bacteria but does not have symptoms) to active TB disease.</p>\n<p>There are different regimens for TPT, including:</p>\n<ul>\n<li>3HP: A regimen consisting of <strong>once-weekly</strong> doses of <strong>Isoniazid</strong> (H) and <strong>Rifapentine</strong> (P) for <strong>12 weeks.</strong></li>\n<li>6H: A regimen consisting of daily Isoniazid for 6 months.</li>\n<li>9H: A regimen consisting of daily Isoniazid for 9 months.</li>\n</ul>\n<p>TPT is particularly important for individuals with latent TB who have a higher risk of developing active TB, such as those with HIV, close contacts of TB patients, or those with certain medical conditions that weaken the immune system.</p>\n<p>Other options:\u00a0</p>\n<p>Option B: Research has demonstrated that the 3HP regimen offers better compliance and similar <strong>effectiveness</strong> compared to the traditional 6H and 9H regimens. The shorter duration of 3HP (once weekly for 12 weeks) makes it more convenient and tolerable for patients, which leads to higher adherence rates. Thus, there is a significant difference in patient compliance between these regimens, with 3HP showing clear advantages.</p>\n<p>Option C: Although <strong>3HP</strong> is generally considered <strong>safe,</strong> data suggests that the risk profile for adverse effects, including <strong>potential reproductive</strong> impacts like abortion, differs between regimens. Specifically, 6H may have a different side effect profile due to the <strong>prolonged exposure</strong> to the drug over six months, compared to the shorter and intermittent dosing of 3HP.\u00a0</p>\n<p>Option D: Studies have confirmed that the 3HP regimen is <strong>as effective</strong> as 6H and 9H in preventing active tuberculosis (TB). Both regimens aim to prevent <strong>latent TB</strong> from <strong>progressing</strong> to <strong>active disease,</strong> and <strong>3HP</strong> has been shown to achieve similar outcomes with fewer doses, enhancing patient compliance.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A female suffered a head injury from a road traffic accident. On examination, there is elevated intracranial pressure. Which diuretic among the following can be used in her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Mannitol"
      },
      {
        "id": 2,
        "text": "Hydrochlorothiazide"
      },
      {
        "id": 3,
        "text": "Spironolactone"
      },
      {
        "id": 4,
        "text": "Acetazolamide"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In this patient with <strong>raised intracranial pressure</strong> after a <strong>road traffic accident, mannitol</strong> is the <strong>diuretic</strong> of <strong>choice</strong> in her management to reduce intracranial pressure.\u00a0</p>\n<p>Mannitol is an osmotic diuretic that draws <strong>fluid</strong> out of the <strong>brain tissue</strong> and into the <strong>bloodstream</strong> as it forms a <strong>hypertonic</strong> solution when it reaches the bloodstream, thereby reducing intracranial pressure (ICP). It is commonly used in cases of <strong>traumatic brain injury</strong> or other conditions that cause <strong>elevated ICP.</strong> This effect helps to <strong>relieve pressure</strong> on the <strong>brain,</strong> preventing <strong>further damage.</strong></p>\n<p>Other options:\u00a0</p>\n<p>The other diuretics listed Hydrochlorothiazide, Spironolactone, and Acetazolamide are not typically used for managing elevated ICP. They are not hypertonic solutes and thus do not lead to a rapid reduction of the ICP as mannitol does.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old child presents to the emergency department with lethargy, difficulty feeding, and dehydration. His vitals are stable and his ECG is shown below. What is the next step in his management?",
    "choices": [
      {
        "id": 1,
        "text": "Synchronized cardioversion with 2J of current"
      },
      {
        "id": 2,
        "text": "Adenosine 0.1 mg/kg"
      },
      {
        "id": 3,
        "text": "Adenosine 0.2 mg/kg"
      },
      {
        "id": 4,
        "text": "Synchronized cardioversion with 1J of current"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given ECG shows <strong>pseudo R' waves</strong>:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f29f9fa43ba346a29a54c1f5a649c32c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d3d48754732b440fb17b875d2b52a8dax510x812.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2d4980e7ca344abdb4c864c7546e97d0x1280x1845.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/61107bbff6054604a20f8b083695fb2dx1279x685.JPEG"
    ]
  },
  {
    "text": "Which of the following drugs when added with erythromycin can lead to torsades de pointes?",
    "choices": [
      {
        "id": 1,
        "text": "Doxylamine"
      },
      {
        "id": 2,
        "text": "Loratidine"
      },
      {
        "id": 3,
        "text": "Promethazine"
      },
      {
        "id": 4,
        "text": "Astemizole"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the given drugs, <strong>astemizole</strong> increases the risk of Torsades de pointes when used concomitantly with erythromycin.\u00a0</p>\n<p>Drugs that <strong>block potassium channels</strong> and prolong <strong>QT increase arrhythmogenic</strong> potential. Astemizole is a <strong>second-generation antihistamine</strong> that <strong>blocks</strong> delayed potassium channels and prolongs the QT interval.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Doxylamine</strong> is an <strong>antihistamine</strong> commonly used as a <strong>short-term treatment</strong> for <strong>insomnia.</strong> It is combined with pyridoxine (vitamin B6) to treat nausea and vomiting during pregnancy (morning sickness). It does <strong>not</strong> prolong the QT interval.</p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option B: <strong>Loratadine</strong> is a <strong>second-generation</strong> antihistamine used to treat allergic rhinitis (hay fever) and urticaria (hives). It is known for being non-sedating due to its minimal penetration into the central nervous system. It does <strong>not</strong> prolong the QT interval.</span></p>\n<p>Option C: <strong>Promethazine</strong> is a <strong>first-generation</strong> antihistamine with multiple uses, including the treatment of allergies, motion sickness, nausea and vomiting, and as a sedative or sleep aid. It also has antiemetic properties and is sometimes used in the management of <strong>postoperative nausea</strong> and <strong>vomiting.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child was started on ciclesonide inhalational therapy for bronchial asthma. Which of the following statements is incorrect regarding his treatment?",
    "choices": [
      {
        "id": 1,
        "text": "It has fewer side effects compared to other inhalational steroids"
      },
      {
        "id": 2,
        "text": "It is a prodrug metabolised by bronchial esterase"
      },
      {
        "id": 3,
        "text": "The occurence of oral candidiasis is more compared to other inhaled steroids"
      },
      {
        "id": 4,
        "text": "Oral bioavailability is negligible"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The incorrect statement is option C as <strong>ciclesonide</strong> has a <strong>lower risk</strong> of <strong>oral candidiasis</strong> as compared to <strong>other inhaled steroids</strong>.</p>\n<p><strong>Ciclesonide</strong> is an <strong>inhaled corticosteroid</strong> that is unique because it is a <strong>prodrug.</strong> It is metabolised by <strong>bronchial esterases</strong> in the <strong>lungs</strong> to its active form, which allows for <strong>targeted action</strong> within the <strong>airways.</strong> This feature <strong>reduces</strong> <strong>systemic side effects</strong> and the risk of <strong>local side effects,</strong> such as <strong>oral candidiasis</strong> (thrush), compared to other inhaled steroids.</p>\n<p>Other options:</p>\n<p>Option A: Ciclesonide's activation in the lungs minimises systemic absorption, leading to fewer side effects.</p>\n<p>Option B: Ciclesonide is inactive until it is converted to its active form in the lungs.</p>\n<p>Option D: Due to its prodrug nature and metabolism in the lungs, ciclesonide has low oral bioavailability, reducing systemic exposure.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient diagnosed with hypertriglyceridemia was started on a medication, following which, he developed flushing, hyperglycemia, and elevated liver enzymes. Identify the drug consumed by the patient.",
    "choices": [
      {
        "id": 1,
        "text": "Nicotinamide"
      },
      {
        "id": 2,
        "text": "Rosuvastatin"
      },
      {
        "id": 3,
        "text": "Ezetemibe"
      },
      {
        "id": 4,
        "text": "Fenofibrate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The drug most likely responsible for causing <strong>flushing, hyperglycemia,</strong> and elevated liver enzymes in a patient being treated for <strong>hypertriglyceridemia</strong> is <strong>Nicotinamide</strong> (Niacin).\u00a0</p>\n<p>Niacin (nicotinic acid), is commonly used to treat hypertriglyceridemia and hypercholesterolemia. However, it is associated with side effects such as <strong>flushing,</strong> which is due to <strong>prostaglandin-mediated vasodilation.</strong> Niacin can also lead to <strong>hyperglycemia</strong> by <strong>impairing insulin sensitivity</strong> and may cause <strong>elevated liver enzymes,</strong> indicating <strong>potential hepatotoxicity.</strong>\u00a0</p>\n<p>Other options:\u00a0</p>\n<p>Option B: <strong>Rosuvastatin</strong> is a statin, primarily used to lower <strong>LDL</strong> cholesterol, and while it may elevate liver enzymes, it is less commonly associated with flushing and hyperglycemia. It can cause <strong>myopathy</strong> in patients.\u00a0</p>\n<p>Option C: <strong>Ezetimibe</strong> inhibits <strong>cholesterol absorption</strong> in the intestines and is not typically associated with these side effects.</p>\n<p>Option D: <strong>Fenofibrate</strong> is used to lower <strong>triglycerides</strong> can elevate <strong>liver enzymes</strong> and can increase the risk of developing myopathy if used concomitantly with statins, but it does not commonly cause flushing or hyperglycemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following reasons best explains the combination of Atropine (0.025 mg) and Diphenoxylate (2.5 mg) for treating secretory diarrhoea?",
    "choices": [
      {
        "id": 1,
        "text": "Atropine potentiates the action of smooth muscle relaxation"
      },
      {
        "id": 2,
        "text": "It prevents overdose and abuse of Diphenoxylate"
      },
      {
        "id": 3,
        "text": "It antagonizes the side effect of Diphenoxylate"
      },
      {
        "id": 4,
        "text": "Atropine increases the antimotility action of diphenoxylate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Atropine</strong> is included in combination with <strong>diphenoxylate</strong> to prevent <strong>abuse</strong> and <strong>overdose</strong> of diphenoxylate.\u00a0</p>\n<p><strong>Diphenoxylate</strong> is structurally similar to <strong>opioids</strong> and has the <strong>potential</strong> for <strong>misuse</strong> at <strong>higher doses.</strong> Additionally, it crosses the <strong>blood-brain</strong> barrier, making it more likely to cause dependence. The anticholinergic effects of atropine (e.g., dry mouth, tachycardia, blurred vision) become prominent at <strong>higher doses,</strong> discouraging overdose.</p>\n<p><strong>Diphenoxylate</strong> is an opioid agonist primarily used as an <strong>antidiarrheal</strong> agent. It works by slowing down <strong>intestinal motility,</strong> allowing more time for water and <strong>electrolytes</strong> to be absorbed from the intestines, which helps <strong>reduce diarrhea.</strong> However, because of its structural similarity to opioids, diphenoxylate has the potential for abuse and dependence if taken in large doses.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A hypertensive patient is started on a drug to control his BP. He had complaints of dry mouth, drowsiness, and confusion after taking this drug, but he still continued to take the drug for 1 year. He had to travel abroad for work, and he forgot to take his medications. He now presents with a blood pressure of 200/120mmHg. Identify the drug he was on?",
    "choices": [
      {
        "id": 1,
        "text": "Amlodipine"
      },
      {
        "id": 2,
        "text": "Atenolol"
      },
      {
        "id": 3,
        "text": "Clonidine"
      },
      {
        "id": 4,
        "text": "Enalapril"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> adverse effects</strong> seen in this patient and the presentation of <strong>rebound hypertension</strong> on <strong>sudden drug withdrawal</strong> indicate that the drug is <strong>clonidine</strong>.\u00a0</p>\n<p>Clonidine is an\u00a0<strong>alpha-2 receptor agonist</strong> and a\u00a0centrally-acting <strong>antihypertensive</strong> agent.\u00a0It treats high blood pressure by stimulating <strong>presynaptic \u03b1<sub>2</sub> receptors</strong> in the vasomotor center in the brainstem. This binding has a <strong>sympatholytic</strong> <strong>effect</strong>, by <strong>suppressing </strong>the release of <strong>norepinephrine</strong> and other sympathomimetics.</p>\n<p>Abrupt withdrawal after long-term therapy can result in <strong>rebound hypertension,\u00a0</strong>restlessness, and sympathetic overactivity.\u00a0<strong>Dry mouth</strong> and <strong>sedation</strong> are the major side effects of clonidine. It can also cause <strong>impotency</strong> and <strong>constipation. Rebound hypertension </strong>is a potentially serious complication and occurs<strong>\u00a0</strong>if the drug is <strong>missed</strong> for<strong> 1\u20132 days</strong>. This is associated with an<strong> alarming rise </strong>in <strong>blood pressure </strong>which may be <strong>more</strong> than the<strong> pretreatment level.</strong></p>\n<div class=\"page\" title=\"Page 171\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Phentolamine</strong> is used for the control of hypertension due to clonidine withdrawal.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which phase of clinical trials is drug dosing done?",
    "choices": [
      {
        "id": 1,
        "text": "Phase I"
      },
      {
        "id": 2,
        "text": "Phase II"
      },
      {
        "id": 3,
        "text": "Phase III"
      },
      {
        "id": 4,
        "text": "Phase IV"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>dosing</strong>\u00a0of a new drug is tested in <strong>phase I </strong>of a clinical trial.</p>\n<p>Phase I trials are usually performed on<strong> healthy volunteers </strong>to check the<strong> safety </strong>and <strong>pharmacokinetic properties </strong>of a drug. The participants in this phase\u00a0do not gain any direct health benefits from taking part. They are generally <strong>paid a fee </strong>for their time, with the payments being regulated and not related to the risk involved.</p>\n<p>In clinical trials, <strong>drug dosing</strong> typically occurs in Phase I, where researchers establish the <strong>optimal dose</strong> to achieve desired effects while <strong>minimizing side effects</strong>. In these phases, they focus on s<strong>afety, tolerability,</strong> and <strong>pharmacokinetics</strong>.</p>\n<p><strong>Dose-ranging</strong>, primarily conducted in <strong>Phase II trials</strong>, involves <strong>testing multiple doses</strong> to identify the <strong>most effective</strong> and <strong>safe dose range</strong>. This phase helps determine the <strong>minimum effective dose</strong> and<strong> maximum tolerated dose</strong>, providing critical data for subsequent studies in Phase 3, where the chosen dose is tested for efficacy and safety in a larger population.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with a gynecological malignancy is started on Methotrexate. Later she develops oral and gastric ulcers. Which nucleotide synthesis is affected in her?",
    "choices": [
      {
        "id": 1,
        "text": "UDP"
      },
      {
        "id": 2,
        "text": "CTP"
      },
      {
        "id": 3,
        "text": "TMP"
      },
      {
        "id": 4,
        "text": "GMP"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>TMP synthesis </strong>is\u00a0<strong>affected </strong>due to<strong> methotrexate.\u00a0</strong></p>\n<p><strong>Methotrexate</strong> inhibits <strong>dihydrofolate reductase</strong> (DHFR), which is required to <strong>synthesize tetrahydrofolate. Tetrahydrofolate</strong> is essential for converting <strong>dUMP</strong> to <strong>dTMP</strong> (thymidine monophosphate) in the <strong>nucleotide synthesis</strong> pathway. Therefore, the <strong>nucleotide synthesis</strong> affected in this patient is <strong>TMP (thymidine monophosphate).</strong></p>\n<p>By inhibiting DHFR, methotrexate <strong>reduces</strong> the <strong>availability</strong> of <strong>THF,</strong> thereby disrupting the production of <strong>thymidylate</strong> (TMP), which is necessary for <strong>DNA replication</strong> and <strong>repair.</strong> This disruption leads to <strong>impaired DNA synthesis</strong> in rapidly dividing cells, such as cancer cells. However, it also affects other rapidly dividing cells, including those in the <strong>gastrointestinal</strong> tract and <strong>oral mucosa,</strong> leading to <strong>side effects</strong> like <strong>oral</strong> and <strong>gastric ulcers.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d865b671317e4be1a17a74242c10f2d4x1280x1905.JPEG"
    ]
  },
  {
    "text": "The drug 'X' is a GHRH analogue that is FDA-approved for the treatment of HIV-associated lipodystrophy and not used for Growth hormone deficiency. Identify the drug 'X'.",
    "choices": [
      {
        "id": 1,
        "text": "Octreotide"
      },
      {
        "id": 2,
        "text": "Somatropin"
      },
      {
        "id": 3,
        "text": "Tesamorelin"
      },
      {
        "id": 4,
        "text": "Mecasermin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Tesamorelin</strong> is approved for use in <strong>HIV-associated lipodystrophy</strong> but <strong>not</strong> for <strong>GH deficiency</strong>. It is a<strong> synthetic N-terminal modified </strong>form of human GHRH<strong>.</strong> It does not get degraded by dipeptidyl peptidase 4 and therefore has a longer duration of action.</p>\n<p>It increases the levels of growth hormone (GH) and insulin-like growth factor (IGF-1) but reduces visceral fat accumulation.</p>\n<p>Tesamorelin is approved for use in HIV-associated lipodystrophy but <strong>not</strong> for <strong>GH</strong>\u00a0<strong>deficiency.</strong>\u00a0</p>\n<p>Other options:</p>\n<p>Option A: <strong>Octreotide\u00a0</strong>is a <strong>somatostatin analogue</strong> that decreases growth hormone levels. It is used in the treatment of <strong>acromegaly</strong>, <strong>variceal bleeding,</strong> diarrhoea due to adenomas secreting VIP (vasoactive intestinal peptide), and <strong>sulfonylurea toxicity.</strong> One of its adverse effects is <strong>gallstone</strong> formation.</p>\n<p>Option B: <strong>Somatropin\u00a0</strong>is a <strong>growth hormone analogue</strong>. It is used in growth hormone deficiency and other short-stature conditions like Turner's syndrome, Noonan syndrome, and Prader-Willi syndrome. Their use is contraindicated in acute critical illness, active malignancy, and proliferative retinopathy.</p>\n<p>Option D: <strong>Mecasermin\u00a0</strong>is a <strong>recombinant human IGF-1</strong>. It is used in IGF-1 deficiency, growth hormone receptor defects, and antibodies against growth hormone receptors. Adverse effects include <strong>hypoglycemia</strong> and <strong>lipohypertrophy</strong>. Another recombinant human IGF-1 with its IGFBP-3, <strong>mecasermin rinfabate</strong> has been FDA-approved for <strong>HIV-associated adipose redistribution syndrome</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '060 Pharmacology Neet 2024';
        let hierarchy = ["Marrow", "PYQs", "Pharmacology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>