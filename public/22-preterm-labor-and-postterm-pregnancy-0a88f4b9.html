<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>22 Preterm Labor And Postterm Pregnancy - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Obstetrics & Gynecology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">24</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Preterm labour is defined as when the labour starts before _____",
    "choices": [
      {
        "id": 1,
        "text": "35 weeks"
      },
      {
        "id": 2,
        "text": "36 weeks"
      },
      {
        "id": 3,
        "text": "37 weeks"
      },
      {
        "id": 4,
        "text": "38 weeks"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Preterm labour</strong> is defined as when labour starts before<strong> 37 completed weeks </strong>(&lt;259 days) counting from the first day of the last menstrual period.</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Timing of delivery</strong></td>\n<td><strong>Terminology</strong></td>\n</tr>\n<tr>\n<td>&lt;33 weeks</td>\n<td>Early preterm</td>\n</tr>\n<tr>\n<td>34&nbsp;to 36 weeks</td>\n<td>Late preterm</td>\n</tr>\n<tr>\n<td>37<sup>&nbsp;</sup>to 38 weeks</td>\n<td>Early term</td>\n</tr>\n<tr>\n<td>39&nbsp;to 40 weeks</td>\n<td>Full term</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a risk factor for preterm labour?",
    "choices": [
      {
        "id": 1,
        "text": "Pregnancy following artificial reproductive technique"
      },
      {
        "id": 2,
        "text": "Asymptomatic bacteriuria"
      },
      {
        "id": 3,
        "text": "Periodontal disease"
      },
      {
        "id": 4,
        "text": "Progesterone intake"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Progesterone intake</strong> is not a risk factor for preterm labour. Progesterone is used for <strong>prophylaxis</strong> of <strong>preterm labour</strong>.</p>\n<p><strong>Risk factors</strong> for preterm labour:</p>\n<ul>\n<li><strong>Maternal</strong> <strong>history -</strong>\n<ul>\n<li>Previous history of spontaneous abortion or preterm delivery</li>\n<li>Artificial reproductive technique</li>\n<li>Asymptomatic bacteriuria or recurrent UTI</li>\n<li>Smoking</li>\n<li>Maternal stress</li>\n</ul>\n</li>\n<li><strong>Pregnancy</strong> <strong>complications -</strong>\n<ul>\n<li>Pre-eclampsia</li>\n<li>Antepartum haemorrhage</li>\n<li>PROM</li>\n<li>Overdistended uterus - polyhydramnios, multiple pregnancy</li>\n<li>Cervical incompetence</li>\n<li>Uterine malformations</li>\n<li>Intrauterine death</li>\n</ul>\n</li>\n<li><strong>Maternal chronic diseases -</strong>\n<ul>\n<li>Hypertension</li>\n<li>Nephritis</li>\n<li>Diabetes</li>\n<li>Severe anaemia</li>\n<li>Periodontal diseases</li>\n</ul>\n</li>\n</ul>\n<p>Option A: <strong>Multifetal pregnancies</strong> are common following <strong>artificial reproductive techniques</strong> and can be associated with <strong>preterm labour</strong>.</p>\n<p>Option B: Asymptomatic bacteriuria or bacterial vaginosis can cause spontaneous preterm labour.</p>\n<p>Option C: <strong>Chronic diseases</strong> like periodontal disease increase the risk of <strong>preterm labour</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Late preterm births include births between _____.",
    "choices": [
      {
        "id": 1,
        "text": "30-32 weeks"
      },
      {
        "id": 2,
        "text": "32-34 weeks"
      },
      {
        "id": 3,
        "text": "34-36 weeks"
      },
      {
        "id": 4,
        "text": "36-38 weeks"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Late preterm</strong> births include births between <strong>34 to 36 weeks </strong>of gestational age.</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Timing of delivery</strong></td>\n<td><strong>Terminology</strong></td>\n</tr>\n<tr>\n<td>&lt;33 weeks</td>\n<td>Early preterm</td>\n</tr>\n<tr>\n<td>34 to 36 weeks</td>\n<td>Late preterm</td>\n</tr>\n<tr>\n<td>37 to 38 weeks</td>\n<td>Early term</td>\n</tr>\n<tr>\n<td>39 to 40 weeks</td>\n<td>Full term</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 31-year-old G3P2 woman presents at 29 weeks of gestation with a blood-tinged vaginal discharge. She is suspected to have preterm labour. Which of the following findings will not help confirm her diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Bishop score of 5"
      },
      {
        "id": 2,
        "text": "Cervical dilatation of 24 mm"
      },
      {
        "id": 3,
        "text": "Cervical length of 32 mm"
      },
      {
        "id": 4,
        "text": "Fetal fibronectin > 50ng/ml"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A cervical length of 32 mm (3 cm) does not help in confirming <strong>preterm labour</strong> as it<span data-preserver-spaces=\"true\">&nbsp;is highly unlikely when the cervical length is &gt;3 cm. The <strong>length</strong> of the <strong>cervix</strong> in preterm labour, as measured in transvaginal ultrasound is&nbsp;<strong>&le;2.5 cm</strong>.</span></p>\n<p><span data-preserver-spaces=\"true\">Preterm labor is the onset of labor before 37 completed weeks of pregnancy (less than 259 days of gestation).</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Features</span></strong><span data-preserver-spaces=\"true\">&nbsp;of preterm labor:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Uterus - regular&nbsp;<strong>contractions</strong> at least one in <strong>every 10 minutes</strong>, with/without pain&nbsp;</span></li>\n<li>Cervix - <strong>dilatation &gt;2 cm</strong><span data-preserver-spaces=\"true\">&nbsp;and <strong>effacement &gt;80%</strong>&nbsp;</span></li>\n<li><span data-preserver-spaces=\"true\">TVS - length of <strong>cervix &lt;2.5 cm</strong> and <strong>funneling</strong> of the internal os <strong>&gt;1 cm</strong></span></li>\n<li><span data-preserver-spaces=\"true\">Pelvic pressure, backache, vaginal discharge or bleeding PV</span></li>\n</ul>\n<p><strong><span data-preserver-spaces=\"true\">Predictors</span></strong><span data-preserver-spaces=\"true\">&nbsp;of preterm labor:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\"><strong>Clinical</strong> predictors:</span>\n<ul>\n<li><span data-preserver-spaces=\"true\">History of prior preterm birth</span></li>\n<li><span data-preserver-spaces=\"true\">Multiple pregnancies</span></li>\n<li><span data-preserver-spaces=\"true\">Presence of genital tract infection</span></li>\n<li><span data-preserver-spaces=\"true\">Symptoms of preterm labour</span></li>\n</ul>\n</li>\n<li><strong>Biophysical</strong> predictors:\n<ul>\n<li><span data-preserver-spaces=\"true\">Uterine contractions &ge;4/hour</span></li>\n<li><strong>Bishop score &ge;4</strong></li>\n<li><span data-preserver-spaces=\"true\">Cervical length (TVS) &le;25 mm</span></li>\n</ul>\n</li>\n<li><span data-preserver-spaces=\"true\"><strong>Biochemical</strong> predictors:</span>\n<ul>\n<li><span data-preserver-spaces=\"true\"><strong>Fetal fibronectin</strong> (fFN) in cervical/vaginal discharge <strong>&gt;50 ng/mL</strong></span></li>\n<li><span data-preserver-spaces=\"true\">Increased levels of IL-6, IL-8, TNF-alpha</span></li>\n</ul>\n</li>\n</ul>\n<p>The <strong>best predictors</strong> of preterm labor in a woman with a previous history of preterm birth are&nbsp;<strong>fetal fibronectin</strong> &gt;50ng/ml and <strong>cervical length</strong> &lt;2.5cm on TVS.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following cannot be used to predict preterm labour in a patient having irregular uterine contractions at 30 weeks of gestation?",
    "choices": [
      {
        "id": 1,
        "text": "IL-6"
      },
      {
        "id": 2,
        "text": "TNF alpha"
      },
      {
        "id": 3,
        "text": "Fetal fibronectin"
      },
      {
        "id": 4,
        "text": "IL-2"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>IL-2 is not a biochemical predictor of preterm labour.</p>\n<p><strong>Biochemical predictors</strong> of preterm labor:</p>\n<ul>\n<li>Fetal fibronectin</li>\n<li>IL 6</li>\n<li>IL 8</li>\n<li>TNF&alpha;</li>\n</ul>\n<p class=\"p1\"><strong>Investigations</strong> of preterm labour:&nbsp;</p>\n<ul>\n<li class=\"p1\">Fetal fibronectin &gt;50 ng/ml</li>\n<li class=\"p1\">TVS - length of cervix&nbsp;&le;2.5 cm</li>\n<li class=\"p1\">Urine culture</li>\n<li class=\"p1\">High vaginal swab</li>\n<li class=\"p1\">Maternal salivary estriol</li>\n<li class=\"p1\">Uterine activity monitoring</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old G2P1L0 woman came for a routine antenatal checkup at 20 weeks of gestation. She is worried about preterm labour as her previous baby was born preterm. What will be the timing and cut-off limit for fetal fibronectin (fFN) assay to predict this condition?",
    "choices": [
      {
        "id": 1,
        "text": ">34 weeks, fFN >15 ng/mL"
      },
      {
        "id": 2,
        "text": "<37 weeks, fFN >1.5 ng/mL"
      },
      {
        "id": 3,
        "text": "20-24 weeks, fFN >5 ng/mL"
      },
      {
        "id": 4,
        "text": "24-34 weeks, fFN >50 ng/mL"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Fetal fibronectin</strong>&nbsp;value of&nbsp;<strong>&gt;50 ng/mL</strong>&nbsp;in the cervicovaginal discharge between <strong>24 and 34 weeks</strong> is predictive of <strong>preterm labor.&nbsp;</strong></p>\n<p>Fibronectin is a <strong>glycoprotein</strong> that binds the <strong>fetal membranes</strong> to the <strong>decidua</strong>. &nbsp;It is <strong>normally found</strong> in the cervicovaginal discharge <strong>before 22 weeks</strong> and <strong>after 37 weeks</strong> of gestation.&nbsp;</p>\n<p>It&nbsp;is measured using an enzyme-linked immunosorbent assay.&nbsp;When the test is <strong>negative</strong>, it reassures that the <strong>delivery</strong> will <strong>not</strong> occur <strong>within the next 7 days.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A pregnant woman presented with blood-tinged vaginal discharge at 35 weeks of gestation. A nitrazine paper test was performed on her. What is this test used to detect?",
    "choices": [
      {
        "id": 1,
        "text": "Fetal hemoglobin in vasa previa"
      },
      {
        "id": 2,
        "text": "Fetal blood cells in Rh isoimmunisation"
      },
      {
        "id": 3,
        "text": "Premature rupture of membranes"
      },
      {
        "id": 4,
        "text": "Abruptio placenta"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option A: <strong>Fetal hemoglobin</strong> in vasa previa is detected by&nbsp;<strong>Apt</strong> <strong>test.</strong></p>\n<p>Option B:&nbsp;Estimation of the volume of <strong>fetal blood entering</strong> the <strong>maternal circulation</strong> in Rh isoimmunisation is done by&nbsp;<strong>Kleihauer-Betke</strong> test.</p>\n<p>Option D: In <strong>abruptio</strong> placenta, the <strong>diagnosis</strong> is mainly based on&nbsp;<strong>clinical </strong>features.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/69fd9002b0184523b032a970c2dd4253x641x483.JPEG"
    ]
  },
  {
    "text": "A sample of the vaginal fluid from the posterior fornix of a patient gave a positive nitrazine paper test. Which of the following conditions does not give a false positive result?",
    "choices": [
      {
        "id": 1,
        "text": "Abruptio placenta"
      },
      {
        "id": 2,
        "text": "Recent sexual intercourse"
      },
      {
        "id": 3,
        "text": "Bacterial vaginosis"
      },
      {
        "id": 4,
        "text": "Oligohydramnios"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Oligohydramnios</strong> shows&nbsp;a <strong>false negative</strong> nitrazine paper test.</p>\n<p><strong>Nitrazine paper</strong> test<strong> detects</strong> the <strong>pH</strong> of the secretions from the vaginal pool. It turns <strong>blue</strong> at <strong>pH &gt;6.&nbsp;</strong>Amniotic fluid is slightly alkaline with a pH of 7.1 - 7.3 and vaginal secretions have a pH of 4.5 - 6.0.</p>\n<p><strong>False-positive</strong> nitrazine test can be seen in contamination of the discharge with <strong>blood, semen,</strong> and <strong>bacterial infections</strong>. <strong>False-negative</strong> nitrazine test can be seen in the case of <strong>scanty amniotic fluid</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Transvaginal sonography in a case of clinically suspected preterm labour revealed a short cervix and funnelling of the internal os. What is the shape of the cervix that is likely to be seen here?",
    "choices": [
      {
        "id": 1,
        "text": "U"
      },
      {
        "id": 2,
        "text": "T"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "O"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>U</strong>-<strong>shaped</strong>&nbsp;<strong>cervix</strong> is seen on tranvaginal sonography (TVS) in <strong>preterm</strong> labour.</p>\n<div class=\"page\" title=\"Page 4\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>On TVS, the cervix should be assessed to determine whether <strong>funnelling</strong> (internal os width &gt;5 mm) is present.</p>\n</div>\n</div>\n</div>\n<table>\n<tbody>\n<tr>\n<td>Shape of cervix</td>\n<td>Inference</td>\n</tr>\n<tr>\n<td>T shaped</td>\n<td>Normal</td>\n</tr>\n<tr>\n<td>Y shaped</td>\n<td>Suspicion of preterm labour</td>\n</tr>\n<tr>\n<td>V shaped</td>\n<td>Funneling of internal os</td>\n</tr>\n<tr>\n<td>U shaped</td>\n<td>\n<p>Incompetent os</p>\n<p>Preterm labour</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>The following is a TVS image showing a V-shaped cervix:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/27050d4592e04b31b52628384f73a5adx709x574.GIF"
    ]
  },
  {
    "text": "A multigravida presents with preterm premature rupture of membranes. According to RCOG guidelines, which of the following antibiotics is preferred for her?",
    "choices": [
      {
        "id": 1,
        "text": "Ampicillin"
      },
      {
        "id": 2,
        "text": "Amoxicillin"
      },
      {
        "id": 3,
        "text": "Erythromycin"
      },
      {
        "id": 4,
        "text": "Azithromycin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>According to RCOG guidelines,&nbsp;<strong>erythromycin</strong> is the preferred antibiotic in the case&nbsp;of <strong>PPROM</strong> (preterm premature rupture of membranes).</p>\n<p><strong>Spontaneous rupture</strong> of membranes <strong>before </strong>the onset of<strong> labour</strong> <strong>between 28 to 37 weeks</strong> is called preterm premature rupture of membranes.&nbsp;</p>\n<p>If <strong>PPROM</strong> occurs<strong> between 28 to 34 weeks</strong>, prophylactic antibiotics and <strong>corticosteroids</strong> are given to the patient.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A primigravida at 30 weeks of gestation presents with labour pains but her membranes were intact. You decide to start her on corticosteroids and a tocolytic. Which of the following drugs will not be useful in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Magnesium sulphate"
      },
      {
        "id": 2,
        "text": "Nifedipine"
      },
      {
        "id": 3,
        "text": "Indomethacin"
      },
      {
        "id": 4,
        "text": "Progesterone"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>preterm labour</strong> with intact membranes and progesterone is not used as a tocolytic in these cases.</p>\n<p><strong>Progesterone</strong> can be used for the <strong>prophylaxis</strong> of preterm labour in women with a&nbsp;<strong>previous history</strong> of spontaneous preterm labour.</p>\n<p><strong>Glucocorticoid</strong> therapy is given in <strong>preterm labour</strong> when the period of gestation is <strong>&lt;34 weeks</strong> to <strong>hasten fetal lung maturity.</strong> Short term therapy with <strong>tocolytics</strong> is given in conjunction with steroids for 1-3 days to <strong>delay labour</strong> for at least<strong> 48 hours</strong> or to transfer the patient to a tertiary centre (with NICU).&nbsp;</p>\n<p>Tocolytics that can be given as short term therapy include:</p>\n<ul>\n<li>Terbutaline</li>\n<li>Magnesium sulphate</li>\n<li>Indomethacin</li>\n<li>Nifedipine</li>\n<li>Atosiban</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A primigravida at 32 weeks of gestation was admitted for management of preterm labour. Which of the following tocolytics would be preferred for this?",
    "choices": [
      {
        "id": 1,
        "text": "Nifedipine"
      },
      {
        "id": 2,
        "text": "Glyceryl trinitrate"
      },
      {
        "id": 3,
        "text": "Ritodrine"
      },
      {
        "id": 4,
        "text": "Magnesium sulphate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Nifedipine</strong> is the <strong>preferred</strong> tocolytic as it has <strong>minimum</strong> maternal <strong>side effects</strong>.</p>\n<p class=\"p1\">According to ACOG guidelines, the use of <strong>tocolytics</strong> in preterm labour does not prolong gestation but may <strong>delay delivery upto 48 hours</strong>. Hence, short-term therapy with tocolytics is given for 1-3 days to delay labour for the action of corticosteroid therapy or to transfer the patient to a tertiary centre (with NICU).&nbsp;</p>\n<p class=\"p1\"><strong>Tocolytics used in preterm labour and their side effects:</strong></p>\n<table style=\"height: 240px;\" width=\"950\">\n<tbody>\n<tr>\n<td style=\"width: 309.34375px;\">Tocolytics</td>\n<td style=\"width: 309.34375px;\">Maternal side effects</td>\n<td style=\"width: 309.34375px;\">Fetal/ neonatal side effects</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>Beta-adrenergic agonists:</p>\n<ul>\n<li>Ritodrine</li>\n<li>Terbutaline</li>\n<li>Isoxsuprine</li>\n</ul>\n</td>\n<td style=\"width: 309.34375px;\">\n<p>Headache, palpitations, tachycardia, hypotension, pulmonary edema, cardiac failure, ARDS</p>\n</td>\n<td style=\"width: 309.34375px;\">\n<p>Fetal heart failure, intrauterine death</p>\n<p>Neonatal hypoglycemia, intraventricular haemorrhage</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>Calcium channel blockers:</p>\n<ul>\n<li>Nifedipine</li>\n<li>Nicardipine</li>\n<li>Verapamil</li>\n</ul>\n</td>\n<td style=\"width: 309.34375px;\">Hypotension, headache, flushing, nausea</td>\n<td style=\"width: 309.34375px;\">-</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>Oxytocin antagonists:</p>\n<ul>\n<li>Atosiban</li>\n</ul>\n<p>(not approved for use in India)</p>\n</td>\n<td style=\"width: 309.34375px;\">Nausea, vomiting, chest pain</td>\n<td style=\"width: 309.34375px;\">-</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">Magnesium sulphate</td>\n<td style=\"width: 309.34375px;\">Flushing, perspiration, headache, muscle weakness, respiratory paralysis</td>\n<td style=\"width: 309.34375px;\">Neonatal cardiac arrest, lethargy, hypotonia, respiratory depression</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>COX inhibitors:</p>\n<ul>\n<li>Indomethacin</li>\n<li>Sulindac</li>\n</ul>\n</td>\n<td style=\"width: 309.34375px;\">Heartburn, asthma, GI bleeding, thrombocytopenia, renal injury, platelet dysfunction, oligohydramnios</td>\n<td style=\"width: 309.34375px;\">Constriction of ductus arteriosus, pulmonary hypertension, intrauterine growth restriction</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a contraindication for tocolysis in a patient with preterm labour?",
    "choices": [
      {
        "id": 1,
        "text": "Chorioamnionitis"
      },
      {
        "id": 2,
        "text": "Fetal distress"
      },
      {
        "id": 3,
        "text": "Anencephaly"
      },
      {
        "id": 4,
        "text": "Placenta previa"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Placenta previa</strong> is not a contraindication for tocolysis.&nbsp;In placenta previa, <strong>nifedipine</strong> and <strong>magnesium sulphate</strong>&nbsp;are used as <strong>tocolytics.</strong></p>\n<p><strong>Contraindications</strong> to <strong>tocolysis</strong>:</p>\n<ul>\n<li><strong>Chorioamnionitis</strong></li>\n<li>Preeclampsia/Eclampsia</li>\n<li>Advanced labour</li>\n<li><strong>Fetal distress</strong></li>\n<li>Intra-uterine death</li>\n<li><strong>Congenital anomalies</strong> not compatible with life</li>\n<li>Pregnancy &gt;34 weeks</li>\n<li>Abruptio placenta</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A G3P1A1 woman presents with preterm labour at 27 weeks of gestation. She tells you that her previous child who was born preterm developed cerebral palsy. Which of the following drugs can you use to reduce the incidence of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Terbutaline"
      },
      {
        "id": 2,
        "text": "Atosiban"
      },
      {
        "id": 3,
        "text": "Magnesium sulphate"
      },
      {
        "id": 4,
        "text": "Nifedipine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Magnesium sulphate</strong>&nbsp;has a&nbsp;<strong>neuroprotective</strong> effect and hence decreases the risk of developing cerebral palsy.</p>\n<p>Magnesium sulphate can be used for neuroprotection in <strong>preterm labour</strong> when the pregnancy is <strong>&lt;32 weeks</strong>. The dose is<strong> 4 g IV over 20</strong>&nbsp;<strong>mins</strong> followed by an<strong> infusion of 1 g/hr</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A primigravida was administered tocolytics and corticosteroids for preterm labour. The following day, she suddenly started coughing and gasping for air. On examination, her BP was 160/100 mmHg and SpO2 was 80% in room air. Which of the following drugs could have caused this?",
    "choices": [
      {
        "id": 1,
        "text": "Atosiban"
      },
      {
        "id": 2,
        "text": "Dexamethasone"
      },
      {
        "id": 3,
        "text": "Indomethacin"
      },
      {
        "id": 4,
        "text": "Ritodrine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>acute pulmonary edema</strong> which is a side effect of the tocolytic&nbsp;<strong>ritodrine</strong>.</p>\n<p>Acute pulmonary edema in pregnancy can be due to:</p>\n<ul>\n<li>Non-cardiogenic&nbsp;causes -\n<ul>\n<li>Pre-eclampsia</li>\n<li>Acute haemorrhage</li>\n<li>Sepsis</li>\n<li>Tocolysis with ritodrine and magnesium sulphate</li>\n<li>Vigorous IV fluid therapy</li>\n</ul>\n</li>\n<li>Cardiogenic causes</li>\n</ul>\n<p class=\"p1\"><strong>Tocolytics used in preterm labour and their side effects:</strong></p>\n<table style=\"height: 240px;\" width=\"950\">\n<tbody>\n<tr>\n<td style=\"width: 309.34375px;\"><strong>Tocolytics</strong></td>\n<td style=\"width: 309.34375px;\"><strong>Maternal side effects</strong></td>\n<td style=\"width: 309.34375px;\"><strong>Fetal/ neonatal side effects</strong></td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>Beta-adrenergic agonists:</p>\n<ul>\n<li>Ritodrine</li>\n<li>Terbutaline</li>\n<li>Isoxsuprine</li>\n</ul>\n</td>\n<td style=\"width: 309.34375px;\">\n<p>Headache, palpitations, tachycardia, hypotension, pulmonary edema, cardiac failure, ARDS</p>\n</td>\n<td style=\"width: 309.34375px;\">\n<p>Fetal heart failure, intrauterine death</p>\n<p>Neonatal hypoglycemia, intraventricular haemorrhage</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>Calcium channel blockers:</p>\n<ul>\n<li>Nifedipine</li>\n<li>Nicardipine</li>\n<li>Verapamil</li>\n</ul>\n</td>\n<td style=\"width: 309.34375px;\">Hypotension, headache, flushing, nausea</td>\n<td style=\"width: 309.34375px;\">-</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>Oxytocin antagonists:</p>\n<ul>\n<li>Atosiban</li>\n</ul>\n<p>(not approved for use in India)</p>\n</td>\n<td style=\"width: 309.34375px;\">Nausea, vomiting, chest pain</td>\n<td style=\"width: 309.34375px;\">-</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">Magnesium sulphate</td>\n<td style=\"width: 309.34375px;\">Flushing, perspiration, headache, muscle weakness, respiratory paralysis</td>\n<td style=\"width: 309.34375px;\">Neonatal cardiac arrest, lethargy, hypotonia, respiratory depression</td>\n</tr>\n<tr>\n<td style=\"width: 309.34375px;\">\n<p>COX inhibitors:</p>\n<ul>\n<li>Indomethacin</li>\n<li>Sulindac</li>\n</ul>\n</td>\n<td style=\"width: 309.34375px;\">Heartburn, asthma, GI bleeding, thrombocytopenia, renal injury, platelet dysfunction, oligohydramnios</td>\n<td style=\"width: 309.34375px;\">Constriction of ductus arteriosus, pulmonary hypertension, intrauterine growth retardation</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following tocolytics can cause multiple fractures in the fetus if given for a prolonged duration?",
    "choices": [
      {
        "id": 1,
        "text": "Atosiban"
      },
      {
        "id": 2,
        "text": "Magnesium sulphate"
      },
      {
        "id": 3,
        "text": "Nifedipine"
      },
      {
        "id": 4,
        "text": "Nitric oxide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Magnesium sulphate</strong> can cause <strong>multiple fractures</strong> and <strong>hypocalcemia</strong> in a preterm baby.</p>\n<p>The FDA warned against prolonged use of magnesium sulphate&nbsp;to arrest preterm labour. The <strong>antagonistic effect</strong> of magnesium <strong>lowers</strong> the <strong>calcium</strong> levels in the fetus. This causes&nbsp;bone thinning and fractures in fetuses <strong>exposed</strong> to the drug for <strong>more than 5 to 7 days</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Post-term pregnancy refers to pregnancy continuing beyond ______.",
    "choices": [
      {
        "id": 1,
        "text": "41 weeks of gestation"
      },
      {
        "id": 2,
        "text": "42 weeks of gestation"
      },
      {
        "id": 3,
        "text": "44 weeks of gestation"
      },
      {
        "id": 4,
        "text": "40 weeks of gestation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>ACOG defines&nbsp;<strong>post-term</strong> pregnancy as a pregnancy continuing<strong> beyond</strong>&nbsp;<strong>42 completed weeks</strong> of gestation.</p>\n<p>For clinical purposes, a pregnancy continuing <strong>beyond 2 weeks </strong>of the<strong> expected date of delivery</strong> (&gt; 294 days) is called a post-term pregnancy.</p>\n<p><strong>Inaccurate LMP</strong> is the <strong>most common cause</strong> of misdiagnosis of post-term pregnancy. Hence, early ultrasound dating is important to determine fetal gestational age.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman presented for an antenatal checkup 2 weeks past her EDD. Which of the following is not an etiological factor for her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Anencephaly"
      },
      {
        "id": 2,
        "text": "Sedentary habit"
      },
      {
        "id": 3,
        "text": "Primiparity"
      },
      {
        "id": 4,
        "text": "Maternal stress"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Maternal stress</strong> is associated with&nbsp;<strong>preterm</strong> <strong>labour</strong>, not post-term pregnancy.</p>\n<p><strong>Etiological</strong> factors of <strong>post-term</strong> pregnancy are:</p>\n<ul>\n<li>Inaccurate LMP</li>\n<li>Heredity</li>\n<li>Primiparity</li>\n<li>Previous prolonged pregnancy</li>\n<li>Sedentary habits</li>\n<li>Elderly multipara</li>\n<li>Anencephaly</li>\n<li>Placental sulphatase deficiency</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You have performed an artificial rupture of membranes in a primigravida for augmentation of labour. You note the amniotic fluid to be saffron-coloured. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Postmaturity"
      },
      {
        "id": 2,
        "text": "Rh incompatibility"
      },
      {
        "id": 3,
        "text": "Intrauterine death"
      },
      {
        "id": 4,
        "text": "Concealed placental abruption"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Saffron</strong>-coloured <strong>amniotic fluid</strong> is seen in <strong>postmaturity</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A newborn baby was found to have wrinkled, patchy skin, a long thin body and long nails. Which of the following could be a cause for his condition?",
    "choices": [
      {
        "id": 1,
        "text": "Placental aromatase deficiency"
      },
      {
        "id": 2,
        "text": "Placental progesterone deficiency"
      },
      {
        "id": 3,
        "text": "Placental pregnenolone deficiency"
      },
      {
        "id": 4,
        "text": "Placental sulphatase deficiency"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>postmaturity</strong> <strong>syndrome</strong>&nbsp;which can occur due to&nbsp;<strong>placental sulphatase</strong> <strong>deficiency</strong>.</p>\n<p><strong>Etiology</strong> of post-term pregnancy:</p>\n<ul>\n<li>Wrong dates - inaccurate LMP (most common)</li>\n<li>Heredity</li>\n<li>Previous prolonged pregnancy</li>\n<li>Anencephaly</li>\n<li>Placental sulphatase deficiency<strong>&nbsp;</strong>(leads to decreased estrogen synthesis)</li>\n<li>Primipara/ elderly multipara</li>\n</ul>\n<p><strong>Features</strong> of <strong>postmaturity syndrome&nbsp;</strong>in a&nbsp;newborn:</p>\n<ul>\n<li>Wrinkled, patchy, peeling skin,&nbsp;particularly prominent on the palms and soles</li>\n<li>Long, thin body suggesting wasting</li>\n<li>Long nails</li>\n<li>Eyes open and unusually&nbsp;alert</li>\n<li>Looks old and worried</li>\n</ul>\n<p>Note:&nbsp;Placental aromatase deficiency causes disorder of sexual development of fetus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A G2P1L1 woman came for a routine ANC at 41 weeks of gestation. On examination, her Bishop score was 2. She was admitted for fetal monitoring and induction. Which of the following complications would you not anticipate in the fetus even if her pregnancy continues further?",
    "choices": [
      {
        "id": 1,
        "text": "Shoulder dystocia"
      },
      {
        "id": 2,
        "text": "Polycythemia"
      },
      {
        "id": 3,
        "text": "Cord compression"
      },
      {
        "id": 4,
        "text": "Hyperglycemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given scenario, the pregnancy continuing further would<strong> cross 42 weeks</strong> of gestation and thus turn into a<strong> post-term pregnancy. Hypoglycemia</strong> is seen in a post-term neonate.</p>\n<p><strong>Complications</strong> <strong>of post-term pregnancy:</strong></p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">During labour:</li>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Fetal hypoxia</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Labour dysfunction</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Macrosomia</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\"><strong>Shoulder dystocia</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Oligohydramnios</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\"><strong>Cord compression</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Birth trauma&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Meconium aspiration</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Intracranial haemorrhage</li>\n</ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Following birth:</li>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Meconium aspiration syndrome</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Hypoxia</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Hypoglycemia</li>\n<li style=\"font-weight: 400;\" aria-level=\"2\"><strong>Polycythemia</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"2\">Neonatal convulsions</li>\n</ul>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A primigravida was admitted at 42 weeks for induction of labour. Which of the following conditions is she not at an increased risk for?",
    "choices": [
      {
        "id": 1,
        "text": "Postpartum hemorrhage"
      },
      {
        "id": 2,
        "text": "Meconium stained liquor"
      },
      {
        "id": 3,
        "text": "Shoulder dystocia"
      },
      {
        "id": 4,
        "text": "Oligohydramnios"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The risk of post-partum haemorrhage does not increase in post-term pregnancy.</p>\n<p><strong>Complications</strong> of <strong>post-term pregnancy</strong> are due to <strong>placental insufficiency</strong>&nbsp;and&nbsp;placental ageing. It manifests as placental infarcts and calcifications.&nbsp;During post-term pregnancy, diminished placental function can cause <strong>oligohydramnios</strong>.&nbsp;</p>\n<p>Complications of post-term pregnancy are:</p>\n<ul>\n<li aria-level=\"1\">During labour:</li>\n<ul>\n<li aria-level=\"2\">Fetal hypoxia</li>\n<li aria-level=\"2\">Labour dysfunction</li>\n<li aria-level=\"2\">Macrosomia</li>\n<li aria-level=\"2\"><strong>Shoulder dystocia</strong></li>\n<li aria-level=\"2\">Oligohydramnios</li>\n<li aria-level=\"2\">Cord compression</li>\n<li aria-level=\"2\">Birth trauma&nbsp;</li>\n<li aria-level=\"2\"><strong>Meconium aspiration</strong></li>\n</ul>\n<li aria-level=\"1\">Following birth:</li>\n<ul>\n<li aria-level=\"2\">Chemical pneumonitis, atelectasis, pulmonary hypertension (due to meconium aspiration)</li>\n<li aria-level=\"2\">Hypoxia</li>\n<li aria-level=\"2\">Hypoglycemia</li>\n<li aria-level=\"2\">Polycythemia</li>\n<li aria-level=\"2\">Neonatal convulsions</li>\n</ul>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The term small for gestational age implies birth weight ______",
    "choices": [
      {
        "id": 1,
        "text": "<10th  percentile"
      },
      {
        "id": 2,
        "text": "<15th   percentile"
      },
      {
        "id": 3,
        "text": "<2.5 kg"
      },
      {
        "id": 4,
        "text": "<2 kg"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Small</strong> for gestational age implies&nbsp;birthweight is&nbsp;<strong>&lt;10th percentile</strong> for gestational age.</p>\n<p>With respect to the <strong>size</strong>, a newborn can be appropriate, small or large for gestational age.</p>\n<table style=\"height: 145px;\" width=\"524\">\n<tbody>\n<tr>\n<td style=\"width: 254px;\"><strong>Birth weight</strong></td>\n<td style=\"width: 254px;\"><strong>Terminology</strong></td>\n</tr>\n<tr>\n<td style=\"width: 254px;\">&lt;10th percentile</td>\n<td style=\"width: 254px;\">Small for gestational age</td>\n</tr>\n<tr>\n<td style=\"width: 254px;\">&gt;90th percentile</td>\n<td style=\"width: 254px;\">Large for gestational age</td>\n</tr>\n<tr>\n<td style=\"width: 254px;\">Between 10th and 90th percentile</td>\n<td style=\"width: 254px;\">Appropriate for gestational age</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the normal pH of amniotic fluid?",
    "choices": [
      {
        "id": 1,
        "text": "8.1 - 8.7"
      },
      {
        "id": 2,
        "text": "7.1 - 7.3"
      },
      {
        "id": 3,
        "text": "6.1 - 6.3"
      },
      {
        "id": 4,
        "text": "6.5 - 6.9"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The normal pH of the amniotic fluid is <strong>7.1 - 7.3</strong></p>\n<p>The normal pH of the vaginal secretions is 4.5 - 5.5. In <strong>premature rupture</strong> of membranes (PROM), the pH of the vaginal secretions becomes<strong> 6 - 6.2</strong>&nbsp;as the amniotic fluid mixes with it. This forms the basis for nitrazine paper test.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '22 Preterm Labor And Postterm Pregnancy';
        let hierarchy = ["Marrow", "qBank", "Obstetrics & Gynecology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>