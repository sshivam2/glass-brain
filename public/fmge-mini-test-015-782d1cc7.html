<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 015 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The middle radioulnar joint is an example of a:",
    "choices": [
      {
        "id": 1,
        "text": "Plane synovial"
      },
      {
        "id": 2,
        "text": "Primary cartilaginous"
      },
      {
        "id": 3,
        "text": "Secondary cartilaginous"
      },
      {
        "id": 4,
        "text": "Fibrous joint"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The middle radioulnar joint is an example of a <strong>fibrous joint (syndesmosis).</strong></p>\n<p>The radius and ulna are united with each other by<strong> three joints:</strong></p>\n<ul>\n<li><strong>Proximal</strong> (superior) radioulnar joint</li>\n<li><strong>Middle</strong> radioulnar joint</li>\n<li><strong>Distal</strong> (inferior) radioulnar joint</li>\n</ul>\n<p><strong>Proximal</strong> and<strong> distal</strong> radioulnar joints are uniaxial <strong>pivot joints</strong> (synovial) and are involved in pronation and supination movements of the forearm.</p>\n<p>The <strong>middle radioulnar</strong> joint is a <strong>fibrous</strong> joint (syndesmosis).&nbsp;The radius and ulna, in the middle, are connected by two syndesmoses namely:</p>\n<ul>\n<li>The <strong>oblique cord </strong>-&nbsp;extends from&nbsp;the lateral side of the ulnar tuberosity to the radius, distal to the radial tuberosity.</li>\n<li><strong>Interosseous membrane</strong>&nbsp;- a broad, thin collagenous structure, which runs perpendicular to the oblique cord. It extends&nbsp;distomedially between the interosseous borders of the radius and ulna.</li>\n</ul>\n<p><strong>Based </strong>on the <strong>structure</strong>, joints are classified into <strong>three types:</strong></p>\n<ul>\n<li><strong>Fibrous joints</strong>\n<ul>\n<li>Sutures</li>\n<li>Syndesmosis</li>\n<li>Gomphosis</li>\n</ul>\n</li>\n<li><strong>Cartilaginous joints</strong>\n<ul>\n<li>Primary cartilaginous joints or synchondrosis</li>\n<li>Secondary cartilaginous joints or symphysis</li>\n</ul>\n</li>\n<li><strong>Synovial joints</strong>\n<ul>\n<li>Ball-and-socket or spheroidal joints</li>\n<li>Sellar or saddle joints</li>\n<li>Condylar or bicondylar joints</li>\n<li>Ellipsoid joints</li>\n<li>Hinge joints</li>\n<li>Pivot or trochoid joints</li>\n<li>Plane joints</li>\n</ul>\n</li>\n</ul>\n<p>The illustration below depicts types of fibrous joints.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0520ea8d41e54729801b5335e98aa751x1280x562.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/931ad3fe7bec4ef19076dcbcf0d2142cx755x900.JPEG"
    ]
  },
  {
    "text": "The maximum amount of air that can be expelled from the lungs after first filling the lungs to their maximum extent and then expiring to the maximum extent is equal to :",
    "choices": [
      {
        "id": 1,
        "text": "Functional residual capacity"
      },
      {
        "id": 2,
        "text": "Total lung capacity"
      },
      {
        "id": 3,
        "text": "Vital capacity"
      },
      {
        "id": 4,
        "text": "Inspiratory capacity"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The maximum amount of air that can be expelled from the lungs after first filling the lungs to their maximum extent and then expiring to the maximum extent is equal to&nbsp;<strong>vital capacity</strong>&nbsp;of lungs.</p>\n<p>It is the sum of inspiratory reserve volume, tidal volume and expiratory reserve volume. It is around 4600 mL.</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Functional residual capacity</strong> is the sum of expiratory reserve volume and residual volume and it is the total amout of air remanining in the lungs after normal expiration. It is about 2300 mL.</p>\n<p>Option B: The <strong>total&nbsp;lung capacity</strong> is the maximum volume to which lungs can be expanded with the greatest effort. It is about 5800 mL and the sum of vital capacity and the residual volume.</p>\n<p>Option D: The <strong>inspiratory capacity </strong>is the maximum amount of air inspired from the end-expiratory level and is about 3500 mL.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/783cb2d1d3b04cdc9ee1a201e2821cbcx799x276.JPEG"
    ]
  },
  {
    "text": "A 17-year-old boy with features of angular stomatitis and a magenta tongue is diagnosed to have a deficiency of a certain water-soluble vitamin. Which of the following vitamins could it be?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B2"
      },
      {
        "id": 2,
        "text": "Vitamin B3"
      },
      {
        "id": 3,
        "text": "Vitamin B6"
      },
      {
        "id": 4,
        "text": "Vitamin E"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The boy is most likely to have a\u00a0<strong>Vitamin B2</strong> / <strong>Riboflavin</strong> deficiency.</p>\n<div class=\"page\" title=\"Page 2356\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Riboflavin is important for the metabolism of fat, carbohydrate, and protein, acting as a respiratory coenzyme and an electron donor. Enzymes that contain flavin adenine dinucleotide (FAD) or flavin mononucleotide (FMN) as prosthetic groups are known as flavoenzymes (e.g., succinic acid dehydrogenase, monoamine oxidase, glutathione reductase). FAD is a cofactor for methyltetrahydrofolate reductase and therefore modulates homocysteine metabolism. The vitamin also plays a role in drug and steroid metabolism, including detoxification reactions.</p>\n<p>The clinical manifestations of riboflavin deficiency are nonspecific; patients with a Vitamin B2 / Thiamine deficiency usually present with features of a magenta-coloured tongue, angular stomatitis, seborrhea, ocular symptoms, corneal vascularization. Risk factors include alcoholism and a poor diet with a low intake of milk products. In addition, corneal vascularization, anaemia, and personality changes have been observed with riboflavin deficiency.</p>\n<div class=\"page\" title=\"Page 2356\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Riboflavin deficiency almost always is due to dietary deficiency. Milk and other dairy products, enriched bread, cereals, meat, fish, eggs, broccoli, and legumes are good sources of riboflavin. It is extremely sensitive to light, and milk should be stored in containers that protect against its photodegradation. Laboratory diagnosis of riboflavin deficiency can be made by determination of red blood cell or urinary riboflavin concentrations or by measurement of erythrocyte glutathione reductase activity.</p>\n<p>Other options:<br /><br />Option B: <strong>Vitamin B3/ Niacin</strong> deficiency leads to pellagra, which is characterised by a pigmented rash in skin exposed areas, bright red tongue, diarrhoea, apathy, memory loss and disorientation.</p>\n<p>Option C: <strong>Vitamin B6/ Pyridoxine</strong> deficiency leads to symptoms such as seborrhea, glossitis, convulsions, neuropathy, depression, confusion and microcytic anaemia.<br /><br />Option D: <strong>Vitamin E</strong> is a fat-soluble vitamin and is not soluble in water. Its deficiency leads to peripheral neuropathy, spinocerebellar ataxia, skeletal muscle atrophy, retinopathy.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-year-old child presents with a history of morning headaches, vomiting, and lethargy for the past 6 months.  MRI scan showed a contrast-enhancing nodule in the cerebellum. Biopsy findings of the tumor are shown in the image. The tumors were positive for glial fibrillary acidic protein. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ependymoma"
      },
      {
        "id": 2,
        "text": "Pilocytic astrocytoma"
      },
      {
        "id": 3,
        "text": "Medulloblastoma"
      },
      {
        "id": 4,
        "text": "Oligodendroglioma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A clinical scenario of a child presenting with symptoms of increased intracranial tension with an image that shows <strong>Rosenthal fibers</strong>&nbsp;are suggestive of&nbsp;<strong>pilocytic astrocytoma</strong>.</p>\n<p><strong>Pilocytic astrocytoma&nbsp;</strong>is a brain tumour that occurs more often in <strong>children</strong> and <strong>young adults.&nbsp;</strong>These tumours are usually&nbsp;<strong>slow-growing </strong>and<strong> benign</strong>. The majority of neoplasms are located in the <strong>cerebellum</strong>. However, they can also appear around the third ventricle, optic nerves, spinal cord, and occasionally in the cerebral hemispheres.</p>\n<p>On<strong> brain</strong>&nbsp;<strong>MRI,&nbsp;</strong>it can be identified as a contrast-enhancing nodule. On microscopy, it has very limited brain invasion compared to infiltrative astrocytomas. The tumour is made up of <strong>bipolar</strong> cells with <strong>hair-like projections</strong> forming a dense fibrillary meshwork<strong>.</strong>&nbsp;These cells are positive for glial fibrillary acidic protein (<strong>GFAP</strong>). The characteristic features of this tumour are the presence of&nbsp;<strong>Rosenthal fibres</strong> and <strong>eosinophilic granular bodies</strong>.&nbsp;A <strong>Rosenthal fibre</strong> is a <strong>corkscrew-shaped eosinophilic</strong> inclusion while&nbsp;<strong>eosinophilic granular bodies&nbsp;</strong>are mulberry-shaped inclusions.</p>\n<p>In low-grade astrocytoma, surgical resection is the primary treatment modality, and in high-grade lesions, local irradiation is also done after surgical correction.</p>\n<p>The below image shows pilocytic astrocytoma with Rosenthal fibers (arrows) and dense fibrillary meshwork.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0ebc4d3587246729b3546c987d2ece4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f310299a9a6f4faea744f8f6a894b59ex600x457.JPEG"
    ]
  },
  {
    "text": "Which of the following parasites may cause deficiency of vitamin B12?",
    "choices": [
      {
        "id": 1,
        "text": "Echinococcus granulosis"
      },
      {
        "id": 2,
        "text": "Diphyllobothrium latum"
      },
      {
        "id": 3,
        "text": "Hymenolepis nana"
      },
      {
        "id": 4,
        "text": "Taenia solium"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Diphyllobothrium latum</strong> causes deficiency of vitamin B12</p>\n<p>The anemia develops because the tapeworm absorbs a large quantity of Vitamin B12 and interferes with its ileal absorption leading to Vitamin B12 deficiency.</p>\n<p>In severe cases, patients may exhibit neurologic sequelae of vitamin B12 deficiency.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old man diagnosed with type-2 diabetes mellitus is being treated with metformin for the last 5 years. The deficiency of which of the following vitamins would be most likely in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin A"
      },
      {
        "id": 2,
        "text": "Vitamin B1"
      },
      {
        "id": 3,
        "text": "Vitamin B12"
      },
      {
        "id": 4,
        "text": "Vitamin B6"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A <strong>vitamin B12 deficiency</strong> is most likely in this patient.</p>\n<div class=\"page\" title=\"Page 1138\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Metformin interferes with the calcium-dependent absorption of vitamin B12-intrinsic factor complex in the terminal ileum. In addition, it is also proposed to cause&nbsp;alterations in small bowel motility which stimulates bacterial overgrowth and consequential vitamin B12 deficiency, competitive inhibition or inactivation of vitamin B12 absorption, alterations in intrinsic factor (IF) levels and interaction with the cubulin endocytic receptor. As a result, vitamin B12 deficiency can occur.</p>\n<p>Decrease in vitamin B12 absorption and levels following metformin use generally begins around the 4<sup>th</sup>&nbsp;month but clinically observable features of vitamin B12 deficiency manifest by 5&ndash;10 years owing to the large body stores in the liver mainly that are not quickly depleted. Additionally, the risk of developing metformin associated vitamin B12 deficiency is greatly influenced by increasing age, metformin dose and duration of use.</p>\n<p>Therefore, periodic screening for vitamin B12 deficiency should be considered, especially in patients with peripheral neuropathy or macrocytic anemia. Also, this&nbsp;effect can be reversed with calcium supplementation.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45 year old iron smelter, presents to the OPD with history of rice water diarrhoea. The image shows the clinical finding that the doctor notes during examination. Which of the following clinical features would be consistent with the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hypothermia"
      },
      {
        "id": 2,
        "text": "Hypopigmentation"
      },
      {
        "id": 3,
        "text": "Hyperphagia"
      },
      {
        "id": 4,
        "text": "Tremors"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shows <strong>transverse white lines </strong>(Leukonychia striata) called <strong>Aldrich Mees Lines </strong>typically seen in&nbsp;<strong>arsenic poisoning.&nbsp;Tremors</strong> are consistent with a diagnosis of <strong>arsenic poisoning</strong> which should be suspected in a patient of with Aldrich Mees lines, red velvety mucosa, and rice water stools.</p>\n<p><strong>Hyper</strong>pyrexia, <strong>Hyper</strong>pigmentation, and <strong>Anorexia</strong> are associated features.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d9eb6b796a2d4e49b573296b737958b1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Where can we find the Thornwaldt's cyst?",
    "choices": [
      {
        "id": 1,
        "text": "Tubal tonsil"
      },
      {
        "id": 2,
        "text": "Adenoid mass"
      },
      {
        "id": 3,
        "text": "Palatine tonsil"
      },
      {
        "id": 4,
        "text": "Lingual tonsil"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Thornwaldt cyst can be found in the midline of the posterior wall of the nasopharynx in the<strong> adenoid mass.</strong></p>\n<ul>\n<li>It is an <strong>epithelial-lined median recess</strong> found within the adenoid mass and extends from <strong>pharyngeal mucosa</strong> to the<strong> periosteum of the basiocciput.</strong></li>\n<li>It represents the<strong> attachment of notochord to the pharyngeal endoderm</strong> during embryonic life.</li>\n<li>When infected, it may be the cause of persistent postnasal discharge or crusting. Sometimes an abscess can form in the bursa <strong>(Thornwaldt&rsquo;s disease</strong>).</li>\n<li>It is managed surgically by marsupialization of the swelling and complete removal of the lining of the cyst.&nbsp; &nbsp;&nbsp;</li>\n</ul>\n<p>The following is the MRI showing a Thornwald cyst.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/692e06e74b0d48e191c8eea918ab3808x452x530.JPEG"
    ]
  },
  {
    "text": "Which of the following is the site of lesion in internuclear ophthalmoplegia?",
    "choices": [
      {
        "id": 1,
        "text": "Medial Longitudinal Fasciculus"
      },
      {
        "id": 2,
        "text": "6th Nerve nucleus"
      },
      {
        "id": 3,
        "text": "Pontine paramedian reticular formation"
      },
      {
        "id": 4,
        "text": "A & C"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p style=\"text-align: left;\">The <strong>site of lesion</strong> in a case of internuclear ophthalmoplegia is <strong>medial longitudinal fasciculus </strong>(MLF).</p>\n<p>The command for left gaze originates from right cerebral cortex and runs to the left paramedian pontine reticular formation (PPRF). An output from the left PPRF runs to the left VI nerve nucleus supplying the left lateral rectus, causing abduction. An output from the left PPRF also goes to the right III nerve nucleus via the right MLF causing right eye adduction.</p>\n<p>Therefore, a<strong> lesion in the right MLF</strong> leads to <strong>failure of the right eye adduction</strong>. The <strong>left eye</strong>, however, <strong>abducts normally</strong>. This is called <strong>internuclear ophthalmoplegia</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c75199c1e184bb6aa97c35b011cfac8x1280x2729.JPEG"
    ]
  },
  {
    "text": "You were posted for screening of deafness in school children under your primary health center. Which type of screening is done in this scenario?",
    "choices": [
      {
        "id": 1,
        "text": "Prospective screening"
      },
      {
        "id": 2,
        "text": "Multiphasic screening"
      },
      {
        "id": 3,
        "text": "Prescriptive screening"
      },
      {
        "id": 4,
        "text": "Selective screening"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The type of<strong> screening\u00a0</strong>done for deafness in school children is prescriptive screening.\u00a0</p>\n<p><strong>Prescriptive screening</strong> is done for <strong>case detection</strong>. People are examined primarily for their <strong>own benefit</strong>. It may lead to the\u00a0<strong>early identification </strong>of\u00a0an <strong>unrecognized disease</strong>.\u00a0Hence, appropriate treatment can be initiated immediately to decline the disease progression.</p>\n<p>Screening\u00a0is initiated by\u00a0medical and public health personnel and is not requested by a patient. Examples of prescriptive screening are:</p>\n<ul>\n<li>Screening of hemolytic disease in newborns</li>\n<li>Screening of infants for phenylketonuria</li>\n<li>Screening of bacteriuria in pregnancy</li>\n</ul>\n<p>Other options:</p>\n<p>Option A -\u00a0<strong>Prospective screening</strong> is done for <strong>disease control</strong>. People are screened for the<strong> benefit</strong> of<strong> others</strong>.\u00a0It may\u00a0lead to an <strong>early</strong> <strong>diagnosis</strong> and permit more effective treatment. It also <strong>reduces</strong>\u00a0the <strong>spread</strong> of infectious diseases in the community. Hence,\u00a0reduces mortality associated with the disease. Examples of prospective screening are:</p>\n<ul>\n<li>Screening of immigrants from infectious diseases such as tuberculosis and syphilis to protect the citizens</li>\n<li>Screening for streptococcal infection to prevent rheumatic fever</li>\n</ul>\n<p>Option B - <strong>Multiphasic screening</strong> is the application of<strong> two or more screening tests</strong> in combination, to a large population at<strong> one time</strong>. It is not cost-effective and has shown no benefit in reducing the morbidity and mortality of the population.</p>\n<p>Option D - <strong>Selective screening</strong> is done in <strong>high-risk groups</strong>. It is one of the most <strong>effective\u00a0</strong>screening tests.</p>\n<p>Example: Screening for diabetes in the other members of a family for a detected diabetes case since these diseases get aggregated in families.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are planning to conduct a randomized control trial to study the effect of an emollient for eczema, you consider two groups of which one group will receive a placebo. You are considering a blinding trial for this to prevent bias. Which among the following is the most frequent blinding that is used to conduct such trials?",
    "choices": [
      {
        "id": 1,
        "text": "Quadruple blinding"
      },
      {
        "id": 2,
        "text": "Single blinding"
      },
      {
        "id": 3,
        "text": "Double blinding"
      },
      {
        "id": 4,
        "text": "Triple blinding"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Although<strong> ideally triple blinding should be used</strong>, <strong>double-blinding</strong> is the <strong>most frequently used method</strong> when blinded-trials are conducted.</p>\n<p>Double blinding trials is where <strong>neither the group members nor the observers are aware</strong> of the group allocation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false regarding the target interventions under National AIDS Control Organisation?",
    "choices": [
      {
        "id": 1,
        "text": "Lubricants are given to  homosexual men"
      },
      {
        "id": 2,
        "text": "Clean needles and syringes are given to injecting drug users"
      },
      {
        "id": 3,
        "text": "Condoms are not given to bridge population"
      },
      {
        "id": 4,
        "text": "Opioid substitution therapy is given to Injecting Drug Users"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Bridge populations <strong>are supplied with condoms</strong> under the NACO target interventions.&nbsp;</p>\n<p><strong>Target interventions:&nbsp;</strong></p>\n<p>General:</p>\n<ul>\n<li>Detection and treatment for sexually transmitted diseases</li>\n<li>Condom distribution</li>\n</ul>\n<p><strong>For injecting drug users:</strong></p>\n<ul>\n<li><strong>Distribution of clean needles and syringes.</strong></li>\n<li>Abscess prevention and management.</li>\n<li>Opioid substitution therapy.</li>\n<li>Linkage with detoxification and rehabilitation services.</li>\n</ul>\n<p><strong>For homosexual men and transgenders:</strong></p>\n<ul>\n<li>Provision of lubricants.</li>\n<li>Provision of project-based clinics for sexually transmitted infections.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common cause of death in patients undergoing blood transfusions?",
    "choices": [
      {
        "id": 1,
        "text": "Febrile non-hemolytic transfusion reaction"
      },
      {
        "id": 2,
        "text": "Acute hemolytic transfusion reaction"
      },
      {
        "id": 3,
        "text": "Delayed hemolytic transfusion reaction"
      },
      {
        "id": 4,
        "text": "Transfusion-related acute lung injury"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Transfusion-related acute lung injury (<strong>TRALI</strong>) is the most common cause of <strong>transfusion-related fatalities</strong>.</p>\n<p>TRALI is due to the presence of <strong>anti-HLA class II antibodies&nbsp;</strong>in the donor plasma. These antibodies&nbsp;bind recipient leukocytes, which aggregate in the pulmonary vasculature and release mediators that increase capillary permeability.&nbsp;<strong>Multiparous women</strong> are frequently&nbsp;implicated donors. Recipients with a history of liver disease, smoking, alcohol use are at a higher risk.</p>\n<p>It&nbsp;occurs within <strong>6 hours</strong> of transfusion and results in <strong>hypoxia</strong> and signs of non-cardiogenic <strong>pulmonary edema</strong> with bilateral interstitial infiltrates on chest X-ray. It is managed with supportive care.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "ABCD2 scoring is used for",
    "choices": [
      {
        "id": 1,
        "text": "Risk of stroke following transient ischemic attack"
      },
      {
        "id": 2,
        "text": "Pulmonary embolism"
      },
      {
        "id": 3,
        "text": "Assessing risk of stroke and for selecting antithrombotic therapy for patients with atrial fibrillation"
      },
      {
        "id": 4,
        "text": "Cardiovascular disease risk assessment"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>ABCD2 Score is used for stroke following transient ischemic attack.</p>\n<p><strong>Other options:</strong></p>\n<ul>\n<li>Pulmonary embolism: Wells clinical prediction rule for pulmonary embolism</li>\n<li>Assessing risk of stroke and for selecting antithrombotic therapy for patients with atrial fibrillation - CHADS2 score.</li>\n<li>Cardiovascular disease risk assessment- Many scoring systems are present,one e.g is QRISK score.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The slowing of conduction in multiple sclerosis is due to which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Gliosis"
      },
      {
        "id": 2,
        "text": "Loss of myelin sheath"
      },
      {
        "id": 3,
        "text": "Defect at node of Ranvier"
      },
      {
        "id": 4,
        "text": "Leaky Na+ channel"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In multiple sclerosis, the <strong>slowing of conduction</strong> is due to<strong>&nbsp;</strong>the <strong>loss of the myelin sheath.</strong></p>\n<p>Under normal circumstances, nerve conduction in myelinated axons occurs in a saltatory manner i.e from one node of Ranvier to another. But, when demyelination sets in, the nerve impulse are unable to travel as fast due to not being saltatory. This produces either a conduction block or delay.</p>\n<p>Lesions due to multiple sclerosis begin with perivenular cuffing by inflammatory mononuclear cells. Myelin-specific autoantibodies cause degeneration of myelin sheaths. As lesions evolve, prominent astrocytic proliferation&nbsp;(gliosis)&nbsp;is observed.</p>\n<p><strong>Demyelination</strong>&nbsp;is the hallmark in the pathology of multiple sclerosis. But, it is not solely a disease affecting the myelin sheath. Partial or total axonal destruction&nbsp;(neuronal loss)&nbsp;can also occur.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 37-year-old male presents with a history of fever and cough for 2 days. He is living with his wife who recently tested positive for COVID-19 and has been under home isolation. On examination, pulse is 110/min, BP is 78/58 mmHg, the temperature is 101.3 F, RR is 28 and SpO2 is 90%. Which of the following is not recommended in this patient\u2019s management?",
    "choices": [
      {
        "id": 1,
        "text": "Awake proning"
      },
      {
        "id": 2,
        "text": "Administration of paracetamol"
      },
      {
        "id": 3,
        "text": "Oxygen support"
      },
      {
        "id": 4,
        "text": "Prophylactic LMW heparin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Awake</strong>&nbsp;<strong>proning</strong> should<strong>&nbsp;be avoided</strong>&nbsp;in patients with <strong>hemodynamic instability.&nbsp;</strong></p>\n<p>This patient can be classified to have <strong>moderate COVID-19</strong> (SpO2 &lt;94%, RR&ge;24). The management protocol for moderate COVID includes oxygen support, anticoagulation (LMWH/UFH), corticosteroids and antivirals. Awake proning may be used in moderate COVID in patients who continue to have hypoxia despite oxygen &gt; 4L/min and no contraindications.&nbsp;As this patient is hypotensive and hemodynamically unstable, awake proning is not recommended.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following nerve is least injured during thyroid surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Recurrent laryngeal nerve"
      },
      {
        "id": 2,
        "text": "Ansa cervicalis"
      },
      {
        "id": 3,
        "text": "External laryngeal nerve"
      },
      {
        "id": 4,
        "text": "Marginal mandibular nerve"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Marginal mandibular nerve is least likely to be injured during thyroid surgery.</p>\n<p>As it is high up (mandibular margin) than the dissection plane of the approach to thyroid surgery.</p>\n<p>Other nerves might be at risk of injury if cautiousness is not practiced.</p>\n<ul>\n<li>Ansa cervicalis may be injured if strap muscles are not cut high enough.</li>\n<li>The superior laryngeal nerve may be injured near the superior pole of the thyroid.</li>\n<li>The recurrent laryngeal nerve may be injured if dissection is done below cricoid cartilage or near the tracheoesophageal groove.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During a splenectomy for a 40-year-old patient with immune thrombocytopenic purpura (ITP), the surgeon must ensure the complete removal of all splenic tissue, including accessory spleens, to prevent symptom recurrence. Accessory spleens are commonly found in specific anatomical locations. Where is the most likely site the surgeon should search for an accessory spleen during the operation?",
    "choices": [
      {
        "id": 1,
        "text": "Splenorenal ligament and omentum"
      },
      {
        "id": 2,
        "text": "Left paracolic gutter"
      },
      {
        "id": 3,
        "text": "Splenic hilum and mesentry"
      },
      {
        "id": 4,
        "text": "Gastrosplenic Ligament"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>The splenic hilum and mesentery</strong> represent the<strong> most common location for accessory spleens.\u00a0</strong></p>\n<p>An accessory spleen, a <strong>supernumerary spleen,</strong> a splenule, or a splenunculus refers to <strong>splenic tissue found outside the normal spleen</strong>. Around 10% to 30% of the population have accessory spleens; with an individual having\u00a0one to six accessory splenic buds. Furthermore, the size of an accessory spleen can also vary. Most accessory spleens are approximately 1 centimeter\u00a0but spleens larger than a few centimeters have also been observed.</p>\n<p>Accessory spleens are formed due to <strong>incomplete fusion</strong> of <strong>mesenchymal buds</strong> during development.\u00a0</p>\n<p>Most of the accessory spleens are observed in the <strong>splenic hilum,</strong> the site at which blood vessels enter the spleen; this is followed by the <strong>tail</strong> <strong>of the pancreas</strong>, with about 20% of all accessory splenic tissue appearing here. The rest can be found in areas such as the <strong>gastrosplenic ligaments</strong>, the <strong>lienorenal ligaments</strong>, the <strong>wall of the stomach</strong>, the wall of the intestines, the greater omentum, the <strong>mesentery,</strong> or even the pelvis or scrotum.</p>\n<p>Accessory spleens are of importance during procedures like <strong>splenectomies</strong> and <strong>imaging studies</strong>.</p>\n<p>In a <strong>therapeutic splenectomy</strong>, it is necessary to remove all accessory splenic tissue for resolution of symptoms failing which symptoms will continue because an accessory spleen is a functional splenic tissue. Conditions that tend to necessitate this sort of management are <strong>hemolytic anemia and chronic idiopathic thrombocytopenic purpura.</strong></p>\n<p>Accessory spleens are also relevant when evaluating the results of imaging studies; for example, when a patient undergoes a CT scan, accessory spleens can appear similar to lymph nodes or even a neoplastic growth.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are signs of the base of skull fracture except _____.",
    "choices": [
      {
        "id": 1,
        "text": "Racoon eyes"
      },
      {
        "id": 2,
        "text": "Battle sign"
      },
      {
        "id": 3,
        "text": "CSF leak"
      },
      {
        "id": 4,
        "text": "Fox sign"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Fox sign is bruising seen over the inguinal ligament in <strong>acute hemorrhagic pancreatitis</strong>.</p>\n<p><strong>Signs of the skull base fracture:</strong></p>\n<ul>\n<li><strong>Battle sign:</strong> Extravasation of blood results in ecchymosis behind the ear at the mastoid process.</li>\n<li><strong>Racoon eye:</strong> Periorbital ecchymoses (black eye)</li>\n<li><strong>Cerebrospinal fluid (CSF) rhinorrhea</strong></li>\n<li><strong>CSF&nbsp;otorrhea</strong></li>\n<li><strong>Anosmia</strong></li>\n<li><strong>Cranial nerve palsy:</strong> damage to the facial or vestibulocochlear nerve, resulting in vertigo, ipsilateral deafness,&nbsp;or facial paralysis<a href=\"https://en.wiktionary.org/wiki/palsy\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><strong>Hemotympanum</strong></li>\n</ul>\n<p><strong>Battle sign:</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/99ffd1df518b4d21ad80c91b6c473138x234x173.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f300e508d8849c2b5890d02deafe4a9x233x189.PNG"
    ]
  },
  {
    "text": "A 25-year-old male patient presented to the emergency department with an injured femoral artery following a stab injury to the right thigh. Which of the following suture material would be ideal for the repair of the artery?",
    "choices": [
      {
        "id": 1,
        "text": "Polyglycaprone"
      },
      {
        "id": 2,
        "text": "Polypropylene"
      },
      {
        "id": 3,
        "text": "Polyglactin"
      },
      {
        "id": 4,
        "text": "Nylon"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Polypropylene</strong> is the ideal suture material to repair the femoral artery.</p>\n<p>The vascular anastomosis requires an accurate and watertight closure. Hence it requires a <strong>non-absorbable</strong> material that can provide tensile <strong>strength</strong> for a <strong>longer</strong> <strong>period</strong>. In addition, the material should be <strong>non-braided</strong> to <strong>avoid</strong> <strong>platelet</strong> <strong>adherence</strong> to the suture material. Hence, polypropylene which is a non-absorbable monofilament is used for vascular anastomoses.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following instrument is used to augment labour in a 28-year-old primigravida via low rupture of membranes. Identify this instrument.",
    "choices": [
      {
        "id": 1,
        "text": "Crile artery forceps"
      },
      {
        "id": 2,
        "text": "Kelly artery forceps"
      },
      {
        "id": 3,
        "text": "Kocher's artery forceps"
      },
      {
        "id": 4,
        "text": "Rochester-Pean artery forceps"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given instrument is <strong>Kocher's artery forceps </strong>and is&nbsp;identified by the presence of a&nbsp;<strong>single tooth</strong> at the tip.</p>\n<p>Kocher's artery forceps&nbsp;are used to achieve <strong>hemostasis</strong> by holding bleeding vessels. They are also used in low rupture of membranes to <strong>augment labour</strong> or for the surgical induction of labour.&nbsp;</p>\n<p>The difference between artery forceps and needle holders is in the edge and smoothness of corrugations. <strong>Artery forceps</strong> have <strong>smooth edges</strong> and <strong>single lined corrugations</strong> whereas, <strong>needle holders</strong> have&nbsp;<strong>rough edges</strong> and crossed lines forming square to <strong>diamond shaped corrugations</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/759ffc5c290c43728d772d7891e71017.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 58-year-old woman is being evaluated for bleeding per vagina. She attained menopause at the age of 47. Which of the following is least likely to be a cause of post-menopausal bleeding?",
    "choices": [
      {
        "id": 1,
        "text": "Genital tract trauma"
      },
      {
        "id": 2,
        "text": "Ovarian Follicular cyst"
      },
      {
        "id": 3,
        "text": "Endometrial carcinoma"
      },
      {
        "id": 4,
        "text": "Granulosa cell tumor"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options,<strong>&nbsp;Ovarian Follicular cysts</strong> are least likely to be a cause of post-menopausal bleeding. They are usually asymptomatic unless they rupture, hemorrhage or the ovary undergoes torsion which would manifest as an acute abdomen. They occur when there is the failure of absorption of fluid in an incompletely developed follicle or anovulation.&nbsp;</p>\n<p>Postmenopausal bleeding is diagnosed when there is bleeding per vagina after 6 months of amenorrhoea after the age of 40 (menopausal age).&nbsp;</p>\n<p>Causes of postmenopausal bleeding include:&nbsp;</p>\n<ul>\n<li><strong>Genital tract trauma</strong> (Option A)</li>\n<li>Cervical erosion, inflammation, polyp, or ulcer</li>\n<li>Uterus - endometritis, endometrial hyperplasia, <strong>endometrial carcinoma</strong> (Option C), polyp, or sarcoma</li>\n<li>Fallopian tube malignancy</li>\n<li>Ovarian tumors such as Brenner tumor, <strong>granulosa cell tumor</strong> (Option D)</li>\n<li>Hypertension and blood dyscrasia</li>\n<li>Urinary tract trauma, bladder carcinoma</li>\n<li>Hemorrhoid, anal fissures, and rectal cancers confused as bleeding per vagina</li>\n<li>Use of estrogens as hormone replacement therapy, tamoxifen.</li>\n</ul>\n<p>The image below gives a summary of the evaluation of postmenopausal bleeding, as per the FOGSI guidelines.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/acac31efbf3e49dca75bdc3081987821x1280x2320.JPEG"
    ]
  },
  {
    "text": "Cervical incompetence or cervical insufficiency is characterized by _______",
    "choices": [
      {
        "id": 1,
        "text": "Repeated mid trimester painful cervical dilatation"
      },
      {
        "id": 2,
        "text": "Repeated mid trimester painless cervical dilatation"
      },
      {
        "id": 3,
        "text": "Repeated third trimester painful cervical dilatation"
      },
      {
        "id": 4,
        "text": "Repeated third trimester painless cervical dilatation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Cervical&nbsp;incompetence is characterized by repeated mid trimester painless cervical&nbsp;dilatation&nbsp;and escape of liquor&nbsp;amnii&nbsp;followed by painless expulsion of products of conception. The usual timings are 16 to 24 weeks.</p>\n<p>Etiology and risk factors:</p>\n<ul>\n<li>Prior cervical destructive surgery</li>\n<li>In utero DES exposure</li>\n<li>Prior induced or spontaneous first and second trimester abortions</li>\n<li>Uterine anomalies</li>\n<li>Multiple gestations</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-year-old boy with persistent diurnal incontinence and abdominal distention is being evaluated for a posterior urethral valve. What is the investigation of choice for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Transrectal ultrasound scan"
      },
      {
        "id": 2,
        "text": "Renal nuclear scintigraphy"
      },
      {
        "id": 3,
        "text": "Voiding cystourethrogram"
      },
      {
        "id": 4,
        "text": "Non-contrast CT scan"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Voiding cystourethrogram (VCUG)</strong>\u00a0is the investigation of choice for a posterior urethral valve<strong>.</strong></p>\n<p>Posterior urethral valves (<strong>PUV</strong>) are obstructing membranous folds within the lumen of the posterior urethra, which hinders the outflow of urine from the urinary bladder and may precipitate chronic renal disease in children.</p>\n<p>It occurs due to <strong>disruption of normal embryonic development</strong> of the male urethra between the 9th and 14th weeks of intrauterine life, resulting in the formation of membranous folds within the lumen of the posterior urethra.</p>\n<p>Children with PUV who are not diagnosed before birth may present with delayed voiding or a poor urinary stream. Infants are predisposed to <strong>repeated urinary tract infections (UTIs).</strong> Other common signs and symptoms may include a palpable abdominal mass, failure to thrive, lethargy, poor feeding, urosepsis, and urinary ascites. Older boys may have persistent diurnal incontinence or abdominal distention. Physical examination in the newborn typically discloses a palpable walnut-sized bladder, which corresponds to the hypertrophic detrusor muscle.</p>\n<div class=\"page\" title=\"Page 748\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 748\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Other options:<br /><br />Option A: <strong>Trans-rectal ultrasound scan (TRUS)</strong> is usually performed in conjunction with a biopsy of the prostate in male patients with an abnormal digital rectal examination of the prostate</p>\n<p>Option B: <strong>Renal nuclear scintigraphy</strong> with a technetium-99m-labelled dimercaptosuccinic acid can be used to visualise any abnormality or thinning of the renal parenchyma, like renal scarring</p>\n<p>Option D: A <strong>non-contrast CT scan</strong> is the investigation of choice in a patient with suspected urinary tract calculi</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the following deformity associated with spinal TB.",
    "choices": [
      {
        "id": 1,
        "text": "Knuckle"
      },
      {
        "id": 2,
        "text": "Gibbus"
      },
      {
        "id": 3,
        "text": "Kyphosis"
      },
      {
        "id": 4,
        "text": "Vertebra plana"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The skeletal deformity shown above is<strong>&nbsp;gibbus. </strong>It&nbsp;involves the <strong>collapse of two or three vertebral levels</strong> and presents as sharp posterior angulation.</p>\n<p>Spinal tuberculosis may present with the following skeletal deformities:</p>\n<ul>\n<li>The <strong>collapse of a single vertebra</strong> causing prominence of a single spinous process is known as <strong>knuckle.</strong></li>\n<li>The <strong>collapse of two or three vertebral levels</strong>&nbsp;presenting as sharp posterior angulation is known as <strong>gibbus/kyphos.</strong></li>\n<li>The <strong>collapse of</strong>&nbsp;<strong>anterior vertebral bodies</strong> involving multiple vertebrae leads to exaggerated curvature of the vertebral column known as <strong>kyphosis</strong>.</li>\n<li>The <strong>collapse of the entire vertebral body</strong> (not just the anterior part of the vertebra) leads to <strong>concertina collapse/vertebra plana. </strong>It is usually seen in tuberculosis of the central vertebral body.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/634398c45c60480483931656b21cc870.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b3324f492b22473e8977358bd0944b9bx1280x2309.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c85658dd636e4c1a9f92d15f8848038ex1280x1968.JPEG"
    ]
  },
  {
    "text": "In aiding the diagnosis of a patient with suspected pneumoperitoneum, what is the most sensitive imaging modality among the given options:",
    "choices": [
      {
        "id": 1,
        "text": "Erect chest x-ray PA view"
      },
      {
        "id": 2,
        "text": "Supine abdomen x-ray AP view"
      },
      {
        "id": 3,
        "text": "Contrast-enhanced CT"
      },
      {
        "id": 4,
        "text": "Erect abdomen x-ray PA view"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Contrast-enhanced CT</strong> is the <strong>most sensitive imaging</strong> modality used in the diagnosis of minimal or suspected pneumoperitoneum. Free air as less as 1 ml can be detected. Small pockets of air trapped in peritoneal recesses can also be detected.&nbsp;</p>\n<p>An <strong>erect chest x-ray</strong> is the next most sensitive investigation, and also the <strong>initial investigation</strong> carried out to diagnose pneumoperitoneum. Free air under the diaphragm, also known as the <strong>crescent sign</strong> is seen here and it can detect around 3-4 ml of free air in the abdomen.&nbsp;</p>\n<p>If the patient is unable to stand, then an abdomen x-ray with <strong>left lateral decubitus view</strong> is more sensitive than supine or erect abdominal films to detect pneumoperitoneum.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-yr-old man presents with an excessive desire for sexual intercourse. What is this called?",
    "choices": [
      {
        "id": 1,
        "text": "Satyriasis"
      },
      {
        "id": 2,
        "text": "Frotteurism"
      },
      {
        "id": 3,
        "text": "Nymphomania"
      },
      {
        "id": 4,
        "text": "Masochism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>An excess desire for sexual intercourse in males is called <strong>satyriasis</strong>.&nbsp;</p>\n<p><strong>Satyriasis</strong> is also known as <strong>Don Juanism. </strong>In some men,&nbsp;sexual activity is a means to mask their deep feelings of inferiority. Some have unconscious homosexual impulses, which they deny by compulsive sexual contact with women. Many of them are no longer interested in the women after sex.</p>\n<p>Other options</p>\n<ul>\n<li><strong>Nymphomania: </strong>An<strong>&nbsp;</strong>excess desire for sexual intercourse in females</li>\n<li><strong>Frotteurism</strong>: Sexual gratification achieved by touching or rubbing against a nonconsenting person.</li>\n<li><strong>Masochism</strong>: The tendency to derive sexual gratification from one's own pain or humiliation.</li>\n</ul>\n<p>Note:&nbsp;Don Juanism represents hypersexuality in males.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 57 year old male patient who has been diagnosed with aggressive pancreatic cancer presents with intractable abdominal pain unresponsive to opioids. The anesthetist decides to opt for a regional block. Which of the following would he choose?",
    "choices": [
      {
        "id": 1,
        "text": "Stellate block"
      },
      {
        "id": 2,
        "text": "Celiac plexus block"
      },
      {
        "id": 3,
        "text": "Lumbar sympathetic block"
      },
      {
        "id": 4,
        "text": "Superior hypogastric plexus block"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The block he would choose in the case of pancreatic cancer is <strong>celiac plexus block.</strong></p>\n<p>The celiac plexus block is indicated in patients with pain arising from the <strong>abdominal viscera,</strong> specifically intraabdominal cancers.\u00a0</p>\n<p>The celiac ganglia are generally clustered at the level of the <strong>body of the</strong> <strong>L1 vertebra</strong>, posterior to the inferior vena cava on the right and lateral to the aorta on the left. It is posterior to the pancreas.\u00a0</p>\n<p>The patient is placed in a <strong>prone position</strong> and 15-20 ml of local anesthetic is injected under fluoroscopic, CT, or ultrasound guidance. The needed should be inserted 7-8cm from the midline at the inferior edge of the spinous process of L1.\u00a0</p>\n<p>The approaches that can be taken for this block include the posterior retrocrural approach, posterior anterocrural approach, posterior transaortic approach, an anterior approach.\u00a0</p>\n<p>The most common complication is <strong>postural hypotension.</strong> This occurs due to blocking of visceral sympathetic innervation which results in vasodilation. To prevent this, the patient should be <strong>adequately hydrated intravenously.\u00a0</strong></p>\n<p>Other options:\u00a0</p>\n<p>Option A: The <strong>stellate block</strong> is indicated in patients with head, neck, arm, and upper chest pain.\u00a0</p>\n<p>Option B: The <strong>lumbar sympathetic block</strong> is indicated in painful conditions involving the pelvis and lower extremities like a peripheral vascular disease.\u00a0</p>\n<p>Option D: The <strong>superior hypogastric plexus block</strong> is indicated in pelvic pain that is unresponsive to lumbar or caudal epidural blocks. It is used in patients with cancer of the pelvic organs or non-cancer pelvic pain.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the false statement regarding Scleredema.",
    "choices": [
      {
        "id": 1,
        "text": "Dermis is thickened 3 to 4 times"
      },
      {
        "id": 2,
        "text": "Erythema and a peau d\u2019orange appearance of the skin"
      },
      {
        "id": 3,
        "text": "Can occur in association with Diabetes"
      },
      {
        "id": 4,
        "text": "Associated with sclerodactyly or Raynauds Phenomenon"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Scleroderma</strong> is associated with <strong>sclerodactyly </strong>or<strong> Raynauds Phenomenon</strong> (and <strong>not scleredema)</strong>.</p>\n<p>The <strong>dermis\u00a0</strong>is 3\u20134 times thicker than normal.\u00a0The subcutaneous tissue is also involved with fat being replaced by coarse collagen fibers.</p>\n<p><strong>Scleredema</strong> :\u00a0</p>\n<ul>\n<li>Scleredema is symmetrical diffuse progressive <strong>non\u2010pitting swelling</strong> and induration of the <strong>upper part of the body</strong> caused by\u00a0a <strong>thickened dermis</strong> and <strong>deposition of mucin</strong>.</li>\n<li><strong>Erythema</strong> and a <strong>peau d\u2019orange</strong> appearance of the skin are commonly observed. The <strong>hands and feet</strong> are characteristically <strong>spared</strong>.</li>\n<li><strong>Diabetic</strong>\u00a0scleredema is the most common type.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1bf68836cdba4c74bc965da76418f9f4x576x547.PNG"
    ]
  },
  {
    "text": "Laser most commonly used in laryngeal surgeries_____",
    "choices": [
      {
        "id": 1,
        "text": "Nd Yag"
      },
      {
        "id": 2,
        "text": "Holmium"
      },
      {
        "id": 3,
        "text": "CO2"
      },
      {
        "id": 4,
        "text": "Diode"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li><strong>Endoscopic resection with the CO2 laser. </strong>Carcinoma of the mobile membranous vocal cord is traditionally treated with radiotherapy.</li>\n<li>Such lesions can be precisely excised with the CO2 laser under the microscope with the same good results.</li>\n<li>Laser excision has the advantages of lower cost, lower duration of treatment and morbidity.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 015';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>