<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neet  Mini - 7 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 30-year-old man came to the OPD with a febrile illness of 2 days, associated with abdominal tenderness, malaise and diarrhoea. His temperature was 39 \u00b0C, PR- 78 bpm, BP- 110/70 mmHg. He lives in a crowded neighborhood with poor sanitation where many others have reported similar complaints recently. Which of the following  investigations will be the most appropriate choice in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Stool culture"
      },
      {
        "id": 2,
        "text": "Widal test"
      },
      {
        "id": 3,
        "text": "Urine culture"
      },
      {
        "id": 4,
        "text": "Blood culture"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient's history of fever with <strong>relative bradycardia</strong>, abdominal tenderness, and similar cases in the neighborhood suggests <strong>enteric fever</strong>. It is caused by <strong>Salmonella</strong> typhi or paratyphi. Out of the given options, blood culture is the most sensitive test in this patient.</p>\n<p>Diagnosis of enteric fever:</p>\n<ul>\n<li>\n<p><strong>Blood culture</strong>: It is more <strong>sensitive during 1st week</strong> than in the subsequent weeks. It rapidly becomes negative on treatment with antibiotics.</p>\n</li>\n<li><strong>Antibody testing</strong>: WIDAL test to detect rising titres of H and O agglutinins against salmonella typhi and paratyphi. Agglutinins appear by the end of the first week and rise steadily up to the 3rd or 4th week, after which they disappear.</li>\n<li>\n<p><strong>Stool culture:</strong> It yields positive results from the 3rd week onwards.</p>\n</li>\n<li>\n<p><strong>Urine culture</strong>: Results may be positive after the 2nd week.</p>\n</li>\n<li><strong>Bone marrow culture</strong>&nbsp;remains positive for&nbsp;<strong>5 days&nbsp;</strong>even after the start of&nbsp;<strong>antibiotics </strong>and is the most sensitive test in the first week<strong>. </strong>The culture of <strong>duodenal aspirate</strong> may yield positive results when bone marrow culture is inconclusive.</li>\n</ul>\n<p><strong>Relative bradycardia</strong>&nbsp;is seen when patients have a lower heart rate than expected for a given rise in body temperature. (<strong>Faget's sign</strong>)</p>\n<p>Infectious causes of relative bradycardia include:&nbsp;</p>\n<ul>\n<li>Salmonella typhi</li>\n<li>Francisella tularensis</li>\n<li>Coxiella burnetii (Q fever)</li>\n<li>Leptospira interrogans</li>\n<li>Legionella pneumophila</li>\n<li>Rickettsia spp.</li>\n<li>Orientia tsutsugamushi (scrub typhus)</li>\n<li>Corynebacterium diphtheriae</li>\n<li>Plasmodium spp. (malaria)</li>\n</ul>\n<p>Noninfectious causes include:</p>\n<ul>\n<li>Drug fever\u2028</li>\n<li>Beta-blocker use\u2028</li>\n<li>Central nervous system lesions</li>\n<li>Malignant lymphoma</li>\n<li>Factitious fever</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old lady who is a known diabetic has had right shoulder pain for the past 7 months. She had pain initially mainly on external rotation along with restricted movements. Now, her pain has gradually decreased but she still complains of a stiff shoulder. You diagnose her with adhesive capsulitis. What stage of adhesive capsulitis is this patient in?",
    "choices": [
      {
        "id": 1,
        "text": "Stage IV"
      },
      {
        "id": 2,
        "text": "Stage III"
      },
      {
        "id": 3,
        "text": "Stage II"
      },
      {
        "id": 4,
        "text": "Stage I"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of <strong>decrease </strong>in<strong> pain </strong>and <strong>complaints of stiffness </strong>in the shoulder joint indicate<strong> stage II</strong> of\u00a0<strong>a</strong><strong>dhesive capsulitis/frozen shoulder.</strong></p>\n<p><strong>Frozen shoulder\u00a0</strong>is a disorder characterized by progressive pain and stiffness of the shoulder, which usually resolves spontaneously. The condition is particularly associated with diabetes, Dupuytren\u2019s contracture, hyperlipidemia, thyroid disorders, cardiac disease, and hemiplegia. X-ray of the shoulder is usually normal, with some cases showing sclerosis on the outer edge of the greater tuberosity.</p>\n<p><strong>Reeves </strong>classified the frozen shoulder into<strong> three stages:</strong></p>\n<ul>\n<li>Stage I <strong>(Stage of pain): </strong>In this stage patients usually complain of acute pain with decreased movements (<strong>external rotation </strong>is<strong> most affected</strong> followed by the abduction and then forward flexion; internal rotation is the least affected). This stage lasts for 10-36 weeks</li>\n<li>Stage II: The<strong> stage of stiffness</strong> where pain gradually decreases and patients complain of the stiff shoulder. This lasts for 4 to 12 months.</li>\n<li>Stage III: The <strong>stage of recovery,</strong> the patient will have no pain and the movements have recovered except that the movements are never regained back to normal. It usually lasts for 6 months to 2 years.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following muscles are bipennate muscles?",
    "choices": [
      {
        "id": 1,
        "text": "1,3,5"
      },
      {
        "id": 2,
        "text": "2,4,5"
      },
      {
        "id": 3,
        "text": "1,4,5"
      },
      {
        "id": 4,
        "text": "2,3,5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options, the bipennate muscles are dorsal interossei, flexor hallucis longs and rectus femoris (2,4,5)</p>\n<p><strong>Muscles with oblique fibers </strong>are subclassified as follows:</p>\n<ul>\n<li><strong>Triangular:</strong> They are triangular in shape. E.g., <strong>temporalis</strong>, <strong>adductor longus</strong>, <strong>trapezius</strong></li>\n<li><strong>Pennate:</strong> They are <strong>feather-shaped</strong>. Based on their complexity, they can have the following subtypes:\n<ul>\n<li><strong>Unipennate:\u00a0</strong>Fascicles on one side of the tendon. E.g.,\n<ul>\n<li>Flexor pollicis longus</li>\n<li>Extensor digitorum longus</li>\n<li>Peroneus tertius</li>\n<li>Palmar interossei</li>\n</ul>\n</li>\n<li><strong>Bipennate:</strong>\u00a0Fascicles on two sides of the tendon. E.g.,\u00a0\n<ul>\n<li>Rectus femoris,</li>\n<li>Peroneus longus,</li>\n<li>Flexor hallucis longus,</li>\n<li>Dorsal interossei</li>\n</ul>\n</li>\n<li><strong>Multipennate:</strong>\u00a0Central tendon branches into two or more branches within the muscle. E.g.,\n<ul>\n<li>Deltoid</li>\n<li>Subscapularis</li>\n</ul>\n</li>\n<li><strong>Circumpennate (radial):</strong>\u00a0Muscle fibers converge to a central tendon in a radial fashion. E.g.,\n<ul>\n<li>Tibialis anterior</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/148b516bff264e99ae76a244865b4a39x1280x3437.JPEG"
    ]
  },
  {
    "text": "A 21-year-old college student is brought to the doctor by his family because they found him working in a \"drag-queen\" bar, dressed as a woman. He says that he feels beautiful when he dresses as a woman and wears make-up. He likes the idea of feeling like a woman but has no wish to undergo any sex change surgery. He does not wish to live with his family as they are not supportive of his choices. This is punishable under which IPC section?",
    "choices": [
      {
        "id": 1,
        "text": "Section 294 IPC"
      },
      {
        "id": 2,
        "text": "Not punishable by law"
      },
      {
        "id": 3,
        "text": "Section 377 IPC"
      },
      {
        "id": 4,
        "text": "Section 290 IPC"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The condition described in the given scenario is<strong>&nbsp;dual-role transvestism</strong>, in which the person temporarily<strong> likes to identify with the&nbsp;</strong><strong>opposite gender by dressing like them.&nbsp;</strong><strong>This is not punishable by law.</strong></p>\n<p>It&nbsp;is <strong>not associated </strong>with any<strong> genital or hormonal abnormality.</strong>&nbsp;This condition is not a sexual paraphilia as it is not accompanied by sexual excitement derived from cross-dressing.&nbsp;They do not want to undergo sex change surgery as they are otherwise comfortable with leading a life as their assigned gender.</p>\n<p>Terms related to gender incongruence:</p>\n<ul>\n<li>Transsexualism&nbsp;is a condition where the person<strong> wants to live life as a member of the opposite sex. </strong>They often prefer to undergo sex change surgery.</li>\n<li>Dual-role transvestism</li>\n<li>Gender incongruence of childhood- persistent excessive preoccupation with the dressing and activities of the opposite sex and desire to be one among the members of the opposite sex. This is accompanied by distress with one's assigned gender.</li>\n</ul>\n<p>Note:<strong>&nbsp;</strong>The terms&nbsp;\"transsexualism\" and \"gender identity disorder of children,\" which were present in ICD-10, are now considered outdated, and the&nbsp;<strong>ICD-11</strong> has renamed them as \"<strong>gender incongruence of adolescence and adulthood</strong>\" and \"<strong>gender incongruence of childhood</strong>,\" respectively.&nbsp;This change reflects the&nbsp;current understanding that trans-related and gender-diverse identities are <strong>not mental illnesses</strong> and that labeling them as such can result in significant stigma.</p>\n<p>Disorders of sexual preference:</p>\n<ul>\n<li>Fetishism - Using nonliving objects, usually those belonging to the opposite sex, as stimuli for sexual gratification</li>\n<li><strong>Fetishistic transvestism</strong>&nbsp;- Dressing as the opposite sex to derive sexual pleasure</li>\n<li>Voyeurism - Recurrent urge to observe a person while undressing or engaging in sexual activity</li>\n<li>Pedophilia - Sexual preference for pre-pubertal or early pubertal children</li>\n<li>Sadomasochism - Preference for inflicting pain on a sexual partner or being subjected to pain by the sexual partner.</li>\n</ul>\n<p>Other options:</p>\n<p><strong>Option A:&nbsp;Section&nbsp;294 IPC </strong>is related to<strong> e</strong><strong>xhibitionism.</strong>&nbsp;It involves behaviors over a period of 6 months or more involving the exposure of one&rsquo;s genitals to an unsuspecting stranger. This is a punishable offense with imprisonment of up to 3 months or a fine.</p>\n<p><strong>Option C:&nbsp;</strong><strong>Section 377 IPC</strong>:&nbsp;Definition and punishment of unnatural sexual offenses with imprisonment for life or up to 10 years and fine.&nbsp;In a landmark judgment, the Supreme Court of India scrapped the provisions of Section 377, except the provisions of bestiality, which is cruelty against animals.</p>\n<p><strong>Option D:</strong>&nbsp;<strong>Section</strong>&nbsp;<strong>290 IPC </strong>is related to <strong>frotteurism, </strong>which describes behavior in which a person obtains sexual gratification by contact with another person (rubbing his private parts against female buttocks, breasts, thighs, etc. in crowds). This is a punishable offense, with a fine of up to 200 Rs.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following options depict the correct match between the substances (column A) and their site of production (column B)?",
    "choices": [
      {
        "id": 1,
        "text": "(i-b), (ii-d), (iii-a), (iv-c)"
      },
      {
        "id": 2,
        "text": "(i-c), (ii-b), (iii-a), (iv-d)"
      },
      {
        "id": 3,
        "text": "(i-a), (ii-d), (iii-c), (iv-b)"
      },
      {
        "id": 4,
        "text": "(i-a), (ii- b), (iii-c), (iv-d)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct match is&nbsp;<strong>(i-b), (ii-d), (iii-a), (iv-c).</strong></p>\n<p>Hormones produced by the kidney are:</p>\n<p><strong>1. Renin- </strong>It is produced by <strong>juxtaglomerular cells</strong>. It converts <strong>angiotensinogen to angiotensin I</strong>. Factors that affect renin secretion are:</p>\n<table style=\"height: 154px;\" width=\"489\">\n<tbody>\n<tr>\n<td style=\"width: 236px;\"><strong>Stimulatory</strong></td>\n<td style=\"width: 237px;\"><strong>Inhibitory</strong></td>\n</tr>\n<tr>\n<td style=\"width: 236px;\">\n<p class=\"p1\">Increased sympathetic activity</p>\n</td>\n<td style=\"width: 237px;\">Increased afferent arteriolar pressure</td>\n</tr>\n<tr>\n<td style=\"width: 236px;\">\n<p class=\"p1\">Increased circulating catecholamines</p>\n</td>\n<td style=\"width: 237px;\">Angiotensin II</td>\n</tr>\n<tr>\n<td style=\"width: 236px;\">Prostaglandins</td>\n<td style=\"width: 237px;\">Increased Na<span class=\"s1\">+ </span>and Cl<span class=\"s1\">&minus; </span>reabsorption across macula densa</td>\n</tr>\n<tr>\n<td style=\"width: 236px;\">&nbsp;</td>\n<td style=\"width: 237px;\">&nbsp;Vasopressin</td>\n</tr>\n</tbody>\n</table>\n<p>Conditions those increase renin secretion are:</p>\n<ul>\n<li class=\"p1\">Na<span class=\"s1\">+ </span>depletion</li>\n<li class=\"p1\">Diuretics</li>\n<li class=\"p1\">Hypotension</li>\n<li class=\"p1\">Hemorrhage</li>\n<li class=\"p1\">Upright posture</li>\n<li class=\"p1\">Dehydration</li>\n<li class=\"p1\">Cardiac failure</li>\n<li class=\"p1\">Cirrhosis</li>\n<li class=\"p1\">Constriction of renal artery or aorta</li>\n</ul>\n<p>2. <strong>Erythropoietin</strong>- the majority of the erythropoietin is produced from&nbsp;<strong>interstitial cells in the peritubular capillary</strong> bed of the kidneys. Some amount is produced by the&nbsp;perivenous hepatocytes in the liver. It is released in response to hypoxia, cobalt salts, and androgens. It increases red cell production.</p>\n<p>3. <strong>1,25-dihydroxycholecalciferol</strong>-&nbsp;The 25-hydroxycholecalciferol produced in the liver is further converted to 1,25-dihydroxycholecalciferol by the <strong>proximal tubular cells</strong>. This is also called <strong>calcitriol</strong>. It increases the calcium reabsorption from the kidneys, intestine, and increases the activity of osteoblasts.</p>\n<p>Note- <strong>Angiotensinogen</strong> is synthesized in the <strong>liver.</strong> It is converted to angiotensin I by renin.&nbsp;Its circulating level is increased by glucocorticoids, thyroid hormones, estrogens, several cytokines, and angiotensin II.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 68-year-old male patient came to the physician with complaints of chronic back pain and easy fatigability.  An X-ray of his skull is shown below. Laboratory investigations show decreased hemoglobin, hypercalcemia, normal alkaline phosphatase, elevated ESR. He should be started on which of the following combination therapy?",
    "choices": [
      {
        "id": 1,
        "text": "Thalidomide + Cyclophosphamide"
      },
      {
        "id": 2,
        "text": "Rituximab+ Cyclophosphamide"
      },
      {
        "id": 3,
        "text": "Bortezomib + Rituximab"
      },
      {
        "id": 4,
        "text": "Lenalidomide + Bortezomib+Dexamethasone"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient's history and clinical findings are suggestive of multiple myeloma.<strong><span data-preserver-spaces=\"true\"> Lenalidomide +Bortezomib+Dexamethasone </span></strong>is the treatment of choice in<strong><span data-preserver-spaces=\"true\">\u00a0multiple myeloma.</span></strong></p>\n<p><span data-preserver-spaces=\"true\">This patient's anemia, hypercalcemia, normal alkaline phosphatase, elevated ESR are consistent with the diagnosis of multiple myeloma. The <strong>skull</strong> demonstrates the typical\u00a0<strong>\u201cpunched out\u201d lesions</strong>\u00a0characteristic of multiple myeloma.\u00a0</span></p>\n<p><span data-preserver-spaces=\"true\">Multiple myeloma is a malignant <strong>plasma cell dyscrasia</strong> with the proliferation of plasma cells derived from a single clone. Bone pain is the most common presenting symptom in multiple myeloma.\u00a0</span>The next most common clinical problem in patients with myeloma is susceptibility to bacterial infections. The most common infections are pneumonia and pyelonephritis, and the most frequent pathogens are <em>Streptococcus pneumoniae</em>, <em>Staphylococcus aureus</em>, and <em>Klebsiella pneumoniae</em> in the lungs and <em>Escherichia coli</em> and other gram-negative organisms in the urinary tract.</p>\n<p><span data-preserver-spaces=\"true\"><strong>Chemotherapy</strong> followed by <strong>a</strong><strong>utologous stem cell transplantation</strong>\u00a0prolongs overall survival in multiple myeloma patients.</span></p>\n<p><span data-preserver-spaces=\"true\">The combination of lenalidomide, bortezomib, and dexamethasone achieves close to a 100% response rate making it one of the preferred induction regimens in transplant-eligible patients.</span></p>\n<p><span data-preserver-spaces=\"true\">NOTE: The U.S. FDA has approved ABECMA, the first cell-based gene therapy to treat adult patients with multiple myeloma who have not responded to, or whose disease has returned after, at least four prior lines (different types) of therapy.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/349c22547afe4047b9d2175715221f38.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e607b9cda8ba4e52913d9b4df17e2270x1280x2516.JPEG"
    ]
  },
  {
    "text": "A gross specimen of the colon obtained from a 14-year-old boy is shown below. Which of the following statements is false about this pathology?",
    "choices": [
      {
        "id": 1,
        "text": "It occurs as a result of a defect in the DNA mismatch repair mechanism."
      },
      {
        "id": 2,
        "text": "At least 100 polyps are needed to make the diagnosis."
      },
      {
        "id": 3,
        "text": "Prophylactic colectomy is done for patients with APC mutations."
      },
      {
        "id": 4,
        "text": "It is associated with congenital hypertrophy of the retinal pigment epithelium."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The gross specimen in the image shows the presence of <strong>multiple polyps</strong> in the colon, along with an area suspicious of colorectal carcinoma. Multiple polyps in the colon of a <strong>14-year-old</strong> boy make&nbsp;<strong>familial adenomatous polyposis (FAP)</strong> the likely diagnosis.</p>\n<p>FAP is an <strong>autosomal dominant</strong> disorder that is caused by mutations of the <strong>adenomatous polyposis coli (<em>APC</em>) gene</strong> and not due to defects in the DNA repair mechanism. Defects in DNA mismatch repair genes result in hereditary non-polyposis colorectal cancer, MYH-associated polyposis, and some sporadic colon cancers.</p>\n<p>Familial adenomatous polyposis, as the name suggests, is an <strong>inherited</strong> disorder presenting with numerous<strong> colorectal adenomatous polyps.</strong>&nbsp;It is an <strong>autosomal dominant</strong> disease&nbsp;caused by mutations in the <strong><em>APC</em> gene</strong>, which is a regulator in the Wnt signaling pathway.&nbsp;At least<strong> 100 polyps </strong>are required to make a<strong> diagnosis of FAP.</strong>&nbsp;</p>\n<p>Patients are usually <strong>teenagers</strong> and multiple polyps are visible in the colon during sigmoidoscopy. It is associated with a variety of extraintestinal manifestations including congenital <strong>hypertrophy</strong> of the <strong>retinal pigmental epithelium</strong>.<strong>&nbsp;</strong><strong>Colorectal adenocarcinoma</strong> occurs in almost all cases before the age of 50.&nbsp;</p>\n<p><strong>Prophylactic colectomy</strong> is recommended in patients with APC gene mutations. The surgeries used are&nbsp;colectomy with ileorectal anastomosis (IRA), restorative proctocolectomy with an ileal pouch-anal anastomosis (RPC), or<span class=\"s1\">&nbsp;</span>total proctectomy and end ileostomy. The first 2 surgeries are preferred in young patients as it avoids a permanent stoma.&nbsp;</p>\n<p>Note-&nbsp;FAP along with <strong>brain tumors </strong>is called<strong> Turcot syndrome. FAP&nbsp;</strong>along with&nbsp;multiple osteomas, skin, and soft tissue tumors is called <strong>Gardner syndrome.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d2e764e223b44bf88c017717b34d9e2d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Shweta came to donate blood for the first time on her 30th birthday. After an adequate history and baseline tests, blood donation was started along with the monitoring of her pulse and BP. She developed sweating,  bradycardia, hypotension, and fainted transiently. Which of the following should not be done?",
    "choices": [
      {
        "id": 1,
        "text": "Help the patient to stand up on her feet"
      },
      {
        "id": 2,
        "text": "Discontinue donation"
      },
      {
        "id": 3,
        "text": "Give her fluids to drink orally"
      },
      {
        "id": 4,
        "text": "Avoid investigation for cause of fainting"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Helping the patient to stand on her feet should not be done.</p>\n<p>The given scenario describes precipitation of <strong>vasovagal syncope</strong>. It might be due to anxiety in first time donor, a hot and humid environment in the donation room, or due to hypoglycemia, lack of sleep in the donor. Signs and symptoms are seen as pallor or sweating, slow pulse, drop in blood pressure, vomiting, loss of consciousness, or very rarely convulsions due to anoxia.&nbsp;</p>\n<p>What should be done in this situation?</p>\n<p>&bull; Discontinue donation<br />&bull; Recline chair<br />&bull; Loosen clothes<br />&bull; Monitor BP and pulse<br />&bull; Reassure the patient<br />&bull; Give fluids to drink (recovery is usually rapid)</p>\n<p>Since the patient underwent basic investigations, monitoring of the vitals before the procedure and she would recover immediately from vasovagal syncope, investigations for the cause of fainting are not necessary and can be avoided.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are true about pre-induction cervical ripening?",
    "choices": [
      {
        "id": 1,
        "text": "1 and 5 only"
      },
      {
        "id": 2,
        "text": "2,3,5"
      },
      {
        "id": 3,
        "text": "1,3,4"
      },
      {
        "id": 4,
        "text": "2 and 4 only"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Statements <strong>1,3,4</strong> are correct.&nbsp;</p>\n<p>The interval between <strong>application of dinoprostone gel</strong> and <strong>starting oxytocin infusion</strong> is <strong>6-12 hours</strong>.</p>\n<p>The dinoprostone <strong>insert</strong> has a <strong>shorter induction to delivery time</strong> as compared to the gel.&nbsp;</p>\n<p><strong>Pharmacological induction of Labour</strong></p>\n<table style=\"height: 75px; width: 756px;\">\n<tbody>\n<tr style=\"height: 65.0078px;\">\n<td style=\"width: 138px; height: 65.0078px;\">Prostaglandin E2</td>\n<td style=\"width: 202.016px; height: 65.0078px;\">\n<p>Dinoprostone gel 0.5mg</p>\n</td>\n<td style=\"width: 394.984px; height: 65.0078px;\">\n<p>Cervical, can repeat 6th hourly upto 3 doses&nbsp;</p>\n</td>\n</tr>\n<tr style=\"height: 24px;\">\n<td style=\"width: 138px; height: 24px;\">Prostaglandin E2</td>\n<td style=\"width: 202.016px; height: 24px;\">Dinoprostone insert 10mg</td>\n<td style=\"width: 394.984px; height: 24px;\">Placed in the posterior fornix, 10mg&nbsp;</td>\n</tr>\n<tr style=\"height: 24px;\">\n<td style=\"width: 138px; height: 24px;\">Prostaglandin E1</td>\n<td style=\"width: 202.016px; height: 24px;\">Misoprostol 25mcg&nbsp;</td>\n<td style=\"width: 394.984px; height: 24px;\">\n<p>Vaginal, can repeat 3-6th hourly&nbsp;</p>\n<p>Induces contractions in 30-60mins&nbsp;</p>\n</td>\n</tr>\n<tr style=\"height: 24px;\">\n<td style=\"width: 138px; height: 24px;\">Prostaglandin E1</td>\n<td style=\"width: 202.016px; height: 24px;\">Misoprostol 100mcg</td>\n<td style=\"width: 394.984px; height: 24px;\">Oral, 50-100mcg, can repeat 3-6 hourly&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old patient, who was diagnosed with severe ARDS  was shifted to the intensive care unit and was put on mechanical ventilation with high PEEP (positive end-expiratory pressure). This ventilatory setting results in all of the following nonpulmonary effects  except",
    "choices": [
      {
        "id": 1,
        "text": "Urinary output decreases"
      },
      {
        "id": 2,
        "text": "Angiotensin level increases"
      },
      {
        "id": 3,
        "text": "Level of Antidiuretic hormone decreases"
      },
      {
        "id": 4,
        "text": "Glomerular filteration decreases"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Mechanical ventilation with positive end-expiratory pressure (PEEP) setting results in all the above effects except decrease in\u00a0Antidiuretic hormone level.</p>\n<p class=\"p1\"><strong>Positive end-expiratory pressure(PEEP)</strong></p>\n<p class=\"p1\">PEEP is a mode of therapy used in conjunction with mechanical ventilation. Application of positive pressure during expiration as an adjunct to a mechanically ventilated breath is referred to as PEEP.</p>\n<p class=\"p1\">The principal mechanism of action appears to be the expansion of partially collapsed alveoli.</p>\n<p class=\"p1\"><strong>Pulmonary effects</strong>:\u00a0</p>\n<ul>\n<li class=\"p1\">In patients with decreased lung volume, appropriate levels of PEEP will <strong>increase FRC</strong> and tidal ventilation and thereby\u00a0<strong>improving lung compliance.</strong></li>\n<li class=\"p1\">It also helps in correcting ventilation/perfusion mismatch and aid in <strong>improving arterial oxygenation.</strong></li>\n</ul>\n<p><strong>Nonpulmonary effects:</strong></p>\n<ul>\n<li><strong>Urinary output decreases</strong></li>\n<li><strong>Glomerular filtration decreases.</strong></li>\n<li>Circulating levels of<strong> antidiuretic hormone and angiotensin </strong>are usually<strong> elevated.</strong></li>\n<li class=\"p1\">Central venous pressure increases</li>\n<li class=\"p1\">Progressive reductions in cardiac output</li>\n<li class=\"p1\">Decrease in both renal and hepatic blood flow.</li>\n<li class=\"p1\">Decreased free water clearance</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The radiologist performs  myocardial perfusion imaging  with  technetium-99m labeled compounds in a cardiac patient to determine the effectiveness of acute revascularization. Identify the true statement about technetium-99m.",
    "choices": [
      {
        "id": 1,
        "text": "Pure beta emitter with half life of 12 hours"
      },
      {
        "id": 2,
        "text": "Pure gamma emitter with half life of 12 hours"
      },
      {
        "id": 3,
        "text": "Pure beta emitter with half life of 6 hours"
      },
      {
        "id": 4,
        "text": "Pure gamma emitter with half life of 6 hours"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Technetium-99m is a&nbsp;<strong>pure gamma emitter</strong>&nbsp;as it is in the metastable state and its half-life is&nbsp; <strong>6 hours.</strong></p>\n<p>Technetium agents based on the Technetium-99m (Tc-99m) radioisotope are most frequently used an agent in medical imaging. The radioactive technetium can be chelated to a number of different compounds to create specific radiopharmaceuticals and optimise imaging of various structures.</p>\n<p>Half-life of Tc 99m is&nbsp;<strong>6 hours</strong></p>\n<p>Tc 99m produce&nbsp;<strong>gamma rays&nbsp;</strong>of&nbsp;<strong>140 keV.</strong></p>\n<p>Note:</p>\n<p>Myocardial perfusion imaging is done with either&nbsp;<strong>thallium-201 or technetium-99m</strong>&nbsp;labeled compounds (e.g., technetium-99m sestamibi).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 1-month-old infant was brought to you with hypotonia, a weak cough, and tongue fasciculations. A diagnosis of spinal muscular atrophy was made. Which of the following marked regions is affected in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>region marked 1</strong> which shows the <strong>anterior horn</strong> of the <strong>spinal cord</strong> is affected in <strong>spinal muscular atrophy</strong>.</p>\n<p>Spinal muscular atrophy (SMA) is an <strong>autosomal recessive pattern</strong> disease characterized by<strong> progressive degeneration</strong> of the motor neurons. It results from a continuation of <strong>apoptosis</strong> that normally occurs in the embryonal period. This results in <strong>extensive neuronal degeneration</strong> and <strong>gliosis</strong> of the anterior horns of the spinal cord and brainstem motor nuclei.</p>\n<p>Clinically SMA is classified into four types:</p>\n<ul>\n<li>SMA type I/ Werdnig-Hoffmann disease</li>\n<li>SMA type II</li>\n<li>SMA type III/ Kugelberg-Welander disease</li>\n<li>SMA type IV</li>\n</ul>\n<p><strong>SMA type I</strong> is seen before the age of <strong>six months.</strong> Children present with<strong> hypotonia</strong>, <strong>proximal muscle weakness</strong>, frog-leg posture, and<strong> tongue fasciculations</strong>. Involvement of the intercostal respiratory muscles causes a paradoxical abdominal breathing pattern and <strong>weak cough</strong>. Deep tendon reflexes are usually absent. It should be kept as one of the differential diagnoses for <strong>floppy infant syndrome</strong>.</p>\n<p><strong>SMA type II</strong> is seen between the age of <strong>6-18 months</strong>. Children present with <strong>developmental delay</strong>, scoliosis, speech, and deglutition problems.</p>\n<p>The proximal muscles involving the <strong>shoulder girdle</strong> are affected in <strong>SMA type III</strong>. <strong>Muscle hypertrophy</strong> might be present rather than atrophy.</p>\n<p><strong>SMA type IV</strong> (adult phenotype) presents with mild muscle weakness in the second or <strong>third decade</strong> of life.\u00a0</p>\n<p>The <strong>gold standard</strong> for diagnosis is testing for <strong>SMN1</strong> (survival motor neuron) <strong>gene deletion</strong>/ mutation. <strong>Supportive therapy</strong> enabling the patient to be maximally functionally independent is the mainstay in management.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/80b8a9a69a204fdd891855b8b5ae49e9.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old woman presents with progressively worsening pain, redness in the right eye for the last two days. She has a history of sarcoidosis. On examination, the right eye is inflamed around the cornea, the pupil is constricted, and reacts sluggishly to light. The iris appears muddy. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Acute bacterial conjunctivitis"
      },
      {
        "id": 2,
        "text": "Anterior uveitis"
      },
      {
        "id": 3,
        "text": "Endophthalmitis"
      },
      {
        "id": 4,
        "text": "Acute primary angle-closure glaucoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with progressively worsening eye pain and redness, constricted pupil reacting sluggishly to light, muddy iris, and a history of sarcoidosis is likely to have<strong> anterior uveitis</strong>.\u00a0</p>\n<p>Sarcoidosis is a systemic inflammatory disorder characterized by the formation of <strong>non-caseating granulomas</strong>.\u00a0Anterior uveitis is often a presenting symptom of sarcoidosis.</p>\n<p>Anterior uveitis presents with blurred vision, pain, photophobia, <strong>circumcorneal conjunctival injection</strong> (around the limbus) with an <strong>aqueous flare and keratin precipitates.</strong> The pupil is constricted and reacts sluggishly to light. The clear pattern of the <strong>iris</strong> is lost and it appears <strong>muddy.</strong></p>\n<p><strong>Slit-lamp examination</strong> shows the following <strong>signs </strong>in anterior uveitis:</p>\n<p>Corneal signs:\u00a0</p>\n<ul>\n<li>Keratic precipitates</li>\n</ul>\n<p>Anterior chamber signs:\u00a0</p>\n<ul>\n<li>Hypopyon</li>\n<li>Aqueous cells</li>\n<li>Aqueous flare</li>\n<li>Deep and irregular anterior chamber due to posterior synechiae</li>\n</ul>\n<p>Iris signs:\u00a0</p>\n<ul>\n<li>Loss of normal pattern</li>\n<li>Change in color \"muddy iris\"</li>\n<li>Posterior synechiae</li>\n</ul>\n<p>Pupillary signs:\u00a0</p>\n<ul>\n<li>Constricted pupil</li>\n<li>Irregular pupil shape</li>\n<li>Ectropion of uveal pigment</li>\n<li>Occlusion pupillae - blocked pupil due to extensive exudate</li>\n</ul>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Steroids and cycloplegics are the mainstay of management for uveitis.</p>\n</div>\n</div>\n<p><strong>Cycloplegics</strong></p>\n<ul>\n<li><strong>atropine</strong></li>\n<li><strong>Relieves spasm</strong> of iris sphincter and ciliary muscle</li>\n<li>Prevents the formation of synechiae</li>\n</ul>\n<p><strong>Steroids </strong>reduce inflammation by their anti-inflammatory effect<strong>\u00a0</strong></p>\n<p><strong>Systemic therapy</strong><strong>\u00a0</strong></p>\n<ul>\n<li>Steroids</li>\n<li>NSAIDs</li>\n<li><strong>Immunosuppressants</strong>\n<ul>\n<li>Used in severe cases</li>\n</ul>\n</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Acute bacterial conjunctivitis</strong> presents with pain, irritation, photophobia with hyperemia (<strong>pink eye</strong>), and <strong>purulent exudate</strong>. There is a diffuse conjunctival injection which is less seen in the circum-corneal region (as opposed to anterior uveitis)</p>\n<p>Option C: <strong>Endophthalmitis</strong> is the infection of the intra-ocular cavities which presents with <strong>severe pain</strong>, <strong>loss of vision, and lid edema.</strong> It is usually seen in post-operative cases of ocular trauma (exogenous) and patients hospitalized with severe bacterial, viral, or fungal infections (endogenous).</p>\n<p>Option D: <strong>Acute primary angle-closure glaucoma</strong> presents with severe <strong>unilateral eye pain</strong>, associated with headache and <strong>loss of vision</strong>. The examination shows a <strong>red congested eye</strong>, corneal edema with a<strong> shallow anterior chamber,</strong> and a\u00a0<strong>mid-dilated pupil</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You work under a research scientist who is working on determining the association of mesothelioma with a compound, labeled compound X. He uses a test whose steps are shown in the image below to determine the mutagenic effect and potential carcinogenicity of compound X. What is this test that he has used?",
    "choices": [
      {
        "id": 1,
        "text": "Comet test"
      },
      {
        "id": 2,
        "text": "Micro nucleus test"
      },
      {
        "id": 3,
        "text": "Microtox bio-assay"
      },
      {
        "id": 4,
        "text": "Ames test"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span data-preserver-spaces=\"true\">The image shows the\u00a0</span><strong><span data-preserver-spaces=\"true\">Ames test.</span></strong></p>\n<p><strong><span data-preserver-spaces=\"true\">Ames test</span></strong> is a widely used <strong>biological assay</strong> to assess the <strong>mutagenic potential</strong> of <strong>chemical compounds</strong>. It<span data-preserver-spaces=\"true\">\u00a0uses bacteria to test if the given chemical can cause mutations in the test organism's DNA<strong>.\u00a0</strong></span><span data-preserver-spaces=\"true\">A positive test indicates that the chemical is mutagenic and therefore may act as a carcinogen because cancer is often linked to mutation.</span></p>\n<p><span data-preserver-spaces=\"true\">The Ames test uses the principle of <strong>flocculation.\u00a0</strong></span><span data-preserver-spaces=\"true\">Ames test does not determine the nature of carcinogenesis.</span><span data-preserver-spaces=\"true\">\u00a0The rationale of the test is that greater than 90% of all chemical mutagens are carcinogenic in subsequent animal tests.\u00a0</span><span data-preserver-spaces=\"true\">The bacterium used in the test is a strain of\u00a0</span><strong><span data-preserver-spaces=\"true\">Salmonella typhimurium</span></strong><span data-preserver-spaces=\"true\">\u00a0that carries a defective (mutant) gene making it unable to synthesize the amino acid histidine.</span></p>\n<p>A<strong><span data-preserver-spaces=\"true\">\u00a0drawback</span></strong>\u00a0is that the<strong><span data-preserver-spaces=\"true\">\u00a0</span></strong><span data-preserver-spaces=\"true\"><strong>compounds that alter epigenetic factors</strong> (such as <strong>DNA methylation</strong>) would <strong>test negative in the Ames test.\u00a0</strong></span></p>\n<p>Other options:</p>\n<p>Option A:<strong> Comet assay\u00a0</strong>is a single gel electrophoresis technique to measure DNA damage and repair at the individual cell level. Fragments of DNA pulled through agarose gel in an electric field will appear as a 'Comet.' It is generally used in\u00a0human and ecological biomonitoring.</p>\n<p>Option B: <strong>Micronucleus</strong><strong> testing (</strong>MN test) is one of the valid tests used as a quick check for detection of acute disorders caused by chemical substances in cells that have undergone cell division.\u00a0</p>\n<p>Option C: <strong>Microtox Bio-assay</strong>\u00a0uses photo-luminescent bacteria to analyze acute chemical toxicity.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c1fb45f11a214fd8bbcd88aa35b2e85b.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 7-year-old girl has numerous vesicles on her face, particularly around her mouth as shown below. Over a few days, the vesicles turn into pustules and crust over, becoming flaky and light yellow in color. The girl's 40-year old uncle develops similar lesions after visiting for 1 week during the child's illness. Which of the following statements about the organism most likely responsible for this girl\u2019s infection is correct?",
    "choices": [
      {
        "id": 1,
        "text": "Sabouraud\u2019s agar is required to culture this bacterium"
      },
      {
        "id": 2,
        "text": "The bacterium is a facultative intracellular organism"
      },
      {
        "id": 3,
        "text": "The bacterium is bacitracin-sensitive"
      },
      {
        "id": 4,
        "text": "The bacterium is a group B \u03b2-hemolytic organism"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The history along with the image showing\u00a0honey-crusted/ golden-crusted /yellowish-brown crusted lesions\u00a0are characteristic of <strong>impetigo\u00a0</strong>caused by Streptococcus pyogenes.</p>\n<p>S. pyogenes is a gram-positive group A \u03b2-hemolytic organism that is <strong>bacitracin-sensitive</strong>.\u00a0</p>\n<p>Impetigo is a<strong> contagious</strong>, superficial bacterial skin infection characterized by an eruption of vesicles on the face. These vesicles later turn into pustules with a characteristic honey-colored crust.\u00a0It is very common in<strong> children,</strong> and in particular during <strong>summer</strong>. It spreads by <strong>direct contact</strong> with discharges from the scab of an infected person.</p>\n<p>If it is <strong>mild</strong>, management includes removing crusts, washing skin using <strong>disinfectants</strong>.<strong> Topical antibiotics </strong>should be applied twice a day for a week.</p>\n<p>If it has<strong> extensive skin involvement, bullous disease, or lymphadenopathy</strong>, treatment should include <strong>systemic antibiotics</strong> like flucloxacillin along with localized skin treatment.</p>\n<p>Other options-</p>\n<p>Option A- Sabouraud\u2019s agar is required to culture fungi, not Streptococcus pyogenes.</p>\n<p>Option B- Streptococcus pyogenes is not a facultative intracellular organisms. Mycobacterium, Brucella, Francisella, Listeria, Yersinia, Legionella, and Salmonella are a few examples of facultative intracellular organisms.</p>\n<p>Option C- Streptococcus pyogenes is not a group B \u03b2-hemolytic organism. It is a group A \u03b2-hemolytic organism. Streptococcus agalactiae is a group B \u03b2-hemolytic organism.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f0e8f45b0a404418b4c3d6fe8c89eca1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f2352c386dc24aedb7407db4105cd6f1x600x1123.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c9aaf9f51f4e4776b3c0c7782ebfba04x1280x2558.JPEG"
    ]
  },
  {
    "text": "A 40-year-old male is diagnosed to have Meniere's disease. He says he constantly gets vertiginous episodes when exposed to loud sounds. Which of the following term can be used to describe this symptom?",
    "choices": [
      {
        "id": 1,
        "text": "Tumarkin\u2019s otolithic crisis"
      },
      {
        "id": 2,
        "text": "Tullio phenomenon"
      },
      {
        "id": 3,
        "text": "Lermoyez syndrome"
      },
      {
        "id": 4,
        "text": "Vestibular hydrops"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Tullio phenomenon </strong>describes&nbsp;the vertiginous episodes associated with exposure to loud noise in a patient with Meniere's disease. This phenomenon is due to the <strong>distended saccule </strong>lying against the <strong>stapes footplate.</strong></p>\n<p><strong>Tumarkin&rsquo;s otolithic crisis (drop attacks)&nbsp;</strong>is when a patient with Meniere&rsquo;s develops<strong> sudden drop attacks without loss of consciousness</strong>. It is an uncommon manifestation. Pathogenesis not well understood.</p>\n<p><strong>Lermoyez syndrome -&nbsp;</strong>Here symptoms of Meniere's disease are seen in reverse order. Initially, there is a <strong>progressive deterioration of hearing,</strong> followed by an attack of <strong>vertigo.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What type of study is shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Case\u2013control study"
      },
      {
        "id": 2,
        "text": "Nested case control study"
      },
      {
        "id": 3,
        "text": "Prospective cohort study"
      },
      {
        "id": 4,
        "text": "Retrospective cohort study"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The study shown is a <strong>prospective cohort study</strong>.\u00a0</p>\n<p>A cohort study is a type of analytical study, which progresses from\u00a0<strong>cause to effect,</strong>\u00a0as exposure has occurred but not disease. It is also known as a\u00a0<strong>forward-looking study</strong>, <strong>incidence study</strong>,<strong> prospective study, and longitudinal study</strong>.<strong>\u00a0</strong>It can be<strong>\u00a0</strong>divided into:</p>\n<ul>\n<li><strong>Prospective\u00a0cohort studies</strong>:\u00a0Outcome has not occurred at the time of the beginning of the investigation\u00a0</li>\n<li><strong>Retrospective</strong>\u00a0<strong>cohort studies</strong>: Outcome has occurred before the beginning of the investigation\u00a0</li>\n<li><strong>Combination cohort studies</strong>:\u00a0Both retrospective and prospective elements are combined</li>\n</ul>\n<p>A cohort is a group of individuals who share a <strong>common experience</strong> or <strong>characteristic</strong> within a <strong>defined time period</strong>.\u00a0The cohort groups are selected before the appearance of the disease under investigation. They are divided into <strong>study</strong> and <strong>control cohorts</strong>. The study cohorts are exposed to a particular factor thought to be related to the disease occurrence whereas the control cohorts are not exposed to this particular factor.\u00a0\u00a0</p>\n<p>Studying the effects of exposure to <strong>uranium</strong> in causing<strong> lung cancer</strong> is an example of a cohort study. <strong>Uranium miners</strong> are taken as the <strong>study</strong>\u00a0<strong>cohort </strong>and other individuals who are <strong>not exposed to uranium</strong> mining are taken as the <strong>control cohort</strong>.\u00a0</p>\n<p>Note: In a\u00a0<strong>nested case-control study</strong>, cases of disease that have occurred in a defined cohort are identified. A specified number of matched <strong>controls</strong> who have <strong>not</strong> <strong>developed </strong>the <strong>disease</strong> are then selected from the cohort.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c2c3e88c75354d7fbb370bb726df54ba.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A newborn was found to have a following anomaly of the penile urethra while being examined by a pediatrician. Identify the incorrect statement regarding the condition.",
    "choices": [
      {
        "id": 1,
        "text": "It is the most common congenital abnormality of the urethra"
      },
      {
        "id": 2,
        "text": "Circumcision should be done to remove the excess skin"
      },
      {
        "id": 3,
        "text": "It does not cause urinary obstruction"
      },
      {
        "id": 4,
        "text": "Ventral\u00a0chordee is a common association"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image showing a newborn having a urethral meatus that opens on the underside of the penis is indicative of&nbsp;<strong>hypospadias</strong>. <strong>Circumcision should not be done</strong> in hypospadias as the foreskin will be used for surgical reconstruction.</p>\n<p>Hypospadias&nbsp;is the most common <strong>congenital abnormality of the urethra.&nbsp;</strong>It is characterized by the combination of:</p>\n<ul>\n<li>A <strong>ventrally</strong>&nbsp;placed urethral meatus&nbsp;(underside of penis or perineum)</li>\n<li>Poor development of the ventral aspect of the prepuce (resulting in <strong>hooded foreskin)</strong></li>\n<li><strong>Ventral</strong>&nbsp;<strong>chordee</strong> (bending of the penis)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5ec5ec6428c14c278f7c3625aad688ec.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1acd96af2a024d718463d238bd9a5f93x600x747.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf89df7753cc4c5ba7cb6d0affc8ad12x448x510.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e2199c750caf49f29fb7abea9892b61dx1043x1053.JPEG"
    ]
  },
  {
    "text": "During the evaluation of a psychiatric patient, the psychiatrist asks her the meaning of proverbs like a stitch in time saves nine, and similarities between a chair, table, and sofa. What is the doctor assessing?",
    "choices": [
      {
        "id": 1,
        "text": "Test judgement"
      },
      {
        "id": 2,
        "text": "Abstract thinking"
      },
      {
        "id": 3,
        "text": "Social judgement"
      },
      {
        "id": 4,
        "text": "Insight"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Similarities </strong>or<strong> differences</strong> between things, meanings of proverbs are asked during the assessment of <strong>abstract thinking</strong> of the patient.</p>\n<p>Other options:</p>\n<p>Option A<strong>- Test judgment</strong> is assessed by asking the patient what he would do in <strong>hypothetical situations</strong>, such as what the patient would do if he sees a house on fire, or what the patient would do if he sees a sealed, stamped, addressed envelope lying on a street.</p>\n<p>Option C<strong>- Social judgment </strong>is the ability to perceive social situations and&nbsp;act accordingly. It is assessed by observing if the behavior of the patient is appropriate or not, if it is causing any harm to the patient, or is not acceptable by society.</p>\n<p>Option D- <strong>Insight</strong> is the degree of personal <strong>awareness</strong> and understanding of the disease. It can have 5 grades.&nbsp;</p>\n<ol>\n<li>Complete denial of illness.</li>\n<li>Slight awareness of being sick and needing help but denying it at the same time.</li>\n<li>Awareness of being sick, but is attributed to external, physical factors or unknown factors.</li>\n<li>Intellectual insight- Awareness of being ill, and that the symptoms are due to own particular irrational feelings and thoughts. However, this knowledge is not applied to future behavior.</li>\n<li>Emotional insight-Awareness of being ill, and that the symptoms are due to own particular irrational feelings and thoughts. The patient also makes significant changes in the personality and future behavior.</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 36-year-old male presented to the OPD with purplish, itchy, flat-topped bumps on his shins along with a fine reticular lacy pattern on the oral mucosa as shown in the below image. Which of the following nail changes is most specific in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Dorsal Nail Pterygium"
      },
      {
        "id": 2,
        "text": "Subungal oil patch sign"
      },
      {
        "id": 3,
        "text": "Pup tent sign"
      },
      {
        "id": 4,
        "text": "Thinning of nail plate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-preserver-spaces=\"true\">The clinical features of <strong>purplish, itchy, flat-topped </strong>lesions on shins and white streaks forming a lacework in the buccal mucosa, <strong>Wickham's striae,</strong> shown in the image are diagnostic of </span><strong><span data-preserver-spaces=\"true\">Lichen planus</span></strong><span data-preserver-spaces=\"true\">. Among all the nail changes seen in\u00a0Lichen planus,\u00a0</span><strong><span data-preserver-spaces=\"true\">Dorsal nail pterygium </span></strong>is<span data-preserver-spaces=\"true\">\u00a0the <strong>most specific nail finding</strong>.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f2aa45a112a64ed786eb2bcb71a6870e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3cabc34d353f4d1bb1e7af9051f7c596x760x488.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a4119491df504e4f832d4a6dd3b46714x1280x2068.JPEG"
    ]
  }
];
        let quizName = 'Neet  Mini - 7 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>