<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 10 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The opening in the central tendon of the diaphragm transmits ______",
    "choices": [
      {
        "id": 1,
        "text": "Aorta"
      },
      {
        "id": 2,
        "text": "Esophagus"
      },
      {
        "id": 3,
        "text": "Right phrenic nerve branch"
      },
      {
        "id": 4,
        "text": "Left gastric artery branch"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>right phrenic nerve </strong>passes<strong> through the central tendon</strong> of the diaphragm, either<strong> by the caval hiatus or just lateral to it</strong>.</p>\n<p>The <strong>left phrenic nerve</strong> passes through the muscular part of the diaphragm <strong>anterior to the central tendon</strong>, just lateral to the left cardiac surface and more anterior than the right phrenic nerve.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea88322317d5432e85a75bcb99c31dcax800x585.JPEG"
    ]
  },
  {
    "text": "Primary active transport is mediated by which one of the following enzymes?",
    "choices": [
      {
        "id": 1,
        "text": "G-Protein"
      },
      {
        "id": 2,
        "text": "Na+-K+ ATPase"
      },
      {
        "id": 3,
        "text": "Carrier protein"
      },
      {
        "id": 4,
        "text": "Channel protein"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The primary active transport is mediated by\u00a0<strong>Na+-K+ ATPase.</strong></p>\n<p>In active transport, the energy is provided almost exclusively by the<strong> hydrolysis </strong>of <strong>ATP</strong>. Hence active transport is mediated by <strong>ATPases</strong> (eg. <strong>Na+-K+-ATPase</strong>), enzymes that catalyze the hydrolysis of ATP.</p>\n<p><strong>Carrier proteins</strong> can mediate both primary and secondary active transports while the Na/K-ATPase is a primary active transport protein.</p>\n<table style=\"width: 319px;\">\n<tbody>\n<tr>\n<td style=\"width: 166px;\"><strong>PRIMARY ACTIVE TRANSPORT</strong></td>\n<td style=\"width: 155px;\"><strong>SECONDARY ACTIVE TRANSPORT</strong></td>\n</tr>\n<tr>\n<td style=\"width: 166px;\">Requires <strong>direct input of metabolic energy </strong>in the form of adenosine triphosphate <strong>(ATP) </strong>\u00a0</td>\n<td style=\"width: 155px;\">The transport of two or more solutes is coupled and metabolic energy is provided\u00a0 <strong>indirectly</strong> from the Na<sup>+</sup> gradient that is maintained across cell membranes by the\u00a0<strong>Na<sup>+</sup>-K<sup>+</sup>-ATPase pump</strong></td>\n</tr>\n<tr>\n<td style=\"width: 166px;\">\n<p>a) <strong>Na<sup>+</sup>-K<sup>+</sup>-ATPase</strong> or sodium-potassium pump</p>\n<p>b) Ca<sup>2+</sup>-ATPase</p>\n<p>c) H<sup>+</sup>-ATPase (proton pump)</p>\n<p>d) H<sup>+</sup>-K<sup>+</sup>-ATPase</p>\n</td>\n<td style=\"width: 155px;\">\n<p>a)<strong> Na<sup>+</sup>- glucose cotransport</strong> (SGLT)</p>\n<p>b) <strong>Na<sup>+</sup>-Ca<sup>2+</sup> counter transport</strong></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Other options :</p>\n<p>Option A: <strong>G-proteins</strong> are molecular switches inside cells that transmit signals from receptors to trigger cellular responses. They play a crucial role in processes like <strong>hormone</strong> <strong>signalling, sensory perception</strong>, and<strong> cell growth</strong>.</p>\n<p>Option C: <strong>Carrier proteins</strong> are membrane proteins that transport specific molecules across cell membranes by binding to them and undergoing conformational changes. They facilitate the movement of substances like ions, <strong>glucose</strong>, and <strong>amino acids</strong> into or out of cells.</p>\n<p>Option D: <strong>Channel proteins</strong> are membrane proteins that form <strong>pores</strong>, allowing the <strong>passive</strong> movement of specific ions or molecules across the cell membrane. They facilitate processes like ion flow in nerve cells and <strong>water transport</strong> in <strong>kidney cells.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following forms complex I of the electron transport chain?",
    "choices": [
      {
        "id": 1,
        "text": "Q-cytochrome c oxidoreductase"
      },
      {
        "id": 2,
        "text": "Succinate-Q reductase"
      },
      {
        "id": 3,
        "text": "NADH-Q oxidoreductase"
      },
      {
        "id": 4,
        "text": "Cytochrome c oxidase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Complex I of the electron transport chain (ETC) is&nbsp;<strong>NADH-Q oxidoreductase.</strong></p>\n<p>The ETC constitutes 4 enzyme complexes:</p>\n<ul>\n<li><strong>Complex I: NADH-Q oxidoreductase</strong></li>\n<li>Complex II: Succinate-Q reductase</li>\n<li>Complex III: Q-cytochrome c oxidoreductase</li>\n<li>Complex IV: cytochrome c oxidase</li>\n</ul>\n<p>Components of complex I: <strong>FMN</strong> and <strong>Fe-S complex&nbsp;</strong></p>\n<p><strong>Mechanism:</strong> NADH-Q oxidoreductase catalyzes the transfer of electrons, from NADH to coenzyme Q, along with the transfer of <strong>four H+</strong> across the membrane.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old woman presents with bilateral adnexal masses and ascites. Histopathological examination of resected specimen shows sheets of mucin-producing signet-ring cells. The most likely diagnosis is ____.",
    "choices": [
      {
        "id": 1,
        "text": "Serous papillary carcinoma"
      },
      {
        "id": 2,
        "text": "Benign cystic teratoma"
      },
      {
        "id": 3,
        "text": "Krukenberg tumour"
      },
      {
        "id": 4,
        "text": "Dysgerminoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis with the above clinical interpretation is metastatic signet-ring carcinoma called <strong>Krukenberg tumor.</strong></p>\n<ul>\n<li>Krukenberg tumor is a <strong>metastatic signet-ring cell adenocarcinoma of the ovary,&nbsp;</strong>accounting for 1% to 2% of all ovarian tumors.</li>\n<li>Primary sites: Stomach (70%); Carcinomas of the colon, appendix, and breast (mainly invasive lobular carcinoma)</li>\n<li>Often bilateral</li>\n<li><strong>Microscopically</strong>, it is composed chiefly of <strong>mucin-laden signet-ring cells</strong> with eccentric hyperchromatic nuclei.</li>\n</ul>\n<p>Image showing metastastic signet-ring cells in Krukenberg tumor</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9f62d536f6049dfb561d22395d02d76x1280x960.JPEG"
    ]
  },
  {
    "text": "Water lily sign is seen in infection due to _____",
    "choices": [
      {
        "id": 1,
        "text": "T. solium"
      },
      {
        "id": 2,
        "text": "T. saginata"
      },
      {
        "id": 3,
        "text": "H. nana"
      },
      {
        "id": 4,
        "text": "E. granulosus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Water lily sign is seen in hydatid cyst, an infection due to&nbsp;<strong>Echinococcus granulosus.</strong></p>\n<p>Hydatid Cyst is a zoonotic infection caused by the&nbsp;<strong>Echinococcus species&nbsp;</strong>(dog tapeworm). Dogs are the definitive hosts of E. granulosus. Sheep are the usual intermediate hosts, but humans are accidental intermediate hosts. Humans are end-stage hosts of the parasite since there is <strong>no human-to-human transmission.</strong></p>\n<p>The clinical presentation of a<strong>&nbsp;hydatid cyst</strong>&nbsp;is mainly <strong>asymptomatic</strong>&nbsp;until complications occur. The&nbsp;most common presenting symp&shy;toms&nbsp;are&nbsp;<strong>abdominal pain,</strong>&nbsp;dyspepsia, and vomiting. The&nbsp;most frequent sign&nbsp;is&nbsp;<strong>hepatomegaly.</strong></p>\n<p>The&nbsp;<strong>water-lily sign</strong>&nbsp;is seen in hydatid infections when there is&nbsp;<strong>detachment of the endocyst membrane, resulting</strong>&nbsp;in&nbsp;<strong>floating membranes within the pericyst</strong>&nbsp;that mimic the appearance of a water lily, on&nbsp;<strong>USG.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f74794bf4873408d9318fd2626fb09bdx1280x817.PNG"
    ]
  },
  {
    "text": "A patient with severe persistent asthma continues to have symptoms despite being on high-dose ICS-LABA therapy. Which of the following is a leukotriene receptor antagonist, appropriate as an add-on therapy for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Dupilumab"
      },
      {
        "id": 2,
        "text": "Roflumilast"
      },
      {
        "id": 3,
        "text": "Zafirlukast"
      },
      {
        "id": 4,
        "text": "Zileuton"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: left;\"><strong>Zafirlukast</strong> can be&nbsp;used as<strong>&nbsp;an add-on therapy</strong> in this patient.</p>\n<p style=\"text-align: left;\"><strong>Zafirlukast </strong>and montelukast are <strong>leukotriene receptor antagonists</strong>. They are competitive antagonists of the cysLT1 receptors. These drugs act by:&nbsp;</p>\n<ul>\n<li style=\"text-align: left;\">Decreasing bronchoconstriction</li>\n<li style=\"text-align: left;\">Reducing airway mucus secretion</li>\n<li style=\"text-align: left;\">Decreasing vascular permeability and</li>\n<li style=\"text-align: left;\">Reducing eosinophil chemotaxis&nbsp;</li>\n</ul>\n<p>Leukotriene modifiers are less effective than inhaled corticosteroids (ICS) in controlling asthma. They are used as<strong> add-on therapy</strong> in some patients whose asthma is not controlled with low doses of ICS.</p>\n<p style=\"text-align: left;\">Option A: Dupilumab is an <strong>interleukin-4 receptor antagonist</strong> used in severe asthma.&nbsp;</p>\n<p style=\"text-align: left;\">Option B: Roflumilast is a<strong> PDE-4 selective inhibitor</strong> used in the treatment of COPD.</p>\n<p style=\"text-align: left;\">Option D: Zileuton is a<strong> lipoxygenase inhibitor</strong> that can be used in the treatment of asthma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Under McNaughten's rule, which of the following criteria is not valid to clear a mentally unsound person of all responsibility?",
    "choices": [
      {
        "id": 1,
        "text": "Evidence of psychiatric illness"
      },
      {
        "id": 2,
        "text": "Presence of uncontrollable impulse"
      },
      {
        "id": 3,
        "text": "Psychiatric illness while committing the crime"
      },
      {
        "id": 4,
        "text": "Inability to understand that the act is wrong"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The criterion of the\u00a0<strong>presence of uncontrollable impulse\u00a0</strong>is <strong>not</strong> included in <strong>McNaughten's rule</strong>. Therefore, it is not a valid criterion to clear a mentally unsound person of all criminal responsibility.</p>\n<p><strong>McNaughten's rule</strong> is followed by the British Courts of law to examine the liability of a mentally unsound person who has committed a crime.\u00a0<strong>Sec. 84 IPC (BNS Section 22) </strong>is the Indian adaptation of this rule.\u00a0</p>\n<p>McNaughten's rule forms the basis of the\u00a0<strong>legal test of insanity/the 'right or wrong' test.\u00a0</strong>It states that a mentally unsound person is cleared of all criminal responsibility for the crime committed if the following criteria are met:</p>\n<ul>\n<li>Presence of evidence of psychiatric illness.</li>\n<li>Existence of psychiatric illness at the time of the commission of the crime.</li>\n<li>Psychiatric illness is of such a degree that the person does not have the ability to understand the wrongness of the act, i.e., impaired intellectual ability.\u00a0</li>\n</ul>\n<p>McNaughten's rule decides a person's soundness of mind based on the presence or absence of intellectual ability. However, it fails to consider any impairments in the person's emotional state or the presence of any <strong>uncontrollable/ irresistible impulses\u00a0</strong>while committing the act.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Waldeyer\u2019s group of lymph nodes do not include",
    "choices": [
      {
        "id": 1,
        "text": "Tonsils"
      },
      {
        "id": 2,
        "text": "Submandibular lymph node"
      },
      {
        "id": 3,
        "text": "Lingual tonsils"
      },
      {
        "id": 4,
        "text": "Adenoids"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Waldeyer&rsquo;s Ring</strong></p>\n<p>Scattered throughout the pharynx in its <strong>subepithelial layer</strong> is the lymphoid tissue which is aggregated at places to form masses, collectively called <strong>Waldeyer&rsquo;s ring</strong>. </p>\n<p>The masses are: </p>\n<ul>\n<li>Nasopharyngeal tonsil or the <strong>adenoids</strong> </li>\n<li>Palatine tonsils or simply the <strong>tonsils</strong> </li>\n<li><strong>Lingual tonsil</strong> </li>\n<li>Tubal tonsils (in fossa of Rosenm&uuml;ller) </li>\n<li><strong>Lateral pharyngeal bands </strong></li>\n<li><strong>Nodules</strong> (in posterior pharyngeal wall)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a56954bd132f4b6ca7235558b1fe7b06x1280x1254.JPEG"
    ]
  },
  {
    "text": "Identify the refractive error shown in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Hypermetropia"
      },
      {
        "id": 2,
        "text": "Myopia"
      },
      {
        "id": 3,
        "text": "Astigmatism"
      },
      {
        "id": 4,
        "text": "Emmetropia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows parallel rays of light converging at a <strong>point in front of the retina</strong>.&nbsp;This is seen in <strong>myopia</strong>.</p>\n<p><strong>Definitions</strong> of refractive errors:</p>\n<p><strong>Myopia&mdash;</strong><strong>Short-sightedness:&nbsp;</strong>The parallel rays of light coming from infinity are focussed in <strong>front of the retina</strong> when accommodation is at rest.</p>\n<p><strong>Hypermetropia&mdash;Long-sightedness:&nbsp;</strong>The parallel rays of light coming from infinity are focused <strong>behind the retina</strong> when accommodation is at rest.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8939af36aea542b5a67c99c8a74e8f58.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/036dd86a07454a3eac801a11b0987a50x1280x1589.JPEG"
    ]
  },
  {
    "text": "A study was conducted on a group of 500 patients having carcinoma lung and another group of 300 was chosen from the general population. Both these groups were questioned on their exposure to smoking. What kind of study is this?",
    "choices": [
      {
        "id": 1,
        "text": "Cohort study"
      },
      {
        "id": 2,
        "text": "Cross-sectional study"
      },
      {
        "id": 3,
        "text": "Ecological study"
      },
      {
        "id": 4,
        "text": "Case-control study"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This is a case&ndash;control study. In this scenario, <strong>500 patients</strong>&nbsp;constitute the <strong>cases</strong> and <strong>300 people</strong>&nbsp;constitute the <strong>controls,&nbsp;</strong>and the study is done from <strong>effect to cause as the disease has already occurred.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Example of multiphasic screening is _____",
    "choices": [
      {
        "id": 1,
        "text": "Chest X-ray for TB in large populations"
      },
      {
        "id": 2,
        "text": "Annual health checkups"
      },
      {
        "id": 3,
        "text": "Pap smear in women above 40 years"
      },
      {
        "id": 4,
        "text": "Random blood sugar during antenatal visits"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Example of multiphasic screening is <strong>annual health checkups</strong>.</p>\n<p><strong>Multiphasic screening</strong> is the application of <strong>two or more screening tests</strong> in combination to a large number of people <strong>at one time</strong>.</p>\n<p><strong>High-risk</strong> or <strong>selective</strong> screening is done on <strong>high-risk groups </strong>example<strong>-&nbsp;</strong>MRI screening of breast done annually in 25-year old women with BRCA 1, BRCA 2 mutations in first degree relative .</p>\n<p>Pap smears screening&nbsp;as per American Cancer Society (ACS) should start at age 21. Women aged &lt;21 years should not be screened regardless of the age of sexual initiation or other risk factors.&nbsp;</p>\n<p><strong>Mass screening</strong> is a screening of a whole or <strong>large population</strong> like using chest X-ray for TB screening in large populations. It is done for diseases with high prevalence.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Given below is an image of a patient with fever and rash. When is the spread of this disease the maximum?",
    "choices": [
      {
        "id": 1,
        "text": "After formation of scab"
      },
      {
        "id": 2,
        "text": "Just before and after the onset of rash"
      },
      {
        "id": 3,
        "text": "One week before onset of rash"
      },
      {
        "id": 4,
        "text": "During convalescence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image depicts the <strong>rash of chickenpox</strong>, as <strong>different stages</strong> of the rash can be seen <strong>at one time.</strong> The communicable period of chickenpox is <strong>2 days before</strong> and <strong>5 days after</strong> the onset of rash.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8d4dd272da014f0d8ced3a925d40e65b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the gold standard investigation for diagnosis of COVID-19?",
    "choices": [
      {
        "id": 1,
        "text": "Chemiluminescence immune assay"
      },
      {
        "id": 2,
        "text": "Enzyme linked immunosorbent assay"
      },
      {
        "id": 3,
        "text": "Rapid antigen test"
      },
      {
        "id": 4,
        "text": "Reverse transcription - polymerase chain reaction test"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>gold standard</strong> for the diagnosis of Covid-19 is the identification of viral genome targets in the respiratory tract materials by <strong>reverse transcriptase&nbsp;polymerase chain reaction (RT-PCR)</strong>&nbsp;during the first week of symptoms.</p>\n<p><strong>RT-PCR:</strong> This method involves the reverse transcription of the genetic material of the virus (RNA) to complementary DNA (cDNA), followed by amplification of some regions of the cDNA.</p>\n<p><strong>Rapid antigen test (RAT):</strong> Antigen-based assays are used as point-of-care tests for early detection of SARS-CoV-2. They are used at the field level for early detection of infection and quick containment. Most of such tests have relatively moderate sensitivity but high specificity. They are used for diagnosis along with RT-PCR.&nbsp;</p>\n<p><strong>Antibody testing</strong>: Antibodies of IgA, IgM, and IgG isotypes specific to different virus proteins are detected by enzyme-linked immunosorbent assay (ELISA) or chemiluminescence immunoassays (CLIA). CLIA is more sensitive compared to ELISA.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old man is brought to the emergency department following a road traffic accident. During the evaluation, the patient opens his eyes in response to voice and says inappropriate words. He is unable to move his right arm but extends his left arm to a painful stimulus on his right arm. What is the GCS score of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "7"
      },
      {
        "id": 2,
        "text": "8"
      },
      {
        "id": 3,
        "text": "9"
      },
      {
        "id": 4,
        "text": "10"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The GCS score of the patient described is <strong>8</strong> (E3 V3 M2).</p>\n<p>In the case elaborated above, the score allotted is :</p>\n<ul>\n<li>Eye-opening to speech&mdash;3</li>\n<li>Inappropriate words&mdash;3</li>\n<li>Extensor response to painful stimuli&mdash;2</li>\n</ul>\n<p>Patients scoring a <strong>GCS</strong> of<strong>&nbsp;3 or 4</strong>&nbsp;have an&nbsp;85% chance<strong>&nbsp;</strong>of<strong>&nbsp;dying</strong>&nbsp;or&nbsp;<strong>remaining vegetative.</strong></p>\n<p>However,&nbsp;<strong>scores &gt;11&nbsp;</strong>indicate only a 5&ndash;10% likelihood of death or vegetative state and an&nbsp;85%<strong>&nbsp;</strong>chance of<strong>&nbsp;moderate disability</strong>&nbsp;or&nbsp;<strong>good recovery</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A lady presents with fever, oral ulcers, photosensitivity and rash on her face as seen below. What is the diagnosis ?",
    "choices": [
      {
        "id": 1,
        "text": "Dermatomyositis"
      },
      {
        "id": 2,
        "text": "Systemic lupus erythematosus"
      },
      {
        "id": 3,
        "text": "Rosacea"
      },
      {
        "id": 4,
        "text": "Melasma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most probable diagnosis from the given clinical scenario and image is <strong>systemic lupus erythematosus </strong>(SLE).</p>\n<p>The rash visualized in the image is a <strong>malar rash</strong>. It is characterized by a well-demarcated erythematous <strong>butterfly rash</strong> over the malar eminences with sparing of the nasolabial folds.</p>\n<p>Cutaneous manifestations seen in SLE are:</p>\n<ul>\n<li>Acute cutaneous lupus erythematosus (<strong>malar rash</strong>)</li>\n<li>Subacute cutaneous lupus erythematosus</li>\n<li>Discoid lupus erythematosus- DLE (<strong>discoid rash</strong>)</li>\n<li>Ulcerations in the oral mucosa</li>\n<li><strong>Alopecia</strong>- It is a non-scarring alopecia in the majority of the cases. However, patients with DLE will have scarring alopecia.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d590e752854944c0a982642d405cace9.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient comes with a blood pressure of 160/100 mmHg and left-sided facial paralysis and weakness since 1 hour. Her CT appears normal. What would be your next step?",
    "choices": [
      {
        "id": 1,
        "text": "Nothing, since CT was normal"
      },
      {
        "id": 2,
        "text": "Start on aspirin + clopidogrel"
      },
      {
        "id": 3,
        "text": "Intravenous thrombolysis"
      },
      {
        "id": 4,
        "text": "Advice BP control"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Sudden onset hemiparesis with apparently normal CT indicates <strong>ischemic stroke</strong> in this patient.</p>\n<p><strong>Intravenous thrombolysis</strong> (alteplase: 0.9 mg/kg ) should be immediately administered to patients with ischemic stroke who arrive in window period (within 3/4.5 hours of symptom onset).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Type of knot seen in below image is:",
    "choices": [
      {
        "id": 1,
        "text": "Half hitch knot"
      },
      {
        "id": 2,
        "text": "Reef knot"
      },
      {
        "id": 3,
        "text": "Surgeon\u2019s knot"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above given image shows <strong>Reef knot.</strong></p>\n<p><strong>Note:&nbsp;</strong>In granny knot, the second knot (superiormost) is seen to thread in the same direction as compared to the first knot .The knot is therefore not squared</p>\n<p><strong>Types of knot: </strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/093cda06d0274628aab3c09ed4097abb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f55ea6d1829494eace586d4ed0f7d07x1280x1883.JPEG"
    ]
  },
  {
    "text": "A woman is admitted to the hospital for the management of breast cancer. The tumor is 3 cm in size with ipsilateral mobile axillary lymph nodes. There is no distant metastasis. The TNM staging of tumor is:",
    "choices": [
      {
        "id": 1,
        "text": "T2 N1 M0"
      },
      {
        "id": 2,
        "text": "T1 N1 M0"
      },
      {
        "id": 3,
        "text": "T3 N2 M0"
      },
      {
        "id": 4,
        "text": "T2 N2 M0"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The TNM staging of the tumor is <strong>T2 N1 M0</strong>.</p>\n<ul>\n<li>Tumor size 3 cm:&nbsp;<strong>T2&nbsp;</strong></li>\n<li>Ipsilateral mobile axillary lymph nodes:&nbsp;<strong>N1</strong></li>\n<li>No distant metastasis: <strong>M0</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An infant delivered at full-term by normal vaginal delivery, presented with respiratory distress immediately after birth. Chest X-ray showed the following picture. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hyaline membrane disease"
      },
      {
        "id": 2,
        "text": "Meconium aspiration syndrome"
      },
      {
        "id": 3,
        "text": "Congenital diaphragmatic hernia"
      },
      {
        "id": 4,
        "text": "Transient tachypnea of the newborn"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above X-ray chest shows <strong>intra-thoracic bowel shadows</strong> along with <strong>mediastinal shift</strong> suggestive of <strong>congenital diaphragmatic hernia</strong>.</p>\n<p>The common clinical presentation is as follows:</p>\n<ul>\n<li>Respiratory distress</li>\n<li>Dextrocardia</li>\n<li>Scaphoid abdomen</li>\n</ul>\n<p>Prenatal diagnosis is done by <strong>ultrasonography</strong>.&nbsp;<strong>Lung-to-head ratio</strong> (LHR) is used to assess severity in patients with left-sided CDH. An LHR value of <strong>&lt;1</strong>&nbsp;is associated with a very <strong>poor</strong> prognosis, whereas an LHR <strong>&gt;1.4</strong> predicts a more <strong>favourable</strong> outcome.</p>\n<p>Option A: <strong>Hyaline membrane disease</strong> is a syndrome in premature infants caused by developmental <strong>insufficiency</strong> of pulmonary <strong>surfactant</strong> production and structural immaturity in the lungs.</p>\n<p>Option B: <strong>Meconium aspiration syndrome</strong>&nbsp;is the aspiration of meconium-stained amniotic fluid, which can occur before, during or immediately after birth. Meconium is the first intestinal discharge from newborns, a viscous, dark-green substance composed of intestinal epithelial cells, lanugo, mucus, and intestinal secretions.</p>\n<p>Option D: During normal delivery, the compression of the rib cage while passing through the mother's vaginal canal helps to remove fluid from the lungs. However, newborns who are delivered via <strong>cesarean</strong> birth may have excess fluid in the lungs and therefore be <strong>hypoxic</strong> and develop <strong>transient tachypnea.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/893b34cb69f042bb810b403f5d7d9fd7.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "All are true about the inguinal canal except _________.",
    "choices": [
      {
        "id": 1,
        "text": "Conjoint tendon forms a part of the posterior wall."
      },
      {
        "id": 2,
        "text": "Superficial ring is an opening in the external oblique aponeurosis."
      },
      {
        "id": 3,
        "text": "Deep ring is an opening in the transverse abdominis."
      },
      {
        "id": 4,
        "text": "Internal oblique forms both the anterior and posterior walls."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>The deep inguinal ring is an opening in the transversalis fascia,</strong> not in the transverse abdominis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old woman at 9 weeks of gestation comes to the clinic for check-up following an MTP. On ultrasound, retained tissue was found and the following instrument was used for its removal. What is this instrument?",
    "choices": [
      {
        "id": 1,
        "text": "Karmann syringe"
      },
      {
        "id": 2,
        "text": "Suction apparatus"
      },
      {
        "id": 3,
        "text": "Manual vacuum aspiration syringe"
      },
      {
        "id": 4,
        "text": "Menstrual regulation syringe"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The image shows a <strong>manual vacuum aspiration </strong>(MVA)<strong> syringe.</strong></p>\n<p class=\"p1\">Manual vacuum aspiration<strong>&nbsp;</strong>can be safely done upto 12 weeks of gestation. However, WHO recommends it as the&nbsp;<strong>procedure of choice </strong>for MTP only upto <strong>10 weeks</strong>&nbsp;of gestation .&nbsp;</p>\n<p class=\"p1\">The <strong>indications </strong>of this procedure<strong>&nbsp;</strong>are given as follows:</p>\n<ul>\n<li class=\"p1\">Medical termination of pregnancy</li>\n<li class=\"p1\"><strong>Incomplete abortion</strong> or missed abortion</li>\n<li class=\"p1\">Molar pregnancy</li>\n<li class=\"p1\">Endometrial aspiration</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/31687d2f476841eeba39ef33ad54ca4d.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf9fee03a89840be808f4b2eee9a2f54x1280x1875.PNG"
    ]
  },
  {
    "text": "The partogram of a 28 year old G2P1 is shown below. What is the next step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Wait and watch"
      },
      {
        "id": 2,
        "text": "Oxytocin infusion"
      },
      {
        "id": 3,
        "text": "Forceps"
      },
      {
        "id": 4,
        "text": "Caesarean section"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above partogram shows a case of <strong>obstructed labour</strong> and management is a&nbsp;<strong>caesarean section.</strong></p>\n<p>There is a secondary arrest of dilatation for &gt;2 hours and arrest of descent for &gt;1 hour. The patient has adequate uterine contractions as shown. The amniotic fluid is stained with meconium and there is fall in fetal heart rate which indicates that the baby is in distress.</p>\n<p>There is no place for wait and watch and use of oxytocin to stimulate uterine contractions in obstructed labor.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ce55b49d913e4c5bad95ced0456a1db8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the investigation of choice in a 55-year-old woman who presents with post-menopausal bleed?",
    "choices": [
      {
        "id": 1,
        "text": "Pap smear"
      },
      {
        "id": 2,
        "text": "Endometrial biopsy"
      },
      {
        "id": 3,
        "text": "Fractional curettage"
      },
      {
        "id": 4,
        "text": "CA-125 estimation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Endometrial biopsy&nbsp;</strong>is the investigation of choice in a case of <strong>post-menopausal bleed</strong>, as the chances of <strong>endometrial cancer</strong> are quite high.</p>\n<p>For those who undergo TVUS and have an <strong>EEC</strong> (endometrial echo complex) <strong>&gt;4 mm</strong>, localized thickening, or an <strong>indistinct</strong> or nonvisible EEC, <strong>endometrial sampling</strong> is a reasonable next step.</p>\n<p>Investigations for endometrial carcinoma include:</p>\n<ul>\n<li><strong>Endometrial aspiration biopsy </strong>is the&nbsp;first investigation in abnormal uterine bleeding, especially in females &gt;35 years.</li>\n<li>Dilatation and fractional curettage&nbsp;was the best method to diagnose but now it is not used.</li>\n<li><strong>Hysteroscopy and biopsy </strong>is the investigation of choice for endometrial cancer.</li>\n<li><strong>Transvaginal USG </strong>is used as an&nbsp;<strong>adjunct</strong> to endometrial biopsy.</li>\n<li>Pap smear is&nbsp;not reliable to diagnose endometrial carcinoma.&nbsp;It is more useful as a screening tool rather than a diagnostic tool.</li>\n</ul>\n<p>If symptoms of postmenopausal bleeding persist, imaging of the endometrial cavity should be performed with one or a combination of the following: TVUS, contrast sonography, or hysteroscopy.</p>\n<p>Note:&nbsp;<strong>Surgical staging</strong> is the gold standard investigation for staging endometrial carcinoma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman recently became pregnant following a history of repeated abortions. She was anxious and wanted to undergo karyotyping this time to detect chromosomal disorders pre-natally. Barr body was found to be absent in her report. Which of the following is associated with an absent Barr body?",
    "choices": [
      {
        "id": 1,
        "text": "46 XX"
      },
      {
        "id": 2,
        "text": "45 X0"
      },
      {
        "id": 3,
        "text": "47 XXX"
      },
      {
        "id": 4,
        "text": "47 XXY"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Barr body is absent in female having <strong>45 X0 genome</strong>.</p>\n<p><strong>Barr body</strong></p>\n<ul>\n<li>Densely staining inactivated condensed X chromosome present in each somatic cell of a female is found in the nucleus.</li>\n<li>Chromatid body (Barr body or sex chromatin) is derived from one of the two X chromosomes which become inactivated.</li>\n<li>The number of Barr bodies is thus one less than the number of X chromosomes.</li>\n</ul>\n<p><strong>Turner's syndrome </strong>is female without Barr body.</p>\n<p><strong>Klinefelter's syndrome </strong>is male with Barr body.</p>\n<p><strong>Note: </strong></p>\n<ul>\n<li><span style=\"color: #000000;\"><strong>Lyon hypothesis</strong> states that only one of the two X chromosomes in a female is functional, the other becomes inactive during embryogenesis.</span></li>\n<li><span style=\"color: #000000;\"><strong>Davidson bodies</strong> are small nuclear buds of chromatin shaped like a drumstick found in neutrophils of females.</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the prosthesis in the given image:",
    "choices": [
      {
        "id": 1,
        "text": "Austin- Moore Prosthesis"
      },
      {
        "id": 2,
        "text": "Thompson Prosthesis"
      },
      {
        "id": 3,
        "text": "Charnley\u2019s Prosthesis"
      },
      {
        "id": 4,
        "text": "Muller\u2019s Prosthesis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows <strong>thompson prosthesis</strong>.</p>\n<p>Thompson prosthesis is<strong> used in hemiarthroplasty </strong>to replace the head of femur. It is specially indicated in cases where neck of femur is absorbed.&nbsp;It can be used with or without cement.</p>\n<p>Note: <strong>Austin-Moore</strong> prosthesis contains<strong> two fenestrations</strong> in the stem which are for the growth of bone and <strong>thompson prosthesis</strong> has no fenestrations.</p>\n<h3 class=\"ng-binding\">&nbsp;</h3>\n<p>&nbsp;Below X-Ray and the image shows&nbsp;Austin-Moore Prosthesis:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a483838fa19846e09d37cb4e0ee4c4ec.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d01d80e31d524cb88b68b5b44445e3eex268x359.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5ef79f057fbe42f08f8d0f88c133c91cx800x600.JPEG"
    ]
  },
  {
    "text": "A 37-year-old man with a history of chronic alcohol use stopped drinking. Three days later, he was brought to the emergency department with disorientation, tremors, hallucinations, and hypertension. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Alcoholic hallucinosis"
      },
      {
        "id": 2,
        "text": "Korsakoff's psychosis"
      },
      {
        "id": 3,
        "text": "Delirium tremens"
      },
      {
        "id": 4,
        "text": "Marchiafava-Bignami disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical features of a chronic alcoholic man brought in with complaints of disorientation, tremors, hallucinations, and hypertension is suggestive of <strong>delirium tremens.</strong></p>\n<p><strong>Delirium tremens</strong> occurs after <strong>2-4 days of abstinence</strong> in a heavy or chronic drinker. It is precipitated by conditions like hepatitis and pancreatitis. It usually resolves in one week. The characteristic <strong>clinical features</strong> include:</p>\n<ul>\n<li>Clouding of consciousness with <strong>disorientation</strong> in time and place</li>\n<li>Distractibility and lack of attention</li>\n<li>Visual, auditory, and/or tactile <strong>hallucinations</strong></li>\n<li><strong>Autonomic disturbance</strong> with tachycardia, fever, hypertension, sweating, and pupillary dilatation</li>\n<li>Psychomotor agitation and ataxia</li>\n<li>Insomnia</li>\n<li>Dehydration with electrolyte imbalance</li>\n</ul>\n<p>Delirium tremens is treated using <strong>benzodiazepines</strong> starting with a higher dosage which is gradually tapered as withdrawal symptoms disappear. In cases of chronic alcohol use, vitamin deficiency (especially thiamine) may be co-existing and hence bolus doses of <strong>thiamine</strong> are given to prevent/treat Wernicke encephalopathy.</p>\n<p>Other options:</p>\n<p><strong><strong>Option A- Alcoholic hallucinosis </strong></strong>is<strong><strong>\u00a0</strong></strong>characterized by the presence of <strong>hallucinations</strong> (usually auditory) during partial or complete abstinence. However, the other symptoms given in the clinical scenario are not seen.</p>\n<p><strong>Option B- Korsakoff\u2019s psychosis:</strong> It is seen n patients with chronic alcohol use usually followed by\u00a0Wernicke\u2019s encephalopathy, together referred to as Wernicke-Korsakoff syndrome. Patients with Korsakoff's psychosis present with memory disturbances, which is not seen in the given case.</p>\n<p><strong>Option C- Marchiafava-Bignami disease</strong> is a rare disorder seen in chronic alcoholics, associated with epilepsy, ataxia, dysarthria, hallucinations, spastic limb paralysis, and deterioration of personality and intellectual functioning.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the device shown below:",
    "choices": [
      {
        "id": 1,
        "text": "Magill's circuit"
      },
      {
        "id": 2,
        "text": "Lack's circuit"
      },
      {
        "id": 3,
        "text": "Bain's circuit"
      },
      {
        "id": 4,
        "text": "Jackson and Rees' circuit"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shown above is of <strong>Lack's circuit</strong>, which is a <strong>co-axial modification </strong>of <strong>Mapleson's A circuit.</strong></p>\n<p>Co-axial circuits&nbsp;have two tubings, one inner and one outer tubing (arranged co-axially).</p>\n<p>Lack's circuit has:</p>\n<ul>\n<li><strong>Inner expiratory</strong> tubing: carries exhaust gases out through APL valve</li>\n<li><strong>Outer inspiratory</strong> tubing: carries fresh gas flow to the patient</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c1f86e07d8da44c293d598d18ca4f879.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3be90b634b914ffd9e93530873ebcc87x825x569.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc1db33bf5be49b0827191f777920467x169x81.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c577f368d7bc4969bc82e53ae3716744x173x83.PNG"
    ]
  },
  {
    "text": "Which of the following conditions is associated with an increased nighttime itching and lesions that are more during the winter months?",
    "choices": [
      {
        "id": 1,
        "text": "Tinea corporis"
      },
      {
        "id": 2,
        "text": "Scabies"
      },
      {
        "id": 3,
        "text": "Psoriasis"
      },
      {
        "id": 4,
        "text": "Photodermatosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Skin lesions that increase during the winter months and that cause more itching during the nighttime are seen with <strong>scabies</strong>.</p>\n<p><strong>Scabies</strong> is an ectoparasitic skin infection that is transmitted through the means of close <strong>personal contact/fomites</strong>. It is caused by the mite<strong> Sarcoptes scabiei var hominis </strong>or human itch mite. It leads to severe <strong>pruritis, excoriating papules,</strong> and<strong> burrows. </strong>The pruritis typically shows <strong>nocturnal exacerbations.</strong> In adults, the face is often spared. Typical sites include the <strong>finger webs</strong>, the flexor surfaces of the wrists, elbows, axillae, buttocks, and genitalia. The typical lesions of scabies are<strong> burrows</strong>.</p>\n<p>The following techniques can be used to <strong>diagnose scabies</strong>:</p>\n<ul>\n<li><strong>Skin scraping and microscopy</strong> - The material is scraped off with a blunt scalpel and is placed in mineral oil on a microscope slide. The presence of mites, eggs, fragments of eggshells, or scybala (hardened masses of faeces) confirms the diagnosis.</li>\n<li><strong>Dermoscopy</strong> - Useful for detecting burrows and visualizing their contents.\n<ul>\n<li><strong>10x magnification</strong> - mini triangle sign, maturing eggs that show minute heads of maturing mites within the egg.</li>\n<li><strong>40x magnification</strong> - The mite in its burrow resembles a \u2018<strong>jet\u2010with\u2010contrail</strong>\u2019.</li>\n</ul>\n</li>\n<li><strong>Adhesive-tape test</strong> - After firmly applying the adhesive side of the tape onto an appropriate skin lesion of patient, the tape is pulled off and transferred directly onto a slide for microscopy to visualize the mites.</li>\n<li><strong>Skin biopsy.</strong></li>\n</ul>\n<p>Treatment:</p>\n<ul>\n<li>A single overnight application of<strong> 5% permethrin </strong>cream from neck to toe in adults and from head to toe in children is the drug of choice for the treatment of scabies in all ages including infants (at least 2 months old) and pregnant women.</li>\n<li><strong>Topical sulfur applications</strong> can be safely used in infants less than 2 months of age, as well as in breastfeeding and pregnant mothers.</li>\n<li><strong>Topical 1% Lindane cream</strong> is <strong>contraindicated</strong> in children, pregnant ladies, and seizure disorders as it is known to cause neurotoxicity.</li>\n<li>All family members, even if asymptomatic, need to be treated simultaneously for this condition to prevent reinfection.</li>\n<li>Clothing needs to be disinfected simultaneously.</li>\n<li><strong>Ivermectin </strong>and<strong> benzyl benzoate </strong>are <strong>contraindicated</strong> in pregnancy.</li>\n</ul>\n<p>The image below shows a photo of a scabies burrow. The large scaly patch at the left is due to scratching. At the upper right, the scabies mite can be seen at the end of the burrow.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5e191fa28649490bbd89bb50328ba948x1280x1091.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ecea1cbc3b384b039748928647098029x720x894.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3030fd52127b4a82ae22837c44415cddx512x475.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bd6482f9395c4db39a4ea9f339be08e9x800x273.JPEG"
    ]
  },
  {
    "text": "Identify the investigation shown below which is the investigation of choice in distal bowel tumours.",
    "choices": [
      {
        "id": 1,
        "text": "Enteroclysis"
      },
      {
        "id": 2,
        "text": "Barium meal"
      },
      {
        "id": 3,
        "text": "Barium meal follow-through"
      },
      {
        "id": 4,
        "text": "Barium enema"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Enteroclysis, </strong>which&nbsp;is the <strong>investigation of choice</strong> in patients with <strong>small bowel tumors.</strong></p>\n<p>Enteroclysis is a <strong>barium study</strong>&nbsp;in which the <strong>contrast </strong>agent is put <strong>directly into the duodenum</strong> through a <strong>nasogastric tube.</strong></p>\n<p>Continued infusion of 500 to 1000 mL of thin barium sulfate and methylcellulose suspension is done and then viewed continuously with the use of either fluoroscopy or radiographs taken at frequent intervals. This technique is a <strong>double-contrast</strong> procedure that allows detailed imaging of the entire small intestine.</p>\n<p>Enteroclysis has a<strong> sensitivity </strong>of over <strong>90%</strong> in the detection of small bowel tumors and is the <strong>investigation of choice</strong>, particularly for<strong> tumors </strong>located in the <strong>distal small bowel.</strong></p>\n<p>Advantages of enteroclysis:</p>\n<ul>\n<li>The contrast is administered at a controlled rate directly in the small bowel, <strong>bypassing the regulatory action</strong> of the <strong>pylorus</strong>.</li>\n<li>The <strong>entire small bowel </strong>is demonstrated in a <strong>distended</strong> state, allowing <strong>better diagnosis</strong>. As a result of the dilatation, the following can be visualized:\n<ul>\n<li>Mild strictures</li>\n<li>Small sinus tracts and fistulas</li>\n<li>Minimal extrinsic compressions</li>\n<li>Skip lesions</li>\n<li>Proximal and distal extent of diffuse diseases.</li>\n</ul>\n</li>\n<li>The examination can be completed in <strong>15&ndash;30 minutes</strong>, thus reducing patient waiting time.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dec6089a80e24fd4929144518fe6c8af.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a natural source of radiation exposure?",
    "choices": [
      {
        "id": 1,
        "text": "Cosmic rays"
      },
      {
        "id": 2,
        "text": "K-40"
      },
      {
        "id": 3,
        "text": "C-14"
      },
      {
        "id": 4,
        "text": "X-rays"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>X-rays</strong>&nbsp;are not a natural source of radiation exposure. They are <strong>artificially produced</strong> by linear accelerators.</p>\n<p><strong>Sources of radiation exposure:</strong></p>\n<p>Natural:</p>\n<ul>\n<li><strong>Cosmic rays</strong></li>\n<li>Environmental - terrestrial and atmospheric</li>\n<li>Radioactive isotopes - of potassium <strong>(K-40)</strong> and carbon <strong>(C-14)</strong></li>\n</ul>\n<p>Man-made:</p>\n<ul>\n<li>Medical and dental - X-rays, radioisotopes</li>\n<li>Occupational exposure</li>\n<li>Nuclear - radioactive fallout</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 10';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>