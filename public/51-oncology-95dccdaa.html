<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>51 Oncology - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Surgery
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">13</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>Which of the following is the most common type of soft tissue sarcoma in adults?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Leiomyosarcoma"
      },
      {
        "id": 2,
        "text": "Liposarcoma"
      },
      {
        "id": 3,
        "text": "Rhabdomyosarcoma"
      },
      {
        "id": 4,
        "text": "Angiosarcoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: </strong> <strong>B) Liposarcoma</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Liposarcoma remains the <strong>most commo</strong>n soft tissue <span class=\"customMeta\" data-dictid=\"82068425041692777198fe3064c370\">sarcoma</span> in<strong> adults. </strong></p>\n\n<h4><strong>Liposarcoma </strong></h4>\n\n<ul>\n\t<li>\n\t<h4><strong>Origin: </strong>A <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> tumour arises from<strong> adipocytes or fat cells. </strong></h4>\n\t</li>\n\t<li><strong>Characteristics:</strong> Liposarcomas are typically large at the time of diagnosis, often because they grow in the<strong> <span class=\"customMeta\" data-dictid=\"4f9c0b029b16927771972a49a1d6b4\">retroperitoneum</span> </strong>or other deep tissues where they can expand without causing early symptoms. They can vary from well-differentiated to poorly differentiated, with the latter being more aggressive.</li>\n\t<li><strong>Presentation:</strong> Patients may present with a painless, enlarging mass. In the retroperitoneum, symptoms may be related to the <span class=\"customMeta\" data-dictid=\"56af81fad316927771843d2b4b1e4f\">compression</span> of nearby organs.</li>\n\t<li><strong>HPE</strong> reveals a tumour composed of <strong>adipocytes with <span class=\"customMeta\" data-dictid=\"06123ff61a1692777182e19b790ebc\">atypical</span> <span class=\"customMeta\" data-dictid=\"fc5f7fef0e169277719952d19a4532\">spindle</span> cells.</strong></li>\n</ul>\n\n<p><img alt=\"\" data-author=\"Mikael H\u00e4ggstr\u00f6m\" data-hash=\"\" data-license=\"CC0\" data-source=\"https://en.wikipedia.org/wiki/Liposarcoma#/media/File:Histopathology_of_liposarcoma,_annotated.jpg\" data-tags=\"\" height=\"378\" src=\"https://image.prepladder.com/content/wn1TlgLUENtFm5s5uqG91739095165.png\" width=\"1028\" /></p>\n\n<p><strong>Leiomyosarcoma</strong> <strong>(Option A) </strong>arises from smooth muscle and is another common type of soft tissue <span class=\"customMeta\" data-dictid=\"82068425041692777198fe3064c370\">sarcoma</span> but less common than liposarcoma.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Rhabdomyosarcoma(Option C)</strong> is more commonly seen in children and arises from skeletal muscle.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Angiosarcoma(Option D</strong>)<strong> </strong>is a <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> tumour that arises from the endothelial cells lining blood vessels or <span class=\"customMeta\" data-dictid=\"4fb6bd90f016927771918d4a2993ed\">lymphatic</span> channels.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/wn1TlgLUENtFm5s5uqG91739095165.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/sL4HFKrgqilstOpx1fsY1747202650.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/8pauW77YonNfVd9b9A3g1747202695.mp3"
  },
  {
    "text": "<p>A 60-year-old male presents with a rapidly enlarging mass in the retroperitoneal area. Imaging reveals a large, heterogeneous mass with areas of necrosis. A biopsy confirms the diagnosis of dedifferentiated liposarcoma<strong>. </strong>What is the most common cause of death in patients with this condition?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Hemorrhage due to tumour rupture"
      },
      {
        "id": 2,
        "text": "Metastasis to lungs"
      },
      {
        "id": 3,
        "text": "Infection secondary to immunosuppression"
      },
      {
        "id": 4,
        "text": "Local recurrence leading to organ failure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) <span class=\"customMeta\" data-dictid=\"d3251bfb0b1692777192b069d7ba4a\">Metastasis</span> to lungs</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>Metastasis is the most common <span class=\"customMeta\" data-dictid=\"254dc5106d1692777183ba9ab1b3e5\">cause of death</span> in patients with <span class=\"customMeta\" data-dictid=\"ffb779b5ad1692777189091a0aef76\">high-grade</span> soft tissue sarcomas, including dedifferentiated liposarcoma.</li>\n\t<li>Soft tissue sarcomas often invade nearby blood vessels, allowing cancer cells to enter the <span class=\"customMeta\" data-dictid=\"f3739d892c1692777184b2e134615c\">circulatory</span> system.</li>\n\t<li>Vascular invasion is a significant <span class=\"customMeta\" data-dictid=\"cfb6c738351692777196f69788a66e\">prognostic</span> indicator, suggesting a higher likelihood of <strong>hematogenous spread.</strong></li>\n\t<li>The most common site of <span class=\"customMeta\" data-dictid=\"d3251bfb0b1692777192b069d7ba4a\">metastasis</span> in soft tissue <span class=\"customMeta\" data-dictid=\"82068425041692777198fe3064c370\">sarcoma</span> is <strong>Lung</strong>.</li>\n</ul>\n\n<p><strong>Process of metastasis</strong><strong> </strong></p>\n\n<p><img alt=\"\" data-author=\"na\" data-hash=\"\" data-license=\"na\" data-source=\"na\" data-tags=\"\" height=\"652\" src=\"https://image.prepladder.com/content/s69eJVNvvdMomqyrksSs1739095467.png\" width=\"500\" /></p>\n\n<p>\u00a0</p>\n\n<ul>\n\t<li>Metastasis typically indicates a poorer <span class=\"customMeta\" data-dictid=\"e580b4033e169277719609af594c16\">prognosis</span> and may require <span class=\"customMeta\" data-dictid=\"8f2e7fd96116927771995b451b5c90\">systemic</span> treatments and local management and local management.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Haemorrhage due to tumour <span class=\"customMeta\" data-dictid=\"e73553a3a5169277719787fd5f4680\">rupture</span> (Option A)</strong> can occur, especially with significant <span class=\"customMeta\" data-dictid=\"526ede3fee169277720184378acc5e\">vascular</span> involvement or during surgery, but it is not the leading cause of death.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Infection secondary to <span class=\"customMeta\" data-dictid=\"498d3df3a416927771894f595a597a\">immunosuppression</span> (Option C)</strong> can be a complication, particularly in patients undergoing treatment, but it is less common as a primary <span class=\"customMeta\" data-dictid=\"254dc5106d1692777183ba9ab1b3e5\">cause of death</span> compared to metastasis.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Local <span class=\"customMeta\" data-dictid=\"1d849ebc9b1692777197d4af1fa8d2\">recurrence</span> leading to organ failure (Option D</strong>) occurs when a tumour reappears at or near the site of the original tumour after treatment<strong>,</strong> but it is also less commonly the primary <span class=\"customMeta\" data-dictid=\"254dc5106d1692777183ba9ab1b3e5\">cause of death</span> compared to metastatic spread.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/s69eJVNvvdMomqyrksSs1739095467.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/oso09qfW5T2Vgy3Y80an1747202757.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/DrWwjp2A5E4I9vrzGHnD1747202804.mp3"
  },
  {
    "text": "<p>Which of the following malignant tumours is known for spreading through both hematogenous and lymphatic routes?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Liposarcoma"
      },
      {
        "id": 2,
        "text": "Leiomyosarcoma"
      },
      {
        "id": 3,
        "text": "Angiosarcoma"
      },
      {
        "id": 4,
        "text": "Rhabdomyosarcoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Angiosarcoma</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>Angiosarcoma is a <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> tumour that arises from the <strong>endothelial cells lining blood vessels. </strong></li>\n\t<li>It has a higher propensity to metastasise via the <span class=\"customMeta\" data-dictid=\"4fb6bd90f016927771918d4a2993ed\">lymphatic</span> system than other sarcomas.</li>\n\t<li><strong>History of radiation therapy</strong><strong> </strong>is a significant risk factor.</li>\n\t<li>Clinically, it presents as a <strong>red-brown, indurated, and ulcerated skin lesion</strong><strong>. </strong></li>\n\t<li>It can spread through <strong>lymphatic and <span class=\"customMeta\" data-dictid=\"33bb6837aa169277718854a46f5cbd\">hematogenous</span> routes</strong>, but due to the tumour's <span class=\"customMeta\" data-dictid=\"526ede3fee169277720184378acc5e\">vascular</span> nature, <span class=\"customMeta\" data-dictid=\"33bb6837aa169277718854a46f5cbd\">hematogenous</span> spread (via blood vessels) is more common.</li>\n\t<li>The<strong> liver and lungs</strong> are common sites of metastasis, reflecting the tumour's aggressive nature.</li>\n</ul>\n\n<p><img alt=\"\" data-author=\"Jun Ho Choi, Kyung Chan Ahn, Hak Chang, Kyung Won Minn, Ung Sik Jin, and Byung Jun Kim\" data-hash=\"\" data-license=\"CC by SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Three_types_of_scalp_angiosarcoma.jpg\" data-tags=\"\" height=\"582\" src=\"https://image.prepladder.com/content/h4qTAhPtqLbaanunCAZL1739101160.png\" width=\"970\" /></p>\n\n<p>\u00a0</p>\n\n<p>The majority of soft tissue sarcomas spread via the <span class=\"customMeta\" data-dictid=\"33bb6837aa169277718854a46f5cbd\">hematogenous</span> route; however, some exceptions primarily spread through the <span class=\"customMeta\" data-dictid=\"4fb6bd90f016927771918d4a2993ed\">lymphatic</span> system, including:</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:623px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Tumor Type</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Description</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Lymphatic Spread</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Angiosarcoma</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Malignant tumour from endothelial cells of blood vessels.</p>\n\t\t\t</td>\n\t\t\t<td rowspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>It can spread via <span class=\"customMeta\" data-dictid=\"4fb6bd90f016927771918d4a2993ed\">lymphatic</span> channels.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Synovial Sarcoma</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Arises near joints and <span class=\"customMeta\" data-dictid=\"d27f9c7a1b16927771999b1679d949\">synovial</span> tissues.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Sarcoma of Extremities</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Various sarcomas are located in limbs.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>It can spread to regional <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> nodes.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Gastrointestinal Stromal Tumor (GIST)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Originate from<strong> <span class=\"customMeta\" data-dictid=\"f46ba26d111692777190def3b1d80a\">interstitial</span> cells of Cajal </strong>in the <span class=\"customMeta\" data-dictid=\"b3a647ce2516927771881427f56c1d\">gastrointestinal</span> tract.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Primarily <span class=\"customMeta\" data-dictid=\"33bb6837aa169277718854a46f5cbd\">hematogenous</span> but can spread via lymphatics.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><strong>Liposarcoma </strong><strong>(Option A)</strong><strong>, <span class=\"customMeta\" data-dictid=\"2d1405c6701692777191187555755e\">Leiomyosarcoma</span> </strong><strong>(Option B)</strong><strong>, and <span class=\"customMeta\" data-dictid=\"70cc4b15ca16927771974963d9d96a\">Rhabdomyosarcoma</span> </strong><strong>(Option D) </strong>primarily spread hematogenously rather than through lymphatics.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/h4qTAhPtqLbaanunCAZL1739101160.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/4ZkrS90duiOTuAJ22Fn21747154449.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/zfzqXHUBjNrou5mgk5Un1747154752.mp3"
  },
  {
    "text": "<p>A 45-year-old male presents with a rapidly enlarging, painless mass in his right thigh, which has been growing over a few months. The mass is firm, deep-seated, and non-tender on examination. What is the investigation of choice for diagnosing the underlying condition in this patient?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Contrast-Enhanced CT (CECT)"
      },
      {
        "id": 2,
        "text": "MRI"
      },
      {
        "id": 3,
        "text": "Tru-cut biopsy"
      },
      {
        "id": 4,
        "text": "PET-CT"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer:</strong> <strong>C) Tru-cut biopsy</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The clinical presentation is characteristic of<strong> Liposarcoma, </strong>a <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> tumour arising from adipocytes (fat cells).</li>\n\t<li>The <span class=\"customMeta\" data-dictid=\"32b854324a1692777185c6c79fdc99\">definitive</span> diagnosis is made via histopathological examination, often through a <strong>tru-cut biopsy.</strong></li>\n</ul>\n\n<p><strong>Tru-cut biopsy</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Aspect</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Details</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Purpose</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>A minimally <span class=\"customMeta\" data-dictid=\"1c5272ad3d1692777190e71409d07a\">invasive</span> procedure to obtain a tissue sample from a suspicious mass or tumour for histopathological examination is often used to diagnose soft tissue sarcomas.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Procedure</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>A needle is inserted into the mass under <span class=\"customMeta\" data-dictid=\"fe3220767716927771892419444041\">imaging</span> guidance (e.g., ultrasound, CT) to retrieve a core of tissue for <span class=\"customMeta\" data-dictid=\"79067cb33316927771926965c3c0b5\">microscopic</span> analysis to determine the nature and characteristics of the tumour.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Advantages</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Minimally <span class=\"customMeta\" data-dictid=\"1c5272ad3d1692777190e71409d07a\">invasive</span> compared to <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> biopsy.</li>\n\t\t\t\t<li>Provides sufficient tissue for accurate <span class=\"customMeta\" data-dictid=\"1e9c8202241692777189dbac6cc062\">histological</span> diagnosis.</li>\n\t\t\t\t<li>Outpatient procedure with minimal recovery time.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Limitations</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>The sample size is relatively small, potentially not representing the entire tumour if it is heterogeneous.</li>\n\t\t\t\t<li>Risk of <span class=\"customMeta\" data-dictid=\"521de62abe16927771989a90d0e9e8\">sampling</span> error leading to potential misdiagnosis.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Contrast-enhanced CT (CECT) (Option A)</strong> helps assess the extent of the tumour and any potential <span class=\"customMeta\" data-dictid=\"d3251bfb0b1692777192b069d7ba4a\">metastasis</span> but is not <span class=\"customMeta\" data-dictid=\"32b854324a1692777185c6c79fdc99\">definitive</span> for diagnosing soft tissue sarcomas.</p>\n\n<p>\u00a0</p>\n\n<p><strong>MRI (Option B) </strong>is excellent for delineating the extent of the tumour and its relationship to surrounding structures, especially in soft tissues. It helps in <span class=\"customMeta\" data-dictid=\"e76ccaf0af1692777196a34b3fb8dc\">preoperative</span> planning but is not sufficient for <span class=\"customMeta\" data-dictid=\"32b854324a1692777185c6c79fdc99\">definitive</span> diagnosis.</p>\n\n<p>\u00a0</p>\n\n<p><strong>PET-CT (Option D) </strong>is useful for <span class=\"customMeta\" data-dictid=\"8ea2e3870f16927771990a138acbc1\">staging</span> and detecting <span class=\"customMeta\" data-dictid=\"d3251bfb0b1692777192b069d7ba4a\">metastasis</span> but not for initial diagnosis.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/zhO9baolrUCkvrUHcxZe1747202908.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/ygZv904MDOLpfz3Cmneq1747202957.mp3"
  },
  {
    "text": "<p>A 60-year-old male presents with a rapidly growing, painless mass in the upper arm. Imaging shows that the mass is located deep in the fascia, and biopsy results indicate poorly differentiated pleomorphic cells with high mitotic activity. What is the most important prognostic factor for this patient's soft tissue sarcoma?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Tumor Size"
      },
      {
        "id": 2,
        "text": "Presence of Necrosis"
      },
      {
        "id": 3,
        "text": "Depth of Tumor"
      },
      {
        "id": 4,
        "text": "Histological Grade"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) <span class=\"customMeta\" data-dictid=\"1e9c8202241692777189dbac6cc062\">Histological</span> Grade</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong>The<strong> <span class=\"customMeta\" data-dictid=\"1e9c8202241692777189dbac6cc062\">histological</span> grade</strong> is the most crucial <span class=\"customMeta\" data-dictid=\"cfb6c738351692777196f69788a66e\">prognostic</span> factor in soft tissue sarcomas, as it directly reflects the tumour's biological behaviour, aggressiveness, and potential response to therapy.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Prognostic factors for soft tissue sarcoma</strong></p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:647px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Prognostic Factor</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Importance</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Histological Grade</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Comprehensive assessment of tumour aggressiveness;</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Depth of Tumor</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Tumours deep into the <span class=\"customMeta\" data-dictid=\"65483c739e169277720294dce50377\">fascia</span> are more likely to be <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> and have a poorer prognosis. <strong>(Option</strong><strong> </strong><strong>C)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Size of Tumor</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Larger tumours (>5 cm) are more likely to be <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> and associated with a worse prognosis. <strong>(Option A)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Presence of Necrosis</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Indicates <span class=\"customMeta\" data-dictid=\"ffb779b5ad1692777189091a0aef76\">high-grade</span> tumours with aggressive behaviour. <strong>(Option B)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Vascular Invasion</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Associated with a higher risk of <span class=\"customMeta\" data-dictid=\"d3251bfb0b1692777192b069d7ba4a\">metastasis</span> and worse prognosis</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Perineural Invasion</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Suggests aggressive behaviour and the potential for local spread</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Positive <span class=\"customMeta\" data-dictid=\"17b5bd50d91692777197ea9cb7f468\">Resection</span> Margins</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Higher risk of <span class=\"customMeta\" data-dictid=\"1d849ebc9b1692777197d4af1fa8d2\">recurrence</span> if cancer cells remain at the edges of <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> resection</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/pPCmInXo9zBf6osWWCn81747203031.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/7vNq8d75AEaiCdtp950n1747203084.mp3"
  },
  {
    "text": "<p>In the surgical management of soft tissue sarcoma, which of the following criteria is most appropriate for achieving optimal outcomes?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Wide local excision with a 1 cm margin"
      },
      {
        "id": 2,
        "text": "Radical excision with removal of adjacent muscle groups"
      },
      {
        "id": 3,
        "text": "Wide local excision with a 2 cm margin"
      },
      {
        "id": 4,
        "text": "Radical excision with lymph node removal"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Wide local <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> with a 2 cm margin</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<p><strong>Wide local <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> with a 2 cm margin </strong>ensures complete tumour removal while preserving function and minimising tissue loss. This approach effectively reduces the risk of local recurrence.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Wide local <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> with a 1 cm margin (Option A)</strong> may be inadequate for many soft tissue sarcomas, potentially leading to higher rates of local recurrence.<strong> </strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Radical <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> with removal of adjacent muscle groups (Option B): </strong>It is often overly aggressive and can lead to unnecessary functional <span class=\"customMeta\" data-dictid=\"4885d5d0021692777189aac6dc80f7\">impairment</span> without significantly improving outcomes in most cases.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Radical <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> with <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> <span class=\"customMeta\" data-dictid=\"b10ce4acbf169277719323ffd12306\">node</span> removal (Option D)</strong> is generally not necessary for most soft tissue sarcomas, as they typically spread hematogenously rather than through lymphatics, and routine <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> <span class=\"customMeta\" data-dictid=\"b10ce4acbf169277719323ffd12306\">node</span> <span class=\"customMeta\" data-dictid=\"e42da316b916927771860f0ba81c19\">dissection</span> is not standard practice unless there is evidence of <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> <span class=\"customMeta\" data-dictid=\"b10ce4acbf169277719323ffd12306\">node</span> involvement.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/tXUynout5sKBtcZnMzYl1747204092.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/rlFuK4oI5cNmvYpARhk21747204139.mp3"
  },
  {
    "text": "<p>A 6-year-old boy has a rapidly growing 3 cm mass in his right cheek. Biopsy shows small round blue cells, alveolar patterns, eosinophilic cytoplasm with cross-striations, and positive immunochemistry for desmin and myogenin. What is the most likely diagnosis?</p>\n\n<p><img alt=\"\" data-author=\"KGH\" data-hash=\"\" data-license=\"CC by SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Uterine_carcinosarcoma_(5)_rhabdomyosarcomatous.jpg\" data-tags=\"\" height=\"493\" src=\"https://image.prepladder.com/content/B66wqpUmOExcHN74dp5O1739101669.png\" width=\"726\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Ewing sarcoma"
      },
      {
        "id": 2,
        "text": "Neuroblastoma"
      },
      {
        "id": 3,
        "text": "Rhabdomyosarcoma"
      },
      {
        "id": 4,
        "text": "Lymphoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) <span class=\"customMeta\" data-dictid=\"70cc4b15ca16927771974963d9d96a\">Rhabdomyosarcoma</span> </strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The clinical presentation and <span class=\"customMeta\" data-dictid=\"d69566338f1692777189ff10521054\">histopathology</span> features suggest <strong>Rhabdomyosarcoma</strong><strong>, </strong>a <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> tumour that arises from <span class=\"customMeta\" data-dictid=\"6d6e7d903b169277719662541dd5e2\">primitive</span> mesenchymal cells committed to the skeletal muscle lineage.</li>\n\t<li>It is the most common soft tissue <span class=\"customMeta\" data-dictid=\"82068425041692777198fe3064c370\">sarcoma</span> in <strong>children</strong> and <strong>adolescents. </strong></li>\n\t<li>It can occur anywhere in the body, but common sites include the <strong>head and neck, </strong>genitourinary tract, and extremities.</li>\n\t<li>It typically presents as a painless, rapidly growing mass, often in the head and neck region.</li>\n\t<li><strong>Histopathology </strong>reveals <strong>small round blue cells</strong> with features of skeletal muscle differentiation.</li>\n\t<li><strong>Immunohistochemistry </strong>confirms the diagnosis with positive for muscle markers like <strong>desmin, myogenin, and MyoD1.</strong></li>\n\t<li><strong>Treatment</strong> involves a <span class=\"customMeta\" data-dictid=\"65eb924d041692777193c679e12ca7\">multimodal</span> approach, including surgery, chemotherapy, and often radiation therapy.</li>\n\t<li><strong>Prognosis</strong> varies widely depending on subtype, location, stage, and age at diagnosis.</li>\n</ul>\n\n<p><img alt=\"\" data-author=\"KGH\" data-hash=\"\" data-license=\"CC by SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Uterine_carcinosarcoma_(5)_rhabdomyosarcomatous.jpg\" data-tags=\"\" height=\"470\" src=\"https://image.prepladder.com/content/EQ93XiEr5LRzFgGkbqyb1739101811.png\" width=\"693\" /></p>\n\n<p><strong>Ewing <span class=\"customMeta\" data-dictid=\"82068425041692777198fe3064c370\">Sarcoma</span> (Option A) </strong>typically presents with<strong> small, round blue cells with scant cytoplasm</strong> lacking muscle differentiation. It commonly affects bone or soft tissue in children and young adults and is often associated with the <strong>EWSR1-FLI1 <span class=\"customMeta\" data-dictid=\"a7dfeb385e1692777203302bcf142d\">fusion</span> gene.</strong></p>\n\n<p><img alt=\"\" data-author=\"Chia-Cheng Su Chien-Liang Liu Ching-Nan Lin Ying-Huei Lee Kun-Hung Shen\" data-hash=\"\" data-license=\"CC by NC ND \" data-source=\"https://www.researchgate.net/figure/HomereWright-type-rosettes-arrow-a-typical-histological-feature-of-primitive_fig11_257730884\" data-tags=\"\" height=\"517\" src=\"https://image.prepladder.com/content/qyKLDCebhH4TOpYQq0gA1739101953.png\" width=\"617\" /></p>\n\n<p><strong>Neuroblastoma (Option B)</strong> usually originates from the <strong>adrenal <span class=\"customMeta\" data-dictid=\"4744bb90c21692777188c8957f9faa\">gland</span> or <span class=\"customMeta\" data-dictid=\"5731c5431416927771999e54e2563b\">sympathetic</span> ganglia</strong> in <strong>young children.</strong> <span class=\"customMeta\" data-dictid=\"ebf8f256f3169277718992ac1b2330\">Histology</span> reveals small, round blue cells with<strong> Homer Wright rosettes</strong> and neurite-like processes, <strong>positive for <span class=\"customMeta\" data-dictid=\"92fc27430116927771991ab6dac762\">synaptophysin</span> and chromogranin.</strong></p>\n\n<p><img alt=\"\" data-author=\"Rayees Ahmad Sofi1, Sajad Bashir Khanday1, Manzoor Qadir Keng1, Junaid Salam Wani1, Ankur Goel1, Tufaila Shafi1\" data-hash=\"\" data-license=\"Open access\" data-source=\"https://www.ijcasereportsandimages.com/archive/2012/003-2012-ijcri/005-03-2012-sofi/ijcri-00503201255-sofi-full-text.php\" data-tags=\"\" height=\"451\" src=\"https://image.prepladder.com/content/eWcBrbVUlKTbRmYLkIso1739102186.png\" width=\"830\" /></p>\n\n<p><strong>Lymphoma (Option D) </strong>typically shows <strong>monomorphic <span class=\"customMeta\" data-dictid=\"32599f889a169277719169e3483e62\">lymphoid</span> cells</strong> and is identified by markers like <strong>CD20, CD3, or CD45. </strong>The presence of alveolar patterns, cross-striations, and muscle markers (desmin, myogenin) points to rhabdomyosarcoma, not lymphoma.</p>\n\n<p><img alt=\"\" data-author=\"KGH\" data-hash=\"\" data-license=\"CC by SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Hodgkin_lymphoma_(1)_mixed_cellulary_type.jpg\" data-tags=\"\" height=\"492\" src=\"https://image.prepladder.com/content/D2hLS4xFTpdiZc8Kjbyy1739102265.png\" width=\"651\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [
      "https://image.prepladder.com/content/B66wqpUmOExcHN74dp5O1739101669.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/EQ93XiEr5LRzFgGkbqyb1739101811.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/293ad2UtPgGAi26QluK41747204368.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/sMaL8v4hN9oTQPoCFCa41747204439.mp3"
  },
  {
    "text": "<p>A 58-year-old woman is diagnosed with a high-grade retroperitoneal liposarcoma. After treatment, her oncologist monitors for metastases. What's the most common site of metastasis for retroperitoneal sarcomas?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Lungs"
      },
      {
        "id": 2,
        "text": "Liver"
      },
      {
        "id": 3,
        "text": "Bone"
      },
      {
        "id": 4,
        "text": "Brain"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) Liver</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<p><strong>Retroperitoneal sarcomas, including liposarcomas, spreads primarily via the <span class=\"customMeta\" data-dictid=\"a74252404f1692777196d3f24bde2d\">portal</span> veain</strong><strong>, and the</strong><strong>\u00a0liver >Lungs is</strong>\u00a0the most common site of metastasis.</p>\n\n<ul>\n\t<li><strong>Retroperitoneal Sarcomas</strong> are rare, aggressive tumours often diagnosed late due to non-specific symptoms.</li>\n\t<li>Subtypes include liposarcoma, leiomyosarcoma, and <span class=\"customMeta\" data-dictid=\"f8aaf091221692777191f73e810e94\">malignant</span> <span class=\"customMeta\" data-dictid=\"5d6dfa73b316927772028f3cd60f7f\">fibrous</span> histiocytoma.</li>\n\t<li><strong>Treatment:</strong> Surgery is the mainstay, often followed by radiation or chemotherapy.</li>\n\t<li><strong>Prognosis:</strong> Depending on size, grade, and resectability, local <span class=\"customMeta\" data-dictid=\"1d849ebc9b1692777197d4af1fa8d2\">recurrence</span> is common.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p><strong>Bone metastases(Option C): </strong>Uncommon for <span class=\"customMeta\" data-dictid=\"5d0f37715816927771973ecda21336\">retroperitoneal</span> sarcomas but a primary metastatic site for prostate, breast, and lung cancers.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Brain metastases(Option D):</strong> Rare for <span class=\"customMeta\" data-dictid=\"5d0f37715816927771973ecda21336\">retroperitoneal</span> sarcomas but a common metastatic site for lung cancer, breast cancer, and melanoma.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/NIY6A3Of0HFfi0SDzGBo1749131297.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/mFrgbIVxtFldq0teyTS41749131348.mp3"
  },
  {
    "text": "<p>In unresectable or metastatic Dermatofibrosarcoma Protuberans (DFSP), which targeted therapy is considered the drug of choice?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Vemurafenib"
      },
      {
        "id": 2,
        "text": "Imatinib"
      },
      {
        "id": 3,
        "text": "Pembrolizumab"
      },
      {
        "id": 4,
        "text": "Dabrafenib"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) Imatinib</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong> <strong>Imatinib</strong>, a tyrosine <span class=\"customMeta\" data-dictid=\"9863da498e1692777190e1c6515b48\">kinase</span> inhibitor, is the drug of choice for unresectable or metastatic<strong> <span class=\"customMeta\" data-dictid=\"e7bca6aafa16927771869a5f74074a\">Dermatofibrosarcoma</span> Protuberans (DFSP)</strong> when surgery is not feasible.</p>\n\n<ul>\n\t<li>Targets the<strong> COL1A1-PDGFB <span class=\"customMeta\" data-dictid=\"a7dfeb385e1692777203302bcf142d\">fusion</span> protein</strong> present in most DFSP cases.</li>\n\t<li>Effectively inhibits tumour growth.</li>\n\t<li>Shown significant <span class=\"customMeta\" data-dictid=\"7f80be61231692777187391e91e867\">efficacy</span> in clinical trials for unresectable or metastatic DFSP.</li>\n</ul>\n\n<p><strong>Dermatofibrosarcoma Protuberans (DFSP): </strong></p>\n\n<ul>\n\t<li>It is a rare, <span class=\"customMeta\" data-dictid=\"5297b5833216927771910b7a85de53\">low-grade</span> <span class=\"customMeta\" data-dictid=\"82068425041692777198fe3064c370\">sarcoma</span> of the dermis.</li>\n\t<li>It is characterised by slow growth and local aggressiveness but rarely metastasises.</li>\n\t<li><strong>Clinical features:</strong> It presents as a firm, painless <span class=\"customMeta\" data-dictid=\"af71c1668e169277719542cf8f1364\">plaque</span> or <span class=\"customMeta\" data-dictid=\"6e6233ba551692777193c62c40bd5f\">nodule</span> on the trunk or extremities, often mistaken for a <span class=\"customMeta\" data-dictid=\"1bbae82f1f16927771824f797639fa\">benign</span> <span class=\"customMeta\" data-dictid=\"d5e7bb15851692777191b39417c26a\">lesion</span> initially.</li>\n\t<li><strong>Pathology:</strong> <span class=\"customMeta\" data-dictid=\"8ba7332e86169277720060bd4507c8\">Translocation</span> resulting in<strong> COL1A1-PDGFB fusion.</strong></li>\n\t<li><strong>Treatment:</strong>\n\t<ul>\n\t\t<li>Surgery with wide local <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> or <span class=\"customMeta\" data-dictid=\"c24dc7a0511692777193e0d2cdc4d4\">Mohs micrographic surgery</span> is the primary treatment.</li>\n\t\t<li>Targeted therapy with<strong> imatinib</strong> is used for unresectable or metastatic cases.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"Karthik C Vallam, Monica Bhagat, Vinay Shankhdhar & Sajid S Qureshi \" data-hash=\"\" data-license=\"Open access\" data-source=\"https://springerplus.springeropen.com/articles/10.1186/s40064-015-1125-1#Fig1\" data-tags=\"\" height=\"357\" src=\"https://image.prepladder.com/content/epOT9NmlRiRfpJPuVZIf1739104234.png\" width=\"287\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/epOT9NmlRiRfpJPuVZIf1739104234.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/TUHxQQ3H04QCv4FQtSdX1747205012.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/mALP90R7VkMOKXEYFeb31747205075.mp3"
  },
  {
    "text": "<p>Which of the following is NOT a critical metabolic derangement typically observed in tumour lysis syndrome?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Hyperkalemia"
      },
      {
        "id": 2,
        "text": "Hyperuricemia"
      },
      {
        "id": 3,
        "text": "Hypercalcemia"
      },
      {
        "id": 4,
        "text": "Hyperphosphatemia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) <span class=\"customMeta\" data-dictid=\"78912d4b7f16927771890c20495303\">Hypercalcemia</span> </strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li><strong>Tumor <span class=\"customMeta\" data-dictid=\"803b5ed1c8169277719190b446ac83\">lysis</span> syndrome (TLS)</strong> is a potentially life-threatening oncological emergency occurring when large numbers of cancer cells are rapidly destroyed.</li>\n\t<li>It results in several <span class=\"customMeta\" data-dictid=\"d92cbff33316927771927b4de10a5b\">metabolic</span> derangements, but <strong>hypercalcemia</strong> is not typically observed.</li>\n</ul>\n\n<ul>\n\t<li><strong>Metabolic derangements </strong>associated with Tumor <span class=\"customMeta\" data-dictid=\"803b5ed1c8169277719190b446ac83\">Lysis</span> Syndrome:\n\n\t<ul>\n\t\t<li>Hyperuricemia</li>\n\t\t<li>Hyperkalemia</li>\n\t\t<li>Hyperphosphatemia</li>\n\t\t<li>Hypocalcemia</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><img alt=\"\" data-author=\"NA\" data-hash=\"\" data-license=\"NA\" data-source=\"NA\" data-tags=\"\" height=\"919\" src=\"https://image.prepladder.com/content/JVAjI6QWjLmzcQUaVVx81739104583.png\" width=\"820\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/JVAjI6QWjLmzcQUaVVx81739104583.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/GKWfdlnhPOahZT6GpE6q1747205166.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/IhrWgOdTin8AWefNRcDP1747205219.mp3"
  },
  {
    "text": "<p>A 50-year-old male who has been taking chemotherapy for chronic leukaemia for 2 years was having shortness of breath, dizziness, and flank pain for 3 days. His investigations revealed elevated serum uric acid, phosphate and potassium levels and decreased calcium levels. Which of the following is not the management of this condition?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Aggressive hydration"
      },
      {
        "id": 2,
        "text": "Allopurinol"
      },
      {
        "id": 3,
        "text": "Bisphosphonates"
      },
      {
        "id": 4,
        "text": "Hemodialysis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Bisphosphonates</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The given clinical scenario suggests an oncological emergency known as <strong>Tumor <span class=\"customMeta\" data-dictid=\"803b5ed1c8169277719190b446ac83\">lysis</span> syndrome,</strong> in which bisphosphonates are not used for management.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Tumor <span class=\"customMeta\" data-dictid=\"803b5ed1c8169277719190b446ac83\">Lysis</span> Syndrome</strong></p>\n\n<ul>\n\t<li>An oncological emergency which results when the release of <span class=\"customMeta\" data-dictid=\"a621be29da16927771901bc91014d1\">intracellular</span> metabolites overwhelms the kidney\u2019s excretory capacity during cancer treatment.</li>\n\t<li>Due to tumour cell lysis, there is the release of <span class=\"customMeta\" data-dictid=\"ffa20262931692777201caef35de16\">uric</span> acid, <span class=\"customMeta\" data-dictid=\"a995a613a016927771969d4395dc80\">potassium</span> and phosphorus,\u00a0leading to hyperuricemia, <span class=\"customMeta\" data-dictid=\"8bf09336411692777189d1a79bf6a5\">hyperkalemia</span> and hyperphosphatemia,\u00a0respectively, which in turn leads to <span class=\"customMeta\" data-dictid=\"59f10ee7c31692777189a8544bb404\">hypocalcemia</span> and <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> <span class=\"customMeta\" data-dictid=\"b9356afdba16927771979d068c6587\">renal</span> failure.</li>\n\t<li>This condition is commonly seen in<strong> poorly differentiated lymphomas (high-grade lymphoma, Burkitt\u2019s lymphoma)</strong> and<strong> leukaemias (chronic leukaemia, ALL-acute lymphoblastic leukaemia).</strong></li>\n\t<li><strong>Management includes, </strong>\n\t<ul>\n\t\t<li>Aggressive <span class=\"customMeta\" data-dictid=\"a195b609f61692777189953f3adaa6\">hydration</span> to correct <span class=\"customMeta\" data-dictid=\"a0e40688fa169277719572bdb48c92\">plasma</span> volume <strong>(Option A)</strong></li>\n\t\t<li>Correction of <span class=\"customMeta\" data-dictid=\"b82539c9ae1692777191a3f7ddd7bb\">lactic</span> <span class=\"customMeta\" data-dictid=\"6caf3a39f416927771807e122b9032\">acidosis</span> by Sodium bicarbonate)</li>\n\t\t<li>Correction of <span class=\"customMeta\" data-dictid=\"e22be927921692777189c58bef4715\">hyperuricemia</span> by Allopurinol, Rasburicase, etc.<strong> (Option B)</strong></li>\n\t\t<li>Hemodialysis is also done in case of <span class=\"customMeta\" data-dictid=\"b9356afdba16927771979d068c6587\">renal</span> failure.<strong> (Option D)</strong></li>\n\t</ul>\n\t</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/BxWW3AvZEUALu683h60J1747205313.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/YPOgmSy4YHJ2cjg1gmEP1747205389.mp3"
  },
  {
    "text": "<p>A 48-year-old male with small cell carcinoma of the lung presents with cyanosis of the neck and face, epistaxis, headache, dizziness and swelling over the face, neck and upper chest. He is irregular regarding chemotherapy sessions. Chest x-ray revealed a widening of the superior mediastinum. What is the investigation of choice in this condition?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Chest x-ray"
      },
      {
        "id": 2,
        "text": "MRI"
      },
      {
        "id": 3,
        "text": "Ultrasound"
      },
      {
        "id": 4,
        "text": "CT scan"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) CT scan</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The given scenario suggests<strong> superior <span class=\"customMeta\" data-dictid=\"3ddf6d5ea71692777201b70c8b9715\">vena</span> <span class=\"customMeta\" data-dictid=\"67544ba6ef16927771835d4641cc8f\">cava</span> syndrome (SVC)</strong>, and a<strong> <span class=\"customMeta\" data-dictid=\"871577be5e169277718596f7614659\">CT scan</span> </strong>is the investigation choice for this conditio<strong>n.</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Superior <span class=\"customMeta\" data-dictid=\"3ddf6d5ea71692777201b70c8b9715\">Vena</span> <span class=\"customMeta\" data-dictid=\"67544ba6ef16927771835d4641cc8f\">Cava</span> (SVC) syndrome:</strong></p>\n\n<ul>\n\t<li>It occurs when the superior <span class=\"customMeta\" data-dictid=\"3ddf6d5ea71692777201b70c8b9715\">vena</span> <span class=\"customMeta\" data-dictid=\"67544ba6ef16927771835d4641cc8f\">cava</span> is obstructed, often due to bulky <span class=\"customMeta\" data-dictid=\"1014e4cf5e169277719246e0ca91df\">mediastinal</span> <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> nodes or a right upper <span class=\"customMeta\" data-dictid=\"d7dd6ae43c1692777191cf75c0bd58\">lobe</span> tumour compressing or invading the vessel.</li>\n\t<li>This <span class=\"customMeta\" data-dictid=\"39f44b27bf169277719416f29a74ee\">obstruction</span> severely reduces <span class=\"customMeta\" data-dictid=\"96e7e3fecc16927772018cb9f8c8cd\">venous</span> return from the head, neck, and upper extremities, leading to clinical manifestations such as:\n\t<ul>\n\t\t<li>Variable degrees of <span class=\"customMeta\" data-dictid=\"e3d212ebd316927771996e0c472d4a\">swelling</span> of head, neck and arms along with cyanosis.</li>\n\t\t<li>Headache, conjunctival oedema, dizziness, and <span class=\"customMeta\" data-dictid=\"9f04fb3f2f1692777199272e3daf84\">syncope</span> can be seen</li>\n\t\t<li>Some other features, such as <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> stuffiness, epistaxis, and tongue swelling, may also be seen.</li>\n\t\t<li>Dyspnea, dysphagia, <span class=\"customMeta\" data-dictid=\"8f02e74e821692777185a0c005c508\">cough</span> and <span class=\"customMeta\" data-dictid=\"4da1fe73a71692777189ec55b7ed8c\">hoarseness</span> of voice can also be seen in case of <span class=\"customMeta\" data-dictid=\"56af81fad316927771843d2b4b1e4f\">compression</span> of <span class=\"customMeta\" data-dictid=\"1014e4cf5e169277719246e0ca91df\">mediastinal</span> structures.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><img alt=\"\" data-author=\"na\" data-hash=\"\" data-license=\"na\" data-source=\"na\" data-tags=\"\" height=\"926\" src=\"https://image.prepladder.com/content/8mtmoMwCSsZNB0kS2L6t1739105121.png\" width=\"983\" /></p>\n\n<ul>\n\t<li>Chest <span class=\"customMeta\" data-dictid=\"fd0c8ab494169277720227102dc79a\">X-ray</span> suggests a widening of superior <span class=\"customMeta\" data-dictid=\"be2aea1ed01692777192b46ee482a3\">mediastinum</span> <strong>(Option A). </strong></li>\n\t<li><strong>The investigation of choice is CT scan</strong> <strong>(Option D)</strong>.</li>\n\t<li>MRI <strong>(Option B)</strong> and <span class=\"customMeta\" data-dictid=\"df077f2c3d16927772019f8223e58f\">ultrasound</span> <strong>(Option C) </strong>are not the investigations of choice, though <span class=\"customMeta\" data-dictid=\"1014e4cf5e169277719246e0ca91df\">mediastinal</span> mass can be seen and diagnosed.</li>\n\t<li>Management of this syndrome depends on the cause. In cases of <span class=\"customMeta\" data-dictid=\"c739a6fb2b1692777200e2ada8023c\">tracheal</span> obstruction, a <span class=\"customMeta\" data-dictid=\"955bd148331692777200316f3d9855\">tracheostomy</span> might be done.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/8mtmoMwCSsZNB0kS2L6t1739105121.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/bkVxsxJPecyIKwfHbEt51747205499.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/v3vD4YTjhHj1BvW1drzG1747205553.mp3"
  },
  {
    "text": "<p>Which of the following statements regarding desmoid tumours is NOT true?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "It is often associated with FAP (familial adenomatous polyposis)"
      },
      {
        "id": 2,
        "text": "It arises in musculoaponeurotic structures"
      },
      {
        "id": 3,
        "text": "It is more common in females than males"
      },
      {
        "id": 4,
        "text": "Estrogen inhibits its growth"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) <span class=\"customMeta\" data-dictid=\"a58dd68b011692777187eb72633aac\">Estrogen</span> inhibits its growth.</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Desmoid tumour\u2019s growth is stimulated by estrogen.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Desmoid tumour</strong></p>\n\n<ul>\n\t<li>Also known as aggressive fibromatosis, it is a rare <span class=\"customMeta\" data-dictid=\"99d12f6d811692777202e87cc63267\">fibroblastic</span> <span class=\"customMeta\" data-dictid=\"1622f69a94169277719372b76236ca\">neoplasm</span> with aggressive <span class=\"customMeta\" data-dictid=\"3107ad472c16927771900477b8dae0\">infiltrative</span> behaviour but no metastatic potential.</li>\n\t<li>Generally, it arises in <span class=\"customMeta\" data-dictid=\"a1bab9945216927771933c01c52aa2\">musculoaponeurotic</span> structures <strong>(Option B)</strong> in the <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> wall.</li>\n\t<li>This tumour can occur anywhere in the body but is more common in the <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> wall.</li>\n\t<li>Predisposing risk factors include,\n\t<ul>\n\t\t<li>History of <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> incision/trauma.</li>\n\t\t<li>Estrogen stimulates its growth <strong>(Option D)</strong></li>\n\t\t<li>It is more commonly seen in females <strong>(Option C)</strong></li>\n\t\t<li>It is often associated with FAP (familial <span class=\"customMeta\" data-dictid=\"bc1de18bfd169277718009de79c6cc\">adenosis</span> polyposis) <strong>(Option A)</strong> and Gardner\u2019s syndrome.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Gardner's syndrome</strong> is an autosomal dominant <span class=\"customMeta\" data-dictid=\"a1b06f401f1692777203a53393ba98\">form</span> of <span class=\"customMeta\" data-dictid=\"fe6b8df2fa1692777196938c42762a\">polyposis</span> characterized by osteomas, <span class=\"customMeta\" data-dictid=\"fe6b8df2fa1692777196938c42762a\">polyposis</span> <span class=\"customMeta\" data-dictid=\"cd0a7121a516927771846d8f5248bb\">coli</span> and mesenchymal tumors of skin and soft tissue.</p>\n\n<ul>\n\t<li><strong>Biopsy is the investigation of choice </strong>which shows <span class=\"customMeta\" data-dictid=\"aa085932ce1692777193be7e5198bf\">multinucleated</span> plasmodial giant cells.</li>\n\t<li>Below is the histopathological image showing <span class=\"customMeta\" data-dictid=\"a8561fd6f51692777202cc82962335\">fibromatosis</span> infiltrating skeletal muscles.</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"Nephron\" data-hash=\"\" data-license=\"CC by SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Desmoid_tumour_--_high_mag.jpg\" data-tags=\"\" height=\"555\" src=\"https://image.prepladder.com/content/dJvJojFcoWxFsmj5nWbZ1739105289.png\" width=\"827\" /></p>\n\n<ul>\n\t<li>MRI can also be done to determine the extent of the tumour.</li>\n\t<li>Treatment includes wide local excision, but as <span class=\"customMeta\" data-dictid=\"1d849ebc9b1692777197d4af1fa8d2\">recurrence</span> is high, <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> <span class=\"customMeta\" data-dictid=\"20b3ce06c5169277718756ee95c1e9\">excision</span> followed by <span class=\"customMeta\" data-dictid=\"a75f060aa1169277719777dd69df3f\">radiotherapy</span> can also be done in such cases.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/dJvJojFcoWxFsmj5nWbZ1739105289.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/UQr5hfn1kHgraJvkSlfy1747205671.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/B3buNwuySPdmxlbEbBUi1747205721.mp3"
  }
];
        let quizName = '51 Oncology';
        const quizFilename = '51-oncology-95dccdaa.html';
        let hierarchy = ["PrepLadder", "qBank", "Surgery"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>