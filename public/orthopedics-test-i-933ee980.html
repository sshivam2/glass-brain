<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orthopedics Test I - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2018 - 19
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following best describes the bony Bankart lesion?",
    "choices": [
      {
        "id": 1,
        "text": "Avulsion fracture of the glenoid rim"
      },
      {
        "id": 2,
        "text": "Stripping of the antero-inferior glenoid labrum"
      },
      {
        "id": 3,
        "text": "Rupture of inferior glenohumeral ligament complex"
      },
      {
        "id": 4,
        "text": "Avulsion of posterior capsular periosteum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> bony bankart lesion</strong> is a small, <strong>avulsion fracture</strong> of the\u00a0<strong>glenoid rim</strong>.</p>\n<p>During an <strong>anterior shoulder dislocation</strong>, the head of the humerus can <strong>tear</strong> the <strong>anteroinferior</strong> part of the <strong>glenoid labrum</strong>. This is known as <strong>Bankart lesion</strong>. In some cases, a small fragment of bone from the glenoid rim can also get avulsed. This is known as a <strong>bony</strong> <strong>Bankart</strong> lesion.</p>\n<p>Avulsion of posterior capsular periosteum is seen in reverse Bankart lesion.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/808b47390d0b416390aebb7db595e4fdx1280x2051.JPEG"
    ]
  },
  {
    "text": "What is the pathology seen in patients with Trevor's disease?",
    "choices": [
      {
        "id": 1,
        "text": "Multiple osteochondromas"
      },
      {
        "id": 2,
        "text": "Intraarticular epiphyseal osteochondroma"
      },
      {
        "id": 3,
        "text": "Osteochondroma  associated with false aneurysms"
      },
      {
        "id": 4,
        "text": "Osteochondroma  associated with hemangiomas"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Trevor's disease&nbsp;is characterized by the presence of&nbsp;<strong>intra-articular epiphyseal osteochondromas</strong>.<strong>&nbsp;</strong></p>\n<p>In <strong>Trevor's disease</strong>, bony lesions appear on the medial or lateral aspect of the epiphysis. The lesions are localized to a <strong>single side</strong> of the body. <strong>Knee</strong> and <strong>ankle</strong> are most frequently involved.</p>\n<p>Multiple osteochondromas are seen in a condition known as<strong>&nbsp;</strong>diaphyseal aclasis or<strong>&nbsp;multiple hereditary exostoses.</strong></p>\n<p>The below <strong>lateral view X-ray</strong> of the lower limb shows&nbsp;<strong>non-uniform bone growth</strong>, and <strong>unconnected ossification centers</strong> related to the epiphyses at the knee and ankle. This is seen in <strong>Trevor's disease</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f8690f3ad4d14d21a006211444998f5fx626x600.JPEG"
    ]
  },
  {
    "text": "Choose the wrong statement regarding chondromalacia patella ______",
    "choices": [
      {
        "id": 1,
        "text": "There is increasing osteoporosis of the patella"
      },
      {
        "id": 2,
        "text": "There is blistering in the patellar cartilage"
      },
      {
        "id": 3,
        "text": "It affects the medial facet of the patella"
      },
      {
        "id": 4,
        "text": "It is commonly associated with vastus medius tendinitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Chondromalacia patella is defined as a blistering cystic change in the patellar cartilage usually affecting the medial facet of the patella. It is associated with vastus medius tendinitis.</li>\n<li><strong>The change is attributed to a decrease in sulfated mucopolysaccharide in the ground substance.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the statements is false regarding the condition shown in the image given below.",
    "choices": [
      {
        "id": 1,
        "text": "ORIF is done to prevent this deformity"
      },
      {
        "id": 2,
        "text": "Increased risk of tardy ulnar nerve palsy"
      },
      {
        "id": 3,
        "text": "Baumann\u2019s angle is greater than 80 degrees in this child"
      },
      {
        "id": 4,
        "text": "Brachial artery is injured in fractures that lead to this deformity"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The deformity seen is a <strong>cubitus varus</strong> <strong>(gunstock)</strong> deformity.&nbsp; There is <strong>no risk of ulnar nerve palsy</strong> in this deformity.</p>\n<p>Normal Baumann&rsquo;s angle is &lt;80 degrees. If &gt;80 degrees, it suggests a varus displacement and possibly a supracondylar fracture.</p>\n<p><strong>Brachial artery, median and radial nerve</strong> are some of the commonest structures to be injured in case of a supracondylar fracture.</p>\n<p>Closed reduction is unlikely to be stable and K-wire fixation is not strong enough to permit early mobilization.&nbsp;</p>\n<p><strong>Open reduction and internal fixation</strong> is therefore the treatment of choice.</p>\n<p>Tardy ulnar nerve palsy is a&nbsp;<strong>chronic clinical condition characterized by a delayed onset ulnar neuropathy after an injury to the elbow</strong>. Typically, tardy ulnar nerve palsy occurs as a consequence of nonunion of pediatric lateral condyle fractures at the elbow, which eventually lead to a cubitus valgus deformity&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5a4b9d48f973442d9e77815ac00765e8.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8cef0216686f4e339ecf61ef7f6349e1x1280x1602.JPEG"
    ]
  },
  {
    "text": "Notta\u2019s nodule is the stenosing tenovaginitis of ____?",
    "choices": [
      {
        "id": 1,
        "text": "Abductor pollicis longus"
      },
      {
        "id": 2,
        "text": "Flexor pollicis longus"
      },
      {
        "id": 3,
        "text": "Extensor pollicis longus"
      },
      {
        "id": 4,
        "text": "Extensor pollicis brevis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Notta&rsquo;s nodule is a palpable thickening of the tendon following stenosing tenovaginitis of <strong>flexor pollicis longus</strong> at the level of the 1st Annular pulley over the MCP joint leading to a congenital trigger finger.</p>\n<p>It occurs within a few months after birth. Triggering often resolves spontaneously but, if the condition persists, it can be treated surgically.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a6812c76346843649be7bf4ba5cff2f7x800x493.JPEG"
    ]
  },
  {
    "text": "How much is \u2018X\u2019 if the radiograph given below is of a normal foot?",
    "choices": [
      {
        "id": 1,
        "text": "5-20"
      },
      {
        "id": 2,
        "text": "15-25"
      },
      {
        "id": 3,
        "text": "20-40"
      },
      {
        "id": 4,
        "text": "40-50"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given X-ray shows Kite&rsquo;s (Talocalcaneal) angle, which is normally 20-40 degrees.</p>\n<p>In an anterior-posterior film, lines can be drawn through the long axis of the talus parallel to its medial border and through that of the calcaneum parallel to its lateral border; they normally cross at an angle of <strong>20&ndash;40 degrees (Kite&rsquo;s angle)</strong> but in club foot the two lines may be almost parallel.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/205afb90d37a406386bf601371cfec99.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the false statement regarding Parsonage Turner syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "One of the risk factors is immunization"
      },
      {
        "id": 2,
        "text": "Variants can present with cranial nerve neuropathies"
      },
      {
        "id": 3,
        "text": "Causes acute shoulder pain and muscle wasting"
      },
      {
        "id": 4,
        "text": "Neck movements are painful"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Neck movements are <strong>relatively pain free</strong> with Parsonage turner syndrome (Brachial neuritis).</p>\n<p>It is a rare syndrome affecting mainly <strong>the lower motor neurons of the brachial plexus</strong> and/or individual nerves or nerve branches.</p>\n<p>It is characterized by the acute onset of excruciating unilateral shoulder pain, followed by flaccid paralysis of shoulder and parascapular muscles several days later.</p>\n<p>The syndrome can also involve cranial nerves.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A subperiosteally placed graft is called:",
    "choices": [
      {
        "id": 1,
        "text": "Cancellous graft"
      },
      {
        "id": 2,
        "text": "Cortical graft"
      },
      {
        "id": 3,
        "text": "Phemister graft"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A phemister bone graft is placed subperiosteally and is most commonly used in the tibial injuries.</p>\n<p>Other options:</p>\n<ul>\n<li>A <strong>cancellous bone graft</strong> is useful in defects less than 2.5 cm. it is rapidly revascularised.</li>\n<li>A <strong>cortical bone graft</strong> provides fixation and osteogenesis. It can be used for the non union of shafts of long bones.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A scaphoid fracture is bridged using the following screw. Identify the screw",
    "choices": [
      {
        "id": 1,
        "text": "Interference screw"
      },
      {
        "id": 2,
        "text": "Acutrak screw"
      },
      {
        "id": 3,
        "text": "Pedicle screws"
      },
      {
        "id": 4,
        "text": "Herbert screw"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This is a <strong>Herbert screw,</strong> which is cannulated and threaded at both ends. It is designed for use in fractures of small articular bones such as the carpals and the scaphoid. The proximal portion has a wider pitch to its thread. This screw is used where a standard screw would impinge on adjacent tissues.</p>\n<p><strong>The Acutrak screw</strong> is also used for the treatment of most scaphoid fractures.&nbsp; It is a cannulated, headless and fully threaded screw.</p>\n<p>The interference screw is a direct tendon-to-bone interference fixation device.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/668ca9ef1e5d4d2d8612ea5915adc9e8.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false about FGF23 (Fibroblast Growth Factor 23)?",
    "choices": [
      {
        "id": 1,
        "text": "It promotes rise of serum calcium"
      },
      {
        "id": 2,
        "text": "Elevated FGF23 levels are seen in hypophosphataemic rickets"
      },
      {
        "id": 3,
        "text": "It promotes the excretion of ionised phosphate"
      },
      {
        "id": 4,
        "text": "Increased FGF23 levels are seen in familial tumoural calcinosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>In familial tumoural calcinosis, decreased FGF23 levels </strong>are seen,<strong>&nbsp;</strong>in which hyperphosphataemia occurs, leading to soft-tissue calcification.</p>\n<p>The main function of FGF23 is regulation of phosphate concentration in plasma.</p>\n<p>FGF23</p>\n<ul>\n<li>Promotes excretion of phosphate by supressing tubular reabsorption</li>\n<li>Promotes rise of Serum calcium&nbsp;</li>\n<li>Is elevated in hypophosphatemic rickets</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following would not be beneficial for the treatment of pulmonary metastasis of a giant cell tumour?",
    "choices": [
      {
        "id": 1,
        "text": "Resection"
      },
      {
        "id": 2,
        "text": "Denosumab"
      },
      {
        "id": 3,
        "text": "Doxorubicin"
      },
      {
        "id": 4,
        "text": "Irradiation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Doxorubicin&nbsp;</strong>is not the preferred&nbsp;treatment of pulmonary metastasis of a giant cell tumour.</p>\n<p>In patients with pulmonary metastases,</p>\n<ul>\n<li><strong>Resection</strong> should be attempted.</li>\n<li><strong>Chemotherapy</strong> has limited success</li>\n<li><strong>Irradiation</strong> should be reserved for symptomatic inoperable lesions.</li>\n</ul>\n<p>Denosumab(chemotherapy) has been approved for use in</p>\n<ul>\n<li>Skeletally mature patients who have an unresectable giant cell tumour.</li>\n<li>Where surgical resection would result in severe morbidity.</li>\n</ul>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true about autologous bone grafts?",
    "choices": [
      {
        "id": 1,
        "text": "Proximal part of the tibia is the most common site for bone graft harvest"
      },
      {
        "id": 2,
        "text": "A temporary polymethylmethacrylate cement spacer delays the grafting process"
      },
      {
        "id": 3,
        "text": "Cortical grafts are more rapidly incorporated than cancellous grafts"
      },
      {
        "id": 4,
        "text": "Vascularised grafts are the ideal grafts"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Vascularised grafts are theoretically the ideal graft; </strong>bone is transferred complete with its blood supply, which is anastomosed to vessels at the recipient site.</p>\n<p>But the technique is difficult and time-consuming.</p>\n<p>Available donor sites include the</p>\n<ul>\n<li>iliac crest (complete with one of the circumflex arteries),</li>\n<li>the fibula (with the peroneal artery),</li>\n<li>radial shaft</li>\n</ul>\n<p><strong>The iliac crest</strong> remains the most frequently used site for bone-graft harvest.</p>\n<p>A temporary polymethylmethacrylate cement spacer creates a <strong>bone friendly environment</strong>.</p>\n<p><strong>Cancellous grafts</strong> are more rapidly incorporated into host bone than cortical grafts, but Cortical bone has greater strength and structural integrity.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The radial nerve is injured in front of the lateral epicondyle. Which of the following will not occur?",
    "choices": [
      {
        "id": 1,
        "text": "Wrist drop"
      },
      {
        "id": 2,
        "text": "Finger drop"
      },
      {
        "id": 3,
        "text": "Sensory loss"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Before radial nerve reaches the lateral condyle, </strong>it<strong>\u00a0</strong>supplies the <strong>extensor carpi radialis</strong> <strong>longus</strong> muscle. Hence,\u00a0wrist drop is not present when the nerve is injured at the lateral condyle.</p>\n<p>Before it crosses the elbow, in front of the lateral condyle, it divides into two branches, <strong>superficial and deep.\u00a0</strong></p>\n<p>The superficial branch is primarily sensory and travels alongside the radial artery into the forearm. This accounts for the sensory loss.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is brought to the emergency department following a RTA. You notice severe facial bruising and on examination his muscles are flaccid, his reflexes and sensations are absent over all four limbs. What is false regarding his condition?",
    "choices": [
      {
        "id": 1,
        "text": "Log rolling should be done to check for injuries"
      },
      {
        "id": 2,
        "text": "Suspected hyperextension injury of cervical spine"
      },
      {
        "id": 3,
        "text": "A complete spinal cord lesion has occurred"
      },
      {
        "id": 4,
        "text": "Quadruple immobilization should be carried out immediately"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient is in spinal shock and a <strong>complete spinal cord lesion cannot be diagnosed</strong> as the neurological outcome may improve.</p>\n<p>The patient is &lsquo;<strong>log- rolled&rsquo;</strong> (i.e. turned over &lsquo;in one piece&rsquo;) to avoid movement of the vertebral column.</p>\n<p>With <strong>severe facial bruising</strong>, always suspect a <strong>hyperextension injury of the neck</strong>.</p>\n<p>Similarly bruising over the lower back should raise the suspicion of a lumbar vertebral fracture.</p>\n<p><strong>Quadruple immobilization</strong> should be carried out immediately. The patient is on a backboard, the head supported by sandbags and held with tape across the forehead, and with a semi-rigid collar.</p>\n<p>Note : Priapism is an important finding since it occurs almost immediately with &lsquo;complete&rsquo; cord injuries and settles in a few hours.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An axial compression force type of injury to the spine could result in which one of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Disruption of facet capsule"
      },
      {
        "id": 2,
        "text": "Fracture of the pedicle"
      },
      {
        "id": 3,
        "text": "Comminuted fracture of the C5"
      },
      {
        "id": 4,
        "text": "Fracture of the transverse process"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Axial compression force</strong> results in load compression and an explosive <strong>comminuted fracture of the C5 vertebra</strong>. <strong>CT</strong> is required for all patients to evaluate the extent of injury. Treatment includes <strong>Rigid Immobilization Surgery. </strong></p>\n<p>Fracture of the pedicle and the transverse process are results of a <strong>lateral flexion force</strong>. <strong>Flexion Rotation Force</strong> leads to disruption of facet capsule.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true about Q-angle?",
    "choices": [
      {
        "id": 1,
        "text": "It is about 14 degrees in men"
      },
      {
        "id": 2,
        "text": "One of the lines forming the angle is a line from the anterior superior iliac spine to the tibial tubercle"
      },
      {
        "id": 3,
        "text": "It is about 20 degrees in women"
      },
      {
        "id": 4,
        "text": "Decreased Q-angle is a predisposing factor for chondromalacia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Q-angle (quadriceps angle) is about 14 degrees in men and 17 degrees in women.</p>\n<p>This is the angle subtended by a line drawn from the <strong>anterior superior iliac spine to the centre of the patella</strong> and another from the <strong>centre of the patella to the tibial tubercle</strong>.</p>\n<p>An <strong>increased Q-angle</strong> is regarded as a predisposing factor in the development of chondromalacia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which NSAID is not effective in acute gout?",
    "choices": [
      {
        "id": 1,
        "text": "Indomethacin"
      },
      {
        "id": 2,
        "text": "Oxaprozin"
      },
      {
        "id": 3,
        "text": "Tolmetin"
      },
      {
        "id": 4,
        "text": "Naproxen"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>All NSAIDs are almost equally <strong>efficacious except Tolmetin</strong>, which is not effective in cases of acute gout.</p>\n<ul>\n<li>The most effective drugs are any of those with a short half-life and include\n<ul>\n<li>Indomethacin</li>\n<li>Naproxen</li>\n<li>Ibuprofen</li>\n<li>Celecoxib</li>\n</ul>\n</li>\n<li>Oxaprozin lowers serum uric acid levels.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The Erlenmeyer flask appearance seen in this x ray is typically seen in?",
    "choices": [
      {
        "id": 1,
        "text": "Gaucher\u2019s disease"
      },
      {
        "id": 2,
        "text": "Radiation Necrosis"
      },
      {
        "id": 3,
        "text": "Dysbaric osteonecrosis"
      },
      {
        "id": 4,
        "text": "Osteochondritis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The is appearance is seen in a lot of conditions, including Gaucher&rsquo;s disease.<br /> It is not seen in the other conditions listed above.</p>\n<p>Erlenmeyer flask deformity (EFD) (also known as <strong>metaphyseal flaring</strong>) is a radiographic appearance typically on a femoral radiograph demonstrating relative constriction of the diaphysis and flaring of the metaphysis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6381e59e6c754c22afb068b3029c36bd.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true about articular cartilage?",
    "choices": [
      {
        "id": 1,
        "text": "Similar cartilage is also found in intervertebral discs"
      },
      {
        "id": 2,
        "text": "Type 1 collagen gives tensile strength"
      },
      {
        "id": 3,
        "text": "It is made up of hyaline cartilage"
      },
      {
        "id": 4,
        "text": "It is sensitive to pain"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Articular cartilage is made up of hyaline cartilage.</p>\n<ul>\n<li>The components of articular cartilage\n<ul>\n<li>Hyaline cartilage</li>\n<li>Glycosaminoglycans :&nbsp;<strong>Chondroitin sulfate</strong> and <strong>keratan sulfate</strong></li>\n<li>Type 2 Collagen</li>\n<li>Chondrocytes</li>\n</ul>\n</li>\n</ul>\n<p>Option a : <strong>Fibrous</strong> cartilage is present in <strong>intervertebral discs</strong>.</p>\n<p>Option c :&nbsp;<strong>Type 2</strong> collagen is mainly responsible for the<strong> tensile strength</strong> of the cartilage.</p>\n<p>Option d : Articular cartilage is aneural&nbsp;and hence it is <strong>insensitive</strong> to pain.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which part of the clavicle is most commonly fractured?",
    "choices": [
      {
        "id": 1,
        "text": "Medial third"
      },
      {
        "id": 2,
        "text": "Middle third"
      },
      {
        "id": 3,
        "text": "Lateral third"
      },
      {
        "id": 4,
        "text": "Medial half"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong>&nbsp;middle third&nbsp;</strong>of the clavicle<strong>&nbsp;</strong>is<strong> most commonly fractured</strong>.&nbsp;</p>\n<p>The middle third of the clavicle is&nbsp;<strong>narrowest</strong> and has the <strong>least</strong> amount of<strong> surrounding</strong> <strong>soft tissue </strong>structures. Therefore, 80% of fractures are seen in this area.</p>\n<p>Within the middle-third of the clavicle, the <strong>junction</strong> of the <strong>medial 3/5<sup>th</sup></strong>&nbsp;and the <strong>lateral 2/5<sup>th</sup></strong>&nbsp;has been described to be the <strong>weakest point</strong>.&nbsp;Lateral third fractures are the second most common type of clavicular fractures.</p>\n<p>Fall on the shoulder (direct impact) and fall on the outstretched hand are the most common causes of clavicle fracture.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/64339b793eec494d9e37e8f26b20cadax1280x1209.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is correct about the double crush phenomenon?\n1: Distal compression of a peripheral nerve renders it more susceptible to the effects of a second, more proximal injury.\n2: Peripheral nerve entrapments are often associated with cervical or lumbar spondylosis.",
    "choices": [
      {
        "id": 1,
        "text": "Both 1 & 2 are correct and related."
      },
      {
        "id": 2,
        "text": "Both 1 & 2 are correct but unrelated"
      },
      {
        "id": 3,
        "text": "Only 1 is correct"
      },
      {
        "id": 4,
        "text": "Only 2 is correct"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Peripheral nerve entrapments are often associated with cervical or lumbar spondylosis.</strong></p>\n<p>The double crush phenomenon is that <strong>proximal compression</strong> of a peripheral nerve renders it more susceptible to the effects of a second, <strong>more peripheral</strong> injury.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All are tumor-like lesions except _______.",
    "choices": [
      {
        "id": 1,
        "text": "Aneurysmal bone cyst"
      },
      {
        "id": 2,
        "text": "Eosinophilic granuloma"
      },
      {
        "id": 3,
        "text": "Enchondroma"
      },
      {
        "id": 4,
        "text": "Monostotic fibrous dysplasia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Aneurysmal bone cyst, eosinophilic granuloma, and monostotic fibrous dysplasia are<strong> tumour-like lesions. Enchondroma&nbsp;</strong>falls under the category of cartilage forming tumors.&nbsp;</p>\n<p><strong>WHO classification of bone tumors:</strong></p>\n<ul>\n<li>Bone forming tumors</li>\n<li>Cartilage forming tumors</li>\n<li>Giant cell tumors</li>\n<li>Marrow tumors</li>\n<li>Vascular tumors</li>\n<li>Tumor-like lesions</li>\n</ul>\n<p><strong>Tumor-like lesions:</strong></p>\n<ul>\n<li>Simple and aneurysmal bone cyst</li>\n<li>Fibrous dysplasia (Mono and polyostotic)</li>\n<li>Reparative giant cell granuloma</li>\n<li>Fibrous cortical defect</li>\n<li>Eosinophilic granuloma</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not included in the major diagnostic triad of fat embolism syndrome (FES)?",
    "choices": [
      {
        "id": 1,
        "text": "Neurological impairment"
      },
      {
        "id": 2,
        "text": "PaO2 < 60 mmHg"
      },
      {
        "id": 3,
        "text": "Fat globules in urine"
      },
      {
        "id": 4,
        "text": "Petechiae"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Fat globules in urine is a minor criterion</strong> in diagnosing fat embolism syndrome.</p>\n<p>Fat embolism syndrome is caused by the release of fat globules from the bone marrow into the bloodstream. It <strong>usually occurs following long bone or pelvic fractures</strong>, and multiple fractures.</p>\n<p>Along with platelet aggregates, the globules result in the following manifestations which make up the <strong>major diagnostic triad</strong>:</p>\n<ul>\n<li><strong>Respiratory insufficiency</strong></li>\n<li><strong>Neurological impairment</strong></li>\n<li><strong>Petechial rash</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a dynamic stabilizer of the hip joint?",
    "choices": [
      {
        "id": 1,
        "text": "Iliofemoral ligament"
      },
      {
        "id": 2,
        "text": "Iliopsoas muscle"
      },
      {
        "id": 3,
        "text": "Joint capsule"
      },
      {
        "id": 4,
        "text": "Pubofemoral ligament"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Iliopsoas </strong>muscle is a <strong>dynamic</strong> stabilizer of the hip joint.</p>\n<p>Dynamic stabilizers:&nbsp;</p>\n<ul>\n<li>Iliopsoas anteriorly</li>\n<li>Short external rotators posteriorly</li>\n<li>Hip abductors laterally.</li>\n</ul>\n<p>&nbsp;Static stabilizers:</p>\n<ul>\n<li>Iliofemoral ligament</li>\n<li>Pubofemoral ligament</li>\n<li>Ischiofemoral ligament</li>\n<li>The joint capsule and labrum</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The condition that may result in secondary osteosarcoma is _______",
    "choices": [
      {
        "id": 1,
        "text": "Aneurysmal bone cyst"
      },
      {
        "id": 2,
        "text": "Osteoid osteoma"
      },
      {
        "id": 3,
        "text": "Paget's disease"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Out of the given conditions, only Paget&rsquo;s disease can progress to secondary osteosarcoma.</p>\n<p>Other conditions which can progress to secondary osteosarcoma:</p>\n<ul>\n<li><strong>Paget's disease</strong></li>\n<li>Fibrous dysplasia</li>\n<li><strong>Post-radiation</strong></li>\n<li><strong>Bone infarction</strong></li>\n<li>Survivors of retinoblastoma</li>\n<li>Multiple osteochondromas</li>\n<li><strong>Chronic osteomyelitis&nbsp;</strong></li>\n<li>Melorheostosis</li>\n<li><strong>Osteogenesis imperfecta.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The oblique spinal X-ray of a patient having chronic low-back ache is given below.  What is the sign seen here called?",
    "choices": [
      {
        "id": 1,
        "text": "Spur sign"
      },
      {
        "id": 2,
        "text": "Beheaded\u00a0Scottish terrier sign"
      },
      {
        "id": 3,
        "text": "Corduroy sign"
      },
      {
        "id": 4,
        "text": "Polka dot sign"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the X-ray given, there is a <strong>break in</strong> the <strong>pars interarticularlis</strong> of the L4 vertebra, which appears like a beheaded&nbsp;Scottish terrier. Hence, it is known as<strong> beheaded&nbsp;Scottish terrier sign</strong>&nbsp;and it is diagnostic of <strong>spondylolisthesis</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/036eb0f315bb480bb47bda36596d2838.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b2e117da7ba14b1d84b4f94f2626c13ex319x356.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bc396e7dc6994218ae352d9f143d045fx934x606.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f69de3e47914535899a2054dbe51fe7x1280x1361.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c8b163367cc447b68425ea6eb273497bx1280x1361.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1a4ffed8b99442a1b1d1df37402e7c49x1280x1360.JPEG"
    ]
  },
  {
    "text": "Which of the following is true about inter-vertebral discs?\n\nA. Accomodates weight and shock \nB. Highly vascular structure \nC. Major constitute of disc is water\nD. The central part of disc is derived from ectoderm",
    "choices": [
      {
        "id": 1,
        "text": "A only"
      },
      {
        "id": 2,
        "text": "A & B"
      },
      {
        "id": 3,
        "text": "A, C & D"
      },
      {
        "id": 4,
        "text": "A & C"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>An intervertebral disc has a <strong>central nucleus pulposus,</strong> which is a <strong>remnant of the notochord (mesoderm)</strong> and annulus fibrosus at the periphery. It binds the vertebra together, allows motion, absorbs shock, distributes load between the segments, and contributes to lordosis.</p>\n<p>The discs are the largest avascular structures in the body and depend on diffusion from a specialized network of end plate blood vessels for nutrition.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is primary impingement?",
    "choices": [
      {
        "id": 1,
        "text": "Impingement occurring beneath the coracoacromial arch"
      },
      {
        "id": 2,
        "text": "Impingement due to scapula-thoracic instability"
      },
      {
        "id": 3,
        "text": "Impingement due to gleno-humeral instability"
      },
      {
        "id": 4,
        "text": "Seen in overhead athletes like throwers and swimmers"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Primary impingement occurs beneath the coracoacromial arch.&nbsp;</p>\n<p>There are <strong>three types</strong> of impingement syndrome.</p>\n<ul>\n<li dir=\"ltr\"><strong>Primary impingement</strong> is due to structural changes that mechanically narrow the subacromial space.&nbsp;It<strong>&nbsp;</strong>occurs beneath the coracoacromial arch and is due to subacromial overloading. It is the <strong>most common.</strong></li>\n<li dir=\"ltr\"><strong>Secondary impingement</strong> results from a functional disturbance of the humeral head. It is due to a relative decrease in the subacromial arch and is due to micro-instability of the glenohumeral joint or scapulothoracic instability.</li>\n<li><strong>Posterior or internal impingement</strong> is seen in overhead athletes like swimmers and throwers.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false regarding Forestier\u2019s disease?",
    "choices": [
      {
        "id": 1,
        "text": "It is a common disorder"
      },
      {
        "id": 2,
        "text": "Normal ESR is seen"
      },
      {
        "id": 3,
        "text": "Asymmetrical intervertebral spur formation and bridging seen"
      },
      {
        "id": 4,
        "text": "Pain and stiffness are severe"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Pain and stiffness are rarely severe </strong>in diffuse idiopathic hyperostosis or Forestier&rsquo;s disease.</p>\n<p>This is a common disorder with widespread ossification of ligaments and tendon insertions.</p>\n<p>X-rays show <strong>asymmetrical intervertebral spur formation</strong> and bridging throughout the dorsolumbar spine. It bears a resemblance to AS, but it is not an inflammatory disease.&nbsp;The sacroiliac joints are not eroded and the <strong>ESR is normal.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old diabetic woman noticed an audible click every time she flexed her left middle finger. The extension of the middle finger is as depicted in the clip below. This is caused due to involvement of which of the following structures?",
    "choices": [
      {
        "id": 1,
        "text": "Extensor tendon"
      },
      {
        "id": 2,
        "text": "Flexor tendon"
      },
      {
        "id": 3,
        "text": "Palmar aponeurosis"
      },
      {
        "id": 4,
        "text": "Dorsal aponeurosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario along with the video showing the middle finger in the flexed position requiring extra force to extend it is suggestive of a <strong>trigger finger.\u00a0</strong></p>\n<p>Trigger finger is caused by<strong> stenosing tenosynovitis</strong> of the flexor sheath. There is nodular or fusiform swelling on the flexor tendon that prevents it from moving along the A1 pulley.</p>\n<p><strong>A1 pulley</strong> is an <strong>annular ligament</strong> that acts as a belt that straps the flexor tendon to the underlying phalanges. There are 5 annular ligaments in each finger namely A1. A2, A3, A4, and A5.</p>\n<p>The image given below is showing the nodule in the flexor tendon and the 5 annular ligaments of the finger.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7904e98f279b4a13b384f3b9afbbc1d0.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/975b1c6e87b94fc39dbd1cd3af00ac2ax1279x1157.JPEG"
    ]
  },
  {
    "text": "A wounds > 10cm long, with extensive soft tissue damage and a comminuted fracture underneath with adequate periosteal covering fall under which class of Gustilo\u2019s classification?",
    "choices": [
      {
        "id": 1,
        "text": "Class II A"
      },
      {
        "id": 2,
        "text": "Class III A"
      },
      {
        "id": 3,
        "text": "Class II B"
      },
      {
        "id": 4,
        "text": "Class III B"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This type of fracture falls under Class IIIA of the Gustilo Anderson classification.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a tumour of the diaphysis?",
    "choices": [
      {
        "id": 1,
        "text": "Chondroblastoma"
      },
      {
        "id": 2,
        "text": "Adamantinoma"
      },
      {
        "id": 3,
        "text": "Enchondroma"
      },
      {
        "id": 4,
        "text": "Osteosarcoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Adamantinoma</strong> is a <strong>tumour of the diaphysis</strong>. It is a rare, low-grade malignant tumour classically involving the tibial diaphysis in up to 90% of cases.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a part of Modified Kocher\u2019s criteria for septic arthritis.",
    "choices": [
      {
        "id": 1,
        "text": "Fever"
      },
      {
        "id": 2,
        "text": "CRP > 1mg/L"
      },
      {
        "id": 3,
        "text": "ESR > 40 mm/h"
      },
      {
        "id": 4,
        "text": "WBC >12000 cells/\u00b5L"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>CRP&gt; 2.0 mg/L </strong>is a part of the modified kocher&rsquo;s criteria for the diagnosis of septic arthritis.</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Criterion</strong></td>\n<td><strong>Value</strong></td>\n</tr>\n<tr>\n<td>Fever</td>\n<td>&gt;38.5 &deg;C</td>\n</tr>\n<tr>\n<td>WBC</td>\n<td>&gt;12000 cells/&micro;L</td>\n</tr>\n<tr>\n<td>ESR</td>\n<td>&gt;40 mm/h</td>\n</tr>\n<tr>\n<td>CRP</td>\n<td>&gt;2.0 mg/L</td>\n</tr>\n<tr>\n<td>Weight-bearing</td>\n<td>Complete inability</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Primary bone tumours are most commonly found in ?",
    "choices": [
      {
        "id": 1,
        "text": "Long bones of upper limb"
      },
      {
        "id": 2,
        "text": "Shoulder Girdle"
      },
      {
        "id": 3,
        "text": "Pelvis"
      },
      {
        "id": 4,
        "text": "Femur"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The most common site for bone tumours is <strong>distal end of the Femur. </strong></p>\n<p>More than 60% of the tumours arise from long bones of the lower limb.</p>\n<p>The order of occurrence goes as follows:</p>\n<p>Distal femur&gt; Pelvis&gt; Proximal Tibia&gt; Proximal femur&gt; Proximal Humerus.</p>\n<p>Shoulder girdle is the least common site.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy is brought with gradually progressive pain below his left knee over the past 6 months. An X-ray reveals the following finding. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Brodie's abscess"
      },
      {
        "id": 2,
        "text": "Sclerosing osteomyelitis of Garre"
      },
      {
        "id": 3,
        "text": "Chronic osteomyelitis"
      },
      {
        "id": 4,
        "text": "Osteoclastoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows a\u00a0<strong>lytic lesion</strong> with a <strong>dense sclerotic rim</strong> and\u00a0<strong>minimal periosteal reaction</strong>.\u00a0This is suggestive of<strong> Brodie's abscess.</strong></p>\n<p>Brodie\u2019s abscess is a <strong>subacute</strong> variant of <strong>osteomyelitis</strong> with a <strong>milder</strong> presentation.\u00a0It occurs when organisms of <strong>low virulence</strong> infect an immunocompetent host. The abscess is walled off by the thickening of the surrounding bone trabeculae.\u00a0It most commonly involves the <strong>metaphysis</strong> of the proximal tibia and distal femur.</p>\n<p>Patients present with intermittent pain and tenderness in the affected area. Diagnosis is confirmed by<strong> biopsy</strong>, and it is managed by <strong>antibiotics</strong> and <strong>curettage</strong>. The following x-ray and MRI images show Brodie's abscess of the radius in a patient.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1ab2c45868d440758a664f7f89186d00.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e97f2d5ab4454958b16cc7997386fbccx512x800.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f11d07461ef64d0d9d4bd812ebb7003ax512x347.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d047bf21eee045a3a82f077b48363382x327x362.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/234c5969c2c94781b62d355374b5091ax1280x1176.JPEG",
      "https://cdn1.dailyrounds.org/uploads/f3ac9c18439d4f6396cc6e6c25c43cb1.JPEG"
    ]
  },
  {
    "text": "Which of the following is not seen in non-structural scoliosis?",
    "choices": [
      {
        "id": 1,
        "text": "Contracture of the hip"
      },
      {
        "id": 2,
        "text": "Lumbar disc prolapse"
      },
      {
        "id": 3,
        "text": "Rotated vertebrae"
      },
      {
        "id": 4,
        "text": "Short leg"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Rotated vertebrae</strong> are seen in&nbsp;<strong>structural</strong> scoliosis.</p>\n<p><strong>Scoliosis</strong> is classified into <strong>2 types</strong>:</p>\n<ul>\n<li><strong>Structural </strong>scoliosis - There is a&nbsp;<strong>non-correctable deformity</strong>&nbsp;due to vertebral rotation in the affected spinal segments&nbsp;</li>\n<li><strong>Postural </strong>scoliosis (non-structural) -&nbsp;\n<ul>\n<li>The&nbsp;deformity is secondary to a condition outside the spine</li>\n<li>Seen in conditions such as:\n<ul>\n<li><strong>Short leg</strong>:<strong>&nbsp;</strong>curvature disappears when the patient is made to sit)</li>\n<li><strong>Hip contracture</strong> with pelvic tilt: disappears after the disc prolapse is managed)</li>\n<li><strong>Lumbar disc prolapse</strong> (sciatic scoliosis)</li>\n</ul>\n</li>\n<li>If scoliosis is due to poor posture, the deformity disappears when the person is asked to bend forward &nbsp;&nbsp;</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following X-rays depicts_______?",
    "choices": [
      {
        "id": 1,
        "text": "Osteosarcoma"
      },
      {
        "id": 2,
        "text": "Melorheostosis"
      },
      {
        "id": 3,
        "text": "Osteopoikilosis"
      },
      {
        "id": 4,
        "text": "Osteopathia striata"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given x ray depicts<strong> Melorheostosis.</strong></p>\n<p><strong>Melorheostosis:</strong>&nbsp;It is also known as Leri's Disease. It&nbsp;is a rare mesenchymal dysplasia manifesting as regions of sclerosis of cortices with a characteristic <strong>dripping wax appearance or flowing candle wax appearance</strong>. The presentation is usually monostotic and unilateral. Symptoms include pain, deformity, skin and circulation problems and contractures.</p>\n<p><strong>Osteopoikilosis</strong> is a benign autosomal dominant sclerosing bone dysplasia with multiple bone islands in a peri-articular distribution in tubular bones, pelvis and scapulae. They are typically bilateral and symmetrical.</p>\n<p><strong>Osteopathia striata</strong>, is a rare, benign dysplasia of bone with radiographically prominent vertical striations involving the epiphysis and metaphysis of tubular bones. It is typically asymptomatic, although there can be associated joint discomfort.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/695796d52381441aa5c0fffe9c4cd060.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A male patient presents with a painful, slow and gradual enlargement at the insertion of the Achilles tendon. It gets relieved with rest.  On examination, the following finding is seen. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hallux valgus"
      },
      {
        "id": 2,
        "text": "Plantar fasciitis"
      },
      {
        "id": 3,
        "text": "Haglund deformity"
      },
      {
        "id": 4,
        "text": "Tarsal coalition"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical features and patient image point towards the diagnosis of <strong>Haglund deformity.</strong>&nbsp;</p>\n<p>Haglund deformity refers to a large <strong>exostosis</strong> at the <strong>posterosuperior</strong> aspect of the <strong>calcaneal tuberosity</strong> located anterior to the Achilles tendon.&nbsp;</p>\n<p>This pre-tendinous bursitis usually is caused by chronic irritation from a shoe heel counter. Modification of shoe wear usually relieves symptoms.&nbsp;</p>\n<p>Treatment includes mainly <strong>conservative</strong> management. Surgical treatment is indicated if conservative management fails.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/59ad33cdb54142408d300eaa09dff7b2.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c95c103560b449d8ab4a3360dd584d79x512x371.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c3f0d5fbf334d19b0ea7f3f5bfddbbfx720x960.PNG"
    ]
  },
  {
    "text": "Which is the commonest site for Panner\u2019s disease?",
    "choices": [
      {
        "id": 1,
        "text": "Capitulum"
      },
      {
        "id": 2,
        "text": "Trochlea"
      },
      {
        "id": 3,
        "text": "Olecranon"
      },
      {
        "id": 4,
        "text": "Medial condyle"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The commonest site of <strong>panner\u2019s disease</strong>(osteochondrosis of the elbow) is the <strong>humeral capitulum</strong>.</p>\n<p>Osteochondrosis is defined by irregularity of the humeral capitulum on plain radiographs, shortly after the appearance of the ossific nucleus under 11 years of age, when the cells are vulnerable for ischaemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true regarding the anatomy of the acetabulum?",
    "choices": [
      {
        "id": 1,
        "text": "2 columns- anterior and posterior"
      },
      {
        "id": 2,
        "text": "No columns"
      },
      {
        "id": 3,
        "text": "3 columns- anterior, middle and posterior"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The articular surface of the acetabulum can be visualized as being supported between the limbs of an inverted &ldquo;Y&rdquo; of a bone.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/01483fdb93504a0ab1aef76791e315d1x638x488.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0482c0bbc3884044ab805483b45edd65x454x520.JPEG"
    ]
  },
  {
    "text": "A patient sustained a fracture as depicted in the image, following a fall from height. What is this fracture known as?",
    "choices": [
      {
        "id": 1,
        "text": "Malgaigne fracture"
      },
      {
        "id": 2,
        "text": "Chauffeur fracture"
      },
      {
        "id": 3,
        "text": "Open book fracture"
      },
      {
        "id": 4,
        "text": "Bucket handle fracture"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The fracture shown in the image is known as&nbsp;<strong>Malgaigne's fracture</strong>.</p>\n<p class=\"p1\">This fracture involves the <strong>pubic rami</strong> anteriorly and the sacroiliac joint (<strong>SI joint</strong>) or <strong>ilium </strong>near the SI joint on the <strong>same side</strong> posteriorly.&nbsp;</p>\n<p class=\"p1\"><strong>Chauffeur's fracture</strong>&nbsp;refers to<strong>&nbsp;</strong>fracture of the<strong> radial styloid process </strong>in the forearm.&nbsp;</p>\n<p class=\"p1\"><strong>Open book fracture&nbsp;</strong>are associated with <strong>pubic</strong>&nbsp;<strong>diastasis</strong> and/or a&nbsp;fracture&nbsp;of the pubic rami with a <strong>posterior&nbsp;pelvic&nbsp;disruption</strong> of the sacro-iliac joint.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/eeea377457e242178085632b1fddd9b7.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8ae9359890d24379a9e622f4f8bd680dx1280x1323.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/82e313f32f7947b1925f349af25e8da2x1280x1323.JPEG"
    ]
  },
  {
    "text": "A 33-year-old woman presents with multiple bony swellings in her hands as seen in the image below marked 1. The X-ray of her hands is as shown in the image marked 2. Identify her condition.",
    "choices": [
      {
        "id": 1,
        "text": "Ollier disease"
      },
      {
        "id": 2,
        "text": "Maffucci\u2019s syndrome"
      },
      {
        "id": 3,
        "text": "Melorheostosis"
      },
      {
        "id": 4,
        "text": "Hemangiopericytoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows <strong>hemangiomas</strong> of the hand. The radiograph shows <strong>multiple tumors</strong> affecting the <strong>small bones</strong> of hand with soft tissue swellings and calcification suggestive of <strong>enchondromatosis</strong>. This is suggestive of <strong>Maffucci's syndrome</strong>.</p>\n<p>Maffucci's syndrome is characterised by <strong>enchondromatosis</strong> with <strong>hemangiomas</strong> of the overlying soft tissue.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d907b4d34db44d64920d0750a35752b4.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6fa8ae21ff524e1cbb36dca771ff9defx1280x2184.JPEG"
    ]
  },
  {
    "text": "A 5-year-old boy with Ewing's sarcoma is on chemotherapy. Which of the following is an indicator of poor prognosis?",
    "choices": [
      {
        "id": 1,
        "text": "Levels of beta 2 microglobulin"
      },
      {
        "id": 2,
        "text": "Fever"
      },
      {
        "id": 3,
        "text": "Thrombocytosis"
      },
      {
        "id": 4,
        "text": "Histologic grade"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Fever </strong>is one of the indicators for <strong>poor prognosis</strong> in Ewing's sarcoma.</p>\n<p><strong>Indicators</strong> of <strong>poor prognosis</strong> in patients with <strong>Ewing's sarcoma</strong>:</p>\n<ul>\n<li>Presence of <strong>distant</strong> <strong>metastasis</strong> -&nbsp;<strong>worst</strong> <strong>prognostic</strong> <strong>factor</strong></li>\n<li>Size and location of the primary lesion</li>\n<li>Presence of fever, anaemia</li>\n<li>Leukocytosis</li>\n<li>Raised ESR</li>\n<li>Male child and age 12&ndash;15 years</li>\n</ul>\n<p>Histologic grade is of no prognostic significance because <strong>all Ewing's sarcomas</strong> are considered <strong>high grade</strong>.</p>\n<p>Note:<strong>&nbsp;</strong>High levels of <strong>beta 2 microglobulin</strong> is an indicator of poor prognosis in<strong> multiple myeloma.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient with acute compartment syndrome of the leg, which of the following muscles is most vulnerable to ischemia?",
    "choices": [
      {
        "id": 1,
        "text": "Gastrocnemius"
      },
      {
        "id": 2,
        "text": "Soleus"
      },
      {
        "id": 3,
        "text": "Plantaris"
      },
      {
        "id": 4,
        "text": "Tibialis anterior"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Tibialis anterior </strong>is a muscle of the anterior compartment of the leg which is<strong> most commonly involved in compartment syndrome</strong>.</p>\n<p><strong>Anterior compartment muscles </strong>are more prone for ischemia because they have&nbsp;<strong>Type 1 fibers which depend on oxidative metabolism</strong>&nbsp;for their energy source, compared to<strong>&nbsp;type 2 fibers</strong>, whose metabolism is<strong> primarily anaerobic</strong>.</p>\n<p>The three main compartments are <strong>anterior (extensor), lateral(fibular) and posterior (flexor)</strong>. The posterior compartment is divided into deep and superficial parts by the transverse intermuscular septum.</p>\n<p><strong>The anterior compartment, the least expansile of the three</strong>, is bounded by the deep fascia, the interosseous surfaces of the tibia and fibula, the interosseous membrane and the anterior intermuscular septum</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/623553d9b6e54b99a08f0511022bb1afx712x599.PNG"
    ]
  },
  {
    "text": "The normal velocity of impulse conduction in a motor nerve is _______",
    "choices": [
      {
        "id": 1,
        "text": "60 m/s"
      },
      {
        "id": 2,
        "text": "75 m/s"
      },
      {
        "id": 3,
        "text": "70 m/s"
      },
      {
        "id": 4,
        "text": "90 m/s"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The normal nerve conduction velocity of motor nerve is <strong>70 m/s.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the diagnosis seen with the arm of the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Rupture of brachialis"
      },
      {
        "id": 2,
        "text": "Rupture of proximal tendon of biceps"
      },
      {
        "id": 3,
        "text": "Rupture of distal tendon of biceps"
      },
      {
        "id": 4,
        "text": "Rupture of the long belly of biceps"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the above image biceps has balled up in the arm which is due to <strong>rupture of the biceps tendon.</strong></p>\n<p><strong>Proximal biceps</strong> <strong>tendon</strong> make up 90-97% of all biceps ruptures and almost exclusively <strong>involve the tendon of the long head.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/a28431d0d3f24753ad0cfb4ff5e630c5.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following does not lead to ARDS(Acute Respiratory Distress Syndrome) at the blood-lung interface?",
    "choices": [
      {
        "id": 1,
        "text": "Pneumonia"
      },
      {
        "id": 2,
        "text": "Fat embolism syndrome following femur shaft fracture"
      },
      {
        "id": 3,
        "text": "Sepsis"
      },
      {
        "id": 4,
        "text": "Transfusion-related lung injury"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Pneumonia leads to ARDS at the air&ndash;lung interface.</p>\n<p><strong>Acute respiratory distress syndrome&nbsp;(ARDS)&nbsp;</strong><span class=\"fontstyle0\"><strong>is a clinical syndrome of severe dyspnea of rapid onset, hypoxemia and diffuse pulmonary infiltrates</strong> leading to respiratory failure.</span>&nbsp;Chest radiograph shows<strong>&nbsp;<span class=\"fontstyle0\">Bilateral alveolar interstitial infiltrates.</span></strong></p>\n<p><strong>Causes of ARDS at Air-lung interface:</strong></p>\n<ul>\n<li>Aspiration</li>\n<li>Toxic gas or smoke inhalation</li>\n<li>Near-drowning</li>\n<li>Pneumonia</li>\n<li>Pulmonary contusion</li>\n</ul>\n<p><strong>Causes of ARDS at Blood-lung interface:</strong></p>\n<ul>\n<li>Sepsis</li>\n<li>Transfusion-related lung injury</li>\n<li>Pancreatitis</li>\n<li>Fat embolism</li>\n<li>Thromboembolism</li>\n</ul>\n<p>&nbsp;</p>\n<p>The following X-ray shows Bilateral alveolar infiltrates as seen in ARDS:&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a2595fb8796044b9b35a284adbd513e6x751x600.PNG"
    ]
  },
  {
    "text": "Trapeziectomy is done in which of the following deformities?",
    "choices": [
      {
        "id": 1,
        "text": "Boutonnie\u0300re deformity with CMC joint failure"
      },
      {
        "id": 2,
        "text": "Arthritis mutilans"
      },
      {
        "id": 3,
        "text": "Game keepers thumb"
      },
      {
        "id": 4,
        "text": "Ruptured FPL"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Trapeziectomy is done for <strong>Boutonnie\u0300re deformity with CMC joint failure </strong>and for severe swan-neck deformity.</p>\n<p>Other options:</p>\n<ul>\n<li><strong>Arthritis mutilans</strong> &ndash; Arthrodesis with interposition bone graft is done.</li>\n<li><strong>Game keepers thumb</strong> &ndash; Ligament reconstruction or MCP joint fusion</li>\n<li><strong>Ruptured FPL</strong> &ndash;If painful: tendon graft or IP fusion.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true regarding features of rheumatoid arthritis?",
    "choices": [
      {
        "id": 1,
        "text": "Macrocytic anemia is the most common hematological feature"
      },
      {
        "id": 2,
        "text": "Platelet counts may be increased"
      },
      {
        "id": 3,
        "text": "Felty\u2019s syndrome occurs early in the course of the disease"
      },
      {
        "id": 4,
        "text": "ESR and CRP are decreased in most patients"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Just as CRP and ESR are increased as acute-phase reactants, <strong>platelet counts</strong> may also be <strong>increased as an acute-phase reactant&nbsp;</strong>in rheumatoid arthritis.</p>\n<p><strong>Normochromic normocytic anemia</strong> is the most common hematological abnormality seen in patients.&nbsp;&nbsp;</p>\n<p><strong>Felty&rsquo;s syndrome</strong> is the clinical triad of <strong>neutropenia, splenomegaly and RA</strong> seen in <strong>late stages</strong> of severe RA.</p>\n<p>T- cell large granular lymphocyte leukemia <strong>occurs early</strong> in the course of RA.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the gold standard treatment of an acute Achilles tendon rupture in an athlete?",
    "choices": [
      {
        "id": 1,
        "text": "Open repair"
      },
      {
        "id": 2,
        "text": "Minimally invasive repair"
      },
      {
        "id": 3,
        "text": "Below knee cast"
      },
      {
        "id": 4,
        "text": "Physiotherapy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>Open repair of acute Achilles tendon ruptures remains the &ldquo;gold standard&rdquo; of operative treatment, especially for athletic individuals,</strong> because of the historically low rate of reruptures, high rate of return to sports, and decreased complication rate with newer techniques.</li>\n<li>Advocates of open repair argue that Achilles tendon injuries often result in complex obliquely oriented tears that cannot be adequately apposed and repaired with percutaneous or minimally invasive techniques.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Orthopedics Test I';
        const quizFilename = 'orthopedics-test-i-933ee980.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2018 - 19"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>