<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vaccination Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following is a subunit vaccine?",
    "choices": [
      {
        "id": 1,
        "text": "BCG vaccine"
      },
      {
        "id": 2,
        "text": "Hepatitis B vaccine"
      },
      {
        "id": 3,
        "text": "DPT vaccine"
      },
      {
        "id": 4,
        "text": "IPV vaccine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Hepatitis B</strong> vaccine is an example of a <strong>subunit vaccine</strong> made using<strong> HBsAg.</strong></p>\n<p>Subunit vaccines\u00a0are produced from macromolecules derived from immunogenic components of organisms by <strong>recombinant DNA technology. </strong>E.g.,\u00a0<strong>HPV vaccine</strong>\u00a0(uses<strong> L1 major capsid protein</strong>) and hepatitis B vaccine\u00a0(uses HBsAg).\u00a0</p>\n<p>BCG is a live attenuated vaccine, IPV is an inactivated vaccine and DPT has diphtheria and tetanus toxoids and a killed pertussis component.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In 2020, the U.S. Food and Drug Administration has approved Inmazeb , a mixture of three monoclonal antibodies, as the first FDA-approved treatment for which of the following deadly diseases?",
    "choices": [
      {
        "id": 1,
        "text": "Corona virus"
      },
      {
        "id": 2,
        "text": "Ebola virus"
      },
      {
        "id": 3,
        "text": "Lyssa virus"
      },
      {
        "id": 4,
        "text": "Nipah virus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The U.S. Food and Drug Administration approved <strong>Inmazeb (atoltivimab, maftivimab, and odesivimab)</strong>, a mixture of three <strong>monoclonal antibodies</strong>, as the first FDA-approved treatment for\u00a0<strong>Zaire ebolavirus\u00a0</strong>(<strong>Ebola virus</strong>) infection in adult and pediatric patients.</p>\n<p>It is indicated for the treatment of infection caused by Zaire ebolavirus in adult and pediatric patients, including neonates born to a mother who is RT-PCR positive for Zaire ebolavirus infection.</p>\n<p>Inmazeb targets the <strong>glycoprotein</strong> that is on the surface of the Ebola virus. Glycoprotein attaches to the cell receptor and fuses the viral and host cell membranes allowing the virus to enter the cell. The three antibodies that makeup Inmazeb can bind to this glycoprotein simultaneously and <strong>block attachment and entry of the virus</strong></p>\n<p>Note: Patients who receive Inmazeb should avoid the concurrent administration of a live vaccine due to the treatment\u2019s potential to inhibit replication of a live vaccine virus indicated for the prevention of Ebola virus infection and possibly reduce the vaccine\u2019s efficacy.</p>\n<p><strong><span data-preserver-spaces=\"true\">Ebola virus\u00a0</span></strong><span data-preserver-spaces=\"true\">is the cause of an emerging disease called Ebola virus disease and is widespread in Africa. It belongs to the\u00a0</span><strong><span data-preserver-spaces=\"true\">Filoviridae</span></strong><span data-preserver-spaces=\"true\">\u00a0family.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Fruit bats</span></strong><span data-preserver-spaces=\"true\">\u00a0act as\u00a0</span><strong><span data-preserver-spaces=\"true\">reservoir</span></strong><span data-preserver-spaces=\"true\">\u00a0hosts of the virus and it is transmitted to humans only accidentally.\u00a0</span><strong><span data-preserver-spaces=\"true\">Human-to-human transmission</span></strong><span data-preserver-spaces=\"true\">\u00a0is through direct contact with blood or body fluids of an infected symptomatic person. </span></p>\n<p><span data-preserver-spaces=\"true\">The incubation period of the disease is\u00a0</span><strong><span data-preserver-spaces=\"true\">2 to 21</span></strong><span data-preserver-spaces=\"true\">\u00a0days. Symptoms include\u00a0</span><strong><span data-preserver-spaces=\"true\">fever, intense weakness, vomiting, diarrhea, rashes,</span></strong><span data-preserver-spaces=\"true\">\u00a0and, in extreme cases, internal and external\u00a0</span><strong><span data-preserver-spaces=\"true\">bleeding</span></strong><span data-preserver-spaces=\"true\">. The current treatment is mainly supportive. Patients are susceptible to reinfection even after a complete cure.</span></p>\n<p>\u00a0</p>\n<p><span data-preserver-spaces=\"true\">The electron micrograph image shows\u00a0<strong>the Ebola virus</strong>.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/30a4a8bdef7a4c7bb1df5e10b02017a8x720x331.JPEG"
    ]
  },
  {
    "text": "Which of the following vaccine is most sensitive to heat?",
    "choices": [
      {
        "id": 1,
        "text": "Japanese encephalitis vaccine"
      },
      {
        "id": 2,
        "text": "Measles vaccine"
      },
      {
        "id": 3,
        "text": "Oral polio vaccine"
      },
      {
        "id": 4,
        "text": "Pentavalent vaccine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Oral Polio Vaccine\u00a0</strong>is the <strong>most</strong>\u00a0<strong>heat-sensitive</strong>\u00a0vaccine.<strong>\u00a0</strong>Hence, it is kept in the\u00a0<strong>lower zone\u00a0</strong>of the Ice Lined Refrigerator.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You should perform a shake test prior to using all of the following vaccines, except ________.",
    "choices": [
      {
        "id": 1,
        "text": "OPV"
      },
      {
        "id": 2,
        "text": "TT"
      },
      {
        "id": 3,
        "text": "IPV"
      },
      {
        "id": 4,
        "text": "Hep B"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Only the <strong>injectable</strong>&nbsp;polio vaccine (IPV) is <strong>freeze sensitive</strong>, <strong>not the oral</strong>&nbsp;polio vaccine (OPV). Hence, a shake test is not relevant for OPV.</p>\n<p>The <strong>shake test</strong> is done to check for <strong>damage</strong> to vaccines that are sensitive to <strong>freezing temperatures.</strong></p>\n<p>Steps to perform the shake test:</p>\n<ul>\n<li>A <strong>frozen vaccine</strong> is used as a <strong>control vial</strong>, and the vial suspected to be damaged by freezing is taken as the test vial.</li>\n<li>Both are <strong>shaken after thawing</strong>,<strong>&nbsp;</strong>and the rate of <strong>sedimentation</strong> is <strong>compared</strong>.</li>\n<li>If the rate of <strong>sedimentation</strong> in the test vial is <strong>slower than</strong> that in the <strong>control</strong> vial, then it is <strong>usable</strong> and has not been damaged.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8e1d7fcab7b4460aa9557ded706a8a0dx600x796.JPEG"
    ]
  },
  {
    "text": "A child has come to you for the administration of the IPV vaccine, as part of his routine immunisation schedule. Which of the following antibiotics may be found in this vaccine?",
    "choices": [
      {
        "id": 1,
        "text": "Penicillin"
      },
      {
        "id": 2,
        "text": "Streptomycin"
      },
      {
        "id": 3,
        "text": "Amikacin"
      },
      {
        "id": 4,
        "text": "Erythromycin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>IPV</strong> may contain trace amounts of <strong>streptomycin</strong>, neomycin or polymyxin B.\u00a0</p>\n<p>MMR contain small amount of neomycin.\u00a0</p>\n<p>Antibiotics are used during vaccine manufacture to <strong>prevent bacterial contamination</strong> of tissue culture cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-day-old child who was not vaccinated at birth was brought to the OPD for vaccination. Which of the following vaccines can be administered to this child?",
    "choices": [
      {
        "id": 1,
        "text": "1,2"
      },
      {
        "id": 2,
        "text": "1,3"
      },
      {
        "id": 3,
        "text": "1"
      },
      {
        "id": 4,
        "text": "1,2,3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The vaccine that can be administered to a 20-day-old child who was not vaccinated at birth is <strong>BCG.</strong></p>\n<p>The vaccines that are administered at birth are BCG, OPV-0, HEP-B</p>\n<ul>\n<li><strong>BCG</strong> can be administered till <strong>1 year of age</strong></li>\n<li><strong>OPV-0</strong> should be administered <strong>within 15 days</strong> after birth</li>\n<li><strong>HEP-B</strong> should be administered <strong>within 24 hours</strong> after birth</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year old female patient presented with painless lesions on the vulva as shown in the image below. Which of the following vaccines is not protective against this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Gardasil"
      },
      {
        "id": 2,
        "text": "Cervarix"
      },
      {
        "id": 3,
        "text": "Gardasil-9"
      },
      {
        "id": 4,
        "text": "Quadrivalent HPV vaccine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The condition in the image is <strong>condyloma acuminata (venereal warts)</strong> caused by infection with human papilloma virus <strong>6 or 11.</strong> The Cervarix vaccine does not protect against it. <strong>Cervarix</strong> offers protection against HPV subtypes <strong>16,18</strong>, which cause CIN and Ca cervix.</p>\n<p>The image shows <strong>multiple warty growths </strong>on the vulva and around the anal canal, as seen in condyloma acuminata<strong>.</strong> The verrucous growths may appear discrete or coalesce to form large <strong>cauliflower-like </strong>growths. They may be asymptomatic but can also cause discomfort, discharge, or bleeding. Treatment may include <strong>ablation</strong>, <strong>excision</strong>, or <strong>topical agents</strong> such as podophyllin and imiquimod.</p>\n<p>The available vaccinations against HPV are summarized below.</p>\n<table style=\"height: 483px; width: 515.165px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 102px;\"><strong>Brand name</strong></td>\n<td style=\"width: 92px;\"><strong>Cervarix</strong></td>\n<td style=\"width: 133px;\"><strong>Gardasil</strong></td>\n<td style=\"width: 139.165px;\"><strong>Gardasil-9</strong></td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Characteristic and HPV subtypes</td>\n<td style=\"width: 92px;\">Bivalent:16,18</td>\n<td style=\"width: 133px;\">Quadrivalent: <strong>6,11,</strong>16,18</td>\n<td style=\"width: 139.165px;\">Nonavalent: <strong>6,11</strong>,16,18,31,33,45,52,58</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Protects against:</td>\n<td style=\"width: 92px;\">CIN, Ca cervix</td>\n<td style=\"width: 133px;\">Anogenital warts, CIN, Ca cervix</td>\n<td style=\"width: 139.165px;\">Anogenital warts, CIN, CA cervix,\u00a0 Vulval intraepithelial neoplasia, Vaginal intraepithelial neoplasia</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Dose</td>\n<td style=\"width: 92px;\">0.5ml\u00a0</td>\n<td style=\"width: 133px;\">0.5ml</td>\n<td style=\"width: 139.165px;\">0.5ml</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Administration</td>\n<td style=\"width: 92px;\">0, 1, 6 months i.m</td>\n<td style=\"width: 133px;\">0, 2, 6 months i.m</td>\n<td style=\"width: 139.165px;\">0, 2, 6months, i.m</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Administered gender</td>\n<td style=\"width: 92px;\">Female and male</td>\n<td style=\"width: 133px;\">Female and male</td>\n<td style=\"width: 139.165px;\">Female and male</td>\n</tr>\n<tr>\n<td style=\"width: 102px;\">Ideal Age range:</td>\n<td style=\"width: 92px;\">11-12 years,9-26 years\u00a0</td>\n<td style=\"width: 133px;\">11-12 years, 9-26 years for both male and female</td>\n<td style=\"width: 139.165px;\">\n<p>Females:11-12 years, 9-26 years</p>\n<p>Males:11-12 years</p>\n<p>9-15 years - FDA approved</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Gardasil 9</strong> has received expanded indication, which now includes the <strong>prevention of oropharyngeal</strong> and other <strong>head and neck cancers</strong> caused by HPV types 16,18,31,33,45,52,58.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5f392e1762c142ffb4f23324c1097a74.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "During a measles epidemic in the community, a 6-month-old child is brought to the vaccination camp. What would you do?",
    "choices": [
      {
        "id": 1,
        "text": "Proceed with the immunization of the child for measles"
      },
      {
        "id": 2,
        "text": "Give half of the dose of usual vaccination"
      },
      {
        "id": 3,
        "text": "No vaccination is given as the child is less than 9 months"
      },
      {
        "id": 4,
        "text": "Give the vaccine only if the child develops symptoms"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the setting of a <strong>measles epidemic</strong>, we <strong>proceed with immunization</strong> of measles for this child.</p>\n<p>The scheduled age for receiving the <strong>first dose </strong>of measles vaccine is at <strong>9 months</strong>. The <strong>second dose </strong>is given between <strong>15 - 18 months </strong>of age such that the <strong>minimum interval </strong>between the 2 doses is <strong>4 weeks</strong>.&nbsp; A <strong>supplementary dose</strong> can be given at the age of <strong>&nbsp;6 months</strong> for the following cases:</p>\n<ul>\n<li><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">As a part of intensified service delivery during a <strong>measles outbreak&nbsp; </strong></span></li>\n<li><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">In places where the <strong>risk of measles</strong> among infants &lt; 9 months of age remains <strong>high</strong> (endemic countries experiencing regular outbreaks)</span></li>\n<li><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Individual infants at high risk of contracting measles (<strong>history of contact</strong> with known cases)</span></li>\n<li><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Infants <strong>traveling to countries</strong> experiencing measles outbreaks</span></li>\n<li><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Infants who are known to be <strong>HIV-infected or exposed&nbsp;</strong></span></li>\n</ul>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Infants immunized between 6 months should further receive doses 1 and 2 according to the national schedule. Thus in the given case, this infant will be immunized at 6 months due to the epidemic and then receive the regular doses at 9 and 15-18 months of age.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Given below is a list of equipment used for the cold storage of vaccines.  Arrange the cold storage equipment in the correct order of usage, starting from the primary health center level to the national level.",
    "choices": [
      {
        "id": 1,
        "text": "3-4-1-2"
      },
      {
        "id": 2,
        "text": "4-3-2-1"
      },
      {
        "id": 3,
        "text": "1-2-3-4"
      },
      {
        "id": 4,
        "text": "4-2-1-3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The cold chain equipments that are used at various healthcare&nbsp;strata starting from the primary health center to the national level are <strong>4-3-2-1 </strong>i.e.<strong>&nbsp;ice lined refrigerators</strong>&nbsp;&rarr; <strong>deep freezer</strong>&nbsp;&rarr;&nbsp;<strong>walk-in-coolers</strong>&nbsp;&rarr;&nbsp;<strong>walk-in-freezers</strong>.</p>\n<p><strong>Ice-lined refrigerators&nbsp;(ILRs)&nbsp;</strong>are similar to conventional refrigerators and are lined with ice packs or tubes. They are categorized based on the vaccine storage capacity. Smaller ones are supplied to the<strong> primary health center</strong> (PHC) headquarters, while larger ones are supplied to district headquarters. They maintain a temperature of <strong>2-8&deg; Celsius</strong> for the storage of vaccines.&nbsp;They have different <strong>temperature zones </strong>for different vaccines and they are stored accordingly in the <strong>baskets</strong> that are provided in most ILRs.</p>\n<p><strong>Deep freezer (DF)</strong>&nbsp;is also similar to a conventional refrigerator but has a <strong>top-opening</strong> lid. It maintains a&nbsp;temperature of <strong>-15&deg; to -25&deg; celsius.&nbsp;</strong>It is used at the&nbsp;<strong>district level </strong>and above&nbsp;for the storage of oral polio vaccines for 3 months. At the&nbsp;<strong>sub-district level</strong>,&nbsp;it is used for freezing icepacks.</p>\n<p><strong>Walk-in-coolers (WIC)</strong>&nbsp;are insulated cold rooms with two cooling units with an uninterrupted power supply. They maintain a temperature of&nbsp;<strong>2-8&deg; celsius.&nbsp;</strong>They are used at government medical store depots,&nbsp;<strong>state, regional,</strong> and occasionally <strong>district</strong> level&nbsp;vaccine stores.&nbsp;</p>\n<p><strong>Walk-in-freezers (WIF)&nbsp;</strong>are similar to WIC but maintain a temperature of&nbsp;<strong>-15&deg; to -25&deg; celsius.&nbsp;</strong>They are used at <strong>national</strong>, state, and regional vaccine stores.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the correct statement about the information obtained from the vaccine vial monitor 14 (VVM14) shown in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "It takes 14 days for the inner square to become darker than outer circle"
      },
      {
        "id": 2,
        "text": "It takes 14 days for the inner square and outer circle to reach the same color"
      },
      {
        "id": 3,
        "text": "The vaccine can be used for 14 days after the inner square and outer circle reach the same color"
      },
      {
        "id": 4,
        "text": "The vaccine can be used for 14 days after the outer circle color  becomes darker"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The correct statement is option 2.</p>\n<p>The given scenario mentions<strong>&nbsp;VVM 14 </strong>(vaccine vial monitor 14), where <strong>14</strong> indicates the&nbsp;<strong>VVM number</strong>. It&nbsp;is the <strong>time in days</strong>&nbsp;for the <strong>inner square </strong>to reach the<strong> color of the outer circle </strong>when the vial is exposed to a constant temperature of 37&deg;C. This color change signifies the&nbsp;<strong>discard point</strong>&nbsp;of the vial.</p>\n</div>\n</div>\n</div>\n<p><strong>Vaccine Vial Monitors (VVM)</strong>&nbsp;are heat-sensitive indicators that are routinely used to monitor vaccine viability as the vaccine vial moves across the supply chain. It&nbsp;records&nbsp;<strong>cumulative heat exposure</strong>&nbsp;through a&nbsp;<strong>gradual change in color</strong>.</p>\n<p>There are currently 4 types of VVMs, they are chosen to match the <strong>heat sensitivity</strong> of the vaccines based on the VVM number.&nbsp;</p>\n<ul>\n<li>VVM 30: High Stability</li>\n<li>VVM 14: Medium Stability</li>\n<li>VVM 7: Moderate Stability</li>\n<li>VVM 2: Least Stable</li>\n</ul>\n<p>If the color of the<strong>&nbsp;inner square </strong>is the<strong> same </strong>or is<strong> darker than the outer</strong>&nbsp;circle, it indicates that the vaccine has been exposed to high temperatures and should be&nbsp;<strong>discarded.</strong></p>\n<p>Purpose of VVMs:</p>\n<ul>\n<li>Ensures that vaccines <strong>damaged by heat</strong> are not administered</li>\n<li>Decision on which vaccines to be kept after a <strong>cold chain break</strong> occurs, minimizing unnecessary vaccine wastage</li>\n<li>Decision on which <strong>vaccine</strong> is<strong> to be used first</strong>. Vaccines showing significant heat exposure should be used before those that show lower heat exposure, even if their expiry date is longer</li>\n</ul>\n<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>There are two different locations for VVMs :</p>\n<ul>\n<li><strong>On the label</strong> of the vaccine: The vaccine vial, once opened, can be kept for subsequent immunization sessions for <strong>up to 28 days</strong>, regardless of the formulation of the product</li>\n<li>In a location <strong>other than on the label</strong> (e.g., cap or neck of ampoule): The vaccine vial, once opened should be discarded at the end of the immunization session or <strong>within six hours of opening</strong>, whichever comes first, regardless of the formulation of the product</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/379a129517164991916eee55809230e8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 7-week-old child presented with abdominal pain and red currant jelly stools. The mother gives a history of vaccination to the child 1 week prior. A barium enema is done, and the image is given below. Which of the following vaccine is likely to be responsible for this adverse effect?",
    "choices": [
      {
        "id": 1,
        "text": "Rotavirus vaccine"
      },
      {
        "id": 2,
        "text": "Pentavalent vaccine"
      },
      {
        "id": 3,
        "text": "Pneumococcal conjugate vaccine"
      },
      {
        "id": 4,
        "text": "Oral Polio vaccine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>The clinical scenario of<strong>\u00a0abdominal pain, red currant jelly stool\u00a0</strong>along with barium enema showing the <strong>claw sign</strong>\u00a0is suggestive of <strong>intussusception.\u00a0</strong>The mother gives a history of vaccination at 6 weeks of age and the <strong>Rotavirus vaccine</strong> is associated with a risk of developing <strong>intussusception, </strong>usually <strong>within a week</strong> <strong>after the first or second dose.</strong></p>\n<p>Intussusception occurs when a portion of the bowel is<strong>\u00a0telescoped</strong>\u00a0into an adjacent segment.<strong>\u00a0</strong>It can be seen in infants during the weaning period following the introduction of new food, vaccination, or upper respiratory tract infection. The currently approved <strong>rotavirus vaccines</strong> are associated with a very minimal risk of intussusception. An area of enlarged submucosal <strong>Peyer's patch</strong> acts as a lead point for intussusception.</p>\n<p>Some <strong>lead points</strong> in children are <strong>Meckel's diverticulum,</strong>\u00a0intestinal polyp, inflamed appendix, submucosal hemorrhage seen in <strong>Henoch-Schonlein purpura</strong>, and intestinal duplication cysts. Patients present with <strong>cramping abdominal pain</strong>, palpable <strong>sausage-shaped abdominal mass</strong>, vomiting, and passage of <strong>red currant jelly stools</strong>. <strong>Diagnosis</strong> is confirmed by <strong>abdominal ultrasound </strong>which shows<strong> the t</strong><strong>arget sign/bull's eye sign </strong>(shown below)<strong>\u00a0</strong>and<strong> pseudo kidney</strong><strong>\u00a0sign</strong> (seen longitudinally).</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c903dc979355418eaf9fb3b833293406.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d81d8af7dc2c42c1847e0212ef827ddfx720x598.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/322a6381b6a84dfd93a2fda7c2454257x1144x1136.PNG"
    ]
  },
  {
    "text": "Open vial policy is applicable for which of the following vaccines?",
    "choices": [
      {
        "id": 1,
        "text": "2,3,5"
      },
      {
        "id": 2,
        "text": "1,4"
      },
      {
        "id": 3,
        "text": "1,3,4"
      },
      {
        "id": 4,
        "text": "2,3,4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Among the given vaccines open vial policy is applicable for the <strong>DPT vaccine, Oral Polio vaccine, and Pneumococcal conjugate vaccine</strong>.</p>\n<p>Open vial policy <strong>applies</strong> to <strong>DPT, TT, Hepatitis B, Oral Polio Vaccine (OPV), Liquid Pentavalent, PCV, and injectable IPV.</strong><br />It does <strong>not</strong> <strong>apply</strong> to <strong>Measles/MR, BCG, or Japanese Encephalitis (JE) vaccines.</strong><br /><br />Vaccine vials opened in session-site can be used in more than one immunization session for up to<strong>\u00a0four weeks</strong> provided</p>\n<ul>\n<li>The expiry date has not passed.</li>\n<li>Vaccines are stored strictly under an appropriate temperature range both during transportation &amp; storage at cold chain points.</li>\n<li>The vaccine vial septum has not been submerged in water or contaminated in any way.</li>\n<li>An aseptic technique has been used to withdraw all doses.</li>\n<li>The vaccine vial monitor (VVM), has not reached the discard point.</li>\n</ul>\n<p>Ensure all open vials have recorded the date and time of opening. All vials (open or unopened) should be transported in a zipper bag in the vaccine carrier and recorded in the stock register. Well-sealed conditioned ice packs should be used in vaccine carriers and water should not be allowed to accumulate where vaccine vials and diluents are stored.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A baby is brought to the pediatrician for the general assessment. During the examination, it is observed that the baby can stand holding support. On giving a small pebble to the baby, the baby tries to hold it between the index and the thumb finger. She also waves bye-bye and can say mama. Which of the following vaccines can be given to this baby if the development is appropriate for her age and if she has not missed any prior immunization?",
    "choices": [
      {
        "id": 1,
        "text": "Oral polio vaccine-3, Pentavalent 2, rotavirus-2"
      },
      {
        "id": 2,
        "text": "Oral polio vaccine-3, Pentavalent 3, rotavirus-2"
      },
      {
        "id": 3,
        "text": "Measles and Rubella-1, Japanese encephalitis vaccine, Pneumococcal conjugate vaccine booster, Vitamin A 1 lakh IU"
      },
      {
        "id": 4,
        "text": "Measles and Rubella-1, Pneumococcal conjugate vaccine booster, Vitmain A 2 Lakhs IU"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>According to the developmental assessment, the child has attained <strong>9 months</strong> of age.</p>\n<p><strong>A 9-month-old baby&nbsp;</strong>can <strong>stand with support;&nbsp;</strong>has a&nbsp;<strong>pincer grasp;&nbsp;</strong>waves <strong>bye-bye;&nbsp;</strong>and can say bisyllabic words like<strong> mama, baba, dada.&nbsp;</strong></p>\n<p>Vaccines given at this age:</p>\n<ul>\n<li><strong>Measles and rubella vaccine (MR-1)</strong> -1st dose of measles and rubella</li>\n<li><strong>Japanese encephalitis vaccine(JE-1)</strong>:1st dose(In <strong>endemic districts</strong>)</li>\n<li><strong>Vitamin A</strong>- 1st dose with<strong> 1 lakh</strong> IU</li>\n<li>Children who are staying in Bihar, Himachal Pradesh, Madhya Pradesh, Uttar Pradesh, Rajasthan, and Haryana should be additionally given a booster dose of <strong>pneumococcal conjugate vaccine (PCV)</strong>.</li>\n</ul>\n<p>&nbsp;</p>\n<table style=\"height: 300px;\" width=\"694\">\n<tbody>\n<tr>\n<td style=\"width: 339px;\">National immunisation schedule</td>\n<td style=\"width: 339px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">Birth</td>\n<td style=\"width: 339px;\">\n<p>Bacille Calmette-Guerin (BCG)</p>\n<p>Oral polio vaccine (OPV)-0 dose</p>\n<p>Hepatitis B- Birth dose</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">6 weeks</td>\n<td style=\"width: 339px;\">\n<p>OPV- 1</p>\n<p>Pentavalent- 1</p>\n<p>Rotavirus vaccine (RVV)-1</p>\n<p>Inactivated Polio vaccine (IPV) -1</p>\n<p>Pneumococcal conjugate vaccine (PCV)-1</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">10 weeks</td>\n<td style=\"width: 339px;\">\n<p>OPV2</p>\n<p>Pentavalent- 2</p>\n<p>RVV- 2</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">14 weeks</td>\n<td style=\"width: 339px;\">\n<p>OPV-3</p>\n<p>Pentavalent- 3</p>\n<p>IPV- 2</p>\n<p>RVV- 3</p>\n<p>PCV- 2</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">9-12 months</td>\n<td style=\"width: 339px;\">\n<p>Measles and Rubella (MR)-1</p>\n<p>IPV-3</p>\n<p>Japanese encepahlitis- (JE)- 1</p>\n<p>PCV booster</p>\n<p>Vitamin A 1 lakh IU</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">16-24 months</td>\n<td style=\"width: 339px;\">\n<p>MR- 2</p>\n<p>JE- 2</p>\n<p>Diphtheria, tetanus, pertussis (DPT) booster - 1</p>\n<p>OPV booster</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">5-6 years&nbsp;</td>\n<td style=\"width: 339px;\">DPT booster-2</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">10 years</td>\n<td style=\"width: 339px;\">Tetanus and adult Diphtheria (Td)</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">16 years&nbsp;</td>\n<td style=\"width: 339px;\">Td</td>\n</tr>\n<tr>\n<td style=\"width: 339px;\">Pregnant mother</td>\n<td style=\"width: 339px;\">Td 1, Td 2, or Td booster</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Pneumococcal conjugate vaccine</strong> and <strong>Japanese encephalitis vaccine</strong> are given <strong>only</strong> in the <strong>endemic</strong> areas.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old pregnant woman comes to you in her first trimester and asks for your advice regarding immunisation. Which of the following vaccines would you tell is contraindicated for her?",
    "choices": [
      {
        "id": 1,
        "text": "Hepatitis A vaccine"
      },
      {
        "id": 2,
        "text": "Hepatitis B vaccine"
      },
      {
        "id": 3,
        "text": "Tetanus toxoid"
      },
      {
        "id": 4,
        "text": "Varicella vaccine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Varicella vaccine</strong> is <strong>contraindicated</strong>&nbsp;for her as she is <strong>pregnant</strong>.</p>\n<p>Varicella vaccine is a<strong> live attenuated</strong> vaccine which is recommended for <strong>children</strong> aged <strong>12-18 months</strong> and those without a history of chickenpox infection in the past. It is administered <strong>subcutaneously</strong> in one or two-dose schedules.&nbsp;</p>\n<p>It is contraindicated in <strong>pregnant</strong>,&nbsp;<strong>immunocompromised</strong> individuals and those who are <strong>allergic</strong> to <strong>neomycin</strong>. However, patients with clinically stable HIV on HAART (highly active anti-retroviral therapy) can be considered for vaccination if CD4+ cells &gt;15%. Avoidance of <strong>salicylates</strong> is recommended<strong> 6 weeks</strong> after the vaccination to prevent <strong>Reye's syndrome</strong>.&nbsp;</p>\n<p>Maternal varicella infection may result in<strong> fetal loss</strong> and<strong> birth defects</strong>. If maternal varicella infection occurs within <strong>5 days</strong> of <strong>delivery</strong>, the baby should receive <strong>VZIG </strong>(varicella-zoster immunoglobulin) due to the risk of disseminated infection.</p>\n<p>Other options:&nbsp;</p>\n<p>Options A: <strong>Hepatitis A vaccine&nbsp;</strong>can be administered as pre-exposure or post-exposure prophylaxis in <strong>high-risk pregnant</strong> individuals in a two-dose schedule given <strong>intramuscularly</strong> one month apart.</p>\n<p>Option B:&nbsp;<strong>Hepatitis B</strong>&nbsp;<strong>vaccine</strong> can be administered as pre-exposure or post-exposure prophylaxis in <strong>high-risk pregnant</strong> individuals. It is given <strong>intramuscularly</strong> in three doses at 0, 1, and 6 months.&nbsp;</p>\n<p>Option C:&nbsp;<strong>Tetanus toxoid</strong> is routinely administered in pregnant women. The <strong>first dose</strong> is given at <strong>16-20 weeks</strong> while the <strong>second dose</strong> is at <strong>20-24</strong> <strong>weeks</strong> ideally maintaining a one-month interval between the two doses.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Where is the DPT vaccine stored in an ice-lined refrigerator(ILR)?",
    "choices": [
      {
        "id": 1,
        "text": "Stored in the lower zone as it is freeze sensitive"
      },
      {
        "id": 2,
        "text": "Stored in the upper zone as it is freeze sensitive"
      },
      {
        "id": 3,
        "text": "Stored in the upper zone as it is heat sensitive"
      },
      {
        "id": 4,
        "text": "Stored in the lower zone as it is heat sensitive"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>DPT vaccine is <strong>freeze sensitive</strong> and hence stored in the <strong>upper zone</strong> of an ice-lined refrigerator(ILR).</p>\n<p><strong>Freeze sensitive vaccines</strong></p>\n<ul>\n<li>Cholera</li>\n<li>DTaP-hepatitis B-Hib-IPV (hexavalent)</li>\n<li>DIwP or DTwP-hepatitis B-Hib (pentavalent) Hepatitis B (Hep B)</li>\n<li>Hib (liquid)</li>\n<li>Human papillomavirus (HPV)</li>\n<li>Inactivated poliovirus (IPV)</li>\n<li>Influenza</li>\n<li>Pneumococcal</li>\n<li>Tetanus, DT, Td</li>\n<li>Rotavirus (liquid and freeze-dried)</li>\n</ul>\n<p><strong>Ice-lined refrigerators</strong> (ILRs) are the main method of vaccine storage in <strong>primary health centers </strong>(PHCs).ILRs are an important part of the cold chain and they maintain a temperature of <strong>2 to 8 degree Celsius</strong> for storage of vaccines. They have different <strong>temperature zones </strong>for different vaccines and they are stored accordingly in the <strong>baskets</strong> that are provided in most ILRs.The ILRs are lined ice packs or tubes. <strong>Dial</strong> or digital thermometers are used to record temperatures inside an ILR. The below <strong>image</strong> shows an<strong> Ice-lined Refrigerator</strong> (ILR).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bbf200ea2a5f43cfa9a8942fbb3c643ex1279x1264.JPEG"
    ]
  },
  {
    "text": "What is the schedule for pre-exposure prophylaxis in rabies vaccination?",
    "choices": [
      {
        "id": 1,
        "text": "0, 3, 7, 14, 28"
      },
      {
        "id": 2,
        "text": "0, 3, 28"
      },
      {
        "id": 3,
        "text": "0, 14, 28"
      },
      {
        "id": 4,
        "text": "0, 7, and 21 or 28"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Pre-exposure prophylaxis is given on days <strong>0, 7, and 21 or 28</strong>.</p>\n<p>Pre-exposure prophylaxis can be administered via the <strong>intramuscular route</strong> with a dose of 1ml or 0.5 ml, depending on the vaccine type, or <strong>intradermal route</strong> of 0.1 ml volume per site (one site each day) given on days 0, 7, and 21 or 28.&nbsp;</p>\n<p>PrEP is recommended for anyone who is at continual, frequent, or <strong>increased risk of exposure</strong> to the rabies virus either as a result of their residence or occupation laboratory workers dealing with the rabies virus and other lyssa viruses, veterinarians, and animal handlers). For people who are potentially at risk of <strong>laboratory exposure</strong> to high concentrations of live rabies virus, <strong>antibody testing</strong> should be done every <strong>6</strong> <strong>months</strong>. Those professionals who are not at continual risk of exposure through their activities, such as certain categories of <strong>veterinarians</strong> and <strong>animal health officers</strong>, should have serological monitoring every <strong>2 years. The booster</strong> would be recommended only if rabies virus-neutralizing antibody titers fall to <strong>&lt;0.5 IU/ml.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman brought her 14-month-old child to the PHC for routine immunization. The child was born in February 2020 at home and has not received any vaccine till now due to the lockdown. The mother is apprehensive about her child's health and wants to immunize him. Which of the following vaccines can be given to the child now?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 2, 4"
      },
      {
        "id": 3,
        "text": "2, 3, 4"
      },
      {
        "id": 4,
        "text": "1, 2, 4, 5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct answer is <strong>1, 2, 4.</strong></p>\n<p>In the case of an unimmunized\u00a014-month-old child,<strong>\u00a0OPV, measles, </strong>and<strong> vitamin A vaccines </strong>can be <strong>given.</strong></p>\n<p><strong>Catch-up vaccination</strong>\u00a0involves the administration of vaccines in children who have\u00a0<strong>not been immunized at all </strong>(left-outs)\u00a0or for children who\u00a0<strong>took vaccines but could not complete the course\u00a0</strong>(dropouts).</p>\n<p>According to the National Immunization Schedule, <strong>BCG</strong> can only be given up to <strong>1 year</strong> of age.\u00a0</p>\n<p><strong>OPV</strong>\u00a0can be given<strong>\u00a0till 5 years</strong>\u00a0of age.</p>\n<p><strong>Measles</strong>\u00a0can be given\u00a0<strong>till 5 years</strong>\u00a0of age.</p>\n<p><strong>DPT</strong>\u00a0can be given<strong>\u00a0until 7 years</strong>\u00a0of age (with booster doses).</p>\n<p>Only the above-mentioned vaccines have upper age limits.\u00a0</p>\n<p>For pentavalent, IPV, PCV, and rotavirus vaccines, if at least one dose is given before one year of age, then remaining doses can be administered and the schedule must be completed irrespective of the age of the child. <strong>If the first dose is not administered before one year of age</strong>, then these vaccines <strong>cannot be administered to the child under UIP.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You should recommend only 1 booster Td dose to a pregnant woman if pregnancy occurs within _____ years of the last pregnancy and 2 Td doses were received.\n(Choose the best possible option)",
    "choices": [
      {
        "id": 1,
        "text": "5"
      },
      {
        "id": 2,
        "text": "1"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "7"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>You should recommend only <strong>1 booster</strong> Td dose to a pregnant woman if <strong>pregnancy occurs within 3 years of the last pregnancy</strong> and <strong>2 Td doses were received.</strong></p>\n<p>The Tetanus and adult diphtheria (Td) vaccine is a combination of tetanus and diphtheria with a lower concentration of diphtheria antigen (d) as recommended for older children and adults. The MoHFW recommends the replacement of the TT vaccine with the Td vaccine for all age groups, including pregnant women. A dose of 0.5 mL is administered via the intramuscular route in the upper arm.</p>\n<p>Scheduled to be administered at <strong>10 and 16 years of age</strong>.</p>\n<p>For pregnant women :</p>\n<ul>\n<li>Td-1: early in pregnancy</li>\n<li>Td-2: 4 weeks after Td-1</li>\n<li>Td (Booster): if pregnancy occurs within 3 years of the last pregnancy and 2 Td doses were received.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following vaccines to the vaccine strains.",
    "choices": [
      {
        "id": 1,
        "text": "1-B, 2-C, 3-A, 4-D"
      },
      {
        "id": 2,
        "text": "1-B, 2-A, 3-C, 4-D"
      },
      {
        "id": 3,
        "text": "1-B, 2-C, 3-D, 4-A"
      },
      {
        "id": 4,
        "text": "1-C, 2-D, 3-A, 4-B"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct match is</p>\n<table style=\"height: 269px;\" width=\"293\">\n<tbody>\n<tr>\n<td style=\"width: 138.5px;\">1. Yellow fever &nbsp; &nbsp;</td>\n<td style=\"width: 138.5px;\">B) 17D strain</td>\n</tr>\n<tr>\n<td style=\"width: 138.5px;\">2.&nbsp;Rubella &nbsp;</td>\n<td style=\"width: 138.5px;\">C) RA 27/3 strain &nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 138.5px;\">3.&nbsp;Chicken Pox&nbsp;</td>\n<td style=\"width: 138.5px;\">D) OKA strain</td>\n</tr>\n<tr>\n<td style=\"width: 138.5px;\">4.&nbsp;Japanese encephalitis</td>\n<td style=\"width: 138.5px;\">A) 14-14-2 strain</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child presents at 6 weeks of age for vaccination and the clinician decides to give a combination vaccine of diphtheria, pertussis, and tetanus toxoid. How does this affect the body's immune response against tetanus toxoid compared to if it was given alone?",
    "choices": [
      {
        "id": 1,
        "text": "Remains the same whether given alone or in combination as DTP"
      },
      {
        "id": 2,
        "text": "Decreases as the immune system is divided to make antibodies against 3 antigens instead of one"
      },
      {
        "id": 3,
        "text": "Increases as multiple antigens increases the immune response"
      },
      {
        "id": 4,
        "text": "Cannot be predicted"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>immune response</strong> against the tetanus toxoid <strong>increases</strong> if given as a <strong>combination of DTP</strong> when compared to given singly.</p>\n<p>Since this vaccine is given for the first time, the response to tetanus toxoid would be enhanced. If it was given to an older child with a history of other vaccinations, immune response would differ.</p>\n<p>The immune response is variable in response to multiple antigens depending on the <strong>antigenic competition</strong>.</p>\n<ul>\n<li>If 2 bacterial vaccines (say cholera and typhoid) are given, antibodies are produced as if they are given separately.</li>\n<li>If 2 toxoids\u00a0(say tetanus and diphtheria) are given with one in excess, the antibody response to the other is diminished</li>\n<li>If a toxoid is given with a bacterial vaccine\u00a0(say DTP vaccine), the antibody response to the toxoid is potentiated</li>\n<li>If a toxoid is administered earlier (say diphtheria toxoid), and then later given as a triple vaccine (DTP), the antibody response to the pertussis and tetanus antigens will be diminished.</li>\n</ul>\n<p>Other factors may also play a role in antibody response:</p>\n<ul>\n<li>Size and number of doses - a minimum critical dose is required, to elicit a response against an antigen. It increases with an increase in dose, up to a certain point, after which it rather induces tolerance.</li>\n<li>Route of administration- parenteral route induces a better antibody response compared to the oral or nasal route.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Vaccination Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>