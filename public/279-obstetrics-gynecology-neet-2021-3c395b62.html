<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>279 Obstetrics & Gynecology Neet 2021 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Obstetrics & Gynecology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">19</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A pregnant woman at 36 weeks of gestation with a prosthetic valve replacement for mitral stenosis is on warfarin therapy. Her INR is 3. What is the appropriate next step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Stop warfarin and start LMWH"
      },
      {
        "id": 2,
        "text": "Stop warfarin and start heparin"
      },
      {
        "id": 3,
        "text": "Continue warfarin"
      },
      {
        "id": 4,
        "text": "Stop warfarin, start LMWH and asprin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The next appropriate step in the management of a pregnant woman with a prosthetic valve on warfarin therapy at 36 weeks of gestation is to <strong>stop warfarin and start low molecular weight heparin (LMWH).&nbsp;</strong></p>\n<p><strong>Warfarin</strong> is <strong>safe</strong> and effective in preventing thromboembolism in the mother during the <strong>2nd trimester</strong>. However, it is<strong> teratogenic</strong> and can lead to&nbsp;miscarriage, stillbirths, fetal anticoagulation, and fetal embryopathy if used in the <strong>1st trimester</strong>.</p>\n<p>Heparin is safe for the fetus as it does not cross the placenta but is less effective than warfarin in preventing thromboembolism.</p>\n<div class=\"page\" title=\"Page 970\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 970\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 970\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<table style=\"height: 197px;\" width=\"438\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 211px; height: 18px; text-align: center;\"><strong>Period of gestation</strong></td>\n<td style=\"width: 211px; height: 18px; text-align: center;\"><strong>Anticoagulant</strong></td>\n</tr>\n<tr style=\"height: 20.3672px;\">\n<td style=\"width: 211px; height: 20.3672px;\">\n<p>Till 12 completed weeks</p>\n</td>\n<td style=\"width: 211px; height: 20.3672px;\">LMWH or UFH</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 211px; height: 18px;\">13 to 36 weeks</td>\n<td style=\"width: 211px; height: 18px;\">Warfarin</td>\n</tr>\n<tr style=\"height: 19px;\">\n<td style=\"width: 211px; height: 19px;\">36 weeks till just before delivery</td>\n<td style=\"width: 211px; height: 19px;\">LMWH or UFH</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 211px; height: 18px;\">6 hours after vaginal delivery and 24 hours after cesarean section</td>\n<td style=\"width: 211px; height: 18px;\">Warfarin, LMWH or UFH&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>LMWH- Low molecular weight heparin, UFH- Unfractionated heparin&nbsp;</p>\n<p>For patients taking LMWH,<strong> factor Xa</strong> levels should be monitored <strong>weekly</strong>.</p>\n<p>Heparin should be discontinued just before (<strong>at least 6 hours before</strong>) delivery. If delivery occurs before discontinuation and there is extensive bleed&shy;ing, then<strong> iv protamine sulfate</strong> can be given. Warfarin or heparin anticoagulation can be <strong>restarted after 6 hours</strong> of vaginal delivery, usually without any problem.</p>\n<div class=\"page\" title=\"Page 970\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 970\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 970\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Warfarin, LMWH, and UFH <strong>do not accumulate in breast milk</strong> and do not have an anticoagulant effect in the newborn. They are <strong>compatible with</strong> <strong>breastfeeding.</strong></p>\n<p>Other options:</p>\n<p>Option B: Unfractionated heparin can also be given instead of LMWH. However, in this case, the better answer is to give LMWH; because, in clinical practice, LMWHs have a long half-life, once-daily dosing, and fewer side effects. If LMWH is unavailable or cost-prohibitive, or if anti-Xa levels cannot be monitored, continuous infusion of UFH can be used as an alternative to LMWH.</p>\n<p>Option D: Aspirin 75-100 mg can be given daily during pregnancy. It can be continued in women with mechanical heart valves if needed for other indications.</p>\n<p>&nbsp;</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 27-year-old female patient was found to have uterus didelphys. Which of the following is not likely to be a complication of this uterine anomaly?",
    "choices": [
      {
        "id": 1,
        "text": "Abortion"
      },
      {
        "id": 2,
        "text": "Endometriosis"
      },
      {
        "id": 3,
        "text": "Preterm labor"
      },
      {
        "id": 4,
        "text": "Transverse lie"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the given options, transverse lie is not a likely complication of uterus didelphys. A transverse lie is more likely to be seen with an arcuate or sub-septate uterus.</p>\n<p>A <strong>uterus didelphys</strong> is a Mullerian defect characterized by two separate uterine horns, each with an endometrial cavity and uterine cervix. It occurs due to the <strong>failure of fusion</strong> of the M&uuml;llerian ducts.</p>\n<p>It is usually asymptomatic but can rarely present with dyspareunia, dysmenorrhea, hematocolpos, and hematometra. Rarely, <strong>endometriosis&nbsp;</strong>(option B) and genital neoplasms may be associated with uterus didelphys.</p>\n<p>Pregnancy is possible with uterus didelphys, however, there is an increased risk of the following complications:</p>\n<ul>\n<li><strong>Spontaneous abortion&nbsp;</strong>(option A)</li>\n<li><strong>Preterm labor&nbsp;</strong>(option C)</li>\n<li><strong>Breech presentation</strong></li>\n<li>Cesarean delivery</li>\n<li>Intrauterine growth restriction</li>\n<li>Low birth weight (&lt;2.5kg)</li>\n<li>Perinatal death</li>\n</ul>\n<p>Uterus didelphys can be diagnosed with ultrasound or hysterosalpingography, but <strong>MRI</strong> provides the most accurate diagnosis.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eae97069bece48a7b9453abd9b97eadbx608x362.PNG"
    ]
  },
  {
    "text": "A woman who underwent dilatation and curettage for molar pregnancy 6 months ago presents with persistent symptoms of abdominal pain and distention. On further evaluation, the beta-hCG levels were persistently elevated and cannonball foci were found on the chest X-ray. What is the appropriate management in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Methotrexate with folinic acid"
      },
      {
        "id": 2,
        "text": "Methotrexate"
      },
      {
        "id": 3,
        "text": "EMACO regimen"
      },
      {
        "id": 4,
        "text": "Hysterectomy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>GTN typically develops along with or after a molar pregnancy. Rarely, it may develop after live birth, miscarriage, or medical termination of pregnancy. &nbsp;</p>\n<p>The given image below shows the classification of gestational trophoblastic diseases:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3116c609600d414c8f967c1c71405d32x1280x2318.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c4c9b153f34c4d858d5955d3df3acfd5x1280x1460.JPEG"
    ]
  },
  {
    "text": "A female patient has a history of three miscarriages. Identify the investigation that was done from the image shown below.",
    "choices": [
      {
        "id": 1,
        "text": "Hysteroscopy"
      },
      {
        "id": 2,
        "text": "Saline infusion sonography"
      },
      {
        "id": 3,
        "text": "Hysterosalpingography"
      },
      {
        "id": 4,
        "text": "Transvaginal ultrasonography"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option D:&nbsp;Transvaginal ultrasonography is a noninvasive imaging technique using the transvaginal approach. It provides a more detailed evaluation of the pelvic organs as compared to the transabdominal approach.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/667127b0407c41328f4845a1538fb093.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9fefe6552b774a7bb4f076d53f75132ex1280x796.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a8fe7b4e3f674d409ef0cdfd4aaa9f18x600x468.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/56e8bad84a6e4253b74ca4bf3c8acdcfx512x469.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad042dbd49d24626991ea7fe1b16d2a1x625x481.JPEG"
    ]
  },
  {
    "text": "A 56-year-old multipara woman presented with grade II/III uterine prolapse with cystocele. She complains of passing urine on coughing and sneezing. What is the type of urinary incontinence seen in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Overflow incontinence"
      },
      {
        "id": 2,
        "text": "Urge incontinence"
      },
      {
        "id": 3,
        "text": "Stress incontinence"
      },
      {
        "id": 4,
        "text": "Neurogenic bladder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The type of urinary incontinence present in a patient with prolapse and cystocele experiencing <strong>urination on coughing </strong>and<strong> sneezing</strong> is <strong>stress incontinence</strong>.</p>\n<div class=\"page\" title=\"Page 238\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Stress incontinence refers to the<strong> involuntary leakage of urine</strong> when there is <strong>increased intra-abdominal pressure</strong> (eg, coughing, sneezing, laughing, Valsalva maneuver). <strong>Absence of detrusor muscle contraction </strong>is seen in urodynamic studies.</p>\n<p>Causes:</p>\n<ul>\n<li>Age and menopause - due to estrogen deficiency</li>\n<li>Multiparity - due to loss of pelvic muscle tone</li>\n<li>Obesity</li>\n<li>Smoking</li>\n<li>Constipation, chronic cough</li>\n<li>Pelvic organ prolapse</li>\n<li>Pregnancy - due to the effect of <strong>progesterone</strong> and pressure of the gravid uterus on the bladder neck.</li>\n<li>Puerperium - due to descent of the bladder neck, loss of urethro-vesical angle, and reduced pelvic muscle tone&nbsp;</li>\n<li>Surgical repair of vesicovaginal fistula</li>\n</ul>\n<div class=\"page\" title=\"Page 239\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Grading of genuine stress incontinence (GSI) :</p>\n<ul>\n<li>Grade I: Incontinence with only severe stress, such as coughing, sneezing, and jogging.</li>\n<li>Grade II: Incontinence with moderate stress, such as fast walk, going up and down the stairs.</li>\n<li>Grade III: Incontinence with mild stress such as standing.</li>\n</ul>\n<p>Investigations are <strong>only done prior to surgery</strong> to confirm the diagnosis. They include:</p>\n<ul>\n<li>Stress test</li>\n<li>Cotton swab or Q-tip test</li>\n<li>Marshall and Bonney&rsquo;s test</li>\n<li>Urethroscopy</li>\n<li>Urodynamic studies.</li>\n</ul>\n<p>These are not required prior to conservative management.</p>\n<p>Conservative management includes Kegel's pelvic exercises, electric nerve stimulation, devices like pessaries, vaginal cones, and artificial sphincters. Medical treatment with estrogen creams, alpha agonists, venlafaxine, and imipramine may be useful.</p>\n<p>Other options:</p>\n<p>Option A:<strong> Overflow incontinence</strong> is an old term that refers to the <strong>inability to empty the bladder</strong>, with involuntary, continuous urinary dribbling. Currently, it refers to another presentation of urge incontinence.&nbsp;</p>\n<p>Option B: <strong>Urge incontinence</strong> is the involuntary escape of urine when there is an imminent need to urinate. It occurs due to <strong>detrusor muscle overactivity</strong> or <strong>detrusor instability</strong>. It is seen more commonly in <strong>old women with decreased bladder capacity</strong>, decreased sensation, and CNS inhibition.&nbsp;</p>\n<p>Option D: <strong>Neurogenic bladder</strong> occurs in patients with neurogenic dysfunction leading to detrusor hyperreflexia. Conditions such as multiple sclerosis, stroke, Parkinson's disease, and spinal injury give rise to this. They present with urgency or urge incontinence.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old married woman who came for the evaluation of infertility was found to have a septum in her uterine cavity. What would be the appropriate management of this case?",
    "choices": [
      {
        "id": 1,
        "text": "Hysterectomy"
      },
      {
        "id": 2,
        "text": "Laparoscopy and metroplasty"
      },
      {
        "id": 3,
        "text": "Hysteroscopy and septoplasty"
      },
      {
        "id": 4,
        "text": "Laparotomy and metroplasty"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The appropriate management for a 32-year-old woman with a <strong>septate uterus</strong>&nbsp;is <strong>hysteroscopy </strong>and<strong> septoplasty</strong>.</p>\n<p>Hysteroscopic septoplasty refers to the resection of the uterine septum under&nbsp;<strong>hysteroscopic</strong>&nbsp;guidance. The septum can be resected either with a resectoscope or a laser.&nbsp;It does not scar the uterus and avoids the necessity of cesarean sections for future pregnancies. There is a reduced risk of pelvic adhesions, compared with transabdominal approaches.</p>\n<p>A&nbsp;<strong>septate uterus</strong>&nbsp;is characterized by a&nbsp;<strong>septum in the endometrial cavity</strong>.&nbsp;It is caused by the failure of the medial segments of the M&uuml;llerian ducts to regress. This creates a permanent septum within the uterine cavity.&nbsp;</p>\n<p>The septum can project partially from the fundus or extend completely to the cervical os. It is the <strong>most common&nbsp;congenital uterine malformation</strong> in women with infertility.</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Hysterectomy</strong> is not advisable since the patient has come for infertility evaluation and desires pregnancy.</p>\n<p>Options B &amp; D:<strong> Laparoscopy/laparotomy and metroplasty&nbsp;</strong>are not preferred for the treatment of a septate uterus due to the following:</p>\n<ul>\n<li>Requirement of cesarean section for subsequent pregnancies to prevent uterine rupture.</li>\n<li>Postoperative pelvic adhesions leading to infertility.</li>\n</ul>\n<div class=\"page\" title=\"Page 449\">Note: Jone's and Tompkin's metroplasties are surgeries for the septate uterus that involve a transabdominal approach. They cause uterine scarring and are hence not preferred.&nbsp;</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old G4A3 woman had a history of miscarriage at 8 weeks, the second miscarriage at 11 weeks with no cardiac activity, and the third pregnancy loss at 24 weeks with preterm delivery due to early-onset preeclampsia. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Syphilis"
      },
      {
        "id": 2,
        "text": "Antiphospholipid antibody syndrome"
      },
      {
        "id": 3,
        "text": "TORCH infections"
      },
      {
        "id": 4,
        "text": "Gestational diabetes mellitus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of a G4A3 woman with miscarriages at 8 and 11 weeks, and preterm delivery due to preeclampsia at 24 weeks is suggestive of\u00a0<strong>antiphospholipid antibody (APLA) syndrome.\u00a0</strong></p>\n<p>APLA is an autoimmune disorder commonly associated with <strong>fetal death</strong>, <strong>preterm delivery</strong>, <strong>early-onset preeclampsia</strong>, and fetal growth restriction due to placental insufficiency and thromboses. Pregnancy loss usually occurs <strong>before 10 weeks</strong>.</p>\n<p>Diagnosis of APLA requires at least <strong>1 clinical </strong>criterion and <strong>1 laboratory</strong> criterion.</p>\n<ul>\n<li>Obstetric criteria\n<ul>\n<li>One or more unexplained deaths of a morphologically normal fetus at or beyond 10 weeks or</li>\n<li>Severe preeclampsia or placental insufficiency requiring delivery before 34 weeks, or</li>\n<li>Three or more unexplained consecutive spontaneous abortions before 10 weeks</li>\n</ul>\n</li>\n<li>Laboratory criteria\n<ul>\n<li>Presence of lupus anticoagulant, or</li>\n<li>Anticardiolipin antibodies, or</li>\n<li>Anti-\u03b22 glycoprotein antibody</li>\n</ul>\n</li>\n</ul>\n<p><strong>Recurrent pregnancy loss</strong> (RPL), also referred to as a recurrent miscarriage or habitual abortion, is historically defined as <strong>3 consecutive</strong> pregnancy losses <strong>prior to 20 weeks</strong> from the last menstrual period.\u00a0</p>\n<p>Common causes include:</p>\n<ul>\n<li>Parental chromosomal abnormalities</li>\n<li>Untreated hypothyroidism</li>\n<li>Uncontrolled diabetes mellitus</li>\n<li>Uterine anatomic abnormalities,</li>\n<li>Antiphospholipid antibody syndrome\u00a0</li>\n</ul>\n<p>Other options:</p>\n<p><span style=\"text-decoration: underline;\">Option A:</span> There is<strong> no history</strong> of <strong>STD</strong> or <strong>skin lesions </strong>suggestive of syphilis and according to<strong> Kassawitz rule</strong>, in women with untreated syphilis having a series of pregnancies, the likelihood of fetal infection in later pregnancies becomes less; usually, only the first pregnancy is an abortion, the following pregnancy losses will be stillbirths in the next trimester rather than recurrent pregnancy loss.</p>\n<p><span style=\"text-decoration: underline;\">Option C</span><strong>: TORCH</strong> infections may play a role in sporadic spontaneous pregnancy loss, rather than recurrent pregnancy losses.</p>\n<p><span style=\"text-decoration: underline;\">Option D</span>: Gestational diabetes mellitus (GDM) refers to the onset or first recognition of diabetes during pregnancy, usually at the 24-28 weeks screening test. Women with <strong>uncontrolled</strong> <strong>overt or pregestational diabetes</strong> with elevated HbA1c or prepran\u00addial glucose in the first trimester have an increased risk for early miscarriage, but there is a history or lab findings suggestive of gestational diabetes mellitus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old female patient came with a history of fatiguability and constipation for the past 1 year. She has a history of multiple blood transfusions after delivery 4 years ago. She has had a lactational failure and never regained her periods after the delivery. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Sheehan syndrome"
      },
      {
        "id": 2,
        "text": "Hypothyroidism"
      },
      {
        "id": 3,
        "text": "Premature ovarian failure"
      },
      {
        "id": 4,
        "text": "Delayed blood transfusion reaction"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most likely diagnosis in a woman with <strong>lactational failure</strong> and <strong>postpartum amenorrhea,</strong> now presenting with fatiguability and constipation is <strong>Sheehan syndrome.&nbsp;</strong>A history of multiple blood transfusions after delivery indicates major obstetric blood loss, which resulted in pituitary ischemia leading to this condition.</p>\n<p>Sheehan syndrome is&nbsp;<strong>panhypopituitarism </strong>due to<strong>&nbsp;</strong>pituitary ischemia and necrosis following massive obstetrical hemorrhage.</p>\n<p>The most severe form presents with <strong>shock</strong> due to <strong>pituitary apoplexy</strong>. It is characterized by a sudden onset headache, nausea, visual deficits, and hormonal dysfunction due to acute pituitary hemorrhage or infarction. Less severe forms present with <strong>anovulation</strong> and <strong>amenorrhea</strong>.</p>\n<p>Damage to specific pituitary cell types leads to <strong>lactational failure</strong>, loss of axillary and pubic hair, and symptoms of hypothyroidism or adrenal insufficiency. <strong>Prolactin</strong> deficiency is <strong>most commonly encountered</strong>, but <strong>adrenal insufficiency</strong> is the most <strong>life-threatening</strong> complication. Hence, the adrenal function should be immediately assessed if there is any suspicion of Sheehan syndrome.</p>\n<div class=\"page\" title=\"Page 1148\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option B: <strong>Hypothyroidism</strong> can present with vague symptoms such as fatigue, constipation, and amenorrhea. However, postpartum hypothyroidism usually presents<strong> 4-8 months after delivery</strong> after a thyrotoxic phase with palpitations and thyroid enlargement.</p>\n<p>Option C:&nbsp;<strong>Premature ovarian failure</strong> presents with menopausal symptoms. It is due to primary ovarian dysfunction. It is diagnosed when serum FSH levels are <strong>&gt;30-40 mIU/mL on two occasions, at least one month apart.</strong></p>\n<p>Option D: Delayed transfusion reaction presents <strong>days to weeks after the transfusion</strong>. It may be asymptomatic or with low-grade fever. Coombs test may be positive, unconjugated bilirubin increased, and the rise in hemoglobin levels following the transfusion will be less than expected.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The ultrasound of a young woman with infertility is suggestive of a uterine anomaly. Which of the following is used to confirm the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hysterosalpingography"
      },
      {
        "id": 2,
        "text": "Hysteroscopy + laparoscopy"
      },
      {
        "id": 3,
        "text": "Laparoscopy"
      },
      {
        "id": 4,
        "text": "Transvaginal sonography"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options,<strong> hysteroscopy with laparoscopy</strong> is used to confirm the diagnosis.&nbsp;</p>\n<div class=\"page\" title=\"Page 115\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>For infertility evaluation, hysteroscopy and laparoscopy can detect m&uuml;llerian anomalies, screen for co-existent endometriosis, and exclude other tubal or uterine cavity pathology.</p>\n<p>This approach can differentiate between a septate and a bicornuate uterus. On laparoscopy, the presence of a uterine fundus indicates that the uterus is septate, while its absence indicates it is bicornuate. The capacity of each horn in a bicornuate uterus and the depth and thickness of the uterine septum prior to surgical resection can also be assessed.&nbsp;</p>\n<div class=\"page\" title=\"Page 445\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>MRI</strong>&nbsp;is the <strong>gold standard investigation</strong> for the diagnosis of Mullerian anomalies. It clearly delineates both the internal and external uterine anatomy. Complex anomalies and common associations like renal or skeletal anomalies can also be evaluated. It is also<strong> less invasive</strong> than hysteroscopy and laparoscopy in diagnosing Mullerian anomalies.</p>\n</div>\n</div>\n</div>\n</div>\n<p>Other options:</p>\n<p>Option A: <strong>Hysterosalpingography (HSG)</strong> provides information about the interior contour of the uterine cavity but <strong>cannot accurately visualize the external contour</strong> of the uterus.&nbsp;</p>\n<p>Option C: <strong>Laparoscopy alone</strong> as a diagnostic procedure <strong>cannot visualize the interior contour</strong> of a hollow viscus like the uterus. This can be done only with the help of hysteroscopy or imaging such as sonography, HSG, or MRI.</p>\n<div class=\"page\" title=\"Page 116\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option D: <strong>Transvaginal sonography</strong> is used for the <strong>initial detection</strong> of uterine anomalies causing infertility or spontaneous abortions. <strong>Complete evaluation</strong> of these anomalies is done by <strong>MRI.</strong></p>\n<p>Note:&nbsp;</p>\n<ul>\n<li>Hysteroscopy is the <strong>gold standard investigation</strong> to <strong>visualize the uterine cavity</strong> and<strong> tubal ostia</strong>. It also has therapeutic benefits in cases of endometrial polyps, submucous resection of myoma, hysteroscopic adhesiolysis, and resection of uterine septum.&nbsp;</li>\n<li>Laparoscopy is the <strong>gold standard investigation</strong> to <strong>evaluate tubal factors</strong> of infertility.&nbsp;</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old pregnant woman, on examination was found to have infra-umbilical flattening. The fetal heart sounds were heard over the lateral side. What could be the fetal presentation/position?",
    "choices": [
      {
        "id": 1,
        "text": "Brow"
      },
      {
        "id": 2,
        "text": "Knee"
      },
      {
        "id": 3,
        "text": "Occipitoposterior"
      },
      {
        "id": 4,
        "text": "Right dorso-anterior"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The presence of infra-umbilical flattening and fetal heart sounds on the lateral side indicates that the fetus is in the <strong>occipito-posterior position.</strong></p>\n<div class=\"page\" title=\"Page 447\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Occipito-posterior (OP) position of the fetus is when the <strong>occiput</strong> is situated<strong> posteriorly</strong> over the <strong>sacroiliac joint</strong>, or directly over the sacrum. The fetus is in vertex presentation.</p>\n<p>Examination findings of OP position:</p>\n<ul>\n<li>On inspection, the abdomen appears flattened below the umbilicus (<strong>infra-umbilical flattening</strong>).</li>\n<li>Pelvic grips:\n<ul>\n<li>The head is <strong>not engaged.</strong></li>\n<li>The sinciput (cephalic prominence) is not prominently felt.</li>\n</ul>\n</li>\n<li>Auscultation: <strong>Fetal heart sounds</strong> are heard maximally over the <strong>flanks</strong>. However, in the direct OP position, they are heard in the midline.</li>\n</ul>\n<p>There are three variants of OP position:</p>\n<ul>\n<li><strong>Left OP</strong> position (<strong>fourth position</strong> of the vertex) - When the occiput points towards the <strong>left sacroiliac joint</strong>.&nbsp;</li>\n<li><strong>Right OP</strong> position (<strong>third position</strong> of the vertex) - When the occiput points towards the <strong>right sacroiliac joint</strong>. It is <strong>more common</strong> than the left OP position.</li>\n<li><strong>Direct OP position </strong>-<strong>&nbsp;</strong>When the occiput points directly towards the <strong>sacrum</strong>.</li>\n</ul>\n<p>All three positions may be primary (present before the onset of labor) or secondary (develops after the onset of labor).&nbsp;</p>\n<p>Other options:</p>\n<p>Option A: <strong>Brow presentation</strong> is a rare type of cephalic presentation where the position of the head is&nbsp;<strong>in between full flexion and full extension</strong>. The part of the head between the orbital ridge and the anterior fontanel presents at the pelvic inlet.</p>\n<p>Option B: <strong>Knee presentation</strong> is a type of <strong>breech</strong> presentation. Here, the thighs are extended but the knees are flexed, presenting at the pelvic inlet. The head will be palpable as a hard globular mass at the fundus.</p>\n<p>Option D:<strong> Right dorso-anterior position&nbsp;</strong>is when the fetal <strong>back</strong> is directed <strong>anteriorly</strong>. This occurs in a <strong>transverse lie</strong>. On examination, the abdomen appears wide, and a hard plane of resistance is felt. The fundus extends just above the umbilicus. The head is felt in one iliac fossa and the breech is felt in the other.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/29d67545252146a8949df0d44d5f79aax1200x1907.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/64620fdac8fd4547ab70956b7f88a61cx1280x2337.JPEG"
    ]
  },
  {
    "text": "A primi at term presented with labor pain and multiple painful vesicular lesions on her vulva. No rashes were found on other parts of the body. What will be the management of this case?",
    "choices": [
      {
        "id": 1,
        "text": "Acyclovir and elective Cesarean section"
      },
      {
        "id": 2,
        "text": "Acyclovir and induction of labor"
      },
      {
        "id": 3,
        "text": "Spontaneous delivery"
      },
      {
        "id": 4,
        "text": "Antiviral and normal vaginal delivery"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of a primi in labor pain with multiple, painful vesicular lesions on her vulva is suggestive of an <strong>active herpes simplex virus</strong> (HSV) <strong>infection</strong>. Management involves the administration of acyclovir and elective cesarean section.</p>\n<p>HSV infection in pregnancy can be caused by either HSV-1 or HSV-2 and transmitted by sexual contact. The infection can be primary, nonprimary, first episode, and recurrent.&nbsp;&nbsp;</p>\n<p>HSV infection (both HSV 1 and 2) during pregnancy has a risk of vertical transmission of the infection to the fetus. The risk is higher in the primary than in the recurrent infection. The maximum risk of fetal infection is during labor, although it can occur in utero and post-natally from direct contact.&nbsp;</p>\n<p>Suspicious lesions should be sent for PCR testing or culture. Antiviral treatment with acyclovir should be given if found positive. Women with no active genital lesions, asymptomatic, or those with active lesions in non-genital areas can undergo normal labor and delivery.&nbsp;</p>\n<p>Management of HSV infection during pregnancy:</p>\n<ul>\n<li>Oral acyclovir or valacyclovir for primary or recurrent infections during pregnancy.</li>\n<li>IV acyclovir followed by oral acyclovir for severe or disseminated infection</li>\n<li>Oral analgesics or topical anesthetics for pain relief</li>\n<li>Catheterization for urinary retention</li>\n</ul>\n<p>Cesarean delivery reduces the risk of vertical transmission during labor and is indicated in:</p>\n<ul>\n<li>Cases of active genital lesions - both primary and recurrent</li>\n<li>Prodromal symptoms like vulval itching or burning</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: The presene of active lesions is a contraindication for induction of labor.</p>\n<p>Option C: Spontaneous delivery is contraindicated in the presence of active lesions.</p>\n<p>Option D: Even after treatment with acyclovir, normal delivery is not indicated owing to the risk of dormant viral transmission to the fetus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old married woman came for an infertility evaluation. On performing further investigations, intramural fibroids of sizes 7x5cm and 5x3cm were seen at the right and left cornual ends of the uterus. Her husband's semen analysis was found to be normal. What is the appropriate management of this case?",
    "choices": [
      {
        "id": 1,
        "text": "Uterine artery embolization"
      },
      {
        "id": 2,
        "text": "Myomectomy"
      },
      {
        "id": 3,
        "text": "Artificial reproductive techniques"
      },
      {
        "id": 4,
        "text": "GnRH analogues"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most appropriate management for a woman with infertility due to intramural fibroids at both the cornual ends of the uterus is&nbsp;<strong>myomectomy.</strong> The infertility, in this case, is due to the fibroids blocking the right and left cornua of the uterus.</p>\n<p><strong>Myomectomy</strong> refers to the removal of fibroids and preserving the uterus. It is indicated in women presenting with infertility, those who desire pregnancy, or those who wish to retain the uterus.</p>\n<p>Intracavitary fibroids can be resected via the hysteroscopic approach, while subserosal or intramural fibroids require laparotomy or laparoscopic myomectomy.</p>\n<p>Other options:</p>\n<p>Option A: Uterine artery embolization is not done in this case, as it may <strong>decrease fertility</strong>, as a result of pelvic adhesions. It is a technique in which polyvinyl alcohol (PVA), gel foam particles, or metal coils are injected into the uterine arteries. This embolization reduces vascularity and the size of the fibroid. It is best suited to <strong>control menorrhagia in multiparous women.</strong></p>\n<p>Option C:&nbsp;Artificial reproductive techniques are not indicated in this case as infertility is seen to be due to the fibroids blocking the cornual ends of the uterus. However, it may be considered at a later stage.</p>\n<p>Option D: GnRH analogs when used for 6 months, can reduce the tumor size by targeting the growth effects of estrogen and progesterone. It can be used in women with infertility caused by <strong>cornual fibroids</strong>. They are often used <strong>preoperatively</strong> to <strong>reduce the size</strong> of the fibroid and facilitate a hysteroscopic approach to surgery. However, it is <strong>expensive</strong> and can cause <strong>menopausal symptoms</strong> if used for<strong> &gt;6 months</strong>. Fibroids are known to <strong>regrow 3-4 months after stopping the therapy.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old married woman who is anxious to conceive presents with copious vaginal discharge, without any itching. Her last menstrual period was 13 days ago. What is the cause of her vaginal discharge?",
    "choices": [
      {
        "id": 1,
        "text": "Candidiasis"
      },
      {
        "id": 2,
        "text": "Bacterial vaginosis"
      },
      {
        "id": 3,
        "text": "Trichomoniasis"
      },
      {
        "id": 4,
        "text": "Physiological"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario of a young woman with copious, non-pruritic (without itching) vaginal discharge occurring 13 days after menstrual period (period of ovulation) is most likely to be leucorrhoea <strong>(physiological).</strong></p>\n<div class=\"page\" title=\"Page 395\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 395\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The term <strong>leucorrhoea</strong> can be used in conditions where normal vaginal secretion is increased in amount. An increase in this normal vaginal secretion develops physiologically:</p>\n</div>\n</div>\n</div>\n<ul>\n<li>At puberty</li>\n<li>At ovulation</li>\n<li>During pregnancy</li>\n<li>During the premenstrual phase, occasionally</li>\n</ul>\n<p>It may be cervical or vaginal in origin. A speculum examination of the vagina can distinguish between the two. If the discharge is cervical in origin, an excessive mucoid discharge will be visible at the external os.</p>\n<p>Normal discharge appears clear or white, without any odor or itching, and will have a pH of 3.8-4.2.</p>\n<p>Other options:</p>\n<p>Option A: Candidiasis is caused by infection with <strong>Candida albicans</strong> and presents with <strong>pruritus</strong>, burning, and dysuria with vulvar erythema, edema, and excoriations. A&nbsp;<strong>curdy white discharge </strong>will be present.&nbsp;</p>\n<p>Option B:&nbsp;<strong>Bacterial vaginosis</strong>&nbsp;is caused by an alteration in the normal vaginal flora and presents&nbsp;<strong>without</strong>&nbsp;<strong>itching</strong> and a malodorous grey-white discharge. It is diagnosed using <strong>Amsel's criteria</strong>, where&nbsp;at&nbsp;least three&nbsp;of the four following criteria should be present to confirm the diagnosis:</p>\n<ul>\n<li>Homogenous vaginal discharge</li>\n<li>Vaginal pH &gt; 4.5</li>\n<li>Amine-like odor on adding KOH (Whiff test positive)</li>\n<li>Clue cells (&gt;20% of cells)</li>\n</ul>\n<p>Option C:&nbsp;<strong>Trichomoniasis</strong>&nbsp;is caused by Trichomonas vaginalis and presents with a <strong>copious</strong>, frothy, <strong>offensive yellow-green discharge</strong> with <strong>vaginal soreness or irritation</strong> and urinary frequency. On examination, the&nbsp;vagina looks red and inflamed. The inflamed&nbsp;cervix <strong>looks like a strawberry</strong>&nbsp;with punctate hemorrhagic spots.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient developed atonic postpartum hemorrhage after a normal vaginal delivery. She was shifted to the OT and the obstetrician planned ligation of vessels to arrest the bleeding. What is the order of ligation of the blood vessels supplying the uterus?",
    "choices": [
      {
        "id": 1,
        "text": "Uterine artery - Ovarian artery - Internal iliac artery"
      },
      {
        "id": 2,
        "text": "Uterine artery - Ovarian artery- External iliac artery"
      },
      {
        "id": 3,
        "text": "Uterine artery - Ovarian artery - Vaginal artery"
      },
      {
        "id": 4,
        "text": "Uterine artery - pudendal artery - Vaginal artery"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The order of ligation of vessels to arrest bleeding in atonic postpartum hemorrhage (PPH) is the <strong>uterine artery - ovarian artery - internal iliac artery</strong>.</p>\n<p>The ascending branch of the <strong>uterine artery </strong>is ligated between the upper and lower segments of the uterus, at the lateral border. If the bleeding continues, the <strong>ovarian and uterine artery anastomosis </strong>is ligated just below the ovarian ligament. If the bleeding still persists, the anterior division of the <strong>internal iliac artery </strong>is ligated 5 cm distal to the common iliac bifurcation. &nbsp;</p>\n<p>Unilateral or bilateral ligation of the internal iliac artery ligation causes a reduction in the pulse pres&shy;sure in the arteries distal to the ligation. This increases the chances of hemostasis via pressure and clot formation.</p>\n<div class=\"page\" title=\"Page 808\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Surgical methods to control PPH are outlined as stepwise uterine devascularization procedures:</p>\n<ul>\n<li>Compression sutures: B-Lynch suture</li>\n<li>Ligation of uterine arteries</li>\n<li>Ligation of ovarian and uterine anastomosis</li>\n<li>Ligation of internal iliac artery</li>\n<li>Angiographic embolization of the bleeding vessel</li>\n</ul>\n<p>Pelvic packing (usually done prior to embolization) and hysterectomy are other surgical methods employed to control PPH.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e2720674c69b418e8fc02346abbcc09bx1280x2569.JPEG"
    ]
  },
  {
    "text": "A teenage patient presented with a history of dysmenorrhea and chronic pelvic pain. On ultrasonography, a transverse vaginal septum was seen. What is the most common complication that can be seen in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Endometriosis"
      },
      {
        "id": 2,
        "text": "Tubo-ovarian abscess"
      },
      {
        "id": 3,
        "text": "Dermoid cyst"
      },
      {
        "id": 4,
        "text": "Theca lutein cyst"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most common complication that can be seen in this patient is <strong>endometriosis</strong>.</p>\n<p>Transverse vaginal septum leads to obstructed flow of menstrual blood. This may lead to <strong>retrograde menstruation</strong>, which increases the likelihood of the development of <strong>endometriosis</strong>, according to Sampson's theory of endometriosis.</p>\n<p><strong>Transverse vaginal septum</strong> occurs as a result of the <strong>failure of M\u00fcllerian duct fusion</strong> or <strong>failure of\u00a0vaginal plate canalization</strong>. It may be obstructive or non-obstructive.\u00a0The commonest site of a transverse septum is the junction between the upper and middle third of the vagina.</p>\n<p>Patients with an obstructive or imperforate vaginal septum present with symptoms similar to the imperforate hymen. Symptoms include <strong>amenorrhoea</strong>, <strong>cyclical abdominal pain</strong>, urinary symptoms, and a palpable pelvic mass. The <strong>vagina</strong> may appear <strong>shortened</strong> and the cervix may not be identifiable. Secondary sexual characteristics appear normal. The diagnosis can be confirmed with ultrasound or MRI.</p>\n<p>There is an increased<strong>\u00a0risk of endometriosis.</strong>\u00a0Other complications such as <strong>pyomucocolpos, pyometra</strong>, and <strong>pyosalpinges</strong> can also develop in infants with obstructive vaginal septums.\u00a0</p>\n<p>Treatment is by manual dilatation of the perforation or surgical excision of the septum.\u00a0</p>\n<p>Other options:</p>\n<p>Option B: <strong>Tubo-ovarian abscess</strong>\u00a0develops in pelvic\u00a0inflammatory disease.</p>\n<p>Option C: <strong>Dermoid cysts</strong> are cystic ovarian tumors that are often associated with mucinous cystadenomas.</p>\n<p>Option D: <strong>Theca lutein cysts</strong> are\u00a0found in association with hydatidiform moles, choriocarcinoma, and gonadotropin or clomiphene citrate therapy. They regress with the management of the mole and choriocarcinoma and discontinuation of gonadotropin therapy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 28-year old pregnant woman came for a routine antenatal check-up in her second trimester. Four years back, she delivered 2 healthy full-term twins. What would her obstetric score be?",
    "choices": [
      {
        "id": 1,
        "text": "G2P2"
      },
      {
        "id": 2,
        "text": "G3P2"
      },
      {
        "id": 3,
        "text": "G2P1"
      },
      {
        "id": 4,
        "text": "G3P1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The obstetric score of a pregnant woman who previously delivered twins would be <strong>G2P1</strong><strong>&nbsp;(gravida 2 para 1).</strong></p>\n<p>The term&nbsp;<strong>gravida</strong>&nbsp;refers to the <strong>number of times</strong> the woman has been <strong>pregnant</strong>, irrespective of whether it crossed the period of viability. The<strong>&nbsp;current pregnancy</strong>&nbsp;is<strong>&nbsp;included&nbsp;</strong>in this count. Since she has been pregnant once before with twins and is currently pregnant now, gravida will be 2.</p>\n<p>The term<strong> para </strong>refers to&nbsp;the <strong>number of previous pregnancies</strong>&nbsp;<strong>reaching </strong>a period of<strong> viability </strong>(gestation of <strong>28 weeks</strong>). It does not increase to a higher number if multiples (twins/triplets) are delivered in a given pregnancy and still count as one birth. A<strong>&nbsp;current pregnancy</strong>, if any, is<strong>&nbsp;not included&nbsp;</strong>in this count. Therefore, para here will be 1 since she had one birth of twins and the present pregnancy is not counted.</p>\n<p>Both gravidity and parity refer to the pregnancies and not the fetuses.</p>\n<p>Note: The <strong>period of viability</strong> is when the fetus is capable of independent existence. The <strong>WHO</strong> defines it to be <strong>24 weeks</strong> while the <strong>Indian definition</strong> is <strong>28 weeks</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 27-year-old woman who is on oral contraceptive pills for contraception has forgotten to take her pills on 4 different days in the last 2 weeks. She presents to the primary health center, asking for advice. What would you suggest to her?",
    "choices": [
      {
        "id": 1,
        "text": "Take 4 pills now, continue the schedule, use barrier method of contraception"
      },
      {
        "id": 2,
        "text": "Take 1 pill now, continue the schedule, and use barrier method of contraception"
      },
      {
        "id": 3,
        "text": "Take 1 pill now, use barrier method, and consider emergency contraception in case of recent intercourse"
      },
      {
        "id": 4,
        "text": "Discard the pack, start a new pack with alternate method of contraception"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A woman who has missed 4 oral contraceptive pills in the last two weeks should <strong>take one hormonal pill </strong>as soon as possible and <strong>finish all hormonal pills</strong> in the pack as scheduled, <strong>throw away the 7 non-hormonal pills</strong> in a 28-pill pack and <strong>start a new pack the next day</strong>.\u00a0</p>\n<table style=\"height: 306px;\" width=\"394\">\n<tbody>\n<tr>\n<td style=\"width: 189px;\"><strong>Missed pills</strong></td>\n<td style=\"width: 189px;\"><strong>Management</strong></td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">\n<p>Missed 1 or 2 pills/ started new pack 1 or 2 days late?</p>\n<p>\u00a0</p>\n</td>\n<td style=\"width: 189px;\">\n<p>You have two options: take one hormonal pill right away, or take two pills at your usual scheduled time.\u00a0</p>\n<p>The risk of pregnancy is minimal to none.</p>\n<p>\u00a0</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">\n<p>Missed 3 or more pills in the first or second week/started new pack 3 or more days late?</p>\n</td>\n<td style=\"width: 189px;\">\n<p>Take one hormonal pill immediately and then continue taking your pills as scheduled.\u00a0</p>\n<p>Make sure to use a backup method of contraception for the next seven days.</p>\n<p>Additionally, if you've had sexual intercourse within the last 72 hours, consider taking emergency contraceptive pills.</p>\n<p>\u00a0</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">Missed 3 or more pills in the third week?</td>\n<td style=\"width: 189px;\">\n<p>Take one hormonal pill as soon as you can and complete the entire pack of hormonal pills according to the schedule.\u00a0</p>\n<p>Discard the seven non-hormonal pills in a 28-pill pack.\u00a0</p>\n<p>Begin a new pack the following day.</p>\n<p>\u00a0</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 189px;\">Missed any nonhormonal pills? (last 7 pills in 28-pill pack)</td>\n<td style=\"width: 189px;\">\n<p>Dispose of any missed non-hormonal pills.\u00a0</p>\n<p>Continue taking your combination oral contraceptives (COCs), one pill each day.\u00a0</p>\n<p>Begin the new pack as you normally would.</p>\n<p>\u00a0</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>If any non-hormonal pills were missed, she can discard the remaining pills. Start the new pack of oral contraceptives and continue taking as usual.</p>\n<p>If she vomits within 2 hours of taking a pill, another pill from the pack should be taken as soon as possible. After that, continue taking the pills as scheduled. If the vomiting or diarrhea persists for &gt;2 days, follow the instructions for 1 or 2 missed pills as mentioned above.</p>\n<p>The contraceptive method should be discontinued and changed in the following situations:</p>\n<ul>\n<li>Unexplained or prolonged heavy vaginal bleeding that suggests an underlying condition not related to the method</li>\n<li>Starting anticonvulsant medication or treatment with rifampicin</li>\n<li>Migraines</li>\n<li>Non-ambulatory conditions lasting for &gt;1 week like major surgery, leg in a cast, etc. Combined oral contraceptives can be restarted 2 weeks after ambulation.</li>\n<li>Suspected heart or liver disease, hypertension, deep vein thrombosis, stroke, breast cancer, diabetes, or gall bladder disease\u00a0</li>\n</ul>\n<p>\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old female patient, on treatment for infertility, came with 6 weeks of amenorrhea, abdominal pain, and mild vaginal bleeding. Her beta hCG level was 2800 mIU/mL. On ultrasound, a 3cm mass was seen in the left adnexa. It contained a gestational sac with no fetal cardiac activity. What is the most appropriate management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Expectant management"
      },
      {
        "id": 2,
        "text": "Single dose methotrexate"
      },
      {
        "id": 3,
        "text": "Salpingectomy"
      },
      {
        "id": 4,
        "text": "Milking of the tube"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A patient on infertility treatment, with 6 weeks of amenorrhea, abdominal pain, and vaginal bleeding with beta hCG levels of 2800 mIU/mL, and a gestational sac in the left adnexa points to the diagnosis of <strong>unruptured ectopic pregnancy </strong>and the most appropriate management is single-dose methotrexate.</p>\n<p>A pregnancy is considered ectopic if implantation occurs at a site outside the uterine cavity. The majority of ectopic pregnancies occur in the fallopian tube, the <strong>ampulla</strong> being the<strong> most common site</strong>.</p>\n<p>Management of ectopic pregnancy:&nbsp;</p>\n<p><strong>Expectant</strong> management: Ectopic pregnancies measuring <strong>&lt;3 cm</strong> and with <strong>declining beta hCG </strong>levels initially&nbsp;<strong>&lt;1500 mIU/mL</strong> may resolve without inter&shy;vention and can be managed expectantly.&nbsp;</p>\n<p><strong>Medical</strong> <strong>management</strong> with <strong>single</strong> or<strong> multiple-dose methotrexate</strong> is preferred if:</p>\n<ul>\n<li>Hemodynamic stability</li>\n<li>Serum beta-hCG <strong>&ge;1500 mIU/ml </strong>and <strong>&le;5000 mIU/mL</strong></li>\n<li>Mean sac diameter<strong> &lt;3.5cm</strong> with <strong>no fetal cardiac activity</strong> detected on transvaginal ultrasound.</li>\n<li>Patients are willing and able to comply with post-treatment follow-up and have access to emergency medical services within a reasonable time frame in case of a deterioration in the clinical status.</li>\n</ul>\n<p>Methotrexate(MTX) can be given as a single IM dose of 50 mg/m<sup>2</sup> or as a multiple-dose regimen of 1mg/kg on days 1, 3, 5, and 7.</p>\n<p><strong>Surgical management</strong> with <strong>salpingectomy</strong> or <strong>salpingostomy</strong> is done when:</p>\n<ul>\n<li>Criteria for expectant and medical management are not met</li>\n<li>Gestational sac&nbsp;<strong>&gt;3.5 cm</strong></li>\n<li>Fetal cardiac activity present</li>\n<li><strong>Beta hCG &gt; 5000 mIU/mL</strong></li>\n<li>Significant pain and hemoperitoneum&nbsp;</li>\n<li>Failure of expectant or medical management</li>\n<li>Clinical status of patient warrants urgent intervention</li>\n<li>Doubtful compliance with medical management&nbsp;</li>\n</ul>\n<p><strong>Milking</strong> of the tube through the fimbriae carries a <strong>high risk of bleeding</strong>, <strong>damage to the tube</strong>, the <strong>persistence of trophoblastic tissue,</strong> and <strong>recurrence</strong> of ectopic pregnancy.&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old woman on oral contraceptives for the past 6 months presents with 6 weeks of amenorrhea. What would be the best method of assessing the gestational age of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Crown rump length by USG"
      },
      {
        "id": 2,
        "text": "Adding 280 days to the LMP"
      },
      {
        "id": 3,
        "text": "Fundus examination"
      },
      {
        "id": 4,
        "text": "Adding 256 days to the LMP"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 70\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 70\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 757\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Ultrasonographic parameters for estimation of the gestational age according to the trimester are as follows:</p>\n</div>\n</div>\n</div>\n</div>\n<table style=\"width: 372px; height: 179px;\">\n<tbody>\n<tr>\n<td style=\"width: 116.18px;\">\n<p><strong>Trimester</strong></p>\n</td>\n<td style=\"width: 227.227px;\">\n<p><strong>Parameter</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 116.18px;\">\n<p>1st&nbsp;</p>\n</td>\n<td style=\"width: 227.227px;\">\n<p>Crown-rump length (CRL)</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 116.18px;\">\n<p>2nd and 3rd&nbsp;</p>\n</td>\n<td style=\"width: 227.227px;\">\n<ul>\n<li>Biparietal diameter (BPD)</li>\n<li>Abdominal Circumference (AC)</li>\n<li>Head Circumference (HC)</li>\n<li>Femur Length. (FL)&nbsp;</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"page\" title=\"Page 70\">Other options:</div>\n<div class=\"page\" title=\"Page 70\">&nbsp;</div>\n<div class=\"page\" title=\"Page 70\">Option B: Adding 280 days to the LMP will provide the <strong>expected delivery date (EDD)</strong>. Adding 9 months + 7 days to the LMP or 280 days to the LMP is <strong>Naegele&rsquo;s formula</strong> for calculating the EDD.</div>\n<div class=\"page\" title=\"Page 70\">&nbsp;</div>\n<div class=\"page\" title=\"Page 70\">Option C: Measurement of <strong>fundal height</strong> in cm (with a variation of 1-2cm) is roughly equal to the <strong>gestational age</strong> in weeks, <strong>after 24 weeks of pregnancy</strong>. This is measured from the superior border of the symphysis pubis to the top of the uterine fundus when the bladder is empty.&nbsp;</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b715a494b85c410c82c45ec9bc851ad0x720x577.JPEG"
    ]
  }
];
        let quizName = '279 Obstetrics & Gynecology Neet 2021';
        let hierarchy = ["Marrow", "PYQs", "Obstetrics & Gynecology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>