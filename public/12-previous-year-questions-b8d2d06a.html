<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12 Previous Year Questions - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Psychiatry
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">14</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>Which of the following is a selective norepinephrine reuptake inhibitor used in the management of ADHD?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Modafinil"
      },
      {
        "id": 2,
        "text": "Reboxetine"
      },
      {
        "id": 3,
        "text": "Guanfacine"
      },
      {
        "id": 4,
        "text": "Methylphenidate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option B \u2013 Reboxetine:</strong></p>\n\n<ul>\n\t<li>Reboxetine is a selective <span class=\"customMeta\" data-dictid=\"155371e9941692777193b48666ce0a\">norepinephrine</span> <span class=\"customMeta\" data-dictid=\"42c441fad11692777197258f322307\">reuptake</span> <span class=\"customMeta\" data-dictid=\"b5fb56a28b1692777190396ae8b625\">inhibitor</span> (NRI) used in the management of Attention Deficit <span class=\"customMeta\" data-dictid=\"2e780c7fd416927771895c61217c12\">Hyperactivity</span> Disorder (ADHD). However, it is not FDA-approved, so it is not used in India and is currently limited to Europe.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p>Options A, C, and D are used in the management of ADHD but are not selective <span class=\"customMeta\" data-dictid=\"155371e9941692777193b48666ce0a\">norepinephrine</span> <span class=\"customMeta\" data-dictid=\"42c441fad11692777197258f322307\">reuptake</span> inhibitors.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A child with untreated ADHD is most likely to develop which of the following disorders during adolescence?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Binge eating"
      },
      {
        "id": 2,
        "text": "Selective mutism"
      },
      {
        "id": 3,
        "text": "Separation from parent leading to depression"
      },
      {
        "id": 4,
        "text": "Conduct disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Option D - Conduct disorder:</strong></p>\n\n<ul>\n\t<li>Children with untreated ADHD are at an increased risk of developing conduct disorder during adolescence.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Options A, B, and C</strong> are less likely to develop in the <span class=\"customMeta\" data-dictid=\"98d9739e5f1692777180d7de404750\">adolescence</span> of a child with untreated ADHD.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 6-year-old boy was presented in the psychiatric OPD with complaints of inattention at school, hitting his friends and excessive talking, poor academic performance, and inability to sit in a place for a long time. What drug is used in the management of this disorder?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Methylphenidate"
      },
      {
        "id": 2,
        "text": "Modafinil"
      },
      {
        "id": 3,
        "text": "Atenolol"
      },
      {
        "id": 4,
        "text": "Amitriptyline"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Methylphenidate </strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The given scenario featuring inattention, aggression, excessive talking, poor academic performance, and difficulty sitting still suggests <strong>Attention Deficit Hyperactivity Disorder (ADHD)</strong>, which is managed with methylphenidate.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p><strong>Attention Deficit Hyperactivity Disorder (ADHD)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Aetiology </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Genetic Factors: Runs in families, with parents or siblings more likely to have the condition<strong> (DAT1 gene and DRD4 gene).</strong></li>\n\t\t\t\t<li><strong>Neurochemical Factors: </strong>Linked to <strong>dopamine</strong> <span class=\"customMeta\" data-dictid=\"3662597407169277718640a12868f5\">dysfunction</span> and <strong>noradrenergic system.</strong></li>\n\t\t\t\t<li><strong>Neurophysiological Factors: </strong>EEG usually shows <span class=\"customMeta\" data-dictid=\"ccb50023dc1692777200804b8475ca\">theta</span> and <span class=\"customMeta\" data-dictid=\"806eb8418c16927771822855b56695\">beta</span> waves in the <span class=\"customMeta\" data-dictid=\"35aa36279d16927772031c7ce8d6e5\">frontal</span> brain.</li>\n\t\t\t\t<li><strong>Neuroanatomical Factors:</strong> Decreased activity in brain areas like the <span class=\"customMeta\" data-dictid=\"25bc983c6716927771967f68667610\">prefrontal</span> cortex, <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> cingulate, and <span class=\"customMeta\" data-dictid=\"923af580cf16927771829606bce2a7\">basal</span> ganglia.</li>\n\t\t\t\t<li><strong>Developmental Factors:</strong> Prenatal and <span class=\"customMeta\" data-dictid=\"a0d3680eab1692777195d6ab932b14\">perinatal</span> factors, such as <span class=\"customMeta\" data-dictid=\"84f13673191692777196762b18e036\">premature</span> birth, <span class=\"customMeta\" data-dictid=\"a191a950d7169277719148e72a75e2\">maternal</span> infections during pregnancy, and low birth weight, may increase the risk.</li>\n\t\t\t\t<li><strong>Psychosocial Factors: </strong>Severe abuse, neglect, or maltreatment can worsen or <span class=\"customMeta\" data-dictid=\"efaf9e0192169277719278711f7f74\">mimic</span> ADHD symptoms.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Clinical features </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Hyperactivity: </strong>Restlessness, difficulty remaining seated, inappropriate running and climbing, excessive talking, interrupting others.</li>\n\t\t\t\t<li><strong>Attention Deficit: </strong>Short attention span, distractibility, difficulty following instructions, forgetfulness, disorganisation, procrastination.</li>\n\t\t\t\t<li><strong>Impulsivity: </strong>Acting without thinking, difficulty waiting for their turn, interrupting others, blurting out answers.</li>\n\t\t\t\t<li><strong>Other: </strong>Emotional lability, explosiveness, irritability, memory and thinking defects, specific learning difficulties, speech and Hearing deficits.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Diagnosis </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>For an <strong>ADHD diagnosis to be confirmed</strong>, symptoms must be present in <strong>at least two different environments</strong>, such as both school and home. This ensures that the behaviour is not limited to one specific context and indicates a broader issue with attention and self-regulation.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Treatment </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Pharmacotherapy</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li><strong>Stimulant Medication:</strong>\n\n\t\t\t\t<ul>\n\t\t\t\t\t<li>Methylphenidate (1st drug of choice)</li>\n\t\t\t\t\t<li>Amphetamine (2nd drug of choice)</li>\n\t\t\t\t\t<li>Modafinil (<strong>not FDA-approved</strong>) <strong>(Option B ruled out)</strong></li>\n\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t\t<li><strong>Non-stimulant medication </strong>\n\t\t\t\t<ul>\n\t\t\t\t\t<li>Atomoxetine</li>\n\t\t\t\t\t<li>Bupropion (<strong>not FDA-approved for ADHD</strong>)</li>\n\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\n\t\t\t<p>\u00a0</p>\n\n\t\t\t<p><strong>Psychosocial interventions</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Atenolol (Option C)</strong> is a beta-blocker which is used in the treatment of hypertension. It has no role in the management of ADHD.</p>\n\n<p><strong>Amitriptyline (Option D)</strong> belongs to the class of <span class=\"customMeta\" data-dictid=\"66bf14385516927772001b3646b855\">tricyclic</span> <span class=\"customMeta\" data-dictid=\"f4dc45846216927771816608bfe8cd\">antidepressant</span> drugs (TCA). It has no role in the management of ADHD.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following is not included in diagnosing autism spectrum disorder?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Abnormalities in social communication"
      },
      {
        "id": 2,
        "text": "Congnitive dysfunction"
      },
      {
        "id": 3,
        "text": "Abnormality in socialization"
      },
      {
        "id": 4,
        "text": "Restricted pattern of behaviour and interest"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option B - Cognitive dysfunction:</strong></p>\n\n<ul>\n\t<li>Cognitive <span class=\"customMeta\" data-dictid=\"3662597407169277718640a12868f5\">dysfunction</span> is not a <span class=\"customMeta\" data-dictid=\"9167b944ea169277718582367e0915\">criterion</span> for diagnosing ASD.</li>\n\t<li>While some individuals with ASD may have cognitive impairments, cognitive <span class=\"customMeta\" data-dictid=\"3662597407169277718640a12868f5\">dysfunction</span> is not a <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> <span class=\"customMeta\" data-dictid=\"9167b944ea169277718582367e0915\">criterion</span> itself.</li>\n\t<li>ASD diagnosis focuses on social communication difficulties and restricted behaviors, not cognitive abilities.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A - Abnormalities in social communication: </strong>This is included in diagnosing ASD. Individuals with ASD typically have difficulties with social communication, such as challenges in understanding and using verbal and non-verbal communication.</p>\n\n<p><strong>Option C - <span class=\"customMeta\" data-dictid=\"e7ed1a964716927771801ab913204a\">Abnormality</span> in socialization: </strong>This is included in diagnosing ASD. Abnormalities in socialization, such as difficulty in developing, maintaining, and understanding relationships, are a key component of ASD diagnosis.</p>\n\n<p><strong>Option D - Restricted pattern of behaviour and interest: </strong>This is included in diagnosing ASD. Individuals with ASD often exhibit restricted and repetitive patterns of behavior, interests, or activities. This is a core <span class=\"customMeta\" data-dictid=\"9167b944ea169277718582367e0915\">criterion</span> for ASD diagnosis. \u200b</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following is a new drug approved for Rett syndrome?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Trofinetide"
      },
      {
        "id": 2,
        "text": "Ambien"
      },
      {
        "id": 3,
        "text": "Lunesta"
      },
      {
        "id": 4,
        "text": "GHB opioids"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer A - Trofinetide</strong></p>\n\n<ul>\n\t<li><strong>Trofinetide</strong> is a new drug approved for Rett syndrome.</li>\n\t<li>It is a <span class=\"customMeta\" data-dictid=\"61fbe2173416927771998e7aa0b432\">synthetic</span> <span class=\"customMeta\" data-dictid=\"22e0051a181692777181872183edb2\">analogue</span> of glycine-proline-glutamate, a naturally occurring peptide.</li>\n\t<li>The exact mechanism is unknown, but it may have anti-inflammatory and <span class=\"customMeta\" data-dictid=\"0ae7ad52281692777200ef75a10716\">trophic</span> effects.</li>\n\t<li>Clinical trials have shown promising results, with improvements in certain <span class=\"customMeta\" data-dictid=\"8af6a293cc16927771971fe815bbed\">Rett syndrome</span> symptoms.</li>\n</ul>\n\n<p><strong>Ambien (Option B)</strong>, <span class=\"customMeta\" data-dictid=\"343b03419d169277718828bb100c95\">generic</span> name: zolpidem, is a <span class=\"customMeta\" data-dictid=\"dd4bbf3a1a16927771988e61c3d5e9\">sedative</span> medication primarily used for the treatment of insomnia.</p>\n\n<p><strong>Lunesta (Option C)</strong>, <span class=\"customMeta\" data-dictid=\"343b03419d169277718828bb100c95\">generic</span> name: eszopiclone, is another <span class=\"customMeta\" data-dictid=\"dd4bbf3a1a16927771988e61c3d5e9\">sedative</span> medication used for the treatment of insomnia. Similar to Ambien,</p>\n\n<p><strong>GHB opioids (Option D)</strong> is a central nervous system <span class=\"customMeta\" data-dictid=\"974aacc9c716927771867653a1dd71\">depressant</span> (gamma-hydroxybutyrate) that has been used recreationally and has <span class=\"customMeta\" data-dictid=\"dd4bbf3a1a16927771988e61c3d5e9\">sedative</span> effects. Opioids, on the other hand, are a class of medications used for pain relief. Neither <span class=\"customMeta\" data-dictid=\"59300e930c16927771887aaef42224\">GHB</span> <span class=\"customMeta\" data-dictid=\"fe5171bb0016927771933a5ca5d376\">nor</span> opioids are approved drugs specifically indicated for the treatment of Rett syndrome.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What should be the treatment approach for a 7-year-old child who has been experiencing bed-wetting about twice a week for the past year, following a thorough investigation to exclude any underlying organic cause?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Pharmacotherapy with imipramine"
      },
      {
        "id": 2,
        "text": "Psychodynamic psychotherapy"
      },
      {
        "id": 3,
        "text": "Bladder training, with the reward for delaying micturition during daytime"
      },
      {
        "id": 4,
        "text": "Bell and pad-based classification conditioning"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Bell and pad-based <span class=\"customMeta\" data-dictid=\"dda6ab11271692777184264b752d39\">classification</span> conditioning</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>Bed-wetting, also known as <strong>nocturnal enuresis</strong>, is a common problem in children, often occurring during sleep. T</li>\n\t<li>The <strong>bell and pad method</strong> is the <strong>most appropriate first-line treatment</strong> for bed-wetting in children without organic causes.</li>\n\t<li>This method involves a moisture-sensitive pad attached to the child's underwear.</li>\n\t<li>When the child begins to wet the bed, the bell rings, waking them up and helping them associate the sensation of a full <span class=\"customMeta\" data-dictid=\"e6cfda323816927771839cc83e376d\">bladder</span> with the action of waking up.</li>\n\t<li>Over time, this <span class=\"customMeta\" data-dictid=\"e7e8b232581692777184eaae773f67\">conditioning</span> process helps the child learn to wake up before urinating, effectively reducing bed-wetting.</li>\n</ul>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align: center;\"><strong>Management of enuresis</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Behavioural modifications:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Reassurance.</li>\n\t\t\t\t<li>Encourage voiding before bed.</li>\n\t\t\t\t<li>Restrict evening <span class=\"customMeta\" data-dictid=\"3d7596c31c1692777203ecf2ce7a17\">fluid intake</span> (40% in the morning, 40% at noon, 20% after 6 PM).</li>\n\t\t\t\t<li>Avoid caffeinated drinks.</li>\n\t\t\t\t<li>Motivational Therapy: Use verbal praise and rewards for dry nights.</li>\n\t\t\t\t<li><strong>Bell and pad method (Alarm Therapy).</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Medications:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Short-Term: Oral desmopressin for immediate relief.</li>\n\t\t\t\t<li>Long-Term: Oxybutynin or tolterodine to reduce <span class=\"customMeta\" data-dictid=\"e6cfda323816927771839cc83e376d\">bladder</span> contractions. <span class=\"customMeta\" data-dictid=\"6a6c40876c169277718989ffa2a6d1\">Imipramine</span> is avoided due to side effects<strong> </strong><strong>(Option A ruled out)</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><br />\n<strong>Psychodynamic <span class=\"customMeta\" data-dictid=\"f3f884992516927771965b324c2faf\">psychotherapy</span> </strong><strong>(Option B)</strong> focuses on resolving <span class=\"customMeta\" data-dictid=\"6d87fbc02c16927772014ec4cead53\">unconscious</span> conflicts but is <strong>not a first-line treatment</strong> for bed-wetting. This approach is not typically indicated for primary <span class=\"customMeta\" data-dictid=\"d51601f2c41692777193ddfa55d163\">nocturnal</span> enuresis, especially when there are no significant emotional or psychological factors contributing to the issue.<strong> </strong></p>\n\n<p><strong>Bladder training, with reward for delaying <span class=\"customMeta\" data-dictid=\"c9ea308a4d169277719266a39f4872\">micturition</span> during daytime </strong><strong>(Option C)</strong><strong>:</strong> While <strong>bladder training</strong> can be effective in treating daytime <span class=\"customMeta\" data-dictid=\"0b72f5e96b16927772018dec8a87e2\">urinary</span> issues, it is generally <strong>not as effective for <span class=\"customMeta\" data-dictid=\"d51601f2c41692777193ddfa55d163\">nocturnal</span> enuresis</strong>. It might improve <span class=\"customMeta\" data-dictid=\"e6cfda323816927771839cc83e376d\">bladder</span> control but does not specifically address bed-wetting at night.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What could be the diagnosis for a child who exhibits below-average mathematical skills despite having a normal IQ and age-appropriate learning abilities and remains unaffected by a year-long private mathematics tutoring?</p>",
    "choices": [
      {
        "id": 1,
        "text": "ADHD"
      },
      {
        "id": 2,
        "text": "Mathematics learning disorder"
      },
      {
        "id": 3,
        "text": "Aspergers syndrome"
      },
      {
        "id": 4,
        "text": "Specific learning disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Specific learning disorder</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The child described is likely experiencing a <strong>Specific Learning Disorder (SLD), </strong>specifically with <span class=\"customMeta\" data-dictid=\"4885d5d0021692777189aac6dc80f7\">impairment</span> in mathematics. This is a <span class=\"customMeta\" data-dictid=\"c5255750631692777193621e13317d\">neurodevelopmental</span> disorder characterised by persistent difficulties in learning and using academic skills despite normal intelligence, adequate educational opportunities, and appropriate interventions such as private tutoring.</li>\n</ul>\n\n<h4><strong>Features of SLD in Mathematics (Dyscalculia):</strong></h4>\n\n<ul>\n\t<li><strong>Mathematical Difficulties: </strong>Problems with basic arithmetic operations, understanding numbers, or applying mathematical concepts.</li>\n\t<li><strong>Persistence:</strong> The issues persist despite normal IQ and adequate learning in other areas.</li>\n\t<li><strong>Impact on Daily Life:</strong> The difficulties impair academic achievement and daily functioning.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>ADHD </strong><strong>(Option A)</strong> involves inattention, hyperactivity, or impulsivity affecting multiple domains, including academics. Poor math performance in ADHD stems from difficulty focusing, not from specific deficits in mathematical skills.</p>\n\n<p><strong>Mathematics Learning Disorder </strong><strong>(Option B):</strong> While this term describes the condition, it is not a standalone diagnosis in the DSM-5. <span class=\"customMeta\" data-dictid=\"c595789f491692777186fb2786bbca\">Dyscalculia</span> is a subtype of Specific Learning Disorder, making \"Specific Learning Disorder\" the correct and broader <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> term.</p>\n\n<p><strong>Asperger\u2019s Syndrome</strong><strong> (Option C)</strong><strong> </strong>(now classified under <span class=\"customMeta\" data-dictid=\"59f989084e16927771822f692979f5\">Autism</span> Spectrum Disorder in DSM-5) involves difficulties with social communication and restricted interests, not specific academic skills like mathematics. Children with Asperger\u2019s often excel academically, including in mathematics.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>The likely diagnosis for a girl who exhibits typical language milestones but primarily focuses on observing her own hands and lacks interaction with others is:</p>",
    "choices": [
      {
        "id": 1,
        "text": "ADHD"
      },
      {
        "id": 2,
        "text": "Autism"
      },
      {
        "id": 3,
        "text": "Asperger's syndrome"
      },
      {
        "id": 4,
        "text": "Rett's syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) Autism</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><strong>Autism Spectrum Disorder (ASD)</strong> is a <span class=\"customMeta\" data-dictid=\"c5255750631692777193621e13317d\">neurodevelopmental</span> condition characterised by:</p>\n\n<ul>\n\t<li><strong>Core Features</strong>:\n\n\t<ul>\n\t\t<li><strong>Impaired social communication</strong>: Difficulty in forming or understanding relationships, <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> social-emotional reciprocity, and challenges in non-verbal communication.</li>\n\t\t<li><strong>Restricted and repetitive behaviours</strong>: These include hand movements, insistence on sameness, fixated interests, or unusual <span class=\"customMeta\" data-dictid=\"408bcde7f01692777198acadb8e1c6\">sensory</span> responses.</li>\n\t</ul>\n\t</li>\n\t<li><strong>Language Development</strong>:\n\t<ul>\n\t\t<li>While some children with ASD exhibit language delays, others, particularly those previously categorised under <strong>Asperger's syndrome</strong> (now under ASD in DSM-5), meet typical language milestones but struggle with the social use of language.</li>\n\t</ul>\n\t</li>\n\t<li><strong>Behaviour Described in Question</strong>:\n\t<ul>\n\t\t<li>The <strong>focus on observing her own hands</strong> is a classic example of repetitive and self-stimulatory behaviour.</li>\n\t\t<li>The <strong>lack of social interaction</strong> fits the hallmark features of difficulty in social reciprocity and relationships seen in ASD.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>ADHD (Attention-Deficit/Hyperactivity Disorder) </strong><strong>(Option A)</strong> is a <span class=\"customMeta\" data-dictid=\"c5255750631692777193621e13317d\">neurodevelopmental</span> disorder characterised by difficulties with attention, impulsivity, and hyperactivity. Individuals with ADHD may display problems in social interactions and exhibit certain repetitive behaviours.</p>\n\n<p><strong>Asperger\u2019s syndrome </strong> <strong>(Option C)</strong><strong> </strong>Previously considered a separate diagnosis, it is now included under ASD in the DSM-5. Typically involves normal to advanced language development but significant social interaction difficulties. Lack of repetitive hand-focused behaviour makes this less likely than Autism.</p>\n\n<p><strong>Rett's Syndrome</strong> <strong>(Option D)</strong> is a rare genetic disorder that predominantly affects females. It is characterised by severe cognitive and physical impairments, loss of purposeful hand skills, and the development of repetitive hand movements.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>The parents of a 13-year-old boy have sought the assistance of a child psychiatrist due to their concerns. They have observed that the child frequently engages in dishonesty both at home and in school, displays disruptive behaviour towards his teacher, often intimidates younger children, and has been caught stealing money multiple times. What is the probable diagnosis for this child?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Oppositional defiant disorder"
      },
      {
        "id": 2,
        "text": "Conduct disorder"
      },
      {
        "id": 3,
        "text": "Antisocial personality disorder"
      },
      {
        "id": 4,
        "text": "Disruptive mood dysregulation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer B - Conduct disorder.</strong></p>\n\n<p><strong>Explanation</strong>:</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Disorder</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Oppositional Defiant Disorder (ODD)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Conduct Disorder</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>The persistent pattern of negativistic, defiant, disobedient, and hostile behaviour <strong>toward authority figures.</strong></p>\n\n\t\t\t<p><strong>(Option A ruled out)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>A persistent pattern of behaviour involving aggression, violating others' rights, and disregarding social norms.</p>\n\n\t\t\t<p><strong>(Option B)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Diagnostic Criteria (DSM-5)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Duration:</strong> \u22656 months.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Symptoms (\u22654):</strong></p>\n\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Losing temper.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Easily annoyed/sensitive.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Angry/resentful.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Argues with authority figures.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Refuses requests/rules.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Deliberately annoys others.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Blames others for their own mistakes/behaviors.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Spiteful/vindictive (at least 2x in 6 months).</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>No severely aggressive or <span class=\"customMeta\" data-dictid=\"c5d4ec0a2816927771858299a89c5e\">delinquent</span> behaviours.</p>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Duration</strong>: \u226512 months, with 1 symptom present in the last 6 months.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Symptoms (\u22653)</strong>:</p>\n\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Physical aggression or threats.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Destruction of property.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Deceitfulness or theft.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Harming animals.</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t<p>Violation of rules (e.g., truancy, running away).</p>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Types (DSM-5)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Angry/Irritable Mood:</strong> Frequent temper loss, persistent irritability.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Argumentative/Defiant Behavior:</strong> Argues, refuses to comply, blames others.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Vindictiveness:</strong> Spiteful/vindictive actions \u22652x in 6 months.</p>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Childhood-onset</strong>: Symptoms before age 10.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Adolescent-Onset</strong>: Symptoms after age 10.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Unspecified-Onset</strong>: Age of onset unknown</p>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Severity Specifiers</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Mild:</strong> Symptoms in 1 setting.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Moderate:</strong> Symptoms in 2 settings.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Severe:</strong> Symptoms in \u22653 settings.</p>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Mild</strong>: Few conduct problems, minor harm.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Moderate</strong>: Intermediate symptoms.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Severe</strong>: Many symptoms, significant harm caused.</p>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Treatment</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Family Interventions:</strong> Parent training in child management, reinforcing positive behaviour.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Cognitive Behavioral Therapy (CBT):</strong> Parents are taught to discourage the child's oppositional behaviour by not paying much attention to it.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Parenting Techniques:</strong> Focus on reducing harsh punishment and increasing positive interactions.</p>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Psychosocial Interventions</strong>: Early intervention, CBT, school-based programs.</p>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t<p><strong>Pharmacologic Interventions</strong>: Antipsychotics (risperidone, quetiapine), SSRIs for impulsivity/irritability, sodium valproate.</p>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><strong>Antisocial personality disorder</strong> <strong>(Option C)</strong> is diagnosed in adults (18 years and older), making it inappropriate to diagnose in a 13-year-old. While the child\u2019s behaviour may resemble ASPD, the diagnosis requires a history of symptoms extending into adulthood.</p>\n\n<p><strong>Disruptive mood dysregulation</strong> <strong>(Option D) </strong>primarily involves severe temper outbursts and a consistently <span class=\"customMeta\" data-dictid=\"31383b73d01692777190c6880a580b\">irritable</span> mood, not the <span class=\"customMeta\" data-dictid=\"6133b1827c16927771813719d533eb\">antisocial</span> behaviours observed here. The child\u2019s actions, such as stealing and bullying, suggest Conduct Disorder rather than mood regulation issues.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What could be the diagnosis for a child who exhibits below-average mathematical skills despite having a normal IQ and age-appropriate learning abilities and remains unaffected by a year-long private mathematics tutoring?</p>",
    "choices": [
      {
        "id": 1,
        "text": "ADHD"
      },
      {
        "id": 2,
        "text": "Mathematics learning disorder"
      },
      {
        "id": 3,
        "text": "Aspergers syndrome"
      },
      {
        "id": 4,
        "text": "Specific learning disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Option D -</strong><strong> Specific learning disorder</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The child described is likely experiencing a <strong>Specific Learning Disorder (SLD), </strong>specifically with <span class=\"customMeta\" data-dictid=\"4885d5d0021692777189aac6dc80f7\">impairment</span> in mathematics. This is a <span class=\"customMeta\" data-dictid=\"c5255750631692777193621e13317d\">neurodevelopmental</span> disorder characterised by persistent difficulties in learning and using academic skills despite normal intelligence, adequate educational opportunities, and appropriate interventions such as private tutoring.</p>\n\n<h4><strong>Features of SLD in Mathematics (Dyscalculia):</strong></h4>\n\n<ul>\n\t<li><strong>Mathematical Difficulties: </strong>Problems with basic arithmetic operations, understanding numbers, or applying mathematical concepts.</li>\n\t<li><strong>Persistence:</strong> The issues persist despite normal IQ and adequate learning in other areas.</li>\n\t<li><strong>Impact on Daily Life:</strong> The difficulties impair academic achievement and daily functioning.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>ADHD (Option A)</strong> involves inattention, hyperactivity, or impulsivity affecting multiple domains, including academics. Poor math performance in ADHD stems from difficulty focusing, not from specific deficits in mathematical skills.</p>\n\n<p><strong>Mathematics Learning Disorder (Option B):</strong> While this term describes the condition, it is not a standalone diagnosis in the DSM-5. Dyscalculia is a subtype of Specific Learning Disorder, making \"Specific Learning Disorder\" the correct and broader <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> term.</p>\n\n<p><strong>Asperger\u2019s Syndrome (Option C) </strong>(now classified under Autism Spectrum Disorder in DSM-5) involves difficulties with social communication and restricted interests, not specific academic skills like mathematics. Children with Asperger\u2019s often excel academically, including in mathematics.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A patient is showing <span class=\"marker\">stubbornness, rigidity and frugality</span>. In which stage we can see this kind of behaviour due to fixation according to <span class=\"marker\">psychosexual stages of development?</span></p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Anal"
      },
      {
        "id": 2,
        "text": "Oral"
      },
      {
        "id": 3,
        "text": "Phallic"
      },
      {
        "id": 4,
        "text": "Genital"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Option A- Anal:</strong></p>\n\n<ul>\n\t<li>In Sigmund Freud's <span class=\"customMeta\" data-dictid=\"1cce7e42041692777196353623dbc6\">psychosexual</span> stages of development, the <span class=\"customMeta\" data-dictid=\"93dc71d76516927771827e64c6c329\">anal stage</span> occurs typically around ages 1 to 3 years. During this stage, the child's focus of pleasure and development centers on the anal region. The main conflict of this stage is related to toilet training and the child's ability to control their <span class=\"customMeta\" data-dictid=\"37863e7aec169277718310f33c6a11\">bowel</span> movements. The child learns to gain satisfaction from retaining and expelling feces.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option B - Oral Stage: </strong>The <span class=\"customMeta\" data-dictid=\"742f677c1c16927771941cebaebc8c\">oral stage</span> occurs during <span class=\"customMeta\" data-dictid=\"663d16ec8e169277719095f74c9816\">infancy</span> (birth to around 1 year old). Pleasure centers on the mouth and the activities related to it, such as sucking and feeding. <span class=\"customMeta\" data-dictid=\"71fd4297541692777202797b7596b9\">Fixation</span> during this stage might result in behaviors like smoking, overeating, or a <span class=\"customMeta\" data-dictid=\"4fe4b79dde16927771866f60a939e2\">dependency</span> on oral <span class=\"customMeta\" data-dictid=\"7f3792072b1692777199fd8e2c4f59\">stimulation</span> for comfort.</p>\n\n<p><strong>Option C - <span class=\"customMeta\" data-dictid=\"09ef87ebe616927771954f28ce7177\">Phallic</span> Stage: </strong>The <span class=\"customMeta\" data-dictid=\"09ef87ebe616927771954f28ce7177\">phallic</span> stage emerges around ages 3 to 6 years. During this stage, children become aware of their own gender and develop feelings of attraction towards the opposite-sex parent and <span class=\"customMeta\" data-dictid=\"b4d159a1d3169277719753d37f7aca\">rivalry</span> with the same-sex parent (Oedipus and Electra complexes). <span class=\"customMeta\" data-dictid=\"71fd4297541692777202797b7596b9\">Fixation</span> during this stage might lead to challenges in forming healthy relationships and issues related to <span class=\"customMeta\" data-dictid=\"ef4efed5d61692777188f931d3254e\">gender identity</span> and self-esteem.</p>\n\n<p><strong>Option D - <span class=\"customMeta\" data-dictid=\"0e919a208b16927771885d9c1f6662\">Genital</span> Stage: </strong>The <span class=\"customMeta\" data-dictid=\"0e919a208b16927771885d9c1f6662\">genital</span> stage occurs from <span class=\"customMeta\" data-dictid=\"c284c4252f16927771963c07a95e13\">puberty</span> onwards. This stage is characterized by the <span class=\"customMeta\" data-dictid=\"0472620c171692777192c655af9c57\">mature</span> development of sexual interests and the establishment of healthy intimate relationships. <span class=\"customMeta\" data-dictid=\"71fd4297541692777202797b7596b9\">Fixation</span> during this stage might lead to difficulties in forming lasting relationships and a lack of fulfillment in adult sexual relationships.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the term used to <span class=\"marker\">describe the phenomenon</span> where a patient in the ward responds to the question<span class=\"marker\"> \"what is your name?\" by repeating the same sentence</span>?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Coprolalia"
      },
      {
        "id": 2,
        "text": "Echopraxia"
      },
      {
        "id": 3,
        "text": "Copropraxia"
      },
      {
        "id": 4,
        "text": "Echolalia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Option D -\u00a0Echolalia:\u00a0</strong></p>\n\n<ul>\n\t<li>Echolalia is a language and speech disorder characterized by the <span class=\"customMeta\" data-dictid=\"42b110efe11692777190ea5720c867\">involuntary</span> repetition of words or phrases spoken by others. This can occur immediately after hearing the words or at a later time. Sometimes, the individual may repeat words or phrases they have heard on television or in their environment. In the given scenario, the patient is seen to repeat the question asked to him involuntarily.\u00a0</li>\n\t<li>\n\t<p>It is often associated with <span class=\"customMeta\" data-dictid=\"59f989084e16927771822f692979f5\">autism</span> spectrum disorder, but can also occur in other neurological conditions such as dementia, schizophrenia, and <span class=\"customMeta\" data-dictid=\"18034e0517169277720002aaa66d36\">traumatic</span> brain injury.</p>\n\t</li>\n</ul>\n\n<p><strong>Incorrect Options:\u00a0</strong></p>\n\n<p><strong>Option A -\u00a0Coprolalia: </strong>Coprolalia is a symptom of Tourette\u2019s syndrome, where the person involuntarily utters socially inappropriate words or phrases.</p>\n\n<p><strong>Option B -</strong>\u00a0<strong>Echopraxia:</strong> <span class=\"customMeta\" data-dictid=\"12f7ccacb21692777186ad7bbad4a3\">Echopraxia</span> is a phenomenon where a person imitates the movements of another person without any apparent purpose.</p>\n\n<p><strong>Option C -\u00a0Copropraxia: </strong>Copropraxia is a symptom of Tourette\u2019s syndrome, where the person involuntarily makes obscene gestures or movements.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>According to the revision of <span class=\"marker\">DSM-5</span> by the<span class=\"marker\"> American Psychiatric Association,</span> what is the current term used to refer to '<span class=\"marker\">mental retardation</span>'?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Feeble mindedness"
      },
      {
        "id": 2,
        "text": "Mental subnormality"
      },
      {
        "id": 3,
        "text": "Intellectual disability"
      },
      {
        "id": 4,
        "text": "Intellectually challenged"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Option C - Intellectual disability:</strong></p>\n\n<ul>\n\t<li>The correct option for what \"mental retardation\" is now called according to the American Psychiatric Association in its revision of DSM-5 is <strong>\"Intellectual disability.\"</strong></li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A - Feeble-mindedness:</strong>\u00a0Feeble-mindedness was a term used in the past to describe individuals with intellectual disabilities. However, this term is outdated and is no longer used in professional <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> criteria.</p>\n\n<p><strong>Option B - Mental subnormality:</strong>\u00a0Mental <span class=\"customMeta\" data-dictid=\"45f9802bfb169277719952075a2ae2\">subnormality</span> is another outdated term that was previously used to describe individuals with intellectual disabilities. It is no longer used in current <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> criteria.</p>\n\n<p><strong>Option D - Intellectually challenged:</strong>\u00a0This term is not used in professional <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> criteria.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which disorder was previously known as <span class=\"marker\">Minimal brain dysfunction</span>?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Dyslexia"
      },
      {
        "id": 2,
        "text": "Attention deficit/hyperactivity disorder"
      },
      {
        "id": 3,
        "text": "Mental subnormality"
      },
      {
        "id": 4,
        "text": "Oligophrenia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option B - Attention deficit/hyperactivity disorder:</strong></p>\n\n<ul>\n\t<li>The disorder that was earlier known as \"minimal brain dysfunction\" is <strong>Attention deficit/hyperactivity disorder (ADHD).</strong></li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A - Dyslexia:</strong>\u00a0Dyslexia refers to a specific learning disorder that primarily affects a person's ability to read, write, and spell. It is characterized by difficulties with accurate or <span class=\"customMeta\" data-dictid=\"1ea569c7fa16927772020c6e8eabc1\">fluent</span> word recognition and poor spelling and decoding abilities. .</p>\n\n<p><strong>Option C - Mental subnormality:</strong>\u00a0Mental <span class=\"customMeta\" data-dictid=\"45f9802bfb169277719952075a2ae2\">subnormality</span> is an outdated term that was previously used to describe what is now known as intellectual disability. <span class=\"customMeta\" data-dictid=\"6b9286cde51692777190fded98b3e5\">Intellectual disability</span> refers to significantly below-average intellectual <span class=\"customMeta\" data-dictid=\"bf1b7e7049169277720354c306d716\">functioning</span> and limitations in adaptive behavior, which manifest during the developmental period.</p>\n\n<p><strong>Option D - Oligophrenia:\u00a0</strong>Oligophrenia is another outdated term that was used to describe what is now known as intellectual disability. It refers to a condition characterized by significantly below-average intellectual <span class=\"customMeta\" data-dictid=\"bf1b7e7049169277720354c306d716\">functioning</span> and limitations in adaptive behavior.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  }
];
        let quizName = '12 Previous Year Questions';
        const quizFilename = '12-previous-year-questions-b8d2d06a.html';
        let hierarchy = ["PrepLadder", "qBank", "Psychiatry"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>