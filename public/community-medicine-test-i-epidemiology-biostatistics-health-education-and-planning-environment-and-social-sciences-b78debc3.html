<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Medicine Test I (Epidemiology, Biostatistics, Health Education And Planning, Environment And Social Sciences) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2018 - 19
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following uses population as the unit of study?",
    "choices": [
      {
        "id": 1,
        "text": "Cross sectional study"
      },
      {
        "id": 2,
        "text": "Case control study"
      },
      {
        "id": 3,
        "text": "Cohort study"
      },
      {
        "id": 4,
        "text": "Ecological study"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Ecological study</strong> uses <strong>population as the unit of study.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0197b41b27fe49e49dc20d7f13e1d029x974x435.PNG"
    ]
  },
  {
    "text": "Statistical power of a test is equal to ______",
    "choices": [
      {
        "id": 1,
        "text": "1 + \u03b1"
      },
      {
        "id": 2,
        "text": "1 + \u03b2"
      },
      {
        "id": 3,
        "text": "1 \u2013 \u03b1"
      },
      {
        "id": 4,
        "text": "1 \u2013 \u03b2"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The power of a trial is represented by <strong>1 &ndash; &beta; where &beta; is type II error or false negative error.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The standard illumination recommended for casual reading is _______ lux",
    "choices": [
      {
        "id": 1,
        "text": "90"
      },
      {
        "id": 2,
        "text": "100"
      },
      {
        "id": 3,
        "text": "120"
      },
      {
        "id": 4,
        "text": "400"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The standard <strong>illumination for casual reading</strong> is <strong>100 lux</strong>.</p>\n<p><strong class=\"ng-binding\">Lighting Standards</strong></p>\n<div class=\"panel-body ng-scope\">\n<p>The following standards have been recommended by the&nbsp;<strong>Illuminating Engineer Society.</strong></p>\n<table>\n<tbody>\n<tr>\n<td><strong>Visual Task</strong></td>\n<td><strong>Illumination in lux</strong></td>\n</tr>\n<tr>\n<td><strong>Casual reading</strong></td>\n<td>100</td>\n</tr>\n<tr>\n<td><strong>General office work</strong></td>\n<td>400</td>\n</tr>\n<tr>\n<td><strong>Fine assembly</strong></td>\n<td>900</td>\n</tr>\n<tr>\n<td><strong>Very severe tasks</strong></td>\n<td>1300 &ndash; 2000</td>\n</tr>\n<tr>\n<td><strong>Watch making</strong></td>\n<td>2000 &ndash; 3000</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Sequence of activities designed to implement policies and accomplish objectives is called",
    "choices": [
      {
        "id": 1,
        "text": "Procedure"
      },
      {
        "id": 2,
        "text": "Plan"
      },
      {
        "id": 3,
        "text": "Programme"
      },
      {
        "id": 4,
        "text": "Schedule"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A <strong>programme</strong> is a <strong>sequence of activities</strong> designed to implement policies and accomplish objectives.</p>\n<p><strong>Option a:</strong> <strong>Procedures </strong>are a set of rules for carrying out the work which helps to ensure maximum use of the resources and efforts.</p>\n<p><strong>Option b: A</strong> <strong>plan </strong>is a <strong>blueprint</strong> for taking action.</p>\n<p><strong>Option d:</strong> A <strong>schedule</strong> is a time sequence for the work to be done.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "False about a standard normal distribution curve is",
    "choices": [
      {
        "id": 1,
        "text": "Mean =  0"
      },
      {
        "id": 2,
        "text": "Standard deviation = 1"
      },
      {
        "id": 3,
        "text": "Mean = median"
      },
      {
        "id": 4,
        "text": "Variance = 0"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In a normal distribution curve, variance is 1.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Denominator used for calculating incidence is",
    "choices": [
      {
        "id": 1,
        "text": "Midyear population"
      },
      {
        "id": 2,
        "text": "Population at risk"
      },
      {
        "id": 3,
        "text": "Total number of deaths"
      },
      {
        "id": 4,
        "text": "Total number of cases"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Population at risk is the denominator for calculating incidence.</strong></p>\n<p>Incidence is defined as &ldquo;the <strong>number of</strong> <strong>NEW cases occuring in a defined population during a specified period of time</strong>.&rdquo;</p>\n<p>It is given by the formula:</p>\n<p>Incident Rate = Number of NEW cases of specific disease during given Time period / Population at risk during given Time period</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What would be the degree of freedom if a contingency table had 8 rows and 6 columns?",
    "choices": [
      {
        "id": 1,
        "text": "48"
      },
      {
        "id": 2,
        "text": "63"
      },
      {
        "id": 3,
        "text": "35"
      },
      {
        "id": 4,
        "text": "53"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>In a <strong>contingency table,</strong> the <strong>degrees of freedom (df) = (r-1) (c-1)</strong>, where <strong>r is the number of rows</strong> and <strong>c is the number of columns</strong>.</li>\n<li>The above contingency table has <strong>8 rows and 6 columns</strong>.</li>\n<li>In this scenario, df = (8 &ndash; 1) (6 &ndash; 1) = <strong>7*5 = 35.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a rural housing standard in India?",
    "choices": [
      {
        "id": 1,
        "text": "Built-up area should not exceed 1/3rd of total area"
      },
      {
        "id": 2,
        "text": "Window area 20% of floor area"
      },
      {
        "id": 3,
        "text": "Cattle sheds must be 25 feet away from the house"
      },
      {
        "id": 4,
        "text": "At least two living rooms"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Window area should be 10% of floor area.</p>\n<p><strong>Rural housing </strong>standards are:</p>\n<ul>\n<li>At least <strong>two living rooms</strong></li>\n<li>Ample <strong>verandah space</strong></li>\n<li>Separate <strong>kitchen </strong>with space for washing utensils</li>\n<li><strong>Built-up area should not exceed 1/3<sup>rd</sup> of total area</strong></li>\n<li>Sanitary <strong>latrine</strong></li>\n<li><strong>Window area should be 10% of floor area</strong></li>\n<li><strong>Sanitary well</strong> or tube well within quarter mile of house</li>\n<li><strong>Cattle sheds </strong>must be <strong>25 feet away from the house</strong></li>\n<li>Adequate arrangements for disposal of waste water and garbage</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "False statement is",
    "choices": [
      {
        "id": 1,
        "text": "Disinfecting action of chlorine is mainly due to hypochlorous acid"
      },
      {
        "id": 2,
        "text": "Horrock\u2019s apparatus is used to estimate chlorine demand"
      },
      {
        "id": 3,
        "text": "Bleaching powder contains 0.33% chlorine"
      },
      {
        "id": 4,
        "text": "Orthotolidine arsenite test measures free and combined chlorine separately"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Bleaching powder</strong> contains <strong>33% available chlorine.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the breeding habits of given mosquitoes\nA.\tAnopheles\tI.\tDirty water\nB.\tAedes\tII. Clean water\nC.\tCulex\tIII. Aquatic vegetation\nD.\tMansonia\tIV. Artificial collection of water",
    "choices": [
      {
        "id": 1,
        "text": "A-I, B-II, C-III, D-IV"
      },
      {
        "id": 2,
        "text": "A-IV, B-I, C-III, D- II"
      },
      {
        "id": 3,
        "text": "A-III, B-II, C-IV, D-I"
      },
      {
        "id": 4,
        "text": "A-II, B-IV, C-I, D-III"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Breeding habits of mosquitoes:</strong></p>\n<p>&nbsp;</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Mosquito</strong></td>\n<td><strong>Breeding habit</strong></td>\n</tr>\n<tr>\n<td>Anopheles</td>\n<td>Clean water</td>\n</tr>\n<tr>\n<td>Culex</td>\n<td>Dirty, polluted water</td>\n</tr>\n<tr>\n<td>Aedes</td>\n<td>Artificial collection of water</td>\n</tr>\n<tr>\n<td>Mansonia</td>\n<td>Aquatic vegetation</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a model of health education?",
    "choices": [
      {
        "id": 1,
        "text": "Medical model"
      },
      {
        "id": 2,
        "text": "Socio-environmental model"
      },
      {
        "id": 3,
        "text": "Service model"
      },
      {
        "id": 4,
        "text": "Motivation model"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Three <strong>models </strong>of health education:</p>\n<ul>\n<li>Medical model: Transfer of proven medical information into education</li>\n<li>Motivational model: Awareness &rarr; Motivation &rarr; Action or <strong>Internalization</strong></li>\n<li>Social intervention model: Changing of a social environment</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "False statement about the type of epidemic represented in below given image is",
    "choices": [
      {
        "id": 1,
        "text": "No secondary waves"
      },
      {
        "id": 2,
        "text": "Clustering of cases within a short period of time"
      },
      {
        "id": 3,
        "text": "Only due to an infectious agent"
      },
      {
        "id": 4,
        "text": "All cases usually develop within one incubation period"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Image shows <strong>point source epidemic.</strong></p>\n<ul>\n<li>Point source epidemics are also called <strong>single exposure</strong> epidemics and belong to the <strong>common source</strong> type of epidemics.</li>\n<li>The exposure to disease agent is brief and all cases develop within <strong>one incubation period.</strong></li>\n<li>In the epidemic curve, there is a sharp <strong>rise and fall</strong> as all cases are clustered within one incubation period and there are <strong>no secondary waves.</strong></li>\n<li>Infectious agents, environmental pollution and contamination of food are common causes of point epidemics.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8e641b27056b489bbedae667cccb3a3f.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "In a bimodal series, if the mean is 4 and median is 7, what is the mode?",
    "choices": [
      {
        "id": 1,
        "text": "15"
      },
      {
        "id": 2,
        "text": "13"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "11"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>The relationship between mode, median and mean in asymmetrical distributions can be given as <strong>Mode = 3 median &ndash; 2 mean.</strong></li>\n<li>In this scenario, <strong>mode</strong> = (3x7) &ndash; (2x4) = 21 &ndash; 8 = <strong>13</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Kuppuswamy scale considers all except",
    "choices": [
      {
        "id": 1,
        "text": "Income"
      },
      {
        "id": 2,
        "text": "Housing"
      },
      {
        "id": 3,
        "text": "Occupation"
      },
      {
        "id": 4,
        "text": "Education"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The Kuppuswamy scale doesn\u2019t include housing.</p>\n<p>The Kuppuswamy scale was designed to classify the socio-economic status in\u00a0<strong>urban </strong>and<strong> peri-urban </strong>areas.</p>\n<p>It was devised in\u00a0<strong>1976</strong>\u00a0by\u00a0<strong>Kuppuswamy\u00a0</strong>and was later\u00a0<strong>modified</strong>\u00a0to be called the Modified Kuppuswamy Scale.</p>\n<p>This scale uses the following components:</p>\n<ul>\n<li><strong>Education of head\u00a0</strong>of the family</li>\n<li><strong>Occupation of the head of the family</strong></li>\n<li><strong>Monthly income</strong>\u00a0of the family</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false about group discussion?",
    "choices": [
      {
        "id": 1,
        "text": "It usually consists of 6 to 12 people"
      },
      {
        "id": 2,
        "text": "It can bring about change in attitude of the participants"
      },
      {
        "id": 3,
        "text": "None of the above"
      },
      {
        "id": 4,
        "text": "There is no leader"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In a<strong> group discussion</strong>, 6-12\u00a0people with<strong> a group leader</strong> interact with each other in a <strong>face-to-face </strong>manner. Hence, option D is a false statement.</p>\n<ul>\n<li><strong>Exchange</strong> of ideas, knowledge, and opinions is done by participants which <strong>influence </strong>a<strong> change</strong> in their <strong>attitudes.</strong></li>\n<li>It usually involves <strong>6\u201312 people</strong> with a <strong>group leader</strong> who guides the conversation giving equal opportunity to everyone to voice themselves.</li>\n<li>In a group discussion, everyone must speak and be open to criticism without interruption.</li>\n<li>If the <strong>group discussion</strong> goes well, it can help in arriving at<strong> finding solutions</strong> that would have not been possible to find for a <strong>single person</strong>.</li>\n<li>Limitation \u2013 not everyone is open to speaking in public and the possibility of <strong>diversion</strong> of the topic of discussion is high when many people are involved.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Forest plots are used to plot the results of ______",
    "choices": [
      {
        "id": 1,
        "text": "Randomized controlled trials"
      },
      {
        "id": 2,
        "text": "Health education sessions"
      },
      {
        "id": 3,
        "text": "Meta-analyses"
      },
      {
        "id": 4,
        "text": "Vaccination programmes"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A <strong>forest plot</strong> is used for plotting the results of a <strong>meta-analysis.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Pyrethrum, an insecticide, acts as a?",
    "choices": [
      {
        "id": 1,
        "text": "Nerve poison"
      },
      {
        "id": 2,
        "text": "Stomach poison"
      },
      {
        "id": 3,
        "text": "Contact poison"
      },
      {
        "id": 4,
        "text": "Both a & c"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>The Insecticide Pyrethrum</strong>\u00a0is a <strong>contact, nerve</strong> poison.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Exposure to sound with a minimum level of _______ dB can lead to rupture of tympanic membrane, resulting in hearing loss",
    "choices": [
      {
        "id": 1,
        "text": "90"
      },
      {
        "id": 2,
        "text": "110"
      },
      {
        "id": 3,
        "text": "160"
      },
      {
        "id": 4,
        "text": "75"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Exposure to sound with a minimum level of <strong>160 dB</strong> can lead to <strong>rupture of tympanic membrane</strong>, resulting in hearing loss.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following variables is measured on the nominal scale?",
    "choices": [
      {
        "id": 1,
        "text": "A, B, O blood groups"
      },
      {
        "id": 2,
        "text": "Glasgow coma scale"
      },
      {
        "id": 3,
        "text": "Intelligence quotient"
      },
      {
        "id": 4,
        "text": "Respiratory rate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Among the given options, the <strong>A, B, O blood groups</strong> can be measured on a<strong> nominal</strong> scale.</p>\n<p>Data will always fall into one of the following four scales:</p>\n<ul>\n<li>Nominal</li>\n<li>Ordinal</li>\n<li>Interval</li>\n<li>Ratio</li>\n</ul>\n<p><strong>Nominal scale data</strong> can be divided into <strong>qualitative</strong> categories or groups. Examples include <strong>male/female</strong>, black/white, or red/green. No order or ratio from the data is implied. Nominal data that falls exclusively into two groups is known as <strong>dichotomous data</strong>. A, B, O blood groups can be clearly divided into qualitative groups and hence can be measured on a nominal scale.</p>\n<p><strong>Ordinal scale data</strong> holds meaning when it is placed in a <strong>particular order</strong>. An example is the ranking of students in a class. But, there is no information about the interval size. This means that the difference between the marks of the first and second students may or may not be the same as the difference between the second and third. An example is the <strong>Glasgow coma scale\u00a0</strong>and <strong>Child-Pugh score</strong>.</p>\n<p><strong>Interval scale data</strong> is similar to ordinal data because it can be placed in a meaningful order. Additionally, they have meaningful <strong>intervals</strong> between the items, usually <strong>measurable quantities</strong>. For example, the difference between 100\u00b0 and 90\u00b0 is the same as that between 50\u00b0 and 40\u00b0 on the temperature scale. But these scales do not have absolute zeroes, which makes ratios between the items meaningless.\u00a0</p>\n<p><strong>Ratio scale data</strong> have similar properties to interval scale data. In addition, they have an <strong>absolute zero</strong>. Most biomedical variables can be measured on a ratio scale. Examples are weight in pounds or grams, pulse rate in beats/minute, and blood pressure in millimeters of mercury. A pulse rate of 0 indicates a lack of pulse, and a rate of 120/minute is twice as fast as a rate of 60/minute.\u00a0This means it is possible to calculate <strong>meaningful ratios</strong>.\u00a0</p>\n<p>Other options:</p>\n<p>Option B: Glasgow coma scale can be measured on the <strong>ordinal</strong> scale.</p>\n<p>Option C: Intelligence quotient\u00a0can be measured on the <strong>interval</strong>\u00a0scale.</p>\n<p>Option D: Respiratory rate<strong>\u00a0</strong>can be measured with the <strong>ratio</strong> scale.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "At which level of heat stress index is a threat to health posed with work being impaired?",
    "choices": [
      {
        "id": 1,
        "text": "20 \u2013 40"
      },
      {
        "id": 2,
        "text": "40 \u2013 60"
      },
      {
        "id": 3,
        "text": "60 \u2013 80"
      },
      {
        "id": 4,
        "text": "80 \u2013 100"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A <strong>heat stress index of 40 &ndash; 60</strong> indicates <strong>severe heat strain</strong> and it can pose a threat to health. Work is greatly impaired if not fit or acclimatized.</p>\n<p><strong class=\"ng-binding\">Heat Stress:</strong></p>\n<div class=\"panel-body ng-scope\">\n<ul>\n<li><strong>Heat stress&nbsp;</strong>is the&nbsp;<strong>load of heat&nbsp;</strong>that must be&nbsp;<strong>dissipated from the body&nbsp;</strong>if it is to remain in thermal equilibrium.</li>\n<li><strong>Factors</strong>&nbsp;which&nbsp;<strong>affect heat stress&nbsp;</strong>are&nbsp;<strong>metabolic rate, air temperature, humidity, air movement</strong>&nbsp;and&nbsp;<strong>radiant temperature</strong>.</li>\n<li>Heat stress&nbsp;<strong>indices</strong>:\n<ul>\n<li><strong>Equatorial comfort index</strong></li>\n<li><strong>Heat stress index (HSI)</strong>&nbsp;&ndash; Values of HIS are as given below</li>\n</ul>\n</li>\n</ul>\n<table>\n<tbody>\n<tr>\n<td><strong>HSI</strong></td>\n<td><strong>Thermal stress</strong></td>\n<td><strong>Work and effects</strong></td>\n</tr>\n<tr>\n<td>0</td>\n<td>No thermal strain</td>\n<td>No work impairment</td>\n</tr>\n<tr>\n<td>10 &ndash; 30</td>\n<td>Moderate to mild heat strain</td>\n<td>Minimal work impairment</td>\n</tr>\n<tr>\n<td>40 &ndash; 60</td>\n<td>Severe heat strain</td>\n<td>Threat to health and greatly impaired work</td>\n</tr>\n<tr>\n<td>70 &ndash; 90</td>\n<td>Very severe heat strain</td>\n<td>Only few who are fit and acclimatized can sustain work</td>\n</tr>\n<tr>\n<td>100</td>\n<td>Upper limit of heat tolerance</td>\n<td>Only fit and acclimatized can sustain work, although with impairment</td>\n</tr>\n<tr>\n<td>&gt;100</td>\n<td>Exceeds tolerable limits</td>\n<td>Varying degrees of heat stress and effects can pursue</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong>Predicted four-hour sweat rate (P<sub>4</sub>SR)</strong>\n<ul>\n<li><strong>Effects</strong>&nbsp;of heat stress include heat<strong>&nbsp;stroke</strong>, heat<strong>&nbsp;hyperpyrexia</strong>, heat&nbsp;<strong>exhaustion</strong>, heat&nbsp;<strong>cramps,</strong>&nbsp;and heat&nbsp;<strong>syncope</strong></li>\n</ul>\n</li>\n</ul>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "False statement about the type of study depicted in below given image is:",
    "choices": [
      {
        "id": 1,
        "text": "No attrition"
      },
      {
        "id": 2,
        "text": "Suitable for rare diseases"
      },
      {
        "id": 3,
        "text": "Incidence can be calculated"
      },
      {
        "id": 4,
        "text": "Less time consuming"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Incidence cannot be calculated from case control studies and can be done from <strong>longitudinal studies.</strong></p>\n<p><strong>Option a: Attrition refers to loss of follow up. Since this is a backward looking study i.e. proceeds from effect to cause, follow up is not done and hence attrition is absent.</strong></p>\n<p><strong>Option b: Case control study is suitable for rare diseases.</strong></p>\n<p><strong>Option d: It is less time consuming since long term follow up is not needed.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/070a02c72f2144d2a289dafa917bc8ad.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following type of representation of data is used for what kind of variables?",
    "choices": [
      {
        "id": 1,
        "text": "Nominal"
      },
      {
        "id": 2,
        "text": "Discrete"
      },
      {
        "id": 3,
        "text": "Continuous"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image given above shows a<strong> histogram </strong>that is used to represent <strong>frequency distributions</strong> of <strong>continuous quantitative data.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/74a812aeb0d54c91b979ffdc983ab386.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a method for management based on behavioral sciences?",
    "choices": [
      {
        "id": 1,
        "text": "Communication"
      },
      {
        "id": 2,
        "text": "Decision making"
      },
      {
        "id": 3,
        "text": "Organizational design"
      },
      {
        "id": 4,
        "text": "Information systems"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Decision making is a quantitative</strong> method of management.</p>\n<p><strong class=\"ng-binding\">Management Methods in Health Programmes:</strong></p>\n<div class=\"panel-body ng-scope\">\n<table width=\"564\">\n<tbody>\n<tr>\n<td width=\"210\">\n<p><strong>Methods based on behavioral sciences</strong></p>\n</td>\n<td width=\"354\">\n<p><strong>Quantitative methods</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"210\">\n<p>Organisational design</p>\n<p>Personnel management</p>\n<p>Communication</p>\n<p>Information systems</p>\n<p>Management by objectives(MBO)</p>\n</td>\n<td width=\"354\">\n<p>Cost\u2013Benefit analysis</p>\n<p>Cost-Effective analysis</p>\n<p>Cost\u2013Accounting</p>\n<p>Input\u2013Output analysis</p>\n<p>Model</p>\n<p>Systems analysis</p>\n<p>Network analysis- Includes Programme Evaluation and Review Technique(PERT) and Critical Path Method(CPM)</p>\n<p>Planning\u2013Programming\u2013Budgeting System (PPBS)</p>\n<p>Work sampling</p>\n<p>Decision making</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Definition of population attributable risk is",
    "choices": [
      {
        "id": 1,
        "text": "Extent to which disease can be attributed to risk factor under study"
      },
      {
        "id": 2,
        "text": "Estimate of amount of disease that can be reduced if risk factor is modified or eliminated"
      },
      {
        "id": 3,
        "text": "Risk of disease among exposed as compared to non exposed"
      },
      {
        "id": 4,
        "text": "Difference in risk of exposed and non exposed groups"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>An <strong>estimate of the amount by which the disease could be reduced in that population if the suspected factor was eliminated or modified</strong> is given by <strong>population attributable risk.</strong></p>\n<p>It is defined as <strong>incidence of the disease (or death) in the total population minus the incidence of disease (or death) among those who were not exposed to the suspected causal factor.</strong></p>\n<p><strong>Option a: Attributable risk</strong> indicates to <strong>what extent the disease under study can be attributed to the exposure.</strong></p>\n<p>Attributable risk (AR) is the difference in incidence rates of disease (or death) between an exposed group and nonexposed group.</p>\n<p>Attributable risk= (Incidence among exposed-incidence among non exposed)/(Incidence among exposed) &times; 100</p>\n<p><strong>Option c: Relative risk (RR)</strong> is the <strong>ratio of the incidence of the disease (or death) among exposed and the incidence among non-exposed</strong>. It is a <strong>direct measure (or index) of the \"strength\" of the association between suspected cause and effect.</strong></p>\n<p>Relative risk= (Incidence among exposed)/(Incidence among non exposed)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Temporary hardness of water is primarily due to presence of",
    "choices": [
      {
        "id": 1,
        "text": "Calcium and magnesium sulphates"
      },
      {
        "id": 2,
        "text": "Calcium and magnesium chlorides"
      },
      {
        "id": 3,
        "text": "Calcium and magnesium carbonates"
      },
      {
        "id": 4,
        "text": "Calcium and magnesium bicarbonates"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Temporary hardness</strong> of water is primarily due to the presence of <strong>calcium and magnesium bicarbonates</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a population of 6000, new cases of TB are 500, and old cases are 150. What is the prevalence of TB in this case?",
    "choices": [
      {
        "id": 1,
        "text": "12%"
      },
      {
        "id": 2,
        "text": "13%"
      },
      {
        "id": 3,
        "text": "18%"
      },
      {
        "id": 4,
        "text": "11%"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In this scenario, old and new cases must be taken together as 650 total cases, thus making the prevalence of TB at 11%.</p>\n<p>Prevalence =\u00a0(Number of all cases of a specified disease at a given point in time/Estimated population at the same point in time) x 100</p>\n<ul>\n<li>New cases of TB = 500</li>\n<li>Old cases of TB = 150</li>\n<li>Total population at that time = 6000</li>\n</ul>\n<p>Hence,</p>\n<ul>\n<li>Prevalence = (500+150) /6000 x 100 = 10.83%\u00a0\u21d2 11%</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Social psychology is",
    "choices": [
      {
        "id": 1,
        "text": "Human relationships and behaviour"
      },
      {
        "id": 2,
        "text": "Psychology of individuals in society"
      },
      {
        "id": 3,
        "text": "Cultural history of man"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Social psychology</strong> is defined as <strong>&ldquo;the science of behaviour of individual in the society.&rdquo;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Disease not transmitted by mosquito shown in below given image is",
    "choices": [
      {
        "id": 1,
        "text": "Dengue"
      },
      {
        "id": 2,
        "text": "Chikungunya"
      },
      {
        "id": 3,
        "text": "West Nile fever"
      },
      {
        "id": 4,
        "text": "Rift valley fever"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Image shows <strong>Aedes aegypti mosquito/tiger mosquito/black mosquito</strong> <strong>&ndash; black body with white stripes, wings are unspotted.</strong></p>\n<p>It acts as a vector for transmission of <strong>dengue, chikungunya, rift valley fever.</strong></p>\n<p><strong>West Nile fever&nbsp;&amp; Filariasis</strong>&nbsp;is transmitted by <strong>culex mosquito.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1776ca6ab4104850972daa89124c19e0.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Single blind study means",
    "choices": [
      {
        "id": 1,
        "text": "Observer is blind about study"
      },
      {
        "id": 2,
        "text": "Participant is blind about study"
      },
      {
        "id": 3,
        "text": "Interpreter or analyzer is blind about study"
      },
      {
        "id": 4,
        "text": "Only person being observed is aware of study"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In <strong>single blind trial</strong>, the trial is so planned that the <strong>participant is not aware whether he belongs to the study group or control group.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "False statement is",
    "choices": [
      {
        "id": 1,
        "text": "RCT is the best study design to prove causation"
      },
      {
        "id": 2,
        "text": "Cross sectional study is the weakest study design to prove cause effect relationship."
      },
      {
        "id": 3,
        "text": "Matching is done to ensure that suspected aetiological factor or the variable we wish to measure is matched"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li><strong>Matching</strong> is defined as the process by which we select controls in such a way that they are similar to cases with regard to certain pertinent selected variables (e.g., age) which are known to influence the outcome of disease and which, if not adequately matched for comparability, could distort or confound the results.</li>\n<li>While matching it should be borne in mind that the <strong>suspected aetiological factor or the variable we wish to measure should not be matched</strong>, because by matching, its aetiological role is eliminated in that study.</li>\n<li>The <strong>cases and controls will then become automatically alike</strong> with respect to that factor.</li>\n</ul>\n<p><strong>RCT is the best</strong> study design to prove causation (option a) and <strong>Cross sectional&nbsp;study is the weakest</strong> study design to prove cause effect relationship.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an example of cyclo-propagative transmission of disease",
    "choices": [
      {
        "id": 1,
        "text": "Plague bacilli in rat fleas"
      },
      {
        "id": 2,
        "text": "Malarial parasite in mosquitoes"
      },
      {
        "id": 3,
        "text": "Microfilaria in mosquitoes"
      },
      {
        "id": 4,
        "text": "Both b & c"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Malaria</strong> is an example of <strong>cyclo-propagative transmission</strong> because it <strong>undergoes both developmental changes and multiplication in mosquitoes.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Process of \u201cComplete extension\u201d in a family cycle refers to time period between",
    "choices": [
      {
        "id": 1,
        "text": "Marriage and birth of first child"
      },
      {
        "id": 2,
        "text": "Birth of first child and birth of last child"
      },
      {
        "id": 3,
        "text": "Birth of last child and first child leaving home"
      },
      {
        "id": 4,
        "text": "First child leaving home and last child leaving parental home"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Complete extension</strong> in family cycle refers to <strong>time period between birth of last child and first child leaving home.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a measure of position?",
    "choices": [
      {
        "id": 1,
        "text": "Median"
      },
      {
        "id": 2,
        "text": "Standard deviation"
      },
      {
        "id": 3,
        "text": "Percentiles"
      },
      {
        "id": 4,
        "text": "Range"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Percentile is a measure of position.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Following instrument is used to measure",
    "choices": [
      {
        "id": 1,
        "text": "Humidity"
      },
      {
        "id": 2,
        "text": "Air velocity"
      },
      {
        "id": 3,
        "text": "Mean radiant temperature"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Image shows <strong>globe thermometer</strong> which is used to <strong>measure mean radiant temperature.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e2165beb1e784015bdbd85edb8ce4dd9.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Match the following with their definitions\nA.\tGeneration time\tI.\tGap in time between the onset of the primary case and the secondary case \nB.\tSerial interval\tII.\tTime during which an infectious agent may be transferred directly or indirectly from an infected person to another person\nC.\tLatent period\tIII.\tInterval of time between receipt of infection by a host and maximal infectivity of that host\nD.\tCommunicable period\tIV.\tPeriod from disease initiation to disease detection",
    "choices": [
      {
        "id": 1,
        "text": "A-I, B-II, C-III, D-IV"
      },
      {
        "id": 2,
        "text": "A-II, B-IV, C-III, D-I"
      },
      {
        "id": 3,
        "text": "A-I, B-III, C-IV, D-II"
      },
      {
        "id": 4,
        "text": "A-III, B-I, C-IV, D-II"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Generation time</strong> is defined as \"<strong>the interval of time between receipt of infection by a host and maximal infectivity of that host</strong>&rdquo;.</p>\n<p><strong>Serial interval</strong> is defined as the <strong>gap in time between the onset of the primary case and the secondary case</strong>.</p>\n<p>The <strong>communicable period</strong> is defined as \"the time during which an infectious agent may be transferred directly or indirectly from an infected person to another person, from an infected animal to man, or from an infected person to an animal, including arthropods\".</p>\n<p>The term <strong>latent period </strong>is used in noninfectious diseases as the equivalent of incubation period in infectious diseases<em>. </em>It has been defined as \"<strong>the period from disease initiation to disease detection\".</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The mean cholesterol levels are measured in patients before and after using an interventional drug. The statistical test of significance applied is _____",
    "choices": [
      {
        "id": 1,
        "text": "Chi-square test"
      },
      {
        "id": 2,
        "text": "Paired t test"
      },
      {
        "id": 3,
        "text": "Unpaired t test"
      },
      {
        "id": 4,
        "text": "ANOVA"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In this scenario, a <strong>paired t-test</strong> would be used as the effect of a drug to change the cholesterol level is measured on the <strong>same sample before and after&nbsp;</strong>administration of the drug.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Socratic method of communication includes",
    "choices": [
      {
        "id": 1,
        "text": "Panel discussion"
      },
      {
        "id": 2,
        "text": "Lecture"
      },
      {
        "id": 3,
        "text": "Television"
      },
      {
        "id": 4,
        "text": "Films"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>Socratic methods</strong> are methods of <strong>two-way communication</strong>.</li>\n<li>Examples include <strong>symposium, panel discussions, </strong>and<strong> workshops.</strong></li>\n<li>Advantage: Learning is more active and the audience can participate by asking questions, etc.</li>\n<li>It is able to <strong>influence human behaviour.</strong></li>\n</ul>\n<p>Lecture, television and films are one-way/didactic method of communication.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following vaccines cannot be used?",
    "choices": [
      {
        "id": 1,
        "text": "Only A"
      },
      {
        "id": 2,
        "text": "A, B & C"
      },
      {
        "id": 3,
        "text": "A & B"
      },
      {
        "id": 4,
        "text": "C & D"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Bottle C:</strong> The inner square is the same shade as the outer circle. Thus, it cannot be used.</p>\n<p><strong>Bottle D:</strong> The inner square is darker than the outer circle. Thus, it cannot be used.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/317995d929824c8fae95001f1de10f43.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A measure of position that divides the distribution into the ratio of 1:3 is the _____",
    "choices": [
      {
        "id": 1,
        "text": "First quartile"
      },
      {
        "id": 2,
        "text": "Third quartile"
      },
      {
        "id": 3,
        "text": "Mean"
      },
      {
        "id": 4,
        "text": "Mode"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In <strong>quartiles,</strong> the first quartile <strong>Q<sub>1</sub></strong> divides the distribution into the ratio of 1:3, the second quartile <strong>Q<sub>2</sub></strong> divides it in the ratio of 1:1, and the <strong>third quartile Q<sub>3</sub></strong> divides it into the ratio of <strong>3:1.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the critical path",
    "choices": [
      {
        "id": 1,
        "text": "1---2---5---7---10"
      },
      {
        "id": 2,
        "text": "1---3---4---6---10"
      },
      {
        "id": 3,
        "text": "1---8---9---10"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Longest path of the network</strong> is called <strong>critical path</strong>.</p>\n<ul>\n<li>Option A is the longest path (2+3+3+3+1= 12 days).</li>\n<li>Option b = 2+2+2+2+1 = 9 days</li>\n<li>Option c = 2+4+4+1 = 11 days</li>\n</ul>\n<p>A delay in the critical path will cause delay in the entire project.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b221736fe1344dc19f04bbe67bffb6f6.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Learned behaviour which is socially acquired is known as",
    "choices": [
      {
        "id": 1,
        "text": "Culture"
      },
      {
        "id": 2,
        "text": "Acculturation"
      },
      {
        "id": 3,
        "text": "Customs"
      },
      {
        "id": 4,
        "text": "Socialization"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Culture</strong> is defined as &ldquo;<strong>Learned behaviour which has been socially acquired.</strong>&rdquo;</p>\n<p><strong>Option b: Acculturation</strong> refers to &ldquo;<strong>culture contact</strong>&rdquo; i.e. diffusion of culture when there is contact between <strong>two people with different types of culture</strong>. Cultural contact takes place via various ways such as trade and commerce, industrialization, propagation of religion, education and conquest.</p>\n<p><strong>Option c: Customs</strong> are the <strong>established patterns of behaviour</strong> that can be objectively verified within a particular social setting. <strong>It can be divided into 2 forms &ndash; folkway and mores.</strong></p>\n<p><strong>Option d: Socialization</strong> is defined as a <strong>process by which man acquires beliefs, customs, traditions and prejudices</strong> of the society as a result of his everyday interaction with people of the society.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false?",
    "choices": [
      {
        "id": 1,
        "text": "Shrivastav committee \u2013 Creation of health guides"
      },
      {
        "id": 2,
        "text": "Kartar Singh committee \u2013 Multipurpose worker scheme"
      },
      {
        "id": 3,
        "text": "Jungalwalla committee \u2013 Integration of health services"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li><strong>Shrivastav committee</strong> recommended <strong>village health guide system</strong>.</li>\n<li><strong>Kartar singh committee</strong> recommended <strong>multipurpose worker scheme.</strong></li>\n<li><strong>Jungalwalla committee</strong> recommended <strong>integration of health services.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "False about septic tank represented in below-given image is",
    "choices": [
      {
        "id": 1,
        "text": "Ideal retention period \u2013 48 hours"
      },
      {
        "id": 2,
        "text": "Minimum capacity \u2013 500 gallons"
      },
      {
        "id": 3,
        "text": "Aerobic oxidation takes place outside the tank"
      },
      {
        "id": 4,
        "text": "Solids settle down as sludge"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Ideal <strong>retention period</strong> for a septic tank is <strong>24 hours.</strong></li>\n<li>If the retention period is too small, there is insufficient treatment of sewage and if it is too long, then undue septicity results.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/50294f004dcf41a88ef7905226eb92f5.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Strain used in mumps vaccine is",
    "choices": [
      {
        "id": 1,
        "text": "Edmonston"
      },
      {
        "id": 2,
        "text": "Jeryll Lynn"
      },
      {
        "id": 3,
        "text": "DANISH 1331"
      },
      {
        "id": 4,
        "text": "OKA"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Widely-used <strong>live attenuated mumps vaccine strains include the Jeryl Lynn, RIT 4385, Leningrad-3, L-Zagreb and Urabe strains</strong>.</p>\n<p><strong>Option a: Edmonston strain</strong> is used for preparation of <strong>measles vaccine.</strong></p>\n<p><strong>Option c: \"Danish 1331\"</strong> strain is the WHO recommended strain for the production of <strong>BCG vaccine</strong>.</p>\n<p><strong>Option d: OKA strain</strong> is the strain used for <strong>Varicella zoster vaccine.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Thickness of lead apron to prevent radiation",
    "choices": [
      {
        "id": 1,
        "text": "1mm"
      },
      {
        "id": 2,
        "text": "2mm"
      },
      {
        "id": 3,
        "text": "0.5mm"
      },
      {
        "id": 4,
        "text": "1.5mm"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Thickness of lead apron is 0.5mm. </strong>They will reduce the intensity of scattered X-rays over 90% and shud be worn by all workers regularly associated with X-ray procedures.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which article of the Indian Constitution confers \u2018Right to life\u2019 to the citizens of India?",
    "choices": [
      {
        "id": 1,
        "text": "Article 11"
      },
      {
        "id": 2,
        "text": "Article 22"
      },
      {
        "id": 3,
        "text": "Article 12"
      },
      {
        "id": 4,
        "text": "Article 21"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The \"<strong>Right to Life</strong>\" is given in <strong>Article 21</strong> of the Indian Constitution.</p>\n<p><strong>Article 11:</strong> Parliament to regulate the rights of citizenship by law.</p>\n<p><strong>Article 12:</strong> According to it, the term &lsquo;State&rsquo; denotes the union and state governments, the Parliament and state legislatures and all local or other authorities within the territory of India or under the control of the Indian government.</p>\n<p><strong>Article 22:&nbsp;</strong><span id=\"Article_22_{Protection_against_arrest_and_detention_in_certain_cases}\" class=\"mw-headline\">Protection against arrest and detention in certain cases.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient who was admitted to the ICU due to a road traffic accident later developed pneumonia. What time duration is required to declare it to be a hospital-acquired infection?",
    "choices": [
      {
        "id": 1,
        "text": "Within 24 hours after hospitalization"
      },
      {
        "id": 2,
        "text": "After 24 hours of hospitalization"
      },
      {
        "id": 3,
        "text": "Within 48 hours after hospitalization"
      },
      {
        "id": 4,
        "text": "After 48 hours of hospitalization"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given clinical scenario, any infection&nbsp;occurring more than <strong>48 hours</strong> after <strong>admission</strong> is usually considered a hospital-acquired infection.&nbsp;</p>\n<p>A hospital-acquired infection is defined as&nbsp;an&nbsp;<strong>infection acquired </strong>during<strong> hospital care </strong>that is <strong>not present</strong> or<strong> incubating at admission</strong>. It is&nbsp;acquired due to cross-infection of a patient by other patients, hospital staff. It is a determinant of the <strong>poor quality</strong> of service provided by the hospital. It is also called <strong>nosocomial infections.</strong></p>\n<p>The criteria for surveillance of nosocomial respiratory infections are:</p>\n<ol>\n<li>Cough</li>\n<li>Purulent sputum</li>\n<li>New infiltrate on radiograph consistent with infection</li>\n</ol>\n<p>If<strong> any 2 </strong>of the above given<strong> 3 </strong>clinical features are <strong>present,</strong> a diagnosis of<strong> hospital-acquired respiratory infection</strong> is made.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the distance around an airport or seaport that has to be kept free of all mosquitoes?",
    "choices": [
      {
        "id": 1,
        "text": "1 kilometre"
      },
      {
        "id": 2,
        "text": "500 metres"
      },
      {
        "id": 3,
        "text": "400 metres"
      },
      {
        "id": 4,
        "text": "100 metres"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The distance around an airport or seaport that has to be kept free of all mosquitoes is <strong>400 metres</strong>. This helps in limiting the spread of vector-borne diseases to new geographic regions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The method used for comparison of a new test and a gold standard test is ______",
    "choices": [
      {
        "id": 1,
        "text": "Regression analysis"
      },
      {
        "id": 2,
        "text": "Bland-Altmann Test"
      },
      {
        "id": 3,
        "text": "Cox regression"
      },
      {
        "id": 4,
        "text": "ANOVA"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>Bland-Altmann analysis</strong> is used for comparing a <strong>new method of measurement with another one, which usually is the gold standard</strong>.</p>\n<ul>\n<li>This method involves the graphical construction of a Bland-Altmann plot which is used to compare the measurements from both methods.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is used to obtain consensus forecasts among a large number of people?",
    "choices": [
      {
        "id": 1,
        "text": "Television"
      },
      {
        "id": 2,
        "text": "GATHER approach"
      },
      {
        "id": 3,
        "text": "Conferences"
      },
      {
        "id": 4,
        "text": "Delphi method"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Delphi method</strong> is a systematic interactive forecasting method, which is used to obtain a <strong>consensus forecast </strong>among a large number of people. It&nbsp;determines the degree of agreement on a topic.</p>\n<p>This can help in <strong>setting priorities</strong> or <strong>selecting alternatives</strong> in planning. This method uses <strong>questionnaires,&nbsp;</strong>which are answered by <strong>experts</strong> in two or more rounds.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Community Medicine Test I (Epidemiology, Biostatistics, Health Education And Planning, Environment And Social Sciences)';
        const quizFilename = 'community-medicine-test-i-epidemiology-biostatistics-health-education-and-planning-environment-and-social-sciences-b78debc3.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2018 - 19"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>