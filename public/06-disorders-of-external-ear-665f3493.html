<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>06 Disorders Of External Ear - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / ENT
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">29</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "In a 7-year-old child with hearing loss and intellectual disability, you notice the following external ear anomaly. What could the anomaly in this case be?",
    "choices": [
      {
        "id": 1,
        "text": "Preauricular sinus"
      },
      {
        "id": 2,
        "text": "Preauricular tag"
      },
      {
        "id": 3,
        "text": "Ganglion"
      },
      {
        "id": 4,
        "text": "Neurodermatitis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The external ear anomaly seen here is <strong>pre-auricular tag/appendage.&nbsp;</strong></p>\n<p>Pre-auricular tags/appendages are congenital external ear anomalies. They are seen as skin-covered pieces of <strong>cartilage</strong> anywhere between the&nbsp;<strong>tragus </strong>and the<strong> angle</strong> of the<strong> mouth</strong>.&nbsp;</p>\n<p>The clinical features of facial asymmetry,&nbsp;intellectual disability, limbal dermoid, and pre-auricular tags and&nbsp;mixed or conductive hearing loss point to a diagnosis of <strong>Goldenhar syndrome&nbsp;</strong>(oculoauriculovertebral spectrum). Clinical features include:</p>\n<div class=\"page\" title=\"Page 145\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<ol>\n<li>Hypoplasia of the malar, maxillary, and mandibular regions</li>\n<li>Macrostomia and microtia</li>\n<li>Preauricular and facial skin tags</li>\n<li>Hemivertebrae (usually cervical)</li>\n<li>Intellectual disability</li>\n<li>Cardiac, renal, and central nervous system (CNS) anomalies</li>\n<li>Ocular features- Limbal dermoids, upper lid notching or coloboma, microphthalmos, disc coloboma</li>\n</ol>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5763c73573dc4afea0bbcab42d3b0b2c.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presents to the OPD with the following finding and history of pus discharge from the same area. What is the likely etiology of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Instrumental injury"
      },
      {
        "id": 2,
        "text": "Congenital anomaly"
      },
      {
        "id": 3,
        "text": "Accessory opening of the mastoid"
      },
      {
        "id": 4,
        "text": "Idiopathic"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario and the image are suggestive of&nbsp;<strong>preauricular</strong>&nbsp;<strong>sinus</strong>&nbsp;seen between the<strong>&nbsp;</strong>tragus&nbsp;and&nbsp;crus of the helix.&nbsp;It is the most common&nbsp;<strong>congenital anomaly</strong> of the <strong>1<sup>st</sup> branchial arch,&nbsp;</strong>due to&nbsp;the&nbsp;<strong>incomplete fusion </strong>of the&nbsp;<strong>hillocks of His</strong><strong>&nbsp;</strong>that develop to form the pinna.</p>\n<p>It can get repeatedly infected and form an abscess, which would then require excision.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9364edfb641b410f93de0eff0037ace2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bb384e068c9f4b8ca074fffb7a1ce30bx1280x2576.JPEG"
    ]
  },
  {
    "text": "An 8-month-old child was brought to your OPD with the following finding.  What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Wildermuth ear"
      },
      {
        "id": 2,
        "text": "Mozart ear"
      },
      {
        "id": 3,
        "text": "Microtia"
      },
      {
        "id": 4,
        "text": "Anotia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image showing <strong>malformed small pinna</strong> appearing like tubercles are suggestive of <strong>microtia.</strong>\u00a0It is frequently accompanied by hearing loss.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2e5d7d08dbf3405296f8758ed285851b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A child with protruding ears is brought to the OPD by his worried parents. They opt for surgical correction of the defect due to cosmetic reasons. After what age would you proceed with the surgery?",
    "choices": [
      {
        "id": 1,
        "text": "3 months"
      },
      {
        "id": 2,
        "text": "6 months"
      },
      {
        "id": 3,
        "text": "3 years"
      },
      {
        "id": 4,
        "text": "6 years"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Protruding ears</strong> or bat ears can be <strong>corrected</strong>&nbsp;anytime <strong>after 6 years</strong> of age if cosmetic appearance demands. This is due to the fact that the pinna is completely developed and achieves adult configuration by the age of 6 years.</p>\n<p>Protruding ears are caused by a <strong>large concha</strong> with poorly developed antihelix and scapha.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f20339f38ecb4d8abf5e6dd67532b1c4x768x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ff6b455c69124977b95413a991c6cedax1280x1586.JPEG"
    ]
  },
  {
    "text": "A 5-year-old girl was brought to you with complaints of serous discharge from a cutaneous opening on the right side of her neck. A fistulogram confirms your diagnosis of collaural fistula. Which of the following is a feature of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Abnormality of second branchial cleft"
      },
      {
        "id": 2,
        "text": "Opens in front of the tragus"
      },
      {
        "id": 3,
        "text": "Acquired secondary to infection"
      },
      {
        "id": 4,
        "text": "Traverses close to the facial nerve"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Collaural fistula</strong>&nbsp;traverses&nbsp;close to the <strong>facial nerve</strong>&nbsp;within the substance of the parotid. It is a <strong>congenital anomaly</strong> of <strong>1<sup>st</sup> branchial cleft.&nbsp;</strong></p>\n<p>The fistula is between the&nbsp;<strong>external auditory canal&nbsp;</strong>and<strong> neck, </strong>where the<strong>&nbsp;</strong>upper opening is on the floor of&nbsp;the external auditory canal and the lower opening is on the neck between mandible and sternocleidomastoid.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A professional wrestler presents to your OPD with the deformity shown below. What is the most likely cause of the same?",
    "choices": [
      {
        "id": 1,
        "text": "Auricular hematoma"
      },
      {
        "id": 2,
        "text": "External ear exostosis"
      },
      {
        "id": 3,
        "text": "Auricular pseudocyst"
      },
      {
        "id": 4,
        "text": "Avulsion of pinna"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows a&nbsp;cauliflower ear deformity, which is likely due to <strong>auricular hematoma.</strong>&nbsp;</p>\n<p>Auricular hematoma is a collection of blood between the auricular cartilage and its perichondrium. If left <strong>untreated</strong><strong>,</strong> the extravasated blood may clot and then organize, resulting in a typical deformity called <strong>cauliflower ear</strong>. It is also called<strong>&nbsp;</strong><strong>pugilistic </strong>or<strong> boxer&rsquo;s ear</strong><strong>.&nbsp;</strong></p>\n<p>It is often seen in boxers, wrestlers, and rugby players due to <strong>blunt trauma</strong>.</p>\n<p>Treatment comprises of <strong>aspiration</strong> of the hematoma under strict aseptic precautions and a <strong>pressure dressing,</strong> to prevent reaccumulation. Aspiration may need to be repeated. If aspiration fails, incision and drainage should be done.&nbsp;All cases should receive <strong>prophylactic antibiotics.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/83c2d517da9f4603b14374b8933229d8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young man is rushed to the ER following a road traffic accident with severe injuries and a completely avulsed pinna. How would you preserve the avulsed pinna until the patient is stable enough for reconstructive surgery?",
    "choices": [
      {
        "id": 1,
        "text": "By storing it in a refrigerator in isotonic saline"
      },
      {
        "id": 2,
        "text": "By suturing it to buccal mucosa after careful cleaning"
      },
      {
        "id": 3,
        "text": "By peeling its skin and inserting cartilage into postauricular area"
      },
      {
        "id": 4,
        "text": "By implanting it into the abdominal cavity"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The avulsed pinna is preserved by <strong>peeling</strong> its <strong>skin</strong> and inserting the&nbsp;<strong>cartilage</strong> into the <strong>postauricular area</strong> which&nbsp;can be preserved&nbsp;for <strong>delayed reconstruction.</strong>&nbsp;</p>\n<p>However,&nbsp;immediate reimplantation using microvascular techniques&nbsp;would be ideal.</p>\n<div class=\"page\" title=\"Page 67\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>If the pinna is still attached to the head by a small pedicle of skin, primary reattachment should be considered.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most likely diagnosis in a patient who presents with a painful ear swelling as shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Cauliflower ear"
      },
      {
        "id": 2,
        "text": "Perichondritis"
      },
      {
        "id": 3,
        "text": "Chondrodermatitis chronica helicis"
      },
      {
        "id": 4,
        "text": "Otitis externa"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>&nbsp;</p>\n<p><strong>Otitis externa,&nbsp;</strong>also called <strong>swimmer's ear</strong>, is the inflammation of the ear canal. It has the following appearance:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3d511ccc8a85488286af90a07e771aeb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5963832cc931499aa3b3d4f522bac8b8x768x1156.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1e06ec75dc342c9bc75ab6388987b42x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/561f50a0c2204200a4ecc36e5e7022cax1024x768.JPEG"
    ]
  },
  {
    "text": "A middle-aged man presents with a lesion as shown below. He is unable to sleep on the affected side. There is no history of trauma. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Acute suppurative perichondritis of pinna"
      },
      {
        "id": 2,
        "text": "Furuncle"
      },
      {
        "id": 3,
        "text": "Chondrodermatitis nodularis chronica helicis"
      },
      {
        "id": 4,
        "text": "Relapsing polychondritis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A small tender nodule in the helix in a middle-aged patient is suggestive of <strong>chondrodermatitis nodularis chronica helicis. </strong>The patient&nbsp;will have difficulty sleeping on the affected side.</p>\n<p>Treatment includes excision of the lesion.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/aeee4ea1f2e042a9b54ea9625b33568c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient is planned for excision of the following lesion. Which of the following measures will not prevent its recurrence post-excision?",
    "choices": [
      {
        "id": 1,
        "text": "Preoperative radiotherapy"
      },
      {
        "id": 2,
        "text": "Postoperative radiotherapy"
      },
      {
        "id": 3,
        "text": "Neoadjuvant chemotherapy"
      },
      {
        "id": 4,
        "text": "Intralesional steroid"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows a<strong> keloid</strong> of the pinna and neoadjuvant chemotherapy does not<strong>&nbsp;</strong>reduce its recurrence post excision.&nbsp;</p>\n<p>Keloid commonly occurs following<strong>&nbsp;trauma.&nbsp;</strong>The common sites are lobule and helix.</p>\n<p>There is a high chance of recurrence after excision, which can be prevented by:</p>\n<ul>\n<li>Intralesional steroids</li>\n<li>Pre and post-operative radiotherapy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/88dd5283f36149769d84a5a87799e7d1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true about furunculosis of ear?",
    "choices": [
      {
        "id": 1,
        "text": "Patients with repeated attacks should be investigated for diabetes mellitus"
      },
      {
        "id": 2,
        "text": "Most common cause is streptococcal infection of hair follicle"
      },
      {
        "id": 3,
        "text": "Can occur anywhere in the external auditory canal"
      },
      {
        "id": 4,
        "text": "Tragal sign is negative in majority of cases"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Patients with <strong>repeated attacks of furunculosis</strong> should be investigated for <strong>diabetes mellitus.</strong>&nbsp;</p>\n<p>A furuncle is a <strong>staphylococcal infection</strong> of the<strong> hair follicle</strong>. As the hairs are confined only to the <strong>cartilaginous part of the meatus</strong>, furuncle is seen only<strong> outer one-third</strong> of EAC.</p>\n<p>Symptoms are severe compared to signs as the skin over the EAC is tightly adherent. The <strong>tragal</strong> <strong>sign</strong> is <strong>positive</strong> and there is an <strong>obliteration</strong> of the <strong>retro auricular groove.</strong></p>\n<p>Treated by incision and drainage or <strong>10% ichthammol glycerine</strong> wicks and antibiotics.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is synonymous with swimmer\u2019s ear?",
    "choices": [
      {
        "id": 1,
        "text": "Hematoma of pinna"
      },
      {
        "id": 2,
        "text": "Exostosis"
      },
      {
        "id": 3,
        "text": "Diffuse otitis externa"
      },
      {
        "id": 4,
        "text": "Malignant otitis externa"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Swimmer&rsquo;s ear</strong> is synonymous with <strong>diffuse otitis externa.</strong></p>\n<p>The normal pH of the external auditory canal is&nbsp;<strong>acidic.</strong>&nbsp;Any condition that makes the pH <strong>alkaline</strong>&nbsp;predisposes to&nbsp;<strong>otitis externa.</strong>&nbsp;This includes situations such as:</p>\n<ul>\n<li>Hot &amp; humid climate (excessive sweating) and</li>\n<li>Prolonged swimming</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old male presents with right-sided ear discharge, itching and pain for the past 4 days. He gives a history of insect entry into the external auditory canal which he removed himself. On examination, there is purulent discharge in a narrow canal and the tympanic membrane is normal. Which of the following is the most effective single treatment for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Medicated wicks"
      },
      {
        "id": 2,
        "text": "Aural toilet"
      },
      {
        "id": 3,
        "text": "Antibiotics"
      },
      {
        "id": 4,
        "text": "Analgesics"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is suggestive of <strong>diffuse otitis externa</strong>&nbsp;following a trauma<strong>.</strong> <strong>Aural toilet</strong> remains the most effective single treatment for this condition.</p>\n<p>All exudate and debris should be carefully removed, with special emphasis on the <strong>anteroinferior meatal recess,&nbsp;</strong>which forms a blind pocket and acts as a <strong>reservoir</strong> of infective secretion. The aural toilet can be done by dry mopping, suction clearance, or irrigating the canal with warm, sterile normal saline.</p>\n<p>Further treatment modalities:</p>\n<ul>\n<li>After the aural toilet is done, <strong>wicks </strong>medicated with<strong> antibiotic-steroid </strong>preparation can be used. These wicks have to be changed daily for 2 to 3 days, which thereafter can be substituted by ear drops.</li>\n<li>Broad-spectrum <strong>systemic antibiotics</strong> are used when there is <strong>cellulitis and acute tender lymphadenitis.</strong></li>\n<li>Analgesics are usually a part of management, as otitis externa is associated with severe pain.</li>\n<li>Gauze wick soaked in <strong>10% ichthammol glycerine</strong> is used to <strong>reduce swelling.</strong></li>\n<li>Astringents such as<strong> aluminum acetate&nbsp;</strong>(8%)<strong> or silver nitrate&nbsp;</strong>(3%) are used to <strong>dry up </strong>an<strong> oozing meatus.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common cause of otomycosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mucor velutinosus"
      },
      {
        "id": 2,
        "text": "Candida albicans"
      },
      {
        "id": 3,
        "text": "Aspergillus fumigatus"
      },
      {
        "id": 4,
        "text": "Aspergillus niger"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Otomycosis</strong> is a fungal infection of the ear canal that often occurs due to <strong><em>Aspergillus niger</em></strong> <strong>(most common)</strong>, <em>Aspergillus fumigatus,</em> or <em>Candida albicans</em>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presented with irritation and itching in the ear, associated with watery discharge and a musty odor. Otoscopic imaging is shown below. What is the causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Aspergillus niger"
      },
      {
        "id": 2,
        "text": "Rhizopus oryzae"
      },
      {
        "id": 3,
        "text": "Candida albicans"
      },
      {
        "id": 4,
        "text": "Aspergillus fumigatus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario along with the otoscopic image showing&nbsp;<strong>black-headed filamentous</strong> growth is suggestive of&nbsp;<strong>otomycosis</strong> by<strong> <em>Aspergillus niger.&nbsp;</em></strong></p>\n<p><strong>Irritation</strong> and <strong>itching</strong> are<strong>&nbsp;</strong>the most predominant symptoms of&nbsp;<em>Aspergillus niger</em> infection. <strong>Pain</strong> is predominant in <em><strong>Aspergillus flavus</strong></em> infection.</p>\n<p>The fungal mass in otomycosis is likened to a wet blotting paper/wet newspaper appearance.</p>\n<p>The appearances of otomycosis on otoscopy and the causative organisms are:&nbsp;</p>\n<ul>\n<li>Black-headed filamentous growth - <em>Aspergillus niger</em> infection</li>\n<li>Green or brown -&nbsp;<em>Aspergillus fumigatus&nbsp;</em>infection</li>\n<li>White and creamy deposit - Candida infection</li>\n</ul>\n<p>Rhizopus oryzae is one of the causative agents of mucormycosis. The common clinical form of this opportunistic infection is&nbsp;rhino-orbital-cerebral mucormycosis (ROCM). It is rarely implicated in otomycosis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5a8458f70e3d4318a5b46b570f9b5afb.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old woman presents to the OPD with right-sided facial weakness. On examination, she has vesicles in the external auditory canal and over the tympanic membrane. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Bell's palsy"
      },
      {
        "id": 2,
        "text": "Ramsay Hunt syndrome"
      },
      {
        "id": 3,
        "text": "M\u00f6ebius syndrome"
      },
      {
        "id": 4,
        "text": "Melkersson syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>&nbsp;</p>\n<p><strong>Moebius</strong> syndrome is a<strong>&nbsp;congenital</strong> unilateral/bilateral lower motor neuron <strong>facial nerve paralysis</strong>&nbsp;with <strong>abducens palsy</strong> causing limited ocular abduction.</p>\n<div class=\"page\" title=\"Page 120\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Melkersson</strong> syndrome is an idiopathic disorder consisting of a <strong>triad</strong> of:</p>\n<ol>\n<li>Facial paralysis</li>\n<li>Swelling of lips</li>\n<li>Fissured tongue.</li>\n</ol>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c23fe164f2514c2f8253379458164a83x720x681.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1012fe1f20fb46d5919d8c6badbfba19x407x599.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f5dcc4eb6e44e3484b5e186e2862d6bx720x281.PNG"
    ]
  },
  {
    "text": "A 60-year-old diabetic presents to the ER with fever, excruciating left ear pain, and otorrhoea which is unresponsive to antibiotics. On examination, she has a deviation of the angle of mouth to the right side, and granulation tissue is seen in the left external auditory canal. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Otomycosis"
      },
      {
        "id": 2,
        "text": "Serous otitis media"
      },
      {
        "id": 3,
        "text": "Malignant otitis externa"
      },
      {
        "id": 4,
        "text": "Eczematous otitis externa"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of an elderly <strong>diabetic</strong> with severe otalgia, otorrhoea,<strong>&nbsp;granulation tissue</strong> in the external auditory canal, and lower motor neuron&nbsp;<strong>facial nerve palsy</strong> indicates <strong>malignant otitis externa.</strong></p>\n<p>It is termed malignant, even though it is an infection, due to the high mortality rate and poor response to treatment.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false about malignant otitis externa?",
    "choices": [
      {
        "id": 1,
        "text": "It is due to pseudomonas infection"
      },
      {
        "id": 2,
        "text": "It mainly affects immunocompromised individuals"
      },
      {
        "id": 3,
        "text": "Technetium 99 bone scan is used for follow up"
      },
      {
        "id": 4,
        "text": "Facial nerve is the most common affected nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Technetium 99 bone scan</strong>&nbsp;remains positive for a year or so and <strong>cannot</strong> be used to&nbsp;<strong>follow up</strong> response to treatment<strong>. </strong>It is particularly useful when the clinical suspicion for malignant otitis externa is high but the CT scan is negative.</p>\n<p>Features of malignant otitis externa:</p>\n<ul>\n<li><em>Pseudomonas</em> infection in the <strong>elderly diabetics</strong>&nbsp;and those on immunosuppressive drugs.</li>\n<li>Excruciating pain, profuse discharge &amp; <strong>granulations</strong> on the <strong>floor of the external auditory canal.</strong></li>\n<li>Necrosis of bone aids in the spread of infection.</li>\n<li>Infection may spread to the skull base and jugular foramen causing <strong>multiple cranial nerve palsies</strong>.</li>\n<li><strong>Facial paralysis</strong> is the most common nerve palsy seen.</li>\n<li><strong>Mitotic figures</strong>&nbsp;will be&nbsp;<strong>normal</strong> since it is an infective and not a malignant condition.</li>\n<li><strong>Gallium-67</strong> is more useful in the&nbsp;<strong>follow-up</strong> of the patient.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presents to the OPD with complaints of intense irritation in the ear following the use of ear drops. Examination reveals vesicle formation, oozing, and crusting in the canal. Which of the following is responsible?",
    "choices": [
      {
        "id": 1,
        "text": "Clotrimazole"
      },
      {
        "id": 2,
        "text": "Paradichlorobenzene"
      },
      {
        "id": 3,
        "text": "Dexamethasone"
      },
      {
        "id": 4,
        "text": "Neomycin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of&nbsp;<strong>eczematous otitis externa </strong>and the drug implicated is <strong>neomycin.</strong></p>\n<p>Eczematous otitis externa&nbsp;is due to&nbsp;<strong>hypersensitivity</strong> to infective organisms or topical ear drops such as chloromycetin or neomycin, etc. The presence of&nbsp;intense irritation, vesicle formation, oozing, and crusting&nbsp;in the canal is observed.</p>\n<p>Management involves stopping the implicated ear drops, changing to a different combination and application of steroid cream.</p>\n<p>Note -&nbsp;<strong>Otitis externa hemorrhagica</strong> is a condition characterized by the formation of&nbsp;<strong>haemorrhagic bullae</strong>&nbsp;on the&nbsp;<strong>tympanic membrane</strong>&nbsp;and deep meatus. This causes severe pain in the ear and blood-stained discharge when the bullae rupture. It is probably viral in origin.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false about wax?",
    "choices": [
      {
        "id": 1,
        "text": "Contains secretions of glands in the external auditory canal"
      },
      {
        "id": 2,
        "text": "Formed by dried up middle ear discharge"
      },
      {
        "id": 3,
        "text": "Has antibacterial activity"
      },
      {
        "id": 4,
        "text": "Is extruded out on its own during jaw movements"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Wax or cerumen is not made up of middle ear discharge.</p>\n<p>Composition of wax:</p>\n<ul>\n<li>Secretions of <strong>ceruminous glands</strong> (modified apocrine sweat glands)</li>\n<li>Secretions of the&nbsp;sebaceous gland (fatty secretion)</li>\n<li>Desquamated epithelial cells</li>\n<li>Hair</li>\n</ul>\n<p>Wax is normally <strong>expelled</strong> by the&nbsp;<strong>movement</strong> of&nbsp;the <strong>jaw</strong> during eating, talking.</p>\n<p>Functions include <strong>antibacterial action</strong> and<strong>&nbsp;</strong>trapping of foreign bodies and dirt.&nbsp;Impacted wax causes a sensation of blockage of the ear, reduced hearing, vertigo, tinnitus.</p>\n<p>Treatment:</p>\n<ul>\n<li>Softening with ceruminolytics like 2% paradichlorobenzene, 5% sodium bicarbonate in equal parts of glycerine and water.</li>\n<li><strong>Syringing</strong> or instrumentation or suction clearance.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ceruminous glands are modifications of which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Apocrine glands"
      },
      {
        "id": 2,
        "text": "Eccrine glands"
      },
      {
        "id": 3,
        "text": "Holocrine glands"
      },
      {
        "id": 4,
        "text": "Cytocrine glands"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Ceruminous</strong> glands are modified <strong>apocrine</strong> sweat glands.</p>\n<p>Ceruminous and sebaceous&nbsp;glands open into the space of the hair follicle in the external auditory canal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While performing syringing for a patient with impacted wax, along which wall of the meatus would you direct the jet of water?",
    "choices": [
      {
        "id": 1,
        "text": "Anterosuperior wall"
      },
      {
        "id": 2,
        "text": "Posterosuperior wall"
      },
      {
        "id": 3,
        "text": "Anteroinferior wall"
      },
      {
        "id": 4,
        "text": "Posteroinferior wall"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>During syringing, the pinna is pulled upwards and backward and the water jet is directed along the <strong>posterosuperior wall </strong>of the<strong> meatus.&nbsp;</strong>This is preferred because of two anatomical reasons:</p>\n<ol>\n<li>On maneuvering the pinna to bring the EAC into a straight configuration, the <strong>posterior wall</strong> is <strong>straighter</strong> and easily <strong>accessible</strong> than the anterior wall.</li>\n<li>The <strong>posteroinferior</strong> wall of EAC is supplied by the&nbsp;<strong>vagus</strong>. Direct stimulation of this can lead to sudden <strong>cardiac arrest.</strong></li>\n</ol>\n<p>Complications of syringing:</p>\n<ul>\n<li>Vertigo&ndash; caloric stimulation of lateral semicircular canal if water is too hot or too cold</li>\n<li>Rupture of the tympanic membrane</li>\n<li>Reactivation of quiescent otitis media, if there is pre-existing perforation</li>\n</ul>\n<p>Contraindications for syringing:</p>\n<ul>\n<li>Presence of ear infection, tympanic membrane perforation</li>\n<li>Presence of grommet or history of ear surgery</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After the extraction of the mass in a patient with keratosis obturans,  it is sent for histopathological examination. Which of the following is seen here?",
    "choices": [
      {
        "id": 1,
        "text": "Keratin in random pattern"
      },
      {
        "id": 2,
        "text": "Cholesterol crystals"
      },
      {
        "id": 3,
        "text": "Desquamated epithelial cells"
      },
      {
        "id": 4,
        "text": "Squamous epithelial metaplasia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Keratosis obturans </strong>is the collection of a pearly white mass of<strong> desquamated epithelial cells</strong> in the deep meatus.</p>\n<p>The keratin plug is arranged in a <strong>lamellar</strong> fashion, not at a random pattern.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not seen in a patient with keratosis obturans?",
    "choices": [
      {
        "id": 1,
        "text": "Ulceration and granuloma formation"
      },
      {
        "id": 2,
        "text": "Isolation of Staphylococcus aureus"
      },
      {
        "id": 3,
        "text": "Association with bronchiectasis"
      },
      {
        "id": 4,
        "text": "Narrowing of meatus causing facial nerve palsy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Keratosis obturans, by pressure effect, causes absorption of bone which causes&nbsp;<strong>widening</strong>&nbsp;(not narrowing) of the meatus leading to facial nerve palsy.</p>\n<p>Normally, epithelium from the surface of the tympanic membrane migrates onto the posterior meatal wall.&nbsp;Failure of this migration, or obstruction to migration caused by wax, may lead to keratosis obturans which is the accumulation of a large plug of <strong>desquamated keratin</strong> in the <strong>external auditory meatus</strong>.</p>\n<p>Features of keratosis obturans:</p>\n<ul>\n<li>Severe otalgia</li>\n<li>Conductive hearing loss</li>\n<li>Thickened tympanic membrane</li>\n<li><strong>Keratin plug</strong>/pearly white mass occluding the canal</li>\n<li><strong>Widened</strong> ear canal- may lead to <strong>facial nerve paralysis</strong></li>\n<li>Hyperemia of canal skin, sometimes with <strong>ulcerations</strong> and&nbsp;<strong>granulomas</strong></li>\n</ul>\n<p><strong><em>Staphylococcus aureus </em></strong>is the most frequent isolate.</p>\n<p>Keratosis oburans may be associated with systemic conditions like bronchiectasis and chronic sinusitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the surgery done to widen the cartilaginous part of the external auditory canal called?",
    "choices": [
      {
        "id": 1,
        "text": "Meatoplasty"
      },
      {
        "id": 2,
        "text": "Tympanoplasty"
      },
      {
        "id": 3,
        "text": "Myringoplasty"
      },
      {
        "id": 4,
        "text": "Otoplasty"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The surgery done to widen the <strong>cartilaginous part</strong> of the external auditory canal is&nbsp;<strong>meatoplasty</strong>.</p>\n<p><strong>Meatoplasty</strong> is a surgical procedure that involves the <strong>removal</strong> of a crescent-shaped portion of <strong>conchal cartilage</strong> to widen the external auditory meatus. It is performed in combination with all <strong>canal wall-down procedures</strong> like <strong>modified</strong> <strong>radical</strong> and <strong>radical mastoidectomies</strong>,<strong> </strong>for easy access to the mastoid cavity for periodic inspection and cleaning.</p>\n<p>It is also done as an <strong>isolated</strong> <strong>procedure</strong> in elderly people with <strong>sagging auricles. </strong>A<strong> sagging</strong>&nbsp;auricle&nbsp;causes obstruction to the meatus leading to the retention of wax and difficulty in hearing.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Tympanoplasty</strong> is the surgical reconstruction to correct damage in the middle ear and restore the integrity of the tympanic membrane for improved hearing. It is <strong>ossicular</strong> <strong>reconstruction</strong> only or ossicular reconstruction with myringoplasty.&nbsp;</p>\n<p>Option C:<strong> Myringoplasty</strong> refers to the reconstruction of the tympanic membrane only.</p>\n<p>Option D: <strong>Otoplasty</strong> is the correction of external ear/deformities of the pinna.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following is meatoplasty not performed?",
    "choices": [
      {
        "id": 1,
        "text": "Congenital atresia of canal"
      },
      {
        "id": 2,
        "text": "Chronic stenotic otitis externa"
      },
      {
        "id": 3,
        "text": "Tortuous canal during tympanoplasty"
      },
      {
        "id": 4,
        "text": "Canal wall up procedure"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Meatoplasty is not a part of canal wall-up (CWU)<strong>&nbsp;</strong>procedures as the meatus appears normal.</p>\n<p>However, <strong>meatoplasty</strong> is performed in combination with all <strong>canal wall down procedures</strong> like modified radical and radical mastoidectomies, for the treatment of middle ear disease such as cholesteatoma.&nbsp;The widened meatus helps to easily visualize and access the mastoid cavity for periodic inspection and cleaning.</p>\n<p>It is also done in <strong>atresia/stenosis</strong>&nbsp;to recanalize the ear and&nbsp;in <strong>tortuous canals</strong> post-tympanoplasty to improve hearing.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While performing otoscopy, which of the following would not indicate a normal tympanic membrane?",
    "choices": [
      {
        "id": 1,
        "text": "Pearly grey in colour"
      },
      {
        "id": 2,
        "text": "Primarily translucent"
      },
      {
        "id": 3,
        "text": "Convex to external auditory canal"
      },
      {
        "id": 4,
        "text": "Mobile with a change in middle ear pressures"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>normal tympanic membrane</strong> is <strong>concave</strong> to the <strong>EAC</strong> with the maximum concavity at the umbo.</p>\n<p>Features of normal TM:</p>\n<ul>\n<li>Pearly grey in color</li>\n<li>Shiny</li>\n<li>Degree of transparency varies</li>\n<li>Mobile with change in middle ear pressures</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false regarding retracted tympanic membrane?",
    "choices": [
      {
        "id": 1,
        "text": "Shiny, pearly white tympanic membrane"
      },
      {
        "id": 2,
        "text": "Foreshortened handle of malleus"
      },
      {
        "id": 3,
        "text": "Prominent lateral process of malleus"
      },
      {
        "id": 4,
        "text": "Sickling of anterior and posterior malleal folds"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A<strong> retracted</strong> <strong>TM </strong>is<strong> d</strong><strong>ull</strong> and<strong> lustreless,</strong>&nbsp;not shiny and pearly white.</p>\n<p>Features of retracted TM:</p>\n<ul>\n<li>The cone of light is absent or interrupted.</li>\n<li>The handle of the malleus appears foreshortened.</li>\n<li>The lateral process of the malleus becomes more prominent.</li>\n<li>Anterior and posterior malleal folds become sickle-shaped.</li>\n</ul>\n<p>The image below shows a retracted TM with the above mentioned findings:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b2e777c69304055a6dca12bb7e73941x220x220.JPEG"
    ]
  },
  {
    "text": "While performing routine otoscopy, a patient is found to have tympanic membrane retraction with the pars tensa draping over the incudostapedial joint. What is the grade of retraction?",
    "choices": [
      {
        "id": 1,
        "text": "Grade I Sade"
      },
      {
        "id": 2,
        "text": "Grade II Sade"
      },
      {
        "id": 3,
        "text": "Grade I Tos"
      },
      {
        "id": 4,
        "text": "Grade II Tos"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Draping of <strong>pars tensa</strong> over the incudostapedial joint is classified as <strong>Sade's grade II r</strong>etraction.</p>\n<p>Sade classification of retraction of Pars tensa: &nbsp;</p>\n<table style=\"height: 214px; width: 331.078125px;\">\n<tbody>\n<tr>\n<td style=\"width: 63px;\">Grade</td>\n<td style=\"width: 253.078125px;\">Description</td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">Grade 1</td>\n<td style=\"width: 253.078125px;\">Mild retraction <strong>not touching</strong> the long process of the <strong>incus</strong></td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">Grade 2</td>\n<td style=\"width: 253.078125px;\">Retracted drum <strong>touching</strong> the long process of the <strong>incus</strong></td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">Grade 3</td>\n<td style=\"width: 253.078125px;\">Touching promontory but <strong>mobile</strong> on seigalization - <strong>atelectasis</strong> of the middle ear</td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">Grade 4</td>\n<td style=\"width: 253.078125px;\">Plastered to promontory and&nbsp;<strong>immobile -</strong>&nbsp;<strong>adhesive</strong> middle ear</td>\n</tr>\n</tbody>\n</table>\n<p>Tos classification of retraction of Pars flaccida: &nbsp;</p>\n<table style=\"height: 208px; width: 331.171875px;\">\n<tbody>\n<tr style=\"height: 19.1875px;\">\n<td style=\"width: 61px; height: 19.1875px;\">Grade</td>\n<td style=\"width: 255.171875px; height: 19.1875px;\">Description</td>\n</tr>\n<tr style=\"height: 49px;\">\n<td style=\"width: 61px; height: 49px;\">Grade 1</td>\n<td style=\"width: 255.171875px; height: 49px;\">Mild attic retraction <strong>not touching</strong> the neck of the <strong>malleus.</strong></td>\n</tr>\n<tr style=\"height: 31px;\">\n<td style=\"width: 61px; height: 31px;\">Grade 2</td>\n<td style=\"width: 255.171875px; height: 31px;\"><strong>Touching</strong>&nbsp;the neck of the&nbsp;<strong>malleus</strong></td>\n</tr>\n<tr style=\"height: 31px;\">\n<td style=\"width: 61px; height: 31px;\">Grade 3</td>\n<td style=\"width: 255.171875px; height: 31px;\"><strong>Limited</strong> outer attic wall erosion</td>\n</tr>\n<tr style=\"height: 31px;\">\n<td style=\"width: 61px; height: 31px;\">Grade 4</td>\n<td style=\"width: 255.171875px; height: 31px;\"><strong>Severe</strong> outer attic wall erosion</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '06 Disorders Of External Ear';
        let hierarchy = ["Marrow", "qBank", "ENT"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>