<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test- 21 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following is the most common congenital anomaly of the kidney?",
    "choices": [
      {
        "id": 1,
        "text": "Renal agenesis"
      },
      {
        "id": 2,
        "text": "Renal duplication"
      },
      {
        "id": 3,
        "text": "Horseshoe kidney"
      },
      {
        "id": 4,
        "text": "Pancake kidney"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>horseshoe kidney</strong> is the <strong>most common congenital anomaly</strong> of the <strong>kidney</strong>, with an incidence of <strong>1 in 600 live births</strong>.</p>\n<p>During development, the kidney is initially located in the pelvic region. Later, the kidneys ascend due to the growth of the body in the lumbar and sacral regions.&nbsp;Sometimes, the kidneys are pushed so close to each other during their ascent that their&nbsp;<strong>lower poles fuse</strong>, forming a <strong>horseshoe kidney</strong>.&nbsp;</p>\n<ul>\n<li>The horseshoe kidney is usually found at the level of the <strong>lower lumbar vertebrae</strong>.</li>\n<li>Its <strong>ascent</strong> is <strong>halted</strong> by the <strong>root of the inferior mesenteric artery</strong>.</li>\n<li>The connecting isthmus of the horseshoe kidney may be present either in front or behind the aorta and the inferior vena cava.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5fe98a70659946e38ba7a2c4b7627a49x340x432.JPEG"
    ]
  },
  {
    "text": "\u2191 LH secretion just before ovulation is due to_____",
    "choices": [
      {
        "id": 1,
        "text": "Positive feedback by progesterone"
      },
      {
        "id": 2,
        "text": "Positive feedback by estrogen"
      },
      {
        "id": 3,
        "text": "Positive feedback by FSH"
      },
      {
        "id": 4,
        "text": "Positive feedback by relaxin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Increased luteinizing hormone (LH) secretion just before ovulation is due to <strong>positive feedback by estrogen.</strong>&nbsp;</p>\n<table style=\"width: 550px;\">\n<tbody>\n<tr>\n<td style=\"width: 96px;\">\n<p><strong>Phases </strong></p>\n</td>\n<td style=\"width: 84px;\">\n<p><strong>Hormone </strong></p>\n</td>\n<td style=\"width: 115px;\">\n<p><strong>Type of feedback </strong></p>\n</td>\n<td style=\"width: 87px;\">\n<p><strong>Site </strong></p>\n</td>\n<td style=\"width: 144px;\">\n<p><strong>FSH and LH secretion</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 96px;\">\n<p>Follicular</p>\n</td>\n<td style=\"width: 84px;\">\n<p>Estrogen</p>\n</td>\n<td style=\"width: 115px;\">\n<p>Negative</p>\n</td>\n<td style=\"width: 87px;\">\n<p>Anterior pituitary</p>\n</td>\n<td style=\"width: 144px;\">\n<p>Both suppressed</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 96px;\">\n<p>Midcycle</p>\n</td>\n<td style=\"width: 84px;\">\n<p>Estrogen</p>\n</td>\n<td style=\"width: 115px;\">\n<p>Positive</p>\n</td>\n<td style=\"width: 87px;\">\n<p>Anterior pituitary</p>\n</td>\n<td style=\"width: 144px;\">\n<p>Increased LH surge</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 96px;\">\n<p>Luteal</p>\n</td>\n<td style=\"width: 84px;\">\n<p>Estrogen</p>\n<p>Progesterone</p>\n</td>\n<td style=\"width: 115px;\">\n<p>Negative</p>\n<p>Negative</p>\n</td>\n<td style=\"width: 87px;\">\n<p>Anterior pituitary</p>\n<p>Anterior pituitary</p>\n</td>\n<td style=\"width: 144px;\">\n<p>Both are decreased</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Name the procedure depicted in the picture below.",
    "choices": [
      {
        "id": 1,
        "text": "Southern Blotting"
      },
      {
        "id": 2,
        "text": "Northern Blotting"
      },
      {
        "id": 3,
        "text": "Western Blotting"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The picture depicts the nothern blotting technique.</p>\n<p><strong><br />Northern</strong> <strong>blotting</strong> is used for detection of <strong>RNA</strong>.</p>\n<p>Other blotting techniques :</p>\n<ul>\n<li><strong>Southern</strong> <strong>blotting</strong> is used for detection of <strong>DNA</strong>.</li>\n<li><strong>Western</strong> <strong>blotting</strong> is used for detection of <strong>protein</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/789dd2f215b44e118fded91514899083.jpeg"
    ],
    "explanation_images": []
  },
  {
    "text": "In the following osmotic fragility curve, \u2018A\u2019 occurs in _________.",
    "choices": [
      {
        "id": 1,
        "text": "Beta thalassemia"
      },
      {
        "id": 2,
        "text": "Sickle-cell anaemia"
      },
      {
        "id": 3,
        "text": "Hereditary spherocytosis"
      },
      {
        "id": 4,
        "text": "Both A and B"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given osmotic fragility curve, the green-shaded region is the normal zone of red blood cell hemolysis. Here, curve A is more towards the left, indicating that RBCs have an <strong>increased osmotic fragility</strong><strong>.\u00a0</strong>When there is an increase in osmotic fragility, hemolysis occurs at a higher concentration of NaCl. <strong>Curve A</strong> signifies a higher concentration of NaCl in this graph which occurs in <strong>hereditary spherocytosis</strong>.</p>\n<p>In thalassemia and sickle-cell\u00a0anemia,\u00a0on the other hand,\u00a0the red cells become more resistant to\u00a0osmotic lysis due to which there is a decrease in osmotic fragility. Hence, the curve\u00a0will\u00a0shift to the right.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1d7e73d1c7de485a97bd29577b3fd529.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The test kit shown in the image below works on the principle of:",
    "choices": [
      {
        "id": 1,
        "text": "ELISA"
      },
      {
        "id": 2,
        "text": "Immunochromatography"
      },
      {
        "id": 3,
        "text": "Immunofluroscence"
      },
      {
        "id": 4,
        "text": "Chemiluminiscence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows a<strong> HbsAg card test kit</strong>&nbsp;which works on the principle of&nbsp;<strong>i</strong><strong>mmunochromatography.</strong></p>\n<div class=\"page\" title=\"Page 762\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>immunochromatographic</strong> <strong>membrane</strong> is used for antigen detection, while a nitrocellulose membrane is used to absorb the antigen from a specimen. A coloured reaction appears directly on the membrane with the sequential addition of conjugate followed by the substrate. In some cases, the antigen is captured by a bound antibody directed against the antigen. These assays have the advantage of being rapid and also frequently include a built-in internal control.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9406c29ddf46469aac441398725963e1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "All are correct about the given device below used along with pMDI (pressurized metered-dose inhaler), except:",
    "choices": [
      {
        "id": 1,
        "text": "Decreases the deposition of drug on the oropharynx"
      },
      {
        "id": 2,
        "text": "Increases the delivery of drug to lower airways"
      },
      {
        "id": 3,
        "text": "Increases the incidence of oropharyngeal candidiasis"
      },
      {
        "id": 4,
        "text": "Systemic absorption of drugs is unaffected"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image is of a <strong>spacer device</strong>. It <strong>decreases</strong> the incidence of oropharyngeal <strong>candidiasis </strong>and other propellant-mediated oropharyngeal adverse effects like dysphonia that occur with the use of a pMDI.</p>\n<p>Spacers reduce the velocity and size of particles entering the upper airways. This <strong>reduces</strong> the <strong>amount</strong> of drug that impinges on the <strong>oropharynx</strong> and <strong>increases</strong> the <strong>proportion of drug inhaled into lower airways.</strong> The<strong> systemic absorption is unchanged by the use of a spacer.</strong></p>\n<p>Spacer devices are useful in delivering inhaled drugs to children who are not able to use a pMDI alone but can also be used by adults for better drug delivery.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2bd3a0001c53481b8b072ec2f393d5da.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The classic signs of asphyxia are no longer considered to be relevant to the diagnosis of asphyxia, due to their absence in many cases of asphyxial death. But, in which  of the following types of asphyxia can one see the most extreme demonstration of these 'classic signs of asphyxia'?",
    "choices": [
      {
        "id": 1,
        "text": "Overlaying"
      },
      {
        "id": 2,
        "text": "Traumatic asphyxia"
      },
      {
        "id": 3,
        "text": "Smothering"
      },
      {
        "id": 4,
        "text": "Ligature strangulation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most extreme demonstration of the 'classic signs of asphyxia' is seen in a case of traumatic asphyxia.</p>\n<p>Classic signs of asphyxia:</p>\n<ul>\n<li>\n<p class=\"p1\">For many years the autopsy diagnosis of an asphyxial death was made by reference to a set of findings that have come to be known as the &lsquo;classic signs of asphyxia&rsquo;.</p>\n</li>\n<li>\n<p class=\"p1\">Unfortunately, it is now quite clear that <strong>most of these signs are so non-specific that little reliance can be placed on them</strong> in the absence of other confirmatory evidence. They are scathingly referred to by Lester Adelson as the &lsquo;obsolete diagnostic quintet&rsquo;.</p>\n</li>\n<li>The four signs are:\n<ol>\n<li>Petechial haemorrhages</li>\n<li>Congestion and edema</li>\n<li>Cyanosis</li>\n<li>Engorgement of the right heart and abnormal fluidity of the blood.</li>\n</ol>\n</li>\n</ul>\n<p>Regarding traumatic asphyxia:</p>\n<ul>\n<li>\n<p class=\"p1\">It means mechanical fixation of the chest.&nbsp;&lsquo;Traumatic asphyxia&rsquo; acts by restricting respiratory movements and thus prevents inspiration.&nbsp;</p>\n</li>\n<li>\n<p class=\"p1\">It provides the most extreme demonstration of the &lsquo;classic signs&rsquo; of asphyxia.</p>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20 yr old male was brought to casualty in unconscious state after a head injury. On examination, CSF rhinorrhea and Battle sign are noted. Which of the following most likely occured to this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Duret haemorrhage"
      },
      {
        "id": 2,
        "text": "Kernohan\u2019s phenomenon"
      },
      {
        "id": 3,
        "text": "Middle cranial fossa fracture"
      },
      {
        "id": 4,
        "text": "Epidural hematoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient with a battle sign, indicates a<strong>&nbsp;skull base fracture</strong> associated with <strong>bruising over mastoid process. Battle sign and CSF rhinorrhea </strong>are features of a <strong>middle cranial fossa fracture.</strong></p>\n<p>Middle cranial fossa fracture&nbsp;is associated with:</p>\n<ul>\n<li>CSF otorrhea or rhinorrhea</li>\n<li>Hemotympanum</li>\n<li>Ossicular disruption</li>\n<li><strong>Battle sign: Bruising behind the ear</strong></li>\n<li>7th and 8th cranial nerve palsies</li>\n</ul>\n<p><strong>CSF rhinorrhea or otorrhea:</strong> Double target sign, a double-ring pattern described with CSF-containing bloody fluid from the ear or nose, when dripped onto paper or linen.</p>\n<p><strong>Double target sign&nbsp;</strong>is seen patients with CSF rhinorrhea. The nasal discharge in a patient with CSF rhinorrhea after head trauma is mixed with blood. When this discharge is&nbsp;<strong>collected on a filter paper,</strong>&nbsp;it shows a double target sign with a<strong>&nbsp;central red spot</strong>&nbsp;and a&nbsp;<strong>peripheral lighter halo</strong>&nbsp;as seen in the image below.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4b81ad47a5644c2d8103e356262e5878x720x631.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c82ff9344d3c4ddb9a29eb5d38231fc1x720x743.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5e6b724be8ef48d39be84db0782ceb04x507x478.PNG"
    ]
  },
  {
    "text": "The following test was done on a patient with squint and the finding noted is shown. What is the defect seen in the left eye?",
    "choices": [
      {
        "id": 1,
        "text": "Exotropia"
      },
      {
        "id": 2,
        "text": "Esophoria"
      },
      {
        "id": 3,
        "text": "Esotropia"
      },
      {
        "id": 4,
        "text": "Exophoria"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The test shown is the <strong>cover - uncover test. </strong>There is<strong> abduction of the eye</strong> with suspected deviation (left eye) on covering the fixing eye (right eye) which suggests <strong>left</strong> <strong>esotropia</strong>.</p>\n<p>This test consists of two parts:</p>\n<ul>\n<li>Cover test</li>\n<li>Uncover test</li>\n</ul>\n<p><strong>Cover Test</strong>: This is used to detect <strong>heterotropia (manifest squint</strong>). Light is first shone and corneal reflections are observed. This is done to assess fixation in the deviating eye. The procedure for testing using an accommodative target and for distance is as follows.</p>\n<ul>\n<li>The patient is asked to fixate on a target straight ahead.</li>\n<li>The eye in which deviation is not suspected is covered first. For example, if a right eye deviation is suspected, the left eye is covered.</li>\n<li>Any movement of the right eye to take up fixation is noted.</li>\n<li>The following are the possible results:</li>\n</ul>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><strong>Movement of the eye</strong></td>\n<td style=\"text-align: center;\"><strong>Suspected defect</strong></td>\n</tr>\n<tr>\n<td>No movements</td>\n<td>Orthotropia/Heterotropia of the covered eye</td>\n</tr>\n<tr>\n<td>Adduction</td>\n<td>Exotropia</td>\n</tr>\n<tr>\n<td>Abduction</td>\n<td>Esotropia</td>\n</tr>\n<tr>\n<td>Downward movement</td>\n<td>Hypertropia</td>\n</tr>\n<tr>\n<td>Upward movement</td>\n<td>Hypotropia</td>\n</tr>\n</tbody>\n</table>\n<p>The test is then repeated for the opposite eye.</p>\n<p><strong>Uncover test:</strong> This is used to detect <strong>heterophoria </strong>(<strong>latent squint</strong>). The test is performed for both near and distant as follows.</p>\n<ul>\n<li>The patient fixates a distant target\u00a0straight ahead.</li>\n<li>The examiner covers an eye for 2-3 seconds and the cover is then removed.</li>\n<li>If the covered eye had deviated, a re-fixation movement is observed on being uncovered.</li>\n<li>The following are the possible results based on the <strong>re-fixation movements</strong> of the eye.</li>\n</ul>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><strong>Movement of the eye</strong></td>\n<td style=\"text-align: center;\"><strong>Suspected defect</strong></td>\n</tr>\n<tr>\n<td>No movements</td>\n<td>Orthophoria</td>\n</tr>\n<tr>\n<td>Adduction (Nasal recovery)</td>\n<td>Exophoria</td>\n</tr>\n<tr>\n<td>Abduction</td>\n<td>Esophoria</td>\n</tr>\n<tr>\n<td>Downward/Upward movement</td>\n<td>Vertical phoria</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>The speed and smoothness of the recovery is noted as well as evidence of the strength of motor fusion.</li>\n<li>The test is then repeated for the opposite eye.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/74281636ebc84224b46060d0e1a6c82b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A medical student  is preparing to do a prospective cohort study for the association of hypertension  with CHD from the general medicine wards. Which of the following must she do?",
    "choices": [
      {
        "id": 1,
        "text": "Exclude  all patients diagnosed with hypertension recently"
      },
      {
        "id": 2,
        "text": "Exclude all the patients on antihypertensive medications"
      },
      {
        "id": 3,
        "text": "Exclude all the  patients with diagnosis of CHD"
      },
      {
        "id": 4,
        "text": "Exclude all the patients diagnosed with hypertension more than 3 years back"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Cohort studies progress from <strong>cause to effect</strong>. Thus, the patients with CHD must be excluded.&nbsp;The study begins before the disease under study has occurred.</p>\n<p><strong>ANALYTICAL EPIDEMIOLOGY</strong></p>\n<p>&nbsp;Analytical studies differ from descriptive studies in that the the subject of interest is the individual within the population whereas in descriptive studies the entire population is studied.&nbsp;</p>\n<p><strong>Analytical studies</strong> includes : <br />&nbsp; &nbsp; &nbsp; (i) Case control study <br />&nbsp; &nbsp; &nbsp; (ii) Cohort study.</p>\n<p>By performing an <strong>analytical</strong> <strong>study</strong> one can find : <br />(i) if a statistical association exists between a disease and a suspected factor or not ; and <br />(ii) if there is one , the strength of the Association.</p>\n<p>&nbsp;Differences between case control and cohort studies:</p>\n<table style=\"width: 584px;\">\n<tbody>\n<tr>\n<td style=\"width: 279.333px;\"><strong>Case control study</strong></td>\n<td style=\"width: 283.667px;\"><strong>Cohort study</strong></td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">1. Proceeds from \"effect to cause\".</td>\n<td style=\"width: 283.667px;\">Proceeds from \"cause to effect\"</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">2. Starts with the disease</td>\n<td style=\"width: 283.667px;\">Starts with people exposed to risk factor or suspected cause.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">3. Tests whether the suspected cause occurs more frequently in those with the disease than among those without the disease.</td>\n<td style=\"width: 283.667px;\">Tests whether disease occurs more frequently in those exposed, than in those not similarly exposed.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">4. Usually the first approach to the testing or a hypothesis, but also useful for exploratory studies.</td>\n<td style=\"width: 283.667px;\">Reserved for testing of precisely formulated hypothesis.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">5. Involves fewer number or subjects</td>\n<td style=\"width: 283.667px;\">Involves larger number of subjects.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">6. Yields relatively quick results.</td>\n<td style=\"width: 283.667px;\">Long follow-up period often needed. involving delayed results.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">7. Suitable for the study of rare diseases.</td>\n<td style=\"width: 283.667px;\">Inappropriate when the disease or exposure under investigation is rare.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">8. Generally yields only estimate of RR (odds ratio).</td>\n<td style=\"width: 283.667px;\">Yields incidence rates, RR as well as AR.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">9. Cannot yield information about diseases other than that selected for study.</td>\n<td style=\"width: 283.667px;\">Can yield information about more than one disease outcome.</td>\n</tr>\n<tr>\n<td style=\"width: 279.333px;\">10. Relatively inexpensive</td>\n<td style=\"width: 283.667px;\">Expensive.</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a component of the global hunger index (GHI)?",
    "choices": [
      {
        "id": 1,
        "text": "Infant mortality rate"
      },
      {
        "id": 2,
        "text": "Under 5 mortality"
      },
      {
        "id": 3,
        "text": "Percentage of undernourished population"
      },
      {
        "id": 4,
        "text": "Percentage of  undernourished children under  5 years"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>infant mortality rate</strong> is <strong>not</strong> a component of the global hunger index.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">The<strong>\u00a0Global Hunger Index (GHI)</strong>\u00a0has <strong>three dimensions. </strong>These dimensions are measured by<strong>\u00a0indicators.\u00a0</strong></p>\n<table style=\"height: 143px;\" width=\"358\">\n<tbody>\n<tr>\n<td style=\"width: 171px;\"><strong>Dimensions</strong></td>\n<td style=\"width: 171px;\"><strong>Indicators</strong></td>\n</tr>\n<tr>\n<td style=\"width: 171px;\">Inadequate food supply</td>\n<td style=\"width: 171px;\">Proportion of the population undernourished</td>\n</tr>\n<tr>\n<td style=\"width: 171px;\">Child mortality</td>\n<td style=\"width: 171px;\">Under 5 mortality rate</td>\n</tr>\n<tr>\n<td style=\"width: 171px;\">Child undernutrition</td>\n<td style=\"width: 171px;\">Wasting in children under 5 years<br />Stunting in children under 5 years</td>\n</tr>\n</tbody>\n</table>\n<p>GHI score = (1/3 X standardized PUN) + (1/6 X standardised CWA) + (1/6 X standardised CST) + (1/3 X Standardised CM)</p>\n<p>Where,</p>\n<ul>\n<li>PUN is the proportion of the population that is undernourished</li>\n<li>CWA is the prevalence of wasting in children under 5 years of age</li>\n<li>CST is the prevalence of stunting in\u00a0children under 5 years of age</li>\n<li>CM is the proportion of children dying under the age of 5 years of age.</li>\n</ul>\n<p>The result lies on a scale from 0 to 100, with 0 meaning no hunger and 100 being the worst score. The GHI is given by the\u00a0<strong>International Food Policy Research Institute</strong>. In 2021, India's GHI was 27.5. It ranks 101 among 116 countries.\u00a0In the\u00a0<a href=\"https://www.globalhungerindex.org/ranking.html\" target=\"_blank\" rel=\"noopener\">2022,</a>India's GHI stands at 29.1, and India ranks\u00a0<strong>107th</strong>\u00a0out of the\u00a0<a href=\"https://www.globalhungerindex.org/ranking.html\" target=\"_blank\" rel=\"noopener\">121 countries.</a></p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following group of individuals would not be targeted under the program represented by the logo shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Men who have sex with men"
      },
      {
        "id": 2,
        "text": "Long-distance truckers"
      },
      {
        "id": 3,
        "text": "Injecting drug users"
      },
      {
        "id": 4,
        "text": "Industrial workers"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>red ribbon&nbsp;</strong>shown is a part of the logo of the&nbsp;<strong>National AIDS Control Organization (NACO) program.&nbsp;</strong>Industrial workers are not included in the target population under NACO.</p>\n<p><strong>Target interventions</strong>&nbsp;for the control of AIDS transmission are done for:</p>\n<ul>\n<li>High-risk groups like sex workers</li>\n<li><strong>Men who have sex with men</strong></li>\n<li>Transgender</li>\n<li><strong>Injecting drug users</strong></li>\n<li><strong>Bridge populations</strong> like migrants and<strong> long-distance truckers</strong></li>\n</ul>\n<p>The services offered through targeted interventions include <strong>detection</strong> and <strong>treatment</strong> for sexually transmitted diseases and condom distribution.</p>\n<p>The <strong>logo</strong> of NACO:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5e4922b3ea6d4338ba7fa1a6260ee37a.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d584cf3d81344b64a0fcb59696537670x537x245.PNG"
    ]
  },
  {
    "text": "During your casualty rotation, you accidentally injure yourself while suturing a patient. You had taken the full schedule of hepatitis B vaccination during your first year of medical school. Which of the following markers will you get measured to determine the need for HBIG administration?",
    "choices": [
      {
        "id": 1,
        "text": "Anti HBeAg"
      },
      {
        "id": 2,
        "text": "IgM Anti HBc"
      },
      {
        "id": 3,
        "text": "IgG Anti HBc"
      },
      {
        "id": 4,
        "text": "Anti HBsAg"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The need for administration of hepatitis B hyperimmune globulin (<strong>HBIG</strong>) in a <strong>previously vaccinated</strong> individual can be determined based on <strong>anti-HBsAg levels</strong>. It is the marker for determining the efficacy of hepatitis B vaccination.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>The complete <strong>hepatitis B vaccine</strong> schedule consists of three<strong>&nbsp;intramuscular doses</strong>&nbsp;at <strong>0, 1, and 6 months</strong>.</p>\n</div>\n</div>\n<p><strong>Post Exposure Prophylaxis:</strong></p>\n<p>The prophylaxis can be done using the hepatitis B vaccine or hepatitis B immunoglobulin (HBIG).</p>\n<table>\n<tbody>\n<tr>\n<td>Vaccination status of the exposed person</td>\n<td>Recommended prophylaxis</td>\n</tr>\n<tr>\n<td>Unvaccinated</td>\n<td>HBIG (0.06 mL/kg) and initiate hepatitis B vaccine series</td>\n</tr>\n<tr>\n<td>Known responder to previous vaccination (<strong>anti-HBs titer&gt;10 mIU/mL</strong>)</td>\n<td>No action required</td>\n</tr>\n<tr>\n<td>Non-responder to previous vaccination (<strong>anti-HBs titer &lt;10 mIU/mL</strong>)</td>\n<td>HBIG: 2 doses (1 month apart)&nbsp;OR&nbsp;HBIG: 1 dose + initiate hepatitis B revaccination.</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 22-year old man presents with diarrhea and intolerance to dairy products. On investigation, he was found to have a lactase deficiency. Which of the following agents is least likely to cause symptoms of lactose intolerance?",
    "choices": [
      {
        "id": 1,
        "text": "Condensed Milk"
      },
      {
        "id": 2,
        "text": "Skimmed Milk"
      },
      {
        "id": 3,
        "text": "Yoghurt"
      },
      {
        "id": 4,
        "text": "Ice Cream"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Yoghurt</strong> is least likely to cause symptoms of lactose intolerance. It contains<strong> bacteria that produce lactase</strong> and is generally well tolerated.</p>\n<p><strong>Lactase </strong>is a brush border enzyme that <strong>hydrolyzes lactose into glucose and galactose</strong>. In lactase deficiency, patients have great variability in clinical symptoms, depending on both the severity of lactase deficiency and the amount of lactose ingested.</p>\n<p>The goal of treatment in patients with isolated lactase deficiency is achieving patient comfort through the elimination of dietary lactose.</p>\n<p>Foods that are high in lactose include milk (12 g/cup), ice cream (9 g/cup) and cottage cheese (8 g/cup). Aged cheese has lower lactose content. Most people can tolerate up to <strong>12g of lactose a day</strong> without significant symptoms.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old woman presents with recurrent paranasal sinus pain and occasional hemoptysis. Laboratory investigations reveal elevated ESR and red cell casts in the urine. Serology is positive for cANCA. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Goodpasture's syndrome"
      },
      {
        "id": 2,
        "text": "Granulomatosis with polyangiitis"
      },
      {
        "id": 3,
        "text": "Microscopic polyangiitis"
      },
      {
        "id": 4,
        "text": "Henoch-Schonlein pupura"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis is <strong>granulomatosis with polyangiitis </strong>(Wegener's granulomatosis). The patient shows the involvement of the upper respiratory tract (sinusitis), lower respiratory tract (occasional hemoptysis), renal system (red cell casts), and the presence of cANCA antibodies.</p>\n<p>It is a <strong>granulomatous, necrotizing vasculitis</strong> of the small vessels which mainly affects</p>\n<ul>\n<li><strong>Upper respiratory tract- </strong>presenting with&nbsp;sinusitis, otitis media, and nasal septal perforation</li>\n<li><strong>Lower respiratory tract</strong>- presenting with hemoptysis</li>\n<li><strong>Renals (glomerulonephritis)</strong>- presenting with proteinuria, hematuria, and hypertension.</li>\n</ul>\n<p>Apart from these organs, the disease can also affect the eye and skin. Skin lesions present as palpable purpura or subcutaneous nodules. Laboratory investigations show <strong>anemia</strong>, leucocytosis, elevated ESR, and <strong>cANCA positivity.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old sustained a crush injury and he says his urine is brownish in colour. On investigation, his urine/plasma creatinine levels were <20. What could be the possible cause?",
    "choices": [
      {
        "id": 1,
        "text": "Rhabdomyolysis"
      },
      {
        "id": 2,
        "text": "Congestive heart failure"
      },
      {
        "id": 3,
        "text": "UTI"
      },
      {
        "id": 4,
        "text": "Hypovolemia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A history of crush injury along with brownish urine and urine/plasma creatinine ratio of <strong>&lt;20</strong> is observed in <strong>renal AKI</strong>, which can be caused by <strong>rhabdomyolysis&nbsp;</strong>in this case.</p>\n<p><strong>Rhabdomyolysis</strong>&nbsp;is a serious life-threatening condition that involves a rapid breakdown of damaged skeletal muscle cells due to direct or indirect injury. Muscle breakdown causes the release of myoglobin, which contains heme into the bloodstream, causing heme pigment nephropathy. The heme pigment can cause direct PCT injury and vasoconstriction leading to fractional excretion of sodium(FENa)less than 1. Pigmented granular cast precipitates in the tubule causing oliguria and renal failure.</p>\n<div class=\"page\" title=\"Page 2149\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Causative factors</strong>&nbsp;include:</p>\n<ul>\n<li>Traumatic crush injuries</li>\n<li>Muscle ischemia during vascular or orthopaedic surgery</li>\n<li>Compression during coma or immobilization</li>\n<li>Prolonged seizure activity</li>\n<li><strong>Excessive or strenuous exercise</strong></li>\n<li>Heatstroke or malignant hyperthermia</li>\n<li>Infections</li>\n<li>Metabolic disorders such as hypophosphatemia or severe hypothyroidism</li>\n<li>Myopathies (drug-induced, metabolic, or inflammatory)</li>\n</ul>\n<p>Skeletal muscle damage causes excessive release of myoglobin, which acts as an endogenous toxin and can cause acute renal failure.</p>\n<p>Laboratory features include&nbsp;<strong>elevated</strong>&nbsp;<strong>myoglobin</strong>,&nbsp;<strong>creatine</strong>&nbsp;<strong>kinase</strong>. Hematuria on dipstick examination without red cells indicates the presence of&nbsp;<strong>myoglobin.</strong></p>\n<p>The treatment includes <strong>administration of large amounts of fluid</strong> (5-6 liters), alkalization of urine, and hemodialysis.&nbsp;</p>\n</div>\n</div>\n</div>\n<p>The rest of the options include causes of <strong>prerenal AKI</strong>, wherein the urine/plasma creatinine is <strong>&gt;40</strong>.</p>\n<table style=\"width: 498.0625px;\">\n<tbody>\n<tr style=\"height: 36px;\">\n<td style=\"width: 119px; text-align: center; height: 36px;\">&nbsp;</td>\n<td style=\"width: 111px; text-align: center; height: 36px;\"><strong><span style=\"font-size: 14pt;\">Pre renal&nbsp;</span></strong></td>\n<td style=\"width: 125px; text-align: center; height: 36px;\"><strong><span style=\"font-size: 14pt;\">Renal</span></strong></td>\n<td style=\"width: 127.0625px; text-align: center; height: 36px;\"><strong><span style=\"font-size: 14pt;\">Post renal</span></strong></td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 119px; text-align: center; height: 36px;\"><strong>Urine osmolality</strong></td>\n<td style=\"width: 111px; text-align: center; height: 36px;\">&gt;500 mOsm/kg</td>\n<td style=\"width: 125px; text-align: center; height: 36px;\">&lt;350mOsm/kg</td>\n<td style=\"width: 127.0625px; text-align: center; height: 36px;\">&lt; 400 mOsm/kg</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 119px; text-align: center; height: 18px;\"><strong>Urine Na</strong></td>\n<td style=\"width: 111px; text-align: center; height: 18px;\">&lt;20 meq/l</td>\n<td style=\"width: 125px; text-align: center; height: 18px;\">&gt;40meq/l</td>\n<td style=\"width: 127.0625px; text-align: center; height: 18px;\">Variable</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 119px; text-align: center; height: 18px;\"><strong>FeNa</strong></td>\n<td style=\"width: 111px; text-align: center; height: 18px;\">&lt;1</td>\n<td style=\"width: 125px; text-align: center; height: 18px;\">&gt;2</td>\n<td style=\"width: 127.0625px; text-align: center; height: 18px;\">Variable</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 119px; text-align: center; height: 54px;\"><strong>Urine creatinine/plasma creatinine</strong></td>\n<td style=\"width: 111px; text-align: center; height: 54px;\">&gt;40:1</td>\n<td style=\"width: 125px; text-align: center; height: 54px;\">&lt;20:1</td>\n<td style=\"width: 127.0625px; text-align: center; height: 54px;\">&lt;20:1</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 119px; text-align: center; height: 18px;\"><strong>BUN: Creatinine&nbsp;</strong></td>\n<td style=\"width: 111px; text-align: center; height: 18px;\">&gt;20:1</td>\n<td style=\"width: 125px; text-align: center; height: 18px;\">&lt;20:1</td>\n<td style=\"width: 127.0625px; text-align: center; height: 18px;\">&gt;20:1</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 119px; text-align: center; height: 36px;\"><strong>Urine microscopy&nbsp;</strong></td>\n<td style=\"width: 111px; text-align: center; height: 36px;\">Hyaline</td>\n<td style=\"width: 125px; text-align: center; height: 36px;\">Muddy brown cast</td>\n<td style=\"width: 127.0625px; text-align: center; height: 36px;\">Normal or RBC/WBC</td>\n</tr>\n</tbody>\n</table>\n<p>Causes of AKI are given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76476eed79574f06ab76a65c33a32508x1280x2027.JPEG"
    ]
  },
  {
    "text": "The complications associated with refeeding syndrome are:",
    "choices": [
      {
        "id": 1,
        "text": "1 and 3"
      },
      {
        "id": 2,
        "text": "2 and 4"
      },
      {
        "id": 3,
        "text": "1, 2, and 4"
      },
      {
        "id": 4,
        "text": "1, 2, 3, and 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Hypomagnesemia and hypophosphatemia, both occur in refeeding syndrome.</p>\n<p>1 and 3 are false as, <strong>hypokalemia </strong>and hypocalcemia (NOT hyper), are complications of refeeding syndrome.</p>\n<p><strong>Refeeding syndrome </strong>is a <strong>fatal</strong> condition that can occur with <strong>rapid and excessive feeding</strong> of patients with <strong>severe underlying malnutrition</strong> which may be due to:</p>\n<ul>\n<li>Starvation</li>\n<li>Alcoholism</li>\n<li>Delayed nutritional support</li>\n<li>Anorexia nervosa</li>\n<li>Massive weight loss in obese patients</li>\n</ul>\n<p>It can occur with either <strong>enteral or parenteral nutrition</strong>, but is more common with the latter.</p>\n<p>With excessive refeeding, there is a <strong>shift in metabolism from fat to carbohydrate</strong> substrate which stimulates <strong>excessive insulin release</strong>. As a result, there is an increase in the cellular uptake of electrolytes, particularly phosphate, magnesium, potassium, and calcium.</p>\n<p>Hence the metabolic abnormalities include:</p>\n<ul>\n<li>Hypophosphatemia</li>\n<li>Hypomagnesemia</li>\n<li>Hypokalemia</li>\n<li>Hypocalcemia</li>\n</ul>\n<p>These electrolyte disorders can result in myocardial infarction, arrhythmias, respiratory dysfunction, liver dysfunction, seizures, confusion, coma, tetany, and death.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6bb423d5c92b4744bc6332800da0e0e0x899x529.PNG"
    ]
  },
  {
    "text": "A neonate presented with mild intermittent upper abdominal pain.On examination, the infant has a scaphoid abdomen and breath sounds are decreased on both sides. X-ray is given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Bochdalek hernia"
      },
      {
        "id": 2,
        "text": "Pneumonia"
      },
      {
        "id": 3,
        "text": "Gastric volvulus"
      },
      {
        "id": 4,
        "text": "Eventration of diaphragm"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical picture of respiratory distress, intermittent abdominal pain, scaphoid abdomen, absent breath sounds in both sides of the chest, and an X-ray image showing bowel loops in the thoracic cavity is diagnostic of <strong>congenital diaphragmatic hernia</strong> (CDH), the most common variant being <strong>Bochdalek hernia</strong>.</p>\n<p>If the defect is posterolateral it is called&nbsp;<strong>Bochdalek hernia&nbsp;</strong>and if it's anteromedial it is called<strong>&nbsp;Morgagni hernia.&nbsp;</strong></p>\n<p>Clinical features :</p>\n<ul>\n<li><strong>Respiratory distress</strong>&nbsp;is a cardinal sign in infants with a congenital diaphragmatic hernia (CDH).</li>\n<li><strong>Early respiratory distress, within 6 hr after birth, is thought to be a poor prognostic sign</strong>.</li>\n<li>Children with CDH may also have a&nbsp;<strong>scaphoid abdomen and increased chest wall diameter.</strong></li>\n<li>Bowel sounds may also be heard in the chest, with a&nbsp;<strong>bilateral&nbsp;decrease in breath sounds.</strong></li>\n<li>The point of maximal cardiac impulse may be displaced away from the side of a hernia if a&nbsp;<strong>mediastinal shift</strong>&nbsp;has occurred.</li>\n<li><strong>Retroperitoneal fat, left kidney, spleen&nbsp;</strong>or only the omentum commonly herniates through the defect. If the defect is large, most abdominal contents including the stomach may herniate.</li>\n</ul>\n<p><strong>Diagnosis:</strong></p>\n<ul>\n<li>Chest radiography and passage of a nasal gastric tube confirm the diagnosis.</li>\n<li>CDH can be diagnosed on&nbsp;<strong>prenatal ultrasonography (between 16 and 24 weeks of gestation)</strong></li>\n<li>High-speed fetal magnetic resonance imaging (MRI) can further define the lesion.</li>\n</ul>\n<p><strong>Differential</strong>&nbsp;<strong>diagnosis</strong>:</p>\n<ul>\n<li>Diaphragmatic eventration</li>\n<li>Cystic adenomatoid malformation</li>\n<li>Bronchogenic cyst</li>\n<li>Cystic teratoma</li>\n</ul>\n<p><strong>Treatment:</strong></p>\n<p>Variable period of time (24-72 hours) to allow for stabilization before surgical repair. Immediate respiratory support should be provided, including rapid endotracheal intubation and sedation.&nbsp;</p>\n<p>Bag and Mask Ventilation&nbsp;is&nbsp;<strong>contraindicated&nbsp;</strong>in newborns with congenital diaphragmatic hernia because it&nbsp;causes&nbsp;<strong>distension of the stomach</strong>&nbsp;which in turn may limit the expansion of the already&nbsp;<strong>hypoplastic lung</strong>.</p>\n<p>During surgery, the viscera are reduced into the abdominal cavity, and the posterolateral defect in the diaphragm is closed using interrupted, nonabsorbable sutures.</p>\n<p>In most cases (80%-90%), a hernia sac is not present. If identified, it is excised at the time of repair.</p>\n<p>Conventional mechanical ventilation, high-frequency oscillatory ventilation (HFOV), and extracorporeal membrane oxygenation (<strong>ECMO</strong>) are the 3 main strategies to support respiratory failure in the newborn with CDH.</p>\n<p><strong>Good relative indicators</strong>&nbsp;of stability are as follows:</p>\n<ul>\n<li>Requirement for conventional ventilation only</li>\n<li>Low peak inspiratory pressure</li>\n<li><strong>Fi-O2 &lt;50</strong></li>\n</ul>\n<p>If the defect is&nbsp;<strong>too large</strong>, a porous polytetrafluoroethylene (Gore-Tex)<strong>&nbsp;patch</strong>&nbsp;is used.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7349b93237e14ea7a25033d0b8a688c8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9d01b2e105de478fabb683ccb45bc149x1280x1660.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e88016b5d7e345ffb33922a35e0b9a08x468x450.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/97213a6b824346bebf418955ba37f97fx512x402.PNG"
    ]
  },
  {
    "text": "Identify the imaging modality.",
    "choices": [
      {
        "id": 1,
        "text": "Retrograde pyelogram"
      },
      {
        "id": 2,
        "text": "Retrograde urethrogram"
      },
      {
        "id": 3,
        "text": "Intravenous pyelography"
      },
      {
        "id": 4,
        "text": "Antegrade pyelography"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image depicts a <strong>retrograde pyelogram. </strong></p>\n<p>Retrograde Pyelogram is particularly valuable when<strong> IVP/CT is contraindicated </strong>and excels at providing detailed imaging of the <strong>collecting system, especially for evaluating ureteral strictures</strong> and <strong>filling defects</strong>, making it especially useful in surgical planning.\u00a0</p>\n<p>Other Options:</p>\n<p>Option B: In <strong>Retrograde urethrogram,</strong> the urethra is visualized with the instillation of contrast into the anterior urethra (penile urethra and bulbar urethra). It helps diagnose <strong>anterior urethral abnormalities.</strong> The following image shows an image of retrograde urethrogram contrast leakage at the <strong>membranous urethra.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/332be08ddd9940b6bd594e4a745b0603.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3c0107c7e17146ceb791c463d277f57ax720x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bd6beebe22594cdfb4908f7b74a1b670x720x964.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/67031746ef214b3ca5e3fd541b607d41x452x547.JPEG"
    ]
  },
  {
    "text": "A young male patient presents with pain during defecation along with the presence of blood-streaked stools. He has had a history of constipation for 5 months. On examination, a sentinel tag is present at the anal orifice. Due to extreme pain, a digital rectal examination is avoided. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fistula in ano"
      },
      {
        "id": 2,
        "text": "Anal fissure"
      },
      {
        "id": 3,
        "text": "Hemorrhoids"
      },
      {
        "id": 4,
        "text": "Rectal prolapse"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This case scenario with a history of chronic constipation, and the presence of sentinel tags on examination, suggests a diagnosis of&nbsp;<strong>anal fissure</strong>.</p>\n<div class=\"page\" title=\"Page 1372\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>An anal fissure is a longitudinal split in the anoderm of the distal anal canal. A chronic anal fissure frequently is associated with :</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li><strong>Sentinel tag </strong>externally</li>\n<li>Hypertrophied <strong>anal papillae</strong>&nbsp;internally</li>\n<li>Anal ulcer overlying the internal sphincter</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d14f8c599baf44dc9dfa86d317a3f99cx1280x1429.JPEG"
    ]
  },
  {
    "text": "A male had a vasectomy 1 month ago and the couple asks the doctor if they have to take any precautions while having sex. What advice should be given?",
    "choices": [
      {
        "id": 1,
        "text": "Oral contraceptive pills for 1 month for the woman"
      },
      {
        "id": 2,
        "text": "Use condoms for 3 months"
      },
      {
        "id": 3,
        "text": "No special advice"
      },
      {
        "id": 4,
        "text": "Hormonal treatment given for 2 more months for the man"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The best advice is to <strong>use condoms for 3 months</strong> as the sperms are stored in the reproductive tract for upto 3 months.&nbsp;</p>\n<p><strong>Vasectomy</strong></p>\n<ul>\n<li>Vasectomy consists of dividing the vas deferens and disrupting the passage of sperms.</li>\n<li>It is done through a small incision in the scrotum, under local anesthesia. The sterility is not immediate. The sperms are stored in the reproductive tract for up to 3 months. The couple must therefore abstain from intercourse during this period or use other methods of contraception.</li>\n<li>Approximately, 20 ejaculates clear the semen of all sperms. Two semen analysis reports must confirm the absence of sperms before the man can be declared sterile.</li>\n<li><strong>No-scalpel technique</strong> has been now adopted. One single incision is made with a special forceps, and skin stitch is not required. Clips and plugs can be applied over the vas instead of cutting. Vasectomy is cheaper than tubectomy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 11-year-old girl is evaluated using Tanner's staging. The breast is elevated like a small mound, with the appearance of pigmented hair sparsely over the labia, either long or slightly curved. This is given as ______ stage.",
    "choices": [
      {
        "id": 1,
        "text": "Tanners 2"
      },
      {
        "id": 2,
        "text": "Tanners 3"
      },
      {
        "id": 3,
        "text": "Tanners 4"
      },
      {
        "id": 4,
        "text": "Tanners 5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This girl has stage 2 according to Tanner's staging</p>\n<ul>\n<li>Initial development of breast and pubic hairs is given by Tanners 1 and 2.&nbsp;</li>\n<li>Tanners 4 &amp; 5 refer to advance stages of breast and pubic hair development.</li>\n</ul>\n<p><strong>Tanners stages describe pubertal changes&nbsp;</strong></p>\n<table style=\"width: 622px;\">\n<tbody>\n<tr>\n<td style=\"width: 62px;\">Tanners&nbsp;</td>\n<td style=\"width: 295px;\">Breast changes&nbsp;</td>\n<td style=\"width: 249px;\">Pubic hair changes&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 62px;\">Stage 1</td>\n<td style=\"width: 295px;\">\n<div>\n<div>\n<div>\n<p>Denotes the prepubertal breast. At this infantile stage, only the papilla is elevated.</p>\n</div>\n</div>\n</div>\n&nbsp;<strong>(B1)</strong></td>\n<td style=\"width: 249px;\">No pubic hair <strong>(P1)</strong></td>\n</tr>\n<tr>\n<td style=\"width: 62px;\">Stage 2</td>\n<td style=\"width: 295px;\">\n<div>\n<div>\n<div>\n<p>Denotes thelarche. The breast buds are palpable, areola enlarges and the breast is elevated like a small mound <strong>(B2)</strong></p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 249px;\">The appearance of pigmented hair sparsely over the labia, either long or slightly curved&nbsp;<strong>(P2)</strong></td>\n</tr>\n<tr>\n<td style=\"width: 62px;\">Stage 3</td>\n<td style=\"width: 295px;\">\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<p>There is further enlargement of the breast and its areola without separation of its contours <strong>(B3)</strong></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 249px;\">Darker coarser and curly hair <strong>(P3)</strong></td>\n</tr>\n<tr>\n<td style=\"width: 62px;\">Stage 4</td>\n<td style=\"width: 295px;\">\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<p>Preferential growth of the areola and nipple leads to formation of a secondary mound over the mound of the breast <strong>(B4)</strong></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 249px;\">Preadult stage cover short inverted triangular distribution <strong>(P4)</strong></td>\n</tr>\n<tr>\n<td style=\"width: 62px;\">Stage 5</td>\n<td style=\"width: 295px;\">\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<div>\n<p>Formation of the mature adult breast <strong>(B5)</strong></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 249px;\">&nbsp;Adult inverted triangular distributuion&nbsp;<strong>(P5)</strong></td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4461f6d2bc3446ec92575cf5709f7508x1280x3776.JPEG"
    ]
  },
  {
    "text": "A 26-year-old female patient with a history of two-second trimester abortions presents to the OG clinic with 6 weeks of amenorrhea and a positive UPT. She was diagnosed to have cervical incompetence after the previous abortion.  What is the best timing to do prophylactic cerclage in this patient______",
    "choices": [
      {
        "id": 1,
        "text": "4-6 weeks"
      },
      {
        "id": 2,
        "text": "8- 10 weeks"
      },
      {
        "id": 3,
        "text": "12-14 weeks"
      },
      {
        "id": 4,
        "text": "18-20 weeks"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Prophylactic cervical cerclage is done between <strong>12 to 14 weeks gestation.</strong></p>\n<p>The timing of surgery depends on clinical circumstances.&nbsp;</p>\n<ul>\n<li><strong>Elective cerclage</strong>(based on previous obstetric outcomes) is usually done between <strong>12 and 14 weeks</strong> gestation.</li>\n<li>If the diagnosis is made in high-risk women using transvaginal sonography to document cervical shortening &lt; 25 mm, then therapeutic cerclage is done at that time.</li>\n<li>For the remainder who undergo <strong>emergency rescue cerclage</strong>, it can be done <strong>until 24 weeks of gestation.&nbsp;</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A newborn child born to a mother with sickle cell disease is to be screened for sickle cell anaemia. Which of the following tests can be used?",
    "choices": [
      {
        "id": 1,
        "text": "Hemoglobin electrophoresis"
      },
      {
        "id": 2,
        "text": "High-performance liquid chromatography"
      },
      {
        "id": 3,
        "text": "Heel-prick Guthrie test"
      },
      {
        "id": 4,
        "text": "Tandem mass spectrometry"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>High-performance liquid chromatography</strong> (HPLC) is used for newborn screening of sickle cell anaemia and thalassemia.</p>\n<p>Other options:</p>\n<ul>\n<li><strong>Haemoglobin electrophoresis</strong> is the <strong>confirmatory test</strong> for sickle cell anaemia and other <strong>hemoglobinopathies</strong>. e.g., thalassemia</li>\n<li>Heel-prick <strong>Guthrie test</strong> is the neonatal screening test for <strong>phenylketonuria</strong>.</li>\n<li><strong>Tandem mass spectrometry</strong>&nbsp;is being used for neonatal&nbsp;screening&nbsp;of inherited<strong> metabolic&nbsp;disorders.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The fracture seen in the Xray given below is?",
    "choices": [
      {
        "id": 1,
        "text": "Galeazzi's fracture"
      },
      {
        "id": 2,
        "text": "Monteggia fracture"
      },
      {
        "id": 3,
        "text": "Smith's fracture"
      },
      {
        "id": 4,
        "text": "Colles' fracture"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The X-ray reveals an oblique fracture in the lower third of radius with dislocation of the distal radio-ulnar joint, which is suggestive of&nbsp;<strong>Galeazzi's fracture.&nbsp;</strong></p>\n<p>In Galeazzi's fracture, the r<span class=\"notion-enable-hover\" data-token-index=\"0\" data-reactroot=\"\">adial bone is fractured</span>&nbsp;at the junction of&nbsp;<span class=\"notion-enable-hover\" data-token-index=\"2\" data-reactroot=\"\">middle and distal third</span>&nbsp;with <span class=\"notion-enable-hover\" data-token-index=\"4\" data-reactroot=\"\">subluxation or dislocation of</span> <span class=\"notion-enable-hover\" data-token-index=\"4\" data-reactroot=\"\">distal radio-ulnar joint</span>.&nbsp;</p>\n<p>Complications include :</p>\n<ul>\n<li>Malunion</li>\n<li>Nonunion</li>\n<li>Entrapment of extensor carpi ulnaris tendon in distal radio-ulnar joint</li>\n</ul>\n<p>Option B:<strong> Monteggia fracture:&nbsp;</strong>It is the fracture of shaft of ulna with dislocation of proximal radio-ulnar joint</p>\n<p>Option C: <strong>Smith's fracture:&nbsp;</strong>It is also known as \"Reverse Colle's fracture\". It is the fracture of the distal radius with palmar angulation of the distal bone fragment.</p>\n<p>Option D: <strong>Colle's fracture:&nbsp;</strong>It is the fracture of the distal radius with dorsal angulation of the distal bone fragment.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/80e332632610484d87cef360f5793d4e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Five days after giving birth to a healthy baby, 29-year-old Rita is experiencing moodiness, tearfulness, and lack of energy. You counsel her and provide her with a booklet educating her on postpartum blues. How long should her symptoms persist before she should be evaluated for postpartum depression?",
    "choices": [
      {
        "id": 1,
        "text": "1 week"
      },
      {
        "id": 2,
        "text": "2 months"
      },
      {
        "id": 3,
        "text": "1 month"
      },
      {
        "id": 4,
        "text": "2 weeks"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The patient should be evaluated for postpartum depression if her symptoms last longer than <strong>2 weeks.</strong></p>\n<p><strong>Postpartum blues</strong> is common in mothers in the puerperal period. It is characterized by <strong>transient</strong> mood disturbances like a labile mood, sadness, and subjective confusion. It is thought to be due to changes in hormone levels, the stress of childbirth, and anxiety about the responsibilities of motherhood.&nbsp;Treatment is nothing more than <strong>education and support, </strong>however, symptoms lasting longer than 2 weeks should be evaluated for postpartum depression.</p>\n<p><strong>Postpartum depression</strong> is characterized by a depressed mood, excessive anxiety, insomnia, anhedonia, and a change in weight, usually within the first 12 weeks postpartum. There may be associated thoughts of suicide or of harming the baby, which is not present in postpartum blues.</p>\n<p><strong>Postpartum psychosis</strong> (or puerperal psychosis),&nbsp;is a psychotic disorder that may occur in women who have recently delivered a baby. It is characterized by depression, delusions, and thoughts of harming either herself or her infant.&nbsp; Such ideation of suicide or infanticide should be carefully monitored. It is listed as a&nbsp;subtype of bipolar disorder in DSM-5.</p>\n<div class=\"page\" title=\"Page 858\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 858\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The onset of psychotic symptoms is usually preceded by insomnia, restlessness, agitation, lability of mood, and mild cognitive deficits. Later, suspiciousness, confusion, incoherence, irrational statements, and obsessive thoughts about the baby's health and welfare develop. The mean time of onset is usually within the first 2-3 weeks following delivery, although it can occur in the first few days. Subsequent pregnancies are associ&shy;ated with an increased risk of a second episode.</p>\n<p>Postpartum psychosis is a psychiatric emergency. The treatment of choice involves antipsychotics and lithium, with an antidepressant.&nbsp;<br />Suicidal patients require admission to a psy&shy;chiatric unit.&nbsp;The mother is allowed supervised contact with her baby if she desires. Psychother&shy;apy is indicated after the period of acute psychosis.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The type of laryngoscope blade shown in the given image is:",
    "choices": [
      {
        "id": 1,
        "text": "Miller"
      },
      {
        "id": 2,
        "text": "Magill"
      },
      {
        "id": 3,
        "text": "Macintosh"
      },
      {
        "id": 4,
        "text": "McCoy\u2019s"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows Miller laryngoscopic blade.</p>\n<p><strong>Miller</strong>&nbsp;is a&nbsp;<strong>straight blade </strong>laryngoscope,&nbsp;used in:</p>\n<ul>\n<li>Neonates, infants and young children</li>\n<li>Adults with short thyromental distance and long floppy epiglottis.</li>\n</ul>\n<p>Laryngoscopic blades can be</p>\n<ul>\n<li><strong>Straight blade, Miller</strong></li>\n<li><strong>Curved blade, Macintosh</strong></li>\n</ul>\n<p>Advantage of curved blade:</p>\n<ul>\n<li>Greater room available for the passage for an endotracheal tube</li>\n<li>Less damage to the teeth</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b13e0c9d5b8d4e8eb3fc85e6056ac631.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94f7e038c4754c97b5e546a52508b556x1024x700.jpeg"
    ]
  },
  {
    "text": "A baby is brought to the hospital with the following lesions on the body. The lesion started 2 days ago and has increased in number. Similar lesions are also present on the lower limbs. Examination of the oral cavity also has similar lesions. Which of the following infection most commonly proceeds with this skin condition?",
    "choices": [
      {
        "id": 1,
        "text": "Herpes simplex"
      },
      {
        "id": 2,
        "text": "Varicella"
      },
      {
        "id": 3,
        "text": "Variola"
      },
      {
        "id": 4,
        "text": "Mumps"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows <strong>target lesions&nbsp;</strong>that are seen in <strong>erythema multiforme.&nbsp;</strong>Infection with <strong>Herpes simplex</strong> commonly proceeds with this skin condition.</p>\n<p>Erythema Multiforme is a<strong>&nbsp;self\u2010limiting cytotoxic dermatitis</strong>&nbsp;resulting from cell\u2010mediated hypersensitivity most commonly to infection or drugs.</p>\n<p>The common triggers are</p>\n<ul>\n<li><strong>Herpes simplex infection</strong></li>\n<li>Mycoplasma infection</li>\n<li>Bacterial infections</li>\n<li>Fungal infections</li>\n<li>Vaccinations</li>\n<li>Malignancy: carcinoma, lymphoma, leukemia</li>\n<li>Drug reactions: sulfonamides, cotrimoxazole, penicillins</li>\n<li>Miscellaneous: Lupus erythematosus (Rowell Syndrome), Sarcoidosis, Polyarteritis Nodosa</li>\n</ul>\n<p>It presents clinically with macular, popular, or urticarial lesions, along with the&nbsp;<strong>classic acral iris</strong>&nbsp;or&nbsp;<strong>target lesions</strong>. The lesions are distributed on the distal extremities, palms or trunk, and oral and genital mucous membranes.</p>\n<p>Target lesions are less than 3 cm in diameter, rounded, and have&nbsp;<strong>three</strong>&nbsp;zones:</p>\n<ul>\n<li>The central area of&nbsp;<strong>dusky erythema</strong>&nbsp;or purpura</li>\n<li>Middle paler zone of&nbsp;<strong>edema</strong></li>\n<li>The outer ring of&nbsp;<strong>erythema</strong>&nbsp;with a well\u2010defined edge</li>\n</ul>\n<p>Atypical lesions will have only 2 zones. They fade in <strong>1-2 weeks</strong> leaving dusky <strong>discoloration.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/92215aaded444c68936c0288c69f764d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the diagnosis based on the image shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Hydatid cysts"
      },
      {
        "id": 2,
        "text": "Bladder stones"
      },
      {
        "id": 3,
        "text": "Schistosomiasis"
      },
      {
        "id": 4,
        "text": "Bladder cancer"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The X-ray gives the diagnosis of bladder stones. The tip of a catheter can also be seen in the Xray.</p>\n<p><strong>Primary bladder stone</strong>:</p>\n<ul>\n<li>Develops in <strong>sterile urine</strong> in the absence of any known functional, anatomic, or infectious factors and does not necessarily imply that stones have formed de novo in the bladder.</li>\n<li><strong>Most common in children</strong> younger than 10 years of age</li>\n<li>Most vesical calculi are mixed</li>\n<li>Ammonium acid urate, calcium oxalate, uric acid, and calcium phosphate are the most common components of primary bladder calculi</li>\n</ul>\n<p><strong>Secondary bladder stone</strong>: Forms&nbsp;during infection, due to bladder outflow obstruction, impaired bladder emptying, or the presence&nbsp;of a foreign body.</p>\n<p><strong>Types:</strong></p>\n<ul>\n<li><strong>Calcium oxalate</strong> stones</li>\n<li><strong>Uric acid</strong> stones - occur in patients with<strong> gout</strong> but are also observed in patients with ileostomies or with bladder outlet obstruction</li>\n<li><strong>Cystine</strong> stones - in cystinuria</li>\n<li><strong>Triple phosphate</strong> stones - occur in urine infected with <strong>urea-splitting organisms</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/92c3ccf6162a4cdb89faede2dc02bc15.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "All among the following are ionizing radiations except ______",
    "choices": [
      {
        "id": 1,
        "text": "Alpha rays"
      },
      {
        "id": 2,
        "text": "Beta rays"
      },
      {
        "id": 3,
        "text": "X-rays"
      },
      {
        "id": 4,
        "text": "MRI"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>MRI is a technique that produces topographic images by means of <strong>magnetic fields </strong>and <strong>radiofrequency waves.</strong></li>\n<li>MRI is based on the ability of a small number of protons within the body to absorb and emit radio wave energy when the body is placed within a strong magnetic field. &nbsp;</li>\n<li>Alpha, beta, gamma, and x-rays are ionizing radiations. Alpha and beta rays are <strong>particulate radiation</strong> (Particles) whereas gamma and x-rays are <strong>electromagnetic rays</strong> (No mass).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test- 21';
        const quizFilename = 'mini-test-21-0cd4d03b.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>