<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05 Conjunctiva - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Ophthalmology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">29</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following characteristic features would you expect to see in a histopathology slide of conjunctiva?",
    "choices": [
      {
        "id": 1,
        "text": "Amacrine cells within\u00a0non-keratinized stratified squamous\u00a0epithelium"
      },
      {
        "id": 2,
        "text": "Goblet cells within\u00a0non-keratinized stratified squamous\u00a0epithelium"
      },
      {
        "id": 3,
        "text": "Goblet cells within keratinized stratified squamous\u00a0epithelium"
      },
      {
        "id": 4,
        "text": "Amacrine cells within keratinized stratified squamous\u00a0epithelium"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The presence of <strong>goblet cells</strong>\u00a0within the\u00a0<strong>non-keratinized stratified squamous</strong><strong>\u00a0epithelium </strong>would help identify the<strong> conjunctiva. </strong>Goblet cells are involved in the secretion of mucin.</p>\n<p><strong>Amacrine cells</strong> are a type of retinal interneuron, and hence would be found in the retina, not the conjunctiva.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the causative organism of angular conjunctivitis?",
    "choices": [
      {
        "id": 1,
        "text": "Moraxella lacunata"
      },
      {
        "id": 2,
        "text": "Haemophilus influenzae"
      },
      {
        "id": 3,
        "text": "Adeno virus type 32"
      },
      {
        "id": 4,
        "text": "Coxackie B virus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<table style=\"height: 161.594px; border-color: #000000;\" width=\"677\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 330.5px; height: 22.3984px;\"><span style=\"font-size: 10pt;\"><strong>Conjunctivitis type</strong></span></td>\n<td style=\"width: 330.5px; height: 22.3984px;\"><span style=\"font-size: 10pt;\"><strong>Adenovirus serotype</strong></span></td>\n</tr>\n<tr style=\"height: 30.3984px;\">\n<td style=\"width: 330.5px; height: 30.3984px;\">\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 10pt;\">Follicular Conjunctivitis</span></p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 330.5px; height: 30.3984px;\">\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 10pt;\">Adenovirus serotypes 1-11 and 19</span></p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 54.3984px;\">\n<td style=\"width: 330.5px; height: 54.3984px;\">\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 10pt;\">Pharyngoconjunctival Fever</span></p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 330.5px; height: 54.3984px;\">\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 10pt;\">Adenovirus serotypes 3, 4, and 7</span></p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 54.3984px;\">\n<td style=\"width: 330.5px; height: 54.3984px;\">\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 10pt;\">Epidemic Keratoconjunctivitis</span></p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 330.5px; height: 54.3984px;\">\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 10pt;\">Adenovirus serotypes 8, 19, and 37</span></p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ff93d73f9d5844e2b56274a372b73c0fx720x434.JPEG"
    ]
  },
  {
    "text": "A child presents with irritation and redness of the left eye at a primary health center. There are no previous immunization records. Examination showed a greyish-white membrane over the bulbar and palpebral conjunctiva which bled on peeling. What is the likely etiology?",
    "choices": [
      {
        "id": 1,
        "text": "Corynebacterium diphtheriae"
      },
      {
        "id": 2,
        "text": "Moraxella lacunata"
      },
      {
        "id": 3,
        "text": "Moraxella axenfeld"
      },
      {
        "id": 4,
        "text": "Chlamydia trachomatis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The of a child with irritation and redness of the eye with no previous vaccination records is suggestive of a case of <strong>membranous conjunctivitis</strong> and among the given options, <strong><em>Corynebacterium diphtheriae</em></strong> is the most likely etiological agent.</p>\n<p>Membranous conjunctivitis presents with<strong> irritation </strong>and<strong> redness</strong> of the eye and is characterized by the formation of a <strong>greyish-white membrane</strong><strong>\u00a0</strong>that <strong>bleeds on peeling</strong>. Vaccines are routinely used to\u00a0prevent\u00a0diphtheria infection and hence, unvaccinated status increases his susceptibility to the bacteria. Moreover, the bacteria thrive in crowded populations and poor\u00a0hygienic surroundings, hence a background of low socioeconomic context, such as an orphanage, acts as a risk factor in this case.</p>\n<p>This condition is associated with the formation of <strong>fibrinous exudates</strong> on the surface and into the substance of the conjunctival epithelium. The causes include beta-hemolytic <strong>streptococci,</strong> <em>Streptococcus pneumonia, </em><em>Haemophilus aegyptius, Corynebacterium diphtheria,</em> and<em> </em><em>Neisseria gonorrhea</em></p>\n<p class=\"p1\">The image given below shows the eye of a patient with <strong>pseudomembranous conjunctivitis.</strong> It differs from membranous conjunctivitis in that the membrane can be easily peeled off in this condition leaving an intact underlying epithelium.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/23bfb12768c54b9d9d4b1897436783e4x1280x958.JPEG"
    ]
  },
  {
    "text": "A child with pharyngitis, and fever subsequently develops conjunctivitis. Initially, the left eye was affected, followed by the right eye's involvement in 2 days. Epiphora, conjunctival hyperemia, and chemosis are noted.  What is its most likely etiological agent?",
    "choices": [
      {
        "id": 1,
        "text": "Picorna virus"
      },
      {
        "id": 2,
        "text": "Coxsackie virus"
      },
      {
        "id": 3,
        "text": "Adenovirus"
      },
      {
        "id": 4,
        "text": "Enterovirus 70"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This child with pharyngitis and subsequent involvement of the eyes most likely has pharyngoconjunctival fever. This condition is commonly caused by <strong>adenovirus</strong> serotypes <strong>3, 4, </strong>and <strong>7</strong>.\u00a0</p>\n<p><strong>Pharyngoconjunctival fever</strong>\u00a0is an acute and highly infectious illness characterized by\u00a0fever, pharyngitis, acute follicular conjunctivitis, and regional lymphoid hyperplasia with tender, enlarged <strong>preauricular adenopathy.</strong>\u00a0Within the classical triad, symptoms may vary in severity. It is usually bilateral, with one eye typically having onset 1-3 days prior to the second eye. It\u00a0is a self-limiting disease and treatment\u00a0is mainly symptomatic, as follows:</p>\n<ul>\n<li>Cold compresses several times per day for 1-2 weeks.</li>\n<li>Artificial tears 4-8 times per day for 1-3 weeks.</li>\n</ul>\n<p><strong>Newcastle conjunctivitis </strong>is usually clinically indistinguishable from this condition and is derived from contact with <strong>diseased fowls. </strong>Another conjunctivitis caused by<strong> adenovirus</strong> serotypes<strong> 8, 19</strong>\u00a0 and\u00a0<strong>37\u00a0</strong>is known as <strong>e</strong><strong>pidemic keratoconjunctivitis.</strong></p>\n<p>The image given below shows the eye of a patient with pharyngoconjunctival fever.\u00a0Significant <strong>conjunctival hyperemia</strong>, petechial subconjunctival hemorrhages, and conjunctival follicles are noted.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e5b35264b3fb4368950e3052bd79b78bx800x601.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is false regarding this condition?",
    "choices": [
      {
        "id": 1,
        "text": "The condition is commonly associated with a benign course."
      },
      {
        "id": 2,
        "text": "It can occur spontaneously in elders with systolic hypertension."
      },
      {
        "id": 3,
        "text": "The blood gets absorbed gradually in 6-8 weeks time without treatment."
      },
      {
        "id": 4,
        "text": "Use of NSAIDs and aspirin to treat the condition should be avoided."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image given above shows a\u00a0<strong>subconjunctival haemorrhage</strong> in the eye. In this condition, the blood gets <strong>absorbed</strong> gradually in <strong>1-3 weeks time</strong> without treatment.</p>\n<p>A subconjunctival hemorrhage is also called <strong>subconjunctival ecchymosis.\u00a0</strong>It is due to the rupture of small blood vessels and\u00a0can occur spontaneously in elders with systolic hypertension or after local trauma.\u00a0The condition is commonly associated with a benign course but, if the\u00a0<strong>posterior limit</strong> of the hemorrhage is <strong>not seen</strong>, one should <strong>check</strong> for the\u00a0<strong>base of the skull fracture.</strong>\u00a0</p>\n<p><strong>Recurrent</strong> <strong>episodes</strong> warrant investigations for a <strong>bleeding diathesis or leukaemia.</strong>\u00a0The use of<strong> NSAIDs and aspirin</strong> to treat the condition should be <strong>avoided.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/94e2c55d7c054609b90f20f24f80b639.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A UNICEF volunteer presented with a bilateral red eye of 2 days duration beginning on a return flight from Ghana. The infection spread among all her family members within a day of her return. Initial examination revealed lid edema, serous discharge, and severe sub-conjunctival hemorrhage. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hemorrhagic conjunctivitis"
      },
      {
        "id": 2,
        "text": "Giant papillary conjunctivitis"
      },
      {
        "id": 3,
        "text": "Allergic conjunctivitis"
      },
      {
        "id": 4,
        "text": "Inclusion conjunctivitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of a patient with <strong>bilateral red-eye</strong> and a <strong>rapid spread of infection</strong>\u00a0to family members points towards a likely diagnosis of<strong>\u00a0hemorrhagic conjunctivitis</strong>. Examination findings of lid edema, serous discharge, and\u00a0<strong>subconjunctival hemorrhage</strong>\u00a0further<strong>\u00a0</strong>consolidate this diagnosis.</p>\n<p>Causes:</p>\n<ul>\n<li><strong>Enterovirus 70 (most important)</strong></li>\n<li>Coxsackievirus 24</li>\n<li>Echovirus 34</li>\n<li>Adenovirus</li>\n<li><em>Pneumococcus</em></li>\n<li><em>Haemophilus</em></li>\n</ul>\n<p>There is <strong>no</strong>\u00a0<strong>treatment</strong>\u00a0currently available. The infection generally resolves itself within a five to seven-day period. The use of steroids can actually cause a corneal microbial superinfection which then requires antimicrobial therapy to eliminate.</p>\n<p>The image given below shows the eyes of a patient with acute hemorrhagic conjunctivitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fc7aef7307ca4900925fcb43ed684313x1279x454.JPEG"
    ]
  },
  {
    "text": "What is the cause of acute hemorrhagic conjunctivitis?",
    "choices": [
      {
        "id": 1,
        "text": "Enterovirus 68"
      },
      {
        "id": 2,
        "text": "Enterovirus 69"
      },
      {
        "id": 3,
        "text": "Enterovirus 70"
      },
      {
        "id": 4,
        "text": "Enterovirus 71"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Enterovirus 71 </strong>(Option D) is associated with fatal meningitis, encephalitis, and paralysis. It is also implicated in <strong>Hand-Foot-Mouth</strong> disease(HFMD) and <strong>Herpangia</strong> which is papulo-vesiculo-ulcerative rash in oral cavity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8cf57362442645a3b860eb9f61da7c55x1280x454.JPEG"
    ]
  },
  {
    "text": "A tribal farmer, presented with a three-day history of right eye redness with pain. He had spent the prior week trekking up a mountain in order to travel to the nearby town and takes such trips frequently. The following lesion was observed on examination. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Retention cyst"
      },
      {
        "id": 2,
        "text": "Pinguecula"
      },
      {
        "id": 3,
        "text": "Pterygium"
      },
      {
        "id": 4,
        "text": "Spring catarrh"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of right eye redness with pain, and findings of a <strong>raised whitish-yellowish lesion</strong> surrounded by mild erythema, points toward a likely diagnosis of\u00a0<strong>pinguecula</strong>. A history of trekking, along with chronic <strong>sunlight exposure</strong> as a farmer, acts as a risk factor because it increases the\u00a0<strong>exposure to the stronger UV radiation</strong> in the mountains.</p>\n<p>Pinguecula has a fatty appearance and\u00a0is usually bilateral.\u00a0They are more often located<strong> nasally</strong>\u00a0than temporally. It has horizontally oriented areas of <strong>bulbar conjunctival thickening</strong> that adjoin the limbus in the palpebral fissure area.\u00a0They are associated with a 2- to 3-fold increased incidence of<strong> age-related macular\u00a0</strong><strong>degeneration</strong>. It is\u00a0seen in most eyes by 70 years of age and in almost all by 80 years of age.</p>\n<p>Pingueculitis responds to a brief course of <strong>NSAIDs</strong> or<strong>\u00a0topical corticosteroids</strong>.\u00a0<strong>Simple excision</strong>\u00a0may be warranted\u00a0in rare cases, wherein pingueculae may be chronically inflamed or cosmetically unsatisfactory<strong>.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7a129786bd6a42d99ea2b3fd1f46d109.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the likely diagnosis from the image given below?",
    "choices": [
      {
        "id": 1,
        "text": "Pinguecula"
      },
      {
        "id": 2,
        "text": "Concretions"
      },
      {
        "id": 3,
        "text": "Pterygium"
      },
      {
        "id": 4,
        "text": "Bitots spots"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The likely diagnosis, based on the above image, is<strong> pterygium</strong>.\u00a0</p>\n<p><strong>Pterygium</strong>\u00a0is a <strong>subconjunctival fibrovascular tissue</strong> encroaching the cornea. It is a <strong>degenerative</strong> condition of the sub-conjunctival tissue and is\u00a0never inflammatory. It occurs due to exposure to\u00a0<strong>UV-B</strong>\u00a0radiation and the most common site is the\u00a0<strong>nasal</strong>.</p>\n<p>It is made up of three parts, \"cap\" (an avascular halo-like zone at the advancing edge), a head, and a body.</p>\n<p>Clinical features:</p>\n<ul>\n<li>Astigmatism with the rule<strong> -</strong>\u00a0most common finding</li>\n<li>Stocker's line<strong> -\u00a0</strong>deposition of iron on the advancing edge</li>\n<li>Fuchs islets <strong>-\u00a0</strong>small, discrete,\u00a0whitish flecks consisting of <strong>clusters</strong> of <strong>pterygial epithelial cells,</strong> often present at the advancing edge.</li>\n</ul>\n<p>The differential diagnosis is <strong>pseudo pterygium.\u00a0</strong></p>\n<table>\n<tbody>\n<tr>\n<td><strong>Pterygium</strong></td>\n<td><strong>Pseudo-pterygium</strong></td>\n</tr>\n<tr>\n<td><strong>Degenerative</strong> process</td>\n<td><strong>Inflammatory</strong> process</td>\n</tr>\n<tr>\n<td>Occurs in <strong>elderly</strong>\u00a0</td>\n<td>Can occur at any age</td>\n</tr>\n<tr>\n<td>Situated at the <strong>palpebral aperture</strong></td>\n<td>Can occur at any site</td>\n</tr>\n<tr>\n<td>Either progressive, regressive, or stationary</td>\n<td>Always stationary</td>\n</tr>\n<tr>\n<td>A <strong>probe cannot</strong> be <strong>passed</strong> underneath</td>\n<td>A probe can be passed under the neck</td>\n</tr>\n</tbody>\n</table>\n<p>The treatment for pterygium is usually <strong>excision. </strong>To prevent a recurrence, <strong>mitomycin C</strong> or <strong>5 fluorouracil</strong> is used. Other methods:</p>\n<ul>\n<li>Auto-grafting-\u00a0Conjunctival limbal autograft (CLAG) from the superior limbal conjunctiva is the\u00a0best method.</li>\n<li>Bare sclera technique-\u00a0high recurrence rate\u00a0of\u00a030 to 80%.</li>\n<li>PERFECT surgery-\u00a0zero rates of\u00a0recurrence. (<strong>PERFECT</strong>\u00a0stands for <span class=\"st\"><strong>P</strong>terygium<strong> E</strong>xtended <strong>R</strong>emoval <strong>F</strong>ollowed by <strong>E</strong>xtended <strong>C</strong>onjunctival<strong> T</strong>ransplant</span>)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f3de6a68c24f4e4faf885c4c59e02429.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The excision of a pinkish, triangular tissue growth at the 1 o\u2019clock position of the eye is being performed. The patient had a history of blurry vision and persistent redness in both eyes for a month. In order to secure the graft in the scleral bed, which of the following will not be used?",
    "choices": [
      {
        "id": 1,
        "text": "Vicryl suture"
      },
      {
        "id": 2,
        "text": "Autologous serum"
      },
      {
        "id": 3,
        "text": "Cyanoacrylate"
      },
      {
        "id": 4,
        "text": "Fibrin glue"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical vignette, with symptoms of\u00a0blurry vision and persistent redness, along with findings of an abnormal triangular mass of thickened conjunctiva, is suggestive of <strong>pterygium.</strong> <strong>Cyanoacrylate</strong> is <strong>not used</strong> for pterygium surgery.</p>\n<p>The various glues used in ophthalmology are as follows:</p>\n<ul>\n<li><strong>Cyanoacrylate glue-\u00a0</strong>Mainly used as a corneal patch to <strong>seal acute corneal perforations</strong> and improve visual outcomes, with reduced enucleation rates and need for tectonic keratoplasty</li>\n<li><strong>Fibrin glue-\u00a0</strong>It is a biological adhesive, which reduces the total surgical time. It is used in corneal and conjunctival surgeries, squint surgeries, cataract (to fix the haptics of intraocular lens [IOL] to the tissue in place of sutures in glued IOL), refractive surgeries, trabeculectomy, and even retinal surgeries.</li>\n<li>Newer tissue adhesives like <strong>b</strong><strong>io-dendrimers</strong> and\u00a0<strong>p</strong><strong>hoto-cross-linkable\u00a0adhesives-</strong>\n<ol>\n<li>Bovine serum albumin-based bioadhesives: used in squint surgery</li>\n<li>Riboflavin-based bioadhesive activated on exposure to ultraviolet A: used in post-LASIK ectasia, infectious keratopathy, pseudophakic bullous keratopathy</li>\n<li>Hyaluronic acid-based photocatalytic glue activated with argon LASER: used in the repair of corneal lacerations</li>\n</ol>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A man presented with red eyes associated with a sandy, gritty sensation. He was diagnosed with conjunctivitis last week, however, his symptoms persisted. He has had multiple sexual partners in the past. Examination revealed palpable preauricular nodes and a follicular reaction involving the bulbar conjunctiva and semilunar folds. Conjunctival scrapings were sent for culture. What is the likely organism involved?",
    "choices": [
      {
        "id": 1,
        "text": "Chlamydia trachomatis"
      },
      {
        "id": 2,
        "text": "Chlamydia psittaci"
      },
      {
        "id": 3,
        "text": "Herpes simplex"
      },
      {
        "id": 4,
        "text": "Gonococcus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of red eyes, along with the examination findings of\u00a0palpable preauricular nodes and\u00a0<strong>follicular reaction\u00a0</strong>involving the bulbar conjunctiva and semilunar folds, is suggestive of <strong>inclusion conjunctivitis</strong>. It is also known as <strong>c</strong><strong>hlamydial conjunctivitis, </strong>caused by <strong><em>Chlamydia trachomatis\u00a0</em>serotypes D\u2013K.\u00a0</strong>It\u00a0is a <strong>sexually transmitted disease</strong>\u00a0occurring commonly in young adults.</p>\n<p>The modes of transmission include orogenital activities and <strong>hand-to-eye spread</strong> of infective genital secretions. Hence, it is important to <strong>treat all sexual partners</strong> <strong>simultaneously</strong> to prevent re-infection and to rule out other venereal diseases, such as gonorrhoea and syphilis.\u00a0Treatment includes a\u00a0single 1g dose of <strong>azithromycin</strong> or <strong>doxycycline</strong> 100 mg twice a day for 7 days.</p>\n<p>The image given below shows the eye of a patient with chlamydial conjunctivitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b726579f427047b99a68cdabcc1d7d56x360x269.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions is closely related to mucus fishing syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Spring catarrh"
      },
      {
        "id": 2,
        "text": "Atopic keratoconjunctivitis"
      },
      {
        "id": 3,
        "text": "Phlyctenular keratoconjunctivitis"
      },
      {
        "id": 4,
        "text": "Giant papillary conjunctivitis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Mucus fishing syndrome</strong> is closely related to\u00a0<strong>giant papillary conjunctivitis</strong>.</p>\n<p>In <strong>Mucus\u00a0fishing syndrome,\u00a0</strong>patients develop a chronic papillary\u00a0reaction due to repetitive manual removal of mucus. The severe form of <strong>mechanically induced</strong> <strong>papillary conjunctivitis</strong>\u00a0is known as giant papillary conjunctivitis (<strong>GPC</strong>). It is most frequently encountered with <strong>contact lens (CL) wear</strong>; in such cases,\u00a0it is termed <strong>contact lens-associated papillary conjunctivitis (CLPC)</strong>.<strong>\u00a0</strong></p>\n<p>The increased risk in contact lens users is because of the\u00a0build-up of proteinaceous deposits and cellular debris on the contact lens surface.\u00a0It may be also be caused by ocular prostheses, exposed sutures, and scleral buckles, corneal surface irregularity, or filtering blebs.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presented with watering, redness and photophobia. He had similar complaints in the past which improved with self-medicated topical drops. His best-corrected visual acuity is 6/36 improving to 6/24. Slit-lamp examination revealed a 3 mm \u00d7 2 mm epithelial defect in the paracentral part of the cornea that stained positive with fluorescein dyes. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Spring catarrh"
      },
      {
        "id": 2,
        "text": "Exposure keratopathy"
      },
      {
        "id": 3,
        "text": "Neuroparalytic keratopathy"
      },
      {
        "id": 4,
        "text": "Trachoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>spring catarrh</strong>.\u00a0Slit-lamp examination finding of\u00a0<strong>shield ulcer </strong>is\u00a0typical of\u00a0<strong>vernal keratoconjunctivitis</strong>\u00a0(VKC) or\u00a0<strong>warm weather conjunctivitis</strong> (another name of VKC).</p>\n<p>Shield ulcers are transverse ulcers seen in the upper cornea due to epithelial macroerosions in\u00a0VKC. It is a rare <strong>complication of VKC</strong> and should always be kept in mind for patients suffering from vernal conjunctivitis.</p>\n<p>Corneal signs in VKC:</p>\n<ul>\n<li><strong>Shield ulcers</strong></li>\n<li>Vernal plaques</li>\n<li>Subepithelial scarring</li>\n<li><strong>Pseudo-gerontoxon-</strong>\u00a0resembles arcus senilus; has a <strong>cupid's bow</strong> outline</li>\n</ul>\n<p>Treatment of VKC is mainly with allergy avoidance and lid hygiene. Cool compresses, topical antihistamines, topical NSAIDs and topical steroids can be used to reduce the intensity of symptoms.\u00a0</p>\n<p>The image given below shows a shield ulcer in a patient with VKC.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/41320d71d3ef4d258273ab56593a2967x320x215.JPEG"
    ]
  },
  {
    "text": "While browsing through the news channels, Geeta came across a panel discussion on public health diseases celebrating the elimination of a peculiar condition of the eye. It was known as the most important cause of corneal blindness in India and shows the following finding. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Trachoma"
      },
      {
        "id": 2,
        "text": "Vernal keratoconjunctivitis"
      },
      {
        "id": 3,
        "text": "Phlyctenular conjunctivitis"
      },
      {
        "id": 4,
        "text": "Xerophthalmia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given<strong> sago-grain appearance</strong> of the conjunctiva is seen in <strong>trachoma</strong>. It was the most important cause of <strong>corneal blindness </strong>in India affecting young children.\u00a0</p>\n<p>Conjunctival appearance:</p>\n<p><strong>1. In trachoma</strong></p>\n<ul>\n<li>Sago-grain appearance</li>\n<li>A <strong>follicular</strong> reaction\u00a0</li>\n</ul>\n<p><strong style=\"font-size: 14px;\">2. In vernal keratoconjunctivitis</strong></p>\n<ul>\n<li><strong>Cobblestone </strong>appearance</li>\n<li>A <strong>papillary</strong> reaction seen in palpebral conjunctiva</li>\n</ul>\n<p><strong>3. Phlyctenular conjunctivitis</strong></p>\n<ul>\n<li>White-pinkish <strong>nodule</strong> in the bulbar conjunctiva</li>\n</ul>\n<p><strong>4. Xerophthalmia</strong></p>\n<ul>\n<li>Epithelial xerosis</li>\n<li><strong>Bitot spot</strong> in bulbar conjunctiva</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d22ca5d022a64386960ad7d2c453f355.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following will not be seen as a corneal sign in a 6-year-old patient with trachoma?",
    "choices": [
      {
        "id": 1,
        "text": "Herbert pits"
      },
      {
        "id": 2,
        "text": "Pannus"
      },
      {
        "id": 3,
        "text": "Opacity"
      },
      {
        "id": 4,
        "text": "Arlt\u2019s line"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<table style=\"height: 287px; width: 421.137px;\">\n<tbody>\n<tr style=\"height: 17px;\">\n<td style=\"width: 165px; height: 17px;\"><strong>Corneal</strong> signs</td>\n<td style=\"width: 229.137px; height: 17px;\"><strong>Conjunctival</strong> signs</td>\n</tr>\n<tr style=\"height: 134.926px;\">\n<td style=\"width: 165px; height: 134.926px;\">\n<ul>\n<li>Superficial keratitis</li>\n<li>Follicles in the limbal area</li>\n<li><strong>Pannus-</strong>&nbsp;superior limbus</li>\n<li>Corneal ulcer</li>\n<li><strong>Herberts pits-&nbsp;</strong>near&nbsp;Limbal area</li>\n<li>Corneal opacity</li>\n</ul>\n</td>\n<td style=\"width: 229.137px; height: 134.926px;\">\n<ul>\n<li>Congestion- On upper tarsal, fornix</li>\n<li>Follicles (containing <strong>Leber cells&nbsp;</strong>on histopathology)- On upper tarsal, fornix</li>\n<li>Papillary hyperplasia</li>\n<li><strong>Arlt&rsquo;s line-</strong>&nbsp;Linear scarring in sulcus subtarsalis</li>\n<li><strong>Concretions-&nbsp;</strong>Inspissated mucus, dead epithelial cells in the glands of Henle</li>\n</ul>\n&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young girl has been brought in by her grandmother because she has constant pain, photosensitivity and discharge from her eyes. From the notes, you see that the child has had multiple presentations for prior eye infections. You observe severe scarring on the palpebral conjunctiva, as well as trachomatous trichiasis. Which McCallan stage will this be classified under?",
    "choices": [
      {
        "id": 1,
        "text": "Stage 1"
      },
      {
        "id": 2,
        "text": "Stage 2"
      },
      {
        "id": 3,
        "text": "Stage 3"
      },
      {
        "id": 4,
        "text": "Stage 5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The clinical vignette of a young child with pain,\u00a0photosensitivity and discharge, having repeated infections, along with findings of scarring and trichiasis is suggestive of <strong>trachoma</strong>. Cicatrising trachoma is <strong>stage 3</strong> of trachoma and is characterized by scarring of the palpebral conjunctiva.</p>\n<p class=\"p1\"><strong>Cicatricial trachoma</strong> is the end result of scarring that occurs in individuals who suffer from severe, persistent infections in childhood. Trachomatous scarring is recognized by the presence of easily visible <strong>white bands</strong> on the underside of the upper eyelid. Severe scarring can result in contraction of the tarsal conjunctiva which causes the lid margin to roll inwards. This results in buckling of the lid so the lashes rub on the eye known as <strong>trachomatous trichiasis</strong>. These lashes can lead to corneal opacities and scarring and eventually <strong>blindness</strong>.</p>\n<p class=\"p1\">The four stages of trachoma according to\u00a0<strong>McCallan</strong> are as follows:</p>\n<ul>\n<li class=\"p1\">Stage 1:\u00a0<strong>Incipient</strong> -<strong> </strong>Immature follicles are present, but<strong>\u00a0</strong>clinical <strong>symptoms </strong>are<strong> not obvious</strong>.</li>\n<li class=\"p1\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Stage 2: </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Established</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> -</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> </strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Typical trachomatous lesions</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">\u00a0without scarring</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">.</span></li>\n<li class=\"p1\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Stage 3: </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Cicatrising</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> - </span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Scarring</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">\u00a0</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">along with</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">\u00a0</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">active infection.</span></li>\n<li class=\"p1\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Stage 4:</span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">\u00a0</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Healed - </strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Only scarring, the\u00a0disease is</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">\u00a0</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">either</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> cured or quiet</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">.</span></li>\n</ul>\n<p>The image below shows\u00a0trachomatous trichiasis\u00a0with severe scarring-</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d211412289c54438bd1f7cb977d7001ex1024x670.JPEG"
    ]
  },
  {
    "text": "What is the drug of choice under the SAFE strategy for trachoma management?",
    "choices": [
      {
        "id": 1,
        "text": "Azithromycin"
      },
      {
        "id": 2,
        "text": "Tetracycline"
      },
      {
        "id": 3,
        "text": "Doxycycline"
      },
      {
        "id": 4,
        "text": "Penicillin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Oral azithromycin</strong>\u00a0is the drug of choice in the <strong>SAFE strategy</strong> of trachoma management. The adult dose is <strong>1 g</strong>\u00a0while\u00a0<strong>20 mg/kg</strong> body weight is given for children.</p>\n<p>Oral azithromycin is slowly replacing tetracycline eye ointment as the first line drug used in trachoma treatment. The experience of Morocco, the first country that used azithromycin in a large-scale, nationwide elimination programme, has paved the way for the <strong>worldwide application of azithromycin as part of the SAFE strategy</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 21-year-old man presented with the following lesion in his eye. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Xerophthalmia"
      },
      {
        "id": 2,
        "text": "Pterygium"
      },
      {
        "id": 3,
        "text": "Phlyctenular conjunctivitis"
      },
      {
        "id": 4,
        "text": "Membranous conjunctivitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image depicts <strong>Bitot's spot</strong>,<strong>\u00a0</strong>a pathognomonic feature of <strong>xerophthalmia</strong>. Hence, the likely diagnosis in this\u00a021-year-old man presenting with the above lesion is<strong> xerophthalmia.</strong></p>\n<p>Bitot's spot is a triangular, silvery-white, foamy patch on the bulbar conjunctiva which is usually bilateral. The most common site is\u00a0<strong>t</strong><strong>emporal.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e5dc44d3c29841119f7b8fa5bee15f57.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 10 year old malnourished boy is brought with a 2-month history of diminished night vision. His dietary history revealed a restricted diet, consisting of mainly chips and nuggets, and he would refuse to eat green leafy vegetables. What is the conjunctival change seen in this deficiency?",
    "choices": [
      {
        "id": 1,
        "text": "Actinic degeneration"
      },
      {
        "id": 2,
        "text": "Stromal infiltration"
      },
      {
        "id": 3,
        "text": "Hyperplasia of goblet cells"
      },
      {
        "id": 4,
        "text": "Hyperkeratosis of the squamous epithelium"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario indicates that this patient has <strong>nyctalopia</strong> (diminished night vision) most likely due to<strong> vitamin A deficiency, </strong>suggested by his poor consumption of vegetables.\u00a0Changes seen in the conjunctiva in vitamin A deficiency is\u00a0<strong>hyperkeratosis</strong> of the <strong>squamous epithelium</strong>.</p>\n<p>This occurs due to the metaplasia of the non-keratinized\u00a0epithelium to keratinized epithelium.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ophthalmia nodosa occurs due to which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Cat scratch disease"
      },
      {
        "id": 2,
        "text": "Tularemia"
      },
      {
        "id": 3,
        "text": "Leprosy"
      },
      {
        "id": 4,
        "text": "Irritation due to caterpillar hair"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Ophthalmia nodosa</strong> occurs due to irritation due to <strong>caterpillar hair</strong>.</p>\n<p>It is often <strong>mistaken for tuberculosis.&nbsp;</strong>On examination, small, semitranslucent, reddish and yellowish-grey nodules are formed in the conjunctiva, cornea,&nbsp;and iris. Microscopy contains caterpillar hair surrounded by <strong>giant cells and lymphocytes.&nbsp;</strong>Treatment includes <strong>excision</strong> of the nodules in the conjunctiva.&nbsp; &nbsp;</p>\n<p>The image below shows a patient's eye infected with ophthalmia nodosa.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f1297e2690eb436980b427bb5d163433x804x586.JPEG"
    ]
  },
  {
    "text": "A 28-year-old woman with redness and photophobia of the left eye was seen in the OPD. An image of a characteristic lesion of her eye is as shown below. Identify the lesion.",
    "choices": [
      {
        "id": 1,
        "text": "Pterygium"
      },
      {
        "id": 2,
        "text": "Pinguecula"
      },
      {
        "id": 3,
        "text": "Phlycten"
      },
      {
        "id": 4,
        "text": "Hebert\u2019s follicle"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows a <strong>white-pinkish nodule</strong> surrounded by hyperemia on the <strong>bulbar conjunctiva</strong> near the <strong>limbus</strong> with associated symptoms of <strong>redness</strong> and <strong>photophobia</strong> most likely has phlyctenular conjunctivitis. The given finding is referred to as a <strong>phlycten.</strong></p>\n<p>\u00a0<strong>Phlyctenular conjunctivitis </strong>is a type 4 hypersensitivity reaction due to endogenous allergens like <strong><em>Staphylococcus aureus </em></strong>(most common) and\u00a0<strong><em>Mycobacterium tuberculosis.</em></strong></p>\n<p>It is characterized by the following:</p>\n<ul>\n<li>Phlycten that may eventually form <strong>ring ulcers</strong></li>\n<li>Shallow marginal ulcer due to the\u00a0breakdown of limbal phlycten known as <strong>sc</strong><strong>rofulous ulcer</strong></li>\n<li><strong>Fascicular ulcer</strong>\u00a0with a prominent parallel leash of blood vessels that heals leaving a <strong>band-shaped opacity</strong></li>\n</ul>\n<p><strong>Treatment</strong>: Topical steroids; atropine if the\u00a0cornea is involved.</p>\n<p><strong>Note:</strong> This can be differentiated from pinguecula by the following points:</p>\n<p>Pinguecula is a <strong>yellow</strong>\u00a0<strong>triangular patch</strong> on the conjunctiva near the limbus. It usually <strong>remains free from conjunctival congestion.\u00a0\u00a0</strong>The following image shows <strong>a yellow patch</strong> with <strong>tortuous blood vessels.</strong>\u00a0There is no congestion as seen with a phlycten.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a5c2f20e7672495bab5159541833e000.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2604fedd5694f57833539469fa6097cx800x600.JPEG"
    ]
  },
  {
    "text": "Which of the following should not be considered in the differential of a patient who presents with the following finding?",
    "choices": [
      {
        "id": 1,
        "text": "Erythema multiforme"
      },
      {
        "id": 2,
        "text": "Steven-Johnson syndrome"
      },
      {
        "id": 3,
        "text": "Phlyctenular conjunctivitis"
      },
      {
        "id": 4,
        "text": "Alkali injury"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows <strong>symblepharon,</strong> which is <strong>not seen</strong> in phlyctenular conjunctivitis. It is a partial or complete <strong>adhesion of the palpebral conjunctiva</strong> of the eyelid to the bulbar conjunctiva of the eyeball.</p>\n<p><strong>Causes of symblepharon:</strong></p>\n<ol>\n<li>Chemical injuries (especially alkalis)</li>\n<li>Burns</li>\n<li>Ocular cicatrical pemphigoid (OCP)</li>\n<li>Steven\u2013Johnson syndrome</li>\n<li>Erythema multiforme</li>\n<li>Pemphigus bullosa</li>\n<li>Membranous conjunctivitis</li>\n</ol>\n<p><strong>Management: </strong></p>\n<ul>\n<li>Lubrication</li>\n<li>Sweeping of fornices</li>\n<li>Symblepharon ring</li>\n<li>Symblepharon release and amniotic membrane graft</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/00e15761c79349ae9dafb82bd4b40cfc.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the most common cause of ophthalmia neonatorum in developed countries?",
    "choices": [
      {
        "id": 1,
        "text": "Chlamydia"
      },
      {
        "id": 2,
        "text": "Gonorrhoea"
      },
      {
        "id": 3,
        "text": "Chemical conjunctivitis"
      },
      {
        "id": 4,
        "text": "Staphylococcus aureus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong><br />Prophylactic</strong> treatment: 1% tetracycline or erythromycin eye ointment is applied to the eyes, if the mother is suspected to have <em>gonococca</em>l or <em>chlamydia</em> infection.</p>\n<p><strong>Curative</strong> treatment:&nbsp;</p>\n<div class=\"page\" title=\"Page 398\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 398\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><em>Chlamydia trachomatis</em> (D&ndash; K)- Erythromycin eye ointment</li>\n<li><em><em>Neisseria gonorrhoeae-&nbsp;</em></em>Ceftriaxone injection, gentamicin drops, bacitracin eye ointment</li>\n</ul>\n<p>The below image shows an infant presenting with <strong>ophthalmia neonatarum.</strong></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6b6c877298fa4b5186ea63d8948d3c26x1218x1178.PNG"
    ]
  },
  {
    "text": "An 8-year-old boy had to miss school because the matting of his eyelids made it difficult to open them in the morning and caused severe pain. His agonized mother rushed him to the hospital and reported that he had a fever and red eye for 4 days. Which group of lymph nodes is likely to be enlarged?",
    "choices": [
      {
        "id": 1,
        "text": "Sublingual and submandibular nodes"
      },
      {
        "id": 2,
        "text": "Parotid and sublingual nodes"
      },
      {
        "id": 3,
        "text": "Submandibular and preauricular nodes"
      },
      {
        "id": 4,
        "text": "Jugulo-digastric nodes"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of fever and red eyes, associated with matting of eyelids and pain, is suggestive of<strong>&nbsp;conjunctivitis</strong>. Lymph from the conjunctiva drains directly into the&nbsp;<strong>submandibular </strong>and<strong> preauricular nodes </strong>and hence, these group of lymph nodes are likely to be enlarged.</p>\n<p>The <strong>l</strong><strong>ymphatic drainage of the conjunctiva&nbsp;</strong>is as follows-</p>\n<ul>\n<li>From the <strong>medial&nbsp;side</strong>, one-third of the superior and medial two-thirds of the inferior conjunctiva &rarr;&nbsp;<strong>Submandibular</strong> <strong>nodes</strong></li>\n<li>From the <strong>lateral side</strong>, two-thirds of the superior conjunctiva and lateral one-third of the inferior conjunctiva &rarr;&nbsp;<strong>Preauricular</strong> <strong>nodes</strong></li>\n</ul>\n<p class=\"p1\">Specialized collections of T and B lymphocytes underlying a modified epithelium is known as <strong>conjunctiva-associated lymphoid tissue (CALT)&nbsp;</strong>present in the stroma (substantia propria). It is critical in the initiation and regulation of ocular-surface immune responses.&nbsp;</p>\n<p class=\"p1\">&nbsp;Note:</p>\n<p class=\"p1\">The stroma also consists of the <strong>accessory lacrimal&nbsp;glands</strong> of <strong>Krause</strong> and <strong>Wolfring </strong>which are&nbsp;exocrine&nbsp;glands&nbsp;responsible for the basal secretion of the middle aqueous layer of the tear film.</p>\n<p class=\"p1\">The image given below shows the lymphatic drainage of the conjunctiva.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4fc4305c60c24134b914471e0e2227aex1280x1537.2637517630465.JPEG"
    ]
  },
  {
    "text": "The image of the eye of a 32-year-old woman having superior limbic keratoconjunctivitis is given below. Which of the following is commonly associated with it?",
    "choices": [
      {
        "id": 1,
        "text": "Valvular heart disease"
      },
      {
        "id": 2,
        "text": "Thyroid disease"
      },
      {
        "id": 3,
        "text": "Inflammatory bowel disease"
      },
      {
        "id": 4,
        "text": "Systemic lupus erythematosus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Superior</strong> <strong>limbic keratoconjunctivitis</strong>&nbsp;has a definite association with <strong>thyroid dysfunction.&nbsp;</strong>It affects one or both eyes of <strong>middle-aged women</strong> and about <strong>65</strong><strong>% </strong>of patients have abnormal thyroid function (usually <strong>hyperthyroidism</strong>).</p>\n<p>It is a chronic disease of the superior limbus and the superior bulbar and the tarsal conjunctiva.</p>\n<p><strong>Clinical features:</strong></p>\n<ul>\n<li>Papillary hypertrophy of the superior tarsal plate, often having a <strong>diffuse velvety appearance.</strong></li>\n<li>Hyperemia of a radial band of the superior bulbar conjunctiva that stains with rose bengal.</li>\n<li style=\"list-style-type: none;\"></li>\n<li>Superior filamentary keratitis that develops in about one-third of cases.</li>\n</ul>\n<p><strong>Management: </strong></p>\n<ul>\n<li>Preservative-free lubricants</li>\n<li><strong>Topical acetylcysteine 10% to 20%,</strong> four times daily to break down filaments</li>\n<li>Topical rebamipide</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/cb0cf85320624756baab9c12c5b00dd3.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is not characteristic of pterygium?",
    "choices": [
      {
        "id": 1,
        "text": "Abnormal activity of p53 is seen in the pterygium tissue."
      },
      {
        "id": 2,
        "text": "Decreased activity of tissue inhibitors of metalloproteinases is seen."
      },
      {
        "id": 3,
        "text": "Destruction of Bowman's layer occurs when the pterygium invades the cornea."
      },
      {
        "id": 4,
        "text": "Elastotic degeneration and hyalinization of the connective tissue of the conjunctiva occur."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Elastotic degeneration and <strong>hyalinization</strong> of the conjunctival connective tissue occurs in <strong>pinguecula</strong> (and <strong>not pterygium</strong>).\u00a0</p>\n<p>In pterygium, there is elastotic degeneration of collagen with<strong> fibrovascular proliferation.</strong></p>\n<p>It is important to distinguish a pterygium from a pinguecula. A pterygium, while histologically similar to a pinguecula, is distinguished by fibrovascular tissue that grows onto the cornea. Pingueculae do not have vascularized tissue and do not cross the limbus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 7-year-old boy complains of intense lacrimation, associated with photophobia. On examination, the following finding is seen in his upper tarsal conjunctiva. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Trachoma"
      },
      {
        "id": 2,
        "text": "Vernal keratoconjunctivitis"
      },
      {
        "id": 3,
        "text": "Phlyctenular conjunctivitis"
      },
      {
        "id": 4,
        "text": "Xerophthalmia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Treatment of this condition is with topical steroids and mast cell stabilizers such as cromolyn sodium. Topical cyclosporine can be used in patients who do not respond to first line treatment modalities.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1156d7b977eb48c2a202f5bacd24041a.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36ac67de6bd6434ea799f7bf80c77346x623x187.JPEG"
    ]
  },
  {
    "text": "Your professor has assigned you to proofread a seminar on the anatomy of the conjunctiva made by a junior. In the explanation of conjunctival follicles, you spot a wrong statement that needs revision. What is that statement?",
    "choices": [
      {
        "id": 1,
        "text": "Conjunctiva of new born does not produce follicles before 2-3 months of age."
      },
      {
        "id": 2,
        "text": "Slit lamp may be necessary to differentiate between follicles and papillae."
      },
      {
        "id": 3,
        "text": "Follicles are a hyperplasia of the normal vascular system."
      },
      {
        "id": 4,
        "text": "Follicles are found in the sub-epithelial adenoid layer of the conjunctiva."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Papillae (not follicles) </strong>are hyperplasia of the normal vascular system, with glomerulus-like branches of capillaries growing into the epithelium in inflammatory conditions.\u00a0On the other hand, <strong>follicles</strong> are <strong>yellowish-white</strong>, round elevations of<strong>\u00a01-2 mm</strong>\u00a0diameter. Follicles are a <strong>localized aggregation of lymphocytes </strong>present\u00a0in the <strong>sub-epithelial adenoid layer </strong>of the conjunctiva.</p>\n<p><strong>Image</strong>: Conjunctival papillae (hyperplastic epithelium\u00a0and capillaries) shown in the first image followed by conjunctival giant follicles (round yellowish-white elevations)\u00a0 shown in the second image.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d7bcdceffca640c28011c2b385f59362x494x318.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ec4c7c5dd1784faa8e7fd5c02dce3cabx506x364.JPEG"
    ]
  },
  {
    "text": "In the grading of trachoma, the follicular stage is defined by the presence of which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "5 or more follicles in the lower tarsal conjunctiva"
      },
      {
        "id": 2,
        "text": "3 or more follicles in the upper tarsal conjunctiva"
      },
      {
        "id": 3,
        "text": "5 or more follicles in the upper tarsal conjunctiva"
      },
      {
        "id": 4,
        "text": "3 or more follicles in the lower tarsal conjunctiva"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the grading of trachoma,<strong> follicular stage</strong> is defined by the presence of\u00a0<strong>5 or more</strong> follicles in the <strong>upper tarsal</strong> conjunctiva.</p>\n<p><strong>Trachoma</strong> is the leading infectious cause of blindness worldwide. It is caused by an obligate intracellular bacterium called\u00a0<strong><em>Chlamydia trachomatis\u00a0</em>Serotypes A\u2013C</strong>. The infection is transmitted by direct or indirect transfer of eye and nose discharges of infected people, particularly young <strong>children</strong> who harbour the principal reservoir of infection.</p>\n<p>The image below shows the follicular stage of trachoma -</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c7a28fbc622142e8b916d36c5f46640dx1024x660.JPEG"
    ]
  }
];
        let quizName = '05 Conjunctiva';
        let hierarchy = ["Marrow", "qBank", "Ophthalmology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>