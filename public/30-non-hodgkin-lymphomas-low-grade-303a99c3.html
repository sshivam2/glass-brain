<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>30 Non Hodgkin Lymphomas  Low Grade - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Pathology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">27</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The peripheral smear finding of a patient with fever and lymphadenopathy is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Infectious mononucleosis"
      },
      {
        "id": 2,
        "text": "Follicular lymphoma"
      },
      {
        "id": 3,
        "text": "Chronic lymphocytic leukemia"
      },
      {
        "id": 4,
        "text": "Hairy-cell leukemia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The peripheral smear finding shows <strong>Downey cells </strong>or<strong>&nbsp;ballerina skirt cells</strong>.&nbsp;These are typically seen in&nbsp;<strong>infectious mononucleosis&nbsp;</strong>caused by&nbsp;Epstein-Barr virus&nbsp;<strong>(EBV)</strong>&nbsp;and cytomegalovirus&nbsp;<strong>(CMV)</strong>.&nbsp;</p>\n<p>They<strong>&nbsp;</strong>are<strong> atypical lymphocytes</strong> with abundant basophilic cytoplasm containing clear vacuolations and prominent nucleoli.&nbsp;They become large as a result of antigen stimulation.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2dcb639613fc48b1a788e7430147c8c3.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f034f001f2df4aa68cbd7dccbf697060x1200x1055.JPEG"
    ]
  },
  {
    "text": "Bruton tyrosine kinase is involved in which type of B-cell lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "Mantle-cell lymphoma"
      },
      {
        "id": 2,
        "text": "Diffuse large B-cell lymphoma"
      },
      {
        "id": 3,
        "text": "Chronic lymphocytic lymphoma"
      },
      {
        "id": 4,
        "text": "Burkitt lymphoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Bruton tyrosine kinase</strong> (BTK)<strong>&nbsp;</strong>is associated with B-cell chronic lymphocytic lymphoma/ small lymphocytic lymphoma (<strong>CLL</strong>/<strong>SLL</strong>).</p>\n<p>Tumour cells in CLL rely on signals generated by the B-cell receptor for growth and survival. These signals are transduced by a cascade of kinases that include BTK.</p>\n<p>Note:&nbsp;BTK is also defective in patients with <strong>congenital X-linked agammaglobulinemia</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old man presents with easy fatigability, weight loss, and anorexia. On examination, he is found to have generalized lymphadenopathy and hepatosplenomegaly. Investigations show a total WBC count of 1 lakh per microliter, with 80% lymphocytes. Peripheral smear is as shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Chronic myeloid leukemia"
      },
      {
        "id": 2,
        "text": "Chronic lymphocytic leukemia"
      },
      {
        "id": 3,
        "text": "Hodgkin lymphoma"
      },
      {
        "id": 4,
        "text": "Hairy cell leukemia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Chronic Lymphocytic Leukemia<strong>&nbsp;(CLL)</strong>&nbsp;/ Small lymphocytic lymphoma<strong>(SLL)</strong>&nbsp;is the most common leukemia among adults in the western world.</p>\n<p>The differentiating point between CLL and SLL is that in<strong>&nbsp;</strong><strong>CLL&nbsp;</strong>the<strong>&nbsp;</strong>absolute lymphocyte count is&nbsp;<strong>&gt;5000 per mm&sup3;&nbsp;</strong>and in<strong>&nbsp;</strong>SLL:&lt;5000 per mm&sup3;.</p>\n<p>It is usually<strong>&nbsp;asymptomatic</strong>&nbsp;at diagnosis but can present with easy fatigability, weight loss, and anorexia. Generalized lymphadenopathy and hepatosplenomegaly are usually seen.</p>\n<ul>\n<li><strong>Total blood count</strong>:\n<ul>\n<li>Total&nbsp;<strong>leukocyte count</strong>&nbsp;is highly&nbsp;<strong>variable</strong>;&nbsp;<strong>leukopenia</strong>&nbsp;is seen when the&nbsp;<strong>marrow</strong>&nbsp;is&nbsp;<strong>involved</strong>.&nbsp;</li>\n<li><strong>Hypogammaglobulinemia</strong>&nbsp;is common and contributes to increased susceptibility to infections.</li>\n<li>10% to 15% of patients develop&nbsp;<strong>hemolytic anemia&nbsp;</strong>or<strong>&nbsp;thrombocytopenia</strong>&nbsp;due to&nbsp;<strong>autoantibodies</strong>&nbsp;made by nonneoplastic B cells.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li><strong>Peripheral smear</strong>:\n<ul>\n<li>Predominantly shows&nbsp;<strong>small lymphocytes</strong>&nbsp;with scant cytoplasm</li>\n<li><strong>Smudge cells&nbsp;</strong>or&nbsp;<strong>basket cells&nbsp;</strong>or&nbsp;<strong>parachute cells -</strong>&nbsp;artifacts of the lymphocytes which are disrupted during the process of making smears.</li>\n<li>Contains a&nbsp;large number of monotonous, uniform-looking, mature lymphocytes, which is often described as a <strong>convent-girl appearance</strong>.</li>\n<li><strong>Spherocytes</strong> (due to coexisting autoimmune hemolytic anemia) and <strong>nucleated RBCs</strong> (due to premature release of progenitors in face of severe anemia, marrow infiltration by the tumor, or both)</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li><strong>Lymph node biopsy</strong>:\n<ul>\n<li><strong>Diffuse effacement</strong>&nbsp;composed of small lymphocytes admixed with variable numbers of larger activated lymphocytes that often gather in loose aggregates</li>\n<li>Referred to as&nbsp;<strong>proliferation centers</strong>, which contain&nbsp;<strong>mitotically active</strong>&nbsp;cells.&nbsp;Proliferation centers are&nbsp;<strong>pathognomonic&nbsp;</strong>for CLL / SLL.</li>\n</ul>\n</li>\n</ul>\n<p><strong>The</strong>&nbsp;<strong>chromosomal defects</strong>:</p>\n<ul>\n<li>Deletion of<strong>&nbsp;13q</strong>&nbsp;(<strong>commonest</strong>&nbsp;and has a&nbsp;<strong>good prognosis</strong>)</li>\n<li>Deletion of 11q</li>\n<li>Trisomy 12q</li>\n<li>Deletion of&nbsp;<strong>17p</strong>&nbsp;(<strong>poor prognosis</strong>).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b403c6e3702d4bdcb81a8cc90e403101.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d40bea353bbb4194907b0f6dd2df578cx1200x1874.JPEG"
    ]
  },
  {
    "text": "The neoplastic cells in chronic lymphocytic leukemia/ small lymphocytic lymphoma originate from which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Pre B cell"
      },
      {
        "id": 2,
        "text": "Germinal center B cell"
      },
      {
        "id": 3,
        "text": "Mantle zone cell"
      },
      {
        "id": 4,
        "text": "Post-germinal-center memory B cell"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The cell of origin for&nbsp;chronic lymphocytic leukemia/small lymphocytic lymphoma <strong>(CLL/SLL)</strong> is either a&nbsp;<strong>post-germinal center memory B cell</strong> or a<strong> naive B cell.</strong></p>\n<p>The cells of CLL show both&nbsp;<strong>unmutated Ig</strong> segments (those of <strong>naive </strong>B-cell origin) and somatic <strong>hypermutated Ig</strong> segments (those of&nbsp;<strong>post-germinal center</strong> memory B cell).</p>\n<p>Tumours with unmutated Ig segments (those of <strong>naive B-cell </strong>origin) pursue a <strong>more aggressive course</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a genetic anomaly seen in patients with chronic lymphocytic lymphoma/ small lymphocytic lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "Deletion of 11q"
      },
      {
        "id": 2,
        "text": "Trisomy 17p"
      },
      {
        "id": 3,
        "text": "Trisomy 12q"
      },
      {
        "id": 4,
        "text": "Deletion of 13q"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Deletion</strong> <strong>of 17p</strong>&nbsp;is a genetic anomaly seen in chronic lymphocytic lymphoma <strong>(CLL)/</strong> small lymphocytic lymphoma <strong>(SLL),</strong> not trisomy 17p.</p>\n<p>The genetic anomalies seen in CLL/SLL are:</p>\n<ul>\n<li>Trisomy 12q</li>\n<li>Deletion of 13q</li>\n<li>Deletion of 17p (bad prognosis)</li>\n<li>Deletion of 11q (bad prognosis)&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 70-year-old man presents with weakness and generalized lymphadenopathy. Lymph node biopsy shows difuse effacement with small lymphocytes and proliferation centers. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Follicular lymphoma"
      },
      {
        "id": 2,
        "text": "Chronic lymphocytic leukemia/small lymphocytic lymphoma"
      },
      {
        "id": 3,
        "text": "Mantle-cell lymphoma"
      },
      {
        "id": 4,
        "text": "Diffuse large B-cell lymphoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>chronic lymphocytic leukemia/small lymphocytic lymphoma </strong>(CLL/SLL).</p>\n<p>Lymph node biopsy in CLL/SLL shows <strong>effacement</strong> of <strong>normal nodal architecture</strong> by sheets of\u00a0predominantly <strong>small lymphocytes</strong>. They have round to slightly irregular nuclei, condensed chromatin, and scant cytoplasm.</p>\n<p>Admixed are a\u00a0variable number of larger activated lymphocytes that often gather in loose aggregates referred to as <strong>proliferation centers.</strong>\u00a0These contain mitotically active cells. When present, <strong>proliferation centers </strong>are <strong>pathognomic</strong> for CLL/SLL (also known as a\u00a0<strong>pseudofollicular pattern</strong>).</p>\n<p>The image given below shows a lymph node biopsy of CLL in a low-power view. It shows loss of normal architecture and a large, pale-staining area in the center of the node (a proliferation center)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/09f82210f2034ebb974ee01ce23c5b16x1280x1201.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1da002a5ac14487894194473e682f55bx1280x1201.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/279c43df8333454190c8590f0d8e29dfx1280x1104.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa622314a7dd498b9cec8e72b19bb47cx1280x1103.JPEG"
    ]
  },
  {
    "text": "A 58-year-old man with cervical lymphadenopathy is suspected to have chronic lymphocytic leukemia. What should be the absolute lymphocyte count/mm3 to diagnose this condition?",
    "choices": [
      {
        "id": 1,
        "text": ">2000"
      },
      {
        "id": 2,
        "text": ">5000"
      },
      {
        "id": 3,
        "text": ">10000"
      },
      {
        "id": 4,
        "text": ">100000"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>diagnostic</strong> requirement for chronic lymphocytic leukemia (<strong>CLL</strong>)&nbsp;is absolute lymphocyte count <strong>&gt;5000</strong> per cubic millimetre.<strong>&nbsp;</strong></p>\n<p>Chronic lymphocytic leukemia (<strong>CLL</strong>) and small lymphocytic lymphoma (<strong>SLL</strong>) <strong>differ</strong> only in the degree of peripheral blood<strong> lymphocytosis:</strong></p>\n<ul>\n<li>CLL - 5000/mm<sup>3</sup></li>\n<li>SLL - &lt;5000 cells/mm<sup>3</sup></li>\n</ul>\n<p>Note: CLL is the most common leukemia of adults in the western world.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Flow cytometric analysis of four patients is given below. Who among the following is most likely suffering from chronic lymphocytic leukemia?",
    "choices": [
      {
        "id": 1,
        "text": "Patient 1"
      },
      {
        "id": 2,
        "text": "Patient 2"
      },
      {
        "id": 3,
        "text": "Patient 3"
      },
      {
        "id": 4,
        "text": "Patient 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Interpretation of results:</p>\n<p>Quadrant 1- Cells marked in green: -VE for A antigen, +VE for B antigen</p>\n<p>Quadrant 2- Cells marked in purple: -VE for both the antigens.</p>\n<p>Quadrant 3- Cells marked in yellow: +VE for both the antigens&nbsp;</p>\n<p>Quadrant 4- Cells marked in red: +VE for A antigen, -VE for B antigen&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ad8748e271e94fcbab3437551b73b1df.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6fdbee5356f744abb37f074deec0d402x1280x1080.JPEG"
    ]
  },
  {
    "text": "A 73-year-old man came with complaints of malaise and low-grade fever. He had generalized lymphadenopathy. The histopathological examination of the lymph node is as shown below. These cells showed positivity for CD5, CD19, CD20, and CD23. Which of the following does not indicate a poor prognosis in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Deletions of 11q and 17p"
      },
      {
        "id": 2,
        "text": "Lack of somatic hypermutation"
      },
      {
        "id": 3,
        "text": "Expression of ZAP-70"
      },
      {
        "id": 4,
        "text": "Absence of  of NOTCH1 mutations"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Variables that correlate with a worse outcome include:</p>\n<ul>\n<li>The presence of <strong>deletions of 11q and 17p</strong></li>\n<li>Lack of somatic hypermutation</li>\n<li><strong>Expression </strong>of <strong>ZAP-70</strong></li>\n<li><strong>Presence </strong>of<strong> NOTCH 1 mutations</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/39c1de8c95124bdfb70106a2c366ef96.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c8ec06380014833ba14baf8cf0733f7x1280x1050.JPEG"
    ]
  },
  {
    "text": "A middle-aged woman presented with chronic fatigue and generalized lymphadenopathy. Investigations revealed overexpression of BCL2. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Burkitt lymphoma"
      },
      {
        "id": 2,
        "text": "Follicular lymphoma"
      },
      {
        "id": 3,
        "text": "Diffuse large-cell lymphoma"
      },
      {
        "id": 4,
        "text": "Mantle cell lymhoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>follicular lymphoma. </strong>This<strong>\u00a0</strong>condition is associated with <strong>overexpression</strong> of<strong> BCL2.</strong></p>\n<p>It usually presents in middle age as <strong>painless</strong> generalized <strong>lymphadenopathy</strong>.\u00a0The involvement of <strong>extranodal</strong> sites is relatively <strong>uncommon. </strong>It has an\u00a0<strong>indolent</strong>\u00a0waxing and waning\u00a0<strong>course</strong>.<strong>\u00a0</strong></p>\n<p>In almost 50% of patients, this cancer gets transformed to diffuse large B-cell lymphoma.\u00a0The median\u00a0survival rate is for 7-9 years.</p>\n<p>The<strong> cell\u00a0</strong>of <strong>origin</strong> for follicular lymphoma is <strong>germinal</strong> centre <strong>B</strong> cells.\u00a0It shows\u00a0<strong>(14;18)\u00a0</strong>translocation.</p>\n<p>Lymph node biopsy shows closely packed follicles.\u00a0<strong>Centrocytes </strong>(small cells with the cleaved nucleus and scant cytoplasm) and <strong>centroblasts</strong> (large cells with open nuclear chromatin and multiple nucleoli) are seen.</p>\n<p><strong>Bone marrow</strong>\u00a0is involved in 85% of the cases and shows para-trabecular lymphoid aggregates.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1a31ec7c340a4a6e9c85f457e7c7c99ax1280x1112.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e2095803a8c74154a4846b4252d21f0dx1280x1112.JPEG"
    ]
  },
  {
    "text": "Which of the following chromosomal abnormality is likely to be seen in patients with follicular lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "t(11;14)"
      },
      {
        "id": 2,
        "text": "t(14;18)"
      },
      {
        "id": 3,
        "text": "t(8;14)"
      },
      {
        "id": 4,
        "text": "t(9;14)"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Follicular lymphoma shows&nbsp;<strong>t(14;18).</strong></p>\n<p>Its hallmark is a&nbsp;translocation that juxtaposes the <strong>IgH</strong> locus on chromosome <strong>14</strong> and the <strong>BCL2</strong> locus on chromosome <strong>18</strong>.&nbsp;It is seen in up to 90% of follicular lymphomas and leads to<strong> overexpression</strong> of <strong>BCL2</strong>.</p>\n<p><strong>BCL2 inhibits apoptosis</strong> and promotes the survival of follicular lymphoma cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old man presents with painless generalized lymphadenopathy and weakness. Lymph node biopsy shows the following picture. Which of the following is not true for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "BCL2 positivity"
      },
      {
        "id": 2,
        "text": "BCL6 positivity"
      },
      {
        "id": 3,
        "text": "Aggressive course"
      },
      {
        "id": 4,
        "text": "Possible transformation into diffuse large B-cell lymphoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Immunophenotyping:</strong></p>\n<ul>\n<li>The&nbsp;<strong>cell of origin</strong>&nbsp;is&nbsp;<strong>germinal-center B</strong>&nbsp;cell, so it is<strong>&nbsp;positive</strong>&nbsp;for CD<strong>19</strong>, CD<strong>20</strong>, CD<strong>10</strong>,&nbsp;<strong>BCL6</strong>, and surface Ig.</li>\n<li><strong>BCL2</strong>&nbsp;expression is positive in over&nbsp;<strong>90%</strong>&nbsp;of cases.</li>\n</ul>\n<p>Histologic transformation to diffuse large B-cell lymphoma (DLBCL)&nbsp;occurs in 30 to 50% of cases.</p>\n<p>Note:&nbsp;In contrast to follicular lymphoma,&nbsp;<strong>DLBCL</strong>&nbsp;has an&nbsp;<strong>aggressive</strong>&nbsp;course, shows a&nbsp;<strong>diffuse&nbsp;</strong>pattern of&nbsp;<strong>growth</strong>&nbsp;in lymph node biopsy and shows&nbsp;<strong>BCL-6 positivity</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/65f6b82da23b49b28778966524d926bc.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a0450aeb663240ea9cb3435c77626700x1280x1055.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5366a901cb8244a4aaf68c24fce734adx1280x1004.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bd0e5b9831f54e54ac92c4e5ed5e1a88x1280x1004.JPEG"
    ]
  },
  {
    "text": "A patient with longstanding cervical lymphadenopathy was diagnosed with mantle cell lymphoma. What is the cell of origin for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Pro B cells"
      },
      {
        "id": 2,
        "text": "Naive B cells"
      },
      {
        "id": 3,
        "text": "Mature B cells"
      },
      {
        "id": 4,
        "text": "Memory B cells"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Mantle-cell lymphoma</strong> arises from the <strong>mantle-zone B cells</strong> which are <strong>naive B</strong> cells as they lack somatic hypermutation IgH gene.</p>\n<div class=\"page\" title=\"Page 610\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Mantle-cell lymphomas have an <strong>(11;14) </strong>translocation involving the IgH locus on chromosome 14 and <strong>overexpression </strong>of <strong>cyclin D1.</strong></p>\n</div>\n</div>\n</div>\n</div>\n<p>It is <strong>CD5 positive</strong> and <strong>CD23 negative</strong>.</p>\n<p>Comparison between mantle-cell lymphoma and chronic lymphocytic leukemia/ small lymphocytic lymphoma (CLL/ SLL):</p>\n<table style=\"height: 171px;\" width=\"401\">\n<tbody>\n<tr>\n<td style=\"width: 125px;\">\u00a0</td>\n<td style=\"width: 126px;\"><strong>Mantle cell lymphoma</strong></td>\n<td style=\"width: 128px;\"><strong>CLL/SLL</strong></td>\n</tr>\n<tr>\n<td style=\"width: 125px;\"><strong>CD5</strong></td>\n<td style=\"width: 126px;\">Positive</td>\n<td style=\"width: 128px;\">Positive</td>\n</tr>\n<tr>\n<td style=\"width: 125px;\"><strong>CD23</strong></td>\n<td style=\"width: 126px;\">Negative</td>\n<td style=\"width: 128px;\">Positive</td>\n</tr>\n<tr>\n<td style=\"width: 125px;\"><strong>CyclinD1</strong></td>\n<td style=\"width: 126px;\">Positive</td>\n<td style=\"width: 128px;\">Negative</td>\n</tr>\n<tr>\n<td style=\"width: 125px;\"><strong>FMC7</strong></td>\n<td style=\"width: 126px;\">Positive</td>\n<td style=\"width: 128px;\">Negative</td>\n</tr>\n<tr>\n<td style=\"width: 125px;\"><strong>CD10, BCL6</strong></td>\n<td style=\"width: 126px;\">Negative</td>\n<td style=\"width: 128px;\">Negative</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements about mantle cell lymphoma is false?",
    "choices": [
      {
        "id": 1,
        "text": "Centroblasts are absent"
      },
      {
        "id": 2,
        "text": "Most common presentation is painless lymphadenopathy"
      },
      {
        "id": 3,
        "text": "Associated with overexpression of cyclin D1"
      },
      {
        "id": 4,
        "text": "Tumor cells are CD5 + and CD23 +"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The neoplastic cells in mantle cell lymphoma are <strong>CD5 positive</strong> and <strong>CD23 negative</strong>.</p>\n<p>Mantle cell lymphoma usually&nbsp;presents as&nbsp;<strong>painless lymphadenopathy.&nbsp;</strong>Centroblasts and proliferation centers are absent, differentiating it from chronic lymphocytic lymphoma.</p>\n<p>Immunophenotyping reveals the cells expressing <strong>cyclin D1</strong>, <strong>CD5,</strong> CD19, CD20, surface Ig.&nbsp;CD23 is negative in these cells.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 53-year-old man was evaluated for painless lymphadenopathy. Biopsy showed a homogenous population of small lymphocytes with cleaved nuclear contours. Which translocation is seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "t(18:14)"
      },
      {
        "id": 2,
        "text": "t(8:14)"
      },
      {
        "id": 3,
        "text": "t(11:18)"
      },
      {
        "id": 4,
        "text": "t(11:14)"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical picture and pathological findings point toward the diagnosis of <strong>mantle cell lymphoma</strong>.</p>\n<p>The<strong> lymph node</strong> biopsy typically shows proliferation consisting of a <strong>homogenous</strong> population of<strong> small lymphocytes</strong>. The <strong>nuclei</strong> of these cells have irregular or deeply <strong>cleaved contours</strong>.</p>\n<p>Mantle cell lymphoma has<strong>(11;14) translocation</strong> involving the <strong>IgH</strong> locus on chromosome <strong>14</strong> and the <strong>cyclin D1</strong> locus on chromosome <strong>11</strong> that leads to <strong>overexpression </strong>of<strong> cyclin D1.</strong></p>\n<p>Option A: Follicular lymphoma has t(14:18), <strong>not</strong> t(18:14). Hence, it is not the answer.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with cervical lymphadenopathy has t(11;14) positive. Which of the following markers should be done to confirm the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 5"
      },
      {
        "id": 2,
        "text": "2, 4"
      },
      {
        "id": 3,
        "text": "1, 3, 5"
      },
      {
        "id": 4,
        "text": "3, 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Translocation (11;14) is characteristic of<strong>&nbsp;mantle cell&nbsp;lymphoma</strong>. The markers to be done to confirm the diagnosis, are&nbsp;<strong>Sox11</strong> and<strong>&nbsp;Cyclin D1</strong>.</p>\n<p>Mantle cell lymphoma is seen in the fifth and sixth decades of life and has a male predominance. It is characterised by painless lymphadenopathy and splenomegaly.</p>\n<p>In some cases, there is multifocal mucosal involvement of the small bowel and colon known as&nbsp;<strong>lymphomatoid polyposis.</strong></p>\n<p>It has (<strong>11;14</strong>) translocation.&nbsp;</p>\n<p>Lymph node biopsy shows nodal tumour cells may surround reactive germinal centres. A&nbsp;<strong>homogeneous </strong>population of<strong> small lymphocytes </strong>with irregular to occasionally deeply cleft (<strong>cleaved</strong>) <strong>nuclear</strong> contours is typically seen.</p>\n<p>Large cells resembling&nbsp;<strong>centroblasts</strong> and <strong>proliferation centres are absent</strong>, distinguishing mantle cell lymphoma from follicular lymphoma and CLL/SLL, respectively.</p>\n<p>Immunophenotyping<strong>&nbsp;</strong>is <strong>positive</strong> for <strong>cyclin D</strong> and <strong>SOX-11</strong>.&nbsp;SOX11 variant that often presents with circulating disease with splenomegaly but without significant lymphadenopathy and with a <strong>low Ki67 </strong>index&nbsp;(&lt;10%).</p>\n<p>Other markers include:</p>\n<ul>\n<li>CD <strong>5</strong>,&nbsp;CD<strong>19</strong> and CD<strong>20</strong> <strong>+ve</strong></li>\n<li>CD <strong>23</strong>&nbsp;<strong>-ve</strong></li>\n<li>Moderately high levels of surface Ig (usually IgM and IgD with &kappa; or &lambda; light chain)</li>\n</ul>\n<p>The IgH genes lack somatic hypermutation, supporting an origin from a naive B cell.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the immunohistochemistry marker for cyclinD1 negative mantle cell lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "SOX11"
      },
      {
        "id": 2,
        "text": "MYD88"
      },
      {
        "id": 3,
        "text": "ITRA 1"
      },
      {
        "id": 4,
        "text": "ANNEXIN  V"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>SOX11</strong> is the marker used for <strong>cyclinD1 negative mantle cell</strong> lymphoma.&nbsp;</p>\n<p>Note:&nbsp;MYD88 is a marker for Waldenstorm macroglobulinemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements about marginal zone lymphoma is false?",
    "choices": [
      {
        "id": 1,
        "text": "They arise within tissues involved by chronic inflammatory disorders"
      },
      {
        "id": 2,
        "text": "They spread rapidly to other sites"
      },
      {
        "id": 3,
        "text": "They may regress if the inciting agent is eradicated"
      },
      {
        "id": 4,
        "text": "Transformation to diffuse large B-cell lymphoma may occur"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Marginal zone lymphoma</strong> does not spread rapidly to other sites. It remains<strong> localised</strong> for <strong>prolonged periods</strong> and spread systematically in the later course of the disease.</p>\n<p>They are <strong>B-cell tumours</strong> that arise within lymph nodes, spleen, or extranodal tissues. It is the most common primary extranodal lymphoma.</p>\n<p>They arise within tissues involved by chronic inflammatory disorders of autoimmune or infectious aetiology:</p>\n<ul>\n<li>Salivary gland in <strong>Sj&ouml;gren disease</strong></li>\n<li>Thyroid gland in <strong>Hashimoto thyroiditis</strong></li>\n<li>Stomach in <strong><em>Helicobacter</em> gastritis</strong></li>\n</ul>\n<p>They may regress if the inciting agent is eradicated. Antibiotic therapy directed against&nbsp;<em>Helicobacter pylori&nbsp;</em>leads to tumour regression.</p>\n<p>Translocations are associated with MALToma are<strong>&nbsp;t(11;18),t(14;18) </strong>and<strong>&nbsp;t(1;14). </strong>These translocations then <strong>upregulate BCL-10/MALT1</strong>, a protein that <strong>activates NF-kB</strong> and promotes the <strong>growth</strong> and survival of <strong>B-cells</strong>.</p>\n<p>They may <strong>invade epithelial</strong> structures to form lymphoepithelial lesions. <strong>Transformation</strong> to <strong>diffuse large B-cell lymphoma</strong> may occur.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with long-standing Hashimoto's thyroiditis was noted to have a swelling in the thyroid region. After evaluation, it was diagnosed as a marginal zone lymphoma. What is the cell of origin of this lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "Naive B cell"
      },
      {
        "id": 2,
        "text": "Germinal-center B cell"
      },
      {
        "id": 3,
        "text": "Memory B cell"
      },
      {
        "id": 4,
        "text": "Pre-B cell"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Marginal zone</strong> lymphomas are considered to be of <strong>memory B cell </strong>origin. In most cases, they show evidence&nbsp;of somatic hypermutation.</p>\n<p>The category of marginal zone lymphoma encompasses a heterogeneous group of B cell tumours that arise&nbsp;within lymph nodes, spleen, or extranodal tissues. They are often referred to as MALTomas.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to you with rapidly growing swelling on her right cheek. Past history is significant for Sj\u00f6gren syndrome. You suspect a lymphoid neoplasm in her. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Anaplastic large cell lymphoma"
      },
      {
        "id": 2,
        "text": "Marginal-zone lymphoma"
      },
      {
        "id": 3,
        "text": "Mantle cell lymphoma"
      },
      {
        "id": 4,
        "text": "Burkitt's lymphoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Lymphomas arising in the setting of&nbsp;<strong>Sj&ouml;gren syndrome</strong> in the <strong>salivary gland</strong> is <strong>marginal-zone lymphomas.</strong></p>\n<p>They often arise in tissues involved by chronic inflammatory disorders of autoimmune or infectious aetiology such as:</p>\n<ul>\n<li>Salivary gland in <strong>Sj&ouml;gren syndrome</strong></li>\n<li>Thyroid gland in <strong>Hashimoto thyroiditis</strong>&nbsp;</li>\n<li>Stomach in<strong><em> Helicobacter</em> gastritis</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following translocations is seen in extra-nodal marginal-zone lymphoma?",
    "choices": [
      {
        "id": 1,
        "text": "t(4;18)"
      },
      {
        "id": 2,
        "text": "t(8;14)"
      },
      {
        "id": 3,
        "text": "t(2;14)"
      },
      {
        "id": 4,
        "text": "t(11;18)"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The translocation seen in <strong>marginal-zone lymphoma</strong> is&nbsp;<strong>t(11;18). </strong>Other translocations include t(<strong>14;18</strong>), t(<strong>1;14</strong>).</p>\n<p>Marginal-zone lymphoma&nbsp;<strong>begins</strong> as a <strong>polyclonal immune reaction</strong>. Signals from the antigen-stimulated T helper cells, drive the growth and survival of the clonal B-cells. At this stage, it is reversible, as in gastric MALToma after antibiotics against <em>Helicobacter pylori</em>.</p>\n<p>With time <strong>tumour cells</strong> may acquire <strong>mutations</strong> that render their <strong>growth</strong> and <strong>survival antigen-independent</strong>. Translocations such as<strong>&nbsp;t(11;18), t(14;18), or t(1;14)&nbsp;</strong>up-regulate the expression and function of<strong><em> BCL10</em> or <em>MALT1</em></strong>&nbsp;and promote the growth and survival of B cells.&nbsp;</p>\n<p>These translocations are relatively specific for extranodal&nbsp;marginal-zone lymphomas.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 34-year-old woman came with complaints of chronic lethargy and weakness. Complete blood counts revealed pancytopenia. The peripheral smear showed the following picture. Which of the following statements is false about this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Neoplastic T lymphocytes are seen"
      },
      {
        "id": 2,
        "text": "Cells are positive for annexin"
      },
      {
        "id": 3,
        "text": "Cell stain positive for TRAP"
      },
      {
        "id": 4,
        "text": "Massive splenomegaly occurs"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Patients present with <strong>massive splenomegaly</strong> and <strong>pancytopenia</strong>. There is an increased incidence of <strong>atypical mycobacterial infections</strong>, possibly related to frequent unexplained monocytopenia.</p>\n<p>Activating point <strong>mutations </strong>in the serine/threonine kinase <strong>BRAF </strong>is seen in&nbsp;90% of cases.</p>\n<p>Peripheral smear shows&nbsp;fine circumferential cytoplasmic <strong>hairy projections </strong>which&nbsp;are&nbsp;<strong>best</strong> recognized under the <strong>phase-contrast microscope</strong>. The bone marrow <strong>aspirate</strong> produces a <strong>dry tap</strong>.</p>\n<p>A <strong>trephine biopsy</strong> reveals infiltration by the cancer cells often in the pattern of a <strong>honeycomb appearance</strong>. Leukemic cells have nuclei surrounded by a cytoplasmic halo (<strong>fried egg&nbsp;appearance</strong>).</p>\n<p>The neoplastic cells stain <strong>positive</strong> for tartrate-resistant acid phosphatase (<strong>TRAP</strong>).&nbsp;</p>\n<p>Markers for hairy cell leukemia include:</p>\n<ul>\n<li><strong>pan-B</strong>-cell markers- CD <strong>19</strong>, CD<strong>2O</strong></li>\n<li>CD<strong>11c&nbsp;</strong></li>\n<li>CD<strong>25&nbsp;</strong></li>\n<li>CD<strong>103&nbsp;</strong></li>\n<li><strong>annexin A1</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9e417f87af89470d82608510582b565c.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a5bc808f7753408b8bc887d035fce0bex1280x1127.JPEG"
    ]
  },
  {
    "text": "A 65-year-old man with a dragging sensation in his abdomen is found to have massive splenomegaly. The peripheral blood smear findings are as follows. Which of the following markers would you test to confirm the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "CD65"
      },
      {
        "id": 2,
        "text": "CD207"
      },
      {
        "id": 3,
        "text": "CD1a"
      },
      {
        "id": 4,
        "text": "CD103"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical features and peripheral smear showing fine circumferential cytoplasmic <strong>hairy projections</strong>\u00a0point towards the diagnosis of <strong>hairy cell leukaemia</strong>.</p>\n<p>It's a rare but distinctive neoplasm of the B cells where splenomegaly is often the only abnormal finding. Pancytopenia from marrow involvement and sequestration of cells in the enlarged spleen is seen in half the cases and infections are seen in one-third of the affected patients.\u00a0</p>\n<p><strong>CD103</strong> must be tested among the markers to confirm <strong>hairy cell leukaemia</strong>.</p>\n<p><strong>Hairy-cell</strong> leukaemias typically express the following markers:</p>\n<ul>\n<li>Pan B-cell markers CD<strong>19</strong>, CD<strong>20</strong>,<strong> surface Ig</strong> (usually IgG)\u00a0</li>\n<li>CD<strong>11c</strong></li>\n<li>CD<strong>25</strong></li>\n<li>CD<strong>103</strong></li>\n<li><strong>Annexin A1</strong>.</li>\n</ul>\n<p><strong>Annexin A1</strong> is the most <strong>specific</strong> and <strong>sensitive</strong> marker.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f754dc7934424d90a3a339359c9209de.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A histological specimen of the spleen is shown below. Which non-Hodgkin's lymphoma does not arise from the area marked as 1?",
    "choices": [
      {
        "id": 1,
        "text": "Hairy-cell leukemia"
      },
      {
        "id": 2,
        "text": "Burkitt's lymphoma"
      },
      {
        "id": 3,
        "text": "Follicular lymphoma"
      },
      {
        "id": 4,
        "text": "Mantle cell lymphoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The area marked '1' in the image is the <strong>white pulp</strong> of the <strong>spleen.</strong>\u00a0<strong>Hairy-cell</strong> leukemia does not arise from the white pulp, it <strong>involves only</strong> the<strong> red pulp</strong> of the spleen. The other condition involving the red pulp is <strong>hepato-splenic lymphoma</strong>.</p>\n<p>All the other non-Hodgkin lymphomas (NHLs) involve white pulp.</p>\n<p><strong>Splenomegaly</strong> is the most common and often the only abnormal<strong>\u00a0</strong>physical finding in <strong>hairy-cell</strong> leukemia. The spleen in this condition is described as a beefy red spleen.</p>\n<p>The image given below shows the normal histology of the spleen.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/da339354afca4a1fb1d4fc18aca3eccb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e92e4d4e5d564b448020022071b981d7x1280x1016.JPEG"
    ]
  },
  {
    "text": "A 60-year-old woman presented with generalized itching and mild hypoaesthesia of the skin. On examination, maculopapular patches were seen on her back. Biopsy revealed the presence of atypical lymphocytes with cerebriform nuclei infiltrating the dermis and epidermis. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Anaplastic large cell lymphoma"
      },
      {
        "id": 2,
        "text": "Mycosis fungoides"
      },
      {
        "id": 3,
        "text": "Peripheral T-cell lymphoma"
      },
      {
        "id": 4,
        "text": "Adult T-cell leukemia/lymphoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given pathological feature is characteristic of a <strong>Pautrier's microabscess</strong>. These are seen in <strong>mycosis fungoides.</strong></p>\n<p>It is a <strong>mature</strong>, <strong>cutaneous</strong>, CD4+ <strong>T-cell</strong> non-Hodgkin<strong> lymphoma.</strong> Skin lesions include truncal scaling,&nbsp;red-brown patches, plaques, and fungating nodules. Lesions may evolve into a systemic lymphoma, with visceral and nodal spread.</p>\n<p><strong>Sezary syndrome</strong> is a variant of mycosis fungoides. It is the <strong>leukemic seeding</strong> of <strong>blood</strong> by malignant T cells from the skin (CD4+). It presents with<strong>&nbsp;diffuse erythroderma</strong> and scaling.&nbsp;</p>\n<p><strong>Histological</strong> hallmark includes:</p>\n<ul>\n<li><strong>S&eacute;zary</strong>-Lutzner<strong> cells </strong>-&nbsp;cells with&nbsp;<strong>cerebriform</strong> nuclei (infolded/hyper-convoluted nuclear membrane).</li>\n<li><strong>Pautrier's microabscesses </strong>-&nbsp;tumor cells invade the epidermis as single cells and small clusters.</li>\n<li><strong>Epidermotropism</strong> -&nbsp;invasion of the tumor cells into the epidermis.</li>\n</ul>\n<p>The image shows sezary cells with cerebriform nuclei in the peripheral smear.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0e428f717c0c46f8b8aa10b62cca8349x220x222.JPEG"
    ]
  },
  {
    "text": "A patient presents with generalized exfoliative erythroderma. The peripheral blood smear shows the following cell. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mycosis fungoides"
      },
      {
        "id": 2,
        "text": "Sezary syndrome"
      },
      {
        "id": 3,
        "text": "Adult T cell leukemia"
      },
      {
        "id": 4,
        "text": "Peripheral NK cell leukemia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows a classical <strong>Sezary cell </strong>with <strong>cerebriform nuclei</strong> which points towards a diagnosis&nbsp;of <strong>Sezary syndrome</strong>.&nbsp;These are <strong>neoplastic T</strong> cells.</p>\n<p>Sezary syndrome and mycosis fungoides are different manifestations of tumors of CD4+ helper T cells that are home to the&nbsp;skin.</p>\n<p><strong>Sezary syndrome&nbsp;</strong>is a variant presenting as <strong>generalized exfoliative erythroderma.</strong>&nbsp;It rarely goes into tumefaction and there is associated leukemia of Sezary cells.</p>\n<p>In<strong> Mycosis fungoides, o</strong><strong>nly</strong> the <strong>epidermis</strong> and <strong>upper dermis</strong> are infiltrated by <strong>neoplastic T</strong> cells with the characteristic cerebriform appearance. In the later stages of the disease, progression occurs to lymph nodes and bone marrow. Tumour cells are not seen in blood. The disease progresses through the&nbsp;premycotic phase, plaque phase, and tumour phase.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f981fb48bce44cd4adab2869d94a3764.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "You suspect a lymphoid neoplasm in a patient who is a known case of rheumatoid arthritis. On workup, she has splenomegaly and her blood count showed neutropenia and lymphocytosis. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Marginal zone lymphoma"
      },
      {
        "id": 2,
        "text": "Follicular lymphoma"
      },
      {
        "id": 3,
        "text": "Burkitt  lymphoma"
      },
      {
        "id": 4,
        "text": "Large granular lymphocytic leukemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A <strong>triad</strong> of rheumatoid arthritis, splenomegaly, and neutropenia is known as&nbsp;<strong>Felty's syndrome</strong>. Some patients with Felty's syndrome have <strong>large granular lymphocytic leukemia</strong> as an underlying cause.</p>\n<p>Large granular lymphocytic leukemia is a&nbsp;<strong>T-cell (CD3+)</strong> and <strong>NK-cell (CD56+)</strong> variant leukemia.&nbsp;They are associated with<strong> mutations</strong> in the transcription factor,&nbsp;<em><strong>STAT3</strong>.</em></p>\n<p>Patients usually presents with mild to moderate <strong>lymphocytosis</strong> and <strong>splenomegaly</strong>. Neutropenia and anemia are also present. Lymphadenopathy and hepatomegaly are usually absent.&nbsp;</p>\n<p>There is an <strong>increased incidence</strong> of <strong>rheumatological disorders</strong> associated with this condition.</p>\n<p>The <strong>peripheral smear</strong> picture shows<strong> large lymphocytes</strong> with abundant <strong>blue cytoplasm</strong> and few azurophilic granules.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '30 Non Hodgkin Lymphomas  Low Grade';
        let hierarchy = ["Marrow", "qBank", "Pathology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>